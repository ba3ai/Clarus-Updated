(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();function fi(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Jv={exports:{}},od={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tA;function $F(){if(tA)return od;tA=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(n,a,i){var o=null;if(i!==void 0&&(o=""+i),a.key!==void 0&&(o=""+a.key),"key"in a){i={};for(var u in a)u!=="key"&&(i[u]=a[u])}else i=a;return a=i.ref,{$$typeof:e,type:n,key:o,ref:a!==void 0?a:null,props:i}}return od.Fragment=t,od.jsx=r,od.jsxs=r,od}var rA;function zF(){return rA||(rA=1,Jv.exports=$F()),Jv.exports}var l=zF(),eg={exports:{}},_t={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nA;function HF(){if(nA)return _t;nA=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),o=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),x=Symbol.iterator;function v(I){return I===null||typeof I!="object"?null:(I=x&&I[x]||I["@@iterator"],typeof I=="function"?I:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,b={};function S(I,se,R){this.props=I,this.context=se,this.refs=b,this.updater=R||y}S.prototype.isReactComponent={},S.prototype.setState=function(I,se){if(typeof I!="object"&&typeof I!="function"&&I!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,I,se,"setState")},S.prototype.forceUpdate=function(I){this.updater.enqueueForceUpdate(this,I,"forceUpdate")};function N(){}N.prototype=S.prototype;function _(I,se,R){this.props=I,this.context=se,this.refs=b,this.updater=R||y}var A=_.prototype=new N;A.constructor=_,w(A,S.prototype),A.isPureReactComponent=!0;var k=Array.isArray,C={H:null,A:null,T:null,S:null,V:null},O=Object.prototype.hasOwnProperty;function T(I,se,R,W,Y,Q){return R=Q.ref,{$$typeof:e,type:I,key:se,ref:R!==void 0?R:null,props:Q}}function z(I,se){return T(I.type,se,void 0,void 0,void 0,I.props)}function P(I){return typeof I=="object"&&I!==null&&I.$$typeof===e}function Z(I){var se={"=":"=0",":":"=2"};return"$"+I.replace(/[=:]/g,function(R){return se[R]})}var q=/\/+/g;function B(I,se){return typeof I=="object"&&I!==null&&I.key!=null?Z(""+I.key):se.toString(36)}function fe(){}function Ne(I){switch(I.status){case"fulfilled":return I.value;case"rejected":throw I.reason;default:switch(typeof I.status=="string"?I.then(fe,fe):(I.status="pending",I.then(function(se){I.status==="pending"&&(I.status="fulfilled",I.value=se)},function(se){I.status==="pending"&&(I.status="rejected",I.reason=se)})),I.status){case"fulfilled":return I.value;case"rejected":throw I.reason}}throw I}function he(I,se,R,W,Y){var Q=typeof I;(Q==="undefined"||Q==="boolean")&&(I=null);var L=!1;if(I===null)L=!0;else switch(Q){case"bigint":case"string":case"number":L=!0;break;case"object":switch(I.$$typeof){case e:case t:L=!0;break;case h:return L=I._init,he(L(I._payload),se,R,W,Y)}}if(L)return Y=Y(I),L=W===""?"."+B(I,0):W,k(Y)?(R="",L!=null&&(R=L.replace(q,"$&/")+"/"),he(Y,se,R,"",function(G){return G})):Y!=null&&(P(Y)&&(Y=z(Y,R+(Y.key==null||I&&I.key===Y.key?"":(""+Y.key).replace(q,"$&/")+"/")+L)),se.push(Y)),1;L=0;var ne=W===""?".":W+":";if(k(I))for(var ge=0;ge<I.length;ge++)W=I[ge],Q=ne+B(W,ge),L+=he(W,se,R,Q,Y);else if(ge=v(I),typeof ge=="function")for(I=ge.call(I),ge=0;!(W=I.next()).done;)W=W.value,Q=ne+B(W,ge++),L+=he(W,se,R,Q,Y);else if(Q==="object"){if(typeof I.then=="function")return he(Ne(I),se,R,W,Y);throw se=String(I),Error("Objects are not valid as a React child (found: "+(se==="[object Object]"?"object with keys {"+Object.keys(I).join(", ")+"}":se)+"). If you meant to render a collection of children, use an array instead.")}return L}function K(I,se,R){if(I==null)return I;var W=[],Y=0;return he(I,W,"","",function(Q){return se.call(R,Q,Y++)}),W}function H(I){if(I._status===-1){var se=I._result;se=se(),se.then(function(R){(I._status===0||I._status===-1)&&(I._status=1,I._result=R)},function(R){(I._status===0||I._status===-1)&&(I._status=2,I._result=R)}),I._status===-1&&(I._status=0,I._result=se)}if(I._status===1)return I._result.default;throw I._result}var be=typeof reportError=="function"?reportError:function(I){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var se=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof I=="object"&&I!==null&&typeof I.message=="string"?String(I.message):String(I),error:I});if(!window.dispatchEvent(se))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",I);return}console.error(I)};function te(){}return _t.Children={map:K,forEach:function(I,se,R){K(I,function(){se.apply(this,arguments)},R)},count:function(I){var se=0;return K(I,function(){se++}),se},toArray:function(I){return K(I,function(se){return se})||[]},only:function(I){if(!P(I))throw Error("React.Children.only expected to receive a single React element child.");return I}},_t.Component=S,_t.Fragment=r,_t.Profiler=a,_t.PureComponent=_,_t.StrictMode=n,_t.Suspense=m,_t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=C,_t.__COMPILER_RUNTIME={__proto__:null,c:function(I){return C.H.useMemoCache(I)}},_t.cache=function(I){return function(){return I.apply(null,arguments)}},_t.cloneElement=function(I,se,R){if(I==null)throw Error("The argument must be a React element, but you passed "+I+".");var W=w({},I.props),Y=I.key,Q=void 0;if(se!=null)for(L in se.ref!==void 0&&(Q=void 0),se.key!==void 0&&(Y=""+se.key),se)!O.call(se,L)||L==="key"||L==="__self"||L==="__source"||L==="ref"&&se.ref===void 0||(W[L]=se[L]);var L=arguments.length-2;if(L===1)W.children=R;else if(1<L){for(var ne=Array(L),ge=0;ge<L;ge++)ne[ge]=arguments[ge+2];W.children=ne}return T(I.type,Y,void 0,void 0,Q,W)},_t.createContext=function(I){return I={$$typeof:o,_currentValue:I,_currentValue2:I,_threadCount:0,Provider:null,Consumer:null},I.Provider=I,I.Consumer={$$typeof:i,_context:I},I},_t.createElement=function(I,se,R){var W,Y={},Q=null;if(se!=null)for(W in se.key!==void 0&&(Q=""+se.key),se)O.call(se,W)&&W!=="key"&&W!=="__self"&&W!=="__source"&&(Y[W]=se[W]);var L=arguments.length-2;if(L===1)Y.children=R;else if(1<L){for(var ne=Array(L),ge=0;ge<L;ge++)ne[ge]=arguments[ge+2];Y.children=ne}if(I&&I.defaultProps)for(W in L=I.defaultProps,L)Y[W]===void 0&&(Y[W]=L[W]);return T(I,Q,void 0,void 0,null,Y)},_t.createRef=function(){return{current:null}},_t.forwardRef=function(I){return{$$typeof:u,render:I}},_t.isValidElement=P,_t.lazy=function(I){return{$$typeof:h,_payload:{_status:-1,_result:I},_init:H}},_t.memo=function(I,se){return{$$typeof:f,type:I,compare:se===void 0?null:se}},_t.startTransition=function(I){var se=C.T,R={};C.T=R;try{var W=I(),Y=C.S;Y!==null&&Y(R,W),typeof W=="object"&&W!==null&&typeof W.then=="function"&&W.then(te,be)}catch(Q){be(Q)}finally{C.T=se}},_t.unstable_useCacheRefresh=function(){return C.H.useCacheRefresh()},_t.use=function(I){return C.H.use(I)},_t.useActionState=function(I,se,R){return C.H.useActionState(I,se,R)},_t.useCallback=function(I,se){return C.H.useCallback(I,se)},_t.useContext=function(I){return C.H.useContext(I)},_t.useDebugValue=function(){},_t.useDeferredValue=function(I,se){return C.H.useDeferredValue(I,se)},_t.useEffect=function(I,se,R){var W=C.H;if(typeof R=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return W.useEffect(I,se)},_t.useId=function(){return C.H.useId()},_t.useImperativeHandle=function(I,se,R){return C.H.useImperativeHandle(I,se,R)},_t.useInsertionEffect=function(I,se){return C.H.useInsertionEffect(I,se)},_t.useLayoutEffect=function(I,se){return C.H.useLayoutEffect(I,se)},_t.useMemo=function(I,se){return C.H.useMemo(I,se)},_t.useOptimistic=function(I,se){return C.H.useOptimistic(I,se)},_t.useReducer=function(I,se,R){return C.H.useReducer(I,se,R)},_t.useRef=function(I){return C.H.useRef(I)},_t.useState=function(I){return C.H.useState(I)},_t.useSyncExternalStore=function(I,se,R){return C.H.useSyncExternalStore(I,se,R)},_t.useTransition=function(){return C.H.useTransition()},_t.version="19.1.0",_t}var aA;function Qc(){return aA||(aA=1,eg.exports=HF()),eg.exports}var g=Qc();const tn=fi(g);var tg={exports:{}},cd={},rg={exports:{}},ng={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iA;function qF(){return iA||(iA=1,function(e){function t(K,H){var be=K.length;K.push(H);e:for(;0<be;){var te=be-1>>>1,I=K[te];if(0<a(I,H))K[te]=H,K[be]=I,be=te;else break e}}function r(K){return K.length===0?null:K[0]}function n(K){if(K.length===0)return null;var H=K[0],be=K.pop();if(be!==H){K[0]=be;e:for(var te=0,I=K.length,se=I>>>1;te<se;){var R=2*(te+1)-1,W=K[R],Y=R+1,Q=K[Y];if(0>a(W,be))Y<I&&0>a(Q,W)?(K[te]=Q,K[Y]=be,te=Y):(K[te]=W,K[R]=be,te=R);else if(Y<I&&0>a(Q,be))K[te]=Q,K[Y]=be,te=Y;else break e}}return H}function a(K,H){var be=K.sortIndex-H.sortIndex;return be!==0?be:K.id-H.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,u=o.now();e.unstable_now=function(){return o.now()-u}}var m=[],f=[],h=1,x=null,v=3,y=!1,w=!1,b=!1,S=!1,N=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;function k(K){for(var H=r(f);H!==null;){if(H.callback===null)n(f);else if(H.startTime<=K)n(f),H.sortIndex=H.expirationTime,t(m,H);else break;H=r(f)}}function C(K){if(b=!1,k(K),!w)if(r(m)!==null)w=!0,O||(O=!0,B());else{var H=r(f);H!==null&&he(C,H.startTime-K)}}var O=!1,T=-1,z=5,P=-1;function Z(){return S?!0:!(e.unstable_now()-P<z)}function q(){if(S=!1,O){var K=e.unstable_now();P=K;var H=!0;try{e:{w=!1,b&&(b=!1,_(T),T=-1),y=!0;var be=v;try{t:{for(k(K),x=r(m);x!==null&&!(x.expirationTime>K&&Z());){var te=x.callback;if(typeof te=="function"){x.callback=null,v=x.priorityLevel;var I=te(x.expirationTime<=K);if(K=e.unstable_now(),typeof I=="function"){x.callback=I,k(K),H=!0;break t}x===r(m)&&n(m),k(K)}else n(m);x=r(m)}if(x!==null)H=!0;else{var se=r(f);se!==null&&he(C,se.startTime-K),H=!1}}break e}finally{x=null,v=be,y=!1}H=void 0}}finally{H?B():O=!1}}}var B;if(typeof A=="function")B=function(){A(q)};else if(typeof MessageChannel<"u"){var fe=new MessageChannel,Ne=fe.port2;fe.port1.onmessage=q,B=function(){Ne.postMessage(null)}}else B=function(){N(q,0)};function he(K,H){T=N(function(){K(e.unstable_now())},H)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(K){K.callback=null},e.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<K?Math.floor(1e3/K):5},e.unstable_getCurrentPriorityLevel=function(){return v},e.unstable_next=function(K){switch(v){case 1:case 2:case 3:var H=3;break;default:H=v}var be=v;v=H;try{return K()}finally{v=be}},e.unstable_requestPaint=function(){S=!0},e.unstable_runWithPriority=function(K,H){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var be=v;v=K;try{return H()}finally{v=be}},e.unstable_scheduleCallback=function(K,H,be){var te=e.unstable_now();switch(typeof be=="object"&&be!==null?(be=be.delay,be=typeof be=="number"&&0<be?te+be:te):be=te,K){case 1:var I=-1;break;case 2:I=250;break;case 5:I=1073741823;break;case 4:I=1e4;break;default:I=5e3}return I=be+I,K={id:h++,callback:H,priorityLevel:K,startTime:be,expirationTime:I,sortIndex:-1},be>te?(K.sortIndex=be,t(f,K),r(m)===null&&K===r(f)&&(b?(_(T),T=-1):b=!0,he(C,be-te))):(K.sortIndex=I,t(m,K),w||y||(w=!0,O||(O=!0,B()))),K},e.unstable_shouldYield=Z,e.unstable_wrapCallback=function(K){var H=v;return function(){var be=v;v=H;try{return K.apply(this,arguments)}finally{v=be}}}}(ng)),ng}var sA;function VF(){return sA||(sA=1,rg.exports=qF()),rg.exports}var ag={exports:{}},Tn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lA;function KF(){if(lA)return Tn;lA=1;var e=Qc();function t(m){var f="https://react.dev/errors/"+m;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)f+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+m+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},a=Symbol.for("react.portal");function i(m,f,h){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:x==null?null:""+x,children:m,containerInfo:f,implementation:h}}var o=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(m,f){if(m==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Tn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Tn.createPortal=function(m,f){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return i(m,f,null,h)},Tn.flushSync=function(m){var f=o.T,h=n.p;try{if(o.T=null,n.p=2,m)return m()}finally{o.T=f,n.p=h,n.d.f()}},Tn.preconnect=function(m,f){typeof m=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,n.d.C(m,f))},Tn.prefetchDNS=function(m){typeof m=="string"&&n.d.D(m)},Tn.preinit=function(m,f){if(typeof m=="string"&&f&&typeof f.as=="string"){var h=f.as,x=u(h,f.crossOrigin),v=typeof f.integrity=="string"?f.integrity:void 0,y=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;h==="style"?n.d.S(m,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:x,integrity:v,fetchPriority:y}):h==="script"&&n.d.X(m,{crossOrigin:x,integrity:v,fetchPriority:y,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Tn.preinitModule=function(m,f){if(typeof m=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var h=u(f.as,f.crossOrigin);n.d.M(m,{crossOrigin:h,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&n.d.M(m)},Tn.preload=function(m,f){if(typeof m=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var h=f.as,x=u(h,f.crossOrigin);n.d.L(m,h,{crossOrigin:x,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Tn.preloadModule=function(m,f){if(typeof m=="string")if(f){var h=u(f.as,f.crossOrigin);n.d.m(m,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:h,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else n.d.m(m)},Tn.requestFormReset=function(m){n.d.r(m)},Tn.unstable_batchedUpdates=function(m,f){return m(f)},Tn.useFormState=function(m,f,h){return o.H.useFormState(m,f,h)},Tn.useFormStatus=function(){return o.H.useHostTransitionStatus()},Tn.version="19.1.0",Tn}var oA;function dC(){if(oA)return ag.exports;oA=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),ag.exports=KF(),ag.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cA;function GF(){if(cA)return cd;cA=1;var e=VF(),t=Qc(),r=dC();function n(s){var c="https://react.dev/errors/"+s;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)c+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+s+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function i(s){var c=s,d=s;if(s.alternate)for(;c.return;)c=c.return;else{s=c;do c=s,(c.flags&4098)!==0&&(d=c.return),s=c.return;while(s)}return c.tag===3?d:null}function o(s){if(s.tag===13){var c=s.memoizedState;if(c===null&&(s=s.alternate,s!==null&&(c=s.memoizedState)),c!==null)return c.dehydrated}return null}function u(s){if(i(s)!==s)throw Error(n(188))}function m(s){var c=s.alternate;if(!c){if(c=i(s),c===null)throw Error(n(188));return c!==s?null:s}for(var d=s,p=c;;){var j=d.return;if(j===null)break;var E=j.alternate;if(E===null){if(p=j.return,p!==null){d=p;continue}break}if(j.child===E.child){for(E=j.child;E;){if(E===d)return u(j),s;if(E===p)return u(j),c;E=E.sibling}throw Error(n(188))}if(d.return!==p.return)d=j,p=E;else{for(var D=!1,U=j.child;U;){if(U===d){D=!0,d=j,p=E;break}if(U===p){D=!0,p=j,d=E;break}U=U.sibling}if(!D){for(U=E.child;U;){if(U===d){D=!0,d=E,p=j;break}if(U===p){D=!0,p=E,d=j;break}U=U.sibling}if(!D)throw Error(n(189))}}if(d.alternate!==p)throw Error(n(190))}if(d.tag!==3)throw Error(n(188));return d.stateNode.current===d?s:c}function f(s){var c=s.tag;if(c===5||c===26||c===27||c===6)return s;for(s=s.child;s!==null;){if(c=f(s),c!==null)return c;s=s.sibling}return null}var h=Object.assign,x=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),y=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),N=Symbol.for("react.provider"),_=Symbol.for("react.consumer"),A=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),z=Symbol.for("react.lazy"),P=Symbol.for("react.activity"),Z=Symbol.for("react.memo_cache_sentinel"),q=Symbol.iterator;function B(s){return s===null||typeof s!="object"?null:(s=q&&s[q]||s["@@iterator"],typeof s=="function"?s:null)}var fe=Symbol.for("react.client.reference");function Ne(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===fe?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case w:return"Fragment";case S:return"Profiler";case b:return"StrictMode";case C:return"Suspense";case O:return"SuspenseList";case P:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case y:return"Portal";case A:return(s.displayName||"Context")+".Provider";case _:return(s._context.displayName||"Context")+".Consumer";case k:var c=s.render;return s=s.displayName,s||(s=c.displayName||c.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case T:return c=s.displayName||null,c!==null?c:Ne(s.type)||"Memo";case z:c=s._payload,s=s._init;try{return Ne(s(c))}catch{}}return null}var he=Array.isArray,K=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,H=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,be={pending:!1,data:null,method:null,action:null},te=[],I=-1;function se(s){return{current:s}}function R(s){0>I||(s.current=te[I],te[I]=null,I--)}function W(s,c){I++,te[I]=s.current,s.current=c}var Y=se(null),Q=se(null),L=se(null),ne=se(null);function ge(s,c){switch(W(L,c),W(Q,s),W(Y,null),c.nodeType){case 9:case 11:s=(s=c.documentElement)&&(s=s.namespaceURI)?kE(s):0;break;default:if(s=c.tagName,c=c.namespaceURI)c=kE(c),s=CE(c,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}R(Y),W(Y,s)}function G(){R(Y),R(Q),R(L)}function ue(s){s.memoizedState!==null&&W(ne,s);var c=Y.current,d=CE(c,s.type);c!==d&&(W(Q,s),W(Y,d))}function Se(s){Q.current===s&&(R(Y),R(Q)),ne.current===s&&(R(ne),nd._currentValue=be)}var M=Object.prototype.hasOwnProperty,Qe=e.unstable_scheduleCallback,xe=e.unstable_cancelCallback,me=e.unstable_shouldYield,ze=e.unstable_requestPaint,oe=e.unstable_now,ke=e.unstable_getCurrentPriorityLevel,Ge=e.unstable_ImmediatePriority,Fe=e.unstable_UserBlockingPriority,Be=e.unstable_NormalPriority,xt=e.unstable_LowPriority,Ze=e.unstable_IdlePriority,ht=e.log,At=e.unstable_setDisableYieldValue,De=null,Xe=null;function at(s){if(typeof ht=="function"&&At(s),Xe&&typeof Xe.setStrictMode=="function")try{Xe.setStrictMode(De,s)}catch{}}var rt=Math.clz32?Math.clz32:st,de=Math.log,Ce=Math.LN2;function st(s){return s>>>=0,s===0?32:31-(de(s)/Ce|0)|0}var nt=256,gt=4194304;function lr(s){var c=s&42;if(c!==0)return c;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Zt(s,c,d){var p=s.pendingLanes;if(p===0)return 0;var j=0,E=s.suspendedLanes,D=s.pingedLanes;s=s.warmLanes;var U=p&134217727;return U!==0?(p=U&~E,p!==0?j=lr(p):(D&=U,D!==0?j=lr(D):d||(d=U&~s,d!==0&&(j=lr(d))))):(U=p&~E,U!==0?j=lr(U):D!==0?j=lr(D):d||(d=p&~s,d!==0&&(j=lr(d)))),j===0?0:c!==0&&c!==j&&(c&E)===0&&(E=j&-j,d=c&-c,E>=d||E===32&&(d&4194048)!==0)?c:j}function Ue(s,c){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&c)===0}function et(s,c){switch(s){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ut(){var s=nt;return nt<<=1,(nt&4194048)===0&&(nt=256),s}function Bt(){var s=gt;return gt<<=1,(gt&62914560)===0&&(gt=4194304),s}function er(s){for(var c=[],d=0;31>d;d++)c.push(s);return c}function tr(s,c){s.pendingLanes|=c,c!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Me(s,c,d,p,j,E){var D=s.pendingLanes;s.pendingLanes=d,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=d,s.entangledLanes&=d,s.errorRecoveryDisabledLanes&=d,s.shellSuspendCounter=0;var U=s.entanglements,le=s.expirationTimes,Ae=s.hiddenUpdates;for(d=D&~d;0<d;){var Le=31-rt(d),qe=1<<Le;U[Le]=0,le[Le]=-1;var Te=Ae[Le];if(Te!==null)for(Ae[Le]=null,Le=0;Le<Te.length;Le++){var Oe=Te[Le];Oe!==null&&(Oe.lane&=-536870913)}d&=~qe}p!==0&&Ye(s,p,0),E!==0&&j===0&&s.tag!==0&&(s.suspendedLanes|=E&~(D&~c))}function Ye(s,c,d){s.pendingLanes|=c,s.suspendedLanes&=~c;var p=31-rt(c);s.entangledLanes|=c,s.entanglements[p]=s.entanglements[p]|1073741824|d&4194090}function it(s,c){var d=s.entangledLanes|=c;for(s=s.entanglements;d;){var p=31-rt(d),j=1<<p;j&c|s[p]&c&&(s[p]|=c),d&=~j}}function Ot(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function ha(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function zn(){var s=H.p;return s!==0?s:(s=window.event,s===void 0?32:XE(s.type))}function Ri(s,c){var d=H.p;try{return H.p=s,c()}finally{H.p=d}}var Qn=Math.random().toString(36).slice(2),Tr="__reactFiber$"+Qn,kr="__reactProps$"+Qn,$a="__reactContainer$"+Qn,Mi="__reactEvents$"+Qn,Ul="__reactListeners$"+Qn,F="__reactHandles$"+Qn,ee="__reactResources$"+Qn,V="__reactMarker$"+Qn;function X(s){delete s[Tr],delete s[kr],delete s[Mi],delete s[Ul],delete s[F]}function J(s){var c=s[Tr];if(c)return c;for(var d=s.parentNode;d;){if(c=d[$a]||d[Tr]){if(d=c.alternate,c.child!==null||d!==null&&d.child!==null)for(s=RE(s);s!==null;){if(d=s[Tr])return d;s=RE(s)}return c}s=d,d=s.parentNode}return null}function re(s){if(s=s[Tr]||s[$a]){var c=s.tag;if(c===5||c===6||c===13||c===26||c===27||c===3)return s}return null}function ie(s){var c=s.tag;if(c===5||c===26||c===27||c===6)return s.stateNode;throw Error(n(33))}function ve(s){var c=s[ee];return c||(c=s[ee]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function ce(s){s[V]=!0}var ye=new Set,je={};function Pe(s,c){Ie(s,c),Ie(s+"Capture",c)}function Ie(s,c){for(je[s]=c,s=0;s<c.length;s++)ye.add(c[s])}var Ke=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ve={},Je={};function ft(s){return M.call(Je,s)?!0:M.call(Ve,s)?!1:Ke.test(s)?Je[s]=!0:(Ve[s]=!0,!1)}function Nt(s,c,d){if(ft(c))if(d===null)s.removeAttribute(c);else{switch(typeof d){case"undefined":case"function":case"symbol":s.removeAttribute(c);return;case"boolean":var p=c.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){s.removeAttribute(c);return}}s.setAttribute(c,""+d)}}function jt(s,c,d){if(d===null)s.removeAttribute(c);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(c);return}s.setAttribute(c,""+d)}}function Rt(s,c,d,p){if(p===null)s.removeAttribute(d);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(d);return}s.setAttributeNS(c,d,""+p)}}var Mr,sn;function ln(s){if(Mr===void 0)try{throw Error()}catch(d){var c=d.stack.trim().match(/\n( *(at )?)/);Mr=c&&c[1]||"",sn=-1<d.stack.indexOf(`
    at`)?" (<anonymous>)":-1<d.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Mr+s+sn}var Dt=!1;function Vt(s,c){if(!s||Dt)return"";Dt=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(c){var qe=function(){throw Error()};if(Object.defineProperty(qe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(qe,[])}catch(Oe){var Te=Oe}Reflect.construct(s,[],qe)}else{try{qe.call()}catch(Oe){Te=Oe}s.call(qe.prototype)}}else{try{throw Error()}catch(Oe){Te=Oe}(qe=s())&&typeof qe.catch=="function"&&qe.catch(function(){})}}catch(Oe){if(Oe&&Te&&typeof Oe.stack=="string")return[Oe.stack,Te.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var j=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");j&&j.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var E=p.DetermineComponentFrameRoot(),D=E[0],U=E[1];if(D&&U){var le=D.split(`
`),Ae=U.split(`
`);for(j=p=0;p<le.length&&!le[p].includes("DetermineComponentFrameRoot");)p++;for(;j<Ae.length&&!Ae[j].includes("DetermineComponentFrameRoot");)j++;if(p===le.length||j===Ae.length)for(p=le.length-1,j=Ae.length-1;1<=p&&0<=j&&le[p]!==Ae[j];)j--;for(;1<=p&&0<=j;p--,j--)if(le[p]!==Ae[j]){if(p!==1||j!==1)do if(p--,j--,0>j||le[p]!==Ae[j]){var Le=`
`+le[p].replace(" at new "," at ");return s.displayName&&Le.includes("<anonymous>")&&(Le=Le.replace("<anonymous>",s.displayName)),Le}while(1<=p&&0<=j);break}}}finally{Dt=!1,Error.prepareStackTrace=d}return(d=s?s.displayName||s.name:"")?ln(d):""}function Yr(s){switch(s.tag){case 26:case 27:case 5:return ln(s.type);case 16:return ln("Lazy");case 13:return ln("Suspense");case 19:return ln("SuspenseList");case 0:case 15:return Vt(s.type,!1);case 11:return Vt(s.type.render,!1);case 1:return Vt(s.type,!0);case 31:return ln("Activity");default:return""}}function ae(s){try{var c="";do c+=Yr(s),s=s.return;while(s);return c}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}function He(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function tt(s){var c=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function mt(s){var c=tt(s)?"checked":"value",d=Object.getOwnPropertyDescriptor(s.constructor.prototype,c),p=""+s[c];if(!s.hasOwnProperty(c)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var j=d.get,E=d.set;return Object.defineProperty(s,c,{configurable:!0,get:function(){return j.call(this)},set:function(D){p=""+D,E.call(this,D)}}),Object.defineProperty(s,c,{enumerable:d.enumerable}),{getValue:function(){return p},setValue:function(D){p=""+D},stopTracking:function(){s._valueTracker=null,delete s[c]}}}}function vt(s){s._valueTracker||(s._valueTracker=mt(s))}function rr(s){if(!s)return!1;var c=s._valueTracker;if(!c)return!0;var d=c.getValue(),p="";return s&&(p=tt(s)?s.checked?"true":"false":s.value),s=p,s!==d?(c.setValue(s),!0):!1}function Kt(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Hn=/[\n"\\]/g;function Qt(s){return s.replace(Hn,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function Yp(s,c,d,p,j,E,D,U){s.name="",D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"?s.type=D:s.removeAttribute("type"),c!=null?D==="number"?(c===0&&s.value===""||s.value!=c)&&(s.value=""+He(c)):s.value!==""+He(c)&&(s.value=""+He(c)):D!=="submit"&&D!=="reset"||s.removeAttribute("value"),c!=null?Zp(s,D,He(c)):d!=null?Zp(s,D,He(d)):p!=null&&s.removeAttribute("value"),j==null&&E!=null&&(s.defaultChecked=!!E),j!=null&&(s.checked=j&&typeof j!="function"&&typeof j!="symbol"),U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"?s.name=""+He(U):s.removeAttribute("name")}function AS(s,c,d,p,j,E,D,U){if(E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(s.type=E),c!=null||d!=null){if(!(E!=="submit"&&E!=="reset"||c!=null))return;d=d!=null?""+He(d):"",c=c!=null?""+He(c):d,U||c===s.value||(s.value=c),s.defaultValue=c}p=p??j,p=typeof p!="function"&&typeof p!="symbol"&&!!p,s.checked=U?s.checked:!!p,s.defaultChecked=!!p,D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"&&(s.name=D)}function Zp(s,c,d){c==="number"&&Kt(s.ownerDocument)===s||s.defaultValue===""+d||(s.defaultValue=""+d)}function Ho(s,c,d,p){if(s=s.options,c){c={};for(var j=0;j<d.length;j++)c["$"+d[j]]=!0;for(d=0;d<s.length;d++)j=c.hasOwnProperty("$"+s[d].value),s[d].selected!==j&&(s[d].selected=j),j&&p&&(s[d].defaultSelected=!0)}else{for(d=""+He(d),c=null,j=0;j<s.length;j++){if(s[j].value===d){s[j].selected=!0,p&&(s[j].defaultSelected=!0);return}c!==null||s[j].disabled||(c=s[j])}c!==null&&(c.selected=!0)}}function _S(s,c,d){if(c!=null&&(c=""+He(c),c!==s.value&&(s.value=c),d==null)){s.defaultValue!==c&&(s.defaultValue=c);return}s.defaultValue=d!=null?""+He(d):""}function TS(s,c,d,p){if(c==null){if(p!=null){if(d!=null)throw Error(n(92));if(he(p)){if(1<p.length)throw Error(n(93));p=p[0]}d=p}d==null&&(d=""),c=d}d=He(c),s.defaultValue=d,p=s.textContent,p===d&&p!==""&&p!==null&&(s.value=p)}function qo(s,c){if(c){var d=s.firstChild;if(d&&d===s.lastChild&&d.nodeType===3){d.nodeValue=c;return}}s.textContent=c}var L8=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function kS(s,c,d){var p=c.indexOf("--")===0;d==null||typeof d=="boolean"||d===""?p?s.setProperty(c,""):c==="float"?s.cssFloat="":s[c]="":p?s.setProperty(c,d):typeof d!="number"||d===0||L8.has(c)?c==="float"?s.cssFloat=d:s[c]=(""+d).trim():s[c]=d+"px"}function CS(s,c,d){if(c!=null&&typeof c!="object")throw Error(n(62));if(s=s.style,d!=null){for(var p in d)!d.hasOwnProperty(p)||c!=null&&c.hasOwnProperty(p)||(p.indexOf("--")===0?s.setProperty(p,""):p==="float"?s.cssFloat="":s[p]="");for(var j in c)p=c[j],c.hasOwnProperty(j)&&d[j]!==p&&kS(s,j,p)}else for(var E in c)c.hasOwnProperty(E)&&kS(s,E,c[E])}function Qp(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var B8=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),U8=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Kf(s){return U8.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var Jp=null;function ex(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Vo=null,Ko=null;function OS(s){var c=re(s);if(c&&(s=c.stateNode)){var d=s[kr]||null;e:switch(s=c.stateNode,c.type){case"input":if(Yp(s,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name),c=d.name,d.type==="radio"&&c!=null){for(d=s;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll('input[name="'+Qt(""+c)+'"][type="radio"]'),c=0;c<d.length;c++){var p=d[c];if(p!==s&&p.form===s.form){var j=p[kr]||null;if(!j)throw Error(n(90));Yp(p,j.value,j.defaultValue,j.defaultValue,j.checked,j.defaultChecked,j.type,j.name)}}for(c=0;c<d.length;c++)p=d[c],p.form===s.form&&rr(p)}break e;case"textarea":_S(s,d.value,d.defaultValue);break e;case"select":c=d.value,c!=null&&Ho(s,!!d.multiple,c,!1)}}}var tx=!1;function DS(s,c,d){if(tx)return s(c,d);tx=!0;try{var p=s(c);return p}finally{if(tx=!1,(Vo!==null||Ko!==null)&&(O0(),Vo&&(c=Vo,s=Ko,Ko=Vo=null,OS(c),s)))for(c=0;c<s.length;c++)OS(s[c])}}function xu(s,c){var d=s.stateNode;if(d===null)return null;var p=d[kr]||null;if(p===null)return null;d=p[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(s=s.type,p=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!p;break e;default:s=!1}if(s)return null;if(d&&typeof d!="function")throw Error(n(231,c,typeof d));return d}var as=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),rx=!1;if(as)try{var vu={};Object.defineProperty(vu,"passive",{get:function(){rx=!0}}),window.addEventListener("test",vu,vu),window.removeEventListener("test",vu,vu)}catch{rx=!1}var Ks=null,nx=null,Gf=null;function PS(){if(Gf)return Gf;var s,c=nx,d=c.length,p,j="value"in Ks?Ks.value:Ks.textContent,E=j.length;for(s=0;s<d&&c[s]===j[s];s++);var D=d-s;for(p=1;p<=D&&c[d-p]===j[E-p];p++);return Gf=j.slice(s,1<p?1-p:void 0)}function Wf(s){var c=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&c===13&&(s=13)):s=c,s===10&&(s=13),32<=s||s===13?s:0}function Xf(){return!0}function RS(){return!1}function Jn(s){function c(d,p,j,E,D){this._reactName=d,this._targetInst=j,this.type=p,this.nativeEvent=E,this.target=D,this.currentTarget=null;for(var U in s)s.hasOwnProperty(U)&&(d=s[U],this[U]=d?d(E):E[U]);return this.isDefaultPrevented=(E.defaultPrevented!=null?E.defaultPrevented:E.returnValue===!1)?Xf:RS,this.isPropagationStopped=RS,this}return h(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=Xf)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=Xf)},persist:function(){},isPersistent:Xf}),c}var $l={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Yf=Jn($l),gu=h({},$l,{view:0,detail:0}),$8=Jn(gu),ax,ix,yu,Zf=h({},gu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lx,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==yu&&(yu&&s.type==="mousemove"?(ax=s.screenX-yu.screenX,ix=s.screenY-yu.screenY):ix=ax=0,yu=s),ax)},movementY:function(s){return"movementY"in s?s.movementY:ix}}),MS=Jn(Zf),z8=h({},Zf,{dataTransfer:0}),H8=Jn(z8),q8=h({},gu,{relatedTarget:0}),sx=Jn(q8),V8=h({},$l,{animationName:0,elapsedTime:0,pseudoElement:0}),K8=Jn(V8),G8=h({},$l,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),W8=Jn(G8),X8=h({},$l,{data:0}),FS=Jn(X8),Y8={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Z8={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Q8={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function J8(s){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(s):(s=Q8[s])?!!c[s]:!1}function lx(){return J8}var eM=h({},gu,{key:function(s){if(s.key){var c=Y8[s.key]||s.key;if(c!=="Unidentified")return c}return s.type==="keypress"?(s=Wf(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Z8[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lx,charCode:function(s){return s.type==="keypress"?Wf(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Wf(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),tM=Jn(eM),rM=h({},Zf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),IS=Jn(rM),nM=h({},gu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lx}),aM=Jn(nM),iM=h({},$l,{propertyName:0,elapsedTime:0,pseudoElement:0}),sM=Jn(iM),lM=h({},Zf,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),oM=Jn(lM),cM=h({},$l,{newState:0,oldState:0}),uM=Jn(cM),dM=[9,13,27,32],ox=as&&"CompositionEvent"in window,bu=null;as&&"documentMode"in document&&(bu=document.documentMode);var fM=as&&"TextEvent"in window&&!bu,LS=as&&(!ox||bu&&8<bu&&11>=bu),BS=" ",US=!1;function $S(s,c){switch(s){case"keyup":return dM.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zS(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Go=!1;function hM(s,c){switch(s){case"compositionend":return zS(c);case"keypress":return c.which!==32?null:(US=!0,BS);case"textInput":return s=c.data,s===BS&&US?null:s;default:return null}}function mM(s,c){if(Go)return s==="compositionend"||!ox&&$S(s,c)?(s=PS(),Gf=nx=Ks=null,Go=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return LS&&c.locale!=="ko"?null:c.data;default:return null}}var pM={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function HS(s){var c=s&&s.nodeName&&s.nodeName.toLowerCase();return c==="input"?!!pM[s.type]:c==="textarea"}function qS(s,c,d,p){Vo?Ko?Ko.push(p):Ko=[p]:Vo=p,c=I0(c,"onChange"),0<c.length&&(d=new Yf("onChange","change",null,d,p),s.push({event:d,listeners:c}))}var wu=null,Su=null;function xM(s){NE(s,0)}function Qf(s){var c=ie(s);if(rr(c))return s}function VS(s,c){if(s==="change")return c}var KS=!1;if(as){var cx;if(as){var ux="oninput"in document;if(!ux){var GS=document.createElement("div");GS.setAttribute("oninput","return;"),ux=typeof GS.oninput=="function"}cx=ux}else cx=!1;KS=cx&&(!document.documentMode||9<document.documentMode)}function WS(){wu&&(wu.detachEvent("onpropertychange",XS),Su=wu=null)}function XS(s){if(s.propertyName==="value"&&Qf(Su)){var c=[];qS(c,Su,s,ex(s)),DS(xM,c)}}function vM(s,c,d){s==="focusin"?(WS(),wu=c,Su=d,wu.attachEvent("onpropertychange",XS)):s==="focusout"&&WS()}function gM(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Qf(Su)}function yM(s,c){if(s==="click")return Qf(c)}function bM(s,c){if(s==="input"||s==="change")return Qf(c)}function wM(s,c){return s===c&&(s!==0||1/s===1/c)||s!==s&&c!==c}var ma=typeof Object.is=="function"?Object.is:wM;function ju(s,c){if(ma(s,c))return!0;if(typeof s!="object"||s===null||typeof c!="object"||c===null)return!1;var d=Object.keys(s),p=Object.keys(c);if(d.length!==p.length)return!1;for(p=0;p<d.length;p++){var j=d[p];if(!M.call(c,j)||!ma(s[j],c[j]))return!1}return!0}function YS(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function ZS(s,c){var d=YS(s);s=0;for(var p;d;){if(d.nodeType===3){if(p=s+d.textContent.length,s<=c&&p>=c)return{node:d,offset:c-s};s=p}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=YS(d)}}function QS(s,c){return s&&c?s===c?!0:s&&s.nodeType===3?!1:c&&c.nodeType===3?QS(s,c.parentNode):"contains"in s?s.contains(c):s.compareDocumentPosition?!!(s.compareDocumentPosition(c)&16):!1:!1}function JS(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var c=Kt(s.document);c instanceof s.HTMLIFrameElement;){try{var d=typeof c.contentWindow.location.href=="string"}catch{d=!1}if(d)s=c.contentWindow;else break;c=Kt(s.document)}return c}function dx(s){var c=s&&s.nodeName&&s.nodeName.toLowerCase();return c&&(c==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||c==="textarea"||s.contentEditable==="true")}var SM=as&&"documentMode"in document&&11>=document.documentMode,Wo=null,fx=null,Nu=null,hx=!1;function ej(s,c,d){var p=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;hx||Wo==null||Wo!==Kt(p)||(p=Wo,"selectionStart"in p&&dx(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),Nu&&ju(Nu,p)||(Nu=p,p=I0(fx,"onSelect"),0<p.length&&(c=new Yf("onSelect","select",null,c,d),s.push({event:c,listeners:p}),c.target=Wo)))}function zl(s,c){var d={};return d[s.toLowerCase()]=c.toLowerCase(),d["Webkit"+s]="webkit"+c,d["Moz"+s]="moz"+c,d}var Xo={animationend:zl("Animation","AnimationEnd"),animationiteration:zl("Animation","AnimationIteration"),animationstart:zl("Animation","AnimationStart"),transitionrun:zl("Transition","TransitionRun"),transitionstart:zl("Transition","TransitionStart"),transitioncancel:zl("Transition","TransitionCancel"),transitionend:zl("Transition","TransitionEnd")},mx={},tj={};as&&(tj=document.createElement("div").style,"AnimationEvent"in window||(delete Xo.animationend.animation,delete Xo.animationiteration.animation,delete Xo.animationstart.animation),"TransitionEvent"in window||delete Xo.transitionend.transition);function Hl(s){if(mx[s])return mx[s];if(!Xo[s])return s;var c=Xo[s],d;for(d in c)if(c.hasOwnProperty(d)&&d in tj)return mx[s]=c[d];return s}var rj=Hl("animationend"),nj=Hl("animationiteration"),aj=Hl("animationstart"),jM=Hl("transitionrun"),NM=Hl("transitionstart"),EM=Hl("transitioncancel"),ij=Hl("transitionend"),sj=new Map,px="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");px.push("scrollEnd");function vi(s,c){sj.set(s,c),Pe(c,[s])}var lj=new WeakMap;function za(s,c){if(typeof s=="object"&&s!==null){var d=lj.get(s);return d!==void 0?d:(c={value:s,source:c,stack:ae(c)},lj.set(s,c),c)}return{value:s,source:c,stack:ae(c)}}var Ha=[],Yo=0,xx=0;function Jf(){for(var s=Yo,c=xx=Yo=0;c<s;){var d=Ha[c];Ha[c++]=null;var p=Ha[c];Ha[c++]=null;var j=Ha[c];Ha[c++]=null;var E=Ha[c];if(Ha[c++]=null,p!==null&&j!==null){var D=p.pending;D===null?j.next=j:(j.next=D.next,D.next=j),p.pending=j}E!==0&&oj(d,j,E)}}function e0(s,c,d,p){Ha[Yo++]=s,Ha[Yo++]=c,Ha[Yo++]=d,Ha[Yo++]=p,xx|=p,s.lanes|=p,s=s.alternate,s!==null&&(s.lanes|=p)}function vx(s,c,d,p){return e0(s,c,d,p),t0(s)}function Zo(s,c){return e0(s,null,null,c),t0(s)}function oj(s,c,d){s.lanes|=d;var p=s.alternate;p!==null&&(p.lanes|=d);for(var j=!1,E=s.return;E!==null;)E.childLanes|=d,p=E.alternate,p!==null&&(p.childLanes|=d),E.tag===22&&(s=E.stateNode,s===null||s._visibility&1||(j=!0)),s=E,E=E.return;return s.tag===3?(E=s.stateNode,j&&c!==null&&(j=31-rt(d),s=E.hiddenUpdates,p=s[j],p===null?s[j]=[c]:p.push(c),c.lane=d|536870912),E):null}function t0(s){if(50<Xu)throw Xu=0,jv=null,Error(n(185));for(var c=s.return;c!==null;)s=c,c=s.return;return s.tag===3?s.stateNode:null}var Qo={};function AM(s,c,d,p){this.tag=s,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pa(s,c,d,p){return new AM(s,c,d,p)}function gx(s){return s=s.prototype,!(!s||!s.isReactComponent)}function is(s,c){var d=s.alternate;return d===null?(d=pa(s.tag,c,s.key,s.mode),d.elementType=s.elementType,d.type=s.type,d.stateNode=s.stateNode,d.alternate=s,s.alternate=d):(d.pendingProps=c,d.type=s.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=s.flags&65011712,d.childLanes=s.childLanes,d.lanes=s.lanes,d.child=s.child,d.memoizedProps=s.memoizedProps,d.memoizedState=s.memoizedState,d.updateQueue=s.updateQueue,c=s.dependencies,d.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},d.sibling=s.sibling,d.index=s.index,d.ref=s.ref,d.refCleanup=s.refCleanup,d}function cj(s,c){s.flags&=65011714;var d=s.alternate;return d===null?(s.childLanes=0,s.lanes=c,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=d.childLanes,s.lanes=d.lanes,s.child=d.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=d.memoizedProps,s.memoizedState=d.memoizedState,s.updateQueue=d.updateQueue,s.type=d.type,c=d.dependencies,s.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),s}function r0(s,c,d,p,j,E){var D=0;if(p=s,typeof s=="function")gx(s)&&(D=1);else if(typeof s=="string")D=TF(s,d,Y.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case P:return s=pa(31,d,c,j),s.elementType=P,s.lanes=E,s;case w:return ql(d.children,j,E,c);case b:D=8,j|=24;break;case S:return s=pa(12,d,c,j|2),s.elementType=S,s.lanes=E,s;case C:return s=pa(13,d,c,j),s.elementType=C,s.lanes=E,s;case O:return s=pa(19,d,c,j),s.elementType=O,s.lanes=E,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case N:case A:D=10;break e;case _:D=9;break e;case k:D=11;break e;case T:D=14;break e;case z:D=16,p=null;break e}D=29,d=Error(n(130,s===null?"null":typeof s,"")),p=null}return c=pa(D,d,c,j),c.elementType=s,c.type=p,c.lanes=E,c}function ql(s,c,d,p){return s=pa(7,s,p,c),s.lanes=d,s}function yx(s,c,d){return s=pa(6,s,null,c),s.lanes=d,s}function bx(s,c,d){return c=pa(4,s.children!==null?s.children:[],s.key,c),c.lanes=d,c.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},c}var Jo=[],ec=0,n0=null,a0=0,qa=[],Va=0,Vl=null,ss=1,ls="";function Kl(s,c){Jo[ec++]=a0,Jo[ec++]=n0,n0=s,a0=c}function uj(s,c,d){qa[Va++]=ss,qa[Va++]=ls,qa[Va++]=Vl,Vl=s;var p=ss;s=ls;var j=32-rt(p)-1;p&=~(1<<j),d+=1;var E=32-rt(c)+j;if(30<E){var D=j-j%5;E=(p&(1<<D)-1).toString(32),p>>=D,j-=D,ss=1<<32-rt(c)+j|d<<j|p,ls=E+s}else ss=1<<E|d<<j|p,ls=s}function wx(s){s.return!==null&&(Kl(s,1),uj(s,1,0))}function Sx(s){for(;s===n0;)n0=Jo[--ec],Jo[ec]=null,a0=Jo[--ec],Jo[ec]=null;for(;s===Vl;)Vl=qa[--Va],qa[Va]=null,ls=qa[--Va],qa[Va]=null,ss=qa[--Va],qa[Va]=null}var qn=null,Cr=null,Yt=!1,Gl=null,Fi=!1,jx=Error(n(519));function Wl(s){var c=Error(n(418,""));throw _u(za(c,s)),jx}function dj(s){var c=s.stateNode,d=s.type,p=s.memoizedProps;switch(c[Tr]=s,c[kr]=p,d){case"dialog":Lt("cancel",c),Lt("close",c);break;case"iframe":case"object":case"embed":Lt("load",c);break;case"video":case"audio":for(d=0;d<Zu.length;d++)Lt(Zu[d],c);break;case"source":Lt("error",c);break;case"img":case"image":case"link":Lt("error",c),Lt("load",c);break;case"details":Lt("toggle",c);break;case"input":Lt("invalid",c),AS(c,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0),vt(c);break;case"select":Lt("invalid",c);break;case"textarea":Lt("invalid",c),TS(c,p.value,p.defaultValue,p.children),vt(c)}d=p.children,typeof d!="string"&&typeof d!="number"&&typeof d!="bigint"||c.textContent===""+d||p.suppressHydrationWarning===!0||TE(c.textContent,d)?(p.popover!=null&&(Lt("beforetoggle",c),Lt("toggle",c)),p.onScroll!=null&&Lt("scroll",c),p.onScrollEnd!=null&&Lt("scrollend",c),p.onClick!=null&&(c.onclick=L0),c=!0):c=!1,c||Wl(s)}function fj(s){for(qn=s.return;qn;)switch(qn.tag){case 5:case 13:Fi=!1;return;case 27:case 3:Fi=!0;return;default:qn=qn.return}}function Eu(s){if(s!==qn)return!1;if(!Yt)return fj(s),Yt=!0,!1;var c=s.tag,d;if((d=c!==3&&c!==27)&&((d=c===5)&&(d=s.type,d=!(d!=="form"&&d!=="button")||Bv(s.type,s.memoizedProps)),d=!d),d&&Cr&&Wl(s),fj(s),c===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));e:{for(s=s.nextSibling,c=0;s;){if(s.nodeType===8)if(d=s.data,d==="/$"){if(c===0){Cr=yi(s.nextSibling);break e}c--}else d!=="$"&&d!=="$!"&&d!=="$?"||c++;s=s.nextSibling}Cr=null}}else c===27?(c=Cr,ol(s.type)?(s=Hv,Hv=null,Cr=s):Cr=c):Cr=qn?yi(s.stateNode.nextSibling):null;return!0}function Au(){Cr=qn=null,Yt=!1}function hj(){var s=Gl;return s!==null&&(ra===null?ra=s:ra.push.apply(ra,s),Gl=null),s}function _u(s){Gl===null?Gl=[s]:Gl.push(s)}var Nx=se(null),Xl=null,os=null;function Gs(s,c,d){W(Nx,c._currentValue),c._currentValue=d}function cs(s){s._currentValue=Nx.current,R(Nx)}function Ex(s,c,d){for(;s!==null;){var p=s.alternate;if((s.childLanes&c)!==c?(s.childLanes|=c,p!==null&&(p.childLanes|=c)):p!==null&&(p.childLanes&c)!==c&&(p.childLanes|=c),s===d)break;s=s.return}}function Ax(s,c,d,p){var j=s.child;for(j!==null&&(j.return=s);j!==null;){var E=j.dependencies;if(E!==null){var D=j.child;E=E.firstContext;e:for(;E!==null;){var U=E;E=j;for(var le=0;le<c.length;le++)if(U.context===c[le]){E.lanes|=d,U=E.alternate,U!==null&&(U.lanes|=d),Ex(E.return,d,s),p||(D=null);break e}E=U.next}}else if(j.tag===18){if(D=j.return,D===null)throw Error(n(341));D.lanes|=d,E=D.alternate,E!==null&&(E.lanes|=d),Ex(D,d,s),D=null}else D=j.child;if(D!==null)D.return=j;else for(D=j;D!==null;){if(D===s){D=null;break}if(j=D.sibling,j!==null){j.return=D.return,D=j;break}D=D.return}j=D}}function Tu(s,c,d,p){s=null;for(var j=c,E=!1;j!==null;){if(!E){if((j.flags&524288)!==0)E=!0;else if((j.flags&262144)!==0)break}if(j.tag===10){var D=j.alternate;if(D===null)throw Error(n(387));if(D=D.memoizedProps,D!==null){var U=j.type;ma(j.pendingProps.value,D.value)||(s!==null?s.push(U):s=[U])}}else if(j===ne.current){if(D=j.alternate,D===null)throw Error(n(387));D.memoizedState.memoizedState!==j.memoizedState.memoizedState&&(s!==null?s.push(nd):s=[nd])}j=j.return}s!==null&&Ax(c,s,d,p),c.flags|=262144}function i0(s){for(s=s.firstContext;s!==null;){if(!ma(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Yl(s){Xl=s,os=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function _n(s){return mj(Xl,s)}function s0(s,c){return Xl===null&&Yl(s),mj(s,c)}function mj(s,c){var d=c._currentValue;if(c={context:c,memoizedValue:d,next:null},os===null){if(s===null)throw Error(n(308));os=c,s.dependencies={lanes:0,firstContext:c},s.flags|=524288}else os=os.next=c;return d}var _M=typeof AbortController<"u"?AbortController:function(){var s=[],c=this.signal={aborted:!1,addEventListener:function(d,p){s.push(p)}};this.abort=function(){c.aborted=!0,s.forEach(function(d){return d()})}},TM=e.unstable_scheduleCallback,kM=e.unstable_NormalPriority,Zr={$$typeof:A,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function _x(){return{controller:new _M,data:new Map,refCount:0}}function ku(s){s.refCount--,s.refCount===0&&TM(kM,function(){s.controller.abort()})}var Cu=null,Tx=0,tc=0,rc=null;function CM(s,c){if(Cu===null){var d=Cu=[];Tx=0,tc=Cv(),rc={status:"pending",value:void 0,then:function(p){d.push(p)}}}return Tx++,c.then(pj,pj),c}function pj(){if(--Tx===0&&Cu!==null){rc!==null&&(rc.status="fulfilled");var s=Cu;Cu=null,tc=0,rc=null;for(var c=0;c<s.length;c++)(0,s[c])()}}function OM(s,c){var d=[],p={status:"pending",value:null,reason:null,then:function(j){d.push(j)}};return s.then(function(){p.status="fulfilled",p.value=c;for(var j=0;j<d.length;j++)(0,d[j])(c)},function(j){for(p.status="rejected",p.reason=j,j=0;j<d.length;j++)(0,d[j])(void 0)}),p}var xj=K.S;K.S=function(s,c){typeof c=="object"&&c!==null&&typeof c.then=="function"&&CM(s,c),xj!==null&&xj(s,c)};var Zl=se(null);function kx(){var s=Zl.current;return s!==null?s:pr.pooledCache}function l0(s,c){c===null?W(Zl,Zl.current):W(Zl,c.pool)}function vj(){var s=kx();return s===null?null:{parent:Zr._currentValue,pool:s}}var Ou=Error(n(460)),gj=Error(n(474)),o0=Error(n(542)),Cx={then:function(){}};function yj(s){return s=s.status,s==="fulfilled"||s==="rejected"}function c0(){}function bj(s,c,d){switch(d=s[d],d===void 0?s.push(c):d!==c&&(c.then(c0,c0),c=d),c.status){case"fulfilled":return c.value;case"rejected":throw s=c.reason,Sj(s),s;default:if(typeof c.status=="string")c.then(c0,c0);else{if(s=pr,s!==null&&100<s.shellSuspendCounter)throw Error(n(482));s=c,s.status="pending",s.then(function(p){if(c.status==="pending"){var j=c;j.status="fulfilled",j.value=p}},function(p){if(c.status==="pending"){var j=c;j.status="rejected",j.reason=p}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw s=c.reason,Sj(s),s}throw Du=c,Ou}}var Du=null;function wj(){if(Du===null)throw Error(n(459));var s=Du;return Du=null,s}function Sj(s){if(s===Ou||s===o0)throw Error(n(483))}var Ws=!1;function Ox(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Dx(s,c){s=s.updateQueue,c.updateQueue===s&&(c.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Xs(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Ys(s,c,d){var p=s.updateQueue;if(p===null)return null;if(p=p.shared,(nr&2)!==0){var j=p.pending;return j===null?c.next=c:(c.next=j.next,j.next=c),p.pending=c,c=t0(s),oj(s,null,d),c}return e0(s,p,c,d),t0(s)}function Pu(s,c,d){if(c=c.updateQueue,c!==null&&(c=c.shared,(d&4194048)!==0)){var p=c.lanes;p&=s.pendingLanes,d|=p,c.lanes=d,it(s,d)}}function Px(s,c){var d=s.updateQueue,p=s.alternate;if(p!==null&&(p=p.updateQueue,d===p)){var j=null,E=null;if(d=d.firstBaseUpdate,d!==null){do{var D={lane:d.lane,tag:d.tag,payload:d.payload,callback:null,next:null};E===null?j=E=D:E=E.next=D,d=d.next}while(d!==null);E===null?j=E=c:E=E.next=c}else j=E=c;d={baseState:p.baseState,firstBaseUpdate:j,lastBaseUpdate:E,shared:p.shared,callbacks:p.callbacks},s.updateQueue=d;return}s=d.lastBaseUpdate,s===null?d.firstBaseUpdate=c:s.next=c,d.lastBaseUpdate=c}var Rx=!1;function Ru(){if(Rx){var s=rc;if(s!==null)throw s}}function Mu(s,c,d,p){Rx=!1;var j=s.updateQueue;Ws=!1;var E=j.firstBaseUpdate,D=j.lastBaseUpdate,U=j.shared.pending;if(U!==null){j.shared.pending=null;var le=U,Ae=le.next;le.next=null,D===null?E=Ae:D.next=Ae,D=le;var Le=s.alternate;Le!==null&&(Le=Le.updateQueue,U=Le.lastBaseUpdate,U!==D&&(U===null?Le.firstBaseUpdate=Ae:U.next=Ae,Le.lastBaseUpdate=le))}if(E!==null){var qe=j.baseState;D=0,Le=Ae=le=null,U=E;do{var Te=U.lane&-536870913,Oe=Te!==U.lane;if(Oe?(zt&Te)===Te:(p&Te)===Te){Te!==0&&Te===tc&&(Rx=!0),Le!==null&&(Le=Le.next={lane:0,tag:U.tag,payload:U.payload,callback:null,next:null});e:{var wt=s,yt=U;Te=c;var ur=d;switch(yt.tag){case 1:if(wt=yt.payload,typeof wt=="function"){qe=wt.call(ur,qe,Te);break e}qe=wt;break e;case 3:wt.flags=wt.flags&-65537|128;case 0:if(wt=yt.payload,Te=typeof wt=="function"?wt.call(ur,qe,Te):wt,Te==null)break e;qe=h({},qe,Te);break e;case 2:Ws=!0}}Te=U.callback,Te!==null&&(s.flags|=64,Oe&&(s.flags|=8192),Oe=j.callbacks,Oe===null?j.callbacks=[Te]:Oe.push(Te))}else Oe={lane:Te,tag:U.tag,payload:U.payload,callback:U.callback,next:null},Le===null?(Ae=Le=Oe,le=qe):Le=Le.next=Oe,D|=Te;if(U=U.next,U===null){if(U=j.shared.pending,U===null)break;Oe=U,U=Oe.next,Oe.next=null,j.lastBaseUpdate=Oe,j.shared.pending=null}}while(!0);Le===null&&(le=qe),j.baseState=le,j.firstBaseUpdate=Ae,j.lastBaseUpdate=Le,E===null&&(j.shared.lanes=0),al|=D,s.lanes=D,s.memoizedState=qe}}function jj(s,c){if(typeof s!="function")throw Error(n(191,s));s.call(c)}function Nj(s,c){var d=s.callbacks;if(d!==null)for(s.callbacks=null,s=0;s<d.length;s++)jj(d[s],c)}var nc=se(null),u0=se(0);function Ej(s,c){s=xs,W(u0,s),W(nc,c),xs=s|c.baseLanes}function Mx(){W(u0,xs),W(nc,nc.current)}function Fx(){xs=u0.current,R(nc),R(u0)}var Zs=0,Pt=null,or=null,Ur=null,d0=!1,ac=!1,Ql=!1,f0=0,Fu=0,ic=null,DM=0;function Fr(){throw Error(n(321))}function Ix(s,c){if(c===null)return!1;for(var d=0;d<c.length&&d<s.length;d++)if(!ma(s[d],c[d]))return!1;return!0}function Lx(s,c,d,p,j,E){return Zs=E,Pt=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,K.H=s===null||s.memoizedState===null?oN:cN,Ql=!1,E=d(p,j),Ql=!1,ac&&(E=_j(c,d,p,j)),Aj(s),E}function Aj(s){K.H=g0;var c=or!==null&&or.next!==null;if(Zs=0,Ur=or=Pt=null,d0=!1,Fu=0,ic=null,c)throw Error(n(300));s===null||on||(s=s.dependencies,s!==null&&i0(s)&&(on=!0))}function _j(s,c,d,p){Pt=s;var j=0;do{if(ac&&(ic=null),Fu=0,ac=!1,25<=j)throw Error(n(301));if(j+=1,Ur=or=null,s.updateQueue!=null){var E=s.updateQueue;E.lastEffect=null,E.events=null,E.stores=null,E.memoCache!=null&&(E.memoCache.index=0)}K.H=BM,E=c(d,p)}while(ac);return E}function PM(){var s=K.H,c=s.useState()[0];return c=typeof c.then=="function"?Iu(c):c,s=s.useState()[0],(or!==null?or.memoizedState:null)!==s&&(Pt.flags|=1024),c}function Bx(){var s=f0!==0;return f0=0,s}function Ux(s,c,d){c.updateQueue=s.updateQueue,c.flags&=-2053,s.lanes&=~d}function $x(s){if(d0){for(s=s.memoizedState;s!==null;){var c=s.queue;c!==null&&(c.pending=null),s=s.next}d0=!1}Zs=0,Ur=or=Pt=null,ac=!1,Fu=f0=0,ic=null}function ea(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ur===null?Pt.memoizedState=Ur=s:Ur=Ur.next=s,Ur}function $r(){if(or===null){var s=Pt.alternate;s=s!==null?s.memoizedState:null}else s=or.next;var c=Ur===null?Pt.memoizedState:Ur.next;if(c!==null)Ur=c,or=s;else{if(s===null)throw Pt.alternate===null?Error(n(467)):Error(n(310));or=s,s={memoizedState:or.memoizedState,baseState:or.baseState,baseQueue:or.baseQueue,queue:or.queue,next:null},Ur===null?Pt.memoizedState=Ur=s:Ur=Ur.next=s}return Ur}function zx(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Iu(s){var c=Fu;return Fu+=1,ic===null&&(ic=[]),s=bj(ic,s,c),c=Pt,(Ur===null?c.memoizedState:Ur.next)===null&&(c=c.alternate,K.H=c===null||c.memoizedState===null?oN:cN),s}function h0(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Iu(s);if(s.$$typeof===A)return _n(s)}throw Error(n(438,String(s)))}function Hx(s){var c=null,d=Pt.updateQueue;if(d!==null&&(c=d.memoCache),c==null){var p=Pt.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(c={data:p.data.map(function(j){return j.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),d===null&&(d=zx(),Pt.updateQueue=d),d.memoCache=c,d=c.data[c.index],d===void 0)for(d=c.data[c.index]=Array(s),p=0;p<s;p++)d[p]=Z;return c.index++,d}function us(s,c){return typeof c=="function"?c(s):c}function m0(s){var c=$r();return qx(c,or,s)}function qx(s,c,d){var p=s.queue;if(p===null)throw Error(n(311));p.lastRenderedReducer=d;var j=s.baseQueue,E=p.pending;if(E!==null){if(j!==null){var D=j.next;j.next=E.next,E.next=D}c.baseQueue=j=E,p.pending=null}if(E=s.baseState,j===null)s.memoizedState=E;else{c=j.next;var U=D=null,le=null,Ae=c,Le=!1;do{var qe=Ae.lane&-536870913;if(qe!==Ae.lane?(zt&qe)===qe:(Zs&qe)===qe){var Te=Ae.revertLane;if(Te===0)le!==null&&(le=le.next={lane:0,revertLane:0,action:Ae.action,hasEagerState:Ae.hasEagerState,eagerState:Ae.eagerState,next:null}),qe===tc&&(Le=!0);else if((Zs&Te)===Te){Ae=Ae.next,Te===tc&&(Le=!0);continue}else qe={lane:0,revertLane:Ae.revertLane,action:Ae.action,hasEagerState:Ae.hasEagerState,eagerState:Ae.eagerState,next:null},le===null?(U=le=qe,D=E):le=le.next=qe,Pt.lanes|=Te,al|=Te;qe=Ae.action,Ql&&d(E,qe),E=Ae.hasEagerState?Ae.eagerState:d(E,qe)}else Te={lane:qe,revertLane:Ae.revertLane,action:Ae.action,hasEagerState:Ae.hasEagerState,eagerState:Ae.eagerState,next:null},le===null?(U=le=Te,D=E):le=le.next=Te,Pt.lanes|=qe,al|=qe;Ae=Ae.next}while(Ae!==null&&Ae!==c);if(le===null?D=E:le.next=U,!ma(E,s.memoizedState)&&(on=!0,Le&&(d=rc,d!==null)))throw d;s.memoizedState=E,s.baseState=D,s.baseQueue=le,p.lastRenderedState=E}return j===null&&(p.lanes=0),[s.memoizedState,p.dispatch]}function Vx(s){var c=$r(),d=c.queue;if(d===null)throw Error(n(311));d.lastRenderedReducer=s;var p=d.dispatch,j=d.pending,E=c.memoizedState;if(j!==null){d.pending=null;var D=j=j.next;do E=s(E,D.action),D=D.next;while(D!==j);ma(E,c.memoizedState)||(on=!0),c.memoizedState=E,c.baseQueue===null&&(c.baseState=E),d.lastRenderedState=E}return[E,p]}function Tj(s,c,d){var p=Pt,j=$r(),E=Yt;if(E){if(d===void 0)throw Error(n(407));d=d()}else d=c();var D=!ma((or||j).memoizedState,d);D&&(j.memoizedState=d,on=!0),j=j.queue;var U=Oj.bind(null,p,j,s);if(Lu(2048,8,U,[s]),j.getSnapshot!==c||D||Ur!==null&&Ur.memoizedState.tag&1){if(p.flags|=2048,sc(9,p0(),Cj.bind(null,p,j,d,c),null),pr===null)throw Error(n(349));E||(Zs&124)!==0||kj(p,c,d)}return d}function kj(s,c,d){s.flags|=16384,s={getSnapshot:c,value:d},c=Pt.updateQueue,c===null?(c=zx(),Pt.updateQueue=c,c.stores=[s]):(d=c.stores,d===null?c.stores=[s]:d.push(s))}function Cj(s,c,d,p){c.value=d,c.getSnapshot=p,Dj(c)&&Pj(s)}function Oj(s,c,d){return d(function(){Dj(c)&&Pj(s)})}function Dj(s){var c=s.getSnapshot;s=s.value;try{var d=c();return!ma(s,d)}catch{return!0}}function Pj(s){var c=Zo(s,2);c!==null&&ba(c,s,2)}function Kx(s){var c=ea();if(typeof s=="function"){var d=s;if(s=d(),Ql){at(!0);try{d()}finally{at(!1)}}}return c.memoizedState=c.baseState=s,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:us,lastRenderedState:s},c}function Rj(s,c,d,p){return s.baseState=d,qx(s,or,typeof p=="function"?p:us)}function RM(s,c,d,p,j){if(v0(s))throw Error(n(485));if(s=c.action,s!==null){var E={payload:j,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(D){E.listeners.push(D)}};K.T!==null?d(!0):E.isTransition=!1,p(E),d=c.pending,d===null?(E.next=c.pending=E,Mj(c,E)):(E.next=d.next,c.pending=d.next=E)}}function Mj(s,c){var d=c.action,p=c.payload,j=s.state;if(c.isTransition){var E=K.T,D={};K.T=D;try{var U=d(j,p),le=K.S;le!==null&&le(D,U),Fj(s,c,U)}catch(Ae){Gx(s,c,Ae)}finally{K.T=E}}else try{E=d(j,p),Fj(s,c,E)}catch(Ae){Gx(s,c,Ae)}}function Fj(s,c,d){d!==null&&typeof d=="object"&&typeof d.then=="function"?d.then(function(p){Ij(s,c,p)},function(p){return Gx(s,c,p)}):Ij(s,c,d)}function Ij(s,c,d){c.status="fulfilled",c.value=d,Lj(c),s.state=d,c=s.pending,c!==null&&(d=c.next,d===c?s.pending=null:(d=d.next,c.next=d,Mj(s,d)))}function Gx(s,c,d){var p=s.pending;if(s.pending=null,p!==null){p=p.next;do c.status="rejected",c.reason=d,Lj(c),c=c.next;while(c!==p)}s.action=null}function Lj(s){s=s.listeners;for(var c=0;c<s.length;c++)(0,s[c])()}function Bj(s,c){return c}function Uj(s,c){if(Yt){var d=pr.formState;if(d!==null){e:{var p=Pt;if(Yt){if(Cr){t:{for(var j=Cr,E=Fi;j.nodeType!==8;){if(!E){j=null;break t}if(j=yi(j.nextSibling),j===null){j=null;break t}}E=j.data,j=E==="F!"||E==="F"?j:null}if(j){Cr=yi(j.nextSibling),p=j.data==="F!";break e}}Wl(p)}p=!1}p&&(c=d[0])}}return d=ea(),d.memoizedState=d.baseState=c,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Bj,lastRenderedState:c},d.queue=p,d=iN.bind(null,Pt,p),p.dispatch=d,p=Kx(!1),E=Qx.bind(null,Pt,!1,p.queue),p=ea(),j={state:c,dispatch:null,action:s,pending:null},p.queue=j,d=RM.bind(null,Pt,j,E,d),j.dispatch=d,p.memoizedState=s,[c,d,!1]}function $j(s){var c=$r();return zj(c,or,s)}function zj(s,c,d){if(c=qx(s,c,Bj)[0],s=m0(us)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var p=Iu(c)}catch(D){throw D===Ou?o0:D}else p=c;c=$r();var j=c.queue,E=j.dispatch;return d!==c.memoizedState&&(Pt.flags|=2048,sc(9,p0(),MM.bind(null,j,d),null)),[p,E,s]}function MM(s,c){s.action=c}function Hj(s){var c=$r(),d=or;if(d!==null)return zj(c,d,s);$r(),c=c.memoizedState,d=$r();var p=d.queue.dispatch;return d.memoizedState=s,[c,p,!1]}function sc(s,c,d,p){return s={tag:s,create:d,deps:p,inst:c,next:null},c=Pt.updateQueue,c===null&&(c=zx(),Pt.updateQueue=c),d=c.lastEffect,d===null?c.lastEffect=s.next=s:(p=d.next,d.next=s,s.next=p,c.lastEffect=s),s}function p0(){return{destroy:void 0,resource:void 0}}function qj(){return $r().memoizedState}function x0(s,c,d,p){var j=ea();p=p===void 0?null:p,Pt.flags|=s,j.memoizedState=sc(1|c,p0(),d,p)}function Lu(s,c,d,p){var j=$r();p=p===void 0?null:p;var E=j.memoizedState.inst;or!==null&&p!==null&&Ix(p,or.memoizedState.deps)?j.memoizedState=sc(c,E,d,p):(Pt.flags|=s,j.memoizedState=sc(1|c,E,d,p))}function Vj(s,c){x0(8390656,8,s,c)}function Kj(s,c){Lu(2048,8,s,c)}function Gj(s,c){return Lu(4,2,s,c)}function Wj(s,c){return Lu(4,4,s,c)}function Xj(s,c){if(typeof c=="function"){s=s();var d=c(s);return function(){typeof d=="function"?d():c(null)}}if(c!=null)return s=s(),c.current=s,function(){c.current=null}}function Yj(s,c,d){d=d!=null?d.concat([s]):null,Lu(4,4,Xj.bind(null,c,s),d)}function Wx(){}function Zj(s,c){var d=$r();c=c===void 0?null:c;var p=d.memoizedState;return c!==null&&Ix(c,p[1])?p[0]:(d.memoizedState=[s,c],s)}function Qj(s,c){var d=$r();c=c===void 0?null:c;var p=d.memoizedState;if(c!==null&&Ix(c,p[1]))return p[0];if(p=s(),Ql){at(!0);try{s()}finally{at(!1)}}return d.memoizedState=[p,c],p}function Xx(s,c,d){return d===void 0||(Zs&1073741824)!==0?s.memoizedState=c:(s.memoizedState=d,s=tE(),Pt.lanes|=s,al|=s,d)}function Jj(s,c,d,p){return ma(d,c)?d:nc.current!==null?(s=Xx(s,d,p),ma(s,c)||(on=!0),s):(Zs&42)===0?(on=!0,s.memoizedState=d):(s=tE(),Pt.lanes|=s,al|=s,c)}function eN(s,c,d,p,j){var E=H.p;H.p=E!==0&&8>E?E:8;var D=K.T,U={};K.T=U,Qx(s,!1,c,d);try{var le=j(),Ae=K.S;if(Ae!==null&&Ae(U,le),le!==null&&typeof le=="object"&&typeof le.then=="function"){var Le=OM(le,p);Bu(s,c,Le,ya(s))}else Bu(s,c,p,ya(s))}catch(qe){Bu(s,c,{then:function(){},status:"rejected",reason:qe},ya())}finally{H.p=E,K.T=D}}function FM(){}function Yx(s,c,d,p){if(s.tag!==5)throw Error(n(476));var j=tN(s).queue;eN(s,j,c,be,d===null?FM:function(){return rN(s),d(p)})}function tN(s){var c=s.memoizedState;if(c!==null)return c;c={memoizedState:be,baseState:be,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:us,lastRenderedState:be},next:null};var d={};return c.next={memoizedState:d,baseState:d,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:us,lastRenderedState:d},next:null},s.memoizedState=c,s=s.alternate,s!==null&&(s.memoizedState=c),c}function rN(s){var c=tN(s).next.queue;Bu(s,c,{},ya())}function Zx(){return _n(nd)}function nN(){return $r().memoizedState}function aN(){return $r().memoizedState}function IM(s){for(var c=s.return;c!==null;){switch(c.tag){case 24:case 3:var d=ya();s=Xs(d);var p=Ys(c,s,d);p!==null&&(ba(p,c,d),Pu(p,c,d)),c={cache:_x()},s.payload=c;return}c=c.return}}function LM(s,c,d){var p=ya();d={lane:p,revertLane:0,action:d,hasEagerState:!1,eagerState:null,next:null},v0(s)?sN(c,d):(d=vx(s,c,d,p),d!==null&&(ba(d,s,p),lN(d,c,p)))}function iN(s,c,d){var p=ya();Bu(s,c,d,p)}function Bu(s,c,d,p){var j={lane:p,revertLane:0,action:d,hasEagerState:!1,eagerState:null,next:null};if(v0(s))sN(c,j);else{var E=s.alternate;if(s.lanes===0&&(E===null||E.lanes===0)&&(E=c.lastRenderedReducer,E!==null))try{var D=c.lastRenderedState,U=E(D,d);if(j.hasEagerState=!0,j.eagerState=U,ma(U,D))return e0(s,c,j,0),pr===null&&Jf(),!1}catch{}finally{}if(d=vx(s,c,j,p),d!==null)return ba(d,s,p),lN(d,c,p),!0}return!1}function Qx(s,c,d,p){if(p={lane:2,revertLane:Cv(),action:p,hasEagerState:!1,eagerState:null,next:null},v0(s)){if(c)throw Error(n(479))}else c=vx(s,d,p,2),c!==null&&ba(c,s,2)}function v0(s){var c=s.alternate;return s===Pt||c!==null&&c===Pt}function sN(s,c){ac=d0=!0;var d=s.pending;d===null?c.next=c:(c.next=d.next,d.next=c),s.pending=c}function lN(s,c,d){if((d&4194048)!==0){var p=c.lanes;p&=s.pendingLanes,d|=p,c.lanes=d,it(s,d)}}var g0={readContext:_n,use:h0,useCallback:Fr,useContext:Fr,useEffect:Fr,useImperativeHandle:Fr,useLayoutEffect:Fr,useInsertionEffect:Fr,useMemo:Fr,useReducer:Fr,useRef:Fr,useState:Fr,useDebugValue:Fr,useDeferredValue:Fr,useTransition:Fr,useSyncExternalStore:Fr,useId:Fr,useHostTransitionStatus:Fr,useFormState:Fr,useActionState:Fr,useOptimistic:Fr,useMemoCache:Fr,useCacheRefresh:Fr},oN={readContext:_n,use:h0,useCallback:function(s,c){return ea().memoizedState=[s,c===void 0?null:c],s},useContext:_n,useEffect:Vj,useImperativeHandle:function(s,c,d){d=d!=null?d.concat([s]):null,x0(4194308,4,Xj.bind(null,c,s),d)},useLayoutEffect:function(s,c){return x0(4194308,4,s,c)},useInsertionEffect:function(s,c){x0(4,2,s,c)},useMemo:function(s,c){var d=ea();c=c===void 0?null:c;var p=s();if(Ql){at(!0);try{s()}finally{at(!1)}}return d.memoizedState=[p,c],p},useReducer:function(s,c,d){var p=ea();if(d!==void 0){var j=d(c);if(Ql){at(!0);try{d(c)}finally{at(!1)}}}else j=c;return p.memoizedState=p.baseState=j,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:j},p.queue=s,s=s.dispatch=LM.bind(null,Pt,s),[p.memoizedState,s]},useRef:function(s){var c=ea();return s={current:s},c.memoizedState=s},useState:function(s){s=Kx(s);var c=s.queue,d=iN.bind(null,Pt,c);return c.dispatch=d,[s.memoizedState,d]},useDebugValue:Wx,useDeferredValue:function(s,c){var d=ea();return Xx(d,s,c)},useTransition:function(){var s=Kx(!1);return s=eN.bind(null,Pt,s.queue,!0,!1),ea().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,c,d){var p=Pt,j=ea();if(Yt){if(d===void 0)throw Error(n(407));d=d()}else{if(d=c(),pr===null)throw Error(n(349));(zt&124)!==0||kj(p,c,d)}j.memoizedState=d;var E={value:d,getSnapshot:c};return j.queue=E,Vj(Oj.bind(null,p,E,s),[s]),p.flags|=2048,sc(9,p0(),Cj.bind(null,p,E,d,c),null),d},useId:function(){var s=ea(),c=pr.identifierPrefix;if(Yt){var d=ls,p=ss;d=(p&~(1<<32-rt(p)-1)).toString(32)+d,c=""+c+"R"+d,d=f0++,0<d&&(c+="H"+d.toString(32)),c+=""}else d=DM++,c=""+c+"r"+d.toString(32)+"";return s.memoizedState=c},useHostTransitionStatus:Zx,useFormState:Uj,useActionState:Uj,useOptimistic:function(s){var c=ea();c.memoizedState=c.baseState=s;var d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=d,c=Qx.bind(null,Pt,!0,d),d.dispatch=c,[s,c]},useMemoCache:Hx,useCacheRefresh:function(){return ea().memoizedState=IM.bind(null,Pt)}},cN={readContext:_n,use:h0,useCallback:Zj,useContext:_n,useEffect:Kj,useImperativeHandle:Yj,useInsertionEffect:Gj,useLayoutEffect:Wj,useMemo:Qj,useReducer:m0,useRef:qj,useState:function(){return m0(us)},useDebugValue:Wx,useDeferredValue:function(s,c){var d=$r();return Jj(d,or.memoizedState,s,c)},useTransition:function(){var s=m0(us)[0],c=$r().memoizedState;return[typeof s=="boolean"?s:Iu(s),c]},useSyncExternalStore:Tj,useId:nN,useHostTransitionStatus:Zx,useFormState:$j,useActionState:$j,useOptimistic:function(s,c){var d=$r();return Rj(d,or,s,c)},useMemoCache:Hx,useCacheRefresh:aN},BM={readContext:_n,use:h0,useCallback:Zj,useContext:_n,useEffect:Kj,useImperativeHandle:Yj,useInsertionEffect:Gj,useLayoutEffect:Wj,useMemo:Qj,useReducer:Vx,useRef:qj,useState:function(){return Vx(us)},useDebugValue:Wx,useDeferredValue:function(s,c){var d=$r();return or===null?Xx(d,s,c):Jj(d,or.memoizedState,s,c)},useTransition:function(){var s=Vx(us)[0],c=$r().memoizedState;return[typeof s=="boolean"?s:Iu(s),c]},useSyncExternalStore:Tj,useId:nN,useHostTransitionStatus:Zx,useFormState:Hj,useActionState:Hj,useOptimistic:function(s,c){var d=$r();return or!==null?Rj(d,or,s,c):(d.baseState=s,[s,d.queue.dispatch])},useMemoCache:Hx,useCacheRefresh:aN},lc=null,Uu=0;function y0(s){var c=Uu;return Uu+=1,lc===null&&(lc=[]),bj(lc,s,c)}function $u(s,c){c=c.props.ref,s.ref=c!==void 0?c:null}function b0(s,c){throw c.$$typeof===x?Error(n(525)):(s=Object.prototype.toString.call(c),Error(n(31,s==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":s)))}function uN(s){var c=s._init;return c(s._payload)}function dN(s){function c(we,pe){if(s){var Ee=we.deletions;Ee===null?(we.deletions=[pe],we.flags|=16):Ee.push(pe)}}function d(we,pe){if(!s)return null;for(;pe!==null;)c(we,pe),pe=pe.sibling;return null}function p(we){for(var pe=new Map;we!==null;)we.key!==null?pe.set(we.key,we):pe.set(we.index,we),we=we.sibling;return pe}function j(we,pe){return we=is(we,pe),we.index=0,we.sibling=null,we}function E(we,pe,Ee){return we.index=Ee,s?(Ee=we.alternate,Ee!==null?(Ee=Ee.index,Ee<pe?(we.flags|=67108866,pe):Ee):(we.flags|=67108866,pe)):(we.flags|=1048576,pe)}function D(we){return s&&we.alternate===null&&(we.flags|=67108866),we}function U(we,pe,Ee,$e){return pe===null||pe.tag!==6?(pe=yx(Ee,we.mode,$e),pe.return=we,pe):(pe=j(pe,Ee),pe.return=we,pe)}function le(we,pe,Ee,$e){var dt=Ee.type;return dt===w?Le(we,pe,Ee.props.children,$e,Ee.key):pe!==null&&(pe.elementType===dt||typeof dt=="object"&&dt!==null&&dt.$$typeof===z&&uN(dt)===pe.type)?(pe=j(pe,Ee.props),$u(pe,Ee),pe.return=we,pe):(pe=r0(Ee.type,Ee.key,Ee.props,null,we.mode,$e),$u(pe,Ee),pe.return=we,pe)}function Ae(we,pe,Ee,$e){return pe===null||pe.tag!==4||pe.stateNode.containerInfo!==Ee.containerInfo||pe.stateNode.implementation!==Ee.implementation?(pe=bx(Ee,we.mode,$e),pe.return=we,pe):(pe=j(pe,Ee.children||[]),pe.return=we,pe)}function Le(we,pe,Ee,$e,dt){return pe===null||pe.tag!==7?(pe=ql(Ee,we.mode,$e,dt),pe.return=we,pe):(pe=j(pe,Ee),pe.return=we,pe)}function qe(we,pe,Ee){if(typeof pe=="string"&&pe!==""||typeof pe=="number"||typeof pe=="bigint")return pe=yx(""+pe,we.mode,Ee),pe.return=we,pe;if(typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case v:return Ee=r0(pe.type,pe.key,pe.props,null,we.mode,Ee),$u(Ee,pe),Ee.return=we,Ee;case y:return pe=bx(pe,we.mode,Ee),pe.return=we,pe;case z:var $e=pe._init;return pe=$e(pe._payload),qe(we,pe,Ee)}if(he(pe)||B(pe))return pe=ql(pe,we.mode,Ee,null),pe.return=we,pe;if(typeof pe.then=="function")return qe(we,y0(pe),Ee);if(pe.$$typeof===A)return qe(we,s0(we,pe),Ee);b0(we,pe)}return null}function Te(we,pe,Ee,$e){var dt=pe!==null?pe.key:null;if(typeof Ee=="string"&&Ee!==""||typeof Ee=="number"||typeof Ee=="bigint")return dt!==null?null:U(we,pe,""+Ee,$e);if(typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case v:return Ee.key===dt?le(we,pe,Ee,$e):null;case y:return Ee.key===dt?Ae(we,pe,Ee,$e):null;case z:return dt=Ee._init,Ee=dt(Ee._payload),Te(we,pe,Ee,$e)}if(he(Ee)||B(Ee))return dt!==null?null:Le(we,pe,Ee,$e,null);if(typeof Ee.then=="function")return Te(we,pe,y0(Ee),$e);if(Ee.$$typeof===A)return Te(we,pe,s0(we,Ee),$e);b0(we,Ee)}return null}function Oe(we,pe,Ee,$e,dt){if(typeof $e=="string"&&$e!==""||typeof $e=="number"||typeof $e=="bigint")return we=we.get(Ee)||null,U(pe,we,""+$e,dt);if(typeof $e=="object"&&$e!==null){switch($e.$$typeof){case v:return we=we.get($e.key===null?Ee:$e.key)||null,le(pe,we,$e,dt);case y:return we=we.get($e.key===null?Ee:$e.key)||null,Ae(pe,we,$e,dt);case z:var Mt=$e._init;return $e=Mt($e._payload),Oe(we,pe,Ee,$e,dt)}if(he($e)||B($e))return we=we.get(Ee)||null,Le(pe,we,$e,dt,null);if(typeof $e.then=="function")return Oe(we,pe,Ee,y0($e),dt);if($e.$$typeof===A)return Oe(we,pe,Ee,s0(pe,$e),dt);b0(pe,$e)}return null}function wt(we,pe,Ee,$e){for(var dt=null,Mt=null,pt=pe,bt=pe=0,un=null;pt!==null&&bt<Ee.length;bt++){pt.index>bt?(un=pt,pt=null):un=pt.sibling;var Wt=Te(we,pt,Ee[bt],$e);if(Wt===null){pt===null&&(pt=un);break}s&&pt&&Wt.alternate===null&&c(we,pt),pe=E(Wt,pe,bt),Mt===null?dt=Wt:Mt.sibling=Wt,Mt=Wt,pt=un}if(bt===Ee.length)return d(we,pt),Yt&&Kl(we,bt),dt;if(pt===null){for(;bt<Ee.length;bt++)pt=qe(we,Ee[bt],$e),pt!==null&&(pe=E(pt,pe,bt),Mt===null?dt=pt:Mt.sibling=pt,Mt=pt);return Yt&&Kl(we,bt),dt}for(pt=p(pt);bt<Ee.length;bt++)un=Oe(pt,we,bt,Ee[bt],$e),un!==null&&(s&&un.alternate!==null&&pt.delete(un.key===null?bt:un.key),pe=E(un,pe,bt),Mt===null?dt=un:Mt.sibling=un,Mt=un);return s&&pt.forEach(function(hl){return c(we,hl)}),Yt&&Kl(we,bt),dt}function yt(we,pe,Ee,$e){if(Ee==null)throw Error(n(151));for(var dt=null,Mt=null,pt=pe,bt=pe=0,un=null,Wt=Ee.next();pt!==null&&!Wt.done;bt++,Wt=Ee.next()){pt.index>bt?(un=pt,pt=null):un=pt.sibling;var hl=Te(we,pt,Wt.value,$e);if(hl===null){pt===null&&(pt=un);break}s&&pt&&hl.alternate===null&&c(we,pt),pe=E(hl,pe,bt),Mt===null?dt=hl:Mt.sibling=hl,Mt=hl,pt=un}if(Wt.done)return d(we,pt),Yt&&Kl(we,bt),dt;if(pt===null){for(;!Wt.done;bt++,Wt=Ee.next())Wt=qe(we,Wt.value,$e),Wt!==null&&(pe=E(Wt,pe,bt),Mt===null?dt=Wt:Mt.sibling=Wt,Mt=Wt);return Yt&&Kl(we,bt),dt}for(pt=p(pt);!Wt.done;bt++,Wt=Ee.next())Wt=Oe(pt,we,bt,Wt.value,$e),Wt!==null&&(s&&Wt.alternate!==null&&pt.delete(Wt.key===null?bt:Wt.key),pe=E(Wt,pe,bt),Mt===null?dt=Wt:Mt.sibling=Wt,Mt=Wt);return s&&pt.forEach(function(UF){return c(we,UF)}),Yt&&Kl(we,bt),dt}function ur(we,pe,Ee,$e){if(typeof Ee=="object"&&Ee!==null&&Ee.type===w&&Ee.key===null&&(Ee=Ee.props.children),typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case v:e:{for(var dt=Ee.key;pe!==null;){if(pe.key===dt){if(dt=Ee.type,dt===w){if(pe.tag===7){d(we,pe.sibling),$e=j(pe,Ee.props.children),$e.return=we,we=$e;break e}}else if(pe.elementType===dt||typeof dt=="object"&&dt!==null&&dt.$$typeof===z&&uN(dt)===pe.type){d(we,pe.sibling),$e=j(pe,Ee.props),$u($e,Ee),$e.return=we,we=$e;break e}d(we,pe);break}else c(we,pe);pe=pe.sibling}Ee.type===w?($e=ql(Ee.props.children,we.mode,$e,Ee.key),$e.return=we,we=$e):($e=r0(Ee.type,Ee.key,Ee.props,null,we.mode,$e),$u($e,Ee),$e.return=we,we=$e)}return D(we);case y:e:{for(dt=Ee.key;pe!==null;){if(pe.key===dt)if(pe.tag===4&&pe.stateNode.containerInfo===Ee.containerInfo&&pe.stateNode.implementation===Ee.implementation){d(we,pe.sibling),$e=j(pe,Ee.children||[]),$e.return=we,we=$e;break e}else{d(we,pe);break}else c(we,pe);pe=pe.sibling}$e=bx(Ee,we.mode,$e),$e.return=we,we=$e}return D(we);case z:return dt=Ee._init,Ee=dt(Ee._payload),ur(we,pe,Ee,$e)}if(he(Ee))return wt(we,pe,Ee,$e);if(B(Ee)){if(dt=B(Ee),typeof dt!="function")throw Error(n(150));return Ee=dt.call(Ee),yt(we,pe,Ee,$e)}if(typeof Ee.then=="function")return ur(we,pe,y0(Ee),$e);if(Ee.$$typeof===A)return ur(we,pe,s0(we,Ee),$e);b0(we,Ee)}return typeof Ee=="string"&&Ee!==""||typeof Ee=="number"||typeof Ee=="bigint"?(Ee=""+Ee,pe!==null&&pe.tag===6?(d(we,pe.sibling),$e=j(pe,Ee),$e.return=we,we=$e):(d(we,pe),$e=yx(Ee,we.mode,$e),$e.return=we,we=$e),D(we)):d(we,pe)}return function(we,pe,Ee,$e){try{Uu=0;var dt=ur(we,pe,Ee,$e);return lc=null,dt}catch(pt){if(pt===Ou||pt===o0)throw pt;var Mt=pa(29,pt,null,we.mode);return Mt.lanes=$e,Mt.return=we,Mt}finally{}}}var oc=dN(!0),fN=dN(!1),Ka=se(null),Ii=null;function Qs(s){var c=s.alternate;W(Qr,Qr.current&1),W(Ka,s),Ii===null&&(c===null||nc.current!==null||c.memoizedState!==null)&&(Ii=s)}function hN(s){if(s.tag===22){if(W(Qr,Qr.current),W(Ka,s),Ii===null){var c=s.alternate;c!==null&&c.memoizedState!==null&&(Ii=s)}}else Js()}function Js(){W(Qr,Qr.current),W(Ka,Ka.current)}function ds(s){R(Ka),Ii===s&&(Ii=null),R(Qr)}var Qr=se(0);function w0(s){for(var c=s;c!==null;){if(c.tag===13){var d=c.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||zv(d)))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===s)break;for(;c.sibling===null;){if(c.return===null||c.return===s)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}function Jx(s,c,d,p){c=s.memoizedState,d=d(p,c),d=d==null?c:h({},c,d),s.memoizedState=d,s.lanes===0&&(s.updateQueue.baseState=d)}var ev={enqueueSetState:function(s,c,d){s=s._reactInternals;var p=ya(),j=Xs(p);j.payload=c,d!=null&&(j.callback=d),c=Ys(s,j,p),c!==null&&(ba(c,s,p),Pu(c,s,p))},enqueueReplaceState:function(s,c,d){s=s._reactInternals;var p=ya(),j=Xs(p);j.tag=1,j.payload=c,d!=null&&(j.callback=d),c=Ys(s,j,p),c!==null&&(ba(c,s,p),Pu(c,s,p))},enqueueForceUpdate:function(s,c){s=s._reactInternals;var d=ya(),p=Xs(d);p.tag=2,c!=null&&(p.callback=c),c=Ys(s,p,d),c!==null&&(ba(c,s,d),Pu(c,s,d))}};function mN(s,c,d,p,j,E,D){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(p,E,D):c.prototype&&c.prototype.isPureReactComponent?!ju(d,p)||!ju(j,E):!0}function pN(s,c,d,p){s=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(d,p),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(d,p),c.state!==s&&ev.enqueueReplaceState(c,c.state,null)}function Jl(s,c){var d=c;if("ref"in c){d={};for(var p in c)p!=="ref"&&(d[p]=c[p])}if(s=s.defaultProps){d===c&&(d=h({},d));for(var j in s)d[j]===void 0&&(d[j]=s[j])}return d}var S0=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function xN(s){S0(s)}function vN(s){console.error(s)}function gN(s){S0(s)}function j0(s,c){try{var d=s.onUncaughtError;d(c.value,{componentStack:c.stack})}catch(p){setTimeout(function(){throw p})}}function yN(s,c,d){try{var p=s.onCaughtError;p(d.value,{componentStack:d.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(j){setTimeout(function(){throw j})}}function tv(s,c,d){return d=Xs(d),d.tag=3,d.payload={element:null},d.callback=function(){j0(s,c)},d}function bN(s){return s=Xs(s),s.tag=3,s}function wN(s,c,d,p){var j=d.type.getDerivedStateFromError;if(typeof j=="function"){var E=p.value;s.payload=function(){return j(E)},s.callback=function(){yN(c,d,p)}}var D=d.stateNode;D!==null&&typeof D.componentDidCatch=="function"&&(s.callback=function(){yN(c,d,p),typeof j!="function"&&(il===null?il=new Set([this]):il.add(this));var U=p.stack;this.componentDidCatch(p.value,{componentStack:U!==null?U:""})})}function UM(s,c,d,p,j){if(d.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(c=d.alternate,c!==null&&Tu(c,d,j,!0),d=Ka.current,d!==null){switch(d.tag){case 13:return Ii===null?Ev():d.alternate===null&&Or===0&&(Or=3),d.flags&=-257,d.flags|=65536,d.lanes=j,p===Cx?d.flags|=16384:(c=d.updateQueue,c===null?d.updateQueue=new Set([p]):c.add(p),_v(s,p,j)),!1;case 22:return d.flags|=65536,p===Cx?d.flags|=16384:(c=d.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([p])},d.updateQueue=c):(d=c.retryQueue,d===null?c.retryQueue=new Set([p]):d.add(p)),_v(s,p,j)),!1}throw Error(n(435,d.tag))}return _v(s,p,j),Ev(),!1}if(Yt)return c=Ka.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=j,p!==jx&&(s=Error(n(422),{cause:p}),_u(za(s,d)))):(p!==jx&&(c=Error(n(423),{cause:p}),_u(za(c,d))),s=s.current.alternate,s.flags|=65536,j&=-j,s.lanes|=j,p=za(p,d),j=tv(s.stateNode,p,j),Px(s,j),Or!==4&&(Or=2)),!1;var E=Error(n(520),{cause:p});if(E=za(E,d),Wu===null?Wu=[E]:Wu.push(E),Or!==4&&(Or=2),c===null)return!0;p=za(p,d),d=c;do{switch(d.tag){case 3:return d.flags|=65536,s=j&-j,d.lanes|=s,s=tv(d.stateNode,p,s),Px(d,s),!1;case 1:if(c=d.type,E=d.stateNode,(d.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(il===null||!il.has(E))))return d.flags|=65536,j&=-j,d.lanes|=j,j=bN(j),wN(j,s,d,p),Px(d,j),!1}d=d.return}while(d!==null);return!1}var SN=Error(n(461)),on=!1;function gn(s,c,d,p){c.child=s===null?fN(c,null,d,p):oc(c,s.child,d,p)}function jN(s,c,d,p,j){d=d.render;var E=c.ref;if("ref"in p){var D={};for(var U in p)U!=="ref"&&(D[U]=p[U])}else D=p;return Yl(c),p=Lx(s,c,d,D,E,j),U=Bx(),s!==null&&!on?(Ux(s,c,j),fs(s,c,j)):(Yt&&U&&wx(c),c.flags|=1,gn(s,c,p,j),c.child)}function NN(s,c,d,p,j){if(s===null){var E=d.type;return typeof E=="function"&&!gx(E)&&E.defaultProps===void 0&&d.compare===null?(c.tag=15,c.type=E,EN(s,c,E,p,j)):(s=r0(d.type,null,p,c,c.mode,j),s.ref=c.ref,s.return=c,c.child=s)}if(E=s.child,!cv(s,j)){var D=E.memoizedProps;if(d=d.compare,d=d!==null?d:ju,d(D,p)&&s.ref===c.ref)return fs(s,c,j)}return c.flags|=1,s=is(E,p),s.ref=c.ref,s.return=c,c.child=s}function EN(s,c,d,p,j){if(s!==null){var E=s.memoizedProps;if(ju(E,p)&&s.ref===c.ref)if(on=!1,c.pendingProps=p=E,cv(s,j))(s.flags&131072)!==0&&(on=!0);else return c.lanes=s.lanes,fs(s,c,j)}return rv(s,c,d,p,j)}function AN(s,c,d){var p=c.pendingProps,j=p.children,E=s!==null?s.memoizedState:null;if(p.mode==="hidden"){if((c.flags&128)!==0){if(p=E!==null?E.baseLanes|d:d,s!==null){for(j=c.child=s.child,E=0;j!==null;)E=E|j.lanes|j.childLanes,j=j.sibling;c.childLanes=E&~p}else c.childLanes=0,c.child=null;return _N(s,c,p,d)}if((d&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},s!==null&&l0(c,E!==null?E.cachePool:null),E!==null?Ej(c,E):Mx(),hN(c);else return c.lanes=c.childLanes=536870912,_N(s,c,E!==null?E.baseLanes|d:d,d)}else E!==null?(l0(c,E.cachePool),Ej(c,E),Js(),c.memoizedState=null):(s!==null&&l0(c,null),Mx(),Js());return gn(s,c,j,d),c.child}function _N(s,c,d,p){var j=kx();return j=j===null?null:{parent:Zr._currentValue,pool:j},c.memoizedState={baseLanes:d,cachePool:j},s!==null&&l0(c,null),Mx(),hN(c),s!==null&&Tu(s,c,p,!0),null}function N0(s,c){var d=c.ref;if(d===null)s!==null&&s.ref!==null&&(c.flags|=4194816);else{if(typeof d!="function"&&typeof d!="object")throw Error(n(284));(s===null||s.ref!==d)&&(c.flags|=4194816)}}function rv(s,c,d,p,j){return Yl(c),d=Lx(s,c,d,p,void 0,j),p=Bx(),s!==null&&!on?(Ux(s,c,j),fs(s,c,j)):(Yt&&p&&wx(c),c.flags|=1,gn(s,c,d,j),c.child)}function TN(s,c,d,p,j,E){return Yl(c),c.updateQueue=null,d=_j(c,p,d,j),Aj(s),p=Bx(),s!==null&&!on?(Ux(s,c,E),fs(s,c,E)):(Yt&&p&&wx(c),c.flags|=1,gn(s,c,d,E),c.child)}function kN(s,c,d,p,j){if(Yl(c),c.stateNode===null){var E=Qo,D=d.contextType;typeof D=="object"&&D!==null&&(E=_n(D)),E=new d(p,E),c.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,E.updater=ev,c.stateNode=E,E._reactInternals=c,E=c.stateNode,E.props=p,E.state=c.memoizedState,E.refs={},Ox(c),D=d.contextType,E.context=typeof D=="object"&&D!==null?_n(D):Qo,E.state=c.memoizedState,D=d.getDerivedStateFromProps,typeof D=="function"&&(Jx(c,d,D,p),E.state=c.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(D=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),D!==E.state&&ev.enqueueReplaceState(E,E.state,null),Mu(c,p,E,j),Ru(),E.state=c.memoizedState),typeof E.componentDidMount=="function"&&(c.flags|=4194308),p=!0}else if(s===null){E=c.stateNode;var U=c.memoizedProps,le=Jl(d,U);E.props=le;var Ae=E.context,Le=d.contextType;D=Qo,typeof Le=="object"&&Le!==null&&(D=_n(Le));var qe=d.getDerivedStateFromProps;Le=typeof qe=="function"||typeof E.getSnapshotBeforeUpdate=="function",U=c.pendingProps!==U,Le||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(U||Ae!==D)&&pN(c,E,p,D),Ws=!1;var Te=c.memoizedState;E.state=Te,Mu(c,p,E,j),Ru(),Ae=c.memoizedState,U||Te!==Ae||Ws?(typeof qe=="function"&&(Jx(c,d,qe,p),Ae=c.memoizedState),(le=Ws||mN(c,d,le,p,Te,Ae,D))?(Le||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(c.flags|=4194308)):(typeof E.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=p,c.memoizedState=Ae),E.props=p,E.state=Ae,E.context=D,p=le):(typeof E.componentDidMount=="function"&&(c.flags|=4194308),p=!1)}else{E=c.stateNode,Dx(s,c),D=c.memoizedProps,Le=Jl(d,D),E.props=Le,qe=c.pendingProps,Te=E.context,Ae=d.contextType,le=Qo,typeof Ae=="object"&&Ae!==null&&(le=_n(Ae)),U=d.getDerivedStateFromProps,(Ae=typeof U=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(D!==qe||Te!==le)&&pN(c,E,p,le),Ws=!1,Te=c.memoizedState,E.state=Te,Mu(c,p,E,j),Ru();var Oe=c.memoizedState;D!==qe||Te!==Oe||Ws||s!==null&&s.dependencies!==null&&i0(s.dependencies)?(typeof U=="function"&&(Jx(c,d,U,p),Oe=c.memoizedState),(Le=Ws||mN(c,d,Le,p,Te,Oe,le)||s!==null&&s.dependencies!==null&&i0(s.dependencies))?(Ae||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(p,Oe,le),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(p,Oe,le)),typeof E.componentDidUpdate=="function"&&(c.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof E.componentDidUpdate!="function"||D===s.memoizedProps&&Te===s.memoizedState||(c.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||D===s.memoizedProps&&Te===s.memoizedState||(c.flags|=1024),c.memoizedProps=p,c.memoizedState=Oe),E.props=p,E.state=Oe,E.context=le,p=Le):(typeof E.componentDidUpdate!="function"||D===s.memoizedProps&&Te===s.memoizedState||(c.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||D===s.memoizedProps&&Te===s.memoizedState||(c.flags|=1024),p=!1)}return E=p,N0(s,c),p=(c.flags&128)!==0,E||p?(E=c.stateNode,d=p&&typeof d.getDerivedStateFromError!="function"?null:E.render(),c.flags|=1,s!==null&&p?(c.child=oc(c,s.child,null,j),c.child=oc(c,null,d,j)):gn(s,c,d,j),c.memoizedState=E.state,s=c.child):s=fs(s,c,j),s}function CN(s,c,d,p){return Au(),c.flags|=256,gn(s,c,d,p),c.child}var nv={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function av(s){return{baseLanes:s,cachePool:vj()}}function iv(s,c,d){return s=s!==null?s.childLanes&~d:0,c&&(s|=Ga),s}function ON(s,c,d){var p=c.pendingProps,j=!1,E=(c.flags&128)!==0,D;if((D=E)||(D=s!==null&&s.memoizedState===null?!1:(Qr.current&2)!==0),D&&(j=!0,c.flags&=-129),D=(c.flags&32)!==0,c.flags&=-33,s===null){if(Yt){if(j?Qs(c):Js(),Yt){var U=Cr,le;if(le=U){e:{for(le=U,U=Fi;le.nodeType!==8;){if(!U){U=null;break e}if(le=yi(le.nextSibling),le===null){U=null;break e}}U=le}U!==null?(c.memoizedState={dehydrated:U,treeContext:Vl!==null?{id:ss,overflow:ls}:null,retryLane:536870912,hydrationErrors:null},le=pa(18,null,null,0),le.stateNode=U,le.return=c,c.child=le,qn=c,Cr=null,le=!0):le=!1}le||Wl(c)}if(U=c.memoizedState,U!==null&&(U=U.dehydrated,U!==null))return zv(U)?c.lanes=32:c.lanes=536870912,null;ds(c)}return U=p.children,p=p.fallback,j?(Js(),j=c.mode,U=E0({mode:"hidden",children:U},j),p=ql(p,j,d,null),U.return=c,p.return=c,U.sibling=p,c.child=U,j=c.child,j.memoizedState=av(d),j.childLanes=iv(s,D,d),c.memoizedState=nv,p):(Qs(c),sv(c,U))}if(le=s.memoizedState,le!==null&&(U=le.dehydrated,U!==null)){if(E)c.flags&256?(Qs(c),c.flags&=-257,c=lv(s,c,d)):c.memoizedState!==null?(Js(),c.child=s.child,c.flags|=128,c=null):(Js(),j=p.fallback,U=c.mode,p=E0({mode:"visible",children:p.children},U),j=ql(j,U,d,null),j.flags|=2,p.return=c,j.return=c,p.sibling=j,c.child=p,oc(c,s.child,null,d),p=c.child,p.memoizedState=av(d),p.childLanes=iv(s,D,d),c.memoizedState=nv,c=j);else if(Qs(c),zv(U)){if(D=U.nextSibling&&U.nextSibling.dataset,D)var Ae=D.dgst;D=Ae,p=Error(n(419)),p.stack="",p.digest=D,_u({value:p,source:null,stack:null}),c=lv(s,c,d)}else if(on||Tu(s,c,d,!1),D=(d&s.childLanes)!==0,on||D){if(D=pr,D!==null&&(p=d&-d,p=(p&42)!==0?1:Ot(p),p=(p&(D.suspendedLanes|d))!==0?0:p,p!==0&&p!==le.retryLane))throw le.retryLane=p,Zo(s,p),ba(D,s,p),SN;U.data==="$?"||Ev(),c=lv(s,c,d)}else U.data==="$?"?(c.flags|=192,c.child=s.child,c=null):(s=le.treeContext,Cr=yi(U.nextSibling),qn=c,Yt=!0,Gl=null,Fi=!1,s!==null&&(qa[Va++]=ss,qa[Va++]=ls,qa[Va++]=Vl,ss=s.id,ls=s.overflow,Vl=c),c=sv(c,p.children),c.flags|=4096);return c}return j?(Js(),j=p.fallback,U=c.mode,le=s.child,Ae=le.sibling,p=is(le,{mode:"hidden",children:p.children}),p.subtreeFlags=le.subtreeFlags&65011712,Ae!==null?j=is(Ae,j):(j=ql(j,U,d,null),j.flags|=2),j.return=c,p.return=c,p.sibling=j,c.child=p,p=j,j=c.child,U=s.child.memoizedState,U===null?U=av(d):(le=U.cachePool,le!==null?(Ae=Zr._currentValue,le=le.parent!==Ae?{parent:Ae,pool:Ae}:le):le=vj(),U={baseLanes:U.baseLanes|d,cachePool:le}),j.memoizedState=U,j.childLanes=iv(s,D,d),c.memoizedState=nv,p):(Qs(c),d=s.child,s=d.sibling,d=is(d,{mode:"visible",children:p.children}),d.return=c,d.sibling=null,s!==null&&(D=c.deletions,D===null?(c.deletions=[s],c.flags|=16):D.push(s)),c.child=d,c.memoizedState=null,d)}function sv(s,c){return c=E0({mode:"visible",children:c},s.mode),c.return=s,s.child=c}function E0(s,c){return s=pa(22,s,null,c),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function lv(s,c,d){return oc(c,s.child,null,d),s=sv(c,c.pendingProps.children),s.flags|=2,c.memoizedState=null,s}function DN(s,c,d){s.lanes|=c;var p=s.alternate;p!==null&&(p.lanes|=c),Ex(s.return,c,d)}function ov(s,c,d,p,j){var E=s.memoizedState;E===null?s.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:p,tail:d,tailMode:j}:(E.isBackwards=c,E.rendering=null,E.renderingStartTime=0,E.last=p,E.tail=d,E.tailMode=j)}function PN(s,c,d){var p=c.pendingProps,j=p.revealOrder,E=p.tail;if(gn(s,c,p.children,d),p=Qr.current,(p&2)!==0)p=p&1|2,c.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=c.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&DN(s,d,c);else if(s.tag===19)DN(s,d,c);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===c)break e;for(;s.sibling===null;){if(s.return===null||s.return===c)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}p&=1}switch(W(Qr,p),j){case"forwards":for(d=c.child,j=null;d!==null;)s=d.alternate,s!==null&&w0(s)===null&&(j=d),d=d.sibling;d=j,d===null?(j=c.child,c.child=null):(j=d.sibling,d.sibling=null),ov(c,!1,j,d,E);break;case"backwards":for(d=null,j=c.child,c.child=null;j!==null;){if(s=j.alternate,s!==null&&w0(s)===null){c.child=j;break}s=j.sibling,j.sibling=d,d=j,j=s}ov(c,!0,d,null,E);break;case"together":ov(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function fs(s,c,d){if(s!==null&&(c.dependencies=s.dependencies),al|=c.lanes,(d&c.childLanes)===0)if(s!==null){if(Tu(s,c,d,!1),(d&c.childLanes)===0)return null}else return null;if(s!==null&&c.child!==s.child)throw Error(n(153));if(c.child!==null){for(s=c.child,d=is(s,s.pendingProps),c.child=d,d.return=c;s.sibling!==null;)s=s.sibling,d=d.sibling=is(s,s.pendingProps),d.return=c;d.sibling=null}return c.child}function cv(s,c){return(s.lanes&c)!==0?!0:(s=s.dependencies,!!(s!==null&&i0(s)))}function $M(s,c,d){switch(c.tag){case 3:ge(c,c.stateNode.containerInfo),Gs(c,Zr,s.memoizedState.cache),Au();break;case 27:case 5:ue(c);break;case 4:ge(c,c.stateNode.containerInfo);break;case 10:Gs(c,c.type,c.memoizedProps.value);break;case 13:var p=c.memoizedState;if(p!==null)return p.dehydrated!==null?(Qs(c),c.flags|=128,null):(d&c.child.childLanes)!==0?ON(s,c,d):(Qs(c),s=fs(s,c,d),s!==null?s.sibling:null);Qs(c);break;case 19:var j=(s.flags&128)!==0;if(p=(d&c.childLanes)!==0,p||(Tu(s,c,d,!1),p=(d&c.childLanes)!==0),j){if(p)return PN(s,c,d);c.flags|=128}if(j=c.memoizedState,j!==null&&(j.rendering=null,j.tail=null,j.lastEffect=null),W(Qr,Qr.current),p)break;return null;case 22:case 23:return c.lanes=0,AN(s,c,d);case 24:Gs(c,Zr,s.memoizedState.cache)}return fs(s,c,d)}function RN(s,c,d){if(s!==null)if(s.memoizedProps!==c.pendingProps)on=!0;else{if(!cv(s,d)&&(c.flags&128)===0)return on=!1,$M(s,c,d);on=(s.flags&131072)!==0}else on=!1,Yt&&(c.flags&1048576)!==0&&uj(c,a0,c.index);switch(c.lanes=0,c.tag){case 16:e:{s=c.pendingProps;var p=c.elementType,j=p._init;if(p=j(p._payload),c.type=p,typeof p=="function")gx(p)?(s=Jl(p,s),c.tag=1,c=kN(null,c,p,s,d)):(c.tag=0,c=rv(null,c,p,s,d));else{if(p!=null){if(j=p.$$typeof,j===k){c.tag=11,c=jN(null,c,p,s,d);break e}else if(j===T){c.tag=14,c=NN(null,c,p,s,d);break e}}throw c=Ne(p)||p,Error(n(306,c,""))}}return c;case 0:return rv(s,c,c.type,c.pendingProps,d);case 1:return p=c.type,j=Jl(p,c.pendingProps),kN(s,c,p,j,d);case 3:e:{if(ge(c,c.stateNode.containerInfo),s===null)throw Error(n(387));p=c.pendingProps;var E=c.memoizedState;j=E.element,Dx(s,c),Mu(c,p,null,d);var D=c.memoizedState;if(p=D.cache,Gs(c,Zr,p),p!==E.cache&&Ax(c,[Zr],d,!0),Ru(),p=D.element,E.isDehydrated)if(E={element:p,isDehydrated:!1,cache:D.cache},c.updateQueue.baseState=E,c.memoizedState=E,c.flags&256){c=CN(s,c,p,d);break e}else if(p!==j){j=za(Error(n(424)),c),_u(j),c=CN(s,c,p,d);break e}else{switch(s=c.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Cr=yi(s.firstChild),qn=c,Yt=!0,Gl=null,Fi=!0,d=fN(c,null,p,d),c.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling}else{if(Au(),p===j){c=fs(s,c,d);break e}gn(s,c,p,d)}c=c.child}return c;case 26:return N0(s,c),s===null?(d=LE(c.type,null,c.pendingProps,null))?c.memoizedState=d:Yt||(d=c.type,s=c.pendingProps,p=B0(L.current).createElement(d),p[Tr]=c,p[kr]=s,bn(p,d,s),ce(p),c.stateNode=p):c.memoizedState=LE(c.type,s.memoizedProps,c.pendingProps,s.memoizedState),null;case 27:return ue(c),s===null&&Yt&&(p=c.stateNode=ME(c.type,c.pendingProps,L.current),qn=c,Fi=!0,j=Cr,ol(c.type)?(Hv=j,Cr=yi(p.firstChild)):Cr=j),gn(s,c,c.pendingProps.children,d),N0(s,c),s===null&&(c.flags|=4194304),c.child;case 5:return s===null&&Yt&&((j=p=Cr)&&(p=pF(p,c.type,c.pendingProps,Fi),p!==null?(c.stateNode=p,qn=c,Cr=yi(p.firstChild),Fi=!1,j=!0):j=!1),j||Wl(c)),ue(c),j=c.type,E=c.pendingProps,D=s!==null?s.memoizedProps:null,p=E.children,Bv(j,E)?p=null:D!==null&&Bv(j,D)&&(c.flags|=32),c.memoizedState!==null&&(j=Lx(s,c,PM,null,null,d),nd._currentValue=j),N0(s,c),gn(s,c,p,d),c.child;case 6:return s===null&&Yt&&((s=d=Cr)&&(d=xF(d,c.pendingProps,Fi),d!==null?(c.stateNode=d,qn=c,Cr=null,s=!0):s=!1),s||Wl(c)),null;case 13:return ON(s,c,d);case 4:return ge(c,c.stateNode.containerInfo),p=c.pendingProps,s===null?c.child=oc(c,null,p,d):gn(s,c,p,d),c.child;case 11:return jN(s,c,c.type,c.pendingProps,d);case 7:return gn(s,c,c.pendingProps,d),c.child;case 8:return gn(s,c,c.pendingProps.children,d),c.child;case 12:return gn(s,c,c.pendingProps.children,d),c.child;case 10:return p=c.pendingProps,Gs(c,c.type,p.value),gn(s,c,p.children,d),c.child;case 9:return j=c.type._context,p=c.pendingProps.children,Yl(c),j=_n(j),p=p(j),c.flags|=1,gn(s,c,p,d),c.child;case 14:return NN(s,c,c.type,c.pendingProps,d);case 15:return EN(s,c,c.type,c.pendingProps,d);case 19:return PN(s,c,d);case 31:return p=c.pendingProps,d=c.mode,p={mode:p.mode,children:p.children},s===null?(d=E0(p,d),d.ref=c.ref,c.child=d,d.return=c,c=d):(d=is(s.child,p),d.ref=c.ref,c.child=d,d.return=c,c=d),c;case 22:return AN(s,c,d);case 24:return Yl(c),p=_n(Zr),s===null?(j=kx(),j===null&&(j=pr,E=_x(),j.pooledCache=E,E.refCount++,E!==null&&(j.pooledCacheLanes|=d),j=E),c.memoizedState={parent:p,cache:j},Ox(c),Gs(c,Zr,j)):((s.lanes&d)!==0&&(Dx(s,c),Mu(c,null,null,d),Ru()),j=s.memoizedState,E=c.memoizedState,j.parent!==p?(j={parent:p,cache:p},c.memoizedState=j,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=j),Gs(c,Zr,p)):(p=E.cache,Gs(c,Zr,p),p!==j.cache&&Ax(c,[Zr],d,!0))),gn(s,c,c.pendingProps.children,d),c.child;case 29:throw c.pendingProps}throw Error(n(156,c.tag))}function hs(s){s.flags|=4}function MN(s,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!HE(c)){if(c=Ka.current,c!==null&&((zt&4194048)===zt?Ii!==null:(zt&62914560)!==zt&&(zt&536870912)===0||c!==Ii))throw Du=Cx,gj;s.flags|=8192}}function A0(s,c){c!==null&&(s.flags|=4),s.flags&16384&&(c=s.tag!==22?Bt():536870912,s.lanes|=c,fc|=c)}function zu(s,c){if(!Yt)switch(s.tailMode){case"hidden":c=s.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?s.tail=null:d.sibling=null;break;case"collapsed":d=s.tail;for(var p=null;d!==null;)d.alternate!==null&&(p=d),d=d.sibling;p===null?c||s.tail===null?s.tail=null:s.tail.sibling=null:p.sibling=null}}function Ar(s){var c=s.alternate!==null&&s.alternate.child===s.child,d=0,p=0;if(c)for(var j=s.child;j!==null;)d|=j.lanes|j.childLanes,p|=j.subtreeFlags&65011712,p|=j.flags&65011712,j.return=s,j=j.sibling;else for(j=s.child;j!==null;)d|=j.lanes|j.childLanes,p|=j.subtreeFlags,p|=j.flags,j.return=s,j=j.sibling;return s.subtreeFlags|=p,s.childLanes=d,c}function zM(s,c,d){var p=c.pendingProps;switch(Sx(c),c.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ar(c),null;case 1:return Ar(c),null;case 3:return d=c.stateNode,p=null,s!==null&&(p=s.memoizedState.cache),c.memoizedState.cache!==p&&(c.flags|=2048),cs(Zr),G(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(s===null||s.child===null)&&(Eu(c)?hs(c):s===null||s.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,hj())),Ar(c),null;case 26:return d=c.memoizedState,s===null?(hs(c),d!==null?(Ar(c),MN(c,d)):(Ar(c),c.flags&=-16777217)):d?d!==s.memoizedState?(hs(c),Ar(c),MN(c,d)):(Ar(c),c.flags&=-16777217):(s.memoizedProps!==p&&hs(c),Ar(c),c.flags&=-16777217),null;case 27:Se(c),d=L.current;var j=c.type;if(s!==null&&c.stateNode!=null)s.memoizedProps!==p&&hs(c);else{if(!p){if(c.stateNode===null)throw Error(n(166));return Ar(c),null}s=Y.current,Eu(c)?dj(c):(s=ME(j,p,d),c.stateNode=s,hs(c))}return Ar(c),null;case 5:if(Se(c),d=c.type,s!==null&&c.stateNode!=null)s.memoizedProps!==p&&hs(c);else{if(!p){if(c.stateNode===null)throw Error(n(166));return Ar(c),null}if(s=Y.current,Eu(c))dj(c);else{switch(j=B0(L.current),s){case 1:s=j.createElementNS("http://www.w3.org/2000/svg",d);break;case 2:s=j.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;default:switch(d){case"svg":s=j.createElementNS("http://www.w3.org/2000/svg",d);break;case"math":s=j.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;case"script":s=j.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof p.is=="string"?j.createElement("select",{is:p.is}):j.createElement("select"),p.multiple?s.multiple=!0:p.size&&(s.size=p.size);break;default:s=typeof p.is=="string"?j.createElement(d,{is:p.is}):j.createElement(d)}}s[Tr]=c,s[kr]=p;e:for(j=c.child;j!==null;){if(j.tag===5||j.tag===6)s.appendChild(j.stateNode);else if(j.tag!==4&&j.tag!==27&&j.child!==null){j.child.return=j,j=j.child;continue}if(j===c)break e;for(;j.sibling===null;){if(j.return===null||j.return===c)break e;j=j.return}j.sibling.return=j.return,j=j.sibling}c.stateNode=s;e:switch(bn(s,d,p),d){case"button":case"input":case"select":case"textarea":s=!!p.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&hs(c)}}return Ar(c),c.flags&=-16777217,null;case 6:if(s&&c.stateNode!=null)s.memoizedProps!==p&&hs(c);else{if(typeof p!="string"&&c.stateNode===null)throw Error(n(166));if(s=L.current,Eu(c)){if(s=c.stateNode,d=c.memoizedProps,p=null,j=qn,j!==null)switch(j.tag){case 27:case 5:p=j.memoizedProps}s[Tr]=c,s=!!(s.nodeValue===d||p!==null&&p.suppressHydrationWarning===!0||TE(s.nodeValue,d)),s||Wl(c)}else s=B0(s).createTextNode(p),s[Tr]=c,c.stateNode=s}return Ar(c),null;case 13:if(p=c.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(j=Eu(c),p!==null&&p.dehydrated!==null){if(s===null){if(!j)throw Error(n(318));if(j=c.memoizedState,j=j!==null?j.dehydrated:null,!j)throw Error(n(317));j[Tr]=c}else Au(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Ar(c),j=!1}else j=hj(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=j),j=!0;if(!j)return c.flags&256?(ds(c),c):(ds(c),null)}if(ds(c),(c.flags&128)!==0)return c.lanes=d,c;if(d=p!==null,s=s!==null&&s.memoizedState!==null,d){p=c.child,j=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(j=p.alternate.memoizedState.cachePool.pool);var E=null;p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(E=p.memoizedState.cachePool.pool),E!==j&&(p.flags|=2048)}return d!==s&&d&&(c.child.flags|=8192),A0(c,c.updateQueue),Ar(c),null;case 4:return G(),s===null&&Rv(c.stateNode.containerInfo),Ar(c),null;case 10:return cs(c.type),Ar(c),null;case 19:if(R(Qr),j=c.memoizedState,j===null)return Ar(c),null;if(p=(c.flags&128)!==0,E=j.rendering,E===null)if(p)zu(j,!1);else{if(Or!==0||s!==null&&(s.flags&128)!==0)for(s=c.child;s!==null;){if(E=w0(s),E!==null){for(c.flags|=128,zu(j,!1),s=E.updateQueue,c.updateQueue=s,A0(c,s),c.subtreeFlags=0,s=d,d=c.child;d!==null;)cj(d,s),d=d.sibling;return W(Qr,Qr.current&1|2),c.child}s=s.sibling}j.tail!==null&&oe()>k0&&(c.flags|=128,p=!0,zu(j,!1),c.lanes=4194304)}else{if(!p)if(s=w0(E),s!==null){if(c.flags|=128,p=!0,s=s.updateQueue,c.updateQueue=s,A0(c,s),zu(j,!0),j.tail===null&&j.tailMode==="hidden"&&!E.alternate&&!Yt)return Ar(c),null}else 2*oe()-j.renderingStartTime>k0&&d!==536870912&&(c.flags|=128,p=!0,zu(j,!1),c.lanes=4194304);j.isBackwards?(E.sibling=c.child,c.child=E):(s=j.last,s!==null?s.sibling=E:c.child=E,j.last=E)}return j.tail!==null?(c=j.tail,j.rendering=c,j.tail=c.sibling,j.renderingStartTime=oe(),c.sibling=null,s=Qr.current,W(Qr,p?s&1|2:s&1),c):(Ar(c),null);case 22:case 23:return ds(c),Fx(),p=c.memoizedState!==null,s!==null?s.memoizedState!==null!==p&&(c.flags|=8192):p&&(c.flags|=8192),p?(d&536870912)!==0&&(c.flags&128)===0&&(Ar(c),c.subtreeFlags&6&&(c.flags|=8192)):Ar(c),d=c.updateQueue,d!==null&&A0(c,d.retryQueue),d=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(d=s.memoizedState.cachePool.pool),p=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(p=c.memoizedState.cachePool.pool),p!==d&&(c.flags|=2048),s!==null&&R(Zl),null;case 24:return d=null,s!==null&&(d=s.memoizedState.cache),c.memoizedState.cache!==d&&(c.flags|=2048),cs(Zr),Ar(c),null;case 25:return null;case 30:return null}throw Error(n(156,c.tag))}function HM(s,c){switch(Sx(c),c.tag){case 1:return s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 3:return cs(Zr),G(),s=c.flags,(s&65536)!==0&&(s&128)===0?(c.flags=s&-65537|128,c):null;case 26:case 27:case 5:return Se(c),null;case 13:if(ds(c),s=c.memoizedState,s!==null&&s.dehydrated!==null){if(c.alternate===null)throw Error(n(340));Au()}return s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 19:return R(Qr),null;case 4:return G(),null;case 10:return cs(c.type),null;case 22:case 23:return ds(c),Fx(),s!==null&&R(Zl),s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 24:return cs(Zr),null;case 25:return null;default:return null}}function FN(s,c){switch(Sx(c),c.tag){case 3:cs(Zr),G();break;case 26:case 27:case 5:Se(c);break;case 4:G();break;case 13:ds(c);break;case 19:R(Qr);break;case 10:cs(c.type);break;case 22:case 23:ds(c),Fx(),s!==null&&R(Zl);break;case 24:cs(Zr)}}function Hu(s,c){try{var d=c.updateQueue,p=d!==null?d.lastEffect:null;if(p!==null){var j=p.next;d=j;do{if((d.tag&s)===s){p=void 0;var E=d.create,D=d.inst;p=E(),D.destroy=p}d=d.next}while(d!==j)}}catch(U){fr(c,c.return,U)}}function el(s,c,d){try{var p=c.updateQueue,j=p!==null?p.lastEffect:null;if(j!==null){var E=j.next;p=E;do{if((p.tag&s)===s){var D=p.inst,U=D.destroy;if(U!==void 0){D.destroy=void 0,j=c;var le=d,Ae=U;try{Ae()}catch(Le){fr(j,le,Le)}}}p=p.next}while(p!==E)}}catch(Le){fr(c,c.return,Le)}}function IN(s){var c=s.updateQueue;if(c!==null){var d=s.stateNode;try{Nj(c,d)}catch(p){fr(s,s.return,p)}}}function LN(s,c,d){d.props=Jl(s.type,s.memoizedProps),d.state=s.memoizedState;try{d.componentWillUnmount()}catch(p){fr(s,c,p)}}function qu(s,c){try{var d=s.ref;if(d!==null){switch(s.tag){case 26:case 27:case 5:var p=s.stateNode;break;case 30:p=s.stateNode;break;default:p=s.stateNode}typeof d=="function"?s.refCleanup=d(p):d.current=p}}catch(j){fr(s,c,j)}}function Li(s,c){var d=s.ref,p=s.refCleanup;if(d!==null)if(typeof p=="function")try{p()}catch(j){fr(s,c,j)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof d=="function")try{d(null)}catch(j){fr(s,c,j)}else d.current=null}function BN(s){var c=s.type,d=s.memoizedProps,p=s.stateNode;try{e:switch(c){case"button":case"input":case"select":case"textarea":d.autoFocus&&p.focus();break e;case"img":d.src?p.src=d.src:d.srcSet&&(p.srcset=d.srcSet)}}catch(j){fr(s,s.return,j)}}function uv(s,c,d){try{var p=s.stateNode;uF(p,s.type,d,c),p[kr]=c}catch(j){fr(s,s.return,j)}}function UN(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&ol(s.type)||s.tag===4}function dv(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||UN(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&ol(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function fv(s,c,d){var p=s.tag;if(p===5||p===6)s=s.stateNode,c?(d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d).insertBefore(s,c):(c=d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d,c.appendChild(s),d=d._reactRootContainer,d!=null||c.onclick!==null||(c.onclick=L0));else if(p!==4&&(p===27&&ol(s.type)&&(d=s.stateNode,c=null),s=s.child,s!==null))for(fv(s,c,d),s=s.sibling;s!==null;)fv(s,c,d),s=s.sibling}function _0(s,c,d){var p=s.tag;if(p===5||p===6)s=s.stateNode,c?d.insertBefore(s,c):d.appendChild(s);else if(p!==4&&(p===27&&ol(s.type)&&(d=s.stateNode),s=s.child,s!==null))for(_0(s,c,d),s=s.sibling;s!==null;)_0(s,c,d),s=s.sibling}function $N(s){var c=s.stateNode,d=s.memoizedProps;try{for(var p=s.type,j=c.attributes;j.length;)c.removeAttributeNode(j[0]);bn(c,p,d),c[Tr]=s,c[kr]=d}catch(E){fr(s,s.return,E)}}var ms=!1,Ir=!1,hv=!1,zN=typeof WeakSet=="function"?WeakSet:Set,cn=null;function qM(s,c){if(s=s.containerInfo,Iv=V0,s=JS(s),dx(s)){if("selectionStart"in s)var d={start:s.selectionStart,end:s.selectionEnd};else e:{d=(d=s.ownerDocument)&&d.defaultView||window;var p=d.getSelection&&d.getSelection();if(p&&p.rangeCount!==0){d=p.anchorNode;var j=p.anchorOffset,E=p.focusNode;p=p.focusOffset;try{d.nodeType,E.nodeType}catch{d=null;break e}var D=0,U=-1,le=-1,Ae=0,Le=0,qe=s,Te=null;t:for(;;){for(var Oe;qe!==d||j!==0&&qe.nodeType!==3||(U=D+j),qe!==E||p!==0&&qe.nodeType!==3||(le=D+p),qe.nodeType===3&&(D+=qe.nodeValue.length),(Oe=qe.firstChild)!==null;)Te=qe,qe=Oe;for(;;){if(qe===s)break t;if(Te===d&&++Ae===j&&(U=D),Te===E&&++Le===p&&(le=D),(Oe=qe.nextSibling)!==null)break;qe=Te,Te=qe.parentNode}qe=Oe}d=U===-1||le===-1?null:{start:U,end:le}}else d=null}d=d||{start:0,end:0}}else d=null;for(Lv={focusedElem:s,selectionRange:d},V0=!1,cn=c;cn!==null;)if(c=cn,s=c.child,(c.subtreeFlags&1024)!==0&&s!==null)s.return=c,cn=s;else for(;cn!==null;){switch(c=cn,E=c.alternate,s=c.flags,c.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&E!==null){s=void 0,d=c,j=E.memoizedProps,E=E.memoizedState,p=d.stateNode;try{var wt=Jl(d.type,j,d.elementType===d.type);s=p.getSnapshotBeforeUpdate(wt,E),p.__reactInternalSnapshotBeforeUpdate=s}catch(yt){fr(d,d.return,yt)}}break;case 3:if((s&1024)!==0){if(s=c.stateNode.containerInfo,d=s.nodeType,d===9)$v(s);else if(d===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":$v(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(n(163))}if(s=c.sibling,s!==null){s.return=c.return,cn=s;break}cn=c.return}}function HN(s,c,d){var p=d.flags;switch(d.tag){case 0:case 11:case 15:tl(s,d),p&4&&Hu(5,d);break;case 1:if(tl(s,d),p&4)if(s=d.stateNode,c===null)try{s.componentDidMount()}catch(D){fr(d,d.return,D)}else{var j=Jl(d.type,c.memoizedProps);c=c.memoizedState;try{s.componentDidUpdate(j,c,s.__reactInternalSnapshotBeforeUpdate)}catch(D){fr(d,d.return,D)}}p&64&&IN(d),p&512&&qu(d,d.return);break;case 3:if(tl(s,d),p&64&&(s=d.updateQueue,s!==null)){if(c=null,d.child!==null)switch(d.child.tag){case 27:case 5:c=d.child.stateNode;break;case 1:c=d.child.stateNode}try{Nj(s,c)}catch(D){fr(d,d.return,D)}}break;case 27:c===null&&p&4&&$N(d);case 26:case 5:tl(s,d),c===null&&p&4&&BN(d),p&512&&qu(d,d.return);break;case 12:tl(s,d);break;case 13:tl(s,d),p&4&&KN(s,d),p&64&&(s=d.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(d=JM.bind(null,d),vF(s,d))));break;case 22:if(p=d.memoizedState!==null||ms,!p){c=c!==null&&c.memoizedState!==null||Ir,j=ms;var E=Ir;ms=p,(Ir=c)&&!E?rl(s,d,(d.subtreeFlags&8772)!==0):tl(s,d),ms=j,Ir=E}break;case 30:break;default:tl(s,d)}}function qN(s){var c=s.alternate;c!==null&&(s.alternate=null,qN(c)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(c=s.stateNode,c!==null&&X(c)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var wr=null,ta=!1;function ps(s,c,d){for(d=d.child;d!==null;)VN(s,c,d),d=d.sibling}function VN(s,c,d){if(Xe&&typeof Xe.onCommitFiberUnmount=="function")try{Xe.onCommitFiberUnmount(De,d)}catch{}switch(d.tag){case 26:Ir||Li(d,c),ps(s,c,d),d.memoizedState?d.memoizedState.count--:d.stateNode&&(d=d.stateNode,d.parentNode.removeChild(d));break;case 27:Ir||Li(d,c);var p=wr,j=ta;ol(d.type)&&(wr=d.stateNode,ta=!1),ps(s,c,d),Ju(d.stateNode),wr=p,ta=j;break;case 5:Ir||Li(d,c);case 6:if(p=wr,j=ta,wr=null,ps(s,c,d),wr=p,ta=j,wr!==null)if(ta)try{(wr.nodeType===9?wr.body:wr.nodeName==="HTML"?wr.ownerDocument.body:wr).removeChild(d.stateNode)}catch(E){fr(d,c,E)}else try{wr.removeChild(d.stateNode)}catch(E){fr(d,c,E)}break;case 18:wr!==null&&(ta?(s=wr,PE(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,d.stateNode),ld(s)):PE(wr,d.stateNode));break;case 4:p=wr,j=ta,wr=d.stateNode.containerInfo,ta=!0,ps(s,c,d),wr=p,ta=j;break;case 0:case 11:case 14:case 15:Ir||el(2,d,c),Ir||el(4,d,c),ps(s,c,d);break;case 1:Ir||(Li(d,c),p=d.stateNode,typeof p.componentWillUnmount=="function"&&LN(d,c,p)),ps(s,c,d);break;case 21:ps(s,c,d);break;case 22:Ir=(p=Ir)||d.memoizedState!==null,ps(s,c,d),Ir=p;break;default:ps(s,c,d)}}function KN(s,c){if(c.memoizedState===null&&(s=c.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{ld(s)}catch(d){fr(c,c.return,d)}}function VM(s){switch(s.tag){case 13:case 19:var c=s.stateNode;return c===null&&(c=s.stateNode=new zN),c;case 22:return s=s.stateNode,c=s._retryCache,c===null&&(c=s._retryCache=new zN),c;default:throw Error(n(435,s.tag))}}function mv(s,c){var d=VM(s);c.forEach(function(p){var j=eF.bind(null,s,p);d.has(p)||(d.add(p),p.then(j,j))})}function xa(s,c){var d=c.deletions;if(d!==null)for(var p=0;p<d.length;p++){var j=d[p],E=s,D=c,U=D;e:for(;U!==null;){switch(U.tag){case 27:if(ol(U.type)){wr=U.stateNode,ta=!1;break e}break;case 5:wr=U.stateNode,ta=!1;break e;case 3:case 4:wr=U.stateNode.containerInfo,ta=!0;break e}U=U.return}if(wr===null)throw Error(n(160));VN(E,D,j),wr=null,ta=!1,E=j.alternate,E!==null&&(E.return=null),j.return=null}if(c.subtreeFlags&13878)for(c=c.child;c!==null;)GN(c,s),c=c.sibling}var gi=null;function GN(s,c){var d=s.alternate,p=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:xa(c,s),va(s),p&4&&(el(3,s,s.return),Hu(3,s),el(5,s,s.return));break;case 1:xa(c,s),va(s),p&512&&(Ir||d===null||Li(d,d.return)),p&64&&ms&&(s=s.updateQueue,s!==null&&(p=s.callbacks,p!==null&&(d=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=d===null?p:d.concat(p))));break;case 26:var j=gi;if(xa(c,s),va(s),p&512&&(Ir||d===null||Li(d,d.return)),p&4){var E=d!==null?d.memoizedState:null;if(p=s.memoizedState,d===null)if(p===null)if(s.stateNode===null){e:{p=s.type,d=s.memoizedProps,j=j.ownerDocument||j;t:switch(p){case"title":E=j.getElementsByTagName("title")[0],(!E||E[V]||E[Tr]||E.namespaceURI==="http://www.w3.org/2000/svg"||E.hasAttribute("itemprop"))&&(E=j.createElement(p),j.head.insertBefore(E,j.querySelector("head > title"))),bn(E,p,d),E[Tr]=s,ce(E),p=E;break e;case"link":var D=$E("link","href",j).get(p+(d.href||""));if(D){for(var U=0;U<D.length;U++)if(E=D[U],E.getAttribute("href")===(d.href==null||d.href===""?null:d.href)&&E.getAttribute("rel")===(d.rel==null?null:d.rel)&&E.getAttribute("title")===(d.title==null?null:d.title)&&E.getAttribute("crossorigin")===(d.crossOrigin==null?null:d.crossOrigin)){D.splice(U,1);break t}}E=j.createElement(p),bn(E,p,d),j.head.appendChild(E);break;case"meta":if(D=$E("meta","content",j).get(p+(d.content||""))){for(U=0;U<D.length;U++)if(E=D[U],E.getAttribute("content")===(d.content==null?null:""+d.content)&&E.getAttribute("name")===(d.name==null?null:d.name)&&E.getAttribute("property")===(d.property==null?null:d.property)&&E.getAttribute("http-equiv")===(d.httpEquiv==null?null:d.httpEquiv)&&E.getAttribute("charset")===(d.charSet==null?null:d.charSet)){D.splice(U,1);break t}}E=j.createElement(p),bn(E,p,d),j.head.appendChild(E);break;default:throw Error(n(468,p))}E[Tr]=s,ce(E),p=E}s.stateNode=p}else zE(j,s.type,s.stateNode);else s.stateNode=UE(j,p,s.memoizedProps);else E!==p?(E===null?d.stateNode!==null&&(d=d.stateNode,d.parentNode.removeChild(d)):E.count--,p===null?zE(j,s.type,s.stateNode):UE(j,p,s.memoizedProps)):p===null&&s.stateNode!==null&&uv(s,s.memoizedProps,d.memoizedProps)}break;case 27:xa(c,s),va(s),p&512&&(Ir||d===null||Li(d,d.return)),d!==null&&p&4&&uv(s,s.memoizedProps,d.memoizedProps);break;case 5:if(xa(c,s),va(s),p&512&&(Ir||d===null||Li(d,d.return)),s.flags&32){j=s.stateNode;try{qo(j,"")}catch(Oe){fr(s,s.return,Oe)}}p&4&&s.stateNode!=null&&(j=s.memoizedProps,uv(s,j,d!==null?d.memoizedProps:j)),p&1024&&(hv=!0);break;case 6:if(xa(c,s),va(s),p&4){if(s.stateNode===null)throw Error(n(162));p=s.memoizedProps,d=s.stateNode;try{d.nodeValue=p}catch(Oe){fr(s,s.return,Oe)}}break;case 3:if(z0=null,j=gi,gi=U0(c.containerInfo),xa(c,s),gi=j,va(s),p&4&&d!==null&&d.memoizedState.isDehydrated)try{ld(c.containerInfo)}catch(Oe){fr(s,s.return,Oe)}hv&&(hv=!1,WN(s));break;case 4:p=gi,gi=U0(s.stateNode.containerInfo),xa(c,s),va(s),gi=p;break;case 12:xa(c,s),va(s);break;case 13:xa(c,s),va(s),s.child.flags&8192&&s.memoizedState!==null!=(d!==null&&d.memoizedState!==null)&&(bv=oe()),p&4&&(p=s.updateQueue,p!==null&&(s.updateQueue=null,mv(s,p)));break;case 22:j=s.memoizedState!==null;var le=d!==null&&d.memoizedState!==null,Ae=ms,Le=Ir;if(ms=Ae||j,Ir=Le||le,xa(c,s),Ir=Le,ms=Ae,va(s),p&8192)e:for(c=s.stateNode,c._visibility=j?c._visibility&-2:c._visibility|1,j&&(d===null||le||ms||Ir||eo(s)),d=null,c=s;;){if(c.tag===5||c.tag===26){if(d===null){le=d=c;try{if(E=le.stateNode,j)D=E.style,typeof D.setProperty=="function"?D.setProperty("display","none","important"):D.display="none";else{U=le.stateNode;var qe=le.memoizedProps.style,Te=qe!=null&&qe.hasOwnProperty("display")?qe.display:null;U.style.display=Te==null||typeof Te=="boolean"?"":(""+Te).trim()}}catch(Oe){fr(le,le.return,Oe)}}}else if(c.tag===6){if(d===null){le=c;try{le.stateNode.nodeValue=j?"":le.memoizedProps}catch(Oe){fr(le,le.return,Oe)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===s)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===s)break e;for(;c.sibling===null;){if(c.return===null||c.return===s)break e;d===c&&(d=null),c=c.return}d===c&&(d=null),c.sibling.return=c.return,c=c.sibling}p&4&&(p=s.updateQueue,p!==null&&(d=p.retryQueue,d!==null&&(p.retryQueue=null,mv(s,d))));break;case 19:xa(c,s),va(s),p&4&&(p=s.updateQueue,p!==null&&(s.updateQueue=null,mv(s,p)));break;case 30:break;case 21:break;default:xa(c,s),va(s)}}function va(s){var c=s.flags;if(c&2){try{for(var d,p=s.return;p!==null;){if(UN(p)){d=p;break}p=p.return}if(d==null)throw Error(n(160));switch(d.tag){case 27:var j=d.stateNode,E=dv(s);_0(s,E,j);break;case 5:var D=d.stateNode;d.flags&32&&(qo(D,""),d.flags&=-33);var U=dv(s);_0(s,U,D);break;case 3:case 4:var le=d.stateNode.containerInfo,Ae=dv(s);fv(s,Ae,le);break;default:throw Error(n(161))}}catch(Le){fr(s,s.return,Le)}s.flags&=-3}c&4096&&(s.flags&=-4097)}function WN(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var c=s;WN(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),s=s.sibling}}function tl(s,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)HN(s,c.alternate,c),c=c.sibling}function eo(s){for(s=s.child;s!==null;){var c=s;switch(c.tag){case 0:case 11:case 14:case 15:el(4,c,c.return),eo(c);break;case 1:Li(c,c.return);var d=c.stateNode;typeof d.componentWillUnmount=="function"&&LN(c,c.return,d),eo(c);break;case 27:Ju(c.stateNode);case 26:case 5:Li(c,c.return),eo(c);break;case 22:c.memoizedState===null&&eo(c);break;case 30:eo(c);break;default:eo(c)}s=s.sibling}}function rl(s,c,d){for(d=d&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var p=c.alternate,j=s,E=c,D=E.flags;switch(E.tag){case 0:case 11:case 15:rl(j,E,d),Hu(4,E);break;case 1:if(rl(j,E,d),p=E,j=p.stateNode,typeof j.componentDidMount=="function")try{j.componentDidMount()}catch(Ae){fr(p,p.return,Ae)}if(p=E,j=p.updateQueue,j!==null){var U=p.stateNode;try{var le=j.shared.hiddenCallbacks;if(le!==null)for(j.shared.hiddenCallbacks=null,j=0;j<le.length;j++)jj(le[j],U)}catch(Ae){fr(p,p.return,Ae)}}d&&D&64&&IN(E),qu(E,E.return);break;case 27:$N(E);case 26:case 5:rl(j,E,d),d&&p===null&&D&4&&BN(E),qu(E,E.return);break;case 12:rl(j,E,d);break;case 13:rl(j,E,d),d&&D&4&&KN(j,E);break;case 22:E.memoizedState===null&&rl(j,E,d),qu(E,E.return);break;case 30:break;default:rl(j,E,d)}c=c.sibling}}function pv(s,c){var d=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(d=s.memoizedState.cachePool.pool),s=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(s=c.memoizedState.cachePool.pool),s!==d&&(s!=null&&s.refCount++,d!=null&&ku(d))}function xv(s,c){s=null,c.alternate!==null&&(s=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==s&&(c.refCount++,s!=null&&ku(s))}function Bi(s,c,d,p){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)XN(s,c,d,p),c=c.sibling}function XN(s,c,d,p){var j=c.flags;switch(c.tag){case 0:case 11:case 15:Bi(s,c,d,p),j&2048&&Hu(9,c);break;case 1:Bi(s,c,d,p);break;case 3:Bi(s,c,d,p),j&2048&&(s=null,c.alternate!==null&&(s=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==s&&(c.refCount++,s!=null&&ku(s)));break;case 12:if(j&2048){Bi(s,c,d,p),s=c.stateNode;try{var E=c.memoizedProps,D=E.id,U=E.onPostCommit;typeof U=="function"&&U(D,c.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(le){fr(c,c.return,le)}}else Bi(s,c,d,p);break;case 13:Bi(s,c,d,p);break;case 23:break;case 22:E=c.stateNode,D=c.alternate,c.memoizedState!==null?E._visibility&2?Bi(s,c,d,p):Vu(s,c):E._visibility&2?Bi(s,c,d,p):(E._visibility|=2,cc(s,c,d,p,(c.subtreeFlags&10256)!==0)),j&2048&&pv(D,c);break;case 24:Bi(s,c,d,p),j&2048&&xv(c.alternate,c);break;default:Bi(s,c,d,p)}}function cc(s,c,d,p,j){for(j=j&&(c.subtreeFlags&10256)!==0,c=c.child;c!==null;){var E=s,D=c,U=d,le=p,Ae=D.flags;switch(D.tag){case 0:case 11:case 15:cc(E,D,U,le,j),Hu(8,D);break;case 23:break;case 22:var Le=D.stateNode;D.memoizedState!==null?Le._visibility&2?cc(E,D,U,le,j):Vu(E,D):(Le._visibility|=2,cc(E,D,U,le,j)),j&&Ae&2048&&pv(D.alternate,D);break;case 24:cc(E,D,U,le,j),j&&Ae&2048&&xv(D.alternate,D);break;default:cc(E,D,U,le,j)}c=c.sibling}}function Vu(s,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var d=s,p=c,j=p.flags;switch(p.tag){case 22:Vu(d,p),j&2048&&pv(p.alternate,p);break;case 24:Vu(d,p),j&2048&&xv(p.alternate,p);break;default:Vu(d,p)}c=c.sibling}}var Ku=8192;function uc(s){if(s.subtreeFlags&Ku)for(s=s.child;s!==null;)YN(s),s=s.sibling}function YN(s){switch(s.tag){case 26:uc(s),s.flags&Ku&&s.memoizedState!==null&&CF(gi,s.memoizedState,s.memoizedProps);break;case 5:uc(s);break;case 3:case 4:var c=gi;gi=U0(s.stateNode.containerInfo),uc(s),gi=c;break;case 22:s.memoizedState===null&&(c=s.alternate,c!==null&&c.memoizedState!==null?(c=Ku,Ku=16777216,uc(s),Ku=c):uc(s));break;default:uc(s)}}function ZN(s){var c=s.alternate;if(c!==null&&(s=c.child,s!==null)){c.child=null;do c=s.sibling,s.sibling=null,s=c;while(s!==null)}}function Gu(s){var c=s.deletions;if((s.flags&16)!==0){if(c!==null)for(var d=0;d<c.length;d++){var p=c[d];cn=p,JN(p,s)}ZN(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)QN(s),s=s.sibling}function QN(s){switch(s.tag){case 0:case 11:case 15:Gu(s),s.flags&2048&&el(9,s,s.return);break;case 3:Gu(s);break;case 12:Gu(s);break;case 22:var c=s.stateNode;s.memoizedState!==null&&c._visibility&2&&(s.return===null||s.return.tag!==13)?(c._visibility&=-3,T0(s)):Gu(s);break;default:Gu(s)}}function T0(s){var c=s.deletions;if((s.flags&16)!==0){if(c!==null)for(var d=0;d<c.length;d++){var p=c[d];cn=p,JN(p,s)}ZN(s)}for(s=s.child;s!==null;){switch(c=s,c.tag){case 0:case 11:case 15:el(8,c,c.return),T0(c);break;case 22:d=c.stateNode,d._visibility&2&&(d._visibility&=-3,T0(c));break;default:T0(c)}s=s.sibling}}function JN(s,c){for(;cn!==null;){var d=cn;switch(d.tag){case 0:case 11:case 15:el(8,d,c);break;case 23:case 22:if(d.memoizedState!==null&&d.memoizedState.cachePool!==null){var p=d.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:ku(d.memoizedState.cache)}if(p=d.child,p!==null)p.return=d,cn=p;else e:for(d=s;cn!==null;){p=cn;var j=p.sibling,E=p.return;if(qN(p),p===d){cn=null;break e}if(j!==null){j.return=E,cn=j;break e}cn=E}}}var KM={getCacheForType:function(s){var c=_n(Zr),d=c.data.get(s);return d===void 0&&(d=s(),c.data.set(s,d)),d}},GM=typeof WeakMap=="function"?WeakMap:Map,nr=0,pr=null,It=null,zt=0,ar=0,ga=null,nl=!1,dc=!1,vv=!1,xs=0,Or=0,al=0,to=0,gv=0,Ga=0,fc=0,Wu=null,ra=null,yv=!1,bv=0,k0=1/0,C0=null,il=null,yn=0,sl=null,hc=null,mc=0,wv=0,Sv=null,eE=null,Xu=0,jv=null;function ya(){if((nr&2)!==0&&zt!==0)return zt&-zt;if(K.T!==null){var s=tc;return s!==0?s:Cv()}return zn()}function tE(){Ga===0&&(Ga=(zt&536870912)===0||Yt?ut():536870912);var s=Ka.current;return s!==null&&(s.flags|=32),Ga}function ba(s,c,d){(s===pr&&(ar===2||ar===9)||s.cancelPendingCommit!==null)&&(pc(s,0),ll(s,zt,Ga,!1)),tr(s,d),((nr&2)===0||s!==pr)&&(s===pr&&((nr&2)===0&&(to|=d),Or===4&&ll(s,zt,Ga,!1)),Ui(s))}function rE(s,c,d){if((nr&6)!==0)throw Error(n(327));var p=!d&&(c&124)===0&&(c&s.expiredLanes)===0||Ue(s,c),j=p?YM(s,c):Av(s,c,!0),E=p;do{if(j===0){dc&&!p&&ll(s,c,0,!1);break}else{if(d=s.current.alternate,E&&!WM(d)){j=Av(s,c,!1),E=!1;continue}if(j===2){if(E=c,s.errorRecoveryDisabledLanes&E)var D=0;else D=s.pendingLanes&-536870913,D=D!==0?D:D&536870912?536870912:0;if(D!==0){c=D;e:{var U=s;j=Wu;var le=U.current.memoizedState.isDehydrated;if(le&&(pc(U,D).flags|=256),D=Av(U,D,!1),D!==2){if(vv&&!le){U.errorRecoveryDisabledLanes|=E,to|=E,j=4;break e}E=ra,ra=j,E!==null&&(ra===null?ra=E:ra.push.apply(ra,E))}j=D}if(E=!1,j!==2)continue}}if(j===1){pc(s,0),ll(s,c,0,!0);break}e:{switch(p=s,E=j,E){case 0:case 1:throw Error(n(345));case 4:if((c&4194048)!==c)break;case 6:ll(p,c,Ga,!nl);break e;case 2:ra=null;break;case 3:case 5:break;default:throw Error(n(329))}if((c&62914560)===c&&(j=bv+300-oe(),10<j)){if(ll(p,c,Ga,!nl),Zt(p,0,!0)!==0)break e;p.timeoutHandle=OE(nE.bind(null,p,d,ra,C0,yv,c,Ga,to,fc,nl,E,2,-0,0),j);break e}nE(p,d,ra,C0,yv,c,Ga,to,fc,nl,E,0,-0,0)}}break}while(!0);Ui(s)}function nE(s,c,d,p,j,E,D,U,le,Ae,Le,qe,Te,Oe){if(s.timeoutHandle=-1,qe=c.subtreeFlags,(qe&8192||(qe&16785408)===16785408)&&(rd={stylesheets:null,count:0,unsuspend:kF},YN(c),qe=OF(),qe!==null)){s.cancelPendingCommit=qe(uE.bind(null,s,c,E,d,p,j,D,U,le,Le,1,Te,Oe)),ll(s,E,D,!Ae);return}uE(s,c,E,d,p,j,D,U,le)}function WM(s){for(var c=s;;){var d=c.tag;if((d===0||d===11||d===15)&&c.flags&16384&&(d=c.updateQueue,d!==null&&(d=d.stores,d!==null)))for(var p=0;p<d.length;p++){var j=d[p],E=j.getSnapshot;j=j.value;try{if(!ma(E(),j))return!1}catch{return!1}}if(d=c.child,c.subtreeFlags&16384&&d!==null)d.return=c,c=d;else{if(c===s)break;for(;c.sibling===null;){if(c.return===null||c.return===s)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function ll(s,c,d,p){c&=~gv,c&=~to,s.suspendedLanes|=c,s.pingedLanes&=~c,p&&(s.warmLanes|=c),p=s.expirationTimes;for(var j=c;0<j;){var E=31-rt(j),D=1<<E;p[E]=-1,j&=~D}d!==0&&Ye(s,d,c)}function O0(){return(nr&6)===0?(Yu(0),!1):!0}function Nv(){if(It!==null){if(ar===0)var s=It.return;else s=It,os=Xl=null,$x(s),lc=null,Uu=0,s=It;for(;s!==null;)FN(s.alternate,s),s=s.return;It=null}}function pc(s,c){var d=s.timeoutHandle;d!==-1&&(s.timeoutHandle=-1,fF(d)),d=s.cancelPendingCommit,d!==null&&(s.cancelPendingCommit=null,d()),Nv(),pr=s,It=d=is(s.current,null),zt=c,ar=0,ga=null,nl=!1,dc=Ue(s,c),vv=!1,fc=Ga=gv=to=al=Or=0,ra=Wu=null,yv=!1,(c&8)!==0&&(c|=c&32);var p=s.entangledLanes;if(p!==0)for(s=s.entanglements,p&=c;0<p;){var j=31-rt(p),E=1<<j;c|=s[j],p&=~E}return xs=c,Jf(),d}function aE(s,c){Pt=null,K.H=g0,c===Ou||c===o0?(c=wj(),ar=3):c===gj?(c=wj(),ar=4):ar=c===SN?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,ga=c,It===null&&(Or=1,j0(s,za(c,s.current)))}function iE(){var s=K.H;return K.H=g0,s===null?g0:s}function sE(){var s=K.A;return K.A=KM,s}function Ev(){Or=4,nl||(zt&4194048)!==zt&&Ka.current!==null||(dc=!0),(al&134217727)===0&&(to&134217727)===0||pr===null||ll(pr,zt,Ga,!1)}function Av(s,c,d){var p=nr;nr|=2;var j=iE(),E=sE();(pr!==s||zt!==c)&&(C0=null,pc(s,c)),c=!1;var D=Or;e:do try{if(ar!==0&&It!==null){var U=It,le=ga;switch(ar){case 8:Nv(),D=6;break e;case 3:case 2:case 9:case 6:Ka.current===null&&(c=!0);var Ae=ar;if(ar=0,ga=null,xc(s,U,le,Ae),d&&dc){D=0;break e}break;default:Ae=ar,ar=0,ga=null,xc(s,U,le,Ae)}}XM(),D=Or;break}catch(Le){aE(s,Le)}while(!0);return c&&s.shellSuspendCounter++,os=Xl=null,nr=p,K.H=j,K.A=E,It===null&&(pr=null,zt=0,Jf()),D}function XM(){for(;It!==null;)lE(It)}function YM(s,c){var d=nr;nr|=2;var p=iE(),j=sE();pr!==s||zt!==c?(C0=null,k0=oe()+500,pc(s,c)):dc=Ue(s,c);e:do try{if(ar!==0&&It!==null){c=It;var E=ga;t:switch(ar){case 1:ar=0,ga=null,xc(s,c,E,1);break;case 2:case 9:if(yj(E)){ar=0,ga=null,oE(c);break}c=function(){ar!==2&&ar!==9||pr!==s||(ar=7),Ui(s)},E.then(c,c);break e;case 3:ar=7;break e;case 4:ar=5;break e;case 7:yj(E)?(ar=0,ga=null,oE(c)):(ar=0,ga=null,xc(s,c,E,7));break;case 5:var D=null;switch(It.tag){case 26:D=It.memoizedState;case 5:case 27:var U=It;if(!D||HE(D)){ar=0,ga=null;var le=U.sibling;if(le!==null)It=le;else{var Ae=U.return;Ae!==null?(It=Ae,D0(Ae)):It=null}break t}}ar=0,ga=null,xc(s,c,E,5);break;case 6:ar=0,ga=null,xc(s,c,E,6);break;case 8:Nv(),Or=6;break e;default:throw Error(n(462))}}ZM();break}catch(Le){aE(s,Le)}while(!0);return os=Xl=null,K.H=p,K.A=j,nr=d,It!==null?0:(pr=null,zt=0,Jf(),Or)}function ZM(){for(;It!==null&&!me();)lE(It)}function lE(s){var c=RN(s.alternate,s,xs);s.memoizedProps=s.pendingProps,c===null?D0(s):It=c}function oE(s){var c=s,d=c.alternate;switch(c.tag){case 15:case 0:c=TN(d,c,c.pendingProps,c.type,void 0,zt);break;case 11:c=TN(d,c,c.pendingProps,c.type.render,c.ref,zt);break;case 5:$x(c);default:FN(d,c),c=It=cj(c,xs),c=RN(d,c,xs)}s.memoizedProps=s.pendingProps,c===null?D0(s):It=c}function xc(s,c,d,p){os=Xl=null,$x(c),lc=null,Uu=0;var j=c.return;try{if(UM(s,j,c,d,zt)){Or=1,j0(s,za(d,s.current)),It=null;return}}catch(E){if(j!==null)throw It=j,E;Or=1,j0(s,za(d,s.current)),It=null;return}c.flags&32768?(Yt||p===1?s=!0:dc||(zt&536870912)!==0?s=!1:(nl=s=!0,(p===2||p===9||p===3||p===6)&&(p=Ka.current,p!==null&&p.tag===13&&(p.flags|=16384))),cE(c,s)):D0(c)}function D0(s){var c=s;do{if((c.flags&32768)!==0){cE(c,nl);return}s=c.return;var d=zM(c.alternate,c,xs);if(d!==null){It=d;return}if(c=c.sibling,c!==null){It=c;return}It=c=s}while(c!==null);Or===0&&(Or=5)}function cE(s,c){do{var d=HM(s.alternate,s);if(d!==null){d.flags&=32767,It=d;return}if(d=s.return,d!==null&&(d.flags|=32768,d.subtreeFlags=0,d.deletions=null),!c&&(s=s.sibling,s!==null)){It=s;return}It=s=d}while(s!==null);Or=6,It=null}function uE(s,c,d,p,j,E,D,U,le){s.cancelPendingCommit=null;do P0();while(yn!==0);if((nr&6)!==0)throw Error(n(327));if(c!==null){if(c===s.current)throw Error(n(177));if(E=c.lanes|c.childLanes,E|=xx,Me(s,d,E,D,U,le),s===pr&&(It=pr=null,zt=0),hc=c,sl=s,mc=d,wv=E,Sv=j,eE=p,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,tF(Be,function(){return pE(),null})):(s.callbackNode=null,s.callbackPriority=0),p=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||p){p=K.T,K.T=null,j=H.p,H.p=2,D=nr,nr|=4;try{qM(s,c,d)}finally{nr=D,H.p=j,K.T=p}}yn=1,dE(),fE(),hE()}}function dE(){if(yn===1){yn=0;var s=sl,c=hc,d=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||d){d=K.T,K.T=null;var p=H.p;H.p=2;var j=nr;nr|=4;try{GN(c,s);var E=Lv,D=JS(s.containerInfo),U=E.focusedElem,le=E.selectionRange;if(D!==U&&U&&U.ownerDocument&&QS(U.ownerDocument.documentElement,U)){if(le!==null&&dx(U)){var Ae=le.start,Le=le.end;if(Le===void 0&&(Le=Ae),"selectionStart"in U)U.selectionStart=Ae,U.selectionEnd=Math.min(Le,U.value.length);else{var qe=U.ownerDocument||document,Te=qe&&qe.defaultView||window;if(Te.getSelection){var Oe=Te.getSelection(),wt=U.textContent.length,yt=Math.min(le.start,wt),ur=le.end===void 0?yt:Math.min(le.end,wt);!Oe.extend&&yt>ur&&(D=ur,ur=yt,yt=D);var we=ZS(U,yt),pe=ZS(U,ur);if(we&&pe&&(Oe.rangeCount!==1||Oe.anchorNode!==we.node||Oe.anchorOffset!==we.offset||Oe.focusNode!==pe.node||Oe.focusOffset!==pe.offset)){var Ee=qe.createRange();Ee.setStart(we.node,we.offset),Oe.removeAllRanges(),yt>ur?(Oe.addRange(Ee),Oe.extend(pe.node,pe.offset)):(Ee.setEnd(pe.node,pe.offset),Oe.addRange(Ee))}}}}for(qe=[],Oe=U;Oe=Oe.parentNode;)Oe.nodeType===1&&qe.push({element:Oe,left:Oe.scrollLeft,top:Oe.scrollTop});for(typeof U.focus=="function"&&U.focus(),U=0;U<qe.length;U++){var $e=qe[U];$e.element.scrollLeft=$e.left,$e.element.scrollTop=$e.top}}V0=!!Iv,Lv=Iv=null}finally{nr=j,H.p=p,K.T=d}}s.current=c,yn=2}}function fE(){if(yn===2){yn=0;var s=sl,c=hc,d=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||d){d=K.T,K.T=null;var p=H.p;H.p=2;var j=nr;nr|=4;try{HN(s,c.alternate,c)}finally{nr=j,H.p=p,K.T=d}}yn=3}}function hE(){if(yn===4||yn===3){yn=0,ze();var s=sl,c=hc,d=mc,p=eE;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?yn=5:(yn=0,hc=sl=null,mE(s,s.pendingLanes));var j=s.pendingLanes;if(j===0&&(il=null),ha(d),c=c.stateNode,Xe&&typeof Xe.onCommitFiberRoot=="function")try{Xe.onCommitFiberRoot(De,c,void 0,(c.current.flags&128)===128)}catch{}if(p!==null){c=K.T,j=H.p,H.p=2,K.T=null;try{for(var E=s.onRecoverableError,D=0;D<p.length;D++){var U=p[D];E(U.value,{componentStack:U.stack})}}finally{K.T=c,H.p=j}}(mc&3)!==0&&P0(),Ui(s),j=s.pendingLanes,(d&4194090)!==0&&(j&42)!==0?s===jv?Xu++:(Xu=0,jv=s):Xu=0,Yu(0)}}function mE(s,c){(s.pooledCacheLanes&=c)===0&&(c=s.pooledCache,c!=null&&(s.pooledCache=null,ku(c)))}function P0(s){return dE(),fE(),hE(),pE()}function pE(){if(yn!==5)return!1;var s=sl,c=wv;wv=0;var d=ha(mc),p=K.T,j=H.p;try{H.p=32>d?32:d,K.T=null,d=Sv,Sv=null;var E=sl,D=mc;if(yn=0,hc=sl=null,mc=0,(nr&6)!==0)throw Error(n(331));var U=nr;if(nr|=4,QN(E.current),XN(E,E.current,D,d),nr=U,Yu(0,!1),Xe&&typeof Xe.onPostCommitFiberRoot=="function")try{Xe.onPostCommitFiberRoot(De,E)}catch{}return!0}finally{H.p=j,K.T=p,mE(s,c)}}function xE(s,c,d){c=za(d,c),c=tv(s.stateNode,c,2),s=Ys(s,c,2),s!==null&&(tr(s,2),Ui(s))}function fr(s,c,d){if(s.tag===3)xE(s,s,d);else for(;c!==null;){if(c.tag===3){xE(c,s,d);break}else if(c.tag===1){var p=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(il===null||!il.has(p))){s=za(d,s),d=bN(2),p=Ys(c,d,2),p!==null&&(wN(d,p,c,s),tr(p,2),Ui(p));break}}c=c.return}}function _v(s,c,d){var p=s.pingCache;if(p===null){p=s.pingCache=new GM;var j=new Set;p.set(c,j)}else j=p.get(c),j===void 0&&(j=new Set,p.set(c,j));j.has(d)||(vv=!0,j.add(d),s=QM.bind(null,s,c,d),c.then(s,s))}function QM(s,c,d){var p=s.pingCache;p!==null&&p.delete(c),s.pingedLanes|=s.suspendedLanes&d,s.warmLanes&=~d,pr===s&&(zt&d)===d&&(Or===4||Or===3&&(zt&62914560)===zt&&300>oe()-bv?(nr&2)===0&&pc(s,0):gv|=d,fc===zt&&(fc=0)),Ui(s)}function vE(s,c){c===0&&(c=Bt()),s=Zo(s,c),s!==null&&(tr(s,c),Ui(s))}function JM(s){var c=s.memoizedState,d=0;c!==null&&(d=c.retryLane),vE(s,d)}function eF(s,c){var d=0;switch(s.tag){case 13:var p=s.stateNode,j=s.memoizedState;j!==null&&(d=j.retryLane);break;case 19:p=s.stateNode;break;case 22:p=s.stateNode._retryCache;break;default:throw Error(n(314))}p!==null&&p.delete(c),vE(s,d)}function tF(s,c){return Qe(s,c)}var R0=null,vc=null,Tv=!1,M0=!1,kv=!1,ro=0;function Ui(s){s!==vc&&s.next===null&&(vc===null?R0=vc=s:vc=vc.next=s),M0=!0,Tv||(Tv=!0,nF())}function Yu(s,c){if(!kv&&M0){kv=!0;do for(var d=!1,p=R0;p!==null;){if(s!==0){var j=p.pendingLanes;if(j===0)var E=0;else{var D=p.suspendedLanes,U=p.pingedLanes;E=(1<<31-rt(42|s)+1)-1,E&=j&~(D&~U),E=E&201326741?E&201326741|1:E?E|2:0}E!==0&&(d=!0,wE(p,E))}else E=zt,E=Zt(p,p===pr?E:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(E&3)===0||Ue(p,E)||(d=!0,wE(p,E));p=p.next}while(d);kv=!1}}function rF(){gE()}function gE(){M0=Tv=!1;var s=0;ro!==0&&(dF()&&(s=ro),ro=0);for(var c=oe(),d=null,p=R0;p!==null;){var j=p.next,E=yE(p,c);E===0?(p.next=null,d===null?R0=j:d.next=j,j===null&&(vc=d)):(d=p,(s!==0||(E&3)!==0)&&(M0=!0)),p=j}Yu(s)}function yE(s,c){for(var d=s.suspendedLanes,p=s.pingedLanes,j=s.expirationTimes,E=s.pendingLanes&-62914561;0<E;){var D=31-rt(E),U=1<<D,le=j[D];le===-1?((U&d)===0||(U&p)!==0)&&(j[D]=et(U,c)):le<=c&&(s.expiredLanes|=U),E&=~U}if(c=pr,d=zt,d=Zt(s,s===c?d:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),p=s.callbackNode,d===0||s===c&&(ar===2||ar===9)||s.cancelPendingCommit!==null)return p!==null&&p!==null&&xe(p),s.callbackNode=null,s.callbackPriority=0;if((d&3)===0||Ue(s,d)){if(c=d&-d,c===s.callbackPriority)return c;switch(p!==null&&xe(p),ha(d)){case 2:case 8:d=Fe;break;case 32:d=Be;break;case 268435456:d=Ze;break;default:d=Be}return p=bE.bind(null,s),d=Qe(d,p),s.callbackPriority=c,s.callbackNode=d,c}return p!==null&&p!==null&&xe(p),s.callbackPriority=2,s.callbackNode=null,2}function bE(s,c){if(yn!==0&&yn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var d=s.callbackNode;if(P0()&&s.callbackNode!==d)return null;var p=zt;return p=Zt(s,s===pr?p:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),p===0?null:(rE(s,p,c),yE(s,oe()),s.callbackNode!=null&&s.callbackNode===d?bE.bind(null,s):null)}function wE(s,c){if(P0())return null;rE(s,c,!0)}function nF(){hF(function(){(nr&6)!==0?Qe(Ge,rF):gE()})}function Cv(){return ro===0&&(ro=ut()),ro}function SE(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Kf(""+s)}function jE(s,c){var d=c.ownerDocument.createElement("input");return d.name=c.name,d.value=c.value,s.id&&d.setAttribute("form",s.id),c.parentNode.insertBefore(d,c),s=new FormData(s),d.parentNode.removeChild(d),s}function aF(s,c,d,p,j){if(c==="submit"&&d&&d.stateNode===j){var E=SE((j[kr]||null).action),D=p.submitter;D&&(c=(c=D[kr]||null)?SE(c.formAction):D.getAttribute("formAction"),c!==null&&(E=c,D=null));var U=new Yf("action","action",null,p,j);s.push({event:U,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(ro!==0){var le=D?jE(j,D):new FormData(j);Yx(d,{pending:!0,data:le,method:j.method,action:E},null,le)}}else typeof E=="function"&&(U.preventDefault(),le=D?jE(j,D):new FormData(j),Yx(d,{pending:!0,data:le,method:j.method,action:E},E,le))},currentTarget:j}]})}}for(var Ov=0;Ov<px.length;Ov++){var Dv=px[Ov],iF=Dv.toLowerCase(),sF=Dv[0].toUpperCase()+Dv.slice(1);vi(iF,"on"+sF)}vi(rj,"onAnimationEnd"),vi(nj,"onAnimationIteration"),vi(aj,"onAnimationStart"),vi("dblclick","onDoubleClick"),vi("focusin","onFocus"),vi("focusout","onBlur"),vi(jM,"onTransitionRun"),vi(NM,"onTransitionStart"),vi(EM,"onTransitionCancel"),vi(ij,"onTransitionEnd"),Ie("onMouseEnter",["mouseout","mouseover"]),Ie("onMouseLeave",["mouseout","mouseover"]),Ie("onPointerEnter",["pointerout","pointerover"]),Ie("onPointerLeave",["pointerout","pointerover"]),Pe("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Pe("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Pe("onBeforeInput",["compositionend","keypress","textInput","paste"]),Pe("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Pe("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Pe("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Zu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),lF=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Zu));function NE(s,c){c=(c&4)!==0;for(var d=0;d<s.length;d++){var p=s[d],j=p.event;p=p.listeners;e:{var E=void 0;if(c)for(var D=p.length-1;0<=D;D--){var U=p[D],le=U.instance,Ae=U.currentTarget;if(U=U.listener,le!==E&&j.isPropagationStopped())break e;E=U,j.currentTarget=Ae;try{E(j)}catch(Le){S0(Le)}j.currentTarget=null,E=le}else for(D=0;D<p.length;D++){if(U=p[D],le=U.instance,Ae=U.currentTarget,U=U.listener,le!==E&&j.isPropagationStopped())break e;E=U,j.currentTarget=Ae;try{E(j)}catch(Le){S0(Le)}j.currentTarget=null,E=le}}}}function Lt(s,c){var d=c[Mi];d===void 0&&(d=c[Mi]=new Set);var p=s+"__bubble";d.has(p)||(EE(c,s,2,!1),d.add(p))}function Pv(s,c,d){var p=0;c&&(p|=4),EE(d,s,p,c)}var F0="_reactListening"+Math.random().toString(36).slice(2);function Rv(s){if(!s[F0]){s[F0]=!0,ye.forEach(function(d){d!=="selectionchange"&&(lF.has(d)||Pv(d,!1,s),Pv(d,!0,s))});var c=s.nodeType===9?s:s.ownerDocument;c===null||c[F0]||(c[F0]=!0,Pv("selectionchange",!1,c))}}function EE(s,c,d,p){switch(XE(c)){case 2:var j=RF;break;case 8:j=MF;break;default:j=Wv}d=j.bind(null,c,d,s),j=void 0,!rx||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(j=!0),p?j!==void 0?s.addEventListener(c,d,{capture:!0,passive:j}):s.addEventListener(c,d,!0):j!==void 0?s.addEventListener(c,d,{passive:j}):s.addEventListener(c,d,!1)}function Mv(s,c,d,p,j){var E=p;if((c&1)===0&&(c&2)===0&&p!==null)e:for(;;){if(p===null)return;var D=p.tag;if(D===3||D===4){var U=p.stateNode.containerInfo;if(U===j)break;if(D===4)for(D=p.return;D!==null;){var le=D.tag;if((le===3||le===4)&&D.stateNode.containerInfo===j)return;D=D.return}for(;U!==null;){if(D=J(U),D===null)return;if(le=D.tag,le===5||le===6||le===26||le===27){p=E=D;continue e}U=U.parentNode}}p=p.return}DS(function(){var Ae=E,Le=ex(d),qe=[];e:{var Te=sj.get(s);if(Te!==void 0){var Oe=Yf,wt=s;switch(s){case"keypress":if(Wf(d)===0)break e;case"keydown":case"keyup":Oe=tM;break;case"focusin":wt="focus",Oe=sx;break;case"focusout":wt="blur",Oe=sx;break;case"beforeblur":case"afterblur":Oe=sx;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Oe=MS;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Oe=H8;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Oe=aM;break;case rj:case nj:case aj:Oe=K8;break;case ij:Oe=sM;break;case"scroll":case"scrollend":Oe=$8;break;case"wheel":Oe=oM;break;case"copy":case"cut":case"paste":Oe=W8;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Oe=IS;break;case"toggle":case"beforetoggle":Oe=uM}var yt=(c&4)!==0,ur=!yt&&(s==="scroll"||s==="scrollend"),we=yt?Te!==null?Te+"Capture":null:Te;yt=[];for(var pe=Ae,Ee;pe!==null;){var $e=pe;if(Ee=$e.stateNode,$e=$e.tag,$e!==5&&$e!==26&&$e!==27||Ee===null||we===null||($e=xu(pe,we),$e!=null&&yt.push(Qu(pe,$e,Ee))),ur)break;pe=pe.return}0<yt.length&&(Te=new Oe(Te,wt,null,d,Le),qe.push({event:Te,listeners:yt}))}}if((c&7)===0){e:{if(Te=s==="mouseover"||s==="pointerover",Oe=s==="mouseout"||s==="pointerout",Te&&d!==Jp&&(wt=d.relatedTarget||d.fromElement)&&(J(wt)||wt[$a]))break e;if((Oe||Te)&&(Te=Le.window===Le?Le:(Te=Le.ownerDocument)?Te.defaultView||Te.parentWindow:window,Oe?(wt=d.relatedTarget||d.toElement,Oe=Ae,wt=wt?J(wt):null,wt!==null&&(ur=i(wt),yt=wt.tag,wt!==ur||yt!==5&&yt!==27&&yt!==6)&&(wt=null)):(Oe=null,wt=Ae),Oe!==wt)){if(yt=MS,$e="onMouseLeave",we="onMouseEnter",pe="mouse",(s==="pointerout"||s==="pointerover")&&(yt=IS,$e="onPointerLeave",we="onPointerEnter",pe="pointer"),ur=Oe==null?Te:ie(Oe),Ee=wt==null?Te:ie(wt),Te=new yt($e,pe+"leave",Oe,d,Le),Te.target=ur,Te.relatedTarget=Ee,$e=null,J(Le)===Ae&&(yt=new yt(we,pe+"enter",wt,d,Le),yt.target=Ee,yt.relatedTarget=ur,$e=yt),ur=$e,Oe&&wt)t:{for(yt=Oe,we=wt,pe=0,Ee=yt;Ee;Ee=gc(Ee))pe++;for(Ee=0,$e=we;$e;$e=gc($e))Ee++;for(;0<pe-Ee;)yt=gc(yt),pe--;for(;0<Ee-pe;)we=gc(we),Ee--;for(;pe--;){if(yt===we||we!==null&&yt===we.alternate)break t;yt=gc(yt),we=gc(we)}yt=null}else yt=null;Oe!==null&&AE(qe,Te,Oe,yt,!1),wt!==null&&ur!==null&&AE(qe,ur,wt,yt,!0)}}e:{if(Te=Ae?ie(Ae):window,Oe=Te.nodeName&&Te.nodeName.toLowerCase(),Oe==="select"||Oe==="input"&&Te.type==="file")var dt=VS;else if(HS(Te))if(KS)dt=bM;else{dt=gM;var Mt=vM}else Oe=Te.nodeName,!Oe||Oe.toLowerCase()!=="input"||Te.type!=="checkbox"&&Te.type!=="radio"?Ae&&Qp(Ae.elementType)&&(dt=VS):dt=yM;if(dt&&(dt=dt(s,Ae))){qS(qe,dt,d,Le);break e}Mt&&Mt(s,Te,Ae),s==="focusout"&&Ae&&Te.type==="number"&&Ae.memoizedProps.value!=null&&Zp(Te,"number",Te.value)}switch(Mt=Ae?ie(Ae):window,s){case"focusin":(HS(Mt)||Mt.contentEditable==="true")&&(Wo=Mt,fx=Ae,Nu=null);break;case"focusout":Nu=fx=Wo=null;break;case"mousedown":hx=!0;break;case"contextmenu":case"mouseup":case"dragend":hx=!1,ej(qe,d,Le);break;case"selectionchange":if(SM)break;case"keydown":case"keyup":ej(qe,d,Le)}var pt;if(ox)e:{switch(s){case"compositionstart":var bt="onCompositionStart";break e;case"compositionend":bt="onCompositionEnd";break e;case"compositionupdate":bt="onCompositionUpdate";break e}bt=void 0}else Go?$S(s,d)&&(bt="onCompositionEnd"):s==="keydown"&&d.keyCode===229&&(bt="onCompositionStart");bt&&(LS&&d.locale!=="ko"&&(Go||bt!=="onCompositionStart"?bt==="onCompositionEnd"&&Go&&(pt=PS()):(Ks=Le,nx="value"in Ks?Ks.value:Ks.textContent,Go=!0)),Mt=I0(Ae,bt),0<Mt.length&&(bt=new FS(bt,s,null,d,Le),qe.push({event:bt,listeners:Mt}),pt?bt.data=pt:(pt=zS(d),pt!==null&&(bt.data=pt)))),(pt=fM?hM(s,d):mM(s,d))&&(bt=I0(Ae,"onBeforeInput"),0<bt.length&&(Mt=new FS("onBeforeInput","beforeinput",null,d,Le),qe.push({event:Mt,listeners:bt}),Mt.data=pt)),aF(qe,s,Ae,d,Le)}NE(qe,c)})}function Qu(s,c,d){return{instance:s,listener:c,currentTarget:d}}function I0(s,c){for(var d=c+"Capture",p=[];s!==null;){var j=s,E=j.stateNode;if(j=j.tag,j!==5&&j!==26&&j!==27||E===null||(j=xu(s,d),j!=null&&p.unshift(Qu(s,j,E)),j=xu(s,c),j!=null&&p.push(Qu(s,j,E))),s.tag===3)return p;s=s.return}return[]}function gc(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function AE(s,c,d,p,j){for(var E=c._reactName,D=[];d!==null&&d!==p;){var U=d,le=U.alternate,Ae=U.stateNode;if(U=U.tag,le!==null&&le===p)break;U!==5&&U!==26&&U!==27||Ae===null||(le=Ae,j?(Ae=xu(d,E),Ae!=null&&D.unshift(Qu(d,Ae,le))):j||(Ae=xu(d,E),Ae!=null&&D.push(Qu(d,Ae,le)))),d=d.return}D.length!==0&&s.push({event:c,listeners:D})}var oF=/\r\n?/g,cF=/\u0000|\uFFFD/g;function _E(s){return(typeof s=="string"?s:""+s).replace(oF,`
`).replace(cF,"")}function TE(s,c){return c=_E(c),_E(s)===c}function L0(){}function cr(s,c,d,p,j,E){switch(d){case"children":typeof p=="string"?c==="body"||c==="textarea"&&p===""||qo(s,p):(typeof p=="number"||typeof p=="bigint")&&c!=="body"&&qo(s,""+p);break;case"className":jt(s,"class",p);break;case"tabIndex":jt(s,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":jt(s,d,p);break;case"style":CS(s,p,E);break;case"data":if(c!=="object"){jt(s,"data",p);break}case"src":case"href":if(p===""&&(c!=="a"||d!=="href")){s.removeAttribute(d);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){s.removeAttribute(d);break}p=Kf(""+p),s.setAttribute(d,p);break;case"action":case"formAction":if(typeof p=="function"){s.setAttribute(d,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof E=="function"&&(d==="formAction"?(c!=="input"&&cr(s,c,"name",j.name,j,null),cr(s,c,"formEncType",j.formEncType,j,null),cr(s,c,"formMethod",j.formMethod,j,null),cr(s,c,"formTarget",j.formTarget,j,null)):(cr(s,c,"encType",j.encType,j,null),cr(s,c,"method",j.method,j,null),cr(s,c,"target",j.target,j,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){s.removeAttribute(d);break}p=Kf(""+p),s.setAttribute(d,p);break;case"onClick":p!=null&&(s.onclick=L0);break;case"onScroll":p!=null&&Lt("scroll",s);break;case"onScrollEnd":p!=null&&Lt("scrollend",s);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(n(61));if(d=p.__html,d!=null){if(j.children!=null)throw Error(n(60));s.innerHTML=d}}break;case"multiple":s.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":s.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){s.removeAttribute("xlink:href");break}d=Kf(""+p),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",d);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?s.setAttribute(d,""+p):s.removeAttribute(d);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?s.setAttribute(d,""):s.removeAttribute(d);break;case"capture":case"download":p===!0?s.setAttribute(d,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?s.setAttribute(d,p):s.removeAttribute(d);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?s.setAttribute(d,p):s.removeAttribute(d);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?s.removeAttribute(d):s.setAttribute(d,p);break;case"popover":Lt("beforetoggle",s),Lt("toggle",s),Nt(s,"popover",p);break;case"xlinkActuate":Rt(s,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":Rt(s,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":Rt(s,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":Rt(s,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":Rt(s,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":Rt(s,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":Rt(s,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":Rt(s,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":Rt(s,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":Nt(s,"is",p);break;case"innerText":case"textContent":break;default:(!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(d=B8.get(d)||d,Nt(s,d,p))}}function Fv(s,c,d,p,j,E){switch(d){case"style":CS(s,p,E);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(n(61));if(d=p.__html,d!=null){if(j.children!=null)throw Error(n(60));s.innerHTML=d}}break;case"children":typeof p=="string"?qo(s,p):(typeof p=="number"||typeof p=="bigint")&&qo(s,""+p);break;case"onScroll":p!=null&&Lt("scroll",s);break;case"onScrollEnd":p!=null&&Lt("scrollend",s);break;case"onClick":p!=null&&(s.onclick=L0);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!je.hasOwnProperty(d))e:{if(d[0]==="o"&&d[1]==="n"&&(j=d.endsWith("Capture"),c=d.slice(2,j?d.length-7:void 0),E=s[kr]||null,E=E!=null?E[d]:null,typeof E=="function"&&s.removeEventListener(c,E,j),typeof p=="function")){typeof E!="function"&&E!==null&&(d in s?s[d]=null:s.hasAttribute(d)&&s.removeAttribute(d)),s.addEventListener(c,p,j);break e}d in s?s[d]=p:p===!0?s.setAttribute(d,""):Nt(s,d,p)}}}function bn(s,c,d){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Lt("error",s),Lt("load",s);var p=!1,j=!1,E;for(E in d)if(d.hasOwnProperty(E)){var D=d[E];if(D!=null)switch(E){case"src":p=!0;break;case"srcSet":j=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,c));default:cr(s,c,E,D,d,null)}}j&&cr(s,c,"srcSet",d.srcSet,d,null),p&&cr(s,c,"src",d.src,d,null);return;case"input":Lt("invalid",s);var U=E=D=j=null,le=null,Ae=null;for(p in d)if(d.hasOwnProperty(p)){var Le=d[p];if(Le!=null)switch(p){case"name":j=Le;break;case"type":D=Le;break;case"checked":le=Le;break;case"defaultChecked":Ae=Le;break;case"value":E=Le;break;case"defaultValue":U=Le;break;case"children":case"dangerouslySetInnerHTML":if(Le!=null)throw Error(n(137,c));break;default:cr(s,c,p,Le,d,null)}}AS(s,E,U,le,Ae,D,j,!1),vt(s);return;case"select":Lt("invalid",s),p=D=E=null;for(j in d)if(d.hasOwnProperty(j)&&(U=d[j],U!=null))switch(j){case"value":E=U;break;case"defaultValue":D=U;break;case"multiple":p=U;default:cr(s,c,j,U,d,null)}c=E,d=D,s.multiple=!!p,c!=null?Ho(s,!!p,c,!1):d!=null&&Ho(s,!!p,d,!0);return;case"textarea":Lt("invalid",s),E=j=p=null;for(D in d)if(d.hasOwnProperty(D)&&(U=d[D],U!=null))switch(D){case"value":p=U;break;case"defaultValue":j=U;break;case"children":E=U;break;case"dangerouslySetInnerHTML":if(U!=null)throw Error(n(91));break;default:cr(s,c,D,U,d,null)}TS(s,p,j,E),vt(s);return;case"option":for(le in d)if(d.hasOwnProperty(le)&&(p=d[le],p!=null))switch(le){case"selected":s.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:cr(s,c,le,p,d,null)}return;case"dialog":Lt("beforetoggle",s),Lt("toggle",s),Lt("cancel",s),Lt("close",s);break;case"iframe":case"object":Lt("load",s);break;case"video":case"audio":for(p=0;p<Zu.length;p++)Lt(Zu[p],s);break;case"image":Lt("error",s),Lt("load",s);break;case"details":Lt("toggle",s);break;case"embed":case"source":case"link":Lt("error",s),Lt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ae in d)if(d.hasOwnProperty(Ae)&&(p=d[Ae],p!=null))switch(Ae){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,c));default:cr(s,c,Ae,p,d,null)}return;default:if(Qp(c)){for(Le in d)d.hasOwnProperty(Le)&&(p=d[Le],p!==void 0&&Fv(s,c,Le,p,d,void 0));return}}for(U in d)d.hasOwnProperty(U)&&(p=d[U],p!=null&&cr(s,c,U,p,d,null))}function uF(s,c,d,p){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var j=null,E=null,D=null,U=null,le=null,Ae=null,Le=null;for(Oe in d){var qe=d[Oe];if(d.hasOwnProperty(Oe)&&qe!=null)switch(Oe){case"checked":break;case"value":break;case"defaultValue":le=qe;default:p.hasOwnProperty(Oe)||cr(s,c,Oe,null,p,qe)}}for(var Te in p){var Oe=p[Te];if(qe=d[Te],p.hasOwnProperty(Te)&&(Oe!=null||qe!=null))switch(Te){case"type":E=Oe;break;case"name":j=Oe;break;case"checked":Ae=Oe;break;case"defaultChecked":Le=Oe;break;case"value":D=Oe;break;case"defaultValue":U=Oe;break;case"children":case"dangerouslySetInnerHTML":if(Oe!=null)throw Error(n(137,c));break;default:Oe!==qe&&cr(s,c,Te,Oe,p,qe)}}Yp(s,D,U,le,Ae,Le,E,j);return;case"select":Oe=D=U=Te=null;for(E in d)if(le=d[E],d.hasOwnProperty(E)&&le!=null)switch(E){case"value":break;case"multiple":Oe=le;default:p.hasOwnProperty(E)||cr(s,c,E,null,p,le)}for(j in p)if(E=p[j],le=d[j],p.hasOwnProperty(j)&&(E!=null||le!=null))switch(j){case"value":Te=E;break;case"defaultValue":U=E;break;case"multiple":D=E;default:E!==le&&cr(s,c,j,E,p,le)}c=U,d=D,p=Oe,Te!=null?Ho(s,!!d,Te,!1):!!p!=!!d&&(c!=null?Ho(s,!!d,c,!0):Ho(s,!!d,d?[]:"",!1));return;case"textarea":Oe=Te=null;for(U in d)if(j=d[U],d.hasOwnProperty(U)&&j!=null&&!p.hasOwnProperty(U))switch(U){case"value":break;case"children":break;default:cr(s,c,U,null,p,j)}for(D in p)if(j=p[D],E=d[D],p.hasOwnProperty(D)&&(j!=null||E!=null))switch(D){case"value":Te=j;break;case"defaultValue":Oe=j;break;case"children":break;case"dangerouslySetInnerHTML":if(j!=null)throw Error(n(91));break;default:j!==E&&cr(s,c,D,j,p,E)}_S(s,Te,Oe);return;case"option":for(var wt in d)if(Te=d[wt],d.hasOwnProperty(wt)&&Te!=null&&!p.hasOwnProperty(wt))switch(wt){case"selected":s.selected=!1;break;default:cr(s,c,wt,null,p,Te)}for(le in p)if(Te=p[le],Oe=d[le],p.hasOwnProperty(le)&&Te!==Oe&&(Te!=null||Oe!=null))switch(le){case"selected":s.selected=Te&&typeof Te!="function"&&typeof Te!="symbol";break;default:cr(s,c,le,Te,p,Oe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var yt in d)Te=d[yt],d.hasOwnProperty(yt)&&Te!=null&&!p.hasOwnProperty(yt)&&cr(s,c,yt,null,p,Te);for(Ae in p)if(Te=p[Ae],Oe=d[Ae],p.hasOwnProperty(Ae)&&Te!==Oe&&(Te!=null||Oe!=null))switch(Ae){case"children":case"dangerouslySetInnerHTML":if(Te!=null)throw Error(n(137,c));break;default:cr(s,c,Ae,Te,p,Oe)}return;default:if(Qp(c)){for(var ur in d)Te=d[ur],d.hasOwnProperty(ur)&&Te!==void 0&&!p.hasOwnProperty(ur)&&Fv(s,c,ur,void 0,p,Te);for(Le in p)Te=p[Le],Oe=d[Le],!p.hasOwnProperty(Le)||Te===Oe||Te===void 0&&Oe===void 0||Fv(s,c,Le,Te,p,Oe);return}}for(var we in d)Te=d[we],d.hasOwnProperty(we)&&Te!=null&&!p.hasOwnProperty(we)&&cr(s,c,we,null,p,Te);for(qe in p)Te=p[qe],Oe=d[qe],!p.hasOwnProperty(qe)||Te===Oe||Te==null&&Oe==null||cr(s,c,qe,Te,p,Oe)}var Iv=null,Lv=null;function B0(s){return s.nodeType===9?s:s.ownerDocument}function kE(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function CE(s,c){if(s===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&c==="foreignObject"?0:s}function Bv(s,c){return s==="textarea"||s==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var Uv=null;function dF(){var s=window.event;return s&&s.type==="popstate"?s===Uv?!1:(Uv=s,!0):(Uv=null,!1)}var OE=typeof setTimeout=="function"?setTimeout:void 0,fF=typeof clearTimeout=="function"?clearTimeout:void 0,DE=typeof Promise=="function"?Promise:void 0,hF=typeof queueMicrotask=="function"?queueMicrotask:typeof DE<"u"?function(s){return DE.resolve(null).then(s).catch(mF)}:OE;function mF(s){setTimeout(function(){throw s})}function ol(s){return s==="head"}function PE(s,c){var d=c,p=0,j=0;do{var E=d.nextSibling;if(s.removeChild(d),E&&E.nodeType===8)if(d=E.data,d==="/$"){if(0<p&&8>p){d=p;var D=s.ownerDocument;if(d&1&&Ju(D.documentElement),d&2&&Ju(D.body),d&4)for(d=D.head,Ju(d),D=d.firstChild;D;){var U=D.nextSibling,le=D.nodeName;D[V]||le==="SCRIPT"||le==="STYLE"||le==="LINK"&&D.rel.toLowerCase()==="stylesheet"||d.removeChild(D),D=U}}if(j===0){s.removeChild(E),ld(c);return}j--}else d==="$"||d==="$?"||d==="$!"?j++:p=d.charCodeAt(0)-48;else p=0;d=E}while(d);ld(c)}function $v(s){var c=s.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var d=c;switch(c=c.nextSibling,d.nodeName){case"HTML":case"HEAD":case"BODY":$v(d),X(d);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(d.rel.toLowerCase()==="stylesheet")continue}s.removeChild(d)}}function pF(s,c,d,p){for(;s.nodeType===1;){var j=d;if(s.nodeName.toLowerCase()!==c.toLowerCase()){if(!p&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(p){if(!s[V])switch(c){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(E=s.getAttribute("rel"),E==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(E!==j.rel||s.getAttribute("href")!==(j.href==null||j.href===""?null:j.href)||s.getAttribute("crossorigin")!==(j.crossOrigin==null?null:j.crossOrigin)||s.getAttribute("title")!==(j.title==null?null:j.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(E=s.getAttribute("src"),(E!==(j.src==null?null:j.src)||s.getAttribute("type")!==(j.type==null?null:j.type)||s.getAttribute("crossorigin")!==(j.crossOrigin==null?null:j.crossOrigin))&&E&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(c==="input"&&s.type==="hidden"){var E=j.name==null?null:""+j.name;if(j.type==="hidden"&&s.getAttribute("name")===E)return s}else return s;if(s=yi(s.nextSibling),s===null)break}return null}function xF(s,c,d){if(c==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!d||(s=yi(s.nextSibling),s===null))return null;return s}function zv(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function vF(s,c){var d=s.ownerDocument;if(s.data!=="$?"||d.readyState==="complete")c();else{var p=function(){c(),d.removeEventListener("DOMContentLoaded",p)};d.addEventListener("DOMContentLoaded",p),s._reactRetry=p}}function yi(s){for(;s!=null;s=s.nextSibling){var c=s.nodeType;if(c===1||c===3)break;if(c===8){if(c=s.data,c==="$"||c==="$!"||c==="$?"||c==="F!"||c==="F")break;if(c==="/$")return null}}return s}var Hv=null;function RE(s){s=s.previousSibling;for(var c=0;s;){if(s.nodeType===8){var d=s.data;if(d==="$"||d==="$!"||d==="$?"){if(c===0)return s;c--}else d==="/$"&&c++}s=s.previousSibling}return null}function ME(s,c,d){switch(c=B0(d),s){case"html":if(s=c.documentElement,!s)throw Error(n(452));return s;case"head":if(s=c.head,!s)throw Error(n(453));return s;case"body":if(s=c.body,!s)throw Error(n(454));return s;default:throw Error(n(451))}}function Ju(s){for(var c=s.attributes;c.length;)s.removeAttributeNode(c[0]);X(s)}var Wa=new Map,FE=new Set;function U0(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var vs=H.d;H.d={f:gF,r:yF,D:bF,C:wF,L:SF,m:jF,X:EF,S:NF,M:AF};function gF(){var s=vs.f(),c=O0();return s||c}function yF(s){var c=re(s);c!==null&&c.tag===5&&c.type==="form"?rN(c):vs.r(s)}var yc=typeof document>"u"?null:document;function IE(s,c,d){var p=yc;if(p&&typeof c=="string"&&c){var j=Qt(c);j='link[rel="'+s+'"][href="'+j+'"]',typeof d=="string"&&(j+='[crossorigin="'+d+'"]'),FE.has(j)||(FE.add(j),s={rel:s,crossOrigin:d,href:c},p.querySelector(j)===null&&(c=p.createElement("link"),bn(c,"link",s),ce(c),p.head.appendChild(c)))}}function bF(s){vs.D(s),IE("dns-prefetch",s,null)}function wF(s,c){vs.C(s,c),IE("preconnect",s,c)}function SF(s,c,d){vs.L(s,c,d);var p=yc;if(p&&s&&c){var j='link[rel="preload"][as="'+Qt(c)+'"]';c==="image"&&d&&d.imageSrcSet?(j+='[imagesrcset="'+Qt(d.imageSrcSet)+'"]',typeof d.imageSizes=="string"&&(j+='[imagesizes="'+Qt(d.imageSizes)+'"]')):j+='[href="'+Qt(s)+'"]';var E=j;switch(c){case"style":E=bc(s);break;case"script":E=wc(s)}Wa.has(E)||(s=h({rel:"preload",href:c==="image"&&d&&d.imageSrcSet?void 0:s,as:c},d),Wa.set(E,s),p.querySelector(j)!==null||c==="style"&&p.querySelector(ed(E))||c==="script"&&p.querySelector(td(E))||(c=p.createElement("link"),bn(c,"link",s),ce(c),p.head.appendChild(c)))}}function jF(s,c){vs.m(s,c);var d=yc;if(d&&s){var p=c&&typeof c.as=="string"?c.as:"script",j='link[rel="modulepreload"][as="'+Qt(p)+'"][href="'+Qt(s)+'"]',E=j;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":E=wc(s)}if(!Wa.has(E)&&(s=h({rel:"modulepreload",href:s},c),Wa.set(E,s),d.querySelector(j)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(d.querySelector(td(E)))return}p=d.createElement("link"),bn(p,"link",s),ce(p),d.head.appendChild(p)}}}function NF(s,c,d){vs.S(s,c,d);var p=yc;if(p&&s){var j=ve(p).hoistableStyles,E=bc(s);c=c||"default";var D=j.get(E);if(!D){var U={loading:0,preload:null};if(D=p.querySelector(ed(E)))U.loading=5;else{s=h({rel:"stylesheet",href:s,"data-precedence":c},d),(d=Wa.get(E))&&qv(s,d);var le=D=p.createElement("link");ce(le),bn(le,"link",s),le._p=new Promise(function(Ae,Le){le.onload=Ae,le.onerror=Le}),le.addEventListener("load",function(){U.loading|=1}),le.addEventListener("error",function(){U.loading|=2}),U.loading|=4,$0(D,c,p)}D={type:"stylesheet",instance:D,count:1,state:U},j.set(E,D)}}}function EF(s,c){vs.X(s,c);var d=yc;if(d&&s){var p=ve(d).hoistableScripts,j=wc(s),E=p.get(j);E||(E=d.querySelector(td(j)),E||(s=h({src:s,async:!0},c),(c=Wa.get(j))&&Vv(s,c),E=d.createElement("script"),ce(E),bn(E,"link",s),d.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},p.set(j,E))}}function AF(s,c){vs.M(s,c);var d=yc;if(d&&s){var p=ve(d).hoistableScripts,j=wc(s),E=p.get(j);E||(E=d.querySelector(td(j)),E||(s=h({src:s,async:!0,type:"module"},c),(c=Wa.get(j))&&Vv(s,c),E=d.createElement("script"),ce(E),bn(E,"link",s),d.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},p.set(j,E))}}function LE(s,c,d,p){var j=(j=L.current)?U0(j):null;if(!j)throw Error(n(446));switch(s){case"meta":case"title":return null;case"style":return typeof d.precedence=="string"&&typeof d.href=="string"?(c=bc(d.href),d=ve(j).hoistableStyles,p=d.get(c),p||(p={type:"style",instance:null,count:0,state:null},d.set(c,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(d.rel==="stylesheet"&&typeof d.href=="string"&&typeof d.precedence=="string"){s=bc(d.href);var E=ve(j).hoistableStyles,D=E.get(s);if(D||(j=j.ownerDocument||j,D={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},E.set(s,D),(E=j.querySelector(ed(s)))&&!E._p&&(D.instance=E,D.state.loading=5),Wa.has(s)||(d={rel:"preload",as:"style",href:d.href,crossOrigin:d.crossOrigin,integrity:d.integrity,media:d.media,hrefLang:d.hrefLang,referrerPolicy:d.referrerPolicy},Wa.set(s,d),E||_F(j,s,d,D.state))),c&&p===null)throw Error(n(528,""));return D}if(c&&p!==null)throw Error(n(529,""));return null;case"script":return c=d.async,d=d.src,typeof d=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=wc(d),d=ve(j).hoistableScripts,p=d.get(c),p||(p={type:"script",instance:null,count:0,state:null},d.set(c,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,s))}}function bc(s){return'href="'+Qt(s)+'"'}function ed(s){return'link[rel="stylesheet"]['+s+"]"}function BE(s){return h({},s,{"data-precedence":s.precedence,precedence:null})}function _F(s,c,d,p){s.querySelector('link[rel="preload"][as="style"]['+c+"]")?p.loading=1:(c=s.createElement("link"),p.preload=c,c.addEventListener("load",function(){return p.loading|=1}),c.addEventListener("error",function(){return p.loading|=2}),bn(c,"link",d),ce(c),s.head.appendChild(c))}function wc(s){return'[src="'+Qt(s)+'"]'}function td(s){return"script[async]"+s}function UE(s,c,d){if(c.count++,c.instance===null)switch(c.type){case"style":var p=s.querySelector('style[data-href~="'+Qt(d.href)+'"]');if(p)return c.instance=p,ce(p),p;var j=h({},d,{"data-href":d.href,"data-precedence":d.precedence,href:null,precedence:null});return p=(s.ownerDocument||s).createElement("style"),ce(p),bn(p,"style",j),$0(p,d.precedence,s),c.instance=p;case"stylesheet":j=bc(d.href);var E=s.querySelector(ed(j));if(E)return c.state.loading|=4,c.instance=E,ce(E),E;p=BE(d),(j=Wa.get(j))&&qv(p,j),E=(s.ownerDocument||s).createElement("link"),ce(E);var D=E;return D._p=new Promise(function(U,le){D.onload=U,D.onerror=le}),bn(E,"link",p),c.state.loading|=4,$0(E,d.precedence,s),c.instance=E;case"script":return E=wc(d.src),(j=s.querySelector(td(E)))?(c.instance=j,ce(j),j):(p=d,(j=Wa.get(E))&&(p=h({},d),Vv(p,j)),s=s.ownerDocument||s,j=s.createElement("script"),ce(j),bn(j,"link",p),s.head.appendChild(j),c.instance=j);case"void":return null;default:throw Error(n(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(p=c.instance,c.state.loading|=4,$0(p,d.precedence,s));return c.instance}function $0(s,c,d){for(var p=d.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),j=p.length?p[p.length-1]:null,E=j,D=0;D<p.length;D++){var U=p[D];if(U.dataset.precedence===c)E=U;else if(E!==j)break}E?E.parentNode.insertBefore(s,E.nextSibling):(c=d.nodeType===9?d.head:d,c.insertBefore(s,c.firstChild))}function qv(s,c){s.crossOrigin==null&&(s.crossOrigin=c.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=c.referrerPolicy),s.title==null&&(s.title=c.title)}function Vv(s,c){s.crossOrigin==null&&(s.crossOrigin=c.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=c.referrerPolicy),s.integrity==null&&(s.integrity=c.integrity)}var z0=null;function $E(s,c,d){if(z0===null){var p=new Map,j=z0=new Map;j.set(d,p)}else j=z0,p=j.get(d),p||(p=new Map,j.set(d,p));if(p.has(s))return p;for(p.set(s,null),d=d.getElementsByTagName(s),j=0;j<d.length;j++){var E=d[j];if(!(E[V]||E[Tr]||s==="link"&&E.getAttribute("rel")==="stylesheet")&&E.namespaceURI!=="http://www.w3.org/2000/svg"){var D=E.getAttribute(c)||"";D=s+D;var U=p.get(D);U?U.push(E):p.set(D,[E])}}return p}function zE(s,c,d){s=s.ownerDocument||s,s.head.insertBefore(d,c==="title"?s.querySelector("head > title"):null)}function TF(s,c,d){if(d===1||c.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;switch(c.rel){case"stylesheet":return s=c.disabled,typeof c.precedence=="string"&&s==null;default:return!0}case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function HE(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var rd=null;function kF(){}function CF(s,c,d){if(rd===null)throw Error(n(475));var p=rd;if(c.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var j=bc(d.href),E=s.querySelector(ed(j));if(E){s=E._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(p.count++,p=H0.bind(p),s.then(p,p)),c.state.loading|=4,c.instance=E,ce(E);return}E=s.ownerDocument||s,d=BE(d),(j=Wa.get(j))&&qv(d,j),E=E.createElement("link"),ce(E);var D=E;D._p=new Promise(function(U,le){D.onload=U,D.onerror=le}),bn(E,"link",d),c.instance=E}p.stylesheets===null&&(p.stylesheets=new Map),p.stylesheets.set(c,s),(s=c.state.preload)&&(c.state.loading&3)===0&&(p.count++,c=H0.bind(p),s.addEventListener("load",c),s.addEventListener("error",c))}}function OF(){if(rd===null)throw Error(n(475));var s=rd;return s.stylesheets&&s.count===0&&Kv(s,s.stylesheets),0<s.count?function(c){var d=setTimeout(function(){if(s.stylesheets&&Kv(s,s.stylesheets),s.unsuspend){var p=s.unsuspend;s.unsuspend=null,p()}},6e4);return s.unsuspend=c,function(){s.unsuspend=null,clearTimeout(d)}}:null}function H0(){if(this.count--,this.count===0){if(this.stylesheets)Kv(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var q0=null;function Kv(s,c){s.stylesheets=null,s.unsuspend!==null&&(s.count++,q0=new Map,c.forEach(DF,s),q0=null,H0.call(s))}function DF(s,c){if(!(c.state.loading&4)){var d=q0.get(s);if(d)var p=d.get(null);else{d=new Map,q0.set(s,d);for(var j=s.querySelectorAll("link[data-precedence],style[data-precedence]"),E=0;E<j.length;E++){var D=j[E];(D.nodeName==="LINK"||D.getAttribute("media")!=="not all")&&(d.set(D.dataset.precedence,D),p=D)}p&&d.set(null,p)}j=c.instance,D=j.getAttribute("data-precedence"),E=d.get(D)||p,E===p&&d.set(null,j),d.set(D,j),this.count++,p=H0.bind(this),j.addEventListener("load",p),j.addEventListener("error",p),E?E.parentNode.insertBefore(j,E.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(j,s.firstChild)),c.state.loading|=4}}var nd={$$typeof:A,Provider:null,Consumer:null,_currentValue:be,_currentValue2:be,_threadCount:0};function PF(s,c,d,p,j,E,D,U){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=er(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=er(0),this.hiddenUpdates=er(null),this.identifierPrefix=p,this.onUncaughtError=j,this.onCaughtError=E,this.onRecoverableError=D,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=U,this.incompleteTransitions=new Map}function qE(s,c,d,p,j,E,D,U,le,Ae,Le,qe){return s=new PF(s,c,d,D,U,le,Ae,qe),c=1,E===!0&&(c|=24),E=pa(3,null,null,c),s.current=E,E.stateNode=s,c=_x(),c.refCount++,s.pooledCache=c,c.refCount++,E.memoizedState={element:p,isDehydrated:d,cache:c},Ox(E),s}function VE(s){return s?(s=Qo,s):Qo}function KE(s,c,d,p,j,E){j=VE(j),p.context===null?p.context=j:p.pendingContext=j,p=Xs(c),p.payload={element:d},E=E===void 0?null:E,E!==null&&(p.callback=E),d=Ys(s,p,c),d!==null&&(ba(d,s,c),Pu(d,s,c))}function GE(s,c){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var d=s.retryLane;s.retryLane=d!==0&&d<c?d:c}}function Gv(s,c){GE(s,c),(s=s.alternate)&&GE(s,c)}function WE(s){if(s.tag===13){var c=Zo(s,67108864);c!==null&&ba(c,s,67108864),Gv(s,67108864)}}var V0=!0;function RF(s,c,d,p){var j=K.T;K.T=null;var E=H.p;try{H.p=2,Wv(s,c,d,p)}finally{H.p=E,K.T=j}}function MF(s,c,d,p){var j=K.T;K.T=null;var E=H.p;try{H.p=8,Wv(s,c,d,p)}finally{H.p=E,K.T=j}}function Wv(s,c,d,p){if(V0){var j=Xv(p);if(j===null)Mv(s,c,p,K0,d),YE(s,p);else if(IF(j,s,c,d,p))p.stopPropagation();else if(YE(s,p),c&4&&-1<FF.indexOf(s)){for(;j!==null;){var E=re(j);if(E!==null)switch(E.tag){case 3:if(E=E.stateNode,E.current.memoizedState.isDehydrated){var D=lr(E.pendingLanes);if(D!==0){var U=E;for(U.pendingLanes|=2,U.entangledLanes|=2;D;){var le=1<<31-rt(D);U.entanglements[1]|=le,D&=~le}Ui(E),(nr&6)===0&&(k0=oe()+500,Yu(0))}}break;case 13:U=Zo(E,2),U!==null&&ba(U,E,2),O0(),Gv(E,2)}if(E=Xv(p),E===null&&Mv(s,c,p,K0,d),E===j)break;j=E}j!==null&&p.stopPropagation()}else Mv(s,c,p,null,d)}}function Xv(s){return s=ex(s),Yv(s)}var K0=null;function Yv(s){if(K0=null,s=J(s),s!==null){var c=i(s);if(c===null)s=null;else{var d=c.tag;if(d===13){if(s=o(c),s!==null)return s;s=null}else if(d===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;s=null}else c!==s&&(s=null)}}return K0=s,null}function XE(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ke()){case Ge:return 2;case Fe:return 8;case Be:case xt:return 32;case Ze:return 268435456;default:return 32}default:return 32}}var Zv=!1,cl=null,ul=null,dl=null,ad=new Map,id=new Map,fl=[],FF="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function YE(s,c){switch(s){case"focusin":case"focusout":cl=null;break;case"dragenter":case"dragleave":ul=null;break;case"mouseover":case"mouseout":dl=null;break;case"pointerover":case"pointerout":ad.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":id.delete(c.pointerId)}}function sd(s,c,d,p,j,E){return s===null||s.nativeEvent!==E?(s={blockedOn:c,domEventName:d,eventSystemFlags:p,nativeEvent:E,targetContainers:[j]},c!==null&&(c=re(c),c!==null&&WE(c)),s):(s.eventSystemFlags|=p,c=s.targetContainers,j!==null&&c.indexOf(j)===-1&&c.push(j),s)}function IF(s,c,d,p,j){switch(c){case"focusin":return cl=sd(cl,s,c,d,p,j),!0;case"dragenter":return ul=sd(ul,s,c,d,p,j),!0;case"mouseover":return dl=sd(dl,s,c,d,p,j),!0;case"pointerover":var E=j.pointerId;return ad.set(E,sd(ad.get(E)||null,s,c,d,p,j)),!0;case"gotpointercapture":return E=j.pointerId,id.set(E,sd(id.get(E)||null,s,c,d,p,j)),!0}return!1}function ZE(s){var c=J(s.target);if(c!==null){var d=i(c);if(d!==null){if(c=d.tag,c===13){if(c=o(d),c!==null){s.blockedOn=c,Ri(s.priority,function(){if(d.tag===13){var p=ya();p=Ot(p);var j=Zo(d,p);j!==null&&ba(j,d,p),Gv(d,p)}});return}}else if(c===3&&d.stateNode.current.memoizedState.isDehydrated){s.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}s.blockedOn=null}function G0(s){if(s.blockedOn!==null)return!1;for(var c=s.targetContainers;0<c.length;){var d=Xv(s.nativeEvent);if(d===null){d=s.nativeEvent;var p=new d.constructor(d.type,d);Jp=p,d.target.dispatchEvent(p),Jp=null}else return c=re(d),c!==null&&WE(c),s.blockedOn=d,!1;c.shift()}return!0}function QE(s,c,d){G0(s)&&d.delete(c)}function LF(){Zv=!1,cl!==null&&G0(cl)&&(cl=null),ul!==null&&G0(ul)&&(ul=null),dl!==null&&G0(dl)&&(dl=null),ad.forEach(QE),id.forEach(QE)}function W0(s,c){s.blockedOn===c&&(s.blockedOn=null,Zv||(Zv=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,LF)))}var X0=null;function JE(s){X0!==s&&(X0=s,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){X0===s&&(X0=null);for(var c=0;c<s.length;c+=3){var d=s[c],p=s[c+1],j=s[c+2];if(typeof p!="function"){if(Yv(p||d)===null)continue;break}var E=re(d);E!==null&&(s.splice(c,3),c-=3,Yx(E,{pending:!0,data:j,method:d.method,action:p},p,j))}}))}function ld(s){function c(le){return W0(le,s)}cl!==null&&W0(cl,s),ul!==null&&W0(ul,s),dl!==null&&W0(dl,s),ad.forEach(c),id.forEach(c);for(var d=0;d<fl.length;d++){var p=fl[d];p.blockedOn===s&&(p.blockedOn=null)}for(;0<fl.length&&(d=fl[0],d.blockedOn===null);)ZE(d),d.blockedOn===null&&fl.shift();if(d=(s.ownerDocument||s).$$reactFormReplay,d!=null)for(p=0;p<d.length;p+=3){var j=d[p],E=d[p+1],D=j[kr]||null;if(typeof E=="function")D||JE(d);else if(D){var U=null;if(E&&E.hasAttribute("formAction")){if(j=E,D=E[kr]||null)U=D.formAction;else if(Yv(j)!==null)continue}else U=D.action;typeof U=="function"?d[p+1]=U:(d.splice(p,3),p-=3),JE(d)}}}function Qv(s){this._internalRoot=s}Y0.prototype.render=Qv.prototype.render=function(s){var c=this._internalRoot;if(c===null)throw Error(n(409));var d=c.current,p=ya();KE(d,p,s,c,null,null)},Y0.prototype.unmount=Qv.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var c=s.containerInfo;KE(s.current,2,null,s,null,null),O0(),c[$a]=null}};function Y0(s){this._internalRoot=s}Y0.prototype.unstable_scheduleHydration=function(s){if(s){var c=zn();s={blockedOn:null,target:s,priority:c};for(var d=0;d<fl.length&&c!==0&&c<fl[d].priority;d++);fl.splice(d,0,s),d===0&&ZE(s)}};var eA=t.version;if(eA!=="19.1.0")throw Error(n(527,eA,"19.1.0"));H.findDOMNode=function(s){var c=s._reactInternals;if(c===void 0)throw typeof s.render=="function"?Error(n(188)):(s=Object.keys(s).join(","),Error(n(268,s)));return s=m(c),s=s!==null?f(s):null,s=s===null?null:s.stateNode,s};var BF={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:K,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Z0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Z0.isDisabled&&Z0.supportsFiber)try{De=Z0.inject(BF),Xe=Z0}catch{}}return cd.createRoot=function(s,c){if(!a(s))throw Error(n(299));var d=!1,p="",j=xN,E=vN,D=gN,U=null;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(p=c.identifierPrefix),c.onUncaughtError!==void 0&&(j=c.onUncaughtError),c.onCaughtError!==void 0&&(E=c.onCaughtError),c.onRecoverableError!==void 0&&(D=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(U=c.unstable_transitionCallbacks)),c=qE(s,1,!1,null,null,d,p,j,E,D,U,null),s[$a]=c.current,Rv(s),new Qv(c)},cd.hydrateRoot=function(s,c,d){if(!a(s))throw Error(n(299));var p=!1,j="",E=xN,D=vN,U=gN,le=null,Ae=null;return d!=null&&(d.unstable_strictMode===!0&&(p=!0),d.identifierPrefix!==void 0&&(j=d.identifierPrefix),d.onUncaughtError!==void 0&&(E=d.onUncaughtError),d.onCaughtError!==void 0&&(D=d.onCaughtError),d.onRecoverableError!==void 0&&(U=d.onRecoverableError),d.unstable_transitionCallbacks!==void 0&&(le=d.unstable_transitionCallbacks),d.formState!==void 0&&(Ae=d.formState)),c=qE(s,1,!0,c,d??null,p,j,E,D,U,le,Ae),c.context=VE(null),d=c.current,p=ya(),p=Ot(p),j=Xs(p),j.callback=null,Ys(d,j,p),d=p,c.current.lanes=d,tr(c,d),Ui(c),s[$a]=c.current,Rv(s),new Y0(c)},cd.version="19.1.0",cd}var uA;function WF(){if(uA)return tg.exports;uA=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),tg.exports=GF(),tg.exports}var XF=WF();const YF=fi(XF);/**
 * react-router v7.9.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var dA="popstate";function ZF(e={}){function t(n,a){let{pathname:i,search:o,hash:u}=n.location;return hy("",{pathname:i,search:o,hash:u},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:Hd(a)}return JF(t,r,null,e)}function Nr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function li(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function QF(){return Math.random().toString(36).substring(2,10)}function fA(e,t){return{usr:e.state,key:e.key,idx:t}}function hy(e,t,r=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?Jc(t):t,state:r,key:t&&t.key||n||QF()}}function Hd({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Jc(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function JF(e,t,r,n={}){let{window:a=document.defaultView,v5Compat:i=!1}=n,o=a.history,u="POP",m=null,f=h();f==null&&(f=0,o.replaceState({...o.state,idx:f},""));function h(){return(o.state||{idx:null}).idx}function x(){u="POP";let S=h(),N=S==null?null:S-f;f=S,m&&m({action:u,location:b.location,delta:N})}function v(S,N){u="PUSH";let _=hy(b.location,S,N);f=h()+1;let A=fA(_,f),k=b.createHref(_);try{o.pushState(A,"",k)}catch(C){if(C instanceof DOMException&&C.name==="DataCloneError")throw C;a.location.assign(k)}i&&m&&m({action:u,location:b.location,delta:1})}function y(S,N){u="REPLACE";let _=hy(b.location,S,N);f=h();let A=fA(_,f),k=b.createHref(_);o.replaceState(A,"",k),i&&m&&m({action:u,location:b.location,delta:0})}function w(S){return eI(S)}let b={get action(){return u},get location(){return e(a,o)},listen(S){if(m)throw new Error("A history only accepts one active listener");return a.addEventListener(dA,x),m=S,()=>{a.removeEventListener(dA,x),m=null}},createHref(S){return t(a,S)},createURL:w,encodeLocation(S){let N=w(S);return{pathname:N.pathname,search:N.search,hash:N.hash}},push:v,replace:y,go(S){return o.go(S)}};return b}function eI(e,t=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),Nr(r,"No window.location.(origin|href) available to create URL");let n=typeof e=="string"?e:Hd(e);return n=n.replace(/ $/,"%20"),!t&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function fC(e,t,r="/"){return tI(e,t,r,!1)}function tI(e,t,r,n){let a=typeof t=="string"?Jc(t):t,i=Os(a.pathname||"/",r);if(i==null)return null;let o=hC(e);rI(o);let u=null;for(let m=0;u==null&&m<o.length;++m){let f=hI(i);u=dI(o[m],f,n)}return u}function hC(e,t=[],r=[],n="",a=!1){let i=(o,u,m=a,f)=>{let h={relativePath:f===void 0?o.path||"":f,caseSensitive:o.caseSensitive===!0,childrenIndex:u,route:o};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(n)&&m)return;Nr(h.relativePath.startsWith(n),`Absolute route path "${h.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(n.length)}let x=Es([n,h.relativePath]),v=r.concat(h);o.children&&o.children.length>0&&(Nr(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${x}".`),hC(o.children,t,v,x,m)),!(o.path==null&&!o.index)&&t.push({path:x,score:cI(x,o.index),routesMeta:v})};return e.forEach((o,u)=>{if(o.path===""||!o.path?.includes("?"))i(o,u);else for(let m of mC(o.path))i(o,u,!0,m)}),t}function mC(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let o=mC(n.join("/")),u=[];return u.push(...o.map(m=>m===""?i:[i,m].join("/"))),a&&u.push(...o),u.map(m=>e.startsWith("/")&&m===""?"/":m)}function rI(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:uI(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var nI=/^:[\w-]+$/,aI=3,iI=2,sI=1,lI=10,oI=-2,hA=e=>e==="*";function cI(e,t){let r=e.split("/"),n=r.length;return r.some(hA)&&(n+=oI),t&&(n+=iI),r.filter(a=>!hA(a)).reduce((a,i)=>a+(nI.test(i)?aI:i===""?sI:lI),n)}function uI(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function dI(e,t,r=!1){let{routesMeta:n}=e,a={},i="/",o=[];for(let u=0;u<n.length;++u){let m=n[u],f=u===n.length-1,h=i==="/"?t:t.slice(i.length)||"/",x=Lh({path:m.relativePath,caseSensitive:m.caseSensitive,end:f},h),v=m.route;if(!x&&f&&r&&!n[n.length-1].route.index&&(x=Lh({path:m.relativePath,caseSensitive:m.caseSensitive,end:!1},h)),!x)return null;Object.assign(a,x.params),o.push({params:a,pathname:Es([i,x.pathname]),pathnameBase:vI(Es([i,x.pathnameBase])),route:v}),x.pathnameBase!=="/"&&(i=Es([i,x.pathnameBase]))}return o}function Lh(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=fI(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),u=a.slice(1);return{params:n.reduce((f,{paramName:h,isOptional:x},v)=>{if(h==="*"){let w=u[v]||"";o=i.slice(0,i.length-w.length).replace(/(.)\/+$/,"$1")}const y=u[v];return x&&!y?f[h]=void 0:f[h]=(y||"").replace(/%2F/g,"/"),f},{}),pathname:i,pathnameBase:o,pattern:e}}function fI(e,t=!1,r=!0){li(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,u,m)=>(n.push({paramName:u,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function hI(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return li(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Os(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function mI(e,t="/"){let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?Jc(e):e;return{pathname:r?r.startsWith("/")?r:pI(r,t):t,search:gI(n),hash:yI(a)}}function pI(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function ig(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function xI(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Fb(e){let t=xI(e);return t.map((r,n)=>n===t.length-1?r.pathname:r.pathnameBase)}function Ib(e,t,r,n=!1){let a;typeof e=="string"?a=Jc(e):(a={...e},Nr(!a.pathname||!a.pathname.includes("?"),ig("?","pathname","search",a)),Nr(!a.pathname||!a.pathname.includes("#"),ig("#","pathname","hash",a)),Nr(!a.search||!a.search.includes("#"),ig("#","search","hash",a)));let i=e===""||a.pathname==="",o=i?"/":a.pathname,u;if(o==null)u=r;else{let x=t.length-1;if(!n&&o.startsWith("..")){let v=o.split("/");for(;v[0]==="..";)v.shift(),x-=1;a.pathname=v.join("/")}u=x>=0?t[x]:"/"}let m=mI(a,u),f=o&&o!=="/"&&o.endsWith("/"),h=(i||o===".")&&r.endsWith("/");return!m.pathname.endsWith("/")&&(f||h)&&(m.pathname+="/"),m}var Es=e=>e.join("/").replace(/\/\/+/g,"/"),vI=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),gI=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,yI=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function bI(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var pC=["POST","PUT","PATCH","DELETE"];new Set(pC);var wI=["GET",...pC];new Set(wI);var eu=g.createContext(null);eu.displayName="DataRouter";var $m=g.createContext(null);$m.displayName="DataRouterState";g.createContext(!1);var xC=g.createContext({isTransitioning:!1});xC.displayName="ViewTransition";var SI=g.createContext(new Map);SI.displayName="Fetchers";var jI=g.createContext(null);jI.displayName="Await";var Ci=g.createContext(null);Ci.displayName="Navigation";var mf=g.createContext(null);mf.displayName="Location";var hi=g.createContext({outlet:null,matches:[],isDataRoute:!1});hi.displayName="Route";var Lb=g.createContext(null);Lb.displayName="RouteError";function NI(e,{relative:t}={}){Nr(tu(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=g.useContext(Ci),{hash:a,pathname:i,search:o}=pf(e,{relative:t}),u=i;return r!=="/"&&(u=i==="/"?r:Es([r,i])),n.createHref({pathname:u,search:o,hash:a})}function tu(){return g.useContext(mf)!=null}function Ua(){return Nr(tu(),"useLocation() may be used only in the context of a <Router> component."),g.useContext(mf).location}var vC="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function gC(e){g.useContext(Ci).static||g.useLayoutEffect(e)}function es(){let{isDataRoute:e}=g.useContext(hi);return e?UI():EI()}function EI(){Nr(tu(),"useNavigate() may be used only in the context of a <Router> component.");let e=g.useContext(eu),{basename:t,navigator:r}=g.useContext(Ci),{matches:n}=g.useContext(hi),{pathname:a}=Ua(),i=JSON.stringify(Fb(n)),o=g.useRef(!1);return gC(()=>{o.current=!0}),g.useCallback((m,f={})=>{if(li(o.current,vC),!o.current)return;if(typeof m=="number"){r.go(m);return}let h=Ib(m,JSON.parse(i),a,f.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:Es([t,h.pathname])),(f.replace?r.replace:r.push)(h,f.state,f)},[t,r,i,a,e])}var AI=g.createContext(null);function _I(e){let t=g.useContext(hi).outlet;return t&&g.createElement(AI.Provider,{value:e},t)}function TI(){let{matches:e}=g.useContext(hi),t=e[e.length-1];return t?t.params:{}}function pf(e,{relative:t}={}){let{matches:r}=g.useContext(hi),{pathname:n}=Ua(),a=JSON.stringify(Fb(r));return g.useMemo(()=>Ib(e,JSON.parse(a),n,t==="path"),[e,a,n,t])}function kI(e,t){return yC(e,t)}function yC(e,t,r,n,a){Nr(tu(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=g.useContext(Ci),{matches:o}=g.useContext(hi),u=o[o.length-1],m=u?u.params:{},f=u?u.pathname:"/",h=u?u.pathnameBase:"/",x=u&&u.route;{let _=x&&x.path||"";bC(f,!x||_.endsWith("*")||_.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${_}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${_}"> to <Route path="${_==="/"?"*":`${_}/*`}">.`)}let v=Ua(),y;if(t){let _=typeof t=="string"?Jc(t):t;Nr(h==="/"||_.pathname?.startsWith(h),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${_.pathname}" was given in the \`location\` prop.`),y=_}else y=v;let w=y.pathname||"/",b=w;if(h!=="/"){let _=h.replace(/^\//,"").split("/");b="/"+w.replace(/^\//,"").split("/").slice(_.length).join("/")}let S=fC(e,{pathname:b});li(x||S!=null,`No routes matched location "${y.pathname}${y.search}${y.hash}" `),li(S==null||S[S.length-1].route.element!==void 0||S[S.length-1].route.Component!==void 0||S[S.length-1].route.lazy!==void 0,`Matched leaf route at location "${y.pathname}${y.search}${y.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let N=RI(S&&S.map(_=>Object.assign({},_,{params:Object.assign({},m,_.params),pathname:Es([h,i.encodeLocation?i.encodeLocation(_.pathname).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?h:Es([h,i.encodeLocation?i.encodeLocation(_.pathnameBase).pathname:_.pathnameBase])})),o,r,n,a);return t&&N?g.createElement(mf.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...y},navigationType:"POP"}},N):N}function CI(){let e=BI(),t=bI(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},i={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=g.createElement(g.Fragment,null,g.createElement("p",null," Hey developer "),g.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",g.createElement("code",{style:i},"ErrorBoundary")," or"," ",g.createElement("code",{style:i},"errorElement")," prop on your route.")),g.createElement(g.Fragment,null,g.createElement("h2",null,"Unexpected Application Error!"),g.createElement("h3",{style:{fontStyle:"italic"}},t),r?g.createElement("pre",{style:a},r):null,o)}var OI=g.createElement(CI,null),DI=class extends g.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error("React Router caught the following error during render",e)}render(){return this.state.error!==void 0?g.createElement(hi.Provider,{value:this.props.routeContext},g.createElement(Lb.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function PI({routeContext:e,match:t,children:r}){let n=g.useContext(eu);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),g.createElement(hi.Provider,{value:e},r)}function RI(e,t=[],r=null,n=null,a=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,o=r?.errors;if(o!=null){let f=i.findIndex(h=>h.route.id&&o?.[h.route.id]!==void 0);Nr(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),i=i.slice(0,Math.min(i.length,f+1))}let u=!1,m=-1;if(r)for(let f=0;f<i.length;f++){let h=i[f];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(m=f),h.route.id){let{loaderData:x,errors:v}=r,y=h.route.loader&&!x.hasOwnProperty(h.route.id)&&(!v||v[h.route.id]===void 0);if(h.route.lazy||y){u=!0,m>=0?i=i.slice(0,m+1):i=[i[0]];break}}}return i.reduceRight((f,h,x)=>{let v,y=!1,w=null,b=null;r&&(v=o&&h.route.id?o[h.route.id]:void 0,w=h.route.errorElement||OI,u&&(m<0&&x===0?(bC("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),y=!0,b=null):m===x&&(y=!0,b=h.route.hydrateFallbackElement||null)));let S=t.concat(i.slice(0,x+1)),N=()=>{let _;return v?_=w:y?_=b:h.route.Component?_=g.createElement(h.route.Component,null):h.route.element?_=h.route.element:_=f,g.createElement(PI,{match:h,routeContext:{outlet:f,matches:S,isDataRoute:r!=null},children:_})};return r&&(h.route.ErrorBoundary||h.route.errorElement||x===0)?g.createElement(DI,{location:r.location,revalidation:r.revalidation,component:w,error:v,children:N(),routeContext:{outlet:null,matches:S,isDataRoute:!0},unstable_onError:n}):N()},null)}function Bb(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function MI(e){let t=g.useContext(eu);return Nr(t,Bb(e)),t}function FI(e){let t=g.useContext($m);return Nr(t,Bb(e)),t}function II(e){let t=g.useContext(hi);return Nr(t,Bb(e)),t}function Ub(e){let t=II(e),r=t.matches[t.matches.length-1];return Nr(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function LI(){return Ub("useRouteId")}function BI(){let e=g.useContext(Lb),t=FI("useRouteError"),r=Ub("useRouteError");return e!==void 0?e:t.errors?.[r]}function UI(){let{router:e}=MI("useNavigate"),t=Ub("useNavigate"),r=g.useRef(!1);return gC(()=>{r.current=!0}),g.useCallback(async(a,i={})=>{li(r.current,vC),r.current&&(typeof a=="number"?e.navigate(a):await e.navigate(a,{fromRouteId:t,...i}))},[e,t])}var mA={};function bC(e,t,r){!t&&!mA[e]&&(mA[e]=!0,li(!1,r))}g.memo($I);function $I({routes:e,future:t,state:r,unstable_onError:n}){return yC(e,void 0,r,n,t)}function ni({to:e,replace:t,state:r,relative:n}){Nr(tu(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=g.useContext(Ci);li(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=g.useContext(hi),{pathname:o}=Ua(),u=es(),m=Ib(e,Fb(i),o,n==="path"),f=JSON.stringify(m);return g.useEffect(()=>{u(JSON.parse(f),{replace:t,state:r,relative:n})},[u,f,n,t,r]),null}function my(e){return _I(e.context)}function dn(e){Nr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function zI({basename:e="/",children:t=null,location:r,navigationType:n="POP",navigator:a,static:i=!1}){Nr(!tu(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=e.replace(/^\/*/,"/"),u=g.useMemo(()=>({basename:o,navigator:a,static:i,future:{}}),[o,a,i]);typeof r=="string"&&(r=Jc(r));let{pathname:m="/",search:f="",hash:h="",state:x=null,key:v="default"}=r,y=g.useMemo(()=>{let w=Os(m,o);return w==null?null:{location:{pathname:w,search:f,hash:h,state:x,key:v},navigationType:n}},[o,m,f,h,x,v,n]);return li(y!=null,`<Router basename="${o}"> is not able to match the URL "${m}${f}${h}" because it does not start with the basename, so the <Router> won't render anything.`),y==null?null:g.createElement(Ci.Provider,{value:u},g.createElement(mf.Provider,{children:t,value:y}))}function HI({children:e,location:t}){return kI(py(e),t)}function py(e,t=[]){let r=[];return g.Children.forEach(e,(n,a)=>{if(!g.isValidElement(n))return;let i=[...t,a];if(n.type===g.Fragment){r.push.apply(r,py(n.props.children,i));return}Nr(n.type===dn,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Nr(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=py(n.props.children,i)),r.push(o)}),r}var Oh="get",Dh="application/x-www-form-urlencoded";function zm(e){return e!=null&&typeof e.tagName=="string"}function qI(e){return zm(e)&&e.tagName.toLowerCase()==="button"}function VI(e){return zm(e)&&e.tagName.toLowerCase()==="form"}function KI(e){return zm(e)&&e.tagName.toLowerCase()==="input"}function GI(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function WI(e,t){return e.button===0&&(!t||t==="_self")&&!GI(e)}function xy(e=""){return new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(a=>[r,a]):[[r,n]])},[]))}function XI(e,t){let r=xy(e);return t&&t.forEach((n,a)=>{r.has(a)||t.getAll(a).forEach(i=>{r.append(a,i)})}),r}var Q0=null;function YI(){if(Q0===null)try{new FormData(document.createElement("form"),0),Q0=!1}catch{Q0=!0}return Q0}var ZI=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function sg(e){return e!=null&&!ZI.has(e)?(li(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Dh}"`),null):e}function QI(e,t){let r,n,a,i,o;if(VI(e)){let u=e.getAttribute("action");n=u?Os(u,t):null,r=e.getAttribute("method")||Oh,a=sg(e.getAttribute("enctype"))||Dh,i=new FormData(e)}else if(qI(e)||KI(e)&&(e.type==="submit"||e.type==="image")){let u=e.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let m=e.getAttribute("formaction")||u.getAttribute("action");if(n=m?Os(m,t):null,r=e.getAttribute("formmethod")||u.getAttribute("method")||Oh,a=sg(e.getAttribute("formenctype"))||sg(u.getAttribute("enctype"))||Dh,i=new FormData(u,e),!YI()){let{name:f,type:h,value:x}=e;if(h==="image"){let v=f?`${f}.`:"";i.append(`${v}x`,"0"),i.append(`${v}y`,"0")}else f&&i.append(f,x)}}else{if(zm(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Oh,n=null,a=Dh,o=e}return i&&a==="text/plain"&&(o=i,i=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:i,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function $b(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function JI(e,t,r){let n=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return n.pathname==="/"?n.pathname=`_root.${r}`:t&&Os(n.pathname,t)==="/"?n.pathname=`${t.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function eL(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function tL(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function rL(e,t,r){let n=await Promise.all(e.map(async a=>{let i=t.routes[a.route.id];if(i){let o=await eL(i,r);return o.links?o.links():[]}return[]}));return sL(n.flat(1).filter(tL).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function pA(e,t,r,n,a,i){let o=(m,f)=>r[f]?m.route.id!==r[f].route.id:!0,u=(m,f)=>r[f].pathname!==m.pathname||r[f].route.path?.endsWith("*")&&r[f].params["*"]!==m.params["*"];return i==="assets"?t.filter((m,f)=>o(m,f)||u(m,f)):i==="data"?t.filter((m,f)=>{let h=n.routes[m.route.id];if(!h||!h.hasLoader)return!1;if(o(m,f)||u(m,f))return!0;if(m.route.shouldRevalidate){let x=m.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:r[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:m.params,defaultShouldRevalidate:!0});if(typeof x=="boolean")return x}return!0}):[]}function nL(e,t,{includeHydrateFallback:r}={}){return aL(e.map(n=>{let a=t.routes[n.route.id];if(!a)return[];let i=[a.module];return a.clientActionModule&&(i=i.concat(a.clientActionModule)),a.clientLoaderModule&&(i=i.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(i=i.concat(a.hydrateFallbackModule)),a.imports&&(i=i.concat(a.imports)),i}).flat(1))}function aL(e){return[...new Set(e)]}function iL(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}function sL(e,t){let r=new Set;return new Set(t),e.reduce((n,a)=>{let i=JSON.stringify(iL(a));return r.has(i)||(r.add(i),n.push({key:i,link:a})),n},[])}function wC(){let e=g.useContext(eu);return $b(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function lL(){let e=g.useContext($m);return $b(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var zb=g.createContext(void 0);zb.displayName="FrameworkContext";function SC(){let e=g.useContext(zb);return $b(e,"You must render this element inside a <HydratedRouter> element"),e}function oL(e,t){let r=g.useContext(zb),[n,a]=g.useState(!1),[i,o]=g.useState(!1),{onFocus:u,onBlur:m,onMouseEnter:f,onMouseLeave:h,onTouchStart:x}=t,v=g.useRef(null);g.useEffect(()=>{if(e==="render"&&o(!0),e==="viewport"){let b=N=>{N.forEach(_=>{o(_.isIntersecting)})},S=new IntersectionObserver(b,{threshold:.5});return v.current&&S.observe(v.current),()=>{S.disconnect()}}},[e]),g.useEffect(()=>{if(n){let b=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(b)}}},[n]);let y=()=>{a(!0)},w=()=>{a(!1),o(!1)};return r?e!=="intent"?[i,v,{}]:[i,v,{onFocus:ud(u,y),onBlur:ud(m,w),onMouseEnter:ud(f,y),onMouseLeave:ud(h,w),onTouchStart:ud(x,y)}]:[!1,v,{}]}function ud(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function cL({page:e,...t}){let{router:r}=wC(),n=g.useMemo(()=>fC(r.routes,e,r.basename),[r.routes,e,r.basename]);return n?g.createElement(dL,{page:e,matches:n,...t}):null}function uL(e){let{manifest:t,routeModules:r}=SC(),[n,a]=g.useState([]);return g.useEffect(()=>{let i=!1;return rL(e,t,r).then(o=>{i||a(o)}),()=>{i=!0}},[e,t,r]),n}function dL({page:e,matches:t,...r}){let n=Ua(),{manifest:a,routeModules:i}=SC(),{basename:o}=wC(),{loaderData:u,matches:m}=lL(),f=g.useMemo(()=>pA(e,t,m,a,n,"data"),[e,t,m,a,n]),h=g.useMemo(()=>pA(e,t,m,a,n,"assets"),[e,t,m,a,n]),x=g.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let w=new Set,b=!1;if(t.forEach(N=>{let _=a.routes[N.route.id];!_||!_.hasLoader||(!f.some(A=>A.route.id===N.route.id)&&N.route.id in u&&i[N.route.id]?.shouldRevalidate||_.hasClientLoader?b=!0:w.add(N.route.id))}),w.size===0)return[];let S=JI(e,o,"data");return b&&w.size>0&&S.searchParams.set("_routes",t.filter(N=>w.has(N.route.id)).map(N=>N.route.id).join(",")),[S.pathname+S.search]},[o,u,n,a,f,t,e,i]),v=g.useMemo(()=>nL(h,a),[h,a]),y=uL(h);return g.createElement(g.Fragment,null,x.map(w=>g.createElement("link",{key:w,rel:"prefetch",as:"fetch",href:w,...r})),v.map(w=>g.createElement("link",{key:w,rel:"modulepreload",href:w,...r})),y.map(({key:w,link:b})=>g.createElement("link",{key:w,nonce:r.nonce,...b})))}function fL(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var jC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{jC&&(window.__reactRouterVersion="7.9.1")}catch{}function hL({basename:e,children:t,window:r}){let n=g.useRef();n.current==null&&(n.current=ZF({window:r,v5Compat:!0}));let a=n.current,[i,o]=g.useState({action:a.action,location:a.location}),u=g.useCallback(m=>{g.startTransition(()=>o(m))},[o]);return g.useLayoutEffect(()=>a.listen(u),[a,u]),g.createElement(zI,{basename:e,children:t,location:i.location,navigationType:i.action,navigator:a})}var NC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Hm=g.forwardRef(function({onClick:t,discover:r="render",prefetch:n="none",relative:a,reloadDocument:i,replace:o,state:u,target:m,to:f,preventScrollReset:h,viewTransition:x,...v},y){let{basename:w}=g.useContext(Ci),b=typeof f=="string"&&NC.test(f),S,N=!1;if(typeof f=="string"&&b&&(S=f,jC))try{let P=new URL(window.location.href),Z=f.startsWith("//")?new URL(P.protocol+f):new URL(f),q=Os(Z.pathname,w);Z.origin===P.origin&&q!=null?f=q+Z.search+Z.hash:N=!0}catch{li(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let _=NI(f,{relative:a}),[A,k,C]=oL(n,v),O=vL(f,{replace:o,state:u,target:m,preventScrollReset:h,relative:a,viewTransition:x});function T(P){t&&t(P),P.defaultPrevented||O(P)}let z=g.createElement("a",{...v,...C,href:S||_,onClick:N||i?t:T,ref:fL(y,k),target:m,"data-discover":!b&&r==="render"?"true":void 0});return A&&!b?g.createElement(g.Fragment,null,z,g.createElement(cL,{page:_})):z});Hm.displayName="Link";var mL=g.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:n="",end:a=!1,style:i,to:o,viewTransition:u,children:m,...f},h){let x=pf(o,{relative:f.relative}),v=Ua(),y=g.useContext($m),{navigator:w,basename:b}=g.useContext(Ci),S=y!=null&&SL(x)&&u===!0,N=w.encodeLocation?w.encodeLocation(x).pathname:x.pathname,_=v.pathname,A=y&&y.navigation&&y.navigation.location?y.navigation.location.pathname:null;r||(_=_.toLowerCase(),A=A?A.toLowerCase():null,N=N.toLowerCase()),A&&b&&(A=Os(A,b)||A);const k=N!=="/"&&N.endsWith("/")?N.length-1:N.length;let C=_===N||!a&&_.startsWith(N)&&_.charAt(k)==="/",O=A!=null&&(A===N||!a&&A.startsWith(N)&&A.charAt(N.length)==="/"),T={isActive:C,isPending:O,isTransitioning:S},z=C?t:void 0,P;typeof n=="function"?P=n(T):P=[n,C?"active":null,O?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let Z=typeof i=="function"?i(T):i;return g.createElement(Hm,{...f,"aria-current":z,className:P,ref:h,style:Z,to:o,viewTransition:u},typeof m=="function"?m(T):m)});mL.displayName="NavLink";var pL=g.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:n,replace:a,state:i,method:o=Oh,action:u,onSubmit:m,relative:f,preventScrollReset:h,viewTransition:x,...v},y)=>{let w=bL(),b=wL(u,{relative:f}),S=o.toLowerCase()==="get"?"get":"post",N=typeof u=="string"&&NC.test(u),_=A=>{if(m&&m(A),A.defaultPrevented)return;A.preventDefault();let k=A.nativeEvent.submitter,C=k?.getAttribute("formmethod")||o;w(k||A.currentTarget,{fetcherKey:t,method:C,navigate:r,replace:a,state:i,relative:f,preventScrollReset:h,viewTransition:x})};return g.createElement("form",{ref:y,method:S,action:b,onSubmit:n?m:_,...v,"data-discover":!N&&e==="render"?"true":void 0})});pL.displayName="Form";function xL(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function EC(e){let t=g.useContext(eu);return Nr(t,xL(e)),t}function vL(e,{target:t,replace:r,state:n,preventScrollReset:a,relative:i,viewTransition:o}={}){let u=es(),m=Ua(),f=pf(e,{relative:i});return g.useCallback(h=>{if(WI(h,t)){h.preventDefault();let x=r!==void 0?r:Hd(m)===Hd(f);u(e,{replace:x,state:n,preventScrollReset:a,relative:i,viewTransition:o})}},[m,u,f,r,n,t,e,a,i,o])}function AC(e){li(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=g.useRef(xy(e)),r=g.useRef(!1),n=Ua(),a=g.useMemo(()=>XI(n.search,r.current?null:t.current),[n.search]),i=es(),o=g.useCallback((u,m)=>{const f=xy(typeof u=="function"?u(new URLSearchParams(a)):u);r.current=!0,i("?"+f,m)},[i,a]);return[a,o]}var gL=0,yL=()=>`__${String(++gL)}__`;function bL(){let{router:e}=EC("useSubmit"),{basename:t}=g.useContext(Ci),r=LI();return g.useCallback(async(n,a={})=>{let{action:i,method:o,encType:u,formData:m,body:f}=QI(n,t);if(a.navigate===!1){let h=a.fetcherKey||yL();await e.fetch(h,r,a.action||i,{preventScrollReset:a.preventScrollReset,formData:m,body:f,formMethod:a.method||o,formEncType:a.encType||u,flushSync:a.flushSync})}else await e.navigate(a.action||i,{preventScrollReset:a.preventScrollReset,formData:m,body:f,formMethod:a.method||o,formEncType:a.encType||u,replace:a.replace,state:a.state,fromRouteId:r,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,t,r])}function wL(e,{relative:t}={}){let{basename:r}=g.useContext(Ci),n=g.useContext(hi);Nr(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),i={...pf(e||".",{relative:t})},o=Ua();if(e==null){i.search=o.search;let u=new URLSearchParams(i.search),m=u.getAll("index");if(m.some(h=>h==="")){u.delete("index"),m.filter(x=>x).forEach(x=>u.append("index",x));let h=u.toString();i.search=h?`?${h}`:""}}return(!e||e===".")&&a.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(i.pathname=i.pathname==="/"?r:Es([r,i.pathname])),Hd(i)}function SL(e,{relative:t}={}){let r=g.useContext(xC);Nr(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=EC("useViewTransitionState"),a=pf(e,{relative:t});if(!r.isTransitioning)return!1;let i=Os(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=Os(r.nextLocation.pathname,n)||r.nextLocation.pathname;return Lh(a.pathname,o)!=null||Lh(a.pathname,i)!=null}var qd=dC();const Hb=fi(qd);function _C(e,t){return function(){return e.apply(t,arguments)}}const{toString:jL}=Object.prototype,{getPrototypeOf:qb}=Object,{iterator:qm,toStringTag:TC}=Symbol,Vm=(e=>t=>{const r=jL.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Oi=e=>(e=e.toLowerCase(),t=>Vm(t)===e),Km=e=>t=>typeof t===e,{isArray:ru}=Array,Vd=Km("undefined");function NL(e){return e!==null&&!Vd(e)&&e.constructor!==null&&!Vd(e.constructor)&&ca(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const kC=Oi("ArrayBuffer");function EL(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&kC(e.buffer),t}const AL=Km("string"),ca=Km("function"),CC=Km("number"),Gm=e=>e!==null&&typeof e=="object",_L=e=>e===!0||e===!1,Ph=e=>{if(Vm(e)!=="object")return!1;const t=qb(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(TC in e)&&!(qm in e)},TL=Oi("Date"),kL=Oi("File"),CL=Oi("Blob"),OL=Oi("FileList"),DL=e=>Gm(e)&&ca(e.pipe),PL=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||ca(e.append)&&((t=Vm(e))==="formdata"||t==="object"&&ca(e.toString)&&e.toString()==="[object FormData]"))},RL=Oi("URLSearchParams"),[ML,FL,IL,LL]=["ReadableStream","Request","Response","Headers"].map(Oi),BL=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function xf(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,a;if(typeof e!="object"&&(e=[e]),ru(e))for(n=0,a=e.length;n<a;n++)t.call(null,e[n],n,e);else{const i=r?Object.getOwnPropertyNames(e):Object.keys(e),o=i.length;let u;for(n=0;n<o;n++)u=i[n],t.call(null,e[u],u,e)}}function OC(e,t){t=t.toLowerCase();const r=Object.keys(e);let n=r.length,a;for(;n-- >0;)if(a=r[n],t===a.toLowerCase())return a;return null}const oo=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,DC=e=>!Vd(e)&&e!==oo;function vy(){const{caseless:e}=DC(this)&&this||{},t={},r=(n,a)=>{const i=e&&OC(t,a)||a;Ph(t[i])&&Ph(n)?t[i]=vy(t[i],n):Ph(n)?t[i]=vy({},n):ru(n)?t[i]=n.slice():t[i]=n};for(let n=0,a=arguments.length;n<a;n++)arguments[n]&&xf(arguments[n],r);return t}const UL=(e,t,r,{allOwnKeys:n}={})=>(xf(t,(a,i)=>{r&&ca(a)?e[i]=_C(a,r):e[i]=a},{allOwnKeys:n}),e),$L=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),zL=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},HL=(e,t,r,n)=>{let a,i,o;const u={};if(t=t||{},e==null)return t;do{for(a=Object.getOwnPropertyNames(e),i=a.length;i-- >0;)o=a[i],(!n||n(o,e,t))&&!u[o]&&(t[o]=e[o],u[o]=!0);e=r!==!1&&qb(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},qL=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},VL=e=>{if(!e)return null;if(ru(e))return e;let t=e.length;if(!CC(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},KL=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&qb(Uint8Array)),GL=(e,t)=>{const n=(e&&e[qm]).call(e);let a;for(;(a=n.next())&&!a.done;){const i=a.value;t.call(e,i[0],i[1])}},WL=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},XL=Oi("HTMLFormElement"),YL=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,a){return n.toUpperCase()+a}),xA=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),ZL=Oi("RegExp"),PC=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};xf(r,(a,i)=>{let o;(o=t(a,i,e))!==!1&&(n[i]=o||a)}),Object.defineProperties(e,n)},QL=e=>{PC(e,(t,r)=>{if(ca(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(ca(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},JL=(e,t)=>{const r={},n=a=>{a.forEach(i=>{r[i]=!0})};return ru(e)?n(e):n(String(e).split(t)),r},e7=()=>{},t7=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function r7(e){return!!(e&&ca(e.append)&&e[TC]==="FormData"&&e[qm])}const n7=e=>{const t=new Array(10),r=(n,a)=>{if(Gm(n)){if(t.indexOf(n)>=0)return;if(!("toJSON"in n)){t[a]=n;const i=ru(n)?[]:{};return xf(n,(o,u)=>{const m=r(o,a+1);!Vd(m)&&(i[u]=m)}),t[a]=void 0,i}}return n};return r(e,0)},a7=Oi("AsyncFunction"),i7=e=>e&&(Gm(e)||ca(e))&&ca(e.then)&&ca(e.catch),RC=((e,t)=>e?setImmediate:t?((r,n)=>(oo.addEventListener("message",({source:a,data:i})=>{a===oo&&i===r&&n.length&&n.shift()()},!1),a=>{n.push(a),oo.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",ca(oo.postMessage)),s7=typeof queueMicrotask<"u"?queueMicrotask.bind(oo):typeof process<"u"&&process.nextTick||RC,l7=e=>e!=null&&ca(e[qm]),Re={isArray:ru,isArrayBuffer:kC,isBuffer:NL,isFormData:PL,isArrayBufferView:EL,isString:AL,isNumber:CC,isBoolean:_L,isObject:Gm,isPlainObject:Ph,isReadableStream:ML,isRequest:FL,isResponse:IL,isHeaders:LL,isUndefined:Vd,isDate:TL,isFile:kL,isBlob:CL,isRegExp:ZL,isFunction:ca,isStream:DL,isURLSearchParams:RL,isTypedArray:KL,isFileList:OL,forEach:xf,merge:vy,extend:UL,trim:BL,stripBOM:$L,inherits:zL,toFlatObject:HL,kindOf:Vm,kindOfTest:Oi,endsWith:qL,toArray:VL,forEachEntry:GL,matchAll:WL,isHTMLForm:XL,hasOwnProperty:xA,hasOwnProp:xA,reduceDescriptors:PC,freezeMethods:QL,toObjectSet:JL,toCamelCase:YL,noop:e7,toFiniteNumber:t7,findKey:OC,global:oo,isContextDefined:DC,isSpecCompliantForm:r7,toJSONObject:n7,isAsyncFn:a7,isThenable:i7,setImmediate:RC,asap:s7,isIterable:l7};function Et(e,t,r,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}Re.inherits(Et,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Re.toJSONObject(this.config),code:this.code,status:this.status}}});const MC=Et.prototype,FC={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{FC[e]={value:e}});Object.defineProperties(Et,FC);Object.defineProperty(MC,"isAxiosError",{value:!0});Et.from=(e,t,r,n,a,i)=>{const o=Object.create(MC);return Re.toFlatObject(e,o,function(m){return m!==Error.prototype},u=>u!=="isAxiosError"),Et.call(o,e.message,t,r,n,a),o.cause=e,o.name=e.name,i&&Object.assign(o,i),o};const o7=null;function gy(e){return Re.isPlainObject(e)||Re.isArray(e)}function IC(e){return Re.endsWith(e,"[]")?e.slice(0,-2):e}function vA(e,t,r){return e?e.concat(t).map(function(a,i){return a=IC(a),!r&&i?"["+a+"]":a}).join(r?".":""):t}function c7(e){return Re.isArray(e)&&!e.some(gy)}const u7=Re.toFlatObject(Re,{},null,function(t){return/^is[A-Z]/.test(t)});function Wm(e,t,r){if(!Re.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=Re.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(b,S){return!Re.isUndefined(S[b])});const n=r.metaTokens,a=r.visitor||h,i=r.dots,o=r.indexes,m=(r.Blob||typeof Blob<"u"&&Blob)&&Re.isSpecCompliantForm(t);if(!Re.isFunction(a))throw new TypeError("visitor must be a function");function f(w){if(w===null)return"";if(Re.isDate(w))return w.toISOString();if(Re.isBoolean(w))return w.toString();if(!m&&Re.isBlob(w))throw new Et("Blob is not supported. Use a Buffer instead.");return Re.isArrayBuffer(w)||Re.isTypedArray(w)?m&&typeof Blob=="function"?new Blob([w]):Buffer.from(w):w}function h(w,b,S){let N=w;if(w&&!S&&typeof w=="object"){if(Re.endsWith(b,"{}"))b=n?b:b.slice(0,-2),w=JSON.stringify(w);else if(Re.isArray(w)&&c7(w)||(Re.isFileList(w)||Re.endsWith(b,"[]"))&&(N=Re.toArray(w)))return b=IC(b),N.forEach(function(A,k){!(Re.isUndefined(A)||A===null)&&t.append(o===!0?vA([b],k,i):o===null?b:b+"[]",f(A))}),!1}return gy(w)?!0:(t.append(vA(S,b,i),f(w)),!1)}const x=[],v=Object.assign(u7,{defaultVisitor:h,convertValue:f,isVisitable:gy});function y(w,b){if(!Re.isUndefined(w)){if(x.indexOf(w)!==-1)throw Error("Circular reference detected in "+b.join("."));x.push(w),Re.forEach(w,function(N,_){(!(Re.isUndefined(N)||N===null)&&a.call(t,N,Re.isString(_)?_.trim():_,b,v))===!0&&y(N,b?b.concat(_):[_])}),x.pop()}}if(!Re.isObject(e))throw new TypeError("data must be an object");return y(e),t}function gA(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function Vb(e,t){this._pairs=[],e&&Wm(e,this,t)}const LC=Vb.prototype;LC.append=function(t,r){this._pairs.push([t,r])};LC.toString=function(t){const r=t?function(n){return t.call(this,n,gA)}:gA;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function d7(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function BC(e,t,r){if(!t)return e;const n=r&&r.encode||d7;Re.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let i;if(a?i=a(t,r):i=Re.isURLSearchParams(t)?t.toString():new Vb(t,r).toString(n),i){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class yA{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Re.forEach(this.handlers,function(n){n!==null&&t(n)})}}const UC={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},f7=typeof URLSearchParams<"u"?URLSearchParams:Vb,h7=typeof FormData<"u"?FormData:null,m7=typeof Blob<"u"?Blob:null,p7={isBrowser:!0,classes:{URLSearchParams:f7,FormData:h7,Blob:m7},protocols:["http","https","file","blob","url","data"]},Kb=typeof window<"u"&&typeof document<"u",yy=typeof navigator=="object"&&navigator||void 0,x7=Kb&&(!yy||["ReactNative","NativeScript","NS"].indexOf(yy.product)<0),v7=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",g7=Kb&&window.location.href||"http://localhost",y7=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Kb,hasStandardBrowserEnv:x7,hasStandardBrowserWebWorkerEnv:v7,navigator:yy,origin:g7},Symbol.toStringTag,{value:"Module"})),Mn={...y7,...p7};function b7(e,t){return Wm(e,new Mn.classes.URLSearchParams,Object.assign({visitor:function(r,n,a,i){return Mn.isNode&&Re.isBuffer(r)?(this.append(n,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},t))}function w7(e){return Re.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function S7(e){const t={},r=Object.keys(e);let n;const a=r.length;let i;for(n=0;n<a;n++)i=r[n],t[i]=e[i];return t}function $C(e){function t(r,n,a,i){let o=r[i++];if(o==="__proto__")return!0;const u=Number.isFinite(+o),m=i>=r.length;return o=!o&&Re.isArray(a)?a.length:o,m?(Re.hasOwnProp(a,o)?a[o]=[a[o],n]:a[o]=n,!u):((!a[o]||!Re.isObject(a[o]))&&(a[o]=[]),t(r,n,a[o],i)&&Re.isArray(a[o])&&(a[o]=S7(a[o])),!u)}if(Re.isFormData(e)&&Re.isFunction(e.entries)){const r={};return Re.forEachEntry(e,(n,a)=>{t(w7(n),a,r,0)}),r}return null}function j7(e,t,r){if(Re.isString(e))try{return(t||JSON.parse)(e),Re.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const vf={transitional:UC,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",a=n.indexOf("application/json")>-1,i=Re.isObject(t);if(i&&Re.isHTMLForm(t)&&(t=new FormData(t)),Re.isFormData(t))return a?JSON.stringify($C(t)):t;if(Re.isArrayBuffer(t)||Re.isBuffer(t)||Re.isStream(t)||Re.isFile(t)||Re.isBlob(t)||Re.isReadableStream(t))return t;if(Re.isArrayBufferView(t))return t.buffer;if(Re.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return b7(t,this.formSerializer).toString();if((u=Re.isFileList(t))||n.indexOf("multipart/form-data")>-1){const m=this.env&&this.env.FormData;return Wm(u?{"files[]":t}:t,m&&new m,this.formSerializer)}}return i||a?(r.setContentType("application/json",!1),j7(t)):t}],transformResponse:[function(t){const r=this.transitional||vf.transitional,n=r&&r.forcedJSONParsing,a=this.responseType==="json";if(Re.isResponse(t)||Re.isReadableStream(t))return t;if(t&&Re.isString(t)&&(n&&!this.responseType||a)){const o=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(t)}catch(u){if(o)throw u.name==="SyntaxError"?Et.from(u,Et.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Mn.classes.FormData,Blob:Mn.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Re.forEach(["delete","get","head","post","put","patch"],e=>{vf.headers[e]={}});const N7=Re.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),E7=e=>{const t={};let r,n,a;return e&&e.split(`
`).forEach(function(o){a=o.indexOf(":"),r=o.substring(0,a).trim().toLowerCase(),n=o.substring(a+1).trim(),!(!r||t[r]&&N7[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},bA=Symbol("internals");function dd(e){return e&&String(e).trim().toLowerCase()}function Rh(e){return e===!1||e==null?e:Re.isArray(e)?e.map(Rh):String(e)}function A7(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const _7=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function lg(e,t,r,n,a){if(Re.isFunction(n))return n.call(this,t,r);if(a&&(t=r),!!Re.isString(t)){if(Re.isString(n))return t.indexOf(n)!==-1;if(Re.isRegExp(n))return n.test(t)}}function T7(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function k7(e,t){const r=Re.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(a,i,o){return this[n].call(this,t,a,i,o)},configurable:!0})})}let ua=class{constructor(t){t&&this.set(t)}set(t,r,n){const a=this;function i(u,m,f){const h=dd(m);if(!h)throw new Error("header name must be a non-empty string");const x=Re.findKey(a,h);(!x||a[x]===void 0||f===!0||f===void 0&&a[x]!==!1)&&(a[x||m]=Rh(u))}const o=(u,m)=>Re.forEach(u,(f,h)=>i(f,h,m));if(Re.isPlainObject(t)||t instanceof this.constructor)o(t,r);else if(Re.isString(t)&&(t=t.trim())&&!_7(t))o(E7(t),r);else if(Re.isObject(t)&&Re.isIterable(t)){let u={},m,f;for(const h of t){if(!Re.isArray(h))throw TypeError("Object iterator must return a key-value pair");u[f=h[0]]=(m=u[f])?Re.isArray(m)?[...m,h[1]]:[m,h[1]]:h[1]}o(u,r)}else t!=null&&i(r,t,n);return this}get(t,r){if(t=dd(t),t){const n=Re.findKey(this,t);if(n){const a=this[n];if(!r)return a;if(r===!0)return A7(a);if(Re.isFunction(r))return r.call(this,a,n);if(Re.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=dd(t),t){const n=Re.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||lg(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let a=!1;function i(o){if(o=dd(o),o){const u=Re.findKey(n,o);u&&(!r||lg(n,n[u],u,r))&&(delete n[u],a=!0)}}return Re.isArray(t)?t.forEach(i):i(t),a}clear(t){const r=Object.keys(this);let n=r.length,a=!1;for(;n--;){const i=r[n];(!t||lg(this,this[i],i,t,!0))&&(delete this[i],a=!0)}return a}normalize(t){const r=this,n={};return Re.forEach(this,(a,i)=>{const o=Re.findKey(n,i);if(o){r[o]=Rh(a),delete r[i];return}const u=t?T7(i):String(i).trim();u!==i&&delete r[i],r[u]=Rh(a),n[u]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return Re.forEach(this,(n,a)=>{n!=null&&n!==!1&&(r[a]=t&&Re.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(a=>n.set(a)),n}static accessor(t){const n=(this[bA]=this[bA]={accessors:{}}).accessors,a=this.prototype;function i(o){const u=dd(o);n[u]||(k7(a,o),n[u]=!0)}return Re.isArray(t)?t.forEach(i):i(t),this}};ua.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Re.reduceDescriptors(ua.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});Re.freezeMethods(ua);function og(e,t){const r=this||vf,n=t||r,a=ua.from(n.headers);let i=n.data;return Re.forEach(e,function(u){i=u.call(r,i,a.normalize(),t?t.status:void 0)}),a.normalize(),i}function zC(e){return!!(e&&e.__CANCEL__)}function nu(e,t,r){Et.call(this,e??"canceled",Et.ERR_CANCELED,t,r),this.name="CanceledError"}Re.inherits(nu,Et,{__CANCEL__:!0});function HC(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new Et("Request failed with status code "+r.status,[Et.ERR_BAD_REQUEST,Et.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function C7(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function O7(e,t){e=e||10;const r=new Array(e),n=new Array(e);let a=0,i=0,o;return t=t!==void 0?t:1e3,function(m){const f=Date.now(),h=n[i];o||(o=f),r[a]=m,n[a]=f;let x=i,v=0;for(;x!==a;)v+=r[x++],x=x%e;if(a=(a+1)%e,a===i&&(i=(i+1)%e),f-o<t)return;const y=h&&f-h;return y?Math.round(v*1e3/y):void 0}}function D7(e,t){let r=0,n=1e3/t,a,i;const o=(f,h=Date.now())=>{r=h,a=null,i&&(clearTimeout(i),i=null),e.apply(null,f)};return[(...f)=>{const h=Date.now(),x=h-r;x>=n?o(f,h):(a=f,i||(i=setTimeout(()=>{i=null,o(a)},n-x)))},()=>a&&o(a)]}const Bh=(e,t,r=3)=>{let n=0;const a=O7(50,250);return D7(i=>{const o=i.loaded,u=i.lengthComputable?i.total:void 0,m=o-n,f=a(m),h=o<=u;n=o;const x={loaded:o,total:u,progress:u?o/u:void 0,bytes:m,rate:f||void 0,estimated:f&&u&&h?(u-o)/f:void 0,event:i,lengthComputable:u!=null,[t?"download":"upload"]:!0};e(x)},r)},wA=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},SA=e=>(...t)=>Re.asap(()=>e(...t)),P7=Mn.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,Mn.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(Mn.origin),Mn.navigator&&/(msie|trident)/i.test(Mn.navigator.userAgent)):()=>!0,R7=Mn.hasStandardBrowserEnv?{write(e,t,r,n,a,i){const o=[e+"="+encodeURIComponent(t)];Re.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),Re.isString(n)&&o.push("path="+n),Re.isString(a)&&o.push("domain="+a),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function M7(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function F7(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function qC(e,t,r){let n=!M7(t);return e&&(n||r==!1)?F7(e,t):t}const jA=e=>e instanceof ua?{...e}:e;function jo(e,t){t=t||{};const r={};function n(f,h,x,v){return Re.isPlainObject(f)&&Re.isPlainObject(h)?Re.merge.call({caseless:v},f,h):Re.isPlainObject(h)?Re.merge({},h):Re.isArray(h)?h.slice():h}function a(f,h,x,v){if(Re.isUndefined(h)){if(!Re.isUndefined(f))return n(void 0,f,x,v)}else return n(f,h,x,v)}function i(f,h){if(!Re.isUndefined(h))return n(void 0,h)}function o(f,h){if(Re.isUndefined(h)){if(!Re.isUndefined(f))return n(void 0,f)}else return n(void 0,h)}function u(f,h,x){if(x in t)return n(f,h);if(x in e)return n(void 0,f)}const m={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:u,headers:(f,h,x)=>a(jA(f),jA(h),x,!0)};return Re.forEach(Object.keys(Object.assign({},e,t)),function(h){const x=m[h]||a,v=x(e[h],t[h],h);Re.isUndefined(v)&&x!==u||(r[h]=v)}),r}const VC=e=>{const t=jo({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:i,headers:o,auth:u}=t;t.headers=o=ua.from(o),t.url=BC(qC(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),u&&o.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):"")));let m;if(Re.isFormData(r)){if(Mn.hasStandardBrowserEnv||Mn.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((m=o.getContentType())!==!1){const[f,...h]=m?m.split(";").map(x=>x.trim()).filter(Boolean):[];o.setContentType([f||"multipart/form-data",...h].join("; "))}}if(Mn.hasStandardBrowserEnv&&(n&&Re.isFunction(n)&&(n=n(t)),n||n!==!1&&P7(t.url))){const f=a&&i&&R7.read(i);f&&o.set(a,f)}return t},I7=typeof XMLHttpRequest<"u",L7=I7&&function(e){return new Promise(function(r,n){const a=VC(e);let i=a.data;const o=ua.from(a.headers).normalize();let{responseType:u,onUploadProgress:m,onDownloadProgress:f}=a,h,x,v,y,w;function b(){y&&y(),w&&w(),a.cancelToken&&a.cancelToken.unsubscribe(h),a.signal&&a.signal.removeEventListener("abort",h)}let S=new XMLHttpRequest;S.open(a.method.toUpperCase(),a.url,!0),S.timeout=a.timeout;function N(){if(!S)return;const A=ua.from("getAllResponseHeaders"in S&&S.getAllResponseHeaders()),C={data:!u||u==="text"||u==="json"?S.responseText:S.response,status:S.status,statusText:S.statusText,headers:A,config:e,request:S};HC(function(T){r(T),b()},function(T){n(T),b()},C),S=null}"onloadend"in S?S.onloadend=N:S.onreadystatechange=function(){!S||S.readyState!==4||S.status===0&&!(S.responseURL&&S.responseURL.indexOf("file:")===0)||setTimeout(N)},S.onabort=function(){S&&(n(new Et("Request aborted",Et.ECONNABORTED,e,S)),S=null)},S.onerror=function(){n(new Et("Network Error",Et.ERR_NETWORK,e,S)),S=null},S.ontimeout=function(){let k=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const C=a.transitional||UC;a.timeoutErrorMessage&&(k=a.timeoutErrorMessage),n(new Et(k,C.clarifyTimeoutError?Et.ETIMEDOUT:Et.ECONNABORTED,e,S)),S=null},i===void 0&&o.setContentType(null),"setRequestHeader"in S&&Re.forEach(o.toJSON(),function(k,C){S.setRequestHeader(C,k)}),Re.isUndefined(a.withCredentials)||(S.withCredentials=!!a.withCredentials),u&&u!=="json"&&(S.responseType=a.responseType),f&&([v,w]=Bh(f,!0),S.addEventListener("progress",v)),m&&S.upload&&([x,y]=Bh(m),S.upload.addEventListener("progress",x),S.upload.addEventListener("loadend",y)),(a.cancelToken||a.signal)&&(h=A=>{S&&(n(!A||A.type?new nu(null,e,S):A),S.abort(),S=null)},a.cancelToken&&a.cancelToken.subscribe(h),a.signal&&(a.signal.aborted?h():a.signal.addEventListener("abort",h)));const _=C7(a.url);if(_&&Mn.protocols.indexOf(_)===-1){n(new Et("Unsupported protocol "+_+":",Et.ERR_BAD_REQUEST,e));return}S.send(i||null)})},B7=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,a;const i=function(f){if(!a){a=!0,u();const h=f instanceof Error?f:this.reason;n.abort(h instanceof Et?h:new nu(h instanceof Error?h.message:h))}};let o=t&&setTimeout(()=>{o=null,i(new Et(`timeout ${t} of ms exceeded`,Et.ETIMEDOUT))},t);const u=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(f=>{f.unsubscribe?f.unsubscribe(i):f.removeEventListener("abort",i)}),e=null)};e.forEach(f=>f.addEventListener("abort",i));const{signal:m}=n;return m.unsubscribe=()=>Re.asap(u),m}},U7=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,a;for(;n<r;)a=n+t,yield e.slice(n,a),n=a},$7=async function*(e,t){for await(const r of z7(e))yield*U7(r,t)},z7=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},NA=(e,t,r,n)=>{const a=$7(e,t);let i=0,o,u=m=>{o||(o=!0,n&&n(m))};return new ReadableStream({async pull(m){try{const{done:f,value:h}=await a.next();if(f){u(),m.close();return}let x=h.byteLength;if(r){let v=i+=x;r(v)}m.enqueue(new Uint8Array(h))}catch(f){throw u(f),f}},cancel(m){return u(m),a.return()}},{highWaterMark:2})},Xm=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",KC=Xm&&typeof ReadableStream=="function",H7=Xm&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),GC=(e,...t)=>{try{return!!e(...t)}catch{return!1}},q7=KC&&GC(()=>{let e=!1;const t=new Request(Mn.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),EA=64*1024,by=KC&&GC(()=>Re.isReadableStream(new Response("").body)),Uh={stream:by&&(e=>e.body)};Xm&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!Uh[t]&&(Uh[t]=Re.isFunction(e[t])?r=>r[t]():(r,n)=>{throw new Et(`Response type '${t}' is not supported`,Et.ERR_NOT_SUPPORT,n)})})})(new Response);const V7=async e=>{if(e==null)return 0;if(Re.isBlob(e))return e.size;if(Re.isSpecCompliantForm(e))return(await new Request(Mn.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(Re.isArrayBufferView(e)||Re.isArrayBuffer(e))return e.byteLength;if(Re.isURLSearchParams(e)&&(e=e+""),Re.isString(e))return(await H7(e)).byteLength},K7=async(e,t)=>{const r=Re.toFiniteNumber(e.getContentLength());return r??V7(t)},G7=Xm&&(async e=>{let{url:t,method:r,data:n,signal:a,cancelToken:i,timeout:o,onDownloadProgress:u,onUploadProgress:m,responseType:f,headers:h,withCredentials:x="same-origin",fetchOptions:v}=VC(e);f=f?(f+"").toLowerCase():"text";let y=B7([a,i&&i.toAbortSignal()],o),w;const b=y&&y.unsubscribe&&(()=>{y.unsubscribe()});let S;try{if(m&&q7&&r!=="get"&&r!=="head"&&(S=await K7(h,n))!==0){let C=new Request(t,{method:"POST",body:n,duplex:"half"}),O;if(Re.isFormData(n)&&(O=C.headers.get("content-type"))&&h.setContentType(O),C.body){const[T,z]=wA(S,Bh(SA(m)));n=NA(C.body,EA,T,z)}}Re.isString(x)||(x=x?"include":"omit");const N="credentials"in Request.prototype;w=new Request(t,{...v,signal:y,method:r.toUpperCase(),headers:h.normalize().toJSON(),body:n,duplex:"half",credentials:N?x:void 0});let _=await fetch(w,v);const A=by&&(f==="stream"||f==="response");if(by&&(u||A&&b)){const C={};["status","statusText","headers"].forEach(P=>{C[P]=_[P]});const O=Re.toFiniteNumber(_.headers.get("content-length")),[T,z]=u&&wA(O,Bh(SA(u),!0))||[];_=new Response(NA(_.body,EA,T,()=>{z&&z(),b&&b()}),C)}f=f||"text";let k=await Uh[Re.findKey(Uh,f)||"text"](_,e);return!A&&b&&b(),await new Promise((C,O)=>{HC(C,O,{data:k,headers:ua.from(_.headers),status:_.status,statusText:_.statusText,config:e,request:w})})}catch(N){throw b&&b(),N&&N.name==="TypeError"&&/Load failed|fetch/i.test(N.message)?Object.assign(new Et("Network Error",Et.ERR_NETWORK,e,w),{cause:N.cause||N}):Et.from(N,N&&N.code,e,w)}}),wy={http:o7,xhr:L7,fetch:G7};Re.forEach(wy,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const AA=e=>`- ${e}`,W7=e=>Re.isFunction(e)||e===null||e===!1,WC={getAdapter:e=>{e=Re.isArray(e)?e:[e];const{length:t}=e;let r,n;const a={};for(let i=0;i<t;i++){r=e[i];let o;if(n=r,!W7(r)&&(n=wy[(o=String(r)).toLowerCase()],n===void 0))throw new Et(`Unknown adapter '${o}'`);if(n)break;a[o||"#"+i]=n}if(!n){const i=Object.entries(a).map(([u,m])=>`adapter ${u} `+(m===!1?"is not supported by the environment":"is not available in the build"));let o=t?i.length>1?`since :
`+i.map(AA).join(`
`):" "+AA(i[0]):"as no adapter specified";throw new Et("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return n},adapters:wy};function cg(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new nu(null,e)}function _A(e){return cg(e),e.headers=ua.from(e.headers),e.data=og.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),WC.getAdapter(e.adapter||vf.adapter)(e).then(function(n){return cg(e),n.data=og.call(e,e.transformResponse,n),n.headers=ua.from(n.headers),n},function(n){return zC(n)||(cg(e),n&&n.response&&(n.response.data=og.call(e,e.transformResponse,n.response),n.response.headers=ua.from(n.response.headers))),Promise.reject(n)})}const XC="1.10.0",Ym={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Ym[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const TA={};Ym.transitional=function(t,r,n){function a(i,o){return"[Axios v"+XC+"] Transitional option '"+i+"'"+o+(n?". "+n:"")}return(i,o,u)=>{if(t===!1)throw new Et(a(o," has been removed"+(r?" in "+r:"")),Et.ERR_DEPRECATED);return r&&!TA[o]&&(TA[o]=!0,console.warn(a(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(i,o,u):!0}};Ym.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function X7(e,t,r){if(typeof e!="object")throw new Et("options must be an object",Et.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let a=n.length;for(;a-- >0;){const i=n[a],o=t[i];if(o){const u=e[i],m=u===void 0||o(u,i,e);if(m!==!0)throw new Et("option "+i+" must be "+m,Et.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Et("Unknown option "+i,Et.ERR_BAD_OPTION)}}const Mh={assertOptions:X7,validators:Ym},$i=Mh.validators;let xo=class{constructor(t){this.defaults=t||{},this.interceptors={request:new yA,response:new yA}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const i=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?i&&!String(n.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+i):n.stack=i}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=jo(this.defaults,r);const{transitional:n,paramsSerializer:a,headers:i}=r;n!==void 0&&Mh.assertOptions(n,{silentJSONParsing:$i.transitional($i.boolean),forcedJSONParsing:$i.transitional($i.boolean),clarifyTimeoutError:$i.transitional($i.boolean)},!1),a!=null&&(Re.isFunction(a)?r.paramsSerializer={serialize:a}:Mh.assertOptions(a,{encode:$i.function,serialize:$i.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Mh.assertOptions(r,{baseUrl:$i.spelling("baseURL"),withXsrfToken:$i.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=i&&Re.merge(i.common,i[r.method]);i&&Re.forEach(["delete","get","head","post","put","patch","common"],w=>{delete i[w]}),r.headers=ua.concat(o,i);const u=[];let m=!0;this.interceptors.request.forEach(function(b){typeof b.runWhen=="function"&&b.runWhen(r)===!1||(m=m&&b.synchronous,u.unshift(b.fulfilled,b.rejected))});const f=[];this.interceptors.response.forEach(function(b){f.push(b.fulfilled,b.rejected)});let h,x=0,v;if(!m){const w=[_A.bind(this),void 0];for(w.unshift.apply(w,u),w.push.apply(w,f),v=w.length,h=Promise.resolve(r);x<v;)h=h.then(w[x++],w[x++]);return h}v=u.length;let y=r;for(x=0;x<v;){const w=u[x++],b=u[x++];try{y=w(y)}catch(S){b.call(this,S);break}}try{h=_A.call(this,y)}catch(w){return Promise.reject(w)}for(x=0,v=f.length;x<v;)h=h.then(f[x++],f[x++]);return h}getUri(t){t=jo(this.defaults,t);const r=qC(t.baseURL,t.url,t.allowAbsoluteUrls);return BC(r,t.params,t.paramsSerializer)}};Re.forEach(["delete","get","head","options"],function(t){xo.prototype[t]=function(r,n){return this.request(jo(n||{},{method:t,url:r,data:(n||{}).data}))}});Re.forEach(["post","put","patch"],function(t){function r(n){return function(i,o,u){return this.request(jo(u||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}xo.prototype[t]=r(),xo.prototype[t+"Form"]=r(!0)});let Y7=class YC{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const n=this;this.promise.then(a=>{if(!n._listeners)return;let i=n._listeners.length;for(;i-- >0;)n._listeners[i](a);n._listeners=null}),this.promise.then=a=>{let i;const o=new Promise(u=>{n.subscribe(u),i=u}).then(a);return o.cancel=function(){n.unsubscribe(i)},o},t(function(i,o,u){n.reason||(n.reason=new nu(i,o,u),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new YC(function(a){t=a}),cancel:t}}};function Z7(e){return function(r){return e.apply(null,r)}}function Q7(e){return Re.isObject(e)&&e.isAxiosError===!0}const Sy={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Sy).forEach(([e,t])=>{Sy[t]=e});function ZC(e){const t=new xo(e),r=_C(xo.prototype.request,t);return Re.extend(r,xo.prototype,t,{allOwnKeys:!0}),Re.extend(r,t,null,{allOwnKeys:!0}),r.create=function(a){return ZC(jo(e,a))},r}const Rr=ZC(vf);Rr.Axios=xo;Rr.CanceledError=nu;Rr.CancelToken=Y7;Rr.isCancel=zC;Rr.VERSION=XC;Rr.toFormData=Wm;Rr.AxiosError=Et;Rr.Cancel=Rr.CanceledError;Rr.all=function(t){return Promise.all(t)};Rr.spread=Z7;Rr.isAxiosError=Q7;Rr.mergeConfig=jo;Rr.AxiosHeaders=ua;Rr.formToJSON=e=>$C(Re.isHTMLForm(e)?new FormData(e):e);Rr.getAdapter=WC.getAdapter;Rr.HttpStatusCode=Sy;Rr.default=Rr;const{Axios:ahe,AxiosError:ihe,CanceledError:she,isCancel:lhe,CancelToken:ohe,VERSION:che,all:uhe,Cancel:dhe,isAxiosError:fhe,spread:hhe,toFormData:mhe,AxiosHeaders:phe,HttpStatusCode:xhe,formToJSON:vhe,getAdapter:ghe,mergeConfig:yhe}=Rr,J7=window.location.origin,We=Rr.create({baseURL:J7,withCredentials:!0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",headers:{"X-Requested-With":"XMLHttpRequest"}});function QC(){const e=document.cookie.match(/(?:^|;\s*)XSRF-TOKEN=([^;]+)/);return e?decodeURIComponent(e[1]):""}We.interceptors.request.use(e=>{const t=(e.method||"get").toUpperCase();if(!["GET","HEAD","OPTIONS","TRACE"].includes(t)){const r=QC();r&&(e.headers["X-XSRF-TOKEN"]=r,e.headers["X-CSRFToken"]=r,e.headers["X-CSRF-Token"]=r)}return e});async function eB(e,t,r={}){const n=new FormData;Object.entries(r).forEach(([o,u])=>n.append(o,u)),n.append("file",t);const a=QC(),i={};return a&&(i["X-XSRF-TOKEN"]=a,i["X-CSRFToken"]=a,i["X-CSRF-Token"]=a),We.post(e,n,{headers:i})}const Di=g.createContext({user:void 0,setUser:()=>{},logout:async()=>{}});function tB({children:e}){const[t,r]=g.useState(void 0);g.useEffect(()=>{let i=!1;return(async()=>{try{const{data:o}=await We.get("/auth/me");if(!i)if(o?.ok&&o?.user){const u=o.user;r({id:u.id,email:u.email,user_type:(u.user_type||"").toLowerCase(),name:u.name||[u.first_name,u.last_name].filter(Boolean).join(" ")||null,permission:u.permission||null})}else r(null)}catch{i||r(null)}})(),()=>{i=!0}},[]);const n=async()=>{try{await We.post("/auth/logout")}catch{}r(null)},a=g.useMemo(()=>({user:t,setUser:r,logout:n}),[t]);return l.jsx(Di.Provider,{value:a,children:e})}function rB(){const e=es(),{setUser:t}=g.useContext(Di),[r,n]=g.useState(""),[a,i]=g.useState(""),[o,u]=g.useState(""),[m,f]=g.useState(!1),h=async v=>{v.preventDefault(),u(""),f(!0);try{const w=(await We.post("/auth/login",{email:r,username:r,password:a}))?.data||{};if(!w.ok)throw new Error(w.error||"Invalid email/username or password");await x()}catch(y){console.error("Login error:",y),u(y.message||"Login failed")}finally{f(!1)}},x=async()=>{try{const y=(await We.get("/auth/me"))?.data||{};if(!y.user)throw console.error("Unexpected /auth/me payload:",y),new Error("Unable to load your profile after login.");const w=y.user,b={id:w.id,email:w.email,user_type:(w.user_type||"").toLowerCase(),full_name:w.name||[w.first_name,w.last_name].filter(Boolean).join(" ")||null,permission:w.permission||null};t(b);const S=b.user_type;if(S==="admin")e("/admin-dashboard");else if(S==="groupadmin"||S==="investor")e("/investor-dashboard");else throw new Error("Unauthorized user role.")}catch(v){throw console.error("getMe() failed after login:",v),new Error("Unable to load your profile after login.")}};return l.jsx("div",{className:"min-h-screen grid place-items-center bg-emerald-500/90 p-6",children:l.jsxs("form",{onSubmit:h,className:"w-full max-w-md rounded-2xl bg-white p-8 shadow-xl space-y-4",children:[l.jsx("h1",{className:"text-2xl font-semibold text-center",children:"Login"}),o&&l.jsx("div",{className:"rounded-lg bg-amber-50 border border-amber-200 text-amber-800 px-4 py-3 text-sm",children:o}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Email or Username"}),l.jsx("input",{className:"mt-1 w-full rounded-lg border border-gray-200 px-4 py-2.5 outline-none focus:ring-4 focus:ring-emerald-100",value:r,onChange:v=>n(v.value||v.target.value),autoComplete:"username",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Password"}),l.jsx("input",{type:"password",className:"mt-1 w-full rounded-lg border border-gray-200 px-4 py-2.5 outline-none focus:ring-4 focus:ring-emerald-100",value:a,onChange:v=>i(v.value||v.target.value),autoComplete:"current-password",required:!0})]}),l.jsx("button",{type:"submit",disabled:m,className:"w-full rounded-lg bg-emerald-600 text-white py-3 font-semibold hover:brightness-110 active:scale-[0.99] disabled:opacity-60 disabled:cursor-not-allowed",children:m?"Signing in":"LOGIN"}),l.jsx("div",{className:"pt-1 text-center",children:l.jsx(Hm,{to:"/forgot-password",className:"inline-block text-sm text-emerald-700 hover:underline",children:"Forgot password?"})})]})})}/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nB=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),aB=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),kA=e=>{const t=aB(e);return t.charAt(0).toUpperCase()+t.slice(1)},JC=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim(),iB=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var sB={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lB=g.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:i,iconNode:o,...u},m)=>g.createElement("svg",{ref:m,...sB,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:JC("lucide",a),...!i&&!iB(u)&&{"aria-hidden":"true"},...u},[...o.map(([f,h])=>g.createElement(f,h)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yr=(e,t)=>{const r=g.forwardRef(({className:n,...a},i)=>g.createElement(lB,{ref:i,iconNode:t,className:JC(`lucide-${nB(kA(e))}`,`lucide-${e}`,n),...a}));return r.displayName=kA(e),r};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oB=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],eO=yr("archive",oB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cB=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],tO=yr("arrow-left",cB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uB=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],dB=yr("bell",uB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fB=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],rO=yr("briefcase",fB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hB=[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]],nO=yr("chart-no-axes-column",hB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mB=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],J0=yr("check",mB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pB=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],xB=yr("chevron-down",pB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vB=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],gB=yr("chevron-right",vB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yB=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],bB=yr("circle-check",yB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wB=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],CA=yr("cloud-upload",wB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SB=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],jB=yr("file-spreadsheet",SB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NB=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],$h=yr("file-text",NB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EB=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],AB=yr("file",EB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _B=[["path",{d:"M20 7h-3a2 2 0 0 1-2-2V2",key:"x099mo"}],["path",{d:"M9 18a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h7l4 4v10a2 2 0 0 1-2 2Z",key:"18t6ie"}],["path",{d:"M3 7.6v12.8A1.6 1.6 0 0 0 4.6 22h9.8",key:"1nja0z"}]],TB=yr("files",_B);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kB=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],OA=yr("house",kB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CB=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],aO=yr("loader-circle",CB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OB=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Zm=yr("log-out",OB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DB=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],ug=yr("mail",DB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PB=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],RB=yr("pen",PB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MB=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],FB=yr("plus",MB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IB=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],LB=yr("shield",IB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BB=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],iO=yr("trash-2",BB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UB=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],sO=yr("user-plus",UB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $B=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],kd=yr("users",$B);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zB=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],ys=yr("x",zB),eh="/api/settings",DA="/api/admin/users";function HB(e){return document.cookie.split("; ").find(t=>t.startsWith(e+"="))?.split("=")[1]||""}async function Sc(e,t={}){const r=new Headers(t.headers||{});if(t.method&&t.method!=="GET"||t.forceXsrf){const a=HB("XSRF-TOKEN");a&&r.set("X-XSRF-TOKEN",a)}return await fetch(e,{...t,headers:r,credentials:"include"})}function qB(){const[e,t]=g.useState(!1),[r,n]=g.useState(null),[a,i]=g.useState(null),[o,u]=g.useState(""),[m,f]=g.useState([]),[h,x]=g.useState(!0),[v,y]=g.useState(1),[w,b]=g.useState(25),[S,N]=g.useState(0),[_,A]=g.useState(""),[k,C]=g.useState(""),[O,T]=g.useState(""),[z,P]=g.useState(""),[Z,q]=g.useState(1),[B,fe]=g.useState(25),[Ne,he]=g.useState(0),[K,H]=g.useState([]),[be,te]=g.useState(null),I=Math.max(1,Math.ceil(Ne/Math.max(1,B))),se=async()=>{t(!0),u("");try{const ue=await(await Sc(`${eh}/logo`,{method:"GET",forceXsrf:!1})).json();n(ue.url||null)}catch(G){console.error(G),u("Failed to load current logo.")}finally{t(!1)}};g.useEffect(()=>{se()},[]);const R=G=>i(G.target.files?.[0]||null),W=async G=>{if(G.preventDefault(),!a){u("Choose an image first.");return}t(!0),u("");try{const ue=new FormData;ue.append("file",a);const Se=await Sc(`${eh}/logo`,{method:"POST",body:ue});let M={};try{M=await Se.json()}catch{}if(!Se.ok)throw new Error(M.error||`Upload failed (${Se.status})`);n(M.url),i(null),u("Logo updated.")}catch(ue){console.error(ue),u(ue.message==="Forbidden"?"CSRF validation failed":ue.message)}finally{t(!1)}},Y=async()=>{if(window.confirm("Remove the current logo?")){t(!0),u("");try{const G=await Sc(`${eh}/logo`,{method:"DELETE"});let ue={};try{ue=await G.json()}catch{}if(!G.ok)throw new Error(ue.error||`Remove failed (${G.status})`);n(null),u("Logo removed.")}catch(G){console.error(G),u(G.message==="Forbidden"?"CSRF validation failed":G.message)}finally{t(!1)}}},Q=async()=>{x(!0);try{const G=new URLSearchParams({page:v,limit:w});_&&G.set("role",_),k&&G.set("action",k);const ue=await Sc(`${eh}/activity?${G.toString()}`,{method:"GET"}),Se=await ue.json();if(!ue.ok)throw new Error(Se.error||"Failed to load activity");f(Se.items||[]),N(Se.total||0)}catch(G){console.error(G),f([]),N(0)}finally{x(!1)}};g.useEffect(()=>{Q()},[v,w,_,k]);const L=Math.max(1,Math.ceil(S/Math.max(1,w))),ne=async(G=Z)=>{try{const ue=new URLSearchParams({page:G,per_page:B});O&&ue.set("q",O),z&&ue.set("role",z);const Se=await Sc(`${DA}?${ue.toString()}`,{method:"GET"});if(Se.status===401||Se.status===403){console.warn("Account Controls: unauthorized. Are you logged in?"),H([]),he(0);return}const M=await Se.json();if(!Se.ok||M.ok===!1)throw new Error(M.error||"Failed to load users");H(M.data||[]),he(M.total||0),q(M.page||G)}catch(ue){console.error(ue),H([]),he(0)}};g.useEffect(()=>{ne(1)},[O,z,B]),g.useEffect(()=>{ne(Z)},[Z]);const ge=async(G,ue,Se)=>{te(G);try{const M=await Sc(`${DA}/${G}/${ue}`,{method:"POST",headers:Se?{"Content-Type":"application/json"}:void 0,body:Se?JSON.stringify(Se):void 0});if(M.status===401||M.status===403)throw new Error("Not authorized. Please sign in again.");const Qe=await M.json();if(!M.ok||Qe.ok===!1)throw new Error(Qe.error||"Action failed");await ne(Z),ue==="send-reset"&&Qe.url&&console.info("Password reset URL:",Qe.url)}catch(M){alert(M.message)}finally{te(null)}};return l.jsxs("div",{className:"max-w-5xl space-y-6",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Settings"}),l.jsxs("div",{className:"bg-white border rounded-xl p-4 shadow-sm",children:[l.jsx("h3",{className:"text-base font-semibold mb-3",children:"Statement Branding"}),l.jsxs("div",{className:"flex items-start gap-6",children:[l.jsx("div",{className:"w-40 h-40 border rounded-md flex items-center justify-center bg-gray-50",children:r?l.jsx("img",{src:r,alt:"Current logo",className:"max-w-full max-h-full object-contain"}):l.jsx("span",{className:"text-gray-400 text-sm",children:"No Logo"})}),l.jsxs("form",{onSubmit:W,className:"flex-1 space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Upload New Logo"}),l.jsx("input",{type:"file",accept:"image/png,image/jpeg,image/webp,image/svg+xml",onChange:R,className:"block w-full text-sm text-gray-700 file:mr-4 file:py-2 file:px-3 file:rounded-md file:border-0 file:bg-blue-600 file:text-white hover:file:bg-blue-700"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Recommended: transparent PNG, at least 200200 px."})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{type:"submit",disabled:e,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:e?"Saving":"Save Logo"}),l.jsx("button",{type:"button",disabled:e||!r,onClick:Y,className:"px-4 py-2 bg-gray-100 text-gray-800 rounded-md hover:bg-gray-200 disabled:opacity-50",children:"Remove"}),l.jsx("button",{type:"button",onClick:se,className:"px-3 py-2 text-sm text-gray-600 hover:text-gray-900",children:"Refresh"})]}),o&&l.jsx("p",{className:"text-sm text-gray-700",children:o})]})]})]}),l.jsxs("div",{className:"bg-white border rounded-xl p-4 shadow-sm",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("h3",{className:"text-base font-semibold",children:"User Activity Log"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("select",{value:k,onChange:G=>{y(1),C(G.target.value)},className:"border rounded px-2 py-1 text-sm",children:[l.jsx("option",{value:"",children:"All actions"}),l.jsx("option",{value:"login",children:"Login"}),l.jsx("option",{value:"logout",children:"Logout"})]}),l.jsxs("select",{value:_,onChange:G=>{y(1),A(G.target.value)},className:"border rounded px-2 py-1 text-sm",children:[l.jsx("option",{value:"",children:"All roles"}),l.jsx("option",{value:"admin",children:"Admin"}),l.jsx("option",{value:"investor",children:"Investor"}),l.jsx("option",{value:"groupadmin",children:"Group admin"})]}),l.jsx("select",{value:w,onChange:G=>{y(1),b(parseInt(G.target.value,10))},className:"border rounded px-2 py-1 text-sm",children:[10,25,50,100].map(G=>l.jsxs("option",{value:G,children:[G,"/page"]},G))})]})]}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full text-sm border",children:[l.jsx("thead",{className:"bg-gray-100",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-3 py-2 border",children:"User"}),l.jsx("th",{className:"px-3 py-2 border",children:"Role"}),l.jsx("th",{className:"px-3 py-2 border",children:"Action"}),l.jsx("th",{className:"px-3 py-2 border",children:"Date & Time"}),l.jsx("th",{className:"px-3 py-2 border",children:"IP"})]})}),l.jsx("tbody",{children:h?l.jsx("tr",{children:l.jsx("td",{className:"px-3 py-4 border text-center",colSpan:5,children:"Loading"})}):m.length===0?l.jsx("tr",{children:l.jsx("td",{className:"px-3 py-4 border text-center",colSpan:5,children:"No activity yet"})}):m.map(G=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-3 py-2 border",children:G.name||G.user_id||"-"}),l.jsx("td",{className:"px-3 py-2 border",children:G.role||"-"}),l.jsx("td",{className:"px-3 py-2 border",children:l.jsx("span",{className:"px-2 py-1 rounded text-white "+(G.action==="login"?"bg-green-500":"bg-rose-500"),children:G.action})}),l.jsx("td",{className:"px-3 py-2 border",children:new Date(G.created_at).toLocaleString()}),l.jsx("td",{className:"px-3 py-2 border",children:G.ip||"-"})]},G.id))})]})}),l.jsxs("div",{className:"flex justify-between items-center mt-3",children:[l.jsxs("p",{className:"text-xs text-gray-500",children:["Showing ",m.length," of ",S," records"]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",disabled:v<=1,onClick:()=>y(G=>G-1),children:"Prev"}),l.jsxs("span",{className:"text-sm",children:["Page ",v," / ",L]}),l.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",disabled:v>=L,onClick:()=>y(G=>G+1),children:"Next"})]})]})]}),l.jsxs("div",{className:"bg-white border rounded-xl p-4 shadow-sm",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("h3",{className:"text-base font-semibold",children:"Account Controls"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("input",{value:O,onChange:G=>T(G.target.value),placeholder:"Search name or email",className:"border rounded px-2 py-1 text-sm"}),l.jsxs("select",{value:z,onChange:G=>{P(G.target.value),q(1)},className:"border rounded px-2 py-1 text-sm",children:[l.jsx("option",{value:"",children:"All roles"}),l.jsx("option",{value:"admin",children:"Admin"}),l.jsx("option",{value:"investor",children:"Investor"})]}),l.jsx("select",{value:B,onChange:G=>{fe(parseInt(G.target.value,10)),q(1)},className:"border rounded px-2 py-1 text-sm",children:[10,25,50,100].map(G=>l.jsxs("option",{value:G,children:[G,"/page"]},G))})]})]}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full text-sm border",children:[l.jsx("thead",{className:"bg-gray-100",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-3 py-2 border",children:"User"}),l.jsx("th",{className:"px-3 py-2 border",children:"Email"}),l.jsx("th",{className:"px-3 py-2 border",children:"Role"}),l.jsx("th",{className:"px-3 py-2 border",children:"Status"}),l.jsx("th",{className:"px-3 py-2 border text-right",children:"Actions"})]})}),l.jsx("tbody",{children:K.length===0?l.jsx("tr",{children:l.jsx("td",{className:"px-3 py-4 border text-center",colSpan:5,children:"No users found"})}):K.map(G=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-3 py-2 border",children:G.name}),l.jsx("td",{className:"px-3 py-2 border",children:G.email}),l.jsx("td",{className:"px-3 py-2 border capitalize",children:G.role}),l.jsx("td",{className:"px-3 py-2 border",children:G.is_blocked?l.jsx("span",{className:"px-2 py-1 rounded bg-rose-100 text-rose-700",children:"Blocked"}):l.jsx("span",{className:"px-2 py-1 rounded bg-green-100 text-green-700",children:"Active"})}),l.jsxs("td",{className:"px-3 py-2 border text-right",children:[G.is_blocked?l.jsx("button",{className:"px-3 py-1 rounded bg-green-600 text-white disabled:opacity-50 mr-2",disabled:be===G.id,onClick:()=>ge(G.id,"unblock"),children:"Unblock"}):l.jsx("button",{className:"px-3 py-1 rounded bg-rose-600 text-white disabled:opacity-50 mr-2",disabled:be===G.id,onClick:()=>{const ue=window.prompt("Reason for blocking (optional):")||"";ge(G.id,"block",{reason:ue})},children:"Block"}),l.jsx("button",{className:"px-3 py-1 rounded bg-indigo-600 text-white disabled:opacity-50",disabled:be===G.id,onClick:()=>ge(G.id,"send-reset"),children:"Send Reset"})]})]},G.id))})]})}),l.jsxs("div",{className:"flex justify-between items-center mt-3",children:[l.jsxs("p",{className:"text-xs text-gray-500",children:["Showing ",K.length," of ",Ne," users"]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",disabled:Z<=1,onClick:()=>q(G=>G-1),children:"Prev"}),l.jsxs("span",{className:"text-sm",children:["Page ",Z," / ",I]}),l.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",disabled:Z>=I,onClick:()=>q(G=>G+1),children:"Next"})]})]})]})]})}function VB({onSuccess:e}){const[t,r]=g.useState({name:"",email:""}),[n,a]=g.useState({type:"",msg:""}),[i,o]=g.useState(!1),u=h=>r(x=>({...x,[h.target.name]:h.target.value})),m=()=>r({name:"",email:""}),f=async h=>{h.preventDefault(),a({type:"",msg:""});const x=t.name.trim(),v=t.email.trim().toLowerCase();if(!x||!v){a({type:"error",msg:"Name and email are required."});return}try{o(!0);const{data:y}=await We.post("/api/admin/invite-admin",{name:x,email:v});if(!y?.ok)throw new Error(y?.error||y?.msg||"Invite failed.");const w=y?.mail_error&&!y?.emailed?`Admin invitation created. Email not sent (${y.mail_error}). You can use this link: ${y.accept_url}`:y?.msg||"Admin invitation created successfully.";a({type:"success",msg:w}),m(),e?.()}catch(y){const w=y?.response?.data?.error||y?.response?.data?.msg||y?.message||"Failed to send invite.";a({type:"error",msg:w})}finally{o(!1)}};return l.jsx("div",{className:"min-h-[60vh] w-full grid place-items-center px-4 py-8",children:l.jsxs("div",{className:"relative w-full max-w-xl",children:[l.jsx("div",{className:"absolute -inset-1 rounded-3xl bg-gradient-to-r from-indigo-500 via-fuchsia-500 to-rose-500 blur opacity-25 animate-pulse"}),l.jsxs("div",{className:"relative rounded-3xl border border-white/10 bg-white/60 backdrop-blur-xl shadow-2xl",children:[l.jsxs("div",{className:"p-6 sm:p-8 border-b border-black/5 bg-gradient-to-br from-white/80 to-white/40 rounded-t-3xl",children:[l.jsx("h1",{className:"text-xl sm:text-2xl font-semibold tracking-tight",children:"Add Admin"}),l.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Invite a new admin user by email."})]}),l.jsxs("form",{onSubmit:f,className:"p-6 sm:p-8 space-y-5",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-800",children:"Name"}),l.jsx("input",{name:"name",value:t.name,onChange:u,required:!0,className:"w-full rounded-xl border border-gray-200 bg-white/90 px-4 py-2.5 outline-none focus:ring-4 focus:ring-indigo-100 focus:border-indigo-400 transition"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-800",children:"Email"}),l.jsx("input",{type:"email",name:"email",value:t.email,onChange:u,required:!0,className:"w-full rounded-xl border border-gray-200 bg-white/90 px-4 py-2.5 outline-none focus:ring-4 focus:ring-indigo-100 focus:border-indigo-400 transition"})]}),n.msg&&l.jsx("div",{className:["rounded-xl px-4 py-3 text-sm border break-words",n.type==="success"?"bg-emerald-50 border-emerald-200 text-emerald-700":"bg-rose-50 border-rose-200 text-rose-700"].join(" "),children:n.msg}),l.jsx("div",{className:"pt-2",children:l.jsx("button",{type:"submit",disabled:i,className:"inline-flex items-center justify-center rounded-xl bg-gradient-to-r from-indigo-600 to-fuchsia-600 text-white font-medium px-5 py-3 shadow-lg shadow-indigo-600/20 hover:shadow-fuchsia-600/25 hover:brightness-110 active:scale-[0.99] disabled:opacity-60 disabled:cursor-not-allowed transition-all duration-150",children:i?"Sending":"Send Invitation"})})]})]})]})})}function KB(e){return document.cookie.split("; ").find(t=>t.startsWith(e+"="))?.split("=")[1]||""}async function GB(e,t={}){const r=new Headers(t.headers||{});if(t.method&&t.method!=="GET"||t.forceXsrf){const n=KB("XSRF-TOKEN");n&&r.set("X-XSRF-TOKEN",n)}return fetch(e,{...t,headers:r,credentials:"include"})}const WB="/api/admin/invite-admin";function XB({onSuccess:e}){const[t,r]=g.useState({name:"",email:""}),[n,a]=g.useState({type:"",msg:""}),[i,o]=g.useState(!1),u=f=>r(h=>({...h,[f.target.name]:f.target.value})),m=async f=>{f.preventDefault(),a({type:"",msg:""});try{o(!0);const h=await GB(WB,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t.name.trim(),email:t.email.trim()})}),x=await h.json().catch(()=>({}));if(h.status===401||h.status===403){a({type:"error",msg:"You are not authorized. Please log in as an admin."});return}if(!h.ok||x.ok===!1)throw new Error(x?.error||`${h.status} ${h.statusText}`);a({type:"success",msg:x.emailed===!1&&x.accept_url?"Admin invitation created. Email could not be sent, but you can copy the link: "+x.accept_url:"Admin invitation sent successfully!"}),r({name:"",email:""}),e&&e()}catch(h){a({type:"error",msg:h.message||"Failed to send invite."})}finally{o(!1)}};return l.jsx("div",{className:"min-h-[60vh] w-full grid place-items-center px-4 py-8",children:l.jsxs("div",{className:"relative w-full max-w-xl",children:[l.jsx("div",{className:"absolute -inset-1 rounded-3xl bg-gradient-to-r from-indigo-500 via-fuchsia-500 to-rose-500 blur opacity-25 animate-pulse"}),l.jsxs("div",{className:"relative rounded-3xl border border-white/10 bg-white/60 backdrop-blur-xl shadow-2xl",children:[l.jsx("div",{className:"p-6 sm:p-8 border-b border-black/5 bg-gradient-to-br from-white/80 to-white/40 rounded-t-3xl",children:l.jsx("h1",{className:"text-xl sm:text-2xl font-semibold tracking-tight",children:"Add Admin"})}),l.jsxs("form",{onSubmit:m,className:"p-6 sm:p-8 space-y-5",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-800",children:"Name"}),l.jsx("input",{name:"name",value:t.name,onChange:u,required:!0,className:"w-full rounded-xl border border-gray-200 bg-white/90 px-4 py-2.5 outline-none focus:ring-4 focus:ring-indigo-100 focus:border-indigo-400 transition"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-800",children:"Email"}),l.jsx("input",{type:"email",name:"email",value:t.email,onChange:u,required:!0,className:"w-full rounded-xl border border-gray-200 bg-white/90 px-4 py-2.5 outline-none focus:ring-4 focus:ring-indigo-100 focus:border-indigo-400 transition"})]}),n.msg&&l.jsx("div",{className:["rounded-xl px-4 py-3 text-sm border",n.type==="success"?"bg-emerald-50 border-emerald-200 text-emerald-700":"bg-rose-50 border-rose-200 text-rose-700"].join(" "),children:n.msg}),l.jsx("div",{className:"pt-2",children:l.jsx("button",{type:"submit",disabled:i,className:"inline-flex items-center justify-center rounded-xl bg-gradient-to-r from-indigo-600 to-fuchsia-600 text-white font-medium px-5 py-3 shadow-lg shadow-indigo-600/20 hover:shadow-fuchsia-600/25 hover:brightness-110 active:scale-[0.99] disabled:opacity-60 disabled:cursor-not-allowed transition-all duration-150",children:i?"Sending":"Send Invitation"})})]})]})]})})}const dg=10;function YB(e){return document.cookie.split("; ").find(t=>t.startsWith(e+"="))?.split("=")[1]||""}async function ZB(e,t={}){const r=new Headers(t.headers||{});if(t.method&&t.method!=="GET"||t.forceXsrf){const n=YB("XSRF-TOKEN");n&&r.set("X-XSRF-TOKEN",n)}return fetch(e,{...t,headers:r,credentials:"include"})}const QB="/api/admin/users";function JB(){const[e,t]=g.useState([]),[r,n]=g.useState([]),[a,i]=g.useState(""),[o,u]=g.useState(!0),[m,f]=g.useState(""),[h,x]=g.useState(1),[v,y]=g.useState(!1),w=(h-1)*dg,b=g.useMemo(()=>r.slice(w,w+dg),[r,w]);async function S(){u(!0),f("");try{const _=new URL(QB,window.location.origin);_.searchParams.set("role","admin"),_.searchParams.set("page","1"),_.searchParams.set("per_page","250");const A=await ZB(_.toString(),{method:"GET"}),k=await A.json().catch(()=>({}));if(!A.ok||k.ok===!1)throw new Error(k.error||`Failed to load admins (${A.status})`);const C=Array.isArray(k.data)?k.data:[];t(C),n(C)}catch(_){f(_.message||"Failed to load admins.")}finally{u(!1)}}g.useEffect(()=>{S()},[]),g.useEffect(()=>{const _=a.trim().toLowerCase(),A=e.filter(k=>(k.name||`${k.first_name||""} ${k.last_name||""}`).trim().toLowerCase().includes(_)||(k.email||"").toLowerCase().includes(_));n(A),x(1)},[a,e]);const N=Math.max(1,Math.ceil(r.length/dg));return o?l.jsx("p",{className:"mt-6 text-center",children:"Loading admins"}):m?l.jsx("p",{className:"mt-6 text-center text-red-600",children:m}):l.jsxs("div",{className:"p-4",children:[l.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row gap-4 sm:items-center sm:justify-between",children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"All Admins"}),l.jsxs("div",{className:"flex w-full sm:w-auto gap-3",children:[l.jsx("input",{type:"text",value:a,onChange:_=>i(_.target.value),placeholder:" Search by name or email",className:"flex-1 sm:w-80 px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),l.jsx("button",{onClick:()=>y(!0),className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-semibold px-5 py-2 rounded-lg shadow-md",children:"+ Add New Admin"})]})]}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full bg-white border border-gray-200 rounded-lg shadow",children:[l.jsx("thead",{className:"bg-blue-600 text-white",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-2 text-left",children:"Name"}),l.jsx("th",{className:"px-4 py-2 text-left",children:"Email"}),l.jsx("th",{className:"px-4 py-2 text-left",children:"Status"}),l.jsx("th",{className:"px-4 py-2 text-left",children:"Permission"})]})}),l.jsx("tbody",{children:b.length===0?l.jsx("tr",{children:l.jsx("td",{colSpan:"4",className:"text-center p-4",children:"No admins found."})}):b.map(_=>{const A=(_.name||`${_.first_name||""} ${_.last_name||""}`).trim(),k=_.status&&_.status!=="-"?_.status:"Active",C=_.permission&&_.permission!=="-"?_.permission:"Viewer";return l.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[l.jsx("td",{className:"px-4 py-2",children:A||"-"}),l.jsx("td",{className:"px-4 py-2",children:_.email||"-"}),l.jsx("td",{className:"px-4 py-2",children:k}),l.jsx("td",{className:"px-4 py-2",children:C})]},_.id||_.email)})})]})}),l.jsxs("div",{className:"text-sm text-gray-500 mt-4",children:["Showing ",b.length," of ",r.length," admins"]}),N>1&&l.jsxs("div",{className:"mt-4 flex justify-center items-center gap-4",children:[l.jsx("button",{onClick:()=>x(_=>Math.max(1,_-1)),disabled:h===1,className:"px-4 py-2 border rounded-lg bg-gray-100 hover:bg-gray-200 disabled:opacity-50",children:" Prev"}),l.jsxs("span",{className:"text-gray-700 font-semibold",children:["Page ",h," of ",N]}),l.jsx("button",{onClick:()=>x(_=>Math.min(N,_+1)),disabled:h===N,className:"px-4 py-2 border rounded-lg bg-gray-100 hover:bg-gray-200 disabled:opacity-50",children:"Next "})]}),v&&l.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:l.jsxs("div",{className:"relative w-full max-w-3xl",children:[l.jsx("button",{onClick:()=>y(!1),className:"absolute -top-3 -right-3 bg-white text-gray-600 px-3 py-1 rounded-full shadow","aria-label":"Close",children:""}),l.jsx("div",{className:"bg-white rounded-lg overflow-hidden shadow-lg max-h-[90vh] overflow-y-auto",children:l.jsx(XB,{onSuccess:()=>{y(!1),S()}})})]})})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var lO=1252,e9=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Gb={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Wb=function(e){e9.indexOf(e)!=-1&&(lO=Gb[0]=e)};function t9(){Wb(1252)}var Ai=function(e){Wb(e)};function oO(){Ai(1200),t9()}function PA(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function r9(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function cO(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Sd=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?r9(e.slice(2)):t==254&&r==255?cO(e.slice(2)):t==65279?e.slice(1):e},th=function(t){return String.fromCharCode(t)},RA=function(t){return String.fromCharCode(t)},Kd,Sl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function MA(e){for(var t="",r=0,n=0,a=0,i=0,o=0,u=0,m=0,f=0;f<e.length;)r=e.charCodeAt(f++),i=r>>2,n=e.charCodeAt(f++),o=(r&3)<<4|n>>4,a=e.charCodeAt(f++),u=(n&15)<<2|a>>6,m=a&63,isNaN(n)?u=m=64:isNaN(a)&&(m=64),t+=Sl.charAt(i)+Sl.charAt(o)+Sl.charAt(u)+Sl.charAt(m);return t}function Ra(e){var t="",r=0,n=0,a=0,i=0,o=0,u=0,m=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<e.length;)i=Sl.indexOf(e.charAt(f++)),o=Sl.indexOf(e.charAt(f++)),r=i<<2|o>>4,t+=String.fromCharCode(r),u=Sl.indexOf(e.charAt(f++)),n=(o&15)<<4|u>>2,u!==64&&(t+=String.fromCharCode(n)),m=Sl.indexOf(e.charAt(f++)),a=(u&3)<<6|m,m!==64&&(t+=String.fromCharCode(a));return t}var Ut=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Oo=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Tl(e){return Ut?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function FA(e){return Ut?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ji=function(t){return Ut?Oo(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Do(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Xb(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Xb(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var bl=Ut?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Oo(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function n9(e){for(var t=[],r=0,n=e.length+250,a=Tl(e.length+255),i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o<128)a[r++]=o;else if(o<2048)a[r++]=192|o>>6&31,a[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var u=e.charCodeAt(++i)&1023;a[r++]=240|o>>8&7,a[r++]=128|o>>2&63,a[r++]=128|u>>6&15|(o&3)<<4,a[r++]=128|u&63}else a[r++]=224|o>>12&15,a[r++]=128|o>>6&63,a[r++]=128|o&63;r>n&&(t.push(a.slice(0,r)),r=0,a=Tl(65535),n=65530)}return t.push(a.slice(0,r)),bl(t)}var Yn=/\u0000/g,jd=/[\u0001-\u0006]/g;function Pc(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function _i(e,t){var r=""+e;return r.length>=t?r:Dr("0",t-r.length)+r}function Yb(e,t){var r=""+e;return r.length>=t?r:Dr(" ",t-r.length)+r}function zh(e,t){var r=""+e;return r.length>=t?r:r+Dr(" ",t-r.length)}function a9(e,t){var r=""+Math.round(e);return r.length>=t?r:Dr("0",t-r.length)+r}function i9(e,t){var r=""+e;return r.length>=t?r:Dr("0",t-r.length)+r}var IA=Math.pow(2,32);function jc(e,t){if(e>IA||e<-IA)return a9(e,t);var r=Math.round(e);return i9(r,t)}function Hh(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var LA=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],fg=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function s9(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Tt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},BA={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},l9={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function qh(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,o=1,u=0,m=1,f=0,h=0,x=Math.floor(a);f<t&&(x=Math.floor(a),u=x*o+i,h=x*f+m,!(a-x<5e-8));)a=1/(a-x),i=o,o=u,m=f,f=h;if(h>t&&(f>t?(h=m,u=i):(h=f,u=o)),!r)return[0,n*u,h];var v=Math.floor(n*u/h);return[v,n*u-v*h,h]}function co(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,o=[],u={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),t&&t.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++a==86400&&(u.T=a=0,++n,++u.D)),n===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var m=new Date(1900,0,1);m.setDate(m.getDate()+n-1),o=[m.getFullYear(),m.getMonth()+1,m.getDate()],i=m.getDay(),n<60&&(i=(i+6)%7),r&&(i=h9(m,o))}return u.y=o[0],u.m=o[1],u.d=o[2],u.S=a%60,a=Math.floor(a/60),u.M=a%60,a=Math.floor(a/60),u.H=a,u.q=i,u}var uO=new Date(1899,11,31,0,0,0),o9=uO.getTime(),c9=new Date(1900,2,1,0,0,0);function dO(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=c9&&(r+=24*60*60*1e3),(r-(o9+(e.getTimezoneOffset()-uO.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Zb(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function u9(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function d9(e){var t=e<0?12:11,r=Zb(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function f9(e){var t=Zb(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Gd(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=d9(e):t===10?r=e.toFixed(10).substr(0,12):r=f9(e),Zb(u9(r.toUpperCase()))}function No(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Gd(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return oi(14,dO(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function h9(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function m9(e,t,r,n){var a="",i=0,o=0,u=r.y,m,f=0;switch(e){case 98:u=r.y+543;case 121:switch(t.length){case 1:case 2:m=u%100,f=2;break;default:m=u%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:m=r.m,f=t.length;break;case 3:return fg[r.m-1][1];case 5:return fg[r.m-1][0];default:return fg[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:m=r.d,f=t.length;break;case 3:return LA[r.q][0];default:return LA[r.q][1]}break;case 104:switch(t.length){case 1:case 2:m=1+(r.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:m=r.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:m=r.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?_i(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),t==="s"?i===0?"0":""+i/o:(a=_i(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":m=r.D*24+r.H;break;case"[m]":case"[mm]":m=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":m=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:m=u,f=1;break}var h=f>0?_i(m,f):"";return h}function jl(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var fO=/%/g;function p9(e,t,r){var n=t.replace(fO,""),a=t.length-n.length;return As(e,n,r*Math.pow(10,2*a))+Dr("%",a)}function x9(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return As(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function hO(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+hO(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,m,f,h){return m+f+h.substr(0,(a+i)%a)+"."+h.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var mO=/# (\?+)( ?)\/( ?)(\d+)/;function v9(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),o=a-i*n,u=n;return r+(i===0?"":""+i)+" "+(o===0?Dr(" ",e[1].length+1+e[4].length):Yb(o,e[1].length)+e[2]+"/"+e[3]+_i(u,e[4].length))}function g9(e,t,r){return r+(t===0?"":""+t)+Dr(" ",e[1].length+2+e[4].length)}var pO=/^#*0*\.([0#]+)/,xO=/\).*[0#]/,vO=/\(###\) ###\\?-####/;function Kn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function UA(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function $A(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function y9(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function b9(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ei(e,t,r){if(e.charCodeAt(0)===40&&!t.match(xO)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ei("n",n,r):"("+ei("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return x9(e,t,r);if(t.indexOf("%")!==-1)return p9(e,t,r);if(t.indexOf("E")!==-1)return hO(t,r);if(t.charCodeAt(0)===36)return"$"+ei(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,o,u,m=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+jc(m,t.length);if(t.match(/^[#?]+$/))return a=jc(r,0),a==="0"&&(a=""),a.length>t.length?a:Kn(t.substr(0,t.length-a.length))+a;if(i=t.match(mO))return v9(i,m,f);if(t.match(/^#+0+$/))return f+jc(m,t.length-t.indexOf("0"));if(i=t.match(pO))return a=UA(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Kn(i[1])).replace(/\.$/,"."+Kn(i[1])).replace(/\.(\d*)$/,function(w,b){return"."+b+Dr("0",Kn(i[1]).length-b.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return f+UA(m,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return f+jl(jc(m,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ei(e,t,-r):jl(""+(Math.floor(r)+y9(r,i[1].length)))+"."+_i($A(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return ei(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Pc(ei(e,t.replace(/[\\-]/g,""),r)),o=0,Pc(Pc(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return o<a.length?a.charAt(o++):w==="0"?"0":""}));if(t.match(vO))return a=ei(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var h="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),u=qh(m,Math.pow(10,o)-1,!1),a=""+f,h=As("n",i[1],u[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),a+=h+i[2]+"/"+i[3],h=zh(u[2],o),h.length<i[4].length&&(h=Kn(i[4].substr(i[4].length-h.length))+h),a+=h,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),u=qh(m,Math.pow(10,o)-1,!0),f+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Yb(u[1],o)+i[2]+"/"+i[3]+zh(u[2],o):Dr(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=jc(r,0),t.length<=a.length?a:Kn(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var x=t.indexOf(".")-o,v=t.length-a.length-x;return Kn(t.substr(0,x)+a+t.substr(t.length-v))}if(i=t.match(/^00,000\.([#0]*0)$/))return o=$A(r,i[1].length),r<0?"-"+ei(e,t,-r):jl(b9(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?_i(0,3-w.length):"")+w})+"."+_i(o,i[1].length);switch(t){case"###,##0.00":return ei(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var y=jl(jc(m,0));return y!=="0"?f+y:"";case"###,###.00":return ei(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ei(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function w9(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return As(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function S9(e,t,r){var n=t.replace(fO,""),a=t.length-n.length;return As(e,n,r*Math.pow(10,2*a))+Dr("%",a)}function gO(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+gO(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,m,f,h){return m+f+h.substr(0,(a+i)%a)+"."+h.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function qi(e,t,r){if(e.charCodeAt(0)===40&&!t.match(xO)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?qi("n",n,r):"("+qi("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return w9(e,t,r);if(t.indexOf("%")!==-1)return S9(e,t,r);if(t.indexOf("E")!==-1)return gO(t,r);if(t.charCodeAt(0)===36)return"$"+qi(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,o,u,m=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+_i(m,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Kn(t.substr(0,t.length-a.length))+a;if(i=t.match(mO))return g9(i,m,f);if(t.match(/^#+0+$/))return f+_i(m,t.length-t.indexOf("0"));if(i=t.match(pO))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Kn(i[1])).replace(/\.$/,"."+Kn(i[1])),a=a.replace(/\.(\d*)$/,function(w,b){return"."+b+Dr("0",Kn(i[1]).length-b.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return f+(""+m).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return f+jl(""+m);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+qi(e,t,-r):jl(""+r)+"."+Dr("0",i[1].length);if(i=t.match(/^#,#*,#0/))return qi(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Pc(qi(e,t.replace(/[\\-]/g,""),r)),o=0,Pc(Pc(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return o<a.length?a.charAt(o++):w==="0"?"0":""}));if(t.match(vO))return a=qi(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var h="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),u=qh(m,Math.pow(10,o)-1,!1),a=""+f,h=As("n",i[1],u[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),a+=h+i[2]+"/"+i[3],h=zh(u[2],o),h.length<i[4].length&&(h=Kn(i[4].substr(i[4].length-h.length))+h),a+=h,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),u=qh(m,Math.pow(10,o)-1,!0),f+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Yb(u[1],o)+i[2]+"/"+i[3]+zh(u[2],o):Dr(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Kn(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var x=t.indexOf(".")-o,v=t.length-a.length-x;return Kn(t.substr(0,x)+a+t.substr(t.length-v))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+qi(e,t,-r):jl(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?_i(0,3-w.length):"")+w})+"."+_i(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var y=jl(""+m);return y!=="0"?f+y:"";default:if(t.match(/\.[0#?]*$/))return qi(e,t.slice(0,t.lastIndexOf(".")),r)+Kn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function As(e,t,r){return(r|0)===r?qi(e,t,r):ei(e,t,r)}function j9(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var yO=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function au(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Hh(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(yO))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function N9(e,t,r,n){for(var a=[],i="",o=0,u="",m="t",f,h,x,v="H";o<e.length;)switch(u=e.charAt(o)){case"G":if(!Hh(e,o))throw new Error("unrecognized character "+u+" in "+e);a[a.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(x=e.charCodeAt(++o))!==34&&o<e.length;)i+=String.fromCharCode(x);a[a.length]={t:"t",v:i},++o;break;case"\\":var y=e.charAt(++o),w=y==="("||y===")"?y:"t";a[a.length]={t:w,v:y},++o;break;case"_":a[a.length]={t:"t",v:" "},o+=2;break;case"@":a[a.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(f==null&&(f=co(t,r,e.charAt(o+1)==="2"),f==null))return"";a[a.length]={t:"X",v:e.substr(o,2)},m=u,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=co(t,r),f==null))return"";for(i=u;++o<e.length&&e.charAt(o).toLowerCase()===u;)i+=u;u==="m"&&m.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=v),a[a.length]={t:u,v:i},m=u;break;case"A":case"a":case"":var b={t:u,v:u};if(f==null&&(f=co(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(f!=null&&(b.v=f.H>=12?"P":"A"),b.t="T",v="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(f!=null&&(b.v=f.H>=12?"PM":"AM"),b.t="T",o+=5,v="h"):e.substr(o,5).toUpperCase()==="/"?(f!=null&&(b.v=f.H>=12?"":""),b.t="T",o+=5,v="h"):(b.t="t",++o),f==null&&b.t==="T")return"";a[a.length]=b,m=u;break;case"[":for(i=u;e.charAt(o++)!=="]"&&o<e.length;)i+=e.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(yO)){if(f==null&&(f=co(t,r),f==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},m=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",au(e)||(a[a.length]={t:"t",v:i}));break;case".":if(f!=null){for(i=u;++o<e.length&&(u=e.charAt(o))==="0";)i+=u;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=u;++o<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(o))>-1;)i+=u;a[a.length]={t:"n",v:i};break;case"?":for(i=u;e.charAt(++o)===u;)i+=u;a[a.length]={t:u,v:i},m=u;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":a[a.length]={t:n===1?"t":u,v:u},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=u;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)i+=e.charAt(o);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:u,v:u},++o;break;case"$":a[a.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+e);a[a.length]={t:"t",v:u},++o;break}var S=0,N=0,_;for(o=a.length-1,m="t";o>=0;--o)switch(a[o].t){case"h":case"H":a[o].t=v,m="h",S<1&&(S=1);break;case"s":(_=a[o].v.match(/\.0+$/))&&(N=Math.max(N,_[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":m=a[o].t;break;case"m":m==="s"&&(a[o].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&a[o].v.match(/[Hh]/)&&(S=1),S<2&&a[o].v.match(/[Mm]/)&&(S=2),S<3&&a[o].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var A="",k;for(o=0;o<a.length;++o)switch(a[o].t){case"t":case"T":case" ":case"D":break;case"X":a[o].v="",a[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[o].v=m9(a[o].t.charCodeAt(0),a[o].v,f,N),a[o].t="t";break;case"n":case"?":for(k=o+1;a[k]!=null&&((u=a[k].t)==="?"||u==="D"||(u===" "||u==="t")&&a[k+1]!=null&&(a[k+1].t==="?"||a[k+1].t==="t"&&a[k+1].v==="/")||a[o].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(a[k].v==="/"||a[k].v===" "&&a[k+1]!=null&&a[k+1].t=="?"));)a[o].v+=a[k].v,a[k]={v:"",t:";"},++k;A+=a[o].v,o=k-1;break;case"G":a[o].t="t",a[o].v=No(t,r);break}var C="",O,T;if(A.length>0){A.charCodeAt(0)==40?(O=t<0&&A.charCodeAt(0)===45?-t:t,T=As("n",A,O)):(O=t<0&&n>1?-t:t,T=As("n",A,O),O<0&&a[0]&&a[0].t=="t"&&(T=T.substr(1),a[0].v="-"+a[0].v)),k=T.length-1;var z=a.length;for(o=0;o<a.length;++o)if(a[o]!=null&&a[o].t!="t"&&a[o].v.indexOf(".")>-1){z=o;break}var P=a.length;if(z===a.length&&T.indexOf("E")===-1){for(o=a.length-1;o>=0;--o)a[o]==null||"n?".indexOf(a[o].t)===-1||(k>=a[o].v.length-1?(k-=a[o].v.length,a[o].v=T.substr(k+1,a[o].v.length)):k<0?a[o].v="":(a[o].v=T.substr(0,k+1),k=-1),a[o].t="t",P=o);k>=0&&P<a.length&&(a[P].v=T.substr(0,k+1)+a[P].v)}else if(z!==a.length&&T.indexOf("E")===-1){for(k=T.indexOf(".")-1,o=z;o>=0;--o)if(!(a[o]==null||"n?".indexOf(a[o].t)===-1)){for(h=a[o].v.indexOf(".")>-1&&o===z?a[o].v.indexOf(".")-1:a[o].v.length-1,C=a[o].v.substr(h+1);h>=0;--h)k>=0&&(a[o].v.charAt(h)==="0"||a[o].v.charAt(h)==="#")&&(C=T.charAt(k--)+C);a[o].v=C,a[o].t="t",P=o}for(k>=0&&P<a.length&&(a[P].v=T.substr(0,k+1)+a[P].v),k=T.indexOf(".")+1,o=z;o<a.length;++o)if(!(a[o]==null||"n?(".indexOf(a[o].t)===-1&&o!==z)){for(h=a[o].v.indexOf(".")>-1&&o===z?a[o].v.indexOf(".")+1:0,C=a[o].v.substr(0,h);h<a[o].v.length;++h)k<T.length&&(C+=T.charAt(k++));a[o].v=C,a[o].t="t",P=o}}}for(o=0;o<a.length;++o)a[o]!=null&&"n?".indexOf(a[o].t)>-1&&(O=n>1&&t<0&&o>0&&a[o-1].v==="-"?-t:t,a[o].v=As(a[o].t,a[o].v,O),a[o].t="t");var Z="";for(o=0;o!==a.length;++o)a[o]!=null&&(Z+=a[o].v);return Z}var zA=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function HA(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function E9(e,t){var r=j9(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(zA),u=r[1].match(zA);return HA(t,o)?[n,r[0]]:HA(t,u)?[n,r[1]]:[n,r[o!=null&&u!=null?2:1]]}return[n,i]}function oi(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Tt)[e],n==null&&(n=r.table&&r.table[BA[e]]||Tt[BA[e]]),n==null&&(n=l9[e]||"General");break}if(Hh(n,0))return No(t,r);t instanceof Date&&(t=dO(t,r.date1904));var a=E9(n,t);if(Hh(a[1]))return No(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return N9(a[1],t,r,a[0])}function vo(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Tt[r]==null){t<0&&(t=r);continue}if(Tt[r]==e){t=r;break}}t<0&&(t=391)}return Tt[t]=e,t}function bO(){Tt=s9()}var A9={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},wO=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function _9(e){var t=typeof e=="number"?Tt[e]:e;return t=t.replace(wO,"(\\d+)"),new RegExp("^"+t+"$")}function T9(e,t,r){var n=-1,a=-1,i=-1,o=-1,u=-1,m=-1;(t.match(wO)||[]).forEach(function(x,v){var y=parseInt(r[v+1],10);switch(x.toLowerCase().charAt(0)){case"y":n=y;break;case"d":i=y;break;case"h":o=y;break;case"s":m=y;break;case"m":o>=0?u=y:a=y;break}}),m>=0&&u==-1&&a>=0&&(u=a,a=-1);var f=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var h=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(m>=0?m:0)).slice(-2);return o==-1&&u==-1&&m==-1?f:n==-1&&a==-1&&i==-1?h:f+"T"+h}var k9=function(){var e={};e.version="1.2.0";function t(){for(var T=0,z=new Array(256),P=0;P!=256;++P)T=P,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,z[P]=T;return typeof Int32Array<"u"?new Int32Array(z):z}var r=t();function n(T){var z=0,P=0,Z=0,q=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(Z=0;Z!=256;++Z)q[Z]=T[Z];for(Z=0;Z!=256;++Z)for(P=T[Z],z=256+Z;z<4096;z+=256)P=q[z]=P>>>8^T[P&255];var B=[];for(Z=1;Z!=16;++Z)B[Z-1]=typeof Int32Array<"u"?q.subarray(Z*256,Z*256+256):q.slice(Z*256,Z*256+256);return B}var a=n(r),i=a[0],o=a[1],u=a[2],m=a[3],f=a[4],h=a[5],x=a[6],v=a[7],y=a[8],w=a[9],b=a[10],S=a[11],N=a[12],_=a[13],A=a[14];function k(T,z){for(var P=z^-1,Z=0,q=T.length;Z<q;)P=P>>>8^r[(P^T.charCodeAt(Z++))&255];return~P}function C(T,z){for(var P=z^-1,Z=T.length-15,q=0;q<Z;)P=A[T[q++]^P&255]^_[T[q++]^P>>8&255]^N[T[q++]^P>>16&255]^S[T[q++]^P>>>24]^b[T[q++]]^w[T[q++]]^y[T[q++]]^v[T[q++]]^x[T[q++]]^h[T[q++]]^f[T[q++]]^m[T[q++]]^u[T[q++]]^o[T[q++]]^i[T[q++]]^r[T[q++]];for(Z+=15;q<Z;)P=P>>>8^r[(P^T[q++])&255];return~P}function O(T,z){for(var P=z^-1,Z=0,q=T.length,B=0,fe=0;Z<q;)B=T.charCodeAt(Z++),B<128?P=P>>>8^r[(P^B)&255]:B<2048?(P=P>>>8^r[(P^(192|B>>6&31))&255],P=P>>>8^r[(P^(128|B&63))&255]):B>=55296&&B<57344?(B=(B&1023)+64,fe=T.charCodeAt(Z++)&1023,P=P>>>8^r[(P^(240|B>>8&7))&255],P=P>>>8^r[(P^(128|B>>2&63))&255],P=P>>>8^r[(P^(128|fe>>6&15|(B&3)<<4))&255],P=P>>>8^r[(P^(128|fe&63))&255]):(P=P>>>8^r[(P^(224|B>>12&15))&255],P=P>>>8^r[(P^(128|B>>6&63))&255],P=P>>>8^r[(P^(128|B&63))&255]);return~P}return e.table=r,e.bstr=k,e.buf=C,e.str=O,e}(),Ht=function(){var t={};t.version="1.2.1";function r(F,ee){for(var V=F.split("/"),X=ee.split("/"),J=0,re=0,ie=Math.min(V.length,X.length);J<ie;++J){if(re=V[J].length-X[J].length)return re;if(V[J]!=X[J])return V[J]<X[J]?-1:1}return V.length-X.length}function n(F){if(F.charAt(F.length-1)=="/")return F.slice(0,-1).indexOf("/")===-1?F:n(F.slice(0,-1));var ee=F.lastIndexOf("/");return ee===-1?F:F.slice(0,ee+1)}function a(F){if(F.charAt(F.length-1)=="/")return a(F.slice(0,-1));var ee=F.lastIndexOf("/");return ee===-1?F:F.slice(ee+1)}function i(F,ee){typeof ee=="string"&&(ee=new Date(ee));var V=ee.getHours();V=V<<6|ee.getMinutes(),V=V<<5|ee.getSeconds()>>>1,F.write_shift(2,V);var X=ee.getFullYear()-1980;X=X<<4|ee.getMonth()+1,X=X<<5|ee.getDate(),F.write_shift(2,X)}function o(F){var ee=F.read_shift(2)&65535,V=F.read_shift(2)&65535,X=new Date,J=V&31;V>>>=5;var re=V&15;V>>>=4,X.setMilliseconds(0),X.setFullYear(V+1980),X.setMonth(re-1),X.setDate(J);var ie=ee&31;ee>>>=5;var ve=ee&63;return ee>>>=6,X.setHours(ee),X.setMinutes(ve),X.setSeconds(ie<<1),X}function u(F){jn(F,0);for(var ee={},V=0;F.l<=F.length-4;){var X=F.read_shift(2),J=F.read_shift(2),re=F.l+J,ie={};switch(X){case 21589:V=F.read_shift(1),V&1&&(ie.mtime=F.read_shift(4)),J>5&&(V&2&&(ie.atime=F.read_shift(4)),V&4&&(ie.ctime=F.read_shift(4))),ie.mtime&&(ie.mt=new Date(ie.mtime*1e3));break}F.l=re,ee[X]=ie}return ee}var m;function f(){return m||(m={})}function h(F,ee){if(F[0]==80&&F[1]==75)return Bt(F,ee);if((F[0]|32)==109&&(F[1]|32)==105)return Ri(F,ee);if(F.length<512)throw new Error("CFB file size "+F.length+" < 512");var V=3,X=512,J=0,re=0,ie=0,ve=0,ce=0,ye=[],je=F.slice(0,512);jn(je,0);var Pe=x(je);switch(V=Pe[0],V){case 3:X=512;break;case 4:X=4096;break;case 0:if(Pe[1]==0)return Bt(F,ee);default:throw new Error("Major Version: Expected 3 or 4 saw "+V)}X!==512&&(je=F.slice(0,X),jn(je,28));var Ie=F.slice(0,X);v(je,V);var Ke=je.read_shift(4,"i");if(V===3&&Ke!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ke);je.l+=4,ie=je.read_shift(4,"i"),je.l+=4,je.chk("00100000","Mini Stream Cutoff Size: "),ve=je.read_shift(4,"i"),J=je.read_shift(4,"i"),ce=je.read_shift(4,"i"),re=je.read_shift(4,"i");for(var Ve=-1,Je=0;Je<109&&(Ve=je.read_shift(4,"i"),!(Ve<0));++Je)ye[Je]=Ve;var ft=y(F,X);S(ce,re,ft,X,ye);var Nt=_(ft,ie,ye,X);Nt[ie].name="!Directory",J>0&&ve!==fe&&(Nt[ve].name="!MiniFAT"),Nt[ye[0]].name="!FAT",Nt.fat_addrs=ye,Nt.ssz=X;var jt={},Rt=[],Mr=[],sn=[];A(ie,Nt,ft,Rt,J,jt,Mr,ve),w(Mr,sn,Rt),Rt.shift();var ln={FileIndex:Mr,FullPaths:sn};return ee&&ee.raw&&(ln.raw={header:Ie,sectors:ft}),ln}function x(F){if(F[F.l]==80&&F[F.l+1]==75)return[0,0];F.chk(Ne,"Header Signature: "),F.l+=16;var ee=F.read_shift(2,"u");return[F.read_shift(2,"u"),ee]}function v(F,ee){var V=9;switch(F.l+=2,V=F.read_shift(2)){case 9:if(ee!=3)throw new Error("Sector Shift: Expected 9 saw "+V);break;case 12:if(ee!=4)throw new Error("Sector Shift: Expected 12 saw "+V);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+V)}F.chk("0600","Mini Sector Shift: "),F.chk("000000000000","Reserved: ")}function y(F,ee){for(var V=Math.ceil(F.length/ee)-1,X=[],J=1;J<V;++J)X[J-1]=F.slice(J*ee,(J+1)*ee);return X[V-1]=F.slice(V*ee),X}function w(F,ee,V){for(var X=0,J=0,re=0,ie=0,ve=0,ce=V.length,ye=[],je=[];X<ce;++X)ye[X]=je[X]=X,ee[X]=V[X];for(;ve<je.length;++ve)X=je[ve],J=F[X].L,re=F[X].R,ie=F[X].C,ye[X]===X&&(J!==-1&&ye[J]!==J&&(ye[X]=ye[J]),re!==-1&&ye[re]!==re&&(ye[X]=ye[re])),ie!==-1&&(ye[ie]=X),J!==-1&&X!=ye[X]&&(ye[J]=ye[X],je.lastIndexOf(J)<ve&&je.push(J)),re!==-1&&X!=ye[X]&&(ye[re]=ye[X],je.lastIndexOf(re)<ve&&je.push(re));for(X=1;X<ce;++X)ye[X]===X&&(re!==-1&&ye[re]!==re?ye[X]=ye[re]:J!==-1&&ye[J]!==J&&(ye[X]=ye[J]));for(X=1;X<ce;++X)if(F[X].type!==0){if(ve=X,ve!=ye[ve])do ve=ye[ve],ee[X]=ee[ve]+"/"+ee[X];while(ve!==0&&ye[ve]!==-1&&ve!=ye[ve]);ye[X]=-1}for(ee[0]+="/",X=1;X<ce;++X)F[X].type!==2&&(ee[X]+="/")}function b(F,ee,V){for(var X=F.start,J=F.size,re=[],ie=X;V&&J>0&&ie>=0;)re.push(ee.slice(ie*B,ie*B+B)),J-=B,ie=so(V,ie*4);return re.length===0?en(0):bl(re).slice(0,F.size)}function S(F,ee,V,X,J){var re=fe;if(F===fe){if(ee!==0)throw new Error("DIFAT chain shorter than expected")}else if(F!==-1){var ie=V[F],ve=(X>>>2)-1;if(!ie)return;for(var ce=0;ce<ve&&(re=so(ie,ce*4))!==fe;++ce)J.push(re);S(so(ie,X-4),ee-1,V,X,J)}}function N(F,ee,V,X,J){var re=[],ie=[];J||(J=[]);var ve=X-1,ce=0,ye=0;for(ce=ee;ce>=0;){J[ce]=!0,re[re.length]=ce,ie.push(F[ce]);var je=V[Math.floor(ce*4/X)];if(ye=ce*4&ve,X<4+ye)throw new Error("FAT boundary crossed: "+ce+" 4 "+X);if(!F[je])break;ce=so(F[je],ye)}return{nodes:re,data:JA([ie])}}function _(F,ee,V,X){var J=F.length,re=[],ie=[],ve=[],ce=[],ye=X-1,je=0,Pe=0,Ie=0,Ke=0;for(je=0;je<J;++je)if(ve=[],Ie=je+ee,Ie>=J&&(Ie-=J),!ie[Ie]){ce=[];var Ve=[];for(Pe=Ie;Pe>=0;){Ve[Pe]=!0,ie[Pe]=!0,ve[ve.length]=Pe,ce.push(F[Pe]);var Je=V[Math.floor(Pe*4/X)];if(Ke=Pe*4&ye,X<4+Ke)throw new Error("FAT boundary crossed: "+Pe+" 4 "+X);if(!F[Je]||(Pe=so(F[Je],Ke),Ve[Pe]))break}re[Ie]={nodes:ve,data:JA([ce])}}return re}function A(F,ee,V,X,J,re,ie,ve){for(var ce=0,ye=X.length?2:0,je=ee[F].data,Pe=0,Ie=0,Ke;Pe<je.length;Pe+=128){var Ve=je.slice(Pe,Pe+128);jn(Ve,64),Ie=Ve.read_shift(2),Ke=t2(Ve,0,Ie-ye),X.push(Ke);var Je={name:Ke,type:Ve.read_shift(1),color:Ve.read_shift(1),L:Ve.read_shift(4,"i"),R:Ve.read_shift(4,"i"),C:Ve.read_shift(4,"i"),clsid:Ve.read_shift(16),state:Ve.read_shift(4,"i"),start:0,size:0},ft=Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2);ft!==0&&(Je.ct=k(Ve,Ve.l-8));var Nt=Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2);Nt!==0&&(Je.mt=k(Ve,Ve.l-8)),Je.start=Ve.read_shift(4,"i"),Je.size=Ve.read_shift(4,"i"),Je.size<0&&Je.start<0&&(Je.size=Je.type=0,Je.start=fe,Je.name=""),Je.type===5?(ce=Je.start,J>0&&ce!==fe&&(ee[ce].name="!StreamData")):Je.size>=4096?(Je.storage="fat",ee[Je.start]===void 0&&(ee[Je.start]=N(V,Je.start,ee.fat_addrs,ee.ssz)),ee[Je.start].name=Je.name,Je.content=ee[Je.start].data.slice(0,Je.size)):(Je.storage="minifat",Je.size<0?Je.size=0:ce!==fe&&Je.start!==fe&&ee[ce]&&(Je.content=b(Je,ee[ce].data,(ee[ve]||{}).data))),Je.content&&jn(Je.content,0),re[Ke]=Je,ie.push(Je)}}function k(F,ee){return new Date((Ta(F,ee+4)/1e7*Math.pow(2,32)+Ta(F,ee)/1e7-11644473600)*1e3)}function C(F,ee){return f(),h(m.readFileSync(F),ee)}function O(F,ee){var V=ee&&ee.type;switch(V||Ut&&Buffer.isBuffer(F)&&(V="buffer"),V||"base64"){case"file":return C(F,ee);case"base64":return h(ji(Ra(F)),ee);case"binary":return h(ji(F),ee)}return h(F,ee)}function T(F,ee){var V=ee||{},X=V.root||"Root Entry";if(F.FullPaths||(F.FullPaths=[]),F.FileIndex||(F.FileIndex=[]),F.FullPaths.length!==F.FileIndex.length)throw new Error("inconsistent CFB structure");F.FullPaths.length===0&&(F.FullPaths[0]=X+"/",F.FileIndex[0]={name:X,type:5}),V.CLSID&&(F.FileIndex[0].clsid=V.CLSID),z(F)}function z(F){var ee="Sh33tJ5";if(!Ht.find(F,"/"+ee)){var V=en(4);V[0]=55,V[1]=V[3]=50,V[2]=54,F.FileIndex.push({name:ee,type:2,content:V,size:4,L:69,R:69,C:69}),F.FullPaths.push(F.FullPaths[0]+ee),P(F)}}function P(F,ee){T(F);for(var V=!1,X=!1,J=F.FullPaths.length-1;J>=0;--J){var re=F.FileIndex[J];switch(re.type){case 0:X?V=!0:(F.FileIndex.pop(),F.FullPaths.pop());break;case 1:case 2:case 5:X=!0,isNaN(re.R*re.L*re.C)&&(V=!0),re.R>-1&&re.L>-1&&re.R==re.L&&(V=!0);break;default:V=!0;break}}if(!(!V&&!ee)){var ie=new Date(1987,1,19),ve=0,ce=Object.create?Object.create(null):{},ye=[];for(J=0;J<F.FullPaths.length;++J)ce[F.FullPaths[J]]=!0,F.FileIndex[J].type!==0&&ye.push([F.FullPaths[J],F.FileIndex[J]]);for(J=0;J<ye.length;++J){var je=n(ye[J][0]);X=ce[je],X||(ye.push([je,{name:a(je).replace("/",""),type:1,clsid:K,ct:ie,mt:ie,content:null}]),ce[je]=!0)}for(ye.sort(function(Ke,Ve){return r(Ke[0],Ve[0])}),F.FullPaths=[],F.FileIndex=[],J=0;J<ye.length;++J)F.FullPaths[J]=ye[J][0],F.FileIndex[J]=ye[J][1];for(J=0;J<ye.length;++J){var Pe=F.FileIndex[J],Ie=F.FullPaths[J];if(Pe.name=a(Ie).replace("/",""),Pe.L=Pe.R=Pe.C=-(Pe.color=1),Pe.size=Pe.content?Pe.content.length:0,Pe.start=0,Pe.clsid=Pe.clsid||K,J===0)Pe.C=ye.length>1?1:-1,Pe.size=0,Pe.type=5;else if(Ie.slice(-1)=="/"){for(ve=J+1;ve<ye.length&&n(F.FullPaths[ve])!=Ie;++ve);for(Pe.C=ve>=ye.length?-1:ve,ve=J+1;ve<ye.length&&n(F.FullPaths[ve])!=n(Ie);++ve);Pe.R=ve>=ye.length?-1:ve,Pe.type=1}else n(F.FullPaths[J+1]||"")==n(Ie)&&(Pe.R=J+1),Pe.type=2}}}function Z(F,ee){var V=ee||{};if(V.fileType=="mad")return Qn(F,V);switch(P(F),V.fileType){case"zip":return tr(F,V)}var X=function(Ke){for(var Ve=0,Je=0,ft=0;ft<Ke.FileIndex.length;++ft){var Nt=Ke.FileIndex[ft];if(Nt.content){var jt=Nt.content.length;jt>0&&(jt<4096?Ve+=jt+63>>6:Je+=jt+511>>9)}}for(var Rt=Ke.FullPaths.length+3>>2,Mr=Ve+7>>3,sn=Ve+127>>7,ln=Mr+Je+Rt+sn,Dt=ln+127>>7,Vt=Dt<=109?0:Math.ceil((Dt-109)/127);ln+Dt+Vt+127>>7>Dt;)Vt=++Dt<=109?0:Math.ceil((Dt-109)/127);var Yr=[1,Vt,Dt,sn,Rt,Je,Ve,0];return Ke.FileIndex[0].size=Ve<<6,Yr[7]=(Ke.FileIndex[0].start=Yr[0]+Yr[1]+Yr[2]+Yr[3]+Yr[4]+Yr[5])+(Yr[6]+7>>3),Yr}(F),J=en(X[7]<<9),re=0,ie=0;{for(re=0;re<8;++re)J.write_shift(1,he[re]);for(re=0;re<8;++re)J.write_shift(2,0);for(J.write_shift(2,62),J.write_shift(2,3),J.write_shift(2,65534),J.write_shift(2,9),J.write_shift(2,6),re=0;re<3;++re)J.write_shift(2,0);for(J.write_shift(4,0),J.write_shift(4,X[2]),J.write_shift(4,X[0]+X[1]+X[2]+X[3]-1),J.write_shift(4,0),J.write_shift(4,4096),J.write_shift(4,X[3]?X[0]+X[1]+X[2]-1:fe),J.write_shift(4,X[3]),J.write_shift(-4,X[1]?X[0]-1:fe),J.write_shift(4,X[1]),re=0;re<109;++re)J.write_shift(-4,re<X[2]?X[1]+re:-1)}if(X[1])for(ie=0;ie<X[1];++ie){for(;re<236+ie*127;++re)J.write_shift(-4,re<X[2]?X[1]+re:-1);J.write_shift(-4,ie===X[1]-1?fe:ie+1)}var ve=function(Ke){for(ie+=Ke;re<ie-1;++re)J.write_shift(-4,re+1);Ke&&(++re,J.write_shift(-4,fe))};for(ie=re=0,ie+=X[1];re<ie;++re)J.write_shift(-4,H.DIFSECT);for(ie+=X[2];re<ie;++re)J.write_shift(-4,H.FATSECT);ve(X[3]),ve(X[4]);for(var ce=0,ye=0,je=F.FileIndex[0];ce<F.FileIndex.length;++ce)je=F.FileIndex[ce],je.content&&(ye=je.content.length,!(ye<4096)&&(je.start=ie,ve(ye+511>>9)));for(ve(X[6]+7>>3);J.l&511;)J.write_shift(-4,H.ENDOFCHAIN);for(ie=re=0,ce=0;ce<F.FileIndex.length;++ce)je=F.FileIndex[ce],je.content&&(ye=je.content.length,!(!ye||ye>=4096)&&(je.start=ie,ve(ye+63>>6)));for(;J.l&511;)J.write_shift(-4,H.ENDOFCHAIN);for(re=0;re<X[4]<<2;++re){var Pe=F.FullPaths[re];if(!Pe||Pe.length===0){for(ce=0;ce<17;++ce)J.write_shift(4,0);for(ce=0;ce<3;++ce)J.write_shift(4,-1);for(ce=0;ce<12;++ce)J.write_shift(4,0);continue}je=F.FileIndex[re],re===0&&(je.start=je.size?je.start-1:fe);var Ie=re===0&&V.root||je.name;if(ye=2*(Ie.length+1),J.write_shift(64,Ie,"utf16le"),J.write_shift(2,ye),J.write_shift(1,je.type),J.write_shift(1,je.color),J.write_shift(-4,je.L),J.write_shift(-4,je.R),J.write_shift(-4,je.C),je.clsid)J.write_shift(16,je.clsid,"hex");else for(ce=0;ce<4;++ce)J.write_shift(4,0);J.write_shift(4,je.state||0),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(4,je.start),J.write_shift(4,je.size),J.write_shift(4,0)}for(re=1;re<F.FileIndex.length;++re)if(je=F.FileIndex[re],je.size>=4096)if(J.l=je.start+1<<9,Ut&&Buffer.isBuffer(je.content))je.content.copy(J,J.l,0,je.size),J.l+=je.size+511&-512;else{for(ce=0;ce<je.size;++ce)J.write_shift(1,je.content[ce]);for(;ce&511;++ce)J.write_shift(1,0)}for(re=1;re<F.FileIndex.length;++re)if(je=F.FileIndex[re],je.size>0&&je.size<4096)if(Ut&&Buffer.isBuffer(je.content))je.content.copy(J,J.l,0,je.size),J.l+=je.size+63&-64;else{for(ce=0;ce<je.size;++ce)J.write_shift(1,je.content[ce]);for(;ce&63;++ce)J.write_shift(1,0)}if(Ut)J.l=J.length;else for(;J.l<J.length;)J.write_shift(1,0);return J}function q(F,ee){var V=F.FullPaths.map(function(ce){return ce.toUpperCase()}),X=V.map(function(ce){var ye=ce.split("/");return ye[ye.length-(ce.slice(-1)=="/"?2:1)]}),J=!1;ee.charCodeAt(0)===47?(J=!0,ee=V[0].slice(0,-1)+ee):J=ee.indexOf("/")!==-1;var re=ee.toUpperCase(),ie=J===!0?V.indexOf(re):X.indexOf(re);if(ie!==-1)return F.FileIndex[ie];var ve=!re.match(jd);for(re=re.replace(Yn,""),ve&&(re=re.replace(jd,"!")),ie=0;ie<V.length;++ie)if((ve?V[ie].replace(jd,"!"):V[ie]).replace(Yn,"")==re||(ve?X[ie].replace(jd,"!"):X[ie]).replace(Yn,"")==re)return F.FileIndex[ie];return null}var B=64,fe=-2,Ne="d0cf11e0a1b11ae1",he=[208,207,17,224,161,177,26,225],K="00000000000000000000000000000000",H={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:fe,FREESECT:-1,HEADER_SIGNATURE:Ne,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:K,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function be(F,ee,V){f();var X=Z(F,V);m.writeFileSync(ee,X)}function te(F){for(var ee=new Array(F.length),V=0;V<F.length;++V)ee[V]=String.fromCharCode(F[V]);return ee.join("")}function I(F,ee){var V=Z(F,ee);switch(ee&&ee.type||"buffer"){case"file":return f(),m.writeFileSync(ee.filename,V),V;case"binary":return typeof V=="string"?V:te(V);case"base64":return MA(typeof V=="string"?V:te(V));case"buffer":if(Ut)return Buffer.isBuffer(V)?V:Oo(V);case"array":return typeof V=="string"?ji(V):V}return V}var se;function R(F){try{var ee=F.InflateRaw,V=new ee;if(V._processChunk(new Uint8Array([3,0]),V._finishFlushFlag),V.bytesRead)se=F;else throw new Error("zlib does not expose bytesRead")}catch(X){console.error("cannot use native zlib: "+(X.message||X))}}function W(F,ee){if(!se)return et(F,ee);var V=se.InflateRaw,X=new V,J=X._processChunk(F.slice(F.l),X._finishFlushFlag);return F.l+=X.bytesRead,J}function Y(F){return se?se.deflateRawSync(F):de(F)}var Q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],L=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ne=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ge(F){var ee=(F<<1|F<<11)&139536|(F<<5|F<<15)&558144;return(ee>>16|ee>>8|ee)&255}for(var G=typeof Uint8Array<"u",ue=G?new Uint8Array(256):[],Se=0;Se<256;++Se)ue[Se]=ge(Se);function M(F,ee){var V=ue[F&255];return ee<=8?V>>>8-ee:(V=V<<8|ue[F>>8&255],ee<=16?V>>>16-ee:(V=V<<8|ue[F>>16&255],V>>>24-ee))}function Qe(F,ee){var V=ee&7,X=ee>>>3;return(F[X]|(V<=6?0:F[X+1]<<8))>>>V&3}function xe(F,ee){var V=ee&7,X=ee>>>3;return(F[X]|(V<=5?0:F[X+1]<<8))>>>V&7}function me(F,ee){var V=ee&7,X=ee>>>3;return(F[X]|(V<=4?0:F[X+1]<<8))>>>V&15}function ze(F,ee){var V=ee&7,X=ee>>>3;return(F[X]|(V<=3?0:F[X+1]<<8))>>>V&31}function oe(F,ee){var V=ee&7,X=ee>>>3;return(F[X]|(V<=1?0:F[X+1]<<8))>>>V&127}function ke(F,ee,V){var X=ee&7,J=ee>>>3,re=(1<<V)-1,ie=F[J]>>>X;return V<8-X||(ie|=F[J+1]<<8-X,V<16-X)||(ie|=F[J+2]<<16-X,V<24-X)||(ie|=F[J+3]<<24-X),ie&re}function Ge(F,ee,V){var X=ee&7,J=ee>>>3;return X<=5?F[J]|=(V&7)<<X:(F[J]|=V<<X&255,F[J+1]=(V&7)>>8-X),ee+3}function Fe(F,ee,V){var X=ee&7,J=ee>>>3;return V=(V&1)<<X,F[J]|=V,ee+1}function Be(F,ee,V){var X=ee&7,J=ee>>>3;return V<<=X,F[J]|=V&255,V>>>=8,F[J+1]=V,ee+8}function xt(F,ee,V){var X=ee&7,J=ee>>>3;return V<<=X,F[J]|=V&255,V>>>=8,F[J+1]=V&255,F[J+2]=V>>>8,ee+16}function Ze(F,ee){var V=F.length,X=2*V>ee?2*V:ee+5,J=0;if(V>=ee)return F;if(Ut){var re=FA(X);if(F.copy)F.copy(re);else for(;J<F.length;++J)re[J]=F[J];return re}else if(G){var ie=new Uint8Array(X);if(ie.set)ie.set(F);else for(;J<V;++J)ie[J]=F[J];return ie}return F.length=X,F}function ht(F){for(var ee=new Array(F),V=0;V<F;++V)ee[V]=0;return ee}function At(F,ee,V){var X=1,J=0,re=0,ie=0,ve=0,ce=F.length,ye=G?new Uint16Array(32):ht(32);for(re=0;re<32;++re)ye[re]=0;for(re=ce;re<V;++re)F[re]=0;ce=F.length;var je=G?new Uint16Array(ce):ht(ce);for(re=0;re<ce;++re)ye[J=F[re]]++,X<J&&(X=J),je[re]=0;for(ye[0]=0,re=1;re<=X;++re)ye[re+16]=ve=ve+ye[re-1]<<1;for(re=0;re<ce;++re)ve=F[re],ve!=0&&(je[re]=ye[ve+16]++);var Pe=0;for(re=0;re<ce;++re)if(Pe=F[re],Pe!=0)for(ve=M(je[re],X)>>X-Pe,ie=(1<<X+4-Pe)-1;ie>=0;--ie)ee[ve|ie<<Pe]=Pe&15|re<<4;return X}var De=G?new Uint16Array(512):ht(512),Xe=G?new Uint16Array(32):ht(32);if(!G){for(var at=0;at<512;++at)De[at]=0;for(at=0;at<32;++at)Xe[at]=0}(function(){for(var F=[],ee=0;ee<32;ee++)F.push(5);At(F,Xe,32);var V=[];for(ee=0;ee<=143;ee++)V.push(8);for(;ee<=255;ee++)V.push(9);for(;ee<=279;ee++)V.push(7);for(;ee<=287;ee++)V.push(8);At(V,De,288)})();var rt=function(){for(var ee=G?new Uint8Array(32768):[],V=0,X=0;V<ne.length-1;++V)for(;X<ne[V+1];++X)ee[X]=V;for(;X<32768;++X)ee[X]=29;var J=G?new Uint8Array(259):[];for(V=0,X=0;V<L.length-1;++V)for(;X<L[V+1];++X)J[X]=V;function re(ve,ce){for(var ye=0;ye<ve.length;){var je=Math.min(65535,ve.length-ye),Pe=ye+je==ve.length;for(ce.write_shift(1,+Pe),ce.write_shift(2,je),ce.write_shift(2,~je&65535);je-- >0;)ce[ce.l++]=ve[ye++]}return ce.l}function ie(ve,ce){for(var ye=0,je=0,Pe=G?new Uint16Array(32768):[];je<ve.length;){var Ie=Math.min(65535,ve.length-je);if(Ie<10){for(ye=Ge(ce,ye,+(je+Ie==ve.length)),ye&7&&(ye+=8-(ye&7)),ce.l=ye/8|0,ce.write_shift(2,Ie),ce.write_shift(2,~Ie&65535);Ie-- >0;)ce[ce.l++]=ve[je++];ye=ce.l*8;continue}ye=Ge(ce,ye,+(je+Ie==ve.length)+2);for(var Ke=0;Ie-- >0;){var Ve=ve[je];Ke=(Ke<<5^Ve)&32767;var Je=-1,ft=0;if((Je=Pe[Ke])&&(Je|=je&-32768,Je>je&&(Je-=32768),Je<je))for(;ve[Je+ft]==ve[je+ft]&&ft<250;)++ft;if(ft>2){Ve=J[ft],Ve<=22?ye=Be(ce,ye,ue[Ve+1]>>1)-1:(Be(ce,ye,3),ye+=5,Be(ce,ye,ue[Ve-23]>>5),ye+=3);var Nt=Ve<8?0:Ve-4>>2;Nt>0&&(xt(ce,ye,ft-L[Ve]),ye+=Nt),Ve=ee[je-Je],ye=Be(ce,ye,ue[Ve]>>3),ye-=3;var jt=Ve<4?0:Ve-2>>1;jt>0&&(xt(ce,ye,je-Je-ne[Ve]),ye+=jt);for(var Rt=0;Rt<ft;++Rt)Pe[Ke]=je&32767,Ke=(Ke<<5^ve[je])&32767,++je;Ie-=ft-1}else Ve<=143?Ve=Ve+48:ye=Fe(ce,ye,1),ye=Be(ce,ye,ue[Ve]),Pe[Ke]=je&32767,++je}ye=Be(ce,ye,0)-1}return ce.l=(ye+7)/8|0,ce.l}return function(ce,ye){return ce.length<8?re(ce,ye):ie(ce,ye)}}();function de(F){var ee=en(50+Math.floor(F.length*1.1)),V=rt(F,ee);return ee.slice(0,V)}var Ce=G?new Uint16Array(32768):ht(32768),st=G?new Uint16Array(32768):ht(32768),nt=G?new Uint16Array(128):ht(128),gt=1,lr=1;function Zt(F,ee){var V=ze(F,ee)+257;ee+=5;var X=ze(F,ee)+1;ee+=5;var J=me(F,ee)+4;ee+=4;for(var re=0,ie=G?new Uint8Array(19):ht(19),ve=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ce=1,ye=G?new Uint8Array(8):ht(8),je=G?new Uint8Array(8):ht(8),Pe=ie.length,Ie=0;Ie<J;++Ie)ie[Q[Ie]]=re=xe(F,ee),ce<re&&(ce=re),ye[re]++,ee+=3;var Ke=0;for(ye[0]=0,Ie=1;Ie<=ce;++Ie)je[Ie]=Ke=Ke+ye[Ie-1]<<1;for(Ie=0;Ie<Pe;++Ie)(Ke=ie[Ie])!=0&&(ve[Ie]=je[Ke]++);var Ve=0;for(Ie=0;Ie<Pe;++Ie)if(Ve=ie[Ie],Ve!=0){Ke=ue[ve[Ie]]>>8-Ve;for(var Je=(1<<7-Ve)-1;Je>=0;--Je)nt[Ke|Je<<Ve]=Ve&7|Ie<<3}var ft=[];for(ce=1;ft.length<V+X;)switch(Ke=nt[oe(F,ee)],ee+=Ke&7,Ke>>>=3){case 16:for(re=3+Qe(F,ee),ee+=2,Ke=ft[ft.length-1];re-- >0;)ft.push(Ke);break;case 17:for(re=3+xe(F,ee),ee+=3;re-- >0;)ft.push(0);break;case 18:for(re=11+oe(F,ee),ee+=7;re-- >0;)ft.push(0);break;default:ft.push(Ke),ce<Ke&&(ce=Ke);break}var Nt=ft.slice(0,V),jt=ft.slice(V);for(Ie=V;Ie<286;++Ie)Nt[Ie]=0;for(Ie=X;Ie<30;++Ie)jt[Ie]=0;return gt=At(Nt,Ce,286),lr=At(jt,st,30),ee}function Ue(F,ee){if(F[0]==3&&!(F[1]&3))return[Tl(ee),2];for(var V=0,X=0,J=FA(ee||1<<18),re=0,ie=J.length>>>0,ve=0,ce=0;(X&1)==0;){if(X=xe(F,V),V+=3,X>>>1)X>>1==1?(ve=9,ce=5):(V=Zt(F,V),ve=gt,ce=lr);else{V&7&&(V+=8-(V&7));var ye=F[V>>>3]|F[(V>>>3)+1]<<8;if(V+=32,ye>0)for(!ee&&ie<re+ye&&(J=Ze(J,re+ye),ie=J.length);ye-- >0;)J[re++]=F[V>>>3],V+=8;continue}for(;;){!ee&&ie<re+32767&&(J=Ze(J,re+32767),ie=J.length);var je=ke(F,V,ve),Pe=X>>>1==1?De[je]:Ce[je];if(V+=Pe&15,Pe>>>=4,(Pe>>>8&255)===0)J[re++]=Pe;else{if(Pe==256)break;Pe-=257;var Ie=Pe<8?0:Pe-4>>2;Ie>5&&(Ie=0);var Ke=re+L[Pe];Ie>0&&(Ke+=ke(F,V,Ie),V+=Ie),je=ke(F,V,ce),Pe=X>>>1==1?Xe[je]:st[je],V+=Pe&15,Pe>>>=4;var Ve=Pe<4?0:Pe-2>>1,Je=ne[Pe];for(Ve>0&&(Je+=ke(F,V,Ve),V+=Ve),!ee&&ie<Ke&&(J=Ze(J,Ke+100),ie=J.length);re<Ke;)J[re]=J[re-Je],++re}}}return ee?[J,V+7>>>3]:[J.slice(0,re),V+7>>>3]}function et(F,ee){var V=F.slice(F.l||0),X=Ue(V,ee);return F.l+=X[1],X[0]}function ut(F,ee){if(F)typeof console<"u"&&console.error(ee);else throw new Error(ee)}function Bt(F,ee){var V=F;jn(V,0);var X=[],J=[],re={FileIndex:X,FullPaths:J};T(re,{root:ee.root});for(var ie=V.length-4;(V[ie]!=80||V[ie+1]!=75||V[ie+2]!=5||V[ie+3]!=6)&&ie>=0;)--ie;V.l=ie+4,V.l+=4;var ve=V.read_shift(2);V.l+=6;var ce=V.read_shift(4);for(V.l=ce,ie=0;ie<ve;++ie){V.l+=20;var ye=V.read_shift(4),je=V.read_shift(4),Pe=V.read_shift(2),Ie=V.read_shift(2),Ke=V.read_shift(2);V.l+=8;var Ve=V.read_shift(4),Je=u(V.slice(V.l+Pe,V.l+Pe+Ie));V.l+=Pe+Ie+Ke;var ft=V.l;V.l=Ve+4,er(V,ye,je,re,Je),V.l=ft}return re}function er(F,ee,V,X,J){F.l+=2;var re=F.read_shift(2),ie=F.read_shift(2),ve=o(F);if(re&8257)throw new Error("Unsupported ZIP encryption");for(var ce=F.read_shift(4),ye=F.read_shift(4),je=F.read_shift(4),Pe=F.read_shift(2),Ie=F.read_shift(2),Ke="",Ve=0;Ve<Pe;++Ve)Ke+=String.fromCharCode(F[F.l++]);if(Ie){var Je=u(F.slice(F.l,F.l+Ie));(Je[21589]||{}).mt&&(ve=Je[21589].mt),((J||{})[21589]||{}).mt&&(ve=J[21589].mt)}F.l+=Ie;var ft=F.slice(F.l,F.l+ye);switch(ie){case 8:ft=W(F,je);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ie)}var Nt=!1;re&8&&(ce=F.read_shift(4),ce==134695760&&(ce=F.read_shift(4),Nt=!0),ye=F.read_shift(4),je=F.read_shift(4)),ye!=ee&&ut(Nt,"Bad compressed size: "+ee+" != "+ye),je!=V&&ut(Nt,"Bad uncompressed size: "+V+" != "+je),kr(X,Ke,ft,{unsafe:!0,mt:ve})}function tr(F,ee){var V=ee||{},X=[],J=[],re=en(1),ie=V.compression?8:0,ve=0,ce=0,ye=0,je=0,Pe=0,Ie=F.FullPaths[0],Ke=Ie,Ve=F.FileIndex[0],Je=[],ft=0;for(ce=1;ce<F.FullPaths.length;++ce)if(Ke=F.FullPaths[ce].slice(Ie.length),Ve=F.FileIndex[ce],!(!Ve.size||!Ve.content||Ke=="Sh33tJ5")){var Nt=je,jt=en(Ke.length);for(ye=0;ye<Ke.length;++ye)jt.write_shift(1,Ke.charCodeAt(ye)&127);jt=jt.slice(0,jt.l),Je[Pe]=k9.buf(Ve.content,0);var Rt=Ve.content;ie==8&&(Rt=Y(Rt)),re=en(30),re.write_shift(4,67324752),re.write_shift(2,20),re.write_shift(2,ve),re.write_shift(2,ie),Ve.mt?i(re,Ve.mt):re.write_shift(4,0),re.write_shift(-4,Je[Pe]),re.write_shift(4,Rt.length),re.write_shift(4,Ve.content.length),re.write_shift(2,jt.length),re.write_shift(2,0),je+=re.length,X.push(re),je+=jt.length,X.push(jt),je+=Rt.length,X.push(Rt),re=en(46),re.write_shift(4,33639248),re.write_shift(2,0),re.write_shift(2,20),re.write_shift(2,ve),re.write_shift(2,ie),re.write_shift(4,0),re.write_shift(-4,Je[Pe]),re.write_shift(4,Rt.length),re.write_shift(4,Ve.content.length),re.write_shift(2,jt.length),re.write_shift(2,0),re.write_shift(2,0),re.write_shift(2,0),re.write_shift(2,0),re.write_shift(4,0),re.write_shift(4,Nt),ft+=re.l,J.push(re),ft+=jt.length,J.push(jt),++Pe}return re=en(22),re.write_shift(4,101010256),re.write_shift(2,0),re.write_shift(2,0),re.write_shift(2,Pe),re.write_shift(2,Pe),re.write_shift(4,ft),re.write_shift(4,je),re.write_shift(2,0),bl([bl(X),bl(J),re])}var Me={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ye(F,ee){if(F.ctype)return F.ctype;var V=F.name||"",X=V.match(/\.([^\.]+)$/);return X&&Me[X[1]]||ee&&(X=(V=ee).match(/[\.\\]([^\.\\])+$/),X&&Me[X[1]])?Me[X[1]]:"application/octet-stream"}function it(F){for(var ee=MA(F),V=[],X=0;X<ee.length;X+=76)V.push(ee.slice(X,X+76));return V.join(`\r
`)+`\r
`}function Ot(F){var ee=F.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ye){var je=ye.charCodeAt(0).toString(16).toUpperCase();return"="+(je.length==1?"0"+je:je)});ee=ee.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ee.charAt(0)==`
`&&(ee="=0D"+ee.slice(1)),ee=ee.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var V=[],X=ee.split(`\r
`),J=0;J<X.length;++J){var re=X[J];if(re.length==0){V.push("");continue}for(var ie=0;ie<re.length;){var ve=76,ce=re.slice(ie,ie+ve);ce.charAt(ve-1)=="="?ve--:ce.charAt(ve-2)=="="?ve-=2:ce.charAt(ve-3)=="="&&(ve-=3),ce=re.slice(ie,ie+ve),ie+=ve,ie<re.length&&(ce+="="),V.push(ce)}}return V.join(`\r
`)}function ha(F){for(var ee=[],V=0;V<F.length;++V){for(var X=F[V];V<=F.length&&X.charAt(X.length-1)=="=";)X=X.slice(0,X.length-1)+F[++V];ee.push(X)}for(var J=0;J<ee.length;++J)ee[J]=ee[J].replace(/[=][0-9A-Fa-f]{2}/g,function(re){return String.fromCharCode(parseInt(re.slice(1),16))});return ji(ee.join(`\r
`))}function zn(F,ee,V){for(var X="",J="",re="",ie,ve=0;ve<10;++ve){var ce=ee[ve];if(!ce||ce.match(/^\s*$/))break;var ye=ce.match(/^(.*?):\s*([^\s].*)$/);if(ye)switch(ye[1].toLowerCase()){case"content-location":X=ye[2].trim();break;case"content-type":re=ye[2].trim();break;case"content-transfer-encoding":J=ye[2].trim();break}}switch(++ve,J.toLowerCase()){case"base64":ie=ji(Ra(ee.slice(ve).join("")));break;case"quoted-printable":ie=ha(ee.slice(ve));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+J)}var je=kr(F,X.slice(V.length),ie,{unsafe:!0});re&&(je.ctype=re)}function Ri(F,ee){if(te(F.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var V=ee&&ee.root||"",X=(Ut&&Buffer.isBuffer(F)?F.toString("binary"):te(F)).split(`\r
`),J=0,re="";for(J=0;J<X.length;++J)if(re=X[J],!!/^Content-Location:/i.test(re)&&(re=re.slice(re.indexOf("file")),V||(V=re.slice(0,re.lastIndexOf("/")+1)),re.slice(0,V.length)!=V))for(;V.length>0&&(V=V.slice(0,V.length-1),V=V.slice(0,V.lastIndexOf("/")+1),re.slice(0,V.length)!=V););var ie=(X[1]||"").match(/boundary="(.*?)"/);if(!ie)throw new Error("MAD cannot find boundary");var ve="--"+(ie[1]||""),ce=[],ye=[],je={FileIndex:ce,FullPaths:ye};T(je);var Pe,Ie=0;for(J=0;J<X.length;++J){var Ke=X[J];Ke!==ve&&Ke!==ve+"--"||(Ie++&&zn(je,X.slice(Pe,J),V),Pe=J)}return je}function Qn(F,ee){var V=ee||{},X=V.boundary||"SheetJS";X="------="+X;for(var J=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+X.slice(2)+'"',"","",""],re=F.FullPaths[0],ie=re,ve=F.FileIndex[0],ce=1;ce<F.FullPaths.length;++ce)if(ie=F.FullPaths[ce].slice(re.length),ve=F.FileIndex[ce],!(!ve.size||!ve.content||ie=="Sh33tJ5")){ie=ie.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ft){return"_x"+ft.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ft){return"_u"+ft.charCodeAt(0).toString(16)+"_"});for(var ye=ve.content,je=Ut&&Buffer.isBuffer(ye)?ye.toString("binary"):te(ye),Pe=0,Ie=Math.min(1024,je.length),Ke=0,Ve=0;Ve<=Ie;++Ve)(Ke=je.charCodeAt(Ve))>=32&&Ke<128&&++Pe;var Je=Pe>=Ie*4/5;J.push(X),J.push("Content-Location: "+(V.root||"file:///C:/SheetJS/")+ie),J.push("Content-Transfer-Encoding: "+(Je?"quoted-printable":"base64")),J.push("Content-Type: "+Ye(ve,ie)),J.push(""),J.push(Je?Ot(je):it(je))}return J.push(X+`--\r
`),J.join(`\r
`)}function Tr(F){var ee={};return T(ee,F),ee}function kr(F,ee,V,X){var J=X&&X.unsafe;J||T(F);var re=!J&&Ht.find(F,ee);if(!re){var ie=F.FullPaths[0];ee.slice(0,ie.length)==ie?ie=ee:(ie.slice(-1)!="/"&&(ie+="/"),ie=(ie+ee).replace("//","/")),re={name:a(ee),type:2},F.FileIndex.push(re),F.FullPaths.push(ie),J||Ht.utils.cfb_gc(F)}return re.content=V,re.size=V?V.length:0,X&&(X.CLSID&&(re.clsid=X.CLSID),X.mt&&(re.mt=X.mt),X.ct&&(re.ct=X.ct)),re}function $a(F,ee){T(F);var V=Ht.find(F,ee);if(V){for(var X=0;X<F.FileIndex.length;++X)if(F.FileIndex[X]==V)return F.FileIndex.splice(X,1),F.FullPaths.splice(X,1),!0}return!1}function Mi(F,ee,V){T(F);var X=Ht.find(F,ee);if(X){for(var J=0;J<F.FileIndex.length;++J)if(F.FileIndex[J]==X)return F.FileIndex[J].name=a(V),F.FullPaths[J]=V,!0}return!1}function Ul(F){P(F,!0)}return t.find=q,t.read=O,t.parse=h,t.write=I,t.writeFile=be,t.utils={cfb_new:Tr,cfb_add:kr,cfb_del:$a,cfb_mov:Mi,cfb_gc:Ul,ReadShift:Cd,CheckField:HO,prep_blob:jn,bconcat:bl,use_zlib:R,_deflateRaw:de,_inflateRaw:et,consts:H},t}();function C9(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function kl(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Qb(e){for(var t=[],r=kl(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var Vh=new Date(1899,11,30,0,0,0);function Ma(e,t){var r=e.getTime(),n=Vh.getTime()+(e.getTimezoneOffset()-Vh.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var SO=new Date,O9=Vh.getTime()+(SO.getTimezoneOffset()-Vh.getTimezoneOffset())*6e4,qA=SO.getTimezoneOffset();function Qm(e){var t=new Date;return t.setTime(e*24*60*60*1e3+O9),t.getTimezoneOffset()!==qA&&t.setTime(t.getTime()+(t.getTimezoneOffset()-qA)*6e4),t}function D9(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[i],10)}return t}var VA=new Date("2017-02-19T19:06:09.000Z"),jO=isNaN(VA.getFullYear())?new Date("2/19/17"):VA,P9=jO.getFullYear()==2017;function Nn(e,t){var r=new Date(e);if(P9)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(jO.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Eo(e,t){if(Ut&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Ed(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Ed(cO(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Ed(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Ed(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function En(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=En(e[r]));return t}function Dr(e,t){for(var r="";r.length<t;)r+=e;return r}function _s(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var R9=["january","february","march","april","may","june","july","august","september","october","november","december"];function Wd(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&R9.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var M9=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var i=r.split(n),o=[i[0]],u=1;u<i.length;++u)o.push(a),o.push(i[u]);return o}}();function NO(e){return e?e.content&&e.type?Eo(e.content,!0):e.data?Sd(e.data):e.asNodeBuffer&&Ut?Sd(e.asNodeBuffer().toString("binary")):e.asBinary?Sd(e.asBinary()):e._data&&e._data.getContent?Sd(Eo(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function EO(e){if(!e)return null;if(e.data)return PA(e.data);if(e.asNodeBuffer&&Ut)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?PA(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function F9(e){return e&&e.name.slice(-4)===".bin"?EO(e):NO(e)}function ri(e,t){for(var r=e.FullPaths||kl(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var o=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||a==o)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function Jb(e,t){var r=ri(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function qr(e,t,r){if(!r)return F9(Jb(e,t));if(!t)return null;try{return qr(e,t)}catch{return null}}function Ca(e,t,r){if(!r)return NO(Jb(e,t));if(!t)return null;try{return Ca(e,t)}catch{return null}}function I9(e,t,r){return EO(Jb(e,t))}function KA(e){for(var t=e.FullPaths||kl(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function L9(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Ut?n=Oo(r):n=n9(r),Ht.utils.cfb_add(e,t,n)}Ht.utils.cfb_add(e,t,r)}else e.file(t,r)}function AO(e,t){switch(t.type){case"base64":return Ht.read(e,{type:"base64"});case"binary":return Ht.read(e,{type:"binary"});case"buffer":case"array":return Ht.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Nd(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var _O=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,B9=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,GA=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,U9=/<[^>]*>/g,Un=_O.match(GA)?GA:U9,$9=/<\w*:/,z9=/<(\/?)\w+:/;function St(e,t,r){for(var n={},a=0,i=0;a!==e.length&&!((i=e.charCodeAt(a))===32||i===10||i===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var o=e.match(B9),u=0,m="",f=0,h="",x="",v=1;if(o)for(f=0;f!=o.length;++f){for(x=o[f],i=0;i!=x.length&&x.charCodeAt(i)!==61;++i);for(h=x.slice(0,i).trim();x.charCodeAt(i+1)==32;)++i;for(v=(a=x.charCodeAt(i+1))==34||a==39?1:0,m=x.slice(i+1+v,x.length-v),u=0;u!=h.length&&h.charCodeAt(u)!==58;++u);if(u===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),n[h]=m,n[h.toLowerCase()]=m;else{var y=(u===5&&h.slice(0,5)==="xmlns"?"xmlns":"")+h.slice(u+1);if(n[y]&&h.slice(u-3,u)=="ext")continue;n[y]=m,n[y.toLowerCase()]=m}}return n}function ts(e){return e.replace(z9,"<$1")}var TO={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},H9=Qb(TO),Gt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(e,function(u,m){return TO[u]||String.fromCharCode(parseInt(m,u.indexOf("x")>-1?16:10))||u}).replace(t,function(u,m){return String.fromCharCode(parseInt(m,16))});var o=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,o)+r(a.slice(o+3))}}(),q9=/[&<>'"]/g,V9=/[\u0000-\u001f]/g;function kO(e){var t=e+"";return t.replace(q9,function(r){return H9[r]}).replace(/\n/g,"<br/>").replace(V9,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var WA=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function Sr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function hg(e){for(var t="",r=0,n=0,a=0,i=0,o=0,u=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=a&63,t+=String.fromCharCode(o);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}o=e.charCodeAt(r++),u=((n&7)<<18|(a&63)<<12|(i&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(u>>>10&1023)),t+=String.fromCharCode(56320+(u&1023))}return t}function XA(e){var t=Tl(2*e.length),r,n,a=1,i=0,o=0,u;for(n=0;n<e.length;n+=a)a=1,(u=e.charCodeAt(n))<128?r=u:u<224?(r=(u&31)*64+(e.charCodeAt(n+1)&63),a=2):u<240?(r=(u&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(u&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[i++]=o&255,t[i++]=o>>>8,o=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function YA(e){return Oo(e,"binary").toString("utf8")}var rh="foo bar baz",vr=Ut&&(YA(rh)==hg(rh)&&YA||XA(rh)==hg(rh)&&XA)||hg,Ed=Ut?function(e){return Oo(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Xd=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),K9=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),G9=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),W9=/<\/?(?:vt:)?variant>/g,X9=/<(?:vt:)([^>]*)>([\s\S]*)</;function ZA(e,t){var r=St(e),n=e.match(G9(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(i){var o=i.replace(W9,"").match(X9);o&&a.push({v:vr(o[2]),t:o[1]})}),a}function e2(e){if(Ut&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return vr(Do(Xb(e)));throw new Error("Bad input format: expected Buffer or string")}var Yd=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Y9={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},Z9=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function Q9(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function J9(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,o=n?-t:t;isFinite(o)?o==0?a=i=0:(a=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var u=0;u<=5;++u,i/=256)e[r+u]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var QA=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},JA=Ut?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Oo(t)})):QA(e)}:QA,e_=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(Ss(e,a)));return n.join("").replace(Yn,"")},t2=Ut?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Yn,""):e_(e,t,r)}:e_,t_=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},CO=Ut?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):t_(e,t,r)}:t_,r_=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Tc(e,a)));return n.join("")},gf=Ut?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):r_(t,r,n)}:r_,OO=function(e,t){var r=Ta(e,t);return r>0?gf(e,t+4,t+4+r-1):""},DO=OO,PO=function(e,t){var r=Ta(e,t);return r>0?gf(e,t+4,t+4+r-1):""},RO=PO,MO=function(e,t){var r=2*Ta(e,t);return r>0?gf(e,t+4,t+4+r-1):""},FO=MO,IO=function(t,r){var n=Ta(t,r);return n>0?t2(t,r+4,r+4+n):""},LO=IO,BO=function(e,t){var r=Ta(e,t);return r>0?gf(e,t+4,t+4+r):""},UO=BO,$O=function(e,t){return Q9(e,t)},Kh=$O,zO=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ut&&(DO=function(t,r){if(!Buffer.isBuffer(t))return OO(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},RO=function(t,r){if(!Buffer.isBuffer(t))return PO(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},FO=function(t,r){if(!Buffer.isBuffer(t))return MO(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},LO=function(t,r){if(!Buffer.isBuffer(t))return IO(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},UO=function(t,r){if(!Buffer.isBuffer(t))return BO(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Kh=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):$O(t,r)},zO=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Tc=function(e,t){return e[t]},Ss=function(e,t){return e[t+1]*256+e[t]},eU=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Ta=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},so=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},tU=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Cd(e,t){var r="",n,a,i=[],o,u,m,f;switch(t){case"dbcs":if(f=this.l,Ut&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(m=0;m<e;++m)r+=String.fromCharCode(Ss(this,f)),f+=2;e*=2;break;case"utf8":r=gf(this,this.l,this.l+e);break;case"utf16le":e*=2,r=t2(this,this.l,this.l+e);break;case"wstr":return Cd.call(this,e,"dbcs");case"lpstr-ansi":r=DO(this,this.l),e=4+Ta(this,this.l);break;case"lpstr-cp":r=RO(this,this.l),e=4+Ta(this,this.l);break;case"lpwstr":r=FO(this,this.l),e=4+2*Ta(this,this.l);break;case"lpp4":e=4+Ta(this,this.l),r=LO(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Ta(this,this.l),r=UO(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Tc(this,this.l+e++))!==0;)i.push(th(o));r=i.join("");break;case"_wstr":for(e=0,r="";(o=Ss(this,this.l+e))!==0;)i.push(th(o)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",f=this.l,m=0;m<e;++m){if(this.lens&&this.lens.indexOf(f)!==-1)return o=Tc(this,f),this.l=f+1,u=Cd.call(this,e-m,o?"dbcs-cont":"sbcs-cont"),i.join("")+u;i.push(th(Ss(this,f))),f+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",f=this.l,m=0;m!=e;++m){if(this.lens&&this.lens.indexOf(f)!==-1)return o=Tc(this,f),this.l=f+1,u=Cd.call(this,e-m,o?"dbcs-cont":"sbcs-cont"),i.join("")+u;i.push(th(Tc(this,f))),f+=1}r=i.join("");break;default:switch(e){case 1:return n=Tc(this,this.l),this.l++,n;case 2:return n=(t==="i"?eU:Ss)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?so:tU)(this,this.l),this.l+=4,n):(a=Ta(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=Kh(this,this.l):a=Kh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=CO(this,this.l,e);break}}return this.l+=e,r}var rU=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},nU=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},aU=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function iU(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)aU(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var o=t.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,rU(this,t,this.l);break;case 8:if(n=8,r==="f"){J9(this,t,this.l);break}case 16:break;case-4:n=4,nU(this,t,this.l);break}return this.l+=n,this}function HO(e,t){var r=CO(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function jn(e,t){e.l=t,e.read_shift=Cd,e.chk=HO,e.write_shift=iU}function Bn(e,t){e.l+=t}function en(e){var t=Tl(e);return jn(t,0),t}function Is(e,t,r){if(e){var n,a,i;jn(e,e.l||0);for(var o=e.length,u=0,m=0;e.l<o;){u=e.read_shift(1),u&128&&(u=(u&127)+((e.read_shift(1)&127)<<7));var f=Qh[u]||Qh[65535];for(n=e.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=e.read_shift(1))&127)<<7*a;m=e.l+i;var h=f.f&&f.f(e,i,r);if(e.l=m,t(h,f,u))return}}}function jy(){var e=[],t=Ut?256:2048,r=function(f){var h=en(f);return jn(h,0),h},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(f){return n&&f<n.length-n.l?n:(a(),n=r(Math.max(f+1,t)))},o=function(){return a(),bl(e)},u=function(f){a(),n=f,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:u,end:o,_bufs:e}}function Od(e,t,r){var n=En(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function n_(e,t,r){var n=En(e);return n.s=Od(n.s,t.s,r),n.e=Od(n.e,t.s,r),n}function Dd(e,t){if(e.cRel&&e.c<0)for(e=En(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=En(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ft(e);return!e.cRel&&e.cRel!=null&&(r=oU(r)),!e.rRel&&e.rRel!=null&&(r=sU(r)),r}function mg(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Wn(e.s.c)+":"+(e.e.cRel?"":"$")+Wn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Da(e.s.r)+":"+(e.e.rRel?"":"$")+Da(e.e.r):Dd(e.s,t.biff)+":"+Dd(e.e,t.biff)}function qO(e){return parseInt(lU(e),10)-1}function Da(e){return""+(e+1)}function sU(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function lU(e){return e.replace(/\$(\d+)$/,"$1")}function VO(e){for(var t=cU(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Wn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function oU(e){return e.replace(/^([A-Z])/,"$$$1")}function cU(e){return e.replace(/^\$([A-Z])/,"$1")}function Ti(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Ft(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function r2(e){var t=e.indexOf(":");return t==-1?{s:Ti(e),e:Ti(e)}:{s:Ti(e.slice(0,t)),e:Ti(e.slice(t+1))}}function sr(e,t){return typeof t>"u"||typeof t=="number"?sr(e.s,e.e):(typeof e!="string"&&(e=Ft(e)),typeof t!="string"&&(t=Ft(t)),e==t?e:e+":"+t)}function pn(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function a_(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=oi(e.z,r?Ma(t):t)}catch{}try{return e.w=oi((e.XF||{}).numFmtId||(r?14:0),r?Ma(t):t)}catch{return""+t}}function Lc(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Fo[e.v]||e.v:t==null?a_(e,e.v):a_(e,t))}function Po(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function uU(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),o=0,u=0;if(i&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var m=typeof n.origin=="string"?Ti(n.origin):n.origin;o=m.r,u=m.c}i["!ref"]||(i["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var h=pn(i["!ref"]);f.s.c=h.s.c,f.s.r=h.s.r,f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),o==-1&&(f.e.r=o=h.e.r+1)}for(var x=0;x!=t.length;++x)if(t[x]){if(!Array.isArray(t[x]))throw new Error("aoa_to_sheet expects an array of arrays");for(var v=0;v!=t[x].length;++v)if(!(typeof t[x][v]>"u")){var y={v:t[x][v]},w=o+x,b=u+v;if(f.s.r>w&&(f.s.r=w),f.s.c>b&&(f.s.c=b),f.e.r<w&&(f.e.r=w),f.e.c<b&&(f.e.c=b),t[x][v]&&typeof t[x][v]=="object"&&!Array.isArray(t[x][v])&&!(t[x][v]instanceof Date))y=t[x][v];else if(Array.isArray(y.v)&&(y.f=t[x][v][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(n.nullError)y.t="e",y.v=0;else if(n.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=n.dateNF||Tt[14],n.cellDates?(y.t="d",y.w=oi(y.z,Ma(y.v))):(y.t="n",y.v=Ma(y.v),y.w=oi(y.z,y.v))):y.t="s";if(a)i[w]||(i[w]=[]),i[w][b]&&i[w][b].z&&(y.z=i[w][b].z),i[w][b]=y;else{var S=Ft({c:b,r:w});i[S]&&i[S].z&&(y.z=i[S].z),i[S]=y}}}return f.s.c<1e7&&(i["!ref"]=sr(f)),i}function yf(e,t){return uU(null,e,t)}function dU(e){return e.read_shift(4,"i")}function Ln(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function fU(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function n2(e,t){var r=e.l,n=e.read_shift(1),a=Ln(e),i=[],o={t:a,h:a};if((n&1)!==0){for(var u=e.read_shift(4),m=0;m!=u;++m)i.push(fU(e));o.r=i}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}var hU=n2;function mi(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Ro(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var mU=Ln;function a2(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var pU=Ln,Ny=a2;function i2(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?Kh([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):so(t,0)>>2;return r?a/100:a}function KO(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Mo=KO;function Fn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function xU(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),o=e.read_shift(1),u=e.read_shift(1),m=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var f=go[a];f&&(t.rgb=Qd(f));break;case 2:t.rgb=Qd([o,u,m]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function vU(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function GO(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function gU(e){return GO(e,1)}function yU(e){return GO(e,2)}var s2=2,na=3,nh=11,i_=12,Gh=19,ah=64,bU=65,wU=71,SU=4108,jU=4126,fn=80,WO=81,NU=[fn,WO],EU={1:{n:"CodePage",t:s2},2:{n:"Category",t:fn},3:{n:"PresentationFormat",t:fn},4:{n:"ByteCount",t:na},5:{n:"LineCount",t:na},6:{n:"ParagraphCount",t:na},7:{n:"SlideCount",t:na},8:{n:"NoteCount",t:na},9:{n:"HiddenCount",t:na},10:{n:"MultimediaClipCount",t:na},11:{n:"ScaleCrop",t:nh},12:{n:"HeadingPairs",t:SU},13:{n:"TitlesOfParts",t:jU},14:{n:"Manager",t:fn},15:{n:"Company",t:fn},16:{n:"LinksUpToDate",t:nh},17:{n:"CharacterCount",t:na},19:{n:"SharedDoc",t:nh},22:{n:"HyperlinksChanged",t:nh},23:{n:"AppVersion",t:na,p:"version"},24:{n:"DigSig",t:bU},26:{n:"ContentType",t:fn},27:{n:"ContentStatus",t:fn},28:{n:"Language",t:fn},29:{n:"Version",t:fn},255:{},2147483648:{n:"Locale",t:Gh},2147483651:{n:"Behavior",t:Gh},1919054434:{}},AU={1:{n:"CodePage",t:s2},2:{n:"Title",t:fn},3:{n:"Subject",t:fn},4:{n:"Author",t:fn},5:{n:"Keywords",t:fn},6:{n:"Comments",t:fn},7:{n:"Template",t:fn},8:{n:"LastAuthor",t:fn},9:{n:"RevNumber",t:fn},10:{n:"EditTime",t:ah},11:{n:"LastPrinted",t:ah},12:{n:"CreatedDate",t:ah},13:{n:"ModifiedDate",t:ah},14:{n:"PageCount",t:na},15:{n:"WordCount",t:na},16:{n:"CharCount",t:na},17:{n:"Thumbnail",t:wU},18:{n:"Application",t:fn},19:{n:"DocSecurity",t:na},255:{},2147483648:{n:"Locale",t:Gh},2147483651:{n:"Behavior",t:Gh},1919054434:{}},s_={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},_U=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function TU(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var kU=TU([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),go=En(kU),Fo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},XO={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},l_={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function CU(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function OU(e){var t=CU();if(!e||!e.match)return t;var r={};if((e.match(Un)||[]).forEach(function(n){var a=St(n);switch(a[0].replace($9,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[l_[a.ContentType]]!==void 0&&t[l_[a.ContentType]].push(a.PartName);break}}),t.xmlns!==Y9.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var kc={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Ey(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Pd(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Un)||[]).forEach(function(a){var i=St(a);if(i[0]==="<Relationship"){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var u=i.TargetMode==="External"?i.Target:Nd(i.Target,t);r[u]=o,n[i.Id]=o}}),r["!id"]=n,r}var DU="application/vnd.oasis.opendocument.spreadsheet";function PU(e,t){for(var r=e2(e),n,a;n=Yd.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=St(n[0],!1),a.path=="/"&&a.type!==DU)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var Rd=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],RU=function(){for(var e=new Array(Rd.length),t=0;t<Rd.length;++t){var r=Rd[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function YO(e){var t={};e=vr(e);for(var r=0;r<Rd.length;++r){var n=Rd[r],a=e.match(RU[r]);a!=null&&a.length>0&&(t[n[1]]=Gt(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Nn(t[n[1]]))}return t}var MU=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function ZO(e,t,r,n){var a=[];if(typeof e=="string")a=ZA(e,n);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map(function(h){return{v:h}}));var o=typeof t=="string"?ZA(t,n).map(function(h){return h.v}):t,u=0,m=0;if(o.length>0)for(var f=0;f!==a.length;f+=2){switch(m=+a[f+1].v,a[f].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=m,r.SheetNames=o.slice(u,u+m);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=m,r.DefinedNames=o.slice(u,u+m);break;case"Charts":case"Diagramme":r.Chartsheets=m,r.ChartNames=o.slice(u,u+m);break}u+=m}}function FU(e,t,r){var n={};return t||(t={}),e=vr(e),MU.forEach(function(a){var i=(e.match(Xd(a[0]))||[])[1];switch(a[2]){case"string":i&&(t[a[1]]=Gt(i));break;case"bool":t[a[1]]=i==="true";break;case"raw":var o=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));o&&o.length>0&&(n[a[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&ZO(n.HeadingPairs,n.TitlesOfParts,t,r),t}var IU=/<[^>]+>[^<]*/g;function LU(e,t){var r={},n="",a=e.match(IU);if(a)for(var i=0;i!=a.length;++i){var o=a[i],u=St(o);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Gt(u.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var m=o.split(">"),f=m[0].slice(4),h=m[1];switch(f){case"lpstr":case"bstr":case"lpwstr":r[n]=Gt(h);break;case"bool":r[n]=Sr(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(h,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(h);break;case"filetime":case"date":r[n]=Nn(h);break;case"cy":case"error":r[n]=Gt(h);break;default:if(f.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,f,m)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}var BU={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},pg;function UU(e,t,r){pg||(pg=Qb(BU)),t=pg[t]||t,e[t]=r}function l2(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function QO(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function JO(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function e5(e,t,r){return t===31?JO(e):QO(e,t,r)}function Ay(e,t,r){return e5(e,t,r===!1?0:4)}function $U(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return e5(e,t,0)}function zU(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Yn,""),e.l-a&2&&(e.l+=2)}return r}function HU(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Yn,"");return r}function qU(e){var t=e.l,r=Wh(e,WO);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Wh(e,na);return[r,n]}function VU(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(qU(e));return r}function o_(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var i=e.read_shift(4),o=e.read_shift(4);n[i]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(Yn,"").replace(jd,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function t5(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function KU(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Wh(e,t,r){var n=e.read_shift(2),a,i=r||{};if(e.l+=2,t!==i_&&n!==t&&NU.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===i_?n:t){case 2:return a=e.read_shift(2,"i"),i.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return QO(e,n,4).replace(Yn,"");case 31:return JO(e);case 64:return l2(e);case 65:return t5(e);case 71:return KU(e);case 80:return Ay(e,n,!i.raw).replace(Yn,"");case 81:return $U(e,n).replace(Yn,"");case 4108:return VU(e);case 4126:case 4127:return n==4127?zU(e):HU(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function c_(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),i=[],o=0,u=0,m=-1,f={};for(o=0;o!=a;++o){var h=e.read_shift(4),x=e.read_shift(4);i[o]=[h,x+r]}i.sort(function(_,A){return _[1]-A[1]});var v={};for(o=0;o!=a;++o){if(e.l!==i[o][1]){var y=!0;if(o>0&&t)switch(t[i[o-1][0]].t){case 2:e.l+2===i[o][1]&&(e.l+=2,y=!1);break;case 80:e.l<=i[o][1]&&(e.l=i[o][1],y=!1);break;case 4108:e.l<=i[o][1]&&(e.l=i[o][1],y=!1);break}if((!t||o==0)&&e.l<=i[o][1]&&(y=!1,e.l=i[o][1]),y)throw new Error("Read Error: Expected address "+i[o][1]+" at "+e.l+" :"+o)}if(t){var w=t[i[o][0]];if(v[w.n]=Wh(e,w.t,{raw:!0}),w.p==="version"&&(v[w.n]=String(v[w.n]>>16)+"."+("0000"+String(v[w.n]&65535)).slice(-4)),w.n=="CodePage")switch(v[w.n]){case 0:v[w.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ai(u=v[w.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+v[w.n])}}else if(i[o][0]===1){if(u=v.CodePage=Wh(e,s2),Ai(u),m!==-1){var b=e.l;e.l=i[m][1],f=o_(e,u),e.l=b}}else if(i[o][0]===0){if(u===0){m=o,e.l=i[o+1][1];continue}f=o_(e,u)}else{var S=f[i[o][0]],N;switch(e[e.l]){case 65:e.l+=4,N=t5(e);break;case 30:e.l+=4,N=Ay(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,N=Ay(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,N=e.read_shift(4,"i");break;case 19:e.l+=4,N=e.read_shift(4);break;case 5:e.l+=4,N=e.read_shift(8,"f");break;case 11:e.l+=4,N=Lr(e,4);break;case 64:e.l+=4,N=Nn(l2(e));break;default:throw new Error("unparsed value: "+e[e.l])}v[S]=N}}return e.l=r+n,v}function u_(e,t,r){var n=e.content;if(!n)return{};jn(n,0);var a,i,o,u,m=0;n.chk("feff","Byte Order: "),n.read_shift(2);var f=n.read_shift(4),h=n.read_shift(16);if(h!==Ht.utils.consts.HEADER_CLSID&&h!==r)throw new Error("Bad PropertySet CLSID "+h);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),u=n.read_shift(4),a===1&&u!==n.l)throw new Error("Length mismatch: "+u+" !== "+n.l);a===2&&(o=n.read_shift(16),m=n.read_shift(4));var x=c_(n,t),v={SystemIdentifier:f};for(var y in x)v[y]=x[y];if(v.FMTID=i,a===1)return v;if(m-n.l==2&&(n.l+=2),n.l!==m)throw new Error("Length mismatch 2: "+n.l+" !== "+m);var w;try{w=c_(n,null)}catch{}for(y in w)v[y]=w[y];return v.FMTID=[i,o],v}function ml(e,t){return e.read_shift(t),null}function GU(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function Lr(e,t){return e.read_shift(t)===1}function Vr(e){return e.read_shift(2,"u")}function r5(e,t){return GU(e,t,Vr)}function WU(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function bf(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var o=n?e.read_shift(n,a):"";return o}function XU(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,i=1+(r&1),o=0,u,m={};a&&(o=e.read_shift(2)),n&&(u=e.read_shift(4));var f=i==2?"dbcs-cont":"sbcs-cont",h=t===0?"":e.read_shift(t,f);return a&&(e.l+=4*o),n&&(e.l+=u),m.t=h,a||(m.raw="<t>"+m.t+"</t>",m.r=m.t),m}function Ao(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function wf(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Ao(e,n,r)}function Io(e,t,r){if(r.biff>5)return wf(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function YU(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function ZU(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Yn,"");return n&&(e.l+=24),a}function QU(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(i>>1,"utf16le").replace(Yn,"");return r+o}function JU(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return ZU(e);case"0303000000000000c000000000000046":return QU(e);default:throw new Error("Unsupported Moniker "+r)}}function ih(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Yn,""):"";return r}function e$(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var i,o,u,m,f="",h,x;a&16&&(i=ih(e,r-e.l)),a&128&&(o=ih(e,r-e.l)),(a&257)===257&&(u=ih(e,r-e.l)),(a&257)===1&&(m=JU(e,r-e.l)),a&8&&(f=ih(e,r-e.l)),a&32&&(h=e.read_shift(16)),a&64&&(x=l2(e)),e.l=r;var v=o||u||m||"";v&&f&&(v+="#"+f),v||(v="#"+f),a&2&&v.charAt(0)=="/"&&v.charAt(1)!="/"&&(v="file://"+v);var y={Target:v};return h&&(y.guid=h),x&&(y.time=x),i&&(y.Tooltip=i),y}function n5(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function a5(e,t){var r=n5(e);return r[3]=0,r}function rs(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function t$(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function r$(e,t,r){return t===0?"":Io(e,t,r)}function n$(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[a,i,o]}function i5(e){var t=e.read_shift(2),r=i2(e);return[t,r]}function a$(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=bf(e,t,r),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,a}function Jm(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function s5(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var i$=s5;function l5(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function s$(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function l$(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function kn(e){e.l+=2,e.l+=e.read_shift(2)}var o$={0:kn,4:kn,5:kn,6:kn,7:l$,8:kn,9:kn,10:kn,11:kn,12:kn,13:s$,14:kn,15:kn,16:kn,17:kn,18:kn,19:kn,20:kn,21:l5};function c$(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(o$[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function sh(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function u$(e,t){return t===0||e.read_shift(2),1200}function d$(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=Io(e,0,r);return e.read_shift(t+n-e.l),a}function f$(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function h$(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var o=bf(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:a,dt:i,name:o}}function m$(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),i=[],o=0;o!=a&&e.l<r;++o)i.push(XU(e));return i.Count=n,i.Unique=a,i}function p$(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function x$(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function v$(e){var t=t$(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function g$(e){return e.read_shift(2),e.read_shift(4)}function d_(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function y$(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),u=e.read_shift(2),m=e.read_shift(2),f=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:i,CurTab:o,FirstTab:u,Selected:m,TabRatio:f}}function b$(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function w$(){}function S$(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=bf(e,0,r),n}function j$(e){var t=rs(e);return t.isst=e.read_shift(4),t}function N$(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=rs(e);r.biff==2&&e.l++;var i=wf(e,n-e.l,r);return a.val=i,a}function E$(e,t,r){var n=e.read_shift(2),a=Io(e,0,r);return[n,a]}var A$=Io;function f_(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,i=e.read_shift(a),o=e.read_shift(a),u=e.read_shift(2),m=e.read_shift(2);return e.l=n,{s:{r:i,c:u},e:{r:o,c:m}}}function _$(e){var t=e.read_shift(2),r=e.read_shift(2),n=i5(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function T$(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(i5(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(i.length!=o-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:o,rkrec:i}}function k$(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(i.length!=o-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:o,ixfe:i}}function C$(e,t,r,n){var a={},i=e.read_shift(4),o=e.read_shift(4),u=e.read_shift(4),m=e.read_shift(2);return a.patternType=_U[u>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=o&15,a.dgRight=o>>4&15,a.dgTop=o>>8&15,a.dgBottom=o>>12&15,a.icvLeft=o>>16&127,a.icvRight=o>>23&127,a.grbitDiag=o>>30&3,a.icvTop=u&127,a.icvBottom=u>>7&127,a.icvDiag=u>>14&127,a.dgDiag=u>>21&15,a.icvFore=m&127,a.icvBack=m>>7&127,a.fsxButton=m>>14&1),a}function O$(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=C$(e,t,n.fStyle,r),n}function D$(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function h_(e,t,r){var n=rs(e);(r.biff==2||t==9)&&++e.l;var a=WU(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function P$(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=rs(e),a=Fn(e);return n.val=a,n}var m_=r$;function R$(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=Ao(e,i),u=[];n>e.l;)u.push(wf(e));return[i,a,o,u]}function p_(e,t,r){var n=e.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=a$(e,t-2,r)),i.body=a||e.read_shift(t-2),typeof a=="string"&&(i.Name=a),i}var M$=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function x_(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(1),o=e.read_shift(1),u=e.read_shift(r&&r.biff==2?1:2),m=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),m=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var f=Ao(e,o,r);a&32&&(f=M$[f.charCodeAt(0)]);var h=n-e.l;r&&r.biff==2&&--h;var x=n==e.l||u===0||!(h>0)?[]:xV(e,h,r,u);return{chKey:i,Name:f,itab:m,rgce:x}}function o5(e,t,r){if(r.biff<8)return F$(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(n$(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function F$(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=bf(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function I$(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),i=Ao(e,n,r),o=Ao(e,a,r);return[i,o]}function L$(e,t,r){var n=s5(e);e.l++;var a=e.read_shift(1);return t-=8,[vV(e,t,r),a,n]}function v_(e,t,r){var n=i$(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,mV(e,t,r)]}function B$(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function U$(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),u=Io(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},u,o,i]}}function $$(e,t,r){return U$(e,t,r)}function z$(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Jm(e));return r}function H$(e,t,r){if(r&&r.biff<8)return V$(e,t,r);var n=l5(e),a=c$(e,t-22,n[1]);return{cmo:n,ft:a}}var q$={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function V$(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((q$[n]||Bn)(e,t,r)),{cmo:[a,n,i],ft:o}}function K$(e,t,r){var n=e.l,a="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:o=YU(e,6,r);var u=e.read_shift(2);e.read_shift(2),Vr(e,2);var m=e.read_shift(2);e.l+=m;for(var f=1;f<e.lens.length-1;++f){if(e.l-n!=e.lens[f])throw new Error("TxO: bad continue record");var h=e[e.l],x=Ao(e,e.lens[f+1]-e.lens[f]-1);if(a+=x,a.length>=(h?u:2*u))break}if(a.length!==u&&a.length!==u*2)throw new Error("cchText: "+u+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function G$(e,t){var r=Jm(e);e.l+=16;var n=e$(e,t-24);return[r,n]}function W$(e,t){e.read_shift(2);var r=Jm(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Yn,""),[r,n]}function X$(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=s_[r]||r,r=e.read_shift(2),t[1]=s_[r]||r,t}function Y$(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(a5(e));return r}function Z$(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(a5(e));return r}function Q$(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function c5(e,t,r){if(!r.cellStyles)return Bn(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),u=e.read_shift(n),m=e.read_shift(2);n==2&&(e.l+=2);var f={s:a,e:i,w:o,ixfe:u,flags:m};return(r.biff>=5||!r.biff)&&(f.level=m>>8&7),f}function J$(e,t){var r={};return t<32||(e.l+=16,r.header=Fn(e),r.footer=Fn(e),e.l+=2),r}function ez(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}var tz=rs,rz=r5,nz=wf;function az(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function iz(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=rs(e);++e.l;var a=Io(e,t-7,r);return n.t="str",n.val=a,n}function sz(e){var t=rs(e);++e.l;var r=Fn(e);return t.t="n",t.val=r,t}function lz(e){var t=rs(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function oz(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function cz(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function uz(e,t,r){var n=e.l+t,a=rs(e),i=e.read_shift(2),o=Ao(e,i,r);return e.l=n,a.t="str",a.val=o,a}var dz=[2,3,48,49,131,139,140,245],g_=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Qb({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,m){var f=[],h=Tl(1);switch(m.type){case"base64":h=ji(Ra(u));break;case"binary":h=ji(u);break;case"buffer":case"array":h=u;break}jn(h,0);var x=h.read_shift(1),v=!!(x&136),y=!1,w=!1;switch(x){case 2:break;case 3:break;case 48:y=!0,v=!0;break;case 49:y=!0,v=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+x.toString(16))}var b=0,S=521;x==2&&(b=h.read_shift(2)),h.l+=3,x!=2&&(b=h.read_shift(4)),b>1048576&&(b=1e6),x!=2&&(S=h.read_shift(2));var N=h.read_shift(2),_=m.codepage||1252;x!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(_=e[h[h.l]]),h.l+=1,h.l+=2),w&&(h.l+=36);for(var A=[],k={},C=Math.min(h.length,x==2?521:S-10-(y?264:0)),O=w?32:11;h.l<C&&h[h.l]!=13;)switch(k={},k.name=Kd.utils.decode(_,h.slice(h.l,h.l+O)).replace(/[\u0000\r\n].*$/g,""),h.l+=O,k.type=String.fromCharCode(h.read_shift(1)),x!=2&&!w&&(k.offset=h.read_shift(4)),k.len=h.read_shift(1),x==2&&(k.offset=h.read_shift(2)),k.dec=h.read_shift(1),k.name.length&&A.push(k),x!=2&&(h.l+=w?13:14),k.type){case"B":(!y||k.len!=8)&&m.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"G":case"P":m.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+k.type)}if(h[h.l]!==13&&(h.l=S-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=S;var T=0,z=0;for(f[0]=[],z=0;z!=A.length;++z)f[0][z]=A[z].name;for(;b-- >0;){if(h[h.l]===42){h.l+=N;continue}for(++h.l,f[++T]=[],z=0,z=0;z!=A.length;++z){var P=h.slice(h.l,h.l+A[z].len);h.l+=A[z].len,jn(P,0);var Z=Kd.utils.decode(_,P);switch(A[z].type){case"C":Z.trim().length&&(f[T][z]=Z.replace(/\s+$/,""));break;case"D":Z.length===8?f[T][z]=new Date(+Z.slice(0,4),+Z.slice(4,6)-1,+Z.slice(6,8)):f[T][z]=Z;break;case"F":f[T][z]=parseFloat(Z.trim());break;case"+":case"I":f[T][z]=w?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(Z.trim().toUpperCase()){case"Y":case"T":f[T][z]=!0;break;case"N":case"F":f[T][z]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+Z+"|")}break;case"M":if(!v)throw new Error("DBF Unexpected MEMO for type "+x.toString(16));f[T][z]="##MEMO##"+(w?parseInt(Z.trim(),10):P.read_shift(4));break;case"N":Z=Z.replace(/\u0000/g,"").trim(),Z&&Z!="."&&(f[T][z]=+Z||0);break;case"@":f[T][z]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":f[T][z]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":f[T][z]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[T][z]=-P.read_shift(-8,"f");break;case"B":if(y&&A[z].len==8){f[T][z]=P.read_shift(8,"f");break}case"G":case"P":P.l+=A[z].len;break;case"0":if(A[z].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+A[z].type)}}}if(x!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return m&&m.sheetRows&&(f=f.slice(0,m.sheetRows)),m.DBF=A,f}function n(u,m){var f=m||{};f.dateNF||(f.dateNF="yyyymmdd");var h=yf(r(u,f),f);return h["!cols"]=f.DBF.map(function(x){return{wch:x.len,DBF:x}}),delete f.DBF,h}function a(u,m){try{return Po(n(u,m),m)}catch(f){if(m&&m.WTF)throw f}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(u,m){var f=m||{};if(+f.codepage>=0&&Ai(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var h=jy(),x=FG(u,{header:1,raw:!0,cellDates:!0}),v=x[0],y=x.slice(1),w=u["!cols"]||[],b=0,S=0,N=0,_=1;for(b=0;b<v.length;++b){if(((w[b]||{}).DBF||{}).name){v[b]=w[b].DBF.name,++N;continue}if(v[b]!=null){if(++N,typeof v[b]=="number"&&(v[b]=v[b].toString(10)),typeof v[b]!="string")throw new Error("DBF Invalid column name "+v[b]+" |"+typeof v[b]+"|");if(v.indexOf(v[b])!==b){for(S=0;S<1024;++S)if(v.indexOf(v[b]+"_"+S)==-1){v[b]+="_"+S;break}}}}var A=pn(u["!ref"]),k=[],C=[],O=[];for(b=0;b<=A.e.c-A.s.c;++b){var T="",z="",P=0,Z=[];for(S=0;S<y.length;++S)y[S][b]!=null&&Z.push(y[S][b]);if(Z.length==0||v[b]==null){k[b]="?";continue}for(S=0;S<Z.length;++S){switch(typeof Z[S]){case"number":z="B";break;case"string":z="C";break;case"boolean":z="L";break;case"object":z=Z[S]instanceof Date?"D":"C";break;default:z="C"}P=Math.max(P,String(Z[S]).length),T=T&&T!=z?"C":z}P>250&&(P=250),z=((w[b]||{}).DBF||{}).type,z=="C"&&w[b].DBF.len>P&&(P=w[b].DBF.len),T=="B"&&z=="N"&&(T="N",O[b]=w[b].DBF.dec,P=w[b].DBF.len),C[b]=T=="C"||z=="N"?P:i[T]||0,_+=C[b],k[b]=T}var q=h.next(32);for(q.write_shift(4,318902576),q.write_shift(4,y.length),q.write_shift(2,296+32*N),q.write_shift(2,_),b=0;b<4;++b)q.write_shift(4,0);for(q.write_shift(4,0|(+t[lO]||3)<<8),b=0,S=0;b<v.length;++b)if(v[b]!=null){var B=h.next(32),fe=(v[b].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);B.write_shift(1,fe,"sbcs"),B.write_shift(1,k[b]=="?"?"C":k[b],"sbcs"),B.write_shift(4,S),B.write_shift(1,C[b]||i[k[b]]||0),B.write_shift(1,O[b]||0),B.write_shift(1,2),B.write_shift(4,0),B.write_shift(1,0),B.write_shift(4,0),B.write_shift(4,0),S+=C[b]||i[k[b]]||0}var Ne=h.next(264);for(Ne.write_shift(4,13),b=0;b<65;++b)Ne.write_shift(4,0);for(b=0;b<y.length;++b){var he=h.next(_);for(he.write_shift(1,0),S=0;S<v.length;++S)if(v[S]!=null)switch(k[S]){case"L":he.write_shift(1,y[b][S]==null?63:y[b][S]?84:70);break;case"B":he.write_shift(8,y[b][S]||0,"f");break;case"N":var K="0";for(typeof y[b][S]=="number"&&(K=y[b][S].toFixed(O[S]||0)),N=0;N<C[S]-K.length;++N)he.write_shift(1,32);he.write_shift(1,K,"sbcs");break;case"D":y[b][S]?(he.write_shift(4,("0000"+y[b][S].getFullYear()).slice(-4),"sbcs"),he.write_shift(2,("00"+(y[b][S].getMonth()+1)).slice(-2),"sbcs"),he.write_shift(2,("00"+y[b][S].getDate()).slice(-2),"sbcs")):he.write_shift(8,"00000000","sbcs");break;case"C":var H=String(y[b][S]!=null?y[b][S]:"").slice(0,C[S]);for(he.write_shift(1,H,"sbcs"),N=0;N<C[S]-H.length;++N)he.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:a,to_sheet:n,from_sheet:o}}(),fz=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+kl(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(v,y){var w=e[y];return typeof w=="number"?RA(w):w},n=function(v,y,w){var b=y.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return b==59?v:RA(b)};e["|"]=254;function a(v,y){switch(y.type){case"base64":return i(Ra(v),y);case"binary":return i(v,y);case"buffer":return i(Ut&&Buffer.isBuffer(v)?v.toString("binary"):Do(v),y);case"array":return i(Eo(v),y)}throw new Error("Unrecognized type "+y.type)}function i(v,y){var w=v.split(/[\n\r]+/),b=-1,S=-1,N=0,_=0,A=[],k=[],C=null,O={},T=[],z=[],P=[],Z=0,q;for(+y.codepage>=0&&Ai(+y.codepage);N!==w.length;++N){Z=0;var B=w[N].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),fe=B.replace(/;;/g,"\0").split(";").map(function(Q){return Q.replace(/\u0000/g,";")}),Ne=fe[0],he;if(B.length>0)switch(Ne){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":fe[1].charAt(0)=="P"&&k.push(B.slice(3).replace(/;;/g,";"));break;case"C":var K=!1,H=!1,be=!1,te=!1,I=-1,se=-1;for(_=1;_<fe.length;++_)switch(fe[_].charAt(0)){case"A":break;case"X":S=parseInt(fe[_].slice(1))-1,H=!0;break;case"Y":for(b=parseInt(fe[_].slice(1))-1,H||(S=0),q=A.length;q<=b;++q)A[q]=[];break;case"K":he=fe[_].slice(1),he.charAt(0)==='"'?he=he.slice(1,he.length-1):he==="TRUE"?he=!0:he==="FALSE"?he=!1:isNaN(_s(he))?isNaN(Wd(he).getDate())||(he=Nn(he)):(he=_s(he),C!==null&&au(C)&&(he=Qm(he))),K=!0;break;case"E":te=!0;var R=Rc(fe[_].slice(1),{r:b,c:S});A[b][S]=[A[b][S],R];break;case"S":be=!0,A[b][S]=[A[b][S],"S5S"];break;case"G":break;case"R":I=parseInt(fe[_].slice(1))-1;break;case"C":se=parseInt(fe[_].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+B)}if(K&&(A[b][S]&&A[b][S].length==2?A[b][S][0]=he:A[b][S]=he,C=null),be){if(te)throw new Error("SYLK shared formula cannot have own formula");var W=I>-1&&A[I][se];if(!W||!W[1])throw new Error("SYLK shared formula cannot find base");A[b][S][1]=y5(W[1],{r:b-I,c:S-se})}break;case"F":var Y=0;for(_=1;_<fe.length;++_)switch(fe[_].charAt(0)){case"X":S=parseInt(fe[_].slice(1))-1,++Y;break;case"Y":for(b=parseInt(fe[_].slice(1))-1,q=A.length;q<=b;++q)A[q]=[];break;case"M":Z=parseInt(fe[_].slice(1))/20;break;case"F":break;case"G":break;case"P":C=k[parseInt(fe[_].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=fe[_].slice(1).split(" "),q=parseInt(P[0],10);q<=parseInt(P[1],10);++q)Z=parseInt(P[2],10),z[q-1]=Z===0?{hidden:!0}:{wch:Z},Bc(z[q-1]);break;case"C":S=parseInt(fe[_].slice(1))-1,z[S]||(z[S]={});break;case"R":b=parseInt(fe[_].slice(1))-1,T[b]||(T[b]={}),Z>0?(T[b].hpt=Z,T[b].hpx=Jd(Z)):Z===0&&(T[b].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+B)}Y<1&&(C=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+B)}}return T.length>0&&(O["!rows"]=T),z.length>0&&(O["!cols"]=z),y&&y.sheetRows&&(A=A.slice(0,y.sheetRows)),[A,O]}function o(v,y){var w=a(v,y),b=w[0],S=w[1],N=yf(b,y);return kl(S).forEach(function(_){N[_]=S[_]}),N}function u(v,y){return Po(o(v,y),y)}function m(v,y,w,b){var S="C;Y"+(w+1)+";X"+(b+1)+";K";switch(v.t){case"n":S+=v.v||0,v.f&&!v.F&&(S+=";E"+QH(v.f,{r:w,c:b}));break;case"b":S+=v.v?"TRUE":"FALSE";break;case"e":S+=v.w||v.v;break;case"d":S+='"'+(v.w||v.v)+'"';break;case"s":S+='"'+v.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function f(v,y){y.forEach(function(w,b){var S="F;W"+(b+1)+" "+(b+1)+" ";w.hidden?S+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=Yh(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=Zh(w.wpx)),typeof w.wch=="number"&&(S+=Math.round(w.wch))),S.charAt(S.length-1)!=" "&&v.push(S)})}function h(v,y){y.forEach(function(w,b){var S="F;";w.hidden?S+="M0;":w.hpt?S+="M"+20*w.hpt+";":w.hpx&&(S+="M"+20*x5(w.hpx)+";"),S.length>2&&v.push(S+"R"+(b+1))})}function x(v,y){var w=["ID;PWXL;N;E"],b=[],S=pn(v["!ref"]),N,_=Array.isArray(v),A=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),v["!cols"]&&f(w,v["!cols"]),v["!rows"]&&h(w,v["!rows"]),w.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var k=S.s.r;k<=S.e.r;++k)for(var C=S.s.c;C<=S.e.c;++C){var O=Ft({r:k,c:C});N=_?(v[k]||[])[C]:v[O],!(!N||N.v==null&&(!N.f||N.F))&&b.push(m(N,v,k,C))}return w.join(A)+A+b.join(A)+A+"E"+A}return{to_workbook:u,to_sheet:o,from_sheet:x}}(),hz=function(){function e(i,o){switch(o.type){case"base64":return t(Ra(i),o);case"binary":return t(i,o);case"buffer":return t(Ut&&Buffer.isBuffer(i)?i.toString("binary"):Do(i),o);case"array":return t(Eo(i),o)}throw new Error("Unrecognized type "+o.type)}function t(i,o){for(var u=i.split(`
`),m=-1,f=-1,h=0,x=[];h!==u.length;++h){if(u[h].trim()==="BOT"){x[++m]=[],f=0;continue}if(!(m<0)){var v=u[h].trim().split(","),y=v[0],w=v[1];++h;for(var b=u[h]||"";(b.match(/["]/g)||[]).length&1&&h<u.length-1;)b+=`
`+u[++h];switch(b=b.trim(),+y){case-1:if(b==="BOT"){x[++m]=[],f=0;continue}else if(b!=="EOD")throw new Error("Unrecognized DIF special command "+b);break;case 0:b==="TRUE"?x[m][f]=!0:b==="FALSE"?x[m][f]=!1:isNaN(_s(w))?isNaN(Wd(w).getDate())?x[m][f]=w:x[m][f]=Nn(w):x[m][f]=_s(w),++f;break;case 1:b=b.slice(1,b.length-1),b=b.replace(/""/g,'"'),b&&b.match(/^=".*"$/)&&(b=b.slice(2,-1)),x[m][f++]=b!==""?b:null;break}if(b==="EOD")break}}return o&&o.sheetRows&&(x=x.slice(0,o.sheetRows)),x}function r(i,o){return yf(e(i,o),o)}function n(i,o){return Po(r(i,o),o)}var a=function(){var i=function(m,f,h,x,v){m.push(f),m.push(h+","+x),m.push('"'+v.replace(/"/g,'""')+'"')},o=function(m,f,h,x){m.push(f+","+h),m.push(f==1?'"'+x.replace(/"/g,'""')+'"':x)};return function(m){var f=[],h=pn(m["!ref"]),x,v=Array.isArray(m);i(f,"TABLE",0,1,"sheetjs"),i(f,"VECTORS",0,h.e.r-h.s.r+1,""),i(f,"TUPLES",0,h.e.c-h.s.c+1,""),i(f,"DATA",0,0,"");for(var y=h.s.r;y<=h.e.r;++y){o(f,-1,0,"BOT");for(var w=h.s.c;w<=h.e.c;++w){var b=Ft({r:y,c:w});if(x=v?(m[y]||[])[w]:m[b],!x){o(f,1,0,"");continue}switch(x.t){case"n":var S=x.w;!S&&x.v!=null&&(S=x.v),S==null?x.f&&!x.F?o(f,1,0,"="+x.f):o(f,1,0,""):o(f,0,S,"V");break;case"b":o(f,0,x.v?1:0,x.v?"TRUE":"FALSE");break;case"s":o(f,1,0,isNaN(x.v)?x.v:'="'+x.v+'"');break;case"d":x.w||(x.w=oi(x.z||Tt[14],Ma(Nn(x.v)))),o(f,0,x.w,"V");break;default:o(f,1,0,"")}}}o(f,-1,0,"EOD");var N=`\r
`,_=f.join(N);return _}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),mz=function(){function e(x){return x.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(x){return x.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(x,v){for(var y=x.split(`
`),w=-1,b=-1,S=0,N=[];S!==y.length;++S){var _=y[S].trim().split(":");if(_[0]==="cell"){var A=Ti(_[1]);if(N.length<=A.r)for(w=N.length;w<=A.r;++w)N[w]||(N[w]=[]);switch(w=A.r,b=A.c,_[2]){case"t":N[w][b]=e(_[3]);break;case"v":N[w][b]=+_[3];break;case"vtf":var k=_[_.length-1];case"vtc":switch(_[3]){case"nl":N[w][b]=!!+_[4];break;default:N[w][b]=+_[4];break}_[2]=="vtf"&&(N[w][b]=[N[w][b],k])}}}return v&&v.sheetRows&&(N=N.slice(0,v.sheetRows)),N}function n(x,v){return yf(r(x,v),v)}function a(x,v){return Po(n(x,v),v)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),m="--SocialCalcSpreadsheetControlSave--";function f(x){if(!x||!x["!ref"])return"";for(var v=[],y=[],w,b="",S=r2(x["!ref"]),N=Array.isArray(x),_=S.s.r;_<=S.e.r;++_)for(var A=S.s.c;A<=S.e.c;++A)if(b=Ft({r:_,c:A}),w=N?(x[_]||[])[A]:x[b],!(!w||w.v==null||w.t==="z")){switch(y=["cell",b,"t"],w.t){case"s":case"str":y.push(t(w.v));break;case"n":w.f?(y[2]="vtf",y[3]="n",y[4]=w.v,y[5]=t(w.f)):(y[2]="v",y[3]=w.v);break;case"b":y[2]="vt"+(w.f?"f":"c"),y[3]="nl",y[4]=w.v?"1":"0",y[5]=t(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var k=Ma(Nn(w.v));y[2]="vtc",y[3]="nd",y[4]=""+k,y[5]=w.w||oi(w.z||Tt[14],k);break;case"e":continue}v.push(y.join(":"))}return v.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),v.push("valueformat:1:text-wiki"),v.join(`
`)}function h(x){return[i,o,u,o,f(x),m].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:h}}(),Zd=function(){function e(h,x,v,y,w){w.raw?x[v][y]=h:h===""||(h==="TRUE"?x[v][y]=!0:h==="FALSE"?x[v][y]=!1:isNaN(_s(h))?isNaN(Wd(h).getDate())?x[v][y]=h:x[v][y]=Nn(h):x[v][y]=_s(h))}function t(h,x){var v=x||{},y=[];if(!h||h.length===0)return y;for(var w=h.split(/[\r\n]/),b=w.length-1;b>=0&&w[b].length===0;)--b;for(var S=10,N=0,_=0;_<=b;++_)N=w[_].indexOf(" "),N==-1?N=w[_].length:N++,S=Math.max(S,N);for(_=0;_<=b;++_){y[_]=[];var A=0;for(e(w[_].slice(0,S).trim(),y,_,A,v),A=1;A<=(w[_].length-S)/10+1;++A)e(w[_].slice(S+(A-1)*10,S+A*10).trim(),y,_,A,v)}return v.sheetRows&&(y=y.slice(0,v.sheetRows)),y}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(h){for(var x={},v=!1,y=0,w=0;y<h.length;++y)(w=h.charCodeAt(y))==34?v=!v:!v&&w in r&&(x[w]=(x[w]||0)+1);w=[];for(y in x)Object.prototype.hasOwnProperty.call(x,y)&&w.push([x[y],y]);if(!w.length){x=n;for(y in x)Object.prototype.hasOwnProperty.call(x,y)&&w.push([x[y],y])}return w.sort(function(b,S){return b[0]-S[0]||n[b[1]]-n[S[1]]}),r[w.pop()[1]]||44}function i(h,x){var v=x||{},y="",w=v.dense?[]:{},b={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(y=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(y=h.charAt(4),h=h.slice(6)):y=a(h.slice(0,1024)):v&&v.FS?y=v.FS:y=a(h.slice(0,1024));var S=0,N=0,_=0,A=0,k=0,C=y.charCodeAt(0),O=!1,T=0,z=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var P=v.dateNF!=null?_9(v.dateNF):null;function Z(){var q=h.slice(A,k),B={};if(q.charAt(0)=='"'&&q.charAt(q.length-1)=='"'&&(q=q.slice(1,-1).replace(/""/g,'"')),q.length===0)B.t="z";else if(v.raw)B.t="s",B.v=q;else if(q.trim().length===0)B.t="s",B.v=q;else if(q.charCodeAt(0)==61)q.charCodeAt(1)==34&&q.charCodeAt(q.length-1)==34?(B.t="s",B.v=q.slice(2,-1).replace(/""/g,'"')):eq(q)?(B.t="n",B.f=q.slice(1)):(B.t="s",B.v=q);else if(q=="TRUE")B.t="b",B.v=!0;else if(q=="FALSE")B.t="b",B.v=!1;else if(!isNaN(_=_s(q)))B.t="n",v.cellText!==!1&&(B.w=q),B.v=_;else if(!isNaN(Wd(q).getDate())||P&&q.match(P)){B.z=v.dateNF||Tt[14];var fe=0;P&&q.match(P)&&(q=T9(q,v.dateNF,q.match(P)||[]),fe=1),v.cellDates?(B.t="d",B.v=Nn(q,fe)):(B.t="n",B.v=Ma(Nn(q,fe))),v.cellText!==!1&&(B.w=oi(B.z,B.v instanceof Date?Ma(B.v):B.v)),v.cellNF||delete B.z}else B.t="s",B.v=q;if(B.t=="z"||(v.dense?(w[S]||(w[S]=[]),w[S][N]=B):w[Ft({c:N,r:S})]=B),A=k+1,z=h.charCodeAt(A),b.e.c<N&&(b.e.c=N),b.e.r<S&&(b.e.r=S),T==C)++N;else if(N=0,++S,v.sheetRows&&v.sheetRows<=S)return!0}e:for(;k<h.length;++k)switch(T=h.charCodeAt(k)){case 34:z===34&&(O=!O);break;case C:case 10:case 13:if(!O&&Z())break e;break}return k-A>0&&Z(),w["!ref"]=sr(b),w}function o(h,x){return!(x&&x.PRN)||x.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?i(h,x):yf(t(h,x),x)}function u(h,x){var v="",y=x.type=="string"?[0,0,0,0]:p2(h,x);switch(x.type){case"base64":v=Ra(h);break;case"binary":v=h;break;case"buffer":x.codepage==65001?v=h.toString("utf8"):x.codepage&&typeof Kd<"u"||(v=Ut&&Buffer.isBuffer(h)?h.toString("binary"):Do(h));break;case"array":v=Eo(h);break;case"string":v=h;break;default:throw new Error("Unrecognized type "+x.type)}return y[0]==239&&y[1]==187&&y[2]==191?v=vr(v.slice(3)):x.type!="string"&&x.type!="buffer"&&x.codepage==65001?v=vr(v):x.type=="binary"&&typeof Kd<"u",v.slice(0,19)=="socialcalc:version:"?mz.to_sheet(x.type=="string"?v:vr(v),x):o(v,x)}function m(h,x){return Po(u(h,x),x)}function f(h){for(var x=[],v=pn(h["!ref"]),y,w=Array.isArray(h),b=v.s.r;b<=v.e.r;++b){for(var S=[],N=v.s.c;N<=v.e.c;++N){var _=Ft({r:b,c:N});if(y=w?(h[b]||[])[N]:h[_],!y||y.v==null){S.push("          ");continue}for(var A=(y.w||(Lc(y),y.w)||"").slice(0,10);A.length<10;)A+=" ";S.push(A+(N===0?" ":""))}x.push(S.join(""))}return x.join(`
`)}return{to_workbook:m,to_sheet:u,from_sheet:f}}();function pz(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=fz.to_workbook(e,r);return r.WTF=n,a}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return Zd.to_workbook(e,t)}}var Md=function(){function e(R,W,Y){if(R){jn(R,R.l||0);for(var Q=Y.Enum||I;R.l<R.length;){var L=R.read_shift(2),ne=Q[L]||Q[65535],ge=R.read_shift(2),G=R.l+ge,ue=ne.f&&ne.f(R,ge,Y);if(R.l=G,W(ue,ne,L))return}}}function t(R,W){switch(W.type){case"base64":return r(ji(Ra(R)),W);case"binary":return r(ji(R),W);case"buffer":case"array":return r(R,W)}throw"Unsupported type "+W.type}function r(R,W){if(!R)return R;var Y=W||{},Q=Y.dense?[]:{},L="Sheet1",ne="",ge=0,G={},ue=[],Se=[],M={s:{r:0,c:0},e:{r:0,c:0}},Qe=Y.sheetRows||0;if(R[2]==0&&(R[3]==8||R[3]==9)&&R.length>=16&&R[14]==5&&R[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(R[2]==2)Y.Enum=I,e(R,function(oe,ke,Ge){switch(Ge){case 0:Y.vers=oe,oe>=4096&&(Y.qpro=!0);break;case 6:M=oe;break;case 204:oe&&(ne=oe);break;case 222:ne=oe;break;case 15:case 51:Y.qpro||(oe[1].v=oe[1].v.slice(1));case 13:case 14:case 16:Ge==14&&(oe[2]&112)==112&&(oe[2]&15)>1&&(oe[2]&15)<15&&(oe[1].z=Y.dateNF||Tt[14],Y.cellDates&&(oe[1].t="d",oe[1].v=Qm(oe[1].v))),Y.qpro&&oe[3]>ge&&(Q["!ref"]=sr(M),G[L]=Q,ue.push(L),Q=Y.dense?[]:{},M={s:{r:0,c:0},e:{r:0,c:0}},ge=oe[3],L=ne||"Sheet"+(ge+1),ne="");var Fe=Y.dense?(Q[oe[0].r]||[])[oe[0].c]:Q[Ft(oe[0])];if(Fe){Fe.t=oe[1].t,Fe.v=oe[1].v,oe[1].z!=null&&(Fe.z=oe[1].z),oe[1].f!=null&&(Fe.f=oe[1].f);break}Y.dense?(Q[oe[0].r]||(Q[oe[0].r]=[]),Q[oe[0].r][oe[0].c]=oe[1]):Q[Ft(oe[0])]=oe[1];break}},Y);else if(R[2]==26||R[2]==14)Y.Enum=se,R[2]==14&&(Y.qpro=!0,R.l=0),e(R,function(oe,ke,Ge){switch(Ge){case 204:L=oe;break;case 22:oe[1].v=oe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(oe[3]>ge&&(Q["!ref"]=sr(M),G[L]=Q,ue.push(L),Q=Y.dense?[]:{},M={s:{r:0,c:0},e:{r:0,c:0}},ge=oe[3],L="Sheet"+(ge+1)),Qe>0&&oe[0].r>=Qe)break;Y.dense?(Q[oe[0].r]||(Q[oe[0].r]=[]),Q[oe[0].r][oe[0].c]=oe[1]):Q[Ft(oe[0])]=oe[1],M.e.c<oe[0].c&&(M.e.c=oe[0].c),M.e.r<oe[0].r&&(M.e.r=oe[0].r);break;case 27:oe[14e3]&&(Se[oe[14e3][0]]=oe[14e3][1]);break;case 1537:Se[oe[0]]=oe[1],oe[0]==ge&&(L=oe[1]);break}},Y);else throw new Error("Unrecognized LOTUS BOF "+R[2]);if(Q["!ref"]=sr(M),G[ne||L]=Q,ue.push(ne||L),!Se.length)return{SheetNames:ue,Sheets:G};for(var xe={},me=[],ze=0;ze<Se.length;++ze)G[ue[ze]]?(me.push(Se[ze]||ue[ze]),xe[Se[ze]]=G[Se[ze]]||G[ue[ze]]):(me.push(Se[ze]),xe[Se[ze]]={"!ref":"A1"});return{SheetNames:me,Sheets:xe}}function n(R,W){var Y=W||{};if(+Y.codepage>=0&&Ai(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK1 to JS string");var Q=jy(),L=pn(R["!ref"]),ne=Array.isArray(R),ge=[];wi(Q,0,i(1030)),wi(Q,6,m(L));for(var G=Math.min(L.e.r,8191),ue=L.s.r;ue<=G;++ue)for(var Se=Da(ue),M=L.s.c;M<=L.e.c;++M){ue===L.s.r&&(ge[M]=Wn(M));var Qe=ge[M]+Se,xe=ne?(R[ue]||[])[M]:R[Qe];if(!(!xe||xe.t=="z"))if(xe.t=="n")(xe.v|0)==xe.v&&xe.v>=-32768&&xe.v<=32767?wi(Q,13,y(ue,M,xe.v)):wi(Q,14,b(ue,M,xe.v));else{var me=Lc(xe);wi(Q,15,x(ue,M,me.slice(0,239)))}}return wi(Q,1),Q.end()}function a(R,W){var Y=W||{};if(+Y.codepage>=0&&Ai(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK3 to JS string");var Q=jy();wi(Q,0,o(R));for(var L=0,ne=0;L<R.SheetNames.length;++L)(R.Sheets[R.SheetNames[L]]||{})["!ref"]&&wi(Q,27,te(R.SheetNames[L],ne++));var ge=0;for(L=0;L<R.SheetNames.length;++L){var G=R.Sheets[R.SheetNames[L]];if(!(!G||!G["!ref"])){for(var ue=pn(G["!ref"]),Se=Array.isArray(G),M=[],Qe=Math.min(ue.e.r,8191),xe=ue.s.r;xe<=Qe;++xe)for(var me=Da(xe),ze=ue.s.c;ze<=ue.e.c;++ze){xe===ue.s.r&&(M[ze]=Wn(ze));var oe=M[ze]+me,ke=Se?(G[xe]||[])[ze]:G[oe];if(!(!ke||ke.t=="z"))if(ke.t=="n")wi(Q,23,Z(xe,ze,ge,ke.v));else{var Ge=Lc(ke);wi(Q,22,T(xe,ze,ge,Ge.slice(0,239)))}}++ge}}return wi(Q,1),Q.end()}function i(R){var W=en(2);return W.write_shift(2,R),W}function o(R){var W=en(26);W.write_shift(2,4096),W.write_shift(2,4),W.write_shift(4,0);for(var Y=0,Q=0,L=0,ne=0;ne<R.SheetNames.length;++ne){var ge=R.SheetNames[ne],G=R.Sheets[ge];if(!(!G||!G["!ref"])){++L;var ue=r2(G["!ref"]);Y<ue.e.r&&(Y=ue.e.r),Q<ue.e.c&&(Q=ue.e.c)}}return Y>8191&&(Y=8191),W.write_shift(2,Y),W.write_shift(1,L),W.write_shift(1,Q),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(1,1),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(4,0),W}function u(R,W,Y){var Q={s:{c:0,r:0},e:{c:0,r:0}};return W==8&&Y.qpro?(Q.s.c=R.read_shift(1),R.l++,Q.s.r=R.read_shift(2),Q.e.c=R.read_shift(1),R.l++,Q.e.r=R.read_shift(2),Q):(Q.s.c=R.read_shift(2),Q.s.r=R.read_shift(2),W==12&&Y.qpro&&(R.l+=2),Q.e.c=R.read_shift(2),Q.e.r=R.read_shift(2),W==12&&Y.qpro&&(R.l+=2),Q.s.c==65535&&(Q.s.c=Q.e.c=Q.s.r=Q.e.r=0),Q)}function m(R){var W=en(8);return W.write_shift(2,R.s.c),W.write_shift(2,R.s.r),W.write_shift(2,R.e.c),W.write_shift(2,R.e.r),W}function f(R,W,Y){var Q=[{c:0,r:0},{t:"n",v:0},0,0];return Y.qpro&&Y.vers!=20768?(Q[0].c=R.read_shift(1),Q[3]=R.read_shift(1),Q[0].r=R.read_shift(2),R.l+=2):(Q[2]=R.read_shift(1),Q[0].c=R.read_shift(2),Q[0].r=R.read_shift(2)),Q}function h(R,W,Y){var Q=R.l+W,L=f(R,W,Y);if(L[1].t="s",Y.vers==20768){R.l++;var ne=R.read_shift(1);return L[1].v=R.read_shift(ne,"utf8"),L}return Y.qpro&&R.l++,L[1].v=R.read_shift(Q-R.l,"cstr"),L}function x(R,W,Y){var Q=en(7+Y.length);Q.write_shift(1,255),Q.write_shift(2,W),Q.write_shift(2,R),Q.write_shift(1,39);for(var L=0;L<Q.length;++L){var ne=Y.charCodeAt(L);Q.write_shift(1,ne>=128?95:ne)}return Q.write_shift(1,0),Q}function v(R,W,Y){var Q=f(R,W,Y);return Q[1].v=R.read_shift(2,"i"),Q}function y(R,W,Y){var Q=en(7);return Q.write_shift(1,255),Q.write_shift(2,W),Q.write_shift(2,R),Q.write_shift(2,Y,"i"),Q}function w(R,W,Y){var Q=f(R,W,Y);return Q[1].v=R.read_shift(8,"f"),Q}function b(R,W,Y){var Q=en(13);return Q.write_shift(1,255),Q.write_shift(2,W),Q.write_shift(2,R),Q.write_shift(8,Y,"f"),Q}function S(R,W,Y){var Q=R.l+W,L=f(R,W,Y);if(L[1].v=R.read_shift(8,"f"),Y.qpro)R.l=Q;else{var ne=R.read_shift(2);k(R.slice(R.l,R.l+ne),L),R.l+=ne}return L}function N(R,W,Y){var Q=W&32768;return W&=-32769,W=(Q?R:0)+(W>=8192?W-16384:W),(Q?"":"$")+(Y?Wn(W):Da(W))}var _={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},A=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function k(R,W){jn(R,0);for(var Y=[],Q=0,L="",ne="",ge="",G="";R.l<R.length;){var ue=R[R.l++];switch(ue){case 0:Y.push(R.read_shift(8,"f"));break;case 1:ne=N(W[0].c,R.read_shift(2),!0),L=N(W[0].r,R.read_shift(2),!1),Y.push(ne+L);break;case 2:{var Se=N(W[0].c,R.read_shift(2),!0),M=N(W[0].r,R.read_shift(2),!1);ne=N(W[0].c,R.read_shift(2),!0),L=N(W[0].r,R.read_shift(2),!1),Y.push(Se+M+":"+ne+L)}break;case 3:if(R.l<R.length){console.error("WK1 premature formula end");return}break;case 4:Y.push("("+Y.pop()+")");break;case 5:Y.push(R.read_shift(2));break;case 6:{for(var Qe="";ue=R[R.l++];)Qe+=String.fromCharCode(ue);Y.push('"'+Qe.replace(/"/g,'""')+'"')}break;case 8:Y.push("-"+Y.pop());break;case 23:Y.push("+"+Y.pop());break;case 22:Y.push("NOT("+Y.pop()+")");break;case 20:case 21:G=Y.pop(),ge=Y.pop(),Y.push(["AND","OR"][ue-20]+"("+ge+","+G+")");break;default:if(ue<32&&A[ue])G=Y.pop(),ge=Y.pop(),Y.push(ge+A[ue]+G);else if(_[ue]){if(Q=_[ue][1],Q==69&&(Q=R[R.l++]),Q>Y.length){console.error("WK1 bad formula parse 0x"+ue.toString(16)+":|"+Y.join("|")+"|");return}var xe=Y.slice(-Q);Y.length-=Q,Y.push(_[ue][0]+"("+xe.join(",")+")")}else return ue<=7?console.error("WK1 invalid opcode "+ue.toString(16)):ue<=24?console.error("WK1 unsupported op "+ue.toString(16)):ue<=30?console.error("WK1 invalid opcode "+ue.toString(16)):ue<=115?console.error("WK1 unsupported function opcode "+ue.toString(16)):console.error("WK1 unrecognized opcode "+ue.toString(16))}}Y.length==1?W[1].f=""+Y[0]:console.error("WK1 bad formula parse |"+Y.join("|")+"|")}function C(R){var W=[{c:0,r:0},{t:"n",v:0},0];return W[0].r=R.read_shift(2),W[3]=R[R.l++],W[0].c=R[R.l++],W}function O(R,W){var Y=C(R);return Y[1].t="s",Y[1].v=R.read_shift(W-4,"cstr"),Y}function T(R,W,Y,Q){var L=en(6+Q.length);L.write_shift(2,R),L.write_shift(1,Y),L.write_shift(1,W),L.write_shift(1,39);for(var ne=0;ne<Q.length;++ne){var ge=Q.charCodeAt(ne);L.write_shift(1,ge>=128?95:ge)}return L.write_shift(1,0),L}function z(R,W){var Y=C(R);Y[1].v=R.read_shift(2);var Q=Y[1].v>>1;if(Y[1].v&1)switch(Q&7){case 0:Q=(Q>>3)*5e3;break;case 1:Q=(Q>>3)*500;break;case 2:Q=(Q>>3)/20;break;case 3:Q=(Q>>3)/200;break;case 4:Q=(Q>>3)/2e3;break;case 5:Q=(Q>>3)/2e4;break;case 6:Q=(Q>>3)/16;break;case 7:Q=(Q>>3)/64;break}return Y[1].v=Q,Y}function P(R,W){var Y=C(R),Q=R.read_shift(4),L=R.read_shift(4),ne=R.read_shift(2);if(ne==65535)return Q===0&&L===3221225472?(Y[1].t="e",Y[1].v=15):Q===0&&L===3489660928?(Y[1].t="e",Y[1].v=42):Y[1].v=0,Y;var ge=ne&32768;return ne=(ne&32767)-16446,Y[1].v=(1-ge*2)*(L*Math.pow(2,ne+32)+Q*Math.pow(2,ne)),Y}function Z(R,W,Y,Q){var L=en(14);if(L.write_shift(2,R),L.write_shift(1,Y),L.write_shift(1,W),Q==0)return L.write_shift(4,0),L.write_shift(4,0),L.write_shift(2,65535),L;var ne=0,ge=0,G=0,ue=0;return Q<0&&(ne=1,Q=-Q),ge=Math.log2(Q)|0,Q/=Math.pow(2,ge-31),ue=Q>>>0,(ue&2147483648)==0&&(Q/=2,++ge,ue=Q>>>0),Q-=ue,ue|=2147483648,ue>>>=0,Q*=Math.pow(2,32),G=Q>>>0,L.write_shift(4,G),L.write_shift(4,ue),ge+=16383+(ne?32768:0),L.write_shift(2,ge),L}function q(R,W){var Y=P(R);return R.l+=W-14,Y}function B(R,W){var Y=C(R),Q=R.read_shift(4);return Y[1].v=Q>>6,Y}function fe(R,W){var Y=C(R),Q=R.read_shift(8,"f");return Y[1].v=Q,Y}function Ne(R,W){var Y=fe(R);return R.l+=W-10,Y}function he(R,W){return R[R.l+W-1]==0?R.read_shift(W,"cstr"):""}function K(R,W){var Y=R[R.l++];Y>W-1&&(Y=W-1);for(var Q="";Q.length<Y;)Q+=String.fromCharCode(R[R.l++]);return Q}function H(R,W,Y){if(!(!Y.qpro||W<21)){var Q=R.read_shift(1);R.l+=17,R.l+=1,R.l+=2;var L=R.read_shift(W-21,"cstr");return[Q,L]}}function be(R,W){for(var Y={},Q=R.l+W;R.l<Q;){var L=R.read_shift(2);if(L==14e3){for(Y[L]=[0,""],Y[L][0]=R.read_shift(2);R[R.l];)Y[L][1]+=String.fromCharCode(R[R.l]),R.l++;R.l++}}return Y}function te(R,W){var Y=en(5+R.length);Y.write_shift(2,14e3),Y.write_shift(2,W);for(var Q=0;Q<R.length;++Q){var L=R.charCodeAt(Q);Y[Y.l++]=L>127?95:L}return Y[Y.l++]=0,Y}var I={0:{n:"BOF",f:Vr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:v},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:he},222:{n:"SHEETNAMELP",f:K},65535:{n:""}},se={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:O},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:z},25:{n:"FORMULA19",f:q},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:be},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:B},38:{n:"??"},39:{n:"NUMBER27",f:fe},40:{n:"FORMULA28",f:Ne},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:he},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:H},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function xz(e){var t={},r=e.match(Un),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=St(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=Gb[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}var vz=function(){var e=Xd("t"),t=Xd("rPr");function r(i){var o=i.match(e);if(!o)return{t:"s",v:""};var u={t:"s",v:Gt(o[1])},m=i.match(t);return m&&(u.s=xz(m[1])),u}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(a).map(r).filter(function(u){return u.v})}}(),gz=function(){var t=/(\r\n|\n)/g;function r(a,i,o){var u=[];a.u&&u.push("text-decoration: underline;"),a.uval&&u.push("text-underline-style:"+a.uval+";"),a.sz&&u.push("font-size:"+a.sz+"pt;"),a.outline&&u.push("text-effect: outline;"),a.shadow&&u.push("text-shadow: auto;"),i.push('<span style="'+u.join("")+'">'),a.b&&(i.push("<b>"),o.push("</b>")),a.i&&(i.push("<i>"),o.push("</i>")),a.strike&&(i.push("<s>"),o.push("</s>"));var m=a.valign||"";return m=="superscript"||m=="super"?m="sup":m=="subscript"&&(m="sub"),m!=""&&(i.push("<"+m+">"),o.push("</"+m+">")),o.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&r(a.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),yz=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,bz=/<(?:\w+:)?r>/,wz=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function o2(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Gt(vr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=vr(e),r&&(n.h=kO(n.t))):e.match(bz)&&(n.r=vr(e),n.t=Gt(vr((e.replace(wz,"").match(yz)||[]).join("").replace(Un,""))),r&&(n.h=gz(vz(n.r)))),n):{t:""}}var Sz=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,jz=/<(?:\w+:)?(?:si|sstItem)>/g,Nz=/<\/(?:\w+:)?(?:si|sstItem)>/;function Ez(e,t){var r=[],n="";if(!e)return r;var a=e.match(Sz);if(a){n=a[2].replace(jz,"").split(Nz);for(var i=0;i!=n.length;++i){var o=o2(n[i].trim(),t);o!=null&&(r[r.length]=o)}a=St(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}function Az(e){return[e.read_shift(4),e.read_shift(4)]}function _z(e,t){var r=[],n=!1;return Is(e,function(i,o,u){switch(u){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function u5(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Ts(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function Tz(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Ts(e,4),t.U=Ts(e,4),t.W=Ts(e,4),t}function kz(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function Cz(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(kz(e));return t}function Oz(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function Dz(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Ts(e,4),t.U=Ts(e,4),t.W=Ts(e,4),t}function Pz(e){var t=Dz(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function d5(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function f5(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function Rz(e){var t=Ts(e);switch(t.Minor){case 2:return[t.Minor,Mz(e)];case 3:return[t.Minor,Fz()];case 4:return[t.Minor,Iz(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function Mz(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=d5(e,r),a=f5(e,e.length-e.l);return{t:"Std",h:n,v:a}}function Fz(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Iz(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Un,function(i){var o=St(i);switch(ts(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(u){n[u]=o[u]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function Lz(e,t){var r={},n=r.EncryptionVersionInfo=Ts(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=d5(e,a),t-=a,r.EncryptionVerifier=f5(e,t),r}function Bz(e){var t={},r=t.EncryptionVersionInfo=Ts(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Uz(e){var t=0,r,n=u5(e),a=n.length+1,i,o,u,m,f;for(r=Tl(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)o=r[i],u=(t&16384)===0?0:1,m=t<<1&32767,f=u|m,t=f^o;return t^52811}var h5=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},a=function(o,u){return n(o^u)},i=function(o){for(var u=t[o.length-1],m=104,f=o.length-1;f>=0;--f)for(var h=o[f],x=0;x!=7;++x)h&64&&(u^=r[m]),h*=2,--m;return u};return function(o){for(var u=u5(o),m=i(u),f=u.length,h=Tl(16),x=0;x!=16;++x)h[x]=0;var v,y,w;for((f&1)===1&&(v=m>>8,h[f]=a(e[0],v),--f,v=m&255,y=u[u.length-1],h[f]=a(y,v));f>0;)--f,v=m>>8,h[f]=a(u[f],v),--f,v=m&255,h[f]=a(u[f],v);for(f=15,w=15-u.length;w>0;)v=m>>8,h[f]=a(e[w],v),--f,--w,v=m&255,h[f]=a(u[f],v),--f,--w;return h}}(),$z=function(e,t,r,n,a){a||(a=t),n||(n=h5(e));var i,o;for(i=0;i!=t.length;++i)o=t[i],o^=n[r],o=(o>>5|o<<3)&255,a[i]=o,++r;return[a,r,n]},zz=function(e){var t=0,r=h5(e);return function(n){var a=$z("",n,t,r);return t=a[1],a[0]}};function Hz(e,t,r,n){var a={key:Vr(e),verificationBytes:Vr(e)};return r.password&&(a.verifier=Uz(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=zz(r.password)),a}function qz(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Bz(e):n.Data=Lz(e,t),n}function Vz(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?qz(e,t-2,n):Hz(e,r.biff>=8?t:t-2,r,n),n}var Kz=function(){function e(a,i){switch(i.type){case"base64":return t(Ra(a),i);case"binary":return t(a,i);case"buffer":return t(Ut&&Buffer.isBuffer(a)?a.toString("binary"):Do(a),i);case"array":return t(Eo(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var o=i||{},u=o.dense?[]:{},m=a.match(/\\trowd.*?\\row\b/g);if(!m.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:m.length-1}};return m.forEach(function(h,x){Array.isArray(u)&&(u[x]=[]);for(var v=/\\\w+\b/g,y=0,w,b=-1;w=v.exec(h);){switch(w[0]){case"\\cell":var S=h.slice(y,v.lastIndex-w[0].length);if(S[0]==" "&&(S=S.slice(1)),++b,S.length){var N={v:S,t:"s"};Array.isArray(u)?u[x][b]=N:u[Ft({r:x,c:b})]=N}break}y=v.lastIndex}b>f.e.c&&(f.e.c=b)}),u["!ref"]=sr(f),u}function r(a,i){return Po(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],o=pn(a["!ref"]),u,m=Array.isArray(a),f=o.s.r;f<=o.e.r;++f){i.push("\\trowd\\trautofit1");for(var h=o.s.c;h<=o.e.c;++h)i.push("\\cellx"+(h+1));for(i.push("\\pard\\intbl"),h=o.s.c;h<=o.e.c;++h){var x=Ft({r:f,c:h});u=m?(a[f]||[])[h]:a[x],!(!u||u.v==null&&(!u.f||u.F))&&(i.push(" "+(u.w||(Lc(u),u.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function Gz(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Qd(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function Wz(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),i=Math.min(t,r,n),o=a-i;if(o===0)return[0,0,t];var u=0,m=0,f=a+i;switch(m=o/(f>1?2-f:f),a){case t:u=((r-n)/o+6)%6;break;case r:u=(n-t)/o+2;break;case n:u=(t-r)/o+4;break}return[u/6,m,f/2]}function Xz(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),i=n-a/2,o=[i,i,i],u=6*t,m;if(r!==0)switch(u|0){case 0:case 6:m=a*u,o[0]+=a,o[1]+=m;break;case 1:m=a*(2-u),o[0]+=m,o[1]+=a;break;case 2:m=a*(u-2),o[1]+=a,o[2]+=m;break;case 3:m=a*(4-u),o[1]+=m,o[2]+=a;break;case 4:m=a*(u-4),o[2]+=a,o[0]+=m;break;case 5:m=a*(6-u),o[2]+=m,o[0]+=a;break}for(var f=0;f!=3;++f)o[f]=Math.round(o[f]*255);return o}function Xh(e,t){if(t===0)return e;var r=Wz(Gz(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Qd(Xz(r))}var m5=6,Yz=15,Zz=1,Gn=m5;function Yh(e){return Math.floor((e+Math.round(128/Gn)/256)*Gn)}function Zh(e){return Math.floor((e-5)/Gn*100+.5)/100}function _y(e){return Math.round((e*Gn+5)/Gn*256)/256}function xg(e){return _y(Zh(Yh(e)))}function c2(e){var t=Math.abs(e-xg(e)),r=Gn;if(t>.005)for(Gn=Zz;Gn<Yz;++Gn)Math.abs(e-xg(e))<=t&&(t=Math.abs(e-xg(e)),r=Gn);Gn=r}function Bc(e){e.width?(e.wpx=Yh(e.width),e.wch=Zh(e.wpx),e.MDW=Gn):e.wpx?(e.wch=Zh(e.wpx),e.width=_y(e.wch),e.MDW=Gn):typeof e.wch=="number"&&(e.width=_y(e.wch),e.wpx=Yh(e.width),e.MDW=Gn),e.customWidth&&delete e.customWidth}var Qz=96,p5=Qz;function x5(e){return e*96/p5}function Jd(e){return e*p5/96}var Jz={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function eH(e,t,r,n){t.Borders=[];var a={},i=!1;(e[0].match(Un)||[]).forEach(function(o){var u=St(o);switch(ts(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},u.diagonalUp&&(a.diagonalUp=Sr(u.diagonalUp)),u.diagonalDown&&(a.diagonalDown=Sr(u.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+u[0]+" in borders")}})}function tH(e,t,r,n){t.Fills=[];var a={},i=!1;(e[0].match(Un)||[]).forEach(function(o){var u=St(o);switch(ts(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":u.patternType&&(a.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),u.indexed&&(a.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(a.bgColor.theme=parseInt(u.theme,10)),u.tint&&(a.bgColor.tint=parseFloat(u.tint)),u.rgb&&(a.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),u.theme&&(a.fgColor.theme=parseInt(u.theme,10)),u.tint&&(a.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(a.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+u[0]+" in fills")}})}function rH(e,t,r,n){t.Fonts=[];var a={},i=!1;(e[0].match(Un)||[]).forEach(function(o){var u=St(o);switch(ts(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":u.val&&(a.name=vr(u.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=u.val?Sr(u.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=u.val?Sr(u.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(u.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=u.val?Sr(u.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=u.val?Sr(u.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=u.val?Sr(u.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=u.val?Sr(u.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=u.val?Sr(u.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":u.val&&(a.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(a.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(a.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(a.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=Gb[parseInt(u.val,10)];break;case"<color":if(a.color||(a.color={}),u.auto&&(a.color.auto=Sr(u.auto)),u.rgb)a.color.rgb=u.rgb.slice(-6);else if(u.indexed){a.color.index=parseInt(u.indexed,10);var m=go[a.color.index];a.color.index==81&&(m=go[1]),m||(m=go[1]),a.color.rgb=m[0].toString(16)+m[1].toString(16)+m[2].toString(16)}else u.theme&&(a.color.theme=parseInt(u.theme,10),u.tint&&(a.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=Xh(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+u[0]+" in fonts")}})}function nH(e,t,r){t.NumberFmt=[];for(var n=kl(Tt),a=0;a<n.length;++a)t.NumberFmt[n[a]]=Tt[n[a]];var i=e[0].match(Un);if(i)for(a=0;a<i.length;++a){var o=St(i[a]);switch(ts(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=Gt(vr(o.formatCode)),m=parseInt(o.numFmtId,10);if(t.NumberFmt[m]=u,m>0){if(m>392){for(m=392;m>60&&t.NumberFmt[m]!=null;--m);t.NumberFmt[m]=u}vo(u,m)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}var lh=["numFmtId","fillId","fontId","borderId","xfId"],oh=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function aH(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(Un)||[]).forEach(function(i){var o=St(i),u=0;switch(ts(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],u=0;u<lh.length;++u)n[lh[u]]&&(n[lh[u]]=parseInt(n[lh[u]],10));for(u=0;u<oh.length;++u)n[oh[u]]&&(n[oh[u]]=Sr(n[oh[u]]));if(t.NumberFmt&&n.numFmtId>392){for(u=392;u>60;--u)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[u]){n.numFmtId=u;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var m={};o.vertical&&(m.vertical=o.vertical),o.horizontal&&(m.horizontal=o.horizontal),o.textRotation!=null&&(m.textRotation=o.textRotation),o.indent&&(m.indent=o.indent),o.wrapText&&(m.wrapText=Sr(o.wrapText)),n.alignment=m;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}var iH=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,m,f){var h={};if(!u)return h;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var x;return(x=u.match(t))&&nH(x,h,f),(x=u.match(a))&&rH(x,h,m,f),(x=u.match(n))&&tH(x,h,m,f),(x=u.match(i))&&eH(x,h,m,f),(x=u.match(r))&&aH(x,h,f),h}}();function sH(e,t){var r=e.read_shift(2),n=Ln(e);return[r,n]}function lH(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=vU(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var u=e.read_shift(1);u>0&&(n.family=u);var m=e.read_shift(1);switch(m>0&&(n.charset=m),e.l++,n.color=xU(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ln(e),n}var oH=Bn;function cH(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}var uH=Bn;function dH(e,t,r){var n={};n.NumberFmt=[];for(var a in Tt)n.NumberFmt[a]=Tt[a];n.CellXf=[],n.Fonts=[];var i=[],o=!1;return Is(e,function(m,f,h){switch(h){case 44:n.NumberFmt[m[0]]=m[1],vo(m[1],m[0]);break;case 43:n.Fonts.push(m),m.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(m.color.rgb=Xh(t.themeElements.clrScheme[m.color.theme].rgb,m.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(m);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(h),o=!0;break;case 38:i.pop(),o=!1;break;default:if(f.T>0)i.push(h);else if(f.T<0)i.pop();else if(!o||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+h.toString(16))}}),n}var fH=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function hH(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Un)||[]).forEach(function(a){var i=St(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[fH.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function mH(){}function pH(){}var xH=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,vH=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,gH=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function yH(e,t,r){t.themeElements={};var n;[["clrScheme",xH,hH],["fontScheme",vH,mH],["fmtScheme",gH,pH]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var bH=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function v5(e,t){(!e||e.length===0)&&(e=wH());var r,n={};if(!(r=e.match(bH)))throw new Error("themeElements not found in theme");return yH(r[0],n,t),n.raw=e,n}function wH(e,t){var r=[_O];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function SH(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var o;try{o=AO(i,{type:"array"})}catch{return}var u=Ca(o,"theme/theme/theme1.xml",!0);if(u)return v5(u,r)}}function jH(e){return e.read_shift(4)}function NH(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=EH(e,4);break;case 2:t.xclrValue=n5(e);break;case 3:t.xclrValue=jH(e);break;case 4:e.l+=4;break}return e.l+=8,t}function EH(e,t){return Bn(e,t)}function AH(e,t){return Bn(e,t)}function _H(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=NH(e);break;case 6:n[1]=AH(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function TH(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),i=[];a-- >0;)i.push(_H(e,r-e.l));return{ixfe:n,ext:i}}function kH(e,t){t.forEach(function(r){r[0]})}function CH(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ln(e)}}function OH(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function DH(e){return e.l+=4,e.read_shift(4)!=0}function PH(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],o=!1,u=2;return Is(e,function(m,f,h){switch(h){case 335:n.Types.push({name:m.name});break;case 51:m.forEach(function(x){u==1?n.Cell.push({type:n.Types[x[0]-1].name,index:x[1]}):u==0&&n.Value.push({type:n.Types[x[0]-1].name,index:x[1]})});break;case 337:u=m?1:0;break;case 338:u=2;break;case 35:i.push(h),o=!0;break;case 36:i.pop(),o=!1;break;default:if(!f.T){if(!o||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}}),n}function RH(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,i=2,o;return e.replace(Un,function(u){var m=St(u);switch(ts(m[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:m.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<n.Types.length;++f)n.Types[f].name==m.name&&(o=n.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[m.t-1].name,index:+m.v}):i==0&&n.Value.push({type:n.Types[m.t-1].name,index:+m.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+m.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+m[0]+" in metadata")}return u}),n}function MH(e){var t=[];if(!e)return t;var r=1;return(e.match(Un)||[]).forEach(function(n){var a=St(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function FH(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ft(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function IH(e,t,r){var n=[];return Is(e,function(i,o,u){switch(u){case 63:n.push(i);break;default:if(!o.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function LH(e,t,r,n){if(!e)return e;var a=n||{},i=!1;Is(e,function(u,m,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!m.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},a)}function BH(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function y_(e,t,r,n){var a=Array.isArray(e),i;t.forEach(function(o){var u=Ti(o.ref);if(a?(e[u.r]||(e[u.r]=[]),i=e[u.r][u.c]):i=e[o.ref],!i){i={t:"z"},a?e[u.r][u.c]=i:e[o.ref]=i;var m=pn(e["!ref"]||"BDWGO1000001:A1");m.s.r>u.r&&(m.s.r=u.r),m.e.r<u.r&&(m.e.r=u.r),m.s.c>u.c&&(m.s.c=u.c),m.e.c<u.c&&(m.e.c=u.c);var f=sr(m);f!==e["!ref"]&&(e["!ref"]=f)}i.c||(i.c=[]);var h={a:o.author,t:o.t,r:o.r,T:r};o.h&&(h.h=o.h);for(var x=i.c.length-1;x>=0;--x){if(!r&&i.c[x].T)return;r&&!i.c[x].T&&i.c.splice(x,1)}if(r&&n){for(x=0;x<n.length;++x)if(h.a==n[x].id){h.a=n[x].name||h.a;break}}i.c.push(h)})}function UH(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var u=o.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var u=o.match(/<(?:\w+:)?comment[^>]*>/);if(u){var m=St(u[0]),f={author:m.authorId&&r[m.authorId]||"sheetjsghost",ref:m.ref,guid:m.guid},h=Ti(m.ref);if(!(t.sheetRows&&t.sheetRows<=h.r)){var x=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),v=!!x&&!!x[1]&&o2(x[1])||{r:"",t:"",h:""};f.r=v.r,v.r=="<t></t>"&&(v.t=v.h=""),f.t=(v.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(f.h=v.h),n.push(f)}}}}),n}function $H(e,t){var r=[],n=!1,a={},i=0;return e.replace(Un,function(u,m){var f=St(u);switch(ts(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":i=m+u.length;break;case"</text>":a.t=e.slice(i,m).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return u}),r}function zH(e,t){var r=[],n=!1;return e.replace(Un,function(i){var o=St(i);switch(ts(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),r}function HH(e){var t={};t.iauthor=e.read_shift(4);var r=Mo(e);return t.rfx=r.s,t.ref=Ft(r.s),e.l+=16,t}var qH=Ln;function VH(e,t){var r=[],n=[],a={},i=!1;return Is(e,function(u,m,f){switch(f){case 632:n.push(u);break;case 635:a=u;break;case 637:a.t=u.t,a.h=u.h,a.r=u.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!m.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),r}var KH="application/vnd.ms-office.vbaProject";function GH(e){var t=Ht.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ht.utils.cfb_add(t,a,e.FileIndex[n].content)}}),Ht.write(t)}function WH(){return{"!type":"dialog"}}function XH(){return{"!type":"dialog"}}function YH(){return{"!type":"macro"}}function ZH(){return{"!type":"macro"}}var Rc=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,o){var u=!1,m=!1;i.length==0?m=!0:i.charAt(0)=="["&&(m=!0,i=i.slice(1,-1)),o.length==0?u=!0:o.charAt(0)=="["&&(u=!0,o=o.slice(1,-1));var f=i.length>0?parseInt(i,10)|0:0,h=o.length>0?parseInt(o,10)|0:0;return u?h+=t.c:--h,m?f+=t.r:--f,a+(u?"":"$")+Wn(h)+(m?"":"$")+Da(f)}return function(a,i){return t=i,a.replace(e,r)}}(),g5=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,QH=function(){return function(t,r){return t.replace(g5,function(n,a,i,o,u,m){var f=VO(o)-(i?0:r.c),h=qO(m)-(u?0:r.r),x=h==0?"":u?h+1:"["+h+"]",v=f==0?"":i?f+1:"["+f+"]";return a+"R"+x+"C"+v})}}();function y5(e,t){return e.replace(g5,function(r,n,a,i,o,u){return n+(a=="$"?a+i:Wn(VO(i)+t.c))+(o=="$"?o+u:Da(qO(u)+t.r))})}function JH(e,t,r){var n=r2(t),a=n.s,i=Ti(r),o={r:i.r-a.r,c:i.c-a.c};return y5(e,o)}function eq(e){return e.length!=1}function b_(e){return e.replace(/_xlfn\./g,"")}function zr(e){e.l+=1}function Cl(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function b5(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return w5(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),o=Cl(e),u=Cl(e);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:u[0],cRel:u[1],rRel:u[2]}}}function w5(e){var t=Cl(e),r=Cl(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function tq(e,t,r){if(r.biff<8)return w5(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=Cl(e),o=Cl(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function S5(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return rq(e);var n=e.read_shift(r&&r.biff==12?4:2),a=Cl(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function rq(e){var t=Cl(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function nq(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function aq(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return iq(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),o=(i&16384)>>14,u=(i&32768)>>15;if(i&=16383,u==1)for(;a>524287;)a-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:o,rRel:u}}function iq(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function sq(e,t,r){var n=(e[e.l++]&96)>>5,a=b5(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function lq(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var o=b5(e,i,r);return[n,a,o]}function oq(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function cq(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function uq(e,t,r){var n=(e[e.l++]&96)>>5,a=tq(e,t-1,r);return[n,a]}function dq(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function w_(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function fq(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function hq(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function mq(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function pq(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function xq(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function j5(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function vq(e){return e.read_shift(2),j5(e)}function gq(e){return e.read_shift(2),j5(e)}function yq(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=S5(e,0,r);return[n,a]}function bq(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=aq(e,0,r);return[n,a]}function wq(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=S5(e,0,r);return[n,a,i]}function Sq(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[jV[a],A5[a],n]}function jq(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Nq(e);return[a,(i[0]===0?A5:SV)[i[1]]]}function Nq(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Eq(e,t,r){e.l+=r&&r.biff==2?3:4}function Aq(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function _q(e){return e.l++,Fo[e.read_shift(1)]}function Tq(e){return e.l++,e.read_shift(2)}function kq(e){return e.l++,e.read_shift(1)!==0}function Cq(e){return e.l++,Fn(e)}function Oq(e,t,r){return e.l++,bf(e,t-1,r)}function Dq(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Lr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Fo[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Fn(e);break;case 2:r[1]=Io(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Pq(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?Mo:Jm)(e));return a}function Rq(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,o=[];i!=n&&(o[i]=[]);++i)for(var u=0;u!=a;++u)o[i][u]=Dq(e,r.biff);return o}function Mq(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function Fq(e,t,r){if(r.biff==5)return Iq(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function Iq(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function Lq(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function Bq(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function Uq(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function $q(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var zq=Bn,Hq=Bn,qq=Bn;function Sf(e,t,r){return e.l+=2,[nq(e)]}function u2(e){return e.l+=6,[]}var Vq=Sf,Kq=u2,Gq=u2,Wq=Sf;function N5(e){return e.l+=2,[Vr(e),e.read_shift(2)&1]}var Xq=Sf,Yq=N5,Zq=u2,Qq=Sf,Jq=Sf,eV=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function tV(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),o=eV[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:a,C:i}}function rV(e){return e.l+=2,[e.read_shift(4)]}function nV(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function aV(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function iV(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function sV(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function lV(e){return e.l+=4,[0,0]}var S_={1:{n:"PtgExp",f:Aq},2:{n:"PtgTbl",f:qq},3:{n:"PtgAdd",f:zr},4:{n:"PtgSub",f:zr},5:{n:"PtgMul",f:zr},6:{n:"PtgDiv",f:zr},7:{n:"PtgPower",f:zr},8:{n:"PtgConcat",f:zr},9:{n:"PtgLt",f:zr},10:{n:"PtgLe",f:zr},11:{n:"PtgEq",f:zr},12:{n:"PtgGe",f:zr},13:{n:"PtgGt",f:zr},14:{n:"PtgNe",f:zr},15:{n:"PtgIsect",f:zr},16:{n:"PtgUnion",f:zr},17:{n:"PtgRange",f:zr},18:{n:"PtgUplus",f:zr},19:{n:"PtgUminus",f:zr},20:{n:"PtgPercent",f:zr},21:{n:"PtgParen",f:zr},22:{n:"PtgMissArg",f:zr},23:{n:"PtgStr",f:Oq},26:{n:"PtgSheet",f:nV},27:{n:"PtgEndSheet",f:aV},28:{n:"PtgErr",f:_q},29:{n:"PtgBool",f:kq},30:{n:"PtgInt",f:Tq},31:{n:"PtgNum",f:Cq},32:{n:"PtgArray",f:dq},33:{n:"PtgFunc",f:Sq},34:{n:"PtgFuncVar",f:jq},35:{n:"PtgName",f:Mq},36:{n:"PtgRef",f:yq},37:{n:"PtgArea",f:sq},38:{n:"PtgMemArea",f:Lq},39:{n:"PtgMemErr",f:zq},40:{n:"PtgMemNoMem",f:Hq},41:{n:"PtgMemFunc",f:Bq},42:{n:"PtgRefErr",f:Uq},43:{n:"PtgAreaErr",f:oq},44:{n:"PtgRefN",f:bq},45:{n:"PtgAreaN",f:uq},46:{n:"PtgMemAreaN",f:iV},47:{n:"PtgMemNoMemN",f:sV},57:{n:"PtgNameX",f:Fq},58:{n:"PtgRef3d",f:wq},59:{n:"PtgArea3d",f:lq},60:{n:"PtgRefErr3d",f:$q},61:{n:"PtgAreaErr3d",f:cq},255:{}},oV={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},cV={1:{n:"PtgElfLel",f:N5},2:{n:"PtgElfRw",f:Qq},3:{n:"PtgElfCol",f:Vq},6:{n:"PtgElfRwV",f:Jq},7:{n:"PtgElfColV",f:Wq},10:{n:"PtgElfRadical",f:Xq},11:{n:"PtgElfRadicalS",f:Zq},13:{n:"PtgElfColS",f:Kq},15:{n:"PtgElfColSV",f:Gq},16:{n:"PtgElfRadicalLel",f:Yq},25:{n:"PtgList",f:tV},29:{n:"PtgSxName",f:rV},255:{}},uV={0:{n:"PtgAttrNoop",f:lV},1:{n:"PtgAttrSemi",f:xq},2:{n:"PtgAttrIf",f:mq},4:{n:"PtgAttrChoose",f:fq},8:{n:"PtgAttrGoto",f:hq},16:{n:"PtgAttrSum",f:Eq},32:{n:"PtgAttrBaxcel",f:w_},33:{n:"PtgAttrBaxcel",f:w_},64:{n:"PtgAttrSpace",f:vq},65:{n:"PtgAttrSpaceSemi",f:gq},128:{n:"PtgAttrIfError",f:pq},255:{}};function jf(e,t,r,n){if(n.biff<8)return Bn(e,t);for(var a=e.l+t,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=Rq(e,0,n),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=Pq(e,r[o][1],n),i.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=a-e.l,t!==0&&i.push(Bn(e,t)),i}function Nf(e,t,r){for(var n=e.l+t,a,i,o=[];n!=e.l;)t=n-e.l,i=e[e.l],a=S_[i]||S_[oV[i]],(i===24||i===25)&&(a=(i===24?cV:uV)[e[e.l+1]]),!a||!a.f?Bn(e,t):o.push([a.n,a.f(e,t,r)]);return o}function dV(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var o=n[i];if(o)switch(o[0]){case 2:a.push('"'+o[1].replace(/"/g,'""')+'"');break;default:a.push(o[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var fV={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function hV(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function E5(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function j_(e,t,r){var n=E5(e,t,r);return n=="#REF"?n:hV(n,r)}function Dn(e,t,r,n,a){var i=a&&a.biff||8,o={s:{c:0,r:0}},u=[],m,f,h,x=0,v=0,y,w="";if(!e[0]||!e[0][0])return"";for(var b=-1,S="",N=0,_=e[0].length;N<_;++N){var A=e[0][N];switch(A[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(m=u.pop(),f=u.pop(),b>=0){switch(e[0][b][1][0]){case 0:S=Dr(" ",e[0][b][1][1]);break;case 1:S=Dr("\r",e[0][b][1][1]);break;default:if(S="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][b][1][0])}f=f+S,b=-1}u.push(f+fV[A[0]]+m);break;case"PtgIsect":m=u.pop(),f=u.pop(),u.push(f+" "+m);break;case"PtgUnion":m=u.pop(),f=u.pop(),u.push(f+","+m);break;case"PtgRange":m=u.pop(),f=u.pop(),u.push(f+":"+m);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=Od(A[1][1],o,a),u.push(Dd(h,i));break;case"PtgRefN":h=r?Od(A[1][1],r,a):A[1][1],u.push(Dd(h,i));break;case"PtgRef3d":x=A[1][1],h=Od(A[1][2],o,a),w=j_(n,x,a),u.push(w+"!"+Dd(h,i));break;case"PtgFunc":case"PtgFuncVar":var k=A[1][0],C=A[1][1];k||(k=0),k&=127;var O=k==0?[]:u.slice(-k);u.length-=k,C==="User"&&(C=O.shift()),u.push(C+"("+O.join(",")+")");break;case"PtgBool":u.push(A[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(A[1]);break;case"PtgNum":u.push(String(A[1]));break;case"PtgStr":u.push('"'+A[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(A[1]);break;case"PtgAreaN":y=n_(A[1][1],r?{s:r}:o,a),u.push(mg(y,a));break;case"PtgArea":y=n_(A[1][1],o,a),u.push(mg(y,a));break;case"PtgArea3d":x=A[1][1],y=A[1][2],w=j_(n,x,a),u.push(w+"!"+mg(y,a));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":v=A[1][2];var T=(n.names||[])[v-1]||(n[0]||[])[v],z=T?T.Name:"SH33TJSNAME"+String(v);z&&z.slice(0,6)=="_xlfn."&&!a.xlfn&&(z=z.slice(6)),u.push(z);break;case"PtgNameX":var P=A[1][1];v=A[1][2];var Z;if(a.biff<=5)P<0&&(P=-P),n[P]&&(Z=n[P][v]);else{var q="";if(((n[P]||[])[0]||[])[0]==14849||(((n[P]||[])[0]||[])[0]==1025?n[P][v]&&n[P][v].itab>0&&(q=n.SheetNames[n[P][v].itab-1]+"!"):q=n.SheetNames[v-1]+"!"),n[P]&&n[P][v])q+=n[P][v].Name;else if(n[0]&&n[0][v])q+=n[0][v].Name;else{var B=(E5(n,P,a)||"").split(";;");B[v-1]?q=B[v-1]:q+="SH33TJSERRX"}u.push(q);break}Z||(Z={Name:"SH33TJSERRY"}),u.push(Z.Name);break;case"PtgParen":var fe="(",Ne=")";if(b>=0){switch(S="",e[0][b][1][0]){case 2:fe=Dr(" ",e[0][b][1][1])+fe;break;case 3:fe=Dr("\r",e[0][b][1][1])+fe;break;case 4:Ne=Dr(" ",e[0][b][1][1])+Ne;break;case 5:Ne=Dr("\r",e[0][b][1][1])+Ne;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][b][1][0])}b=-1}u.push(fe+u.pop()+Ne);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":h={c:A[1][1],r:A[1][0]};var he={c:r.c,r:r.r};if(n.sharedf[Ft(h)]){var K=n.sharedf[Ft(h)];u.push(Dn(K,o,he,n,a))}else{var H=!1;for(m=0;m!=n.arrayf.length;++m)if(f=n.arrayf[m],!(h.c<f[0].s.c||h.c>f[0].e.c)&&!(h.r<f[0].s.r||h.r>f[0].e.r)){u.push(Dn(f[1],o,he,n,a)),H=!0;break}H||u.push(A[1])}break;case"PtgArray":u.push("{"+dV(A[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":b=N;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+A[1].idx+"[#"+A[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(A));default:throw new Error("Unrecognized Formula Token: "+String(A))}var be=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&b>=0&&be.indexOf(e[0][N][0])==-1){A=e[0][b];var te=!0;switch(A[1][0]){case 4:te=!1;case 0:S=Dr(" ",A[1][1]);break;case 5:te=!1;case 1:S=Dr("\r",A[1][1]);break;default:if(S="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+A[1][0])}u.push((te?S:"")+u.pop()+(te?"":S)),b=-1}}if(u.length>1&&a.WTF)throw new Error("bad formula stack");return u[0]}function mV(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,o=e.read_shift(a);if(o==65535)return[[],Bn(e,t-2)];var u=Nf(e,o,r);return t!==o+a&&(i=jf(e,t-o-a,u,r)),e.l=n,[u,i]}function pV(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,o=e.read_shift(a);if(o==65535)return[[],Bn(e,t-2)];var u=Nf(e,o,r);return t!==o+a&&(i=jf(e,t-o-a,u,r)),e.l=n,[u,i]}function xV(e,t,r,n){var a=e.l+t,i=Nf(e,n,r),o;return a!==e.l&&(o=jf(e,a-e.l,i,r)),[i,o]}function vV(e,t,r){var n=e.l+t,a,i=e.read_shift(2),o=Nf(e,i,r);return i==65535?[[],Bn(e,t-2)]:(t!==i+2&&(a=jf(e,n-i-2,o,r)),[o,a])}function gV(e){var t;if(Ss(e,e.l+6)!==65535)return[Fn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function vg(e,t,r){var n=e.l+t,a=rs(e);r.biff==2&&++e.l;var i=gV(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var u=pV(e,n-e.l,r);return{cell:a,val:i[0],formula:u,shared:o>>3&1,tt:i[1]}}function ep(e,t,r){var n=e.read_shift(4),a=Nf(e,n,r),i=e.read_shift(4),o=i>0?jf(e,i,a,r):null;return[a,o]}var yV=ep,tp=ep,bV=ep,wV=ep,SV={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},A5={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},jV={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function N_(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function gg(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Fd={},Mc={};function Id(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function _5(e,t,r,n,a,i){try{n.cellNF&&(e.z=Tt[t])}catch(u){if(n.WTF)throw u}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Nn(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Tt[t]==null&&vo(A9[t]||"General",t),e.t==="e")e.w=e.w||Fo[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Gd(e.v);else if(e.t==="d"){var o=Ma(e.v);(o|0)===o?e.w=o.toString(10):e.w=Gd(o)}else{if(e.v===void 0)return"";e.w=No(e.v,Mc)}else e.t==="d"?e.w=oi(t,Ma(e.v),Mc):e.w=oi(t,e.v,Mc)}catch(u){if(n.WTF)throw u}if(n.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Xh(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Xh(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(u){if(n.WTF&&i.Fills)throw u}}}function NV(e,t){var r=pn(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=sr(r))}var EV=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,AV=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,_V=/<(?:\w:)?hyperlink [^>]*>/mg,TV=/"(\w*:\w*)"/,kV=/<(?:\w:)?col\b[^>]*[\/]?>/g,CV=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,OV=/<(?:\w:)?pageMargins[^>]*\/>/g,T5=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,DV=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,PV=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function RV(e,t,r,n,a,i,o){if(!e)return e;n||(n={"!id":{}});var u=t.dense?[]:{},m={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",h="",x=e.match(AV);x?(f=e.slice(0,x.index),h=e.slice(x.index+x[0].length)):f=h=e;var v=f.match(T5);v?d2(v[0],u,a,r):(v=f.match(DV))&&MV(v[0],v[1]||"",u,a,r);var y=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(y>0){var w=f.slice(y,y+50).match(TV);w&&NV(u,w[1])}var b=f.match(PV);b&&b[1]&&$V(b[1],a);var S=[];if(t.cellStyles){var N=f.match(kV);N&&LV(S,N)}x&&zV(x[1],u,t,m,i,o);var _=h.match(CV);_&&(u["!autofilter"]=BV(_[0]));var A=[],k=h.match(EV);if(k)for(y=0;y!=k.length;++y)A[y]=pn(k[y].slice(k[y].indexOf('"')+1));var C=h.match(_V);C&&FV(u,C,n);var O=h.match(OV);if(O&&(u["!margins"]=IV(St(O[0]))),!u["!ref"]&&m.e.c>=m.s.c&&m.e.r>=m.s.r&&(u["!ref"]=sr(m)),t.sheetRows>0&&u["!ref"]){var T=pn(u["!ref"]);t.sheetRows<=+T.e.r&&(T.e.r=t.sheetRows-1,T.e.r>m.e.r&&(T.e.r=m.e.r),T.e.r<T.s.r&&(T.s.r=T.e.r),T.e.c>m.e.c&&(T.e.c=m.e.c),T.e.c<T.s.c&&(T.s.c=T.e.c),u["!fullref"]=u["!ref"],u["!ref"]=sr(T))}return S.length>0&&(u["!cols"]=S),A.length>0&&(u["!merges"]=A),u}function d2(e,t,r,n){var a=St(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Gt(vr(a.codeName)))}function MV(e,t,r,n,a){d2(e.slice(0,e.indexOf(">")),r,n,a)}function FV(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var i=St(vr(t[a]),!0);if(!i.ref)return;var o=((r||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+Gt(i.location))):(i.Target="#"+Gt(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var u=pn(i.ref),m=u.s.r;m<=u.e.r;++m)for(var f=u.s.c;f<=u.e.c;++f){var h=Ft({c:f,r:m});n?(e[m]||(e[m]=[]),e[m][f]||(e[m][f]={t:"z",v:void 0}),e[m][f].l=i):(e[h]||(e[h]={t:"z",v:void 0}),e[h].l=i)}}}function IV(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function LV(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=St(t[n],!0);a.hidden&&(a.hidden=Sr(a.hidden));var i=parseInt(a.min,10)-1,o=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,c2(a.width)),Bc(a);i<=o;)e[i++]=En(a)}}function BV(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var UV=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function $V(e,t){t.Views||(t.Views=[{}]),(e.match(UV)||[]).forEach(function(r,n){var a=St(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),Sr(a.rightToLeft)&&(t.Views[n].RTL=!0)})}var zV=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=Xd("v"),o=Xd("f");return function(m,f,h,x,v,y){for(var w=0,b="",S=[],N=[],_=0,A=0,k=0,C="",O,T,z=0,P=0,Z,q,B=0,fe=0,Ne=Array.isArray(y.CellXf),he,K=[],H=[],be=Array.isArray(f),te=[],I={},se=!1,R=!!h.sheetStubs,W=m.split(t),Y=0,Q=W.length;Y!=Q;++Y){b=W[Y].trim();var L=b.length;if(L!==0){var ne=0;e:for(w=0;w<L;++w)switch(b[w]){case">":if(b[w-1]!="/"){++w;break e}if(h&&h.cellStyles){if(T=St(b.slice(ne,w),!0),z=T.r!=null?parseInt(T.r,10):z+1,P=-1,h.sheetRows&&h.sheetRows<z)continue;I={},se=!1,T.ht&&(se=!0,I.hpt=parseFloat(T.ht),I.hpx=Jd(I.hpt)),T.hidden=="1"&&(se=!0,I.hidden=!0),T.outlineLevel!=null&&(se=!0,I.level=+T.outlineLevel),se&&(te[z-1]=I)}break;case"<":ne=w;break}if(ne>=w)break;if(T=St(b.slice(ne,w),!0),z=T.r!=null?parseInt(T.r,10):z+1,P=-1,!(h.sheetRows&&h.sheetRows<z)){x.s.r>z-1&&(x.s.r=z-1),x.e.r<z-1&&(x.e.r=z-1),h&&h.cellStyles&&(I={},se=!1,T.ht&&(se=!0,I.hpt=parseFloat(T.ht),I.hpx=Jd(I.hpt)),T.hidden=="1"&&(se=!0,I.hidden=!0),T.outlineLevel!=null&&(se=!0,I.level=+T.outlineLevel),se&&(te[z-1]=I)),S=b.slice(w).split(e);for(var ge=0;ge!=S.length&&S[ge].trim().charAt(0)=="<";++ge);for(S=S.slice(ge),w=0;w!=S.length;++w)if(b=S[w].trim(),b.length!==0){if(N=b.match(r),_=w,A=0,k=0,b="<c "+(b.slice(0,1)=="<"?">":"")+b,N!=null&&N.length===2){for(_=0,C=N[1],A=0;A!=C.length&&!((k=C.charCodeAt(A)-64)<1||k>26);++A)_=26*_+k;--_,P=_}else++P;for(A=0;A!=b.length&&b.charCodeAt(A)!==62;++A);if(++A,T=St(b.slice(0,A),!0),T.r||(T.r=Ft({r:z-1,c:P})),C=b.slice(A),O={t:""},(N=C.match(i))!=null&&N[1]!==""&&(O.v=Gt(N[1])),h.cellFormula){if((N=C.match(o))!=null&&N[1]!==""){if(O.f=Gt(vr(N[1])).replace(/\r\n/g,`
`),h.xlfn||(O.f=b_(O.f)),N[0].indexOf('t="array"')>-1)O.F=(C.match(a)||[])[1],O.F.indexOf(":")>-1&&K.push([pn(O.F),O.F]);else if(N[0].indexOf('t="shared"')>-1){q=St(N[0]);var G=Gt(vr(N[1]));h.xlfn||(G=b_(G)),H[parseInt(q.si,10)]=[q,G,T.r]}}else(N=C.match(/<f[^>]*\/>/))&&(q=St(N[0]),H[q.si]&&(O.f=JH(H[q.si][1],H[q.si][2],T.r)));var ue=Ti(T.r);for(A=0;A<K.length;++A)ue.r>=K[A][0].s.r&&ue.r<=K[A][0].e.r&&ue.c>=K[A][0].s.c&&ue.c<=K[A][0].e.c&&(O.F=K[A][1])}if(T.t==null&&O.v===void 0)if(O.f||O.F)O.v=0,O.t="n";else if(R)O.t="z";else continue;else O.t=T.t||"n";switch(x.s.c>P&&(x.s.c=P),x.e.c<P&&(x.e.c=P),O.t){case"n":if(O.v==""||O.v==null){if(!R)continue;O.t="z"}else O.v=parseFloat(O.v);break;case"s":if(typeof O.v>"u"){if(!R)continue;O.t="z"}else Z=Fd[parseInt(O.v,10)],O.v=Z.t,O.r=Z.r,h.cellHTML&&(O.h=Z.h);break;case"str":O.t="s",O.v=O.v!=null?vr(O.v):"",h.cellHTML&&(O.h=kO(O.v));break;case"inlineStr":N=C.match(n),O.t="s",N!=null&&(Z=o2(N[1]))?(O.v=Z.t,h.cellHTML&&(O.h=Z.h)):O.v="";break;case"b":O.v=Sr(O.v);break;case"d":h.cellDates?O.v=Nn(O.v,1):(O.v=Ma(Nn(O.v,1)),O.t="n");break;case"e":(!h||h.cellText!==!1)&&(O.w=O.v),O.v=XO[O.v];break}if(B=fe=0,he=null,Ne&&T.s!==void 0&&(he=y.CellXf[T.s],he!=null&&(he.numFmtId!=null&&(B=he.numFmtId),h.cellStyles&&he.fillId!=null&&(fe=he.fillId))),_5(O,B,fe,h,v,y),h.cellDates&&Ne&&O.t=="n"&&au(Tt[B])&&(O.t="d",O.v=Qm(O.v)),T.cm&&h.xlmeta){var Se=(h.xlmeta.Cell||[])[+T.cm-1];Se&&Se.type=="XLDAPR"&&(O.D=!0)}if(be){var M=Ti(T.r);f[M.r]||(f[M.r]=[]),f[M.r][M.c]=O}else f[T.r]=O}}}}te.length>0&&(f["!rows"]=te)}}();function HV(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}var qV=Mo;function VV(){}function KV(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=mU(e),r}function GV(e){var t=mi(e);return[t]}function WV(e){var t=Ro(e);return[t]}function XV(e){var t=mi(e),r=e.read_shift(1);return[t,r,"b"]}function YV(e){var t=Ro(e),r=e.read_shift(1);return[t,r,"b"]}function ZV(e){var t=mi(e),r=e.read_shift(1);return[t,r,"e"]}function QV(e){var t=Ro(e),r=e.read_shift(1);return[t,r,"e"]}function JV(e){var t=mi(e),r=e.read_shift(4);return[t,r,"s"]}function eK(e){var t=Ro(e),r=e.read_shift(4);return[t,r,"s"]}function tK(e){var t=mi(e),r=Fn(e);return[t,r,"n"]}function k5(e){var t=Ro(e),r=Fn(e);return[t,r,"n"]}function rK(e){var t=mi(e),r=i2(e);return[t,r,"n"]}function nK(e){var t=Ro(e),r=i2(e);return[t,r,"n"]}function aK(e){var t=mi(e),r=n2(e);return[t,r,"is"]}function iK(e){var t=mi(e),r=Ln(e);return[t,r,"str"]}function sK(e){var t=Ro(e),r=Ln(e);return[t,r,"str"]}function lK(e,t,r){var n=e.l+t,a=mi(e);a.r=r["!row"];var i=e.read_shift(1),o=[a,i,"b"];if(r.cellFormula){e.l+=2;var u=tp(e,n-e.l,r);o[3]=Dn(u,null,a,r.supbooks,r)}else e.l=n;return o}function oK(e,t,r){var n=e.l+t,a=mi(e);a.r=r["!row"];var i=e.read_shift(1),o=[a,i,"e"];if(r.cellFormula){e.l+=2;var u=tp(e,n-e.l,r);o[3]=Dn(u,null,a,r.supbooks,r)}else e.l=n;return o}function cK(e,t,r){var n=e.l+t,a=mi(e);a.r=r["!row"];var i=Fn(e),o=[a,i,"n"];if(r.cellFormula){e.l+=2;var u=tp(e,n-e.l,r);o[3]=Dn(u,null,a,r.supbooks,r)}else e.l=n;return o}function uK(e,t,r){var n=e.l+t,a=mi(e);a.r=r["!row"];var i=Ln(e),o=[a,i,"str"];if(r.cellFormula){e.l+=2;var u=tp(e,n-e.l,r);o[3]=Dn(u,null,a,r.supbooks,r)}else e.l=n;return o}var dK=Mo;function fK(e,t){var r=e.l+t,n=Mo(e),a=a2(e),i=Ln(e),o=Ln(e),u=Ln(e);e.l=r;var m={rfx:n,relId:a,loc:i,display:u};return o&&(m.Tooltip=o),m}function hK(){}function mK(e,t,r){var n=e.l+t,a=KO(e),i=e.read_shift(1),o=[a];if(o[2]=i,r.cellFormula){var u=yV(e,n-e.l,r);o[1]=u}else e.l=n;return o}function pK(e,t,r){var n=e.l+t,a=Mo(e),i=[a];if(r.cellFormula){var o=wV(e,n-e.l,r);i[1]=o,e.l=n}else e.l=n;return i}var xK=["left","right","top","bottom","header","footer"];function vK(e){var t={};return xK.forEach(function(r){t[r]=Fn(e)}),t}function gK(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function yK(){}function bK(){}function wK(e,t,r,n,a,i,o){if(!e)return e;var u=t||{};n||(n={"!id":{}});var m=u.dense?[]:{},f,h={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=!1,v=!1,y,w,b,S,N,_,A,k,C,O=[];u.biff=12,u["!row"]=0;var T=0,z=!1,P=[],Z={},q=u.supbooks||a.supbooks||[[]];if(q.sharedf=Z,q.arrayf=P,q.SheetNames=a.SheetNames||a.Sheets.map(function(be){return be.name}),!u.supbooks&&(u.supbooks=q,a.Names))for(var B=0;B<a.Names.length;++B)q[0][B+1]=a.Names[B];var fe=[],Ne=[],he=!1;Qh[16]={n:"BrtShortReal",f:k5};var K;if(Is(e,function(te,I,se){if(!v)switch(se){case 148:f=te;break;case 0:y=te,u.sheetRows&&u.sheetRows<=y.r&&(v=!0),k=Da(S=y.r),u["!row"]=y.r,(te.hidden||te.hpt||te.level!=null)&&(te.hpt&&(te.hpx=Jd(te.hpt)),Ne[te.r]=te);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(w={t:te[2]},te[2]){case"n":w.v=te[1];break;case"s":A=Fd[te[1]],w.v=A.t,w.r=A.r;break;case"b":w.v=!!te[1];break;case"e":w.v=te[1],u.cellText!==!1&&(w.w=Fo[w.v]);break;case"str":w.t="s",w.v=te[1];break;case"is":w.t="s",w.v=te[1].t;break}if((b=o.CellXf[te[0].iStyleRef])&&_5(w,b.numFmtId,null,u,i,o),N=te[0].c==-1?N+1:te[0].c,u.dense?(m[S]||(m[S]=[]),m[S][N]=w):m[Wn(N)+k]=w,u.cellFormula){for(z=!1,T=0;T<P.length;++T){var R=P[T];y.r>=R[0].s.r&&y.r<=R[0].e.r&&N>=R[0].s.c&&N<=R[0].e.c&&(w.F=sr(R[0]),z=!0)}!z&&te.length>3&&(w.f=te[3])}if(h.s.r>y.r&&(h.s.r=y.r),h.s.c>N&&(h.s.c=N),h.e.r<y.r&&(h.e.r=y.r),h.e.c<N&&(h.e.c=N),u.cellDates&&b&&w.t=="n"&&au(Tt[b.numFmtId])){var W=co(w.v);W&&(w.t="d",w.v=new Date(W.y,W.m-1,W.d,W.H,W.M,W.S,W.u))}K&&(K.type=="XLDAPR"&&(w.D=!0),K=void 0);break;case 1:case 12:if(!u.sheetStubs||x)break;w={t:"z",v:void 0},N=te[0].c==-1?N+1:te[0].c,u.dense?(m[S]||(m[S]=[]),m[S][N]=w):m[Wn(N)+k]=w,h.s.r>y.r&&(h.s.r=y.r),h.s.c>N&&(h.s.c=N),h.e.r<y.r&&(h.e.r=y.r),h.e.c<N&&(h.e.c=N),K&&(K.type=="XLDAPR"&&(w.D=!0),K=void 0);break;case 176:O.push(te);break;case 49:K=((u.xlmeta||{}).Cell||[])[te-1];break;case 494:var Y=n["!id"][te.relId];for(Y?(te.Target=Y.Target,te.loc&&(te.Target+="#"+te.loc),te.Rel=Y):te.relId==""&&(te.Target="#"+te.loc),S=te.rfx.s.r;S<=te.rfx.e.r;++S)for(N=te.rfx.s.c;N<=te.rfx.e.c;++N)u.dense?(m[S]||(m[S]=[]),m[S][N]||(m[S][N]={t:"z",v:void 0}),m[S][N].l=te):(_=Ft({c:N,r:S}),m[_]||(m[_]={t:"z",v:void 0}),m[_].l=te);break;case 426:if(!u.cellFormula)break;P.push(te),C=u.dense?m[S][N]:m[Wn(N)+k],C.f=Dn(te[1],h,{r:y.r,c:N},q,u),C.F=sr(te[0]);break;case 427:if(!u.cellFormula)break;Z[Ft(te[0].s)]=te[1],C=u.dense?m[S][N]:m[Wn(N)+k],C.f=Dn(te[1],h,{r:y.r,c:N},q,u);break;case 60:if(!u.cellStyles)break;for(;te.e>=te.s;)fe[te.e--]={width:te.w/256,hidden:!!(te.flags&1),level:te.level},he||(he=!0,c2(te.w/256)),Bc(fe[te.e+1]);break;case 161:m["!autofilter"]={ref:sr(te)};break;case 476:m["!margins"]=te;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),te.name&&(a.Sheets[r].CodeName=te.name),(te.above||te.left)&&(m["!outline"]={above:te.above,left:te.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),te.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:x=!0;break;case 36:x=!1;break;case 37:x=!0;break;case 38:x=!1;break;default:if(!I.T){if(!x||u.WTF)throw new Error("Unexpected record 0x"+se.toString(16))}}},u),delete u.supbooks,delete u["!row"],!m["!ref"]&&(h.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(m["!ref"]=sr(f||h)),u.sheetRows&&m["!ref"]){var H=pn(m["!ref"]);u.sheetRows<=+H.e.r&&(H.e.r=u.sheetRows-1,H.e.r>h.e.r&&(H.e.r=h.e.r),H.e.r<H.s.r&&(H.s.r=H.e.r),H.e.c>h.e.c&&(H.e.c=h.e.c),H.e.c<H.s.c&&(H.s.c=H.e.c),m["!fullref"]=m["!ref"],m["!ref"]=sr(H))}return O.length>0&&(m["!merges"]=O),fe.length>0&&(m["!cols"]=fe),Ne.length>0&&(m["!rows"]=Ne),m}function SK(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var o=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var a=Gt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[t,a,n]}function jK(e,t,r,n,a,i){var o=i||{"!type":"chart"};if(!e)return i;var u=0,m=0,f="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(x){var v=SK(x);h.s.r=h.s.c=0,h.e.c=u,f=Wn(u),v[0].forEach(function(y,w){o[f+Da(w)]={t:"n",v:y,z:v[1]},m=w}),h.e.r<m&&(h.e.r=m),++u}),u>0&&(o["!ref"]=sr(h)),o}function NK(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o,u=e.match(T5);return u&&d2(u[0],i,a,r),(o=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function EK(e,t){e.l+=10;var r=Ln(e);return{name:r}}function AK(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Is(e,function(m,f,h){switch(h){case 550:i["!rel"]=m;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),m.name&&(a.Sheets[r].CodeName=m.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var C5=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],_K=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],TK=[],kK=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function E_(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var i=t[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=Sr(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function A_(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Sr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function O5(e){A_(e.WBProps,C5),A_(e.CalcPr,kK),E_(e.WBView,_K),E_(e.Sheets,TK),Mc.date1904=Sr(e.WBProps.date1904)}var CK="][*?/\\".split("");function OK(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return CK.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var DK=/<\w+:workbook/;function PK(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},o=0;if(e.replace(Un,function(m,f){var h=St(m);switch(ts(h[0])){case"<?xml":break;case"<workbook":m.match(DK)&&(a="xmlns"+m.match(/<(\w+):/)[1]),r.xmlns=h[a];break;case"</workbook>":break;case"<fileVersion":delete h[0],r.AppVersion=h;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":C5.forEach(function(x){if(h[x[0]]!=null)switch(x[2]){case"bool":r.WBProps[x[0]]=Sr(h[x[0]]);break;case"int":r.WBProps[x[0]]=parseInt(h[x[0]],10);break;default:r.WBProps[x[0]]=h[x[0]]}}),h.codeName&&(r.WBProps.CodeName=vr(h.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete h[0],r.WBView.push(h);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=Gt(vr(h.name)),delete h[0],r.Sheets.push(h);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=vr(h.name),h.comment&&(i.Comment=h.comment),h.localSheetId&&(i.Sheet=+h.localSheetId),Sr(h.hidden||"0")&&(i.Hidden=!0),o=f+m.length;break;case"</definedName>":i.Ref=Gt(vr(e.slice(o,f))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete h[0],r.CalcPr=h;break;case"<calcPr/>":delete h[0],r.CalcPr=h;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return m}),Z9.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return O5(r),r}function RK(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Ny(e),r.name=Ln(e),r}function MK(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Ln(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function FK(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function IK(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=pU(e),o=bV(e,0,r),u=a2(e);e.l=n;var m={Name:i,Ptg:o};return a<268435455&&(m.Sheet=a),u&&(m.Comment=u),m}function LK(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],Qh[16]={n:"BrtFRTArchID$",f:FK},Is(e,function(m,f,h){switch(h){case 156:o.SheetNames.push(m.name),r.Sheets.push(m);break;case 153:r.WBProps=m;break;case 39:m.Sheet!=null&&(t.SID=m.Sheet),m.Ref=Dn(m.Ptg,null,null,o,t),delete t.SID,delete m.Ptg,i.push(m);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([h,m]):o[0]=[h,m],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(m),o.XTI=o.XTI.concat(m);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(h),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(h),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!f.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}},t),O5(r),r.Names=i,r.supbooks=o,r}function BK(e,t,r){return t.slice(-4)===".bin"?LK(e,r):PK(e,r)}function UK(e,t,r,n,a,i,o,u){return t.slice(-4)===".bin"?wK(e,n,r,a,i,o,u):RV(e,n,r,a,i,o,u)}function $K(e,t,r,n,a,i,o,u){return t.slice(-4)===".bin"?AK(e,n,r,a,i):NK(e,n,r,a,i)}function zK(e,t,r,n,a,i,o,u){return t.slice(-4)===".bin"?YH():ZH()}function HK(e,t,r,n,a,i,o,u){return t.slice(-4)===".bin"?WH():XH()}function qK(e,t,r,n){return t.slice(-4)===".bin"?dH(e,r,n):iH(e,r,n)}function VK(e,t,r){return v5(e,r)}function KK(e,t,r){return t.slice(-4)===".bin"?_z(e,r):Ez(e,r)}function GK(e,t,r){return t.slice(-4)===".bin"?VH(e,r):UH(e,r)}function WK(e,t,r){return t.slice(-4)===".bin"?IH(e):MH(e)}function XK(e,t,r,n){return r.slice(-4)===".bin"?LH(e,t,r,n):void 0}function YK(e,t,r){return t.slice(-4)===".bin"?PH(e,t,r):RH(e,t,r)}var D5=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,P5=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function bi(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(D5),i,o,u,m;if(a)for(m=0;m!=a.length;++m)i=a[m].match(P5),(o=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?u="xmlns"+i[1].slice(6):u=i[1].slice(o+1),n[u]=i[2].slice(1,i[2].length-1));return n}function ZK(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(D5),a,i,o,u;if(n)for(u=0;u!=n.length;++u)a=n[u].match(P5),(i=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),r[o]=a[2].slice(1,a[2].length-1));return r}var Ld;function QK(e,t){var r=Ld[e]||Gt(e);return r==="General"?No(t):oi(r,t)}function JK(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Sr(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Nn(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Gt(t)]=a}function eG(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Fo[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Gd(e.v):e.w=No(e.v):e.w=QK(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var n=Ld[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&au(n)){var a=co(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(r.WTF)throw i}}}function tG(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=Jz[n.Pattern]||n.Pattern)}e[t.ID]=t}function rG(e,t,r,n,a,i,o,u,m,f){var h="General",x=n.StyleID,v={};f=f||{};var y=[],w=0;for(x===void 0&&u&&(x=u.StyleID),x===void 0&&o&&(x=o.StyleID);i[x]!==void 0&&(i[x].nf&&(h=i[x].nf),i[x].Interior&&y.push(i[x].Interior),!!i[x].Parent);)x=i[x].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Sr(e);break;case"String":n.t="s",n.r=WA(Gt(e)),n.v=e.indexOf("<")>-1?Gt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Nn(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Gt(e):n.v<60&&(n.v=n.v-1),(!h||h=="General")&&(h="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=XO[e],f.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=WA(t||e));break}if(eG(n,h,f),f.cellFormula!==!1)if(n.Formula){var b=Gt(n.Formula);b.charCodeAt(0)==61&&(b=b.slice(1)),n.f=Rc(b,a),delete n.Formula,n.ArrayRange=="RC"?n.F=Rc("RC:RC",a):n.ArrayRange&&(n.F=Rc(n.ArrayRange,a),m.push([pn(n.F),n.F]))}else for(w=0;w<m.length;++w)a.r>=m[w][0].s.r&&a.r<=m[w][0].e.r&&a.c>=m[w][0].s.c&&a.c<=m[w][0].e.c&&(n.F=m[w][1]);f.cellStyles&&(y.forEach(function(S){!v.patternType&&S.patternType&&(v.patternType=S.patternType)}),n.s=v),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function nG(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function yg(e,t){var r=t||{};bO();var n=Sd(e2(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=vr(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var o=En(r);return o.type="string",Zd.to_workbook(n,o)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ke){a.indexOf("<"+ke)>=0&&(i=!0)}),i)return cG(n,r);Ld={"General Number":"General","General Date":Tt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Tt[15],"Short Date":Tt[14],"Long Time":Tt[19],"Medium Time":Tt[18],"Short Time":Tt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Tt[2],Standard:Tt[4],Percent:Tt[10],Scientific:Tt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,m=[],f,h={},x=[],v=r.dense?[]:{},y="",w={},b={},S=bi('<Data ss:Type="String">'),N=0,_=0,A=0,k={s:{r:2e6,c:2e6},e:{r:0,c:0}},C={},O={},T="",z=0,P=[],Z={},q={},B=0,fe=[],Ne=[],he={},K=[],H,be=!1,te=[],I=[],se={},R=0,W=0,Y={Sheets:[],WBProps:{date1904:!1}},Q={};Yd.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var L="";u=Yd.exec(n);)switch(u[3]=(L=u[3]).toLowerCase()){case"data":if(L=="data"){if(u[1]==="/"){if((f=m.pop())[0]!==u[3])throw new Error("Bad state: "+f.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&m.push([u[3],!0]);break}if(m[m.length-1][1])break;u[1]==="/"?rG(n.slice(N,u.index),T,S,m[m.length-1][0]=="comment"?he:w,{c:_,r:A},C,K[_],b,te,r):(T="",S=bi(u[0]),N=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(Ne.length>0&&(w.c=Ne),(!r.sheetRows||r.sheetRows>A)&&w.v!==void 0&&(r.dense?(v[A]||(v[A]=[]),v[A][_]=w):v[Wn(_)+Da(A)]=w),w.HRef&&(w.l={Target:Gt(w.HRef)},w.HRefScreenTip&&(w.l.Tooltip=w.HRefScreenTip),delete w.HRef,delete w.HRefScreenTip),(w.MergeAcross||w.MergeDown)&&(R=_+(parseInt(w.MergeAcross,10)|0),W=A+(parseInt(w.MergeDown,10)|0),P.push({s:{c:_,r:A},e:{c:R,r:W}})),!r.sheetStubs)w.MergeAcross?_=R+1:++_;else if(w.MergeAcross||w.MergeDown){for(var ne=_;ne<=R;++ne)for(var ge=A;ge<=W;++ge)(ne>_||ge>A)&&(r.dense?(v[ge]||(v[ge]=[]),v[ge][ne]={t:"z"}):v[Wn(ne)+Da(ge)]={t:"z"});_=R+1}else++_;else w=ZK(u[0]),w.Index&&(_=+w.Index-1),_<k.s.c&&(k.s.c=_),_>k.e.c&&(k.e.c=_),u[0].slice(-2)==="/>"&&++_,Ne=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(A<k.s.r&&(k.s.r=A),A>k.e.r&&(k.e.r=A),u[0].slice(-2)==="/>"&&(b=bi(u[0]),b.Index&&(A=+b.Index-1)),_=0,++A):(b=bi(u[0]),b.Index&&(A=+b.Index-1),se={},(b.AutoFitHeight=="0"||b.Height)&&(se.hpx=parseInt(b.Height,10),se.hpt=x5(se.hpx),I[A]=se),b.Hidden=="1"&&(se.hidden=!0,I[A]=se));break;case"worksheet":if(u[1]==="/"){if((f=m.pop())[0]!==u[3])throw new Error("Bad state: "+f.join("|"));x.push(y),k.s.r<=k.e.r&&k.s.c<=k.e.c&&(v["!ref"]=sr(k),r.sheetRows&&r.sheetRows<=k.e.r&&(v["!fullref"]=v["!ref"],k.e.r=r.sheetRows-1,v["!ref"]=sr(k))),P.length&&(v["!merges"]=P),K.length>0&&(v["!cols"]=K),I.length>0&&(v["!rows"]=I),h[y]=v}else k={s:{r:2e6,c:2e6},e:{r:0,c:0}},A=_=0,m.push([u[3],!1]),f=bi(u[0]),y=Gt(f.Name),v=r.dense?[]:{},P=[],te=[],I=[],Q={name:y,Hidden:0},Y.Sheets.push(Q);break;case"table":if(u[1]==="/"){if((f=m.pop())[0]!==u[3])throw new Error("Bad state: "+f.join("|"))}else{if(u[0].slice(-2)=="/>")break;m.push([u[3],!1]),K=[],be=!1}break;case"style":u[1]==="/"?tG(C,O,r):O=bi(u[0]);break;case"numberformat":O.nf=Gt(bi(u[0]).Format||"General"),Ld[O.nf]&&(O.nf=Ld[O.nf]);for(var G=0;G!=392&&Tt[G]!=O.nf;++G);if(G==392){for(G=57;G!=392;++G)if(Tt[G]==null){vo(O.nf,G);break}}break;case"column":if(m[m.length-1][0]!=="table")break;if(H=bi(u[0]),H.Hidden&&(H.hidden=!0,delete H.Hidden),H.Width&&(H.wpx=parseInt(H.Width,10)),!be&&H.wpx>10){be=!0,Gn=m5;for(var ue=0;ue<K.length;++ue)K[ue]&&Bc(K[ue])}be&&Bc(H),K[H.Index-1||K.length]=H;for(var Se=0;Se<+H.Span;++Se)K[K.length]=En(H);break;case"namedrange":if(u[1]==="/")break;Y.Names||(Y.Names=[]);var M=St(u[0]),Qe={Name:M.Name,Ref:Rc(M.RefersTo.slice(1),{r:0,c:0})};Y.Sheets.length>0&&(Qe.Sheet=Y.Sheets.length-1),Y.Names.push(Qe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?T+=n.slice(z,u.index):z=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;O.Interior=bi(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?UU(Z,L,n.slice(B,u.index)):B=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((f=m.pop())[0]!==u[3])throw new Error("Bad state: "+f.join("|"))}else m.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((f=m.pop())[0]!==u[3])throw new Error("Bad state: "+f.join("|"));nG(he),Ne.push(he)}else m.push([u[3],!1]),f=bi(u[0]),he={a:f.Author};break;case"autofilter":if(u[1]==="/"){if((f=m.pop())[0]!==u[3])throw new Error("Bad state: "+f.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var xe=bi(u[0]);v["!autofilter"]={ref:Rc(xe.Range).replace(/\$/g,"")},m.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((f=m.pop())[0]!==u[3])throw new Error("Bad state: "+f.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&m.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((f=m.pop())[0]!==u[3])throw new Error("Bad state: "+f.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&m.push([u[3],!0]);break;case"null":break;default:if(m.length==0&&u[3]=="document"||m.length==0&&u[3]=="uof")return O_(n,r);var me=!0;switch(m[m.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:me=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:me=!1}break;case"excelworkbook":switch(u[3]){case"date1904":Y.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:me=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:me=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(n.slice(B,u.index)){case"SheetHidden":Q.Hidden=1;break;case"SheetVeryHidden":Q.Hidden=2;break}else B=u.index+u[0].length;break;case"header":v["!margins"]||Id(v["!margins"]={},"xlml"),isNaN(+St(u[0]).Margin)||(v["!margins"].header=+St(u[0]).Margin);break;case"footer":v["!margins"]||Id(v["!margins"]={},"xlml"),isNaN(+St(u[0]).Margin)||(v["!margins"].footer=+St(u[0]).Margin);break;case"pagemargins":var ze=St(u[0]);v["!margins"]||Id(v["!margins"]={},"xlml"),isNaN(+ze.Top)||(v["!margins"].top=+ze.Top),isNaN(+ze.Left)||(v["!margins"].left=+ze.Left),isNaN(+ze.Right)||(v["!margins"].right=+ze.Right),isNaN(+ze.Bottom)||(v["!margins"].bottom=+ze.Bottom);break;case"displayrighttoleft":Y.Views||(Y.Views=[]),Y.Views[0]||(Y.Views[0]={}),Y.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:me=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:me=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:me=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:me=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:me=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:me=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:me=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:me=!1}break;case"smarttags":break;default:me=!1;break}if(me||u[3].match(/!\[CDATA/))break;if(!m[m.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+m.join("|");if(m[m.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?JK(q,L,fe,n.slice(B,u.index)):(fe=u,B=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+m.join("|")}var oe={};return!r.bookSheets&&!r.bookProps&&(oe.Sheets=h),oe.SheetNames=x,oe.Workbook=Y,oe.SSF=En(Tt),oe.Props=Z,oe.Custprops=q,oe}function Ty(e,t){switch(m2(t=t||{}),t.type||"base64"){case"base64":return yg(Ra(e),t);case"binary":case"buffer":case"file":return yg(e,t);case"array":return yg(Do(e),t)}}function aG(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=gU(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=yU(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var iG=[60,1084,2066,2165,2175];function sG(e,t,r,n,a){var i=n,o=[],u=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&u.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(u)}o.push(u),r.l+=i;for(var m=Ss(r,r.l),f=ky[m],h=0;f!=null&&iG.indexOf(m)>-1;)i=Ss(r,r.l+2),h=r.l+4,m==2066?h+=4:(m==2165||m==2175)&&(h+=12),u=r.slice(h,r.l+4+i),o.push(u),r.l+=4+i,f=ky[m=Ss(r,r.l)];var x=bl(o);jn(x,0);var v=0;x.lens=[];for(var y=0;y<o.length;++y)x.lens.push(v),v+=o[y].length;if(x.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+x.length+" < "+n;return t.f(x,x.length,a)}function zi(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Tt[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Fo[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Gd(e.v):e.w=No(e.v):e.w=oi(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&e.t=="n"&&au(Tt[n]||String(n))){var a=co(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function ch(e,t,r){return{v:e,ixfe:t,t:r}}function lG(e,t){var r={opts:{}},n={},a=t.dense?[]:{},i={},o={},u=null,m=[],f="",h={},x,v="",y,w,b,S,N={},_=[],A,k,C=[],O=[],T={Sheets:[],WBProps:{date1904:!1},Views:[{}]},z={},P=function(de){return de<8?go[de]:de<64&&O[de-8]||go[de]},Z=function(de,Ce,st){var nt=Ce.XF.data;if(!(!nt||!nt.patternType||!st||!st.cellStyles)){Ce.s={},Ce.s.patternType=nt.patternType;var gt;(gt=Qd(P(nt.icvFore)))&&(Ce.s.fgColor={rgb:gt}),(gt=Qd(P(nt.icvBack)))&&(Ce.s.bgColor={rgb:gt})}},q=function(de,Ce,st){if(!(se>1)&&!(st.sheetRows&&de.r>=st.sheetRows)){if(st.cellStyles&&Ce.XF&&Ce.XF.data&&Z(de,Ce,st),delete Ce.ixfe,delete Ce.XF,x=de,v=Ft(de),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),de.r<o.s.r&&(o.s.r=de.r),de.c<o.s.c&&(o.s.c=de.c),de.r+1>o.e.r&&(o.e.r=de.r+1),de.c+1>o.e.c&&(o.e.c=de.c+1),st.cellFormula&&Ce.f){for(var nt=0;nt<_.length;++nt)if(!(_[nt][0].s.c>de.c||_[nt][0].s.r>de.r)&&!(_[nt][0].e.c<de.c||_[nt][0].e.r<de.r)){Ce.F=sr(_[nt][0]),(_[nt][0].s.c!=de.c||_[nt][0].s.r!=de.r)&&delete Ce.f,Ce.f&&(Ce.f=""+Dn(_[nt][1],o,de,te,B));break}}st.dense?(a[de.r]||(a[de.r]=[]),a[de.r][de.c]=Ce):a[v]=Ce}},B={enc:!1,sbcch:0,snames:[],sharedf:N,arrayf:_,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(B.password=t.password);var fe,Ne=[],he=[],K=[],H=[],be=!1,te=[];te.SheetNames=B.snames,te.sharedf=B.sharedf,te.arrayf=B.arrayf,te.names=[],te.XTI=[];var I=0,se=0,R=0,W=[],Y=[],Q;B.codepage=1200,Ai(1200);for(var L=!1;e.l<e.length-1;){var ne=e.l,ge=e.read_shift(2);if(ge===0&&I===10)break;var G=e.l===e.length?0:e.read_shift(2),ue=ky[ge];if(ue&&ue.f){if(t.bookSheets&&I===133&&ge!==133)break;if(I=ge,ue.r===2||ue.r==12){var Se=e.read_shift(2);if(G-=2,!B.enc&&Se!==ge&&((Se&255)<<8|Se>>8)!==ge)throw new Error("rt mismatch: "+Se+"!="+ge);ue.r==12&&(e.l+=10,G-=10)}var M={};if(ge===10?M=ue.f(e,G,B):M=sG(ge,ue,e,G,B),se==0&&[9,521,1033,2057].indexOf(I)===-1)continue;switch(ge){case 34:r.opts.Date1904=T.WBProps.date1904=M;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(B.enc||(e.l=0),B.enc=M,!t.password)throw new Error("File is password-protected");if(M.valid==null)throw new Error("Encryption scheme unsupported");if(!M.valid)throw new Error("Password is incorrect");break;case 92:B.lastuser=M;break;case 66:var Qe=Number(M);switch(Qe){case 21010:Qe=1200;break;case 32768:Qe=1e4;break;case 32769:Qe=1252;break}Ai(B.codepage=Qe),L=!0;break;case 317:B.rrtabid=M;break;case 25:B.winlocked=M;break;case 439:r.opts.RefreshAll=M;break;case 12:r.opts.CalcCount=M;break;case 16:r.opts.CalcDelta=M;break;case 17:r.opts.CalcIter=M;break;case 13:r.opts.CalcMode=M;break;case 14:r.opts.CalcPrecision=M;break;case 95:r.opts.CalcSaveRecalc=M;break;case 15:B.CalcRefMode=M;break;case 2211:r.opts.FullCalc=M;break;case 129:M.fDialog&&(a["!type"]="dialog"),M.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),M.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:C.push(M);break;case 430:te.push([M]),te[te.length-1].XTI=[];break;case 35:case 547:te[te.length-1].push(M);break;case 24:case 536:Q={Name:M.Name,Ref:Dn(M.rgce,o,null,te,B)},M.itab>0&&(Q.Sheet=M.itab-1),te.names.push(Q),te[0]||(te[0]=[],te[0].XTI=[]),te[te.length-1].push(M),M.Name=="_xlnm._FilterDatabase"&&M.itab>0&&M.rgce&&M.rgce[0]&&M.rgce[0][0]&&M.rgce[0][0][0]=="PtgArea3d"&&(Y[M.itab-1]={ref:sr(M.rgce[0][0][1][2])});break;case 22:B.ExternCount=M;break;case 23:te.length==0&&(te[0]=[],te[0].XTI=[]),te[te.length-1].XTI=te[te.length-1].XTI.concat(M),te.XTI=te.XTI.concat(M);break;case 2196:if(B.biff<8)break;Q!=null&&(Q.Comment=M[1]);break;case 18:a["!protect"]=M;break;case 19:M!==0&&B.WTF&&console.error("Password verifier: "+M);break;case 133:i[M.pos]=M,B.snames.push(M.name);break;case 10:{if(--se)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,a["!ref"]=sr(o),t.sheetRows&&t.sheetRows<=o.e.r){var xe=o.e.r;o.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=sr(o),o.e.r=xe}o.e.r++,o.e.c++}Ne.length>0&&(a["!merges"]=Ne),he.length>0&&(a["!objects"]=he),K.length>0&&(a["!cols"]=K),H.length>0&&(a["!rows"]=H),T.Sheets.push(z)}f===""?h=a:n[f]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(B.biff===8&&(B.biff={9:2,521:3,1033:4}[ge]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[M.BIFFVer]||8),B.biffguess=M.BIFFVer==0,M.BIFFVer==0&&M.dt==4096&&(B.biff=5,L=!0,Ai(B.codepage=28591)),B.biff==8&&M.BIFFVer==0&&M.dt==16&&(B.biff=2),se++)break;if(a=t.dense?[]:{},B.biff<8&&!L&&(L=!0,Ai(B.codepage=t.codepage||1252)),B.biff<5||M.BIFFVer==0&&M.dt==4096){f===""&&(f="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var me={pos:e.l-G,name:f};i[me.pos]=me,B.snames.push(f)}else f=(i[ne]||{name:""}).name;M.dt==32&&(a["!type"]="chart"),M.dt==64&&(a["!type"]="macro"),Ne=[],he=[],B.arrayf=_=[],K=[],H=[],be=!1,z={Hidden:(i[ne]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[M.r]||[])[M.c]:a[Ft({c:M.c,r:M.r})])&&++M.c,A={ixfe:M.ixfe,XF:C[M.ixfe]||{},v:M.val,t:"n"},R>0&&(A.z=W[A.ixfe>>8&63]),zi(A,t,r.opts.Date1904),q({c:M.c,r:M.r},A,t);break;case 5:case 517:A={ixfe:M.ixfe,XF:C[M.ixfe],v:M.val,t:M.t},R>0&&(A.z=W[A.ixfe>>8&63]),zi(A,t,r.opts.Date1904),q({c:M.c,r:M.r},A,t);break;case 638:A={ixfe:M.ixfe,XF:C[M.ixfe],v:M.rknum,t:"n"},R>0&&(A.z=W[A.ixfe>>8&63]),zi(A,t,r.opts.Date1904),q({c:M.c,r:M.r},A,t);break;case 189:for(var ze=M.c;ze<=M.C;++ze){var oe=M.rkrec[ze-M.c][0];A={ixfe:oe,XF:C[oe],v:M.rkrec[ze-M.c][1],t:"n"},R>0&&(A.z=W[A.ixfe>>8&63]),zi(A,t,r.opts.Date1904),q({c:ze,r:M.r},A,t)}break;case 6:case 518:case 1030:{if(M.val=="String"){u=M;break}if(A=ch(M.val,M.cell.ixfe,M.tt),A.XF=C[A.ixfe],t.cellFormula){var ke=M.formula;if(ke&&ke[0]&&ke[0][0]&&ke[0][0][0]=="PtgExp"){var Ge=ke[0][0][1][0],Fe=ke[0][0][1][1],Be=Ft({r:Ge,c:Fe});N[Be]?A.f=""+Dn(M.formula,o,M.cell,te,B):A.F=((t.dense?(a[Ge]||[])[Fe]:a[Be])||{}).F}else A.f=""+Dn(M.formula,o,M.cell,te,B)}R>0&&(A.z=W[A.ixfe>>8&63]),zi(A,t,r.opts.Date1904),q(M.cell,A,t),u=M}break;case 7:case 519:if(u)u.val=M,A=ch(M,u.cell.ixfe,"s"),A.XF=C[A.ixfe],t.cellFormula&&(A.f=""+Dn(u.formula,o,u.cell,te,B)),R>0&&(A.z=W[A.ixfe>>8&63]),zi(A,t,r.opts.Date1904),q(u.cell,A,t),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{_.push(M);var xt=Ft(M[0].s);if(y=t.dense?(a[M[0].s.r]||[])[M[0].s.c]:a[xt],t.cellFormula&&y){if(!u||!xt||!y)break;y.f=""+Dn(M[1],o,M[0],te,B),y.F=sr(M[0])}}break;case 1212:{if(!t.cellFormula)break;if(v){if(!u)break;N[Ft(u.cell)]=M[0],y=t.dense?(a[u.cell.r]||[])[u.cell.c]:a[Ft(u.cell)],(y||{}).f=""+Dn(M[0],o,x,te,B)}}break;case 253:A=ch(m[M.isst].t,M.ixfe,"s"),m[M.isst].h&&(A.h=m[M.isst].h),A.XF=C[A.ixfe],R>0&&(A.z=W[A.ixfe>>8&63]),zi(A,t,r.opts.Date1904),q({c:M.c,r:M.r},A,t);break;case 513:t.sheetStubs&&(A={ixfe:M.ixfe,XF:C[M.ixfe],t:"z"},R>0&&(A.z=W[A.ixfe>>8&63]),zi(A,t,r.opts.Date1904),q({c:M.c,r:M.r},A,t));break;case 190:if(t.sheetStubs)for(var Ze=M.c;Ze<=M.C;++Ze){var ht=M.ixfe[Ze-M.c];A={ixfe:ht,XF:C[ht],t:"z"},R>0&&(A.z=W[A.ixfe>>8&63]),zi(A,t,r.opts.Date1904),q({c:Ze,r:M.r},A,t)}break;case 214:case 516:case 4:A=ch(M.val,M.ixfe,"s"),A.XF=C[A.ixfe],R>0&&(A.z=W[A.ixfe>>8&63]),zi(A,t,r.opts.Date1904),q({c:M.c,r:M.r},A,t);break;case 0:case 512:se===1&&(o=M);break;case 252:m=M;break;case 1054:if(B.biff==4){W[R++]=M[1];for(var At=0;At<R+163&&Tt[At]!=M[1];++At);At>=163&&vo(M[1],R+163)}else vo(M[1],M[0]);break;case 30:{W[R++]=M;for(var De=0;De<R+163&&Tt[De]!=M;++De);De>=163&&vo(M,R+163)}break;case 229:Ne=Ne.concat(M);break;case 93:he[M.cmo[0]]=B.lastobj=M;break;case 438:B.lastobj.TxO=M;break;case 127:B.lastobj.ImData=M;break;case 440:for(S=M[0].s.r;S<=M[0].e.r;++S)for(b=M[0].s.c;b<=M[0].e.c;++b)y=t.dense?(a[S]||[])[b]:a[Ft({c:b,r:S})],y&&(y.l=M[1]);break;case 2048:for(S=M[0].s.r;S<=M[0].e.r;++S)for(b=M[0].s.c;b<=M[0].e.c;++b)y=t.dense?(a[S]||[])[b]:a[Ft({c:b,r:S})],y&&y.l&&(y.l.Tooltip=M[1]);break;case 28:{if(B.biff<=5&&B.biff>=2)break;y=t.dense?(a[M[0].r]||[])[M[0].c]:a[Ft(M[0])];var Xe=he[M[2]];y||(t.dense?(a[M[0].r]||(a[M[0].r]=[]),y=a[M[0].r][M[0].c]={t:"z"}):y=a[Ft(M[0])]={t:"z"},o.e.r=Math.max(o.e.r,M[0].r),o.s.r=Math.min(o.s.r,M[0].r),o.e.c=Math.max(o.e.c,M[0].c),o.s.c=Math.min(o.s.c,M[0].c)),y.c||(y.c=[]),w={a:M[1],t:Xe.TxO.t},y.c.push(w)}break;case 2173:kH(C[M.ixfe],M.ext);break;case 125:{if(!B.cellStyles)break;for(;M.e>=M.s;)K[M.e--]={width:M.w/256,level:M.level||0,hidden:!!(M.flags&1)},be||(be=!0,c2(M.w/256)),Bc(K[M.e+1])}break;case 520:{var at={};M.level!=null&&(H[M.r]=at,at.level=M.level),M.hidden&&(H[M.r]=at,at.hidden=!0),M.hpt&&(H[M.r]=at,at.hpt=M.hpt,at.hpx=Jd(M.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Id(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ge]]=M;break;case 161:a["!margins"]||Id(a["!margins"]={}),a["!margins"].header=M.header,a["!margins"].footer=M.footer;break;case 574:M.RTL&&(T.Views[0].RTL=!0);break;case 146:O=M;break;case 2198:fe=M;break;case 140:k=M;break;case 442:f?z.CodeName=M||z.name:T.WBProps.CodeName=M||"ThisWorkbook";break}}else ue||console.error("Missing Info for XLS Record 0x"+ge.toString(16)),e.l+=G}return r.SheetNames=kl(i).sort(function(rt,de){return Number(rt)-Number(de)}).map(function(rt){return i[rt].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&h["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=h)):r.Preamble=h,r.Sheets&&Y.forEach(function(rt,de){r.Sheets[r.SheetNames[de]]["!autofilter"]=rt}),r.Strings=m,r.SSF=En(Tt),B.enc&&(r.Encryption=B.enc),fe&&(r.Themes=fe),r.Metadata={},k!==void 0&&(r.Metadata.Country=k),te.names.length>0&&(T.Names=te.names),r.Workbook=T,r}var __={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function oG(e,t,r){var n=Ht.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=u_(n,EU,__.DSI);for(var i in a)t[i]=a[i]}catch(f){if(r.WTF)throw f}var o=Ht.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var u=u_(o,AU,__.SI);for(var m in u)t[m]==null&&(t[m]=u[m])}catch(f){if(r.WTF)throw f}t.HeadingPairs&&t.TitlesOfParts&&(ZO(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function R5(e,t){t||(t={}),m2(t),oO(),t.codepage&&Wb(t.codepage);var r,n;if(e.FullPaths){if(Ht.find(e,"/encryption"))throw new Error("File is password-protected");r=Ht.find(e,"!CompObj"),n=Ht.find(e,"/Workbook")||Ht.find(e,"/Book")}else{switch(t.type){case"base64":e=ji(Ra(e));break;case"binary":e=ji(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}jn(e,0),n={content:e}}var a,i;if(r&&aG(r),t.bookProps&&!t.bookSheets)a={};else{var o=Ut?"buffer":"array";if(n&&n.content)a=lG(n.content,t);else if((i=Ht.find(e,"PerfectOffice_MAIN"))&&i.content)a=Md.to_workbook(i.content,(t.type=o,t));else if((i=Ht.find(e,"NativeContent_MAIN"))&&i.content)a=Md.to_workbook(i.content,(t.type=o,t));else throw(i=Ht.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Ht.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=GH(e))}var u={};return e.FullPaths&&oG(e,u,t),a.Props=a.Custprops=u,t.bookFiles&&(a.cfb=e),a}var Qh={0:{f:HV},1:{f:GV},2:{f:rK},3:{f:ZV},4:{f:XV},5:{f:tK},6:{f:iK},7:{f:JV},8:{f:uK},9:{f:cK},10:{f:lK},11:{f:oK},12:{f:WV},13:{f:nK},14:{f:QV},15:{f:YV},16:{f:k5},17:{f:sK},18:{f:eK},19:{f:n2},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:IK},40:{},42:{},43:{f:lH},44:{f:sH},45:{f:oH},46:{f:uH},47:{f:cH},48:{},49:{f:dU},50:{},51:{f:OH},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:c5},62:{f:aK},63:{f:FH},64:{f:yK},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Bn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:gK},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:KV},148:{f:qV,p:16},151:{f:hK},152:{},153:{f:MK},154:{},155:{},156:{f:RK},157:{},158:{},159:{T:1,f:Az},160:{T:-1},161:{T:1,f:Mo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:dK},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:CH},336:{T:-1},337:{f:DH,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Ny},357:{},358:{},359:{},360:{T:1},361:{},362:{f:o5},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:mK},427:{f:pK},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:vK},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:VV},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:fK},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Ny},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:qH},633:{T:1},634:{T:-1},635:{T:1,f:HH},636:{T:-1},637:{f:hU},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:EK},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:bK},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},ky={6:{f:vg},10:{f:ml},12:{f:Vr},13:{f:Vr},14:{f:Lr},15:{f:Lr},16:{f:Fn},17:{f:Lr},18:{f:Lr},19:{f:Vr},20:{f:m_},21:{f:m_},23:{f:o5},24:{f:x_},25:{f:Lr},26:{},27:{},28:{f:$$},29:{},34:{f:Lr},35:{f:p_},38:{f:Fn},39:{f:Fn},40:{f:Fn},41:{f:Fn},42:{f:Lr},43:{f:Lr},47:{f:Vz},49:{f:S$},51:{f:Vr},60:{},61:{f:y$},64:{f:Lr},65:{f:w$},66:{f:Vr},77:{},80:{},81:{},82:{},85:{f:Vr},89:{},90:{},91:{},92:{f:d$},93:{f:H$},94:{},95:{f:Lr},96:{},97:{},99:{f:Lr},125:{f:c5},128:{f:D$},129:{f:f$},130:{f:Vr},131:{f:Lr},132:{f:Lr},133:{f:h$},134:{},140:{f:X$},141:{f:Vr},144:{},146:{f:Z$},151:{},152:{},153:{},154:{},155:{},156:{f:Vr},157:{},158:{},160:{f:rz},161:{f:J$},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:T$},190:{f:k$},193:{f:ml},197:{},198:{},199:{},200:{},201:{},202:{f:Lr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Vr},220:{},221:{f:Lr},222:{},224:{f:O$},225:{f:u$},226:{f:ml},227:{},229:{f:z$},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:m$},253:{f:j$},255:{f:p$},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:r5},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Lr},353:{f:ml},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:R$},431:{f:Lr},432:{},433:{},434:{},437:{},438:{f:K$},439:{f:Lr},440:{f:G$},441:{},442:{f:wf},443:{},444:{f:Vr},445:{},446:{},448:{f:ml},449:{f:g$,r:2},450:{f:ml},512:{f:f_},513:{f:tz},515:{f:P$},516:{f:N$},517:{f:h_},519:{f:nz},520:{f:x$},523:{},545:{f:v_},549:{f:d_},566:{},574:{f:b$},638:{f:_$},659:{},1048:{},1054:{f:E$},1084:{},1212:{f:L$},2048:{f:W$},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:sh},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ml},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Q$,r:12},2173:{f:TH,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Lr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:I$,r:12},2197:{},2198:{f:SH,r:12},2199:{},2200:{},2201:{},2202:{f:B$,r:12},2203:{f:ml},2204:{},2205:{},2206:{},2207:{},2211:{f:v$},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Vr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:ez},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Y$},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:f_},1:{},2:{f:lz},3:{f:sz},4:{f:iz},5:{f:h_},7:{f:oz},8:{},9:{f:sh},11:{},22:{f:Vr},30:{f:A$},31:{},32:{},33:{f:v_},36:{},37:{f:d_},50:{f:cz},62:{},52:{},67:{},68:{f:Vr},69:{},86:{},126:{},127:{f:az},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:uz},223:{},234:{},354:{},421:{},518:{f:vg},521:{f:sh},536:{f:x_},547:{f:p_},561:{},579:{},1030:{f:vg},1033:{f:sh},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function wi(e,t,r,n){var a=t;if(!isNaN(a)){var i=(r||[]).length||0,o=e.next(4);o.write_shift(2,a),o.write_shift(2,i),i>0&&zO(r)&&e.push(r)}}function T_(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),o=a.index,u=i&&i.index||e.length,m=M9(e.slice(o,u),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,h=0,x=0,v=0,y={s:{r:1e7,c:1e7},e:{r:0,c:0}},w=[];for(o=0;o<m.length;++o){var b=m[o].trim(),S=b.slice(0,3).toLowerCase();if(S=="<tr"){if(++f,r.sheetRows&&r.sheetRows<=f){--f;break}h=0;continue}if(!(S!="<td"&&S!="<th")){var N=b.split(/<\/t[dh]>/i);for(u=0;u<N.length;++u){var _=N[u].trim();if(_.match(/<t[dh]/i)){for(var A=_,k=0;A.charAt(0)=="<"&&(k=A.indexOf(">"))>-1;)A=A.slice(k+1);for(var C=0;C<w.length;++C){var O=w[C];O.s.c==h&&O.s.r<f&&f<=O.e.r&&(h=O.e.c+1,C=-1)}var T=St(_.slice(0,_.indexOf(">")));v=T.colspan?+T.colspan:1,((x=+T.rowspan)>1||v>1)&&w.push({s:{r:f,c:h},e:{r:f+(x||1)-1,c:h+v-1}});var z=T.t||T["data-t"]||"";if(!A.length){h+=v;continue}if(A=K9(A),y.s.r>f&&(y.s.r=f),y.e.r<f&&(y.e.r=f),y.s.c>h&&(y.s.c=h),y.e.c<h&&(y.e.c=h),!A.length){h+=v;continue}var P={t:"s",v:A};r.raw||!A.trim().length||z=="s"||(A==="TRUE"?P={t:"b",v:!0}:A==="FALSE"?P={t:"b",v:!1}:isNaN(_s(A))?isNaN(Wd(A).getDate())||(P={t:"d",v:Nn(A)},r.cellDates||(P={t:"n",v:Ma(P.v)}),P.z=r.dateNF||Tt[14]):P={t:"n",v:_s(A)}),r.dense?(n[f]||(n[f]=[]),n[f][h]=P):n[Ft({r:f,c:h})]=P,h+=v}}}}return n["!ref"]=sr(y),w.length&&(n["!merges"]=w),n}function cG(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Po(T_(r[0],t),t);var n=I5();return r.forEach(function(a,i){L5(n,T_(a,t),"Sheet"+(i+1))}),n}function uG(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Gt(t.replace(/<[^>]*>/g,""));return[r]}var k_={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function M5(e,t){var r=t||{},n=e2(e),a=[],i,o,u={name:""},m="",f=0,h,x,v={},y=[],w=r.dense?[]:{},b,S,N={value:""},_="",A=0,k=[],C=-1,O=-1,T={s:{r:1e6,c:1e7},e:{r:0,c:0}},z=0,P={},Z=[],q={},B=0,fe=0,Ne=[],he=1,K=1,H=[],be={Names:[]},te={},I=["",""],se=[],R={},W="",Y=0,Q=!1,L=!1,ne=0;for(Yd.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");b=Yd.exec(n);)switch(b[3]=b[3].replace(/_.*$/,"")){case"table":case"":b[1]==="/"?(T.e.c>=T.s.c&&T.e.r>=T.s.r?w["!ref"]=sr(T):w["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=T.e.r&&(w["!fullref"]=w["!ref"],T.e.r=r.sheetRows-1,w["!ref"]=sr(T)),Z.length&&(w["!merges"]=Z),Ne.length&&(w["!rows"]=Ne),h.name=h.||h.name,typeof JSON<"u"&&JSON.stringify(h),y.push(h.name),v[h.name]=w,L=!1):b[0].charAt(b[0].length-2)!=="/"&&(h=St(b[0],!1),C=O=-1,T.s.r=T.s.c=1e7,T.e.r=T.e.c=0,w=r.dense?[]:{},Z=[],Ne=[],L=!0);break;case"table-row-group":b[1]==="/"?--z:++z;break;case"table-row":case"":if(b[1]==="/"){C+=he,he=1;break}if(x=St(b[0],!1),x.?C=x.-1:C==-1&&(C=0),he=+x["number-rows-repeated"]||1,he<10)for(ne=0;ne<he;++ne)z>0&&(Ne[C+ne]={level:z});O=-1;break;case"covered-table-cell":b[1]!=="/"&&++O,r.sheetStubs&&(r.dense?(w[C]||(w[C]=[]),w[C][O]={t:"z"}):w[Ft({r:C,c:O})]={t:"z"}),_="",k=[];break;case"table-cell":case"":if(b[0].charAt(b[0].length-2)==="/")++O,N=St(b[0],!1),K=parseInt(N["number-columns-repeated"]||"1",10),S={t:"z",v:null},N.formula&&r.cellFormula!=!1&&(S.f=N_(Gt(N.formula))),(N.||N["value-type"])=="string"&&(S.t="s",S.v=Gt(N["string-value"]||""),r.dense?(w[C]||(w[C]=[]),w[C][O]=S):w[Ft({r:C,c:O})]=S),O+=K-1;else if(b[1]!=="/"){++O,_="",A=0,k=[],K=1;var ge=he?C+he-1:C;if(O>T.e.c&&(T.e.c=O),O<T.s.c&&(T.s.c=O),C<T.s.r&&(T.s.r=C),ge>T.e.r&&(T.e.r=ge),N=St(b[0],!1),se=[],R={},S={t:N.||N["value-type"],v:null},r.cellFormula)if(N.formula&&(N.formula=Gt(N.formula)),N["number-matrix-columns-spanned"]&&N["number-matrix-rows-spanned"]&&(B=parseInt(N["number-matrix-rows-spanned"],10)||0,fe=parseInt(N["number-matrix-columns-spanned"],10)||0,q={s:{r:C,c:O},e:{r:C+B-1,c:O+fe-1}},S.F=sr(q),H.push([q,S.F])),N.formula)S.f=N_(N.formula);else for(ne=0;ne<H.length;++ne)C>=H[ne][0].s.r&&C<=H[ne][0].e.r&&O>=H[ne][0].s.c&&O<=H[ne][0].e.c&&(S.F=H[ne][1]);switch((N["number-columns-spanned"]||N["number-rows-spanned"])&&(B=parseInt(N["number-rows-spanned"],10)||0,fe=parseInt(N["number-columns-spanned"],10)||0,q={s:{r:C,c:O},e:{r:C+B-1,c:O+fe-1}},Z.push(q)),N["number-columns-repeated"]&&(K=parseInt(N["number-columns-repeated"],10)),S.t){case"boolean":S.t="b",S.v=Sr(N["boolean-value"]);break;case"float":S.t="n",S.v=parseFloat(N.value);break;case"percentage":S.t="n",S.v=parseFloat(N.value);break;case"currency":S.t="n",S.v=parseFloat(N.value);break;case"date":S.t="d",S.v=Nn(N["date-value"]),r.cellDates||(S.t="n",S.v=Ma(S.v)),S.z="m/d/yy";break;case"time":S.t="n",S.v=D9(N["time-value"])/86400,r.cellDates&&(S.t="d",S.v=Qm(S.v)),S.z="HH:MM:SS";break;case"number":S.t="n",S.v=parseFloat(N.);break;default:if(S.t==="string"||S.t==="text"||!S.t)S.t="s",N["string-value"]!=null&&(_=Gt(N["string-value"]),k=[]);else throw new Error("Unsupported value type "+S.t)}}else{if(Q=!1,S.t==="s"&&(S.v=_||"",k.length&&(S.R=k),Q=A==0),te.Target&&(S.l=te),se.length>0&&(S.c=se,se=[]),_&&r.cellText!==!1&&(S.w=_),Q&&(S.t="z",delete S.v),(!Q||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=C))for(var G=0;G<he;++G){if(K=parseInt(N["number-columns-repeated"]||"1",10),r.dense)for(w[C+G]||(w[C+G]=[]),w[C+G][O]=G==0?S:En(S);--K>0;)w[C+G][O+K]=En(S);else for(w[Ft({r:C+G,c:O})]=S;--K>0;)w[Ft({r:C+G,c:O+K})]=En(S);T.e.c<=O&&(T.e.c=O)}K=parseInt(N["number-columns-repeated"]||"1",10),O+=K-1,K=0,S={},_="",k=[]}te={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(b[1]==="/"){if((i=a.pop())[0]!==b[3])throw"Bad state: "+i}else b[0].charAt(b[0].length-2)!=="/"&&a.push([b[3],!0]);break;case"annotation":if(b[1]==="/"){if((i=a.pop())[0]!==b[3])throw"Bad state: "+i;R.t=_,k.length&&(R.R=k),R.a=W,se.push(R)}else b[0].charAt(b[0].length-2)!=="/"&&a.push([b[3],!1]);W="",Y=0,_="",A=0,k=[];break;case"creator":b[1]==="/"?W=n.slice(Y,b.index):Y=b.index+b[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(b[1]==="/"){if((i=a.pop())[0]!==b[3])throw"Bad state: "+i}else b[0].charAt(b[0].length-2)!=="/"&&a.push([b[3],!1]);_="",A=0,k=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(b[1]==="/"){if(P[u.name]=m,(i=a.pop())[0]!==b[3])throw"Bad state: "+i}else b[0].charAt(b[0].length-2)!=="/"&&(m="",u=St(b[0],!1),a.push([b[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":o=St(b[0],!1),m+=k_[b[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":o=St(b[0],!1),m+=k_[b[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(b[0].slice(-2)==="/>")break;if(b[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":m+=n.slice(f,b.index);break}else f=b.index+b[0].length;break;case"named-range":o=St(b[0],!1),I=gg(o["cell-range-address"]);var ue={Name:o.name,Ref:I[0]+"!"+I[1]};L&&(ue.Sheet=y.length),be.Names.push(ue);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(b[1]==="/"&&(!N||!N["string-value"])){var Se=uG(n.slice(A,b.index));_=(_.length>0?_+`
`:"")+Se[0]}else St(b[0],!1),A=b.index+b[0].length;break;case"s":break;case"database-range":if(b[1]==="/")break;try{I=gg(St(b[0])["target-range-address"]),v[I[0]]["!autofilter"]={ref:I[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(b[1]!=="/"){if(te=St(b[0],!1),!te.href)break;te.Target=Gt(te.href),delete te.href,te.Target.charAt(0)=="#"&&te.Target.indexOf(".")>-1?(I=gg(te.Target.slice(1)),te.Target="#"+I[0]+"!"+I[1]):te.Target.match(/^\.\.[\\\/]/)&&(te.Target=te.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(b[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(b)}}var M={Sheets:v,SheetNames:y,Workbook:be};return r.bookSheets&&delete M.Sheets,M}function C_(e,t){t=t||{},ri(e,"META-INF/manifest.xml")&&PU(qr(e,"META-INF/manifest.xml"),t);var r=Ca(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=M5(vr(r),t);return ri(e,"meta.xml")&&(n.Props=YO(qr(e,"meta.xml"))),n}function O_(e,t){return M5(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function f2(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Cy(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):vr(Do(e))}function Oy(e){var t=e.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function D_(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function dG(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function ef(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function rn(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function In(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=ef(e,r),i=a&7;a=Math.floor(a/8);var o=0,u;if(a==0)break;switch(i){case 0:{for(var m=r[0];e[r[0]++]>=128;);u=e.slice(m,r[0])}break;case 5:o=4,u=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,u=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=ef(e,r),u=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var f={data:u,type:i};t[a]==null?t[a]=[f]:t[a].push(f)}return t}function h2(e,t){return e?.map(function(r){return t(r.data)})||[]}function fG(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=ef(e,n),i=In(e.slice(n[0],n[0]+a));n[0]+=a;var o={id:rn(i[1][0].data),messages:[]};i[2].forEach(function(u){var m=In(u.data),f=rn(m[3][0].data);o.messages.push({meta:m,data:e.slice(n[0],n[0]+f)}),n[0]+=f}),(t=i[3])!=null&&t[0]&&(o.merge=rn(i[3][0].data)>>>0>0),r.push(o)}return r}function hG(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=ef(t,r),a=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var u=o-59;o=t[r[0]],u>1&&(o|=t[r[0]+1]<<8),u>2&&(o|=t[r[0]+2]<<16),u>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=u}a.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var m=0,f=0;if(i==1?(f=(t[r[0]]>>2&7)+4,m=(t[r[0]++]&224)<<3,m|=t[r[0]++]):(f=(t[r[0]++]>>2)+1,i==2?(m=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(m=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Oy(a)],m==0)throw new Error("Invalid offset 0");if(m>a[0].length)throw new Error("Invalid offset beyond length");if(f>=m)for(a.push(a[0].slice(-m)),f-=m;f>=a[a.length-1].length;)a.push(a[a.length-1]),f-=a[a.length-1].length;a.push(a[0].slice(-m,-m+f))}}var h=Oy(a);if(h.length!=n)throw new Error("Unexpected length: ".concat(h.length," != ").concat(n));return h}function mG(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(hG(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Oy(t)}function pG(e,t,r,n){var a=f2(e),i=a.getUint32(4,!0),o=(n>1?12:8)+D_(i&(n>1?3470:398))*4,u=-1,m=-1,f=NaN,h=new Date(2001,0,1);i&512&&(u=a.getUint32(o,!0),o+=4),o+=D_(i&(n>1?12288:4096))*4,i&16&&(m=a.getUint32(o,!0),o+=4),i&32&&(f=a.getFloat64(o,!0),o+=8),i&64&&(h.setTime(h.getTime()+a.getFloat64(o,!0)*1e3),o+=8);var x;switch(e[2]){case 0:break;case 2:x={t:"n",v:f};break;case 3:x={t:"s",v:t[m]};break;case 5:x={t:"d",v:h};break;case 6:x={t:"b",v:f>0};break;case 7:x={t:"n",v:f/86400};break;case 8:x={t:"e",v:0};break;case 9:if(u>-1)x={t:"s",v:r[u]};else if(m>-1)x={t:"s",v:t[m]};else if(!isNaN(f))x={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return x}function xG(e,t,r){var n=f2(e),a=n.getUint32(8,!0),i=12,o=-1,u=-1,m=NaN,f=NaN,h=new Date(2001,0,1);a&1&&(m=dG(e,i),i+=16),a&2&&(f=n.getFloat64(i,!0),i+=8),a&4&&(h.setTime(h.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(u=n.getUint32(i,!0),i+=4),a&16&&(o=n.getUint32(i,!0),i+=4);var x;switch(e[1]){case 0:break;case 2:x={t:"n",v:m};break;case 3:x={t:"s",v:t[u]};break;case 5:x={t:"d",v:h};break;case 6:x={t:"b",v:f>0};break;case 7:x={t:"n",v:f/86400};break;case 8:x={t:"e",v:0};break;case 9:if(o>-1)x={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:x={t:"n",v:m};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return x}function vG(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return pG(e,t,r,e[0]);case 5:return xG(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function El(e){var t=In(e);return ef(t[1][0].data)}function P_(e,t){var r=In(t.data),n=rn(r[1][0].data),a=r[3],i=[];return(a||[]).forEach(function(o){var u=In(o.data),m=rn(u[1][0].data)>>>0;switch(n){case 1:i[m]=Cy(u[3][0].data);break;case 8:{var f=e[El(u[9][0].data)][0],h=In(f.data),x=e[El(h[1][0].data)][0],v=rn(x.meta[1][0].data);if(v!=2001)throw new Error("2000 unexpected reference to ".concat(v));var y=In(x.data);i[m]=y[3].map(function(w){return Cy(w.data)}).join("")}break}}),i}function gG(e,t){var r,n,a,i,o,u,m,f,h,x,v,y,w,b,S=In(e),N=rn(S[1][0].data)>>>0,_=rn(S[2][0].data)>>>0,A=((n=(r=S[8])==null?void 0:r[0])==null?void 0:n.data)&&rn(S[8][0].data)>0||!1,k,C;if((i=(a=S[7])==null?void 0:a[0])!=null&&i.data&&t!=0)k=(u=(o=S[7])==null?void 0:o[0])==null?void 0:u.data,C=(f=(m=S[6])==null?void 0:m[0])==null?void 0:f.data;else if((x=(h=S[4])==null?void 0:h[0])!=null&&x.data&&t!=1)k=(y=(v=S[4])==null?void 0:v[0])==null?void 0:y.data,C=(b=(w=S[3])==null?void 0:w[0])==null?void 0:b.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var O=A?4:1,T=f2(k),z=[],P=0;P<k.length/2;++P){var Z=T.getUint16(P*2,!0);Z<65535&&z.push([P,Z])}if(z.length!=_)throw"Expected ".concat(_," cells, found ").concat(z.length);var q=[];for(P=0;P<z.length-1;++P)q[z[P][0]]=C.subarray(z[P][1]*O,z[P+1][1]*O);return z.length>=1&&(q[z[z.length-1][0]]=C.subarray(z[z.length-1][1]*O)),{R:N,cells:q}}function yG(e,t){var r,n=In(t.data),a=(r=n?.[7])!=null&&r[0]?rn(n[7][0].data)>>>0>0?1:0:-1,i=h2(n[5],function(o){return gG(o,a)});return{nrows:rn(n[4][0].data)>>>0,data:i.reduce(function(o,u){return o[u.R]||(o[u.R]=[]),u.cells.forEach(function(m,f){if(o[u.R][f])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(f));o[u.R][f]=m}),o},[])}}function bG(e,t,r){var n,a=In(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(rn(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(rn(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=sr(i);var o=In(a[4][0].data),u=P_(e,e[El(o[4][0].data)][0]),m=(n=o[17])!=null&&n[0]?P_(e,e[El(o[17][0].data)][0]):[],f=In(o[3][0].data),h=0;f[1].forEach(function(x){var v=In(x.data),y=e[El(v[2][0].data)][0],w=rn(y.meta[1][0].data);if(w!=6002)throw new Error("6001 unexpected reference to ".concat(w));var b=yG(e,y);b.data.forEach(function(S,N){S.forEach(function(_,A){var k=Ft({r:h+N,c:A}),C=vG(_,u,m);C&&(r[k]=C)})}),h+=b.nrows})}function wG(e,t){var r=In(t.data),n={"!ref":"A1"},a=e[El(r[2][0].data)],i=rn(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return bG(e,a[0],n),n}function SG(e,t){var r,n=In(t.data),a={name:(r=n[1])!=null&&r[0]?Cy(n[1][0].data):"",sheets:[]},i=h2(n[2],El);return i.forEach(function(o){e[o].forEach(function(u){var m=rn(u.meta[1][0].data);m==6e3&&a.sheets.push(wG(e,u))})}),a}function jG(e,t){var r=I5(),n=In(t.data),a=h2(n[1],El);if(a.forEach(function(i){e[i].forEach(function(o){var u=rn(o.meta[1][0].data);if(u==2){var m=SG(e,o);m.sheets.forEach(function(f,h){L5(r,f,h==0?m.name:m.name+"_"+h,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function bg(e){var t,r,n,a,i={},o=[];if(e.FullPaths.forEach(function(m){if(m.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(m){if(m.name.match(/\.iwa$/)){var f;try{f=mG(m.content)}catch(x){return console.log("?? "+m.content.length+" "+(x.message||x))}var h;try{h=fG(f)}catch(x){return console.log("## "+(x.message||x))}h.forEach(function(x){i[x.id]=x.messages,o.push(x.id)})}}),!o.length)throw new Error("File has no messages");var u=((a=(n=(r=(t=i?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&rn(i[1][0].meta[1][0].data)==1&&i[1][0];if(u||o.forEach(function(m){i[m].forEach(function(f){var h=rn(f.meta[1][0].data)>>>0;if(h==1)if(!u)u=f;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return jG(i,u)}function NG(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function m2(e){NG([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function EG(e){return kc.WS.indexOf(e)>-1?"sheet":e==kc.CS?"chart":e==kc.DS?"dialog":e==kc.MS?"macro":e&&e.length?e:"sheet"}function AG(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,EG(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function _G(e,t,r,n,a,i,o,u,m,f,h,x){try{i[n]=Pd(Ca(e,r,!0),t);var v=qr(e,t),y;switch(u){case"sheet":y=UK(v,t,a,m,i[n],f,h,x);break;case"chart":if(y=$K(v,t,a,m,i[n],f,h,x),!y||!y["!drawel"])break;var w=Nd(y["!drawel"].Target,t),b=Ey(w),S=BH(Ca(e,w,!0),Pd(Ca(e,b,!0),w)),N=Nd(S,w),_=Ey(N);y=jK(Ca(e,N,!0),N,m,Pd(Ca(e,_,!0),N),f,y);break;case"macro":y=zK(v,t,a,m,i[n],f,h,x);break;case"dialog":y=HK(v,t,a,m,i[n],f,h,x);break;default:throw new Error("Unrecognized sheet type "+u)}o[n]=y;var A=[];i&&i[n]&&kl(i[n]).forEach(function(k){var C="";if(i[n][k].Type==kc.CMNT){C=Nd(i[n][k].Target,t);var O=GK(qr(e,C,!0),C,m);if(!O||!O.length)return;y_(y,O,!1)}i[n][k].Type==kc.TCMNT&&(C=Nd(i[n][k].Target,t),A=A.concat($H(qr(e,C,!0),m)))}),A&&A.length&&y_(y,A,!0,m.people||[])}catch(k){if(m.WTF)throw k}}function Xa(e){return e.charAt(0)=="/"?e.slice(1):e}function TG(e,t){if(bO(),t=t||{},m2(t),ri(e,"META-INF/manifest.xml")||ri(e,"objectdata.xml"))return C_(e,t);if(ri(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof bg<"u"){if(e.FileIndex)return bg(e);var r=Ht.utils.cfb_new();return KA(e).forEach(function(Ne){L9(r,Ne,I9(e,Ne))}),bg(r)}throw new Error("Unsupported NUMBERS file")}if(!ri(e,"[Content_Types].xml"))throw ri(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ri(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=KA(e),a=OU(Ca(e,"[Content_Types].xml")),i=!1,o,u;if(a.workbooks.length===0&&(u="xl/workbook.xml",qr(e,u,!0)&&a.workbooks.push(u)),a.workbooks.length===0){if(u="xl/workbook.bin",!qr(e,u,!0))throw new Error("Could not find workbook");a.workbooks.push(u),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var m={},f={};if(!t.bookSheets&&!t.bookProps){if(Fd=[],a.sst)try{Fd=KK(qr(e,Xa(a.sst)),a.sst,t)}catch(Ne){if(t.WTF)throw Ne}t.cellStyles&&a.themes.length&&(m=VK(Ca(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(f=qK(qr(e,Xa(a.style)),a.style,m,t))}a.links.map(function(Ne){try{var he=Pd(Ca(e,Ey(Xa(Ne))),Ne);return XK(qr(e,Xa(Ne)),he,Ne,t)}catch{}});var h=BK(qr(e,Xa(a.workbooks[0])),a.workbooks[0],t),x={},v="";a.coreprops.length&&(v=qr(e,Xa(a.coreprops[0]),!0),v&&(x=YO(v)),a.extprops.length!==0&&(v=qr(e,Xa(a.extprops[0]),!0),v&&FU(v,x,t)));var y={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(v=Ca(e,Xa(a.custprops[0]),!0),v&&(y=LU(v,t)));var w={};if((t.bookSheets||t.bookProps)&&(h.Sheets?o=h.Sheets.map(function(he){return he.name}):x.Worksheets&&x.SheetNames.length>0&&(o=x.SheetNames),t.bookProps&&(w.Props=x,w.Custprops=y),t.bookSheets&&typeof o<"u"&&(w.SheetNames=o),t.bookSheets?w.SheetNames:t.bookProps))return w;o={};var b={};t.bookDeps&&a.calcchain&&(b=WK(qr(e,Xa(a.calcchain)),a.calcchain));var S=0,N={},_,A;{var k=h.Sheets;x.Worksheets=k.length,x.SheetNames=[];for(var C=0;C!=k.length;++C)x.SheetNames[C]=k[C].name}var O=i?"bin":"xml",T=a.workbooks[0].lastIndexOf("/"),z=(a.workbooks[0].slice(0,T+1)+"_rels/"+a.workbooks[0].slice(T+1)+".rels").replace(/^\//,"");ri(e,z)||(z="xl/_rels/workbook."+O+".rels");var P=Pd(Ca(e,z,!0),z.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=YK(qr(e,Xa(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=zH(qr(e,Xa(a.people[0])),t)),P&&(P=AG(P,h.Sheets));var Z=qr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(S=0;S!=x.Worksheets;++S){var q="sheet";if(P&&P[S]?(_="xl/"+P[S][1].replace(/[\/]?xl\//,""),ri(e,_)||(_=P[S][1]),ri(e,_)||(_=z.replace(/_rels\/.*$/,"")+P[S][1]),q=P[S][2]):(_="xl/worksheets/sheet"+(S+1-Z)+"."+O,_=_.replace(/sheet0\./,"sheet.")),A=_.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(S!=t.sheets)continue e;break;case"string":if(x.SheetNames[S].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var B=!1,fe=0;fe!=t.sheets.length;++fe)typeof t.sheets[fe]=="number"&&t.sheets[fe]==S&&(B=1),typeof t.sheets[fe]=="string"&&t.sheets[fe].toLowerCase()==x.SheetNames[S].toLowerCase()&&(B=1);if(!B)continue e}}_G(e,_,A,x.SheetNames[S],S,N,o,q,t,h,m,f)}return w={Directory:a,Workbook:h,Props:x,Custprops:y,Deps:b,Sheets:o,SheetNames:x.SheetNames,Strings:Fd,Styles:f,Themes:m,SSF:En(Tt)},t&&t.bookFiles&&(e.files?(w.keys=n,w.files=e.files):(w.keys=[],w.files={},e.FullPaths.forEach(function(Ne,he){Ne=Ne.replace(/^Root Entry[\/]/,""),w.keys.push(Ne),w.files[Ne]=e.FileIndex[he]}))),t&&t.bookVBA&&(a.vba.length>0?w.vbaraw=qr(e,Xa(a.vba[0]),!0):a.defaults&&a.defaults.bin===KH&&(w.vbaraw=qr(e,"xl/vbaProject.bin",!0))),w}function kG(e,t){var r=t||{},n="Workbook",a=Ht.find(e,n);try{if(n="/!DataSpaces/Version",a=Ht.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Tz(a.content),n="/!DataSpaces/DataSpaceMap",a=Ht.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=Cz(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Ht.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Oz(a.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Ht.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);Pz(a.content)}catch{}if(n="/EncryptionInfo",a=Ht.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var u=Rz(a.content);if(n="/EncryptedPackage",a=Ht.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],a.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function p2(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Ra(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function CG(e,t){return Ht.find(e,"EncryptedPackage")?kG(e,t):R5(e,t)}function OG(e,t){var r,n=e,a=t||{};return a.type||(a.type=Ut&&Buffer.isBuffer(e)?"buffer":"base64"),r=AO(n,a),TG(r,a)}function F5(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Ty(e.slice(r),t);default:break e}return Zd.to_workbook(e,t)}function DG(e,t){var r="",n=p2(e,t);switch(t.type){case"base64":r=Ra(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Eo(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=vr(r)),t.type="binary",F5(r,t)}function PG(e,t){var r=e;return t.type=="base64"&&(r=Ra(r)),r=Kd.utils.decode(1200,r.slice(2),"str"),t.type="binary",F5(r,t)}function RG(e){return e.match(/[^\x00-\x7F]/)?Ed(e):e}function wg(e,t,r,n){return n?(r.type="string",Zd.to_workbook(e,r)):Zd.to_workbook(t,r)}function Dy(e,t){oO();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Dy(new Uint8Array(e),(r=En(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Mc={},r.dateNF&&(Mc.dateNF=r.dateNF),r.type||(r.type=Ut&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Ut?"buffer":"binary",n=C9(e),typeof Uint8Array<"u"&&!Ut&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=RG(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),u=new Uint8Array(o);if(u.foo="bar",!u.foo)return r=En(r),r.type="array",Dy(Xb(n),r)}switch((a=p2(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return CG(Ht.read(n,r),r);break;case 9:if(a[1]<=8)return R5(n,r);break;case 60:return Ty(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return pz(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return hz.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?OG(n,r):wg(e,n,r,i);case 239:return a[3]===60?Ty(n,r):wg(e,n,r,i);case 255:if(a[1]===254)return PG(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return Md.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Md.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return g_.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return Kz.to_workbook(n,r);break;case 10:case 13:case 32:return DG(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return dz.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?g_.to_workbook(n,r):wg(e,n,r,i)}function MG(e,t,r,n,a,i,o,u){var m=Da(r),f=u.defval,h=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),x=!0,v=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(v,"__rowNum__",{value:r,enumerable:!1})}catch{v.__rowNum__=r}else v.__rowNum__=r;if(!o||e[r])for(var y=t.s.c;y<=t.e.c;++y){var w=o?e[r][y]:e[n[y]+m];if(w===void 0||w.t===void 0){if(f===void 0)continue;i[y]!=null&&(v[i[y]]=f);continue}var b=w.v;switch(w.t){case"z":if(b==null)break;continue;case"e":b=b==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(i[y]!=null){if(b==null)if(w.t=="e"&&b===null)v[i[y]]=null;else if(f!==void 0)v[i[y]]=f;else if(h&&b===null)v[i[y]]=null;else continue;else v[i[y]]=h&&(w.t!=="n"||w.t==="n"&&u.rawNumbers!==!1)?b:Lc(w,b,u);b!=null&&(x=!1)}}return{row:v,isempty:x}}function FG(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],o=0,u="",m={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},h=f.range!=null?f.range:e["!ref"];switch(f.header===1?n=1:f.header==="A"?n=2:Array.isArray(f.header)?n=3:f.header==null&&(n=0),typeof h){case"string":m=pn(h);break;case"number":m=pn(e["!ref"]),m.s.r=h;break;default:m=h}n>0&&(a=0);var x=Da(m.s.r),v=[],y=[],w=0,b=0,S=Array.isArray(e),N=m.s.r,_=0,A={};S&&!e[N]&&(e[N]=[]);var k=f.skipHidden&&e["!cols"]||[],C=f.skipHidden&&e["!rows"]||[];for(_=m.s.c;_<=m.e.c;++_)if(!(k[_]||{}).hidden)switch(v[_]=Wn(_),r=S?e[N][_]:e[v[_]+x],n){case 1:i[_]=_-m.s.c;break;case 2:i[_]=v[_];break;case 3:i[_]=f.header[_-m.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=o=Lc(r,null,f),b=A[o]||0,!b)A[o]=1;else{do u=o+"_"+b++;while(A[u]);A[o]=b,A[u]=1}i[_]=u}for(N=m.s.r+a;N<=m.e.r;++N)if(!(C[N]||{}).hidden){var O=MG(e,m,N,v,n,i,S,f);(O.isempty===!1||(n===1?f.blankrows!==!1:f.blankrows))&&(y[w++]=O.row)}return y.length=w,y}function I5(){return{SheetNames:[],Sheets:{}}}function L5(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var o=i&&i[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=o+a)!=-1;++a);}if(OK(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}const IG={},Hi=IG?.VITE_API_BASE||"",LG=[{id:"upload",label:"Upload"},{id:"sharepoint",label:"SharePoint"}],uh=[".xlsx",".xls",".xlsm"],dh=50,Nc=(...e)=>e.filter(Boolean).join(" "),BG=e=>{try{return new Date(e).toLocaleString()}catch{return e}},R_=e=>(e/(1024*1024)).toFixed(2),Sg=e=>{try{const r=(e||"").split("?")[0].split("/").pop()||"";return decodeURIComponent(r)||""}catch{return""}},Ec=()=>{if(typeof document>"u")return null;const e=document.cookie.match(/(?:^|;\s*)XSRF-TOKEN=([^;]+)/);return e?decodeURIComponent(e[1]):null};function UG(){const[e,t]=g.useState("upload"),[r,n]=g.useState({connected:!1,account:"",expires_in:0}),[a,i]=g.useState(null),[o,u]=g.useState(!1),[m,f]=g.useState(0),[h,x]=g.useState(!1),[v,y]=g.useState(""),[w,b]=g.useState(""),[S,N]=g.useState([]),_=g.useRef(null),[A,k]=g.useState("Clarus Balance Sheet"),[C,O]=g.useState([]),[T,z]=g.useState(""),[P,Z]=g.useState(""),[q,B]=g.useState(null),[fe,Ne]=g.useState(null),[he,K]=g.useState(""),[H,be]=g.useState([]),[te,I]=g.useState("Clarus Balance Sheet"),[se,R]=g.useState("Valuation"),[W,Y]=g.useState(""),[Q,L]=g.useState(!1),[ne,ge]=g.useState(""),[G,ue]=g.useState(!1);g.useEffect(()=>{Se(),oe(),Fe()},[]),g.useEffect(()=>{if(!T&&!P&&H.length){const De=H[0],Xe=Sg(De.url);z(De.url),Z(Xe)}},[H,T,P]);const Se=async()=>{try{const Xe=await(await fetch(`${Hi}/auth/ms/status`,{credentials:"include"})).json();n(Xe)}catch{n({connected:!1})}},M=De=>{if(!De)return"Please select a file.";const Xe=(De.name||"").toLowerCase();return uh.some(rt=>Xe.endsWith(rt))?De.size>dh*1024*1024?`Max size ${dh} MB exceeded.`:"":`Unsupported type. Allowed: ${uh.join(", ")}`},Qe=async De=>{try{const Xe=await De.arrayBuffer(),rt=Dy(Xe,{type:"array"}).SheetNames||[];O(rt);const de=rt.find(st=>st.trim().toLowerCase().includes("clarus")),Ce=rt.find(st=>st.trim().toLowerCase()==="master");de?k(de):Ce?k(Ce):rt.includes(A)||k(rt[0]||A)}catch(Xe){console.warn("Failed to parse sheet names:",Xe),O([])}},xe=De=>{b(""),y("");const Xe=M(De);if(Xe){b(Xe),i(null),O([]);return}i(De),Qe(De)},me=De=>{if(De.preventDefault(),De.stopPropagation(),u(!1),h)return;const Xe=De.dataTransfer.files?.[0];Xe&&xe(Xe)},ze=async()=>{if(!a)return b("Please select a file first.");x(!0),f(0),b(""),y("");try{const De=new FormData;De.append("file",a),A?.trim()&&De.append("sheet",A.trim()),await new Promise((Xe,at)=>{const rt=new XMLHttpRequest;rt.open("POST",`${Hi}/excel/upload_and_ingest`,!0),rt.withCredentials=!0;const de=Ec();de&&rt.setRequestHeader("X-XSRF-TOKEN",de),rt.upload.onprogress=Ce=>{if(!Ce.lengthComputable)return;const st=Math.round(Ce.loaded/Ce.total*100);f(st)},rt.onload=()=>{let Ce={};try{Ce=JSON.parse(rt.responseText||"{}")}catch{}if(rt.status>=200&&rt.status<300&&Ce&&Ce.ok)y(`Stored ${Array.isArray(Ce.admin_periods_upserted)?Ce.admin_periods_upserted.length:0} period(s) for ${Ce.sheet}.`),f(100),oe(),Xe();else{const st=Ce&&Ce.error?Ce.error:`Upload failed (HTTP ${rt.status})`;b(st),at(new Error(st))}},rt.onerror=()=>{const Ce="Network error while uploading.";b(Ce),at(new Error(Ce))},rt.send(De)}),i(null),O([]),_.current&&(_.current.value="")}catch{}finally{x(!1),setTimeout(()=>f(0),1e3)}},oe=async()=>{try{const Xe=await(await fetch(`${Hi}/excel/upload_history`,{credentials:"include"})).json();N(Array.isArray(Xe)?Xe:[])}catch{}},ke=()=>{const De=new URL(window.location.href);T&&De.searchParams.set("sp_connect_url",T);const Xe=`${Hi}/auth/ms/login?redirect=${encodeURIComponent(De.toString())}`;window.location.assign(Xe)},Ge=async()=>{const De=Ec();try{await fetch(`${Hi}/auth/ms/logout`,{method:"POST",credentials:"include",headers:De?{"X-XSRF-TOKEN":De}:void 0})}finally{n({connected:!1})}},Fe=async()=>{try{const Xe=await(await fetch(`${Hi}/api/sharepoint/excel/connections?include_shared=1`,{credentials:"include"})).json();Xe.ok&&be(Xe.connections||[])}catch{}},Be=async()=>{const De=(T||"").trim();if(!De)return K("Paste a SharePoint file URL first.");const Xe=Ec(),at={"Content-Type":"application/json",...Xe?{"X-XSRF-TOKEN":Xe}:{}},de=await(await fetch(`${Hi}/api/sharepoint/excel/connect_by_url`,{method:"POST",headers:at,credentials:"include",body:JSON.stringify({url:De})})).json();if(!de.ok)return K(de.error||"Failed to connect");be(de.connections||[]);const Ce=Sg(De);Z(Ce),z(De)},xt=async De=>{const Xe=Ec(),at=Xe?{"X-XSRF-TOKEN":Xe}:void 0,de=await(await fetch(`${Hi}/api/sharepoint/excel/connections/${De}`,{method:"DELETE",credentials:"include",headers:at})).json();de.ok&&be(de.connections||[]),H.find(Ce=>String(Ce.id)===String(De))?.url===T&&(z(""),Z(""))},Ze=()=>{const De=(T||"").trim();return De||(H.length?(H[0].url||"").trim():"")},ht=async()=>{Y(""),K("");const De=Ze(),Xe=(te||"").trim();if(!De)return K("Add or select a SharePoint workbook first (paste URL and Connect).");try{L(!0);const at=Ec(),rt={"Content-Type":"application/json",...at?{"X-XSRF-TOKEN":at}:{}},de=await fetch(`${Hi}/api/sharepoint/excel/sync_balance_by_url`,{method:"POST",headers:rt,credentials:"include",body:JSON.stringify({url:De,sheet:Xe})}),Ce=await de.json();if(!de.ok||!Ce.ok){K(Ce.error||"Balance sync failed"),Y("");return}const st=(Array.isArray(Ce.admin_periods_upserted)?Ce.admin_periods_upserted.length:0)+(Array.isArray(Ce.investor_periods_upserted)?Ce.investor_periods_upserted.length:0);Y(`Balance sync  Stored ${st} period batch(es) from '${Xe||"auto-detected sheet"}'.`)}catch(at){K(String(at))}finally{L(!1)}},At=async()=>{ge(""),K("");const De=Ze(),Xe=(se||"").trim();if(!De)return K("Add or select a SharePoint workbook first (paste URL and Connect).");try{ue(!0);const at=Ec(),rt={"Content-Type":"application/json",...at?{"X-XSRF-TOKEN":at}:{}},de=await fetch(`${Hi}/api/sharepoint/excel/sync_investments_by_url`,{method:"POST",headers:rt,credentials:"include",body:JSON.stringify({url:De,sheet:Xe})}),Ce=await de.json();if(!de.ok||!Ce.ok){K(Ce.error||"Investment sync failed"),ge("");return}ge(`Investment values stored  rows=${Ce.rows??"?"}, as_of=${Ce.as_of??"n/a"}`);try{window.dispatchEvent(new CustomEvent("investment:updated",{detail:Ce}))}catch{}}catch(at){K(String(at))}finally{ue(!1)}};return l.jsxs("div",{className:"p-6 md:p-10 space-y-8",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Excel & Sheets Hub"}),l.jsx("button",{onClick:()=>{Se(),oe(),Fe()},className:"px-3 py-2 text-sm rounded-lg border border-slate-300 hover:bg-slate-50",children:"Refresh"})]}),l.jsx("div",{className:"flex gap-2",children:LG.map(De=>l.jsx("button",{onClick:()=>t(De.id),className:Nc("px-4 py-2 rounded-lg border text-sm",e===De.id?"bg-indigo-600 border-indigo-600 text-white shadow":"bg-white border-slate-300 hover:bg-slate-50"),children:De.label},De.id))}),e==="upload"&&l.jsxs("div",{className:"relative overflow-hidden rounded-2xl border border-slate-200 shadow-sm",children:[l.jsx("div",{className:"absolute inset-x-0 -top-24 h-48 bg-gradient-to-r from-indigo-500 via-sky-500 to-emerald-500 opacity-10 pointer-events-none"}),l.jsxs("div",{className:"p-6 md:p-8 space-y-6 bg-white/80 backdrop-blur",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-xl bg-indigo-600 text-white grid place-items-center shadow",children:l.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",children:[l.jsx("path",{d:"M12 16V7m0 0l-3 3m3-3l3 3",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round"}),l.jsx("path",{d:"M7 17a5 5 0 010-10 6.5 6.5 0 0112.3 1.9A4.5 4.5 0 0120 17H7z",stroke:"currentColor",strokeWidth:"1.4"})]})}),l.jsxs("div",{children:[l.jsx("div",{className:"text-lg font-semibold text-slate-900",children:"Upload Excel"}),l.jsxs("div",{className:"text-sm text-slate-600",children:["Drag & drop or choose a file. We support Excel (.xlsx/.xls/.xlsm) up to ",dh," MB."]})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("label",{className:"text-sm text-slate-600",children:"Worksheet"}),C.length>0?l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("select",{className:"border border-slate-300 rounded-lg px-3 py-2 w-72",value:A,onChange:De=>k(De.target.value),children:C.map(De=>l.jsx("option",{value:De,children:De},De))}),l.jsx("div",{className:"hidden md:flex gap-1 flex-wrap max-w-[420px]",children:C.slice(0,6).map(De=>l.jsx("button",{onClick:()=>k(De),className:Nc("px-2 py-1 rounded border text-xs",De===A?"bg-indigo-600 text-white border-indigo-600":"bg-white border-slate-300 hover:bg-slate-50"),title:`Use sheet: ${De}`,children:De},De))})]}):l.jsx("input",{className:"border border-slate-300 rounded-lg px-3 py-2 w-72",value:A,onChange:De=>k(De.target.value),placeholder:"Clarus Balance Sheet"})]}),l.jsx("div",{onDragOver:De=>{De.preventDefault(),De.stopPropagation(),h||u(!0)},onDragLeave:()=>u(!1),onDrop:me,className:Nc("rounded-xl border-2 border-dashed p-6 md:p-10 text-center transition",o?"border-indigo-500 bg-indigo-50":"border-slate-300 bg-slate-50"),children:l.jsxs("div",{className:"space-y-3",children:[l.jsx("div",{className:"text-slate-700",children:a?l.jsx("span",{className:"font-medium",children:a.name}):l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"font-medium",children:"Drop your file here"}),l.jsx("span",{className:"text-slate-500",children:" or "})]})}),!a&&l.jsxs("button",{className:"inline-flex items-center gap-2 rounded-lg bg-indigo-600 text-white px-4 py-2 text-sm hover:bg-indigo-700 shadow",onClick:()=>_.current?.click(),disabled:h,children:[l.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:l.jsx("path",{d:"M12 5v14M5 12h14",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})}),"Choose file"]}),l.jsx("input",{ref:_,type:"file",accept:uh.join(","),className:"hidden",onChange:De=>xe(De.target.files?.[0]||null),disabled:h}),a&&l.jsxs("div",{className:"mx-auto max-w-lg bg-white border border-slate-200 rounded-lg p-3 text-left shadow-sm",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"text-sm",children:[l.jsx("div",{className:"font-medium text-slate-900 truncate",children:a.name}),l.jsxs("div",{className:"text-slate-500",children:[R_(a.size)," MB"]})]}),l.jsx("button",{className:"text-slate-600 hover:text-rose-600",onClick:()=>{i(null),b(""),y(""),_.current&&(_.current.value=""),O([])},disabled:h,title:"Remove",children:l.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:l.jsx("path",{d:"M6 6l12 12M18 6L6 18",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round"})})})]}),h&&l.jsxs("div",{className:"mt-3",children:[l.jsx("div",{className:"w-full h-2 bg-slate-200 rounded",children:l.jsx("div",{className:"h-2 rounded bg-gradient-to-r from-indigo-500 to-sky-500 transition-all",style:{width:`${m}%`}})}),l.jsxs("div",{className:"text-xs text-slate-600 mt-1",children:[m,"%"]})]})]})]})}),l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[l.jsxs("div",{className:"text-xs text-slate-500",children:["Allowed types:"," ",l.jsx("span",{className:"font-medium",children:uh.join(", ")}),"  Max size: ",l.jsxs("span",{className:"font-medium",children:[dh," MB"]})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:()=>_.current?.click(),className:"px-3 py-2 rounded-lg border border-slate-300 bg-white hover:bg-slate-50",disabled:h,children:"Choose another"}),l.jsx("button",{onClick:ze,className:"px-4 py-2 rounded-lg bg-emerald-600 text-white hover:bg-emerald-700 shadow disabled:opacity-60",disabled:!a||h,children:h?"Uploading":"Upload"})]})]}),v&&l.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-emerald-50 border border-emerald-200 text-emerald-800 px-3 py-2 text-sm",children:[l.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:l.jsx("path",{d:"M5 13l4 4L19 7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})}),l.jsx("span",{children:v})]}),w&&l.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-rose-50 border border-rose-200 text-rose-700 px-3 py-2 text-sm",children:[l.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:l.jsx("path",{d:"M12 9v4m0 4h.01M4.93 19.07l14.14-14.14",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})}),l.jsx("span",{children:w})]}),l.jsxs("div",{className:"mt-4",children:[l.jsx("div",{className:"text-sm font-semibold text-slate-900 mb-2",children:"Recent uploads"}),S?.length?l.jsx("ul",{className:"divide-y divide-slate-200 rounded-lg border border-slate-200 overflow-hidden",children:S.map((De,Xe)=>l.jsxs("li",{className:"flex items-center justify-between px-3 py-2 bg-white hover:bg-slate-50",children:[l.jsxs("div",{className:"min-w-0",children:[l.jsx("div",{className:"truncate font-mono text-sm text-slate-800",children:De.filename}),l.jsx("div",{className:"text-xs text-slate-500",children:BG(De.uploaded_at)})]}),De.size&&l.jsxs("div",{className:"text-xs text-slate-500",children:[R_(De.size)," MB"]})]},Xe))}):l.jsx("div",{className:"text-sm text-slate-500",children:"No uploads yet."})]})]})]}),e==="sharepoint"&&l.jsxs("div",{className:"bg-white p-5 md:p-6 rounded-2xl border border-slate-200 shadow-sm space-y-5",children:[l.jsxs("div",{className:"flex items-center justify-between bg-slate-50 border border-slate-200 p-3 rounded-xl",children:[l.jsxs("div",{className:"text-sm",children:[l.jsx("span",{className:Nc("text-xs px-2 py-1 rounded mr-3",r.connected?"bg-emerald-100 text-emerald-700":"bg-slate-200 text-slate-700"),children:r.connected?`Connected  ${r.account||""}`:"Not connected"}),r.connected&&!!r.expires_in&&l.jsxs("span",{className:"text-slate-500",children:["token expires in ~",Math.max(0,Math.floor(r.expires_in/60)),"m"]})]}),l.jsx("div",{className:"flex gap-2",children:r.connected?l.jsx("button",{onClick:Ge,className:"px-3 py-2 rounded-lg border border-slate-300 bg-white hover:bg-slate-50",children:"Sign out"}):l.jsx("button",{onClick:ke,className:"px-3 py-2 rounded-lg bg-indigo-600 text-white hover:bg-indigo-700",children:"Connect Microsoft"})})]}),P&&l.jsxs("div",{className:"flex items-center justify-between bg-slate-50 border border-slate-200 p-3 rounded-xl",children:[l.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[l.jsx("div",{className:"w-8 h-8 rounded-lg bg-indigo-600 text-white grid place-items-center shadow",children:l.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[l.jsx("path",{d:"M7 3h7l4 4v14a1 1 0 01-1 1H7a1 1 0 01-1-1V3a1 1 0 011-1z",stroke:"currentColor",strokeWidth:"1.5"}),l.jsx("path",{d:"M14 3v5h5",stroke:"currentColor",strokeWidth:"1.5"})]})}),l.jsxs("div",{className:"truncate",children:[l.jsx("div",{className:"text-sm font-medium text-slate-900 truncate",children:P}),l.jsx("div",{className:"text-xs text-slate-500",children:"Selected SharePoint workbook"})]})]}),l.jsx("button",{onClick:()=>{z(""),Z("")},className:"px-3 py-2 rounded-lg border border-slate-300 bg-white hover:bg-slate-50",children:"Clear"})]}),l.jsxs("div",{className:"border border-slate-200 rounded-xl p-4 space-y-3",children:[l.jsx("label",{className:"text-sm font-medium text-slate-800",children:"Add SharePoint workbook"}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{className:"border border-slate-300 p-2 rounded-lg w-full",placeholder:"https://tenant.sharepoint.com/:x:/r/sites/.../file.xlsx?...",value:T,onChange:De=>z(De.target.value)}),l.jsxs("button",{onClick:Be,className:"inline-flex items-center gap-2 px-3 py-2 rounded-lg bg-emerald-600 text-white hover:bg-emerald-700 shadow",children:[l.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:l.jsx("path",{d:"M10 13a5 5 0 007.07 0l1.41-1.41a5 5 0 10-7.07-7.07L10 5",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round"})}),"Connect"]})]}),l.jsx("div",{className:"text-xs text-slate-500",children:"You can save multiple files. The Balance/Investment Sync buttons will use the active workbook (the last connected one, or the first saved connection)."})]}),l.jsx("div",{className:"border border-slate-200 rounded-xl p-4",children:l.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-sm font-medium text-slate-800",children:"Balance worksheet (admin & investor)"}),l.jsx("input",{className:"border border-slate-300 p-2 rounded-lg w-full",placeholder:"Clarus Balance Sheet",value:te,onChange:De=>I(De.target.value)})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-sm font-medium text-slate-800",children:"Investment worksheet (valuation)"}),l.jsx("input",{className:"border border-slate-300 p-2 rounded-lg w-full",placeholder:"Valuation",value:se,onChange:De=>R(De.target.value)})]}),l.jsxs("div",{className:"flex gap-2 flex-wrap",children:[l.jsx("button",{disabled:Q,onClick:ht,className:"px-3 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60",children:Q?"Syncing":"Balance Sync"}),l.jsx("button",{disabled:G,onClick:At,className:"px-3 py-2 rounded-lg bg-emerald-600 text-white hover:bg-emerald-700 disabled:opacity-60",children:G?"Syncing":"Investment Sync"})]}),W&&l.jsx("div",{className:"text-emerald-700 text-sm",children:W}),ne&&l.jsx("div",{className:"text-emerald-700 text-sm",children:ne}),he&&l.jsx("div",{className:"text-rose-600 text-sm",children:he})]}),l.jsxs("div",{className:"text-xs text-slate-600 space-y-1.5",children:[l.jsxs("p",{children:[l.jsx("span",{className:"font-semibold",children:"Balance Sync"})," reads the balance worksheet (for example"," ",l.jsx("span",{className:"font-mono",children:"Clarus Balance Sheet"}),") from the selected SharePoint workbook and stores:"]}),l.jsxs("ul",{className:"list-disc list-inside mt-1 space-y-0.5",children:[l.jsxs("li",{children:["Investor rows into"," ",l.jsx("span",{className:"font-mono",children:"investor_period_balances"}),"."]}),l.jsxs("li",{children:["Admin totals into"," ",l.jsx("span",{className:"font-mono",children:"admin_period_balances"}),"."]})]}),l.jsxs("p",{className:"mt-3",children:[l.jsx("span",{className:"font-semibold",children:"Investment Sync"})," reads the valuation worksheet and stores investment values (same ingestion logic as your Excel upload for the valuation sheet) into the appropriate investment tables."]})]})]})}),l.jsxs("div",{className:"border border-slate-200 rounded-xl p-4",children:[l.jsx("div",{className:"font-medium mb-3",children:"Your SharePoint connections"}),H?.length?l.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-4",children:H.map(De=>{const Xe=Sg(De.url),at=P&&Xe===P||De.url===T;return l.jsxs("div",{className:Nc("rounded-xl border p-4 bg-white shadow-sm",at?"border-indigo-400 ring-2 ring-indigo-200":"border-slate-200"),children:[l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx("div",{className:"w-9 h-9 rounded-lg bg-indigo-600 text-white grid place-items-center shrink-0",children:l.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:l.jsx("path",{d:"M7 3h7l4 4v14H7V3z",stroke:"currentColor",strokeWidth:"1.5"})})}),l.jsxs("div",{className:"min-w-0",children:[l.jsx("div",{className:"font-medium text-slate-900 truncate",children:Xe||"(file)"}),l.jsxs("div",{className:"text-xs text-slate-500 truncate",children:["drive:"," ",l.jsx("span",{className:"font-mono",children:De.drive_id})]}),l.jsxs("div",{className:"text-xs text-slate-500 truncate",children:["item:"," ",l.jsx("span",{className:"font-mono",children:De.item_id})]})]})]}),l.jsxs("div",{className:"mt-3 flex gap-2",children:[l.jsx("button",{onClick:()=>{z(De.url),Z(Xe)},className:Nc("px-3 py-1.5 rounded-lg text-sm",at?"bg-indigo-600 text-white":"bg-slate-900 text-white hover:bg-black"),title:"Select this workbook",children:at?"Selected":"Use"}),l.jsx("button",{onClick:()=>xt(De.id),className:"px-3 py-1.5 rounded-lg text-sm border border-slate-300 bg-white hover:bg-slate-50 text-rose-600",title:"Remove connection",children:"Disconnect"})]})]},De.id)})}):l.jsx("div",{className:"text-slate-500 text-sm",children:"No connections yet. Add one above."})]}),q&&l.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"border border-slate-200 rounded-xl p-3",children:[l.jsx("div",{className:"font-medium mb-2",children:"Worksheets"}),q.worksheets?.length?l.jsx("ul",{className:"text-sm space-y-1",children:q.worksheets.map(De=>l.jsx("li",{children:De.name},De.id))}):l.jsx("div",{className:"text-slate-500 text-sm",children:"None"})]}),l.jsxs("div",{className:"border border-slate-200 rounded-xl p-3",children:[l.jsx("div",{className:"font-medium mb-2",children:"Tables"}),q.tables?.length?l.jsx("ul",{className:"text-sm space-y-1",children:q.tables.map(De=>l.jsx("li",{children:De.name},De.id))}):l.jsx("div",{className:"text-slate-500 text-sm",children:"None"})]})]}),fe&&l.jsxs("div",{className:"overflow-auto border border-slate-200 rounded-xl",children:[l.jsxs("table",{className:"min-w-full text-sm",children:[l.jsx("thead",{className:"bg-slate-50",children:l.jsx("tr",{children:fe.columns.map(De=>l.jsx("th",{className:"px-2 py-1 text-left border-b",children:De},De))})}),l.jsx("tbody",{children:fe.rows.map((De,Xe)=>l.jsx("tr",{className:"odd:bg-white even:bg-slate-50",children:fe.columns.map(at=>l.jsx("td",{className:"px-2 py-1 border-b",children:De[at]},at))},Xe))})]}),fe.truncated&&l.jsxs("div",{className:"p-2 text-xs text-slate-500",children:["Showing first ",fe.rows.length," rows (truncated)."]})]})]})]})}const jg=({children:e,tone:t="slate"})=>l.jsx("span",{className:`inline-flex items-center px-2 py-0.5 text-xs font-medium rounded-full bg-${t}-100 text-${t}-800`,children:e}),Ng=({label:e,value:t,sub:r})=>l.jsxs("div",{className:"flex-1 rounded-2xl bg-white shadow-sm border p-4",children:[l.jsx("div",{className:"text-sm text-gray-500",children:e}),l.jsx("div",{className:"text-2xl font-semibold text-gray-900 mt-1",children:t}),r?l.jsx("div",{className:"text-xs text-gray-400 mt-1",children:r}):null]}),M_=({label:e,value:t,onChange:r,min:n,max:a})=>l.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[l.jsx("span",{className:"text-slate-600",children:e}),l.jsx("input",{type:"month",value:t,min:n,max:a,onChange:i=>r(i.target.value),className:"border rounded px-2 py-1 text-sm"})]}),$G=()=>{const[e,t]=g.useState(""),[r,n]=g.useState(""),[a,i]=g.useState([]),[o,u]=g.useState(!1),[m,f]=g.useState(!1),[h,x]=g.useState(!1),[v,y]=g.useState(!1),[w,b]=g.useState(null),[S,N]=g.useState(null),[_,A]=g.useState([]),[k,C]=g.useState(!1),[O,T]=g.useState(""),z=g.useMemo(()=>new Date,[]),P=`${z.getFullYear()}-${String(z.getMonth()+1).padStart(2,"0")}`,Z=g.useMemo(()=>{const Se=new Date(z);return Se.setMonth(Se.getMonth()-12),`${Se.getFullYear()}-${String(Se.getMonth()+1).padStart(2,"0")}`},[z]),[q,B]=g.useState(Z),[fe,Ne]=g.useState(P),[he,K]=g.useState(!1),[H,be]=g.useState(null),[te,I]=g.useState(""),se=_?.length||0,R=g.useMemo(()=>{try{return _.reduce((Se,M)=>Se+(Number(M.Balance)||0),0)}catch{return 0}},[_]);g.useEffect(()=>{W(),Y()},[]);const W=async()=>{try{const Se=await We.get("/api/qbo/customers");y(!0);const Qe=Se?.data?.QueryResponse?.Customer||[];A(Qe),b(Se?.data?.realmId||null),N(Se?.data?.environment||null)}catch{y(!1),A([]),b(null),N(null)}},Y=async()=>{try{u(!0);const Se=await We.get("/api/admin/quickbooks-api");if(Se.data?.api){const M={id:Date.now(),apiKey:Se.data.api,description:"Fetched from DB",timestamp:new Date().toLocaleString()};i([M])}}catch{}finally{u(!1)}},Q=async()=>{if(!e.trim()){alert("Please enter the QuickBooks API");return}try{await We.post("/api/admin/quickbooks-api",{api:e,description:r});const Se={id:Date.now(),apiKey:e,description:r,timestamp:new Date().toLocaleString()};i([Se,...a]),t(""),n(""),alert("QuickBooks API saved successfully!")}catch(Se){console.error("Failed to save:",Se),alert("Save failed.")}},L=async()=>{try{f(!0);const Se=await We.get("/api/qbo/connect"),{url:M}=Se.data||{};M?window.location.href=M:(alert("Failed to start QuickBooks connect."),f(!1))}catch{alert("Please sign in first, then try connecting."),f(!1)}},ne=async()=>{if(!(!v||!window.confirm("Disconnect QuickBooks for this workspace?")))try{x(!0),await We.post("/api/qbo/disconnect",{realmId:w}),y(!1),b(null),N(null),A([]),T("")}catch(M){console.error(M),alert("Failed to disconnect. Please try again.")}finally{x(!1)}},ge=async()=>{C(!0),T("");try{const M=(await We.get("/api/qbo/customers")).data;if(M?.Fault)T(M.Fault?.Error?.[0]?.Message||"Failed to fetch customers"),A([]);else{const Qe=M?.QueryResponse?.Customer||[];A(Qe),b(M?.realmId||w),N(M?.environment||S)}}catch{T("Not connected or insufficient permissions."),A([])}finally{C(!1)}},G=async()=>{if(!v){alert("Connect QuickBooks first.");return}K(!0),I(""),be(null);try{const Se={from:q?`${q}-01`:void 0,to:fe?`${fe}-28`:void 0},M=await We.post("/api/qbo/full-sync",Se);be(M.data||{ok:!0})}catch(Se){console.error(Se);const M=Se?.response?.data?.error||Se?.response?.data?.message||Se?.message||"Full sync failed.";I(String(M))}finally{K(!1)}},ue=async()=>{if(!v){alert("Connect QuickBooks first.");return}if(!q||!fe){alert("Select a valid From/To month range.");return}if(q>fe){alert("From month cannot be after To month.");return}K(!0),I(""),be(null);try{const Se=await We.post("/api/qbo/periods/sync",{from:q,to:fe});be(Se.data||{ok:!0})}catch(Se){console.error(Se);const M=Se?.response?.data?.error||Se?.response?.data?.message||Se?.message||"Sync failed.";I(String(M))}finally{K(!1)}};return l.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 p-6 space-y-8",children:[l.jsxs("div",{className:"max-w-6xl mx-auto",children:[l.jsxs("div",{className:"flex items-start justify-between mb-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl md:text-3xl font-semibold text-slate-900",children:"QuickBooks Online"}),l.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"Connect your QBO company and sync your data to the database."})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(jg,{tone:v?"emerald":"rose",children:v?"Connected":"Not connected"}),S?l.jsx(jg,{tone:"blue",children:S}):null,w?l.jsxs(jg,{tone:"violet",children:["Realm: ",w]}):null]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsx(Ng,{label:"Customers",value:se,sub:v?"from QBO":""}),l.jsx(Ng,{label:"Total Balance",value:R.toFixed(2),sub:v?"across customers":""}),l.jsx(Ng,{label:"Status",value:v?"Linked":"Awaiting link",sub:v?"ready to sync":"click connect"})]})]}),l.jsxs("div",{className:"max-w-6xl mx-auto grid grid-cols-1 lg:grid-cols-3 gap-6",children:[l.jsxs("div",{className:"lg:col-span-2 bg-white rounded-2xl shadow-sm border",children:[l.jsxs("div",{className:"px-6 py-4 border-b flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",className:"text-slate-700",children:l.jsx("path",{fill:"currentColor",d:"M7 6v6a5 5 0 1 0 10 0V6h2V4h-4v8a3 3 0 1 1-6 0V4H5v2h2z"})}),l.jsx("span",{className:"font-semibold text-slate-800",children:"QuickBooks connection"})]}),v?l.jsx("span",{className:"text-xs text-emerald-600",children:"Youre connected"}):null]}),l.jsxs("div",{className:"p-6",children:[l.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"We use Intuits secure OAuth flow. Click connect, approve access, and youll return here automatically."}),l.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[v?l.jsx("button",{onClick:ne,disabled:h,className:"inline-flex items-center gap-2 rounded-2xl bg-rose-600 hover:bg-rose-700 text-white px-5 py-2.5 shadow transition",title:"Revoke the connection and remove stored tokens",children:h?l.jsxs(l.Fragment,{children:[l.jsxs("svg",{className:"animate-spin",width:"16",height:"16",viewBox:"0 0 24 24",children:[l.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none",opacity:"0.25"}),l.jsx("path",{d:"M22 12a10 10 0 0 1-10 10",stroke:"currentColor",strokeWidth:"4",fill:"none"})]}),"Disconnecting"]}):l.jsxs(l.Fragment,{children:[l.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",children:l.jsx("path",{fill:"currentColor",d:"M18 7l-1.41-1.41L12 10.17 7.41 5.59 6 7l4.59 4.59L6 16.17 7.41 17.6 12 13l4.59 4.59L18 16.17l-4.59-4.58L18 7z"})}),"Disconnect"]})}):l.jsx("button",{onClick:L,disabled:m,className:"inline-flex items-center gap-2 rounded-2xl bg-emerald-600 hover:bg-emerald-700 text-white px-5 py-2.5 shadow transition",children:m?l.jsxs(l.Fragment,{children:[l.jsxs("svg",{className:"animate-spin",width:"16",height:"16",viewBox:"0 0 24 24",children:[l.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none",opacity:"0.25"}),l.jsx("path",{d:"M22 12a10 10 0 0 1-10 10",stroke:"currentColor",strokeWidth:"4",fill:"none"})]}),"Connecting"]}):l.jsxs(l.Fragment,{children:[l.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",children:l.jsx("path",{fill:"currentColor",d:"M10 3H5a2 2 0 0 0-2 2v5h2V5h5V3zm4 0h5a2 2 0 0 1 2 2v5h-2V5h-5V3zM3 14v5a2 2 0 0 0 2 2h5v-2H5v-5H3zm18 0v5a2 2 0 0 1-2 2h-5v-2h5v-5h2z"})}),"Connect to QuickBooks"]})}),l.jsxs("button",{onClick:ge,className:"inline-flex items-center gap-2 rounded-2xl border border-slate-200 hover:bg-slate-50 text-slate-800 px-4 py-2 transition",children:[l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",children:l.jsx("path",{fill:"currentColor",d:"M12 6v6l4 2-.5 1L11 13V6h1z"})}),"Test fetch customers"]}),v?null:l.jsx("span",{className:"text-xs text-slate-500",children:"Tip: Youll be redirected to Intuit and then back here."})]})]})]}),l.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border",children:[l.jsx("div",{className:"px-6 py-4 border-b font-semibold text-slate-800",children:"(Optional) Admin API Notes"}),l.jsxs("div",{className:"p-6 space-y-3",children:[l.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"QuickBooks API"}),l.jsx("input",{type:"text",value:e,onChange:Se=>t(Se.target.value),placeholder:"Enter QuickBooks API",className:"w-full border border-slate-200 rounded-xl px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-emerald-200"}),l.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Description"}),l.jsx("input",{type:"text",value:r,onChange:Se=>n(Se.target.value),placeholder:"Add a note",className:"w-full border border-slate-200 rounded-xl px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-emerald-200"}),l.jsx("button",{onClick:Q,className:"w-full rounded-xl bg-slate-900 hover:bg-black text-white py-2 text-sm transition",children:"Save note"})]})]})]}),l.jsxs("div",{className:"max-w-6xl mx-auto bg-white rounded-2xl shadow-sm border p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Sync data to DB"}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx(M_,{label:"From",value:q,onChange:B,max:fe||void 0}),l.jsx(M_,{label:"To",value:fe,onChange:Ne,min:q||void 0}),l.jsx("button",{className:"inline-flex items-center gap-2 rounded-xl bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 text-sm transition disabled:opacity-60",onClick:G,disabled:!v||he,title:v?"Dump all QBO entities into qbo_entities":"Connect QuickBooks first",children:he?l.jsxs(l.Fragment,{children:[l.jsxs("svg",{className:"animate-spin",width:"16",height:"16",viewBox:"0 0 24 24",children:[l.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none",opacity:"0.25"}),l.jsx("path",{d:"M22 12a10 10 0 0 1-10 10",stroke:"currentColor",strokeWidth:"4",fill:"none"})]}),"Full syncing"]}):l.jsxs(l.Fragment,{children:[l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",children:l.jsx("path",{fill:"currentColor",d:"M5 13h14v-2H5v2z"})}),"Full sync (all entities)"]})}),l.jsx("button",{className:"inline-flex items-center gap-2 rounded-xl border border-slate-300 hover:bg-slate-50 text-slate-800 px-4 py-2 text-sm transition disabled:opacity-60",onClick:ue,disabled:!v||he,title:"Optional: write one roll-up row per month to qbo_period_metrics",children:"Monthly rollup"})]})]}),te&&l.jsx("p",{className:"text-rose-600 text-sm mb-2",children:te}),H?l.jsx("div",{className:"rounded border bg-slate-50 p-3 text-xs overflow-x-auto",children:l.jsx("pre",{className:"whitespace-pre-wrap",children:JSON.stringify(H,null,2)})}):l.jsxs("p",{className:"text-sm text-slate-500",children:[l.jsx("strong",{children:"Full sync"})," will store all supported QuickBooks entities into"," ",l.jsx("code",{children:"qbo_entities"})," and record a summary in ",l.jsx("code",{children:"qbo_sync_logs"}),". Use the month pickers to hint a date window for transaction types (Invoices, Bills, Payments, etc.). The Monthly rollup button (optional) writes one row per month into"," ",l.jsx("code",{children:"qbo_period_metrics"}),"."]})]}),l.jsxs("div",{className:"max-w-6xl mx-auto bg-white rounded-2xl shadow-sm border p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"History"}),o?l.jsx("span",{className:"text-xs text-slate-500",children:"Loading"}):null]}),a.length===0?l.jsx("p",{className:"text-sm text-slate-500",children:"No entries yet."}):l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full text-sm",children:[l.jsx("thead",{className:"bg-slate-50 text-slate-600",children:l.jsxs("tr",{children:[l.jsx("th",{className:"p-2 text-left",children:"#"}),l.jsx("th",{className:"p-2 text-left",children:"API"}),l.jsx("th",{className:"p-2 text-left",children:"Description"}),l.jsx("th",{className:"p-2 text-left",children:"Timestamp"})]})}),l.jsx("tbody",{children:a.map((Se,M)=>l.jsxs("tr",{className:"border-t hover:bg-slate-50",children:[l.jsx("td",{className:"p-2",children:M+1}),l.jsx("td",{className:"p-2",children:Se.apiKey}),l.jsx("td",{className:"p-2",children:Se.description}),l.jsx("td",{className:"p-2",children:Se.timestamp})]},Se.id))})]})})]}),l.jsxs("div",{className:"max-w-6xl mx-auto bg-white rounded-2xl shadow-sm border p-6",children:[l.jsx("div",{className:"flex items-center justify-between mb-4",children:l.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"QuickBooks Customers"})}),k?l.jsx("p",{className:"text-slate-500 text-sm",children:"Loading customers"}):O?l.jsx("p",{className:"text-rose-600 text-sm",children:O}):_.length===0?l.jsx("p",{className:"text-slate-500 text-sm",children:"No customers found."}):l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full text-sm",children:[l.jsx("thead",{className:"bg-slate-50 text-slate-600",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-3 py-2 text-left",children:"Display Name"}),l.jsx("th",{className:"px-3 py-2 text-left",children:"Email"}),l.jsx("th",{className:"px-3 py-2 text-left",children:"Phone"}),l.jsx("th",{className:"px-3 py-2 text-left",children:"Balance"})]})}),l.jsx("tbody",{children:_.map((Se,M)=>l.jsxs("tr",{className:"border-t hover:bg-slate-50",children:[l.jsx("td",{className:"px-3 py-2",children:Se.DisplayName}),l.jsx("td",{className:"px-3 py-2",children:Se.PrimaryEmailAddr?.Address||"-"}),l.jsx("td",{className:"px-3 py-2",children:Se.PrimaryPhone?.FreeFormNumber||"-"}),l.jsx("td",{className:"px-3 py-2",children:Se.Balance??"0.00"})]},M))})]})})]})]})},zG="https://clarus.elpiscapital.com";function HG(){const e=es(),[t,r]=g.useState({first_name:"",last_name:"",birthdate:"",citizenship:"",email:"",phone:"",ssn:"",address1:"",address2:"",country:"",city:"",state:"",zip:""}),[n,a]=g.useState(!1),[i,o]=g.useState(""),[u,m]=g.useState(""),f=g.useMemo(()=>{const y=(t.first_name||"").trim()[0]||"",w=(t.last_name||"").trim()[0]||"";return(y+w||"A").toUpperCase()},[t.first_name,t.last_name]),h=y=>r(w=>({...w,[y.target.name]:y.target.value})),x=["first_name","last_name","birthdate","citizenship","email","phone","ssn","address1","country","city","state","zip"],v=async y=>{y.preventDefault(),m(""),o("");for(const b of x)if(!String(t[b]||"").trim()){const S=b.replace("_"," ");m(`${S} is required`);return}const w=localStorage.getItem("accessToken")||sessionStorage.getItem("accessToken");if(!w){m("Your session has expired. Please log in again."),e("/login");return}a(!0);try{const b=await fetch(`${zG}/manual/manual_entry`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${w}`},body:JSON.stringify(t)});if(b.status===401||b.status===403){m("Your session has expired. Please log in again."),e("/login");return}const S=await b.json().catch(()=>({}));if(!b.ok)throw new Error(S?.msg||`Submit failed (${b.status})`);o("Manual entry saved successfully."),r({first_name:"",last_name:"",birthdate:"",citizenship:"",email:"",phone:"",ssn:"",address1:"",address2:"",country:"",city:"",state:"",zip:""}),setTimeout(()=>o(""),2500)}catch(b){m(b.message||"Unable to submit. Please try again.")}finally{a(!1)}};return l.jsx("div",{className:"max-w-5xl mx-auto p-6",children:l.jsxs("form",{onSubmit:v,className:"space-y-10",children:[l.jsxs("section",{className:"rounded-2xl border border-gray-200 bg-white shadow-sm",children:[l.jsx("div",{className:"flex items-start justify-between p-6 border-b",children:l.jsx("h2",{className:"text-xl font-semibold",children:"Personal Information"})}),l.jsx("div",{className:"p-6",children:l.jsxs("div",{className:"grid grid-cols-[96px_1fr] gap-6 items-start",children:[l.jsx("div",{className:"h-24 w-24 rounded-full bg-teal-500 text-white grid place-items-center text-3xl font-semibold",children:f}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsx(wa,{label:"First Name",name:"first_name",value:t.first_name,onChange:h,required:!0}),l.jsx(wa,{label:"Last Name",name:"last_name",value:t.last_name,onChange:h,required:!0}),l.jsx(wa,{label:"Birthdate",name:"birthdate",value:t.birthdate,onChange:h,placeholder:"MM/DD/YYYY",required:!0}),l.jsx(wa,{label:"Citizenship",name:"citizenship",value:t.citizenship,onChange:h,placeholder:"United States",required:!0}),l.jsx(wa,{label:"Email",name:"email",type:"email",value:t.email,onChange:h,required:!0}),l.jsx(wa,{label:"Phone",name:"phone",value:t.phone,onChange:h,required:!0}),l.jsx(wa,{label:"SSN / Tax ID",name:"ssn",value:t.ssn,onChange:h,required:!0}),l.jsx("div",{className:"text-xs text-gray-500 self-end",children:"SSN / Tax ID is an encrypted attribute"})]})]})})]}),l.jsxs("section",{className:"rounded-2xl border border-gray-200 bg-white shadow-sm",children:[l.jsx("div",{className:"p-6 border-b",children:l.jsx("h3",{className:"text-xl font-semibold",children:"Residential Address"})}),l.jsxs("div",{className:"p-6 grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsx("div",{className:"md:col-span-2",children:l.jsx(wa,{label:"Street Address 1",name:"address1",value:t.address1,onChange:h,required:!0})}),l.jsx("div",{className:"md:col-span-2",children:l.jsx(wa,{label:"Street Address 2 (Optional)",name:"address2",value:t.address2,onChange:h})}),l.jsx(wa,{label:"Country",name:"country",value:t.country,onChange:h,required:!0}),l.jsx(wa,{label:"City",name:"city",value:t.city,onChange:h,required:!0}),l.jsx(wa,{label:"State / Province",name:"state",value:t.state,onChange:h,required:!0}),l.jsx(wa,{label:"Zip / Postal Code",name:"zip",value:t.zip,onChange:h,required:!0})]})]}),u&&l.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 text-rose-700 px-4 py-3",children:u}),i&&l.jsx("div",{className:"rounded-xl border border-emerald-200 bg-emerald-50 text-emerald-700 px-4 py-3",children:i}),l.jsx("div",{children:l.jsx("button",{type:"submit",disabled:n,className:"inline-flex items-center justify-center rounded-xl bg-indigo-600 text-white font-medium px-6 py-3 shadow hover:brightness-110 active:scale-[0.99] disabled:opacity-60",children:n?"Saving":"Save Manual Entry"})})]})})}function wa({label:e,name:t,value:r,onChange:n,required:a,type:i="text",placeholder:o=""}){return l.jsxs("div",{className:"space-y-1",children:[l.jsxs("label",{className:"block text-sm font-semibold text-gray-700",children:[e,a&&l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{name:t,type:i,value:r,onChange:n,placeholder:o,required:a,className:"w-full rounded-lg border px-3 py-2.5 bg-gray-50 focus:bg-white focus:outline-none focus:ring-4 focus:ring-indigo-100 border-gray-300"})]})}function B5(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=B5(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function $t(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=B5(e))&&(n&&(n+=" "),n+=t);return n}var Eg={},Ag={},F_;function qG(){return F_||(F_=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t}(Ag)),Ag}var _g={},I_;function U5(){return I_||(I_=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t}(_g)),_g}var Tg={},L_;function $5(){return L_||(L_=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}e.toKey=t}(Tg)),Tg}var kg={},B_;function x2(){return B_||(B_=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){const n=[],a=r.length;if(a===0)return n;let i=0,o="",u="",m=!1;for(r.charCodeAt(0)===46&&(n.push(""),i++);i<a;){const f=r[i];u?f==="\\"&&i+1<a?(i++,o+=r[i]):f===u?u="":o+=f:m?f==='"'||f==="'"?u=f:f==="]"?(m=!1,n.push(o),o=""):o+=f:f==="["?(m=!0,o&&(n.push(o),o="")):f==="."?o&&(n.push(o),o=""):o+=f,i++}return o&&n.push(o),n}e.toPath=t}(kg)),kg}var U_;function v2(){return U_||(U_=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=qG(),r=U5(),n=$5(),a=x2();function i(u,m,f){if(u==null)return f;switch(typeof m){case"string":{if(t.isUnsafeProperty(m))return f;const h=u[m];return h===void 0?r.isDeepKey(m)?i(u,a.toPath(m),f):f:h}case"number":case"symbol":{typeof m=="number"&&(m=n.toKey(m));const h=u[m];return h===void 0?f:h}default:{if(Array.isArray(m))return o(u,m,f);if(Object.is(m?.valueOf(),-0)?m="-0":m=String(m),t.isUnsafeProperty(m))return f;const h=u[m];return h===void 0?f:h}}}function o(u,m,f){if(m.length===0)return f;let h=u;for(let x=0;x<m.length;x++){if(h==null||t.isUnsafeProperty(m[x]))return f;h=h[m[x]]}return h===void 0?f:h}e.get=i}(Eg)),Eg}var Cg,$_;function VG(){return $_||($_=1,Cg=v2().get),Cg}var KG=VG();const Ol=fi(KG);var Og={exports:{}},dr={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var z_;function GG(){if(z_)return dr;z_=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),o=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),f=Symbol.for("react.suspense_list"),h=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),v=Symbol.for("react.view_transition"),y=Symbol.for("react.client.reference");function w(b){if(typeof b=="object"&&b!==null){var S=b.$$typeof;switch(S){case e:switch(b=b.type,b){case r:case a:case n:case m:case f:case v:return b;default:switch(b=b&&b.$$typeof,b){case o:case u:case x:case h:return b;case i:return b;default:return S}}case t:return S}}}return dr.ContextConsumer=i,dr.ContextProvider=o,dr.Element=e,dr.ForwardRef=u,dr.Fragment=r,dr.Lazy=x,dr.Memo=h,dr.Portal=t,dr.Profiler=a,dr.StrictMode=n,dr.Suspense=m,dr.SuspenseList=f,dr.isContextConsumer=function(b){return w(b)===i},dr.isContextProvider=function(b){return w(b)===o},dr.isElement=function(b){return typeof b=="object"&&b!==null&&b.$$typeof===e},dr.isForwardRef=function(b){return w(b)===u},dr.isFragment=function(b){return w(b)===r},dr.isLazy=function(b){return w(b)===x},dr.isMemo=function(b){return w(b)===h},dr.isPortal=function(b){return w(b)===t},dr.isProfiler=function(b){return w(b)===a},dr.isStrictMode=function(b){return w(b)===n},dr.isSuspense=function(b){return w(b)===m},dr.isSuspenseList=function(b){return w(b)===f},dr.isValidElementType=function(b){return typeof b=="string"||typeof b=="function"||b===r||b===a||b===n||b===m||b===f||typeof b=="object"&&b!==null&&(b.$$typeof===x||b.$$typeof===h||b.$$typeof===o||b.$$typeof===i||b.$$typeof===u||b.$$typeof===y||b.getModuleId!==void 0)},dr.typeOf=w,dr}var H_;function WG(){return H_||(H_=1,Og.exports=GG()),Og.exports}var XG=WG(),Gr=e=>e===0?0:e>0?1:-1,Fa=e=>typeof e=="number"&&e!=+e,uo=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,ot=e=>(typeof e=="number"||e instanceof Number)&&!Fa(e),Wi=e=>ot(e)||typeof e=="string",YG=0,Dl=e=>{var t=++YG;return"".concat(e||"").concat(t)},Zn=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!ot(t)&&typeof t!="string")return n;var i;if(uo(t)){if(r==null)return n;var o=t.indexOf("%");i=r*parseFloat(t.slice(0,o))/100}else i=+t;return Fa(i)&&(i=n),a&&r!=null&&i>r&&(i=r),i},z5=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[e[n]])r[e[n]]=!0;else return!0;return!1},Kr=(e,t)=>ot(e)&&ot(t)?r=>e+r*(t-e):()=>t;function H5(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):Ol(n,t))===r)}var ZG=e=>{if(!e||!e.length)return null;for(var t=e.length,r=0,n=0,a=0,i=0,o=1/0,u=-1/0,m=0,f=0,h=0;h<t;h++)m=e[h].cx||0,f=e[h].cy||0,r+=m,n+=f,a+=m*f,i+=m*m,o=Math.min(o,m),u=Math.max(u,m);var x=t*i!==r*r?(t*a-r*n)/(t*i-r*r):0;return{xmin:o,xmax:u,a:x,b:(n-x*r)/t}},qt=e=>e===null||typeof e>"u",Ef=e=>qt(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),QG=["viewBox","children"],JG=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],q_=["points","pathLength"],Dg={svg:QG,polygon:q_,polyline:q_},g2=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],y2=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(g.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(a=>{g2.includes(a)&&(n[a]=i=>r[a](r,i))}),n},eW=(e,t,r)=>n=>(e(t,r,n),null),Pl=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(a=>{var i=e[a];g2.includes(a)&&typeof i=="function"&&(n||(n={}),n[a]=eW(i,t,r))}),n},V_=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",K_=null,Pg=null,q5=e=>{if(e===K_&&Array.isArray(Pg))return Pg;var t=[];return g.Children.forEach(e,r=>{qt(r)||(XG.isFragment(r)?t=t.concat(q5(r.props.children)):t.push(r))}),Pg=t,K_=e,t};function Lo(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(a=>V_(a)):n=[V_(t)],q5(e).forEach(a=>{var i=Ol(a,"type.displayName")||Ol(a,"type.name");n.indexOf(i)!==-1&&r.push(a)}),r}var V5=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,tW=(e,t,r,n)=>{var a,i=(a=n&&Dg?.[n])!==null&&a!==void 0?a:[];return t.startsWith("data-")||typeof e!="function"&&(n&&i.includes(t)||JG.includes(t))||r&&g2.includes(t)},kt=(e,t,r)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(g.isValidElement(e)&&(n=e.props),typeof n!="object"&&typeof n!="function")return null;var a={};return Object.keys(n).forEach(i=>{var o;tW((o=n)===null||o===void 0?void 0:o[i],i,t,r)&&(a[i]=n[i])}),a},rW=["children","width","height","viewBox","className","style","title","desc"];function Py(){return Py=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Py.apply(null,arguments)}function nW(e,t){if(e==null)return{};var r,n,a=aW(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function aW(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var b2=g.forwardRef((e,t)=>{var{children:r,width:n,height:a,viewBox:i,className:o,style:u,title:m,desc:f}=e,h=nW(e,rW),x=i||{width:n,height:a,x:0,y:0},v=$t("recharts-surface",o);return g.createElement("svg",Py({},kt(h,!0,"svg"),{className:v,width:n,height:a,style:u,viewBox:"".concat(x.x," ").concat(x.y," ").concat(x.width," ").concat(x.height),ref:t}),g.createElement("title",null,m),g.createElement("desc",null,f),r)}),iW=["children","className"];function Ry(){return Ry=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ry.apply(null,arguments)}function sW(e,t){if(e==null)return{};var r,n,a=lW(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function lW(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var mr=g.forwardRef((e,t)=>{var{children:r,className:n}=e,a=sW(e,iW),i=$t("recharts-layer",n);return g.createElement("g",Ry({className:i},kt(a,!0),{ref:t}),r)}),K5=g.createContext(null),oW=()=>g.useContext(K5);function xr(e){return function(){return e}}const G5=Math.cos,Jh=Math.sin,Pi=Math.sqrt,em=Math.PI,rp=2*em,My=Math.PI,Fy=2*My,no=1e-6,cW=Fy-no;function W5(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function uW(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return W5;const r=10**t;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class dW{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?W5:uW(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,o){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+o}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let o=this._x1,u=this._y1,m=n-t,f=a-r,h=o-t,x=u-r,v=h*h+x*x;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(v>no)if(!(Math.abs(x*m-f*h)>no)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let y=n-o,w=a-u,b=m*m+f*f,S=y*y+w*w,N=Math.sqrt(b),_=Math.sqrt(v),A=i*Math.tan((My-Math.acos((b+v-S)/(2*N*_)))/2),k=A/_,C=A/N;Math.abs(k-1)>no&&this._append`L${t+k*h},${r+k*x}`,this._append`A${i},${i},0,0,${+(x*y>h*w)},${this._x1=t+C*m},${this._y1=r+C*f}`}}arc(t,r,n,a,i,o){if(t=+t,r=+r,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let u=n*Math.cos(a),m=n*Math.sin(a),f=t+u,h=r+m,x=1^o,v=o?a-i:i-a;this._x1===null?this._append`M${f},${h}`:(Math.abs(this._x1-f)>no||Math.abs(this._y1-h)>no)&&this._append`L${f},${h}`,n&&(v<0&&(v=v%Fy+Fy),v>cW?this._append`A${n},${n},0,1,${x},${t-u},${r-m}A${n},${n},0,1,${x},${this._x1=f},${this._y1=h}`:v>no&&this._append`A${n},${n},0,${+(v>=My)},${x},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function w2(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new dW(t)}function S2(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function X5(e){this._context=e}X5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function np(e){return new X5(e)}function Y5(e){return e[0]}function Z5(e){return e[1]}function Q5(e,t){var r=xr(!0),n=null,a=np,i=null,o=w2(u);e=typeof e=="function"?e:e===void 0?Y5:xr(e),t=typeof t=="function"?t:t===void 0?Z5:xr(t);function u(m){var f,h=(m=S2(m)).length,x,v=!1,y;for(n==null&&(i=a(y=o())),f=0;f<=h;++f)!(f<h&&r(x=m[f],f,m))===v&&((v=!v)?i.lineStart():i.lineEnd()),v&&i.point(+e(x,f,m),+t(x,f,m));if(y)return i=null,y+""||null}return u.x=function(m){return arguments.length?(e=typeof m=="function"?m:xr(+m),u):e},u.y=function(m){return arguments.length?(t=typeof m=="function"?m:xr(+m),u):t},u.defined=function(m){return arguments.length?(r=typeof m=="function"?m:xr(!!m),u):r},u.curve=function(m){return arguments.length?(a=m,n!=null&&(i=a(n)),u):a},u.context=function(m){return arguments.length?(m==null?n=i=null:i=a(n=m),u):n},u}function fh(e,t,r){var n=null,a=xr(!0),i=null,o=np,u=null,m=w2(f);e=typeof e=="function"?e:e===void 0?Y5:xr(+e),t=typeof t=="function"?t:xr(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?Z5:xr(+r);function f(x){var v,y,w,b=(x=S2(x)).length,S,N=!1,_,A=new Array(b),k=new Array(b);for(i==null&&(u=o(_=m())),v=0;v<=b;++v){if(!(v<b&&a(S=x[v],v,x))===N)if(N=!N)y=v,u.areaStart(),u.lineStart();else{for(u.lineEnd(),u.lineStart(),w=v-1;w>=y;--w)u.point(A[w],k[w]);u.lineEnd(),u.areaEnd()}N&&(A[v]=+e(S,v,x),k[v]=+t(S,v,x),u.point(n?+n(S,v,x):A[v],r?+r(S,v,x):k[v]))}if(_)return u=null,_+""||null}function h(){return Q5().defined(a).curve(o).context(i)}return f.x=function(x){return arguments.length?(e=typeof x=="function"?x:xr(+x),n=null,f):e},f.x0=function(x){return arguments.length?(e=typeof x=="function"?x:xr(+x),f):e},f.x1=function(x){return arguments.length?(n=x==null?null:typeof x=="function"?x:xr(+x),f):n},f.y=function(x){return arguments.length?(t=typeof x=="function"?x:xr(+x),r=null,f):t},f.y0=function(x){return arguments.length?(t=typeof x=="function"?x:xr(+x),f):t},f.y1=function(x){return arguments.length?(r=x==null?null:typeof x=="function"?x:xr(+x),f):r},f.lineX0=f.lineY0=function(){return h().x(e).y(t)},f.lineY1=function(){return h().x(e).y(r)},f.lineX1=function(){return h().x(n).y(t)},f.defined=function(x){return arguments.length?(a=typeof x=="function"?x:xr(!!x),f):a},f.curve=function(x){return arguments.length?(o=x,i!=null&&(u=o(i)),f):o},f.context=function(x){return arguments.length?(x==null?i=u=null:u=o(i=x),f):i},f}class J5{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function fW(e){return new J5(e,!0)}function hW(e){return new J5(e,!1)}const j2={draw(e,t){const r=Pi(t/em);e.moveTo(r,0),e.arc(0,0,r,0,rp)}},mW={draw(e,t){const r=Pi(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},e6=Pi(1/3),pW=e6*2,xW={draw(e,t){const r=Pi(t/pW),n=r*e6;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},vW={draw(e,t){const r=Pi(t),n=-r/2;e.rect(n,n,r,r)}},gW=.8908130915292852,t6=Jh(em/10)/Jh(7*em/10),yW=Jh(rp/10)*t6,bW=-G5(rp/10)*t6,wW={draw(e,t){const r=Pi(t*gW),n=yW*r,a=bW*r;e.moveTo(0,-r),e.lineTo(n,a);for(let i=1;i<5;++i){const o=rp*i/5,u=G5(o),m=Jh(o);e.lineTo(m*r,-u*r),e.lineTo(u*n-m*a,m*n+u*a)}e.closePath()}},Rg=Pi(3),SW={draw(e,t){const r=-Pi(t/(Rg*3));e.moveTo(0,r*2),e.lineTo(-Rg*r,-r),e.lineTo(Rg*r,-r),e.closePath()}},Ya=-.5,Za=Pi(3)/2,Iy=1/Pi(12),jW=(Iy/2+1)*3,NW={draw(e,t){const r=Pi(t/jW),n=r/2,a=r*Iy,i=n,o=r*Iy+r,u=-i,m=o;e.moveTo(n,a),e.lineTo(i,o),e.lineTo(u,m),e.lineTo(Ya*n-Za*a,Za*n+Ya*a),e.lineTo(Ya*i-Za*o,Za*i+Ya*o),e.lineTo(Ya*u-Za*m,Za*u+Ya*m),e.lineTo(Ya*n+Za*a,Ya*a-Za*n),e.lineTo(Ya*i+Za*o,Ya*o-Za*i),e.lineTo(Ya*u+Za*m,Ya*m-Za*u),e.closePath()}};function EW(e,t){let r=null,n=w2(a);e=typeof e=="function"?e:xr(e||j2),t=typeof t=="function"?t:xr(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:xr(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:xr(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function tm(){}function rm(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function r6(e){this._context=e}r6.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:rm(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:rm(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function AW(e){return new r6(e)}function n6(e){this._context=e}n6.prototype={areaStart:tm,areaEnd:tm,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:rm(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function _W(e){return new n6(e)}function a6(e){this._context=e}a6.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:rm(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function TW(e){return new a6(e)}function i6(e){this._context=e}i6.prototype={areaStart:tm,areaEnd:tm,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function kW(e){return new i6(e)}function G_(e){return e<0?-1:1}function W_(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),o=(r-e._y1)/(a||n<0&&-0),u=(i*a+o*n)/(n+a);return(G_(i)+G_(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(u))||0}function X_(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Mg(e,t,r){var n=e._x0,a=e._y0,i=e._x1,o=e._y1,u=(i-n)/3;e._context.bezierCurveTo(n+u,a+u*t,i-u,o-u*r,i,o)}function nm(e){this._context=e}nm.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Mg(this,this._t0,X_(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Mg(this,X_(this,r=W_(this,e,t)),r);break;default:Mg(this,this._t0,r=W_(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function s6(e){this._context=new l6(e)}(s6.prototype=Object.create(nm.prototype)).point=function(e,t){nm.prototype.point.call(this,t,e)};function l6(e){this._context=e}l6.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function CW(e){return new nm(e)}function OW(e){return new s6(e)}function o6(e){this._context=e}o6.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=Y_(e),a=Y_(t),i=0,o=1;o<r;++i,++o)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[o],t[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function Y_(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),o=new Array(r);for(a[0]=0,i[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,o[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,o[t]-=n*o[t-1];for(a[r-1]=o[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(o[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function DW(e){return new o6(e)}function ap(e,t){this._context=e,this._t=t}ap.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function PW(e){return new ap(e,.5)}function RW(e){return new ap(e,0)}function MW(e){return new ap(e,1)}function Uc(e,t){if((o=e.length)>1)for(var r=1,n,a,i=e[t[0]],o,u=i.length;r<o;++r)for(a=i,i=e[t[r]],n=0;n<u;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function Ly(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function FW(e,t){return e[t]}function IW(e){const t=[];return t.key=e,t}function LW(){var e=xr([]),t=Ly,r=Uc,n=FW;function a(i){var o=Array.from(e.apply(this,arguments),IW),u,m=o.length,f=-1,h;for(const x of i)for(u=0,++f;u<m;++u)(o[u][f]=[0,+n(x,o[u].key,f,i)]).data=x;for(u=0,h=S2(t(o));u<m;++u)o[h[u]].index=u;return r(o,h),o}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:xr(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:xr(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?Ly:typeof i=="function"?i:xr(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??Uc,a):r},a}function BW(e,t){if((n=e.length)>0){for(var r,n,a=0,i=e[0].length,o;a<i;++a){for(o=r=0;r<n;++r)o+=e[r][a][1]||0;if(o)for(r=0;r<n;++r)e[r][a][1]/=o}Uc(e,t)}}function UW(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var o=0,u=0;o<a;++o)u+=e[o][r][1]||0;n[r][1]+=n[r][0]=-u/2}Uc(e,t)}}function $W(e,t){if(!(!((o=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,i,o;n<i;++n){for(var u=0,m=0,f=0;u<o;++u){for(var h=e[t[u]],x=h[n][1]||0,v=h[n-1][1]||0,y=(x-v)/2,w=0;w<u;++w){var b=e[t[w]],S=b[n][1]||0,N=b[n-1][1]||0;y+=S-N}m+=x,f+=y*x}a[n-1][1]+=a[n-1][0]=r,m&&(r-=f/m)}a[n-1][1]+=a[n-1][0]=r,Uc(e,t)}}var zW=["type","size","sizeType"];function By(){return By=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},By.apply(null,arguments)}function Z_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Q_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Z_(Object(r),!0).forEach(function(n){HW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function HW(e,t,r){return(t=qW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qW(e){var t=VW(e,"string");return typeof t=="symbol"?t:t+""}function VW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function KW(e,t){if(e==null)return{};var r,n,a=GW(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function GW(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var c6={symbolCircle:j2,symbolCross:mW,symbolDiamond:xW,symbolSquare:vW,symbolStar:wW,symbolTriangle:SW,symbolWye:NW},WW=Math.PI/180,XW=e=>{var t="symbol".concat(Ef(e));return c6[t]||j2},YW=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*WW;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},ZW=(e,t)=>{c6["symbol".concat(Ef(e))]=t},ip=e=>{var{type:t="circle",size:r=64,sizeType:n="area"}=e,a=KW(e,zW),i=Q_(Q_({},a),{},{type:t,size:r,sizeType:n}),o=()=>{var x=XW(t),v=EW().type(x).size(YW(r,n,t));return v()},{className:u,cx:m,cy:f}=i,h=kt(i,!0);return m===+m&&f===+f&&r===+r?g.createElement("path",By({},h,{className:$t("recharts-symbols",u),transform:"translate(".concat(m,", ").concat(f,")"),d:o()})):null};ip.registerSymbol=ZW;function Uy(){return Uy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Uy.apply(null,arguments)}function J_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function QW(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?J_(Object(r),!0).forEach(function(n){N2(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function N2(e,t,r){return(t=JW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JW(e){var t=eX(e,"string");return typeof t=="symbol"?t:t+""}function eX(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qa=32;class E2 extends g.PureComponent{renderIcon(t,r){var{inactiveColor:n}=this.props,a=Qa/2,i=Qa/6,o=Qa/3,u=t.inactive?n:t.color,m=r??t.type;if(m==="none")return null;if(m==="plainline")return g.createElement("line",{strokeWidth:4,fill:"none",stroke:u,strokeDasharray:t.payload.strokeDasharray,x1:0,y1:a,x2:Qa,y2:a,className:"recharts-legend-icon"});if(m==="line")return g.createElement("path",{strokeWidth:4,fill:"none",stroke:u,d:"M0,".concat(a,"h").concat(o,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(2*o,",").concat(a,`
            H`).concat(Qa,"M").concat(2*o,",").concat(a,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(o,",").concat(a),className:"recharts-legend-icon"});if(m==="rect")return g.createElement("path",{stroke:"none",fill:u,d:"M0,".concat(Qa/8,"h").concat(Qa,"v").concat(Qa*3/4,"h").concat(-Qa,"z"),className:"recharts-legend-icon"});if(g.isValidElement(t.legendIcon)){var f=QW({},t);return delete f.legendIcon,g.cloneElement(t.legendIcon,f)}return g.createElement(ip,{fill:u,cx:a,cy:a,size:Qa,sizeType:"diameter",type:m})}renderItems(){var{payload:t,iconSize:r,layout:n,formatter:a,inactiveColor:i,iconType:o}=this.props,u={x:0,y:0,width:Qa,height:Qa},m={display:n==="horizontal"?"inline-block":"block",marginRight:10},f={display:"inline-block",verticalAlign:"middle",marginRight:4};return t.map((h,x)=>{var v=h.formatter||a,y=$t({"recharts-legend-item":!0,["legend-item-".concat(x)]:!0,inactive:h.inactive});if(h.type==="none")return null;var w=h.inactive?i:h.color,b=v?v(h.value,h,x):h.value;return g.createElement("li",Uy({className:y,style:m,key:"legend-item-".concat(x)},Pl(this.props,h,x)),g.createElement(b2,{width:r,height:r,viewBox:u,style:f,"aria-label":"".concat(b," legend icon")},this.renderIcon(h,o)),g.createElement("span",{className:"recharts-legend-item-text",style:{color:w}},b))})}render(){var{payload:t,layout:r,align:n}=this.props;if(!t||!t.length)return null;var a={padding:0,margin:0,textAlign:r==="horizontal"?n:"left"};return g.createElement("ul",{className:"recharts-default-legend",style:a},this.renderItems())}}N2(E2,"displayName","Legend");N2(E2,"defaultProps",{align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"});var Fg={},Ig={},e4;function tX(){return e4||(e4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const a=new Map;for(let i=0;i<r.length;i++){const o=r[i],u=n(o);a.has(u)||a.set(u,o)}return Array.from(a.values())}e.uniqBy=t}(Ig)),Ig}var Lg={},t4;function u6(){return t4||(t4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t}(Lg)),Lg}var Bg={},Ug={},$g={},r4;function rX(){return r4||(r4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t}($g)),$g}var n4;function A2(){return n4||(n4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=rX();function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r}(Ug)),Ug}var zg={},a4;function nX(){return a4||(a4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t}(zg)),zg}var i4;function aX(){return i4||(i4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=A2(),r=nX();function n(a){return r.isObjectLike(a)&&t.isArrayLike(a)}e.isArrayLikeObject=n}(Bg)),Bg}var Hg={},qg={},s4;function iX(){return s4||(s4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=v2();function r(n){return function(a){return t.get(a,n)}}e.property=r}(qg)),qg}var Vg={},Kg={},Gg={},Wg={},l4;function d6(){return l4||(l4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t}(Wg)),Wg}var Xg={},o4;function f6(){return o4||(o4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t}(Xg)),Xg}var Yg={},c4;function _2(){return c4||(c4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.eq=t}(Yg)),Yg}var u4;function sX(){return u4||(u4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=T2(),r=d6(),n=f6(),a=_2();function i(x,v,y){return typeof y!="function"?t.isMatch(x,v):o(x,v,function w(b,S,N,_,A,k){const C=y(b,S,N,_,A,k);return C!==void 0?!!C:o(b,S,w,k)},new Map)}function o(x,v,y,w){if(v===x)return!0;switch(typeof v){case"object":return u(x,v,y,w);case"function":return Object.keys(v).length>0?o(x,{...v},y,w):a.eq(x,v);default:return r.isObject(x)?typeof v=="string"?v==="":!0:a.eq(x,v)}}function u(x,v,y,w){if(v==null)return!0;if(Array.isArray(v))return f(x,v,y,w);if(v instanceof Map)return m(x,v,y,w);if(v instanceof Set)return h(x,v,y,w);const b=Object.keys(v);if(x==null)return b.length===0;if(b.length===0)return!0;if(w&&w.has(v))return w.get(v)===x;w&&w.set(v,x);try{for(let S=0;S<b.length;S++){const N=b[S];if(!n.isPrimitive(x)&&!(N in x)||v[N]===void 0&&x[N]!==void 0||v[N]===null&&x[N]!==null||!y(x[N],v[N],N,x,v,w))return!1}return!0}finally{w&&w.delete(v)}}function m(x,v,y,w){if(v.size===0)return!0;if(!(x instanceof Map))return!1;for(const[b,S]of v.entries()){const N=x.get(b);if(y(N,S,b,x,v,w)===!1)return!1}return!0}function f(x,v,y,w){if(v.length===0)return!0;if(!Array.isArray(x))return!1;const b=new Set;for(let S=0;S<v.length;S++){const N=v[S];let _=!1;for(let A=0;A<x.length;A++){if(b.has(A))continue;const k=x[A];let C=!1;if(y(k,N,S,x,v,w)&&(C=!0),C){b.add(A),_=!0;break}}if(!_)return!1}return!0}function h(x,v,y,w){return v.size===0?!0:x instanceof Set?f([...x],[...v],y,w):!1}e.isMatchWith=i,e.isSetMatch=h}(Gg)),Gg}var d4;function T2(){return d4||(d4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=sX();function r(n,a){return t.isMatchWith(n,a,()=>{})}e.isMatch=r}(Kg)),Kg}var Zg={},Qg={},Jg={},f4;function h6(){return f4||(f4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t}(Jg)),Jg}var e1={},h4;function k2(){return h4||(h4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t}(e1)),e1}var t1={},m4;function C2(){return m4||(m4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",a="[object Boolean]",i="[object Arguments]",o="[object Symbol]",u="[object Date]",m="[object Map]",f="[object Set]",h="[object Array]",x="[object Function]",v="[object ArrayBuffer]",y="[object Object]",w="[object Error]",b="[object DataView]",S="[object Uint8Array]",N="[object Uint8ClampedArray]",_="[object Uint16Array]",A="[object Uint32Array]",k="[object BigUint64Array]",C="[object Int8Array]",O="[object Int16Array]",T="[object Int32Array]",z="[object BigInt64Array]",P="[object Float32Array]",Z="[object Float64Array]";e.argumentsTag=i,e.arrayBufferTag=v,e.arrayTag=h,e.bigInt64ArrayTag=z,e.bigUint64ArrayTag=k,e.booleanTag=a,e.dataViewTag=b,e.dateTag=u,e.errorTag=w,e.float32ArrayTag=P,e.float64ArrayTag=Z,e.functionTag=x,e.int16ArrayTag=O,e.int32ArrayTag=T,e.int8ArrayTag=C,e.mapTag=m,e.numberTag=n,e.objectTag=y,e.regexpTag=t,e.setTag=f,e.stringTag=r,e.symbolTag=o,e.uint16ArrayTag=_,e.uint32ArrayTag=A,e.uint8ArrayTag=S,e.uint8ClampedArrayTag=N}(t1)),t1}var r1={},p4;function lX(){return p4||(p4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t}(r1)),r1}var x4;function m6(){return x4||(x4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=h6(),r=k2(),n=C2(),a=f6(),i=lX();function o(h,x){return u(h,void 0,h,new Map,x)}function u(h,x,v,y=new Map,w=void 0){const b=w?.(h,x,v,y);if(b!=null)return b;if(a.isPrimitive(h))return h;if(y.has(h))return y.get(h);if(Array.isArray(h)){const S=new Array(h.length);y.set(h,S);for(let N=0;N<h.length;N++)S[N]=u(h[N],N,v,y,w);return Object.hasOwn(h,"index")&&(S.index=h.index),Object.hasOwn(h,"input")&&(S.input=h.input),S}if(h instanceof Date)return new Date(h.getTime());if(h instanceof RegExp){const S=new RegExp(h.source,h.flags);return S.lastIndex=h.lastIndex,S}if(h instanceof Map){const S=new Map;y.set(h,S);for(const[N,_]of h)S.set(N,u(_,N,v,y,w));return S}if(h instanceof Set){const S=new Set;y.set(h,S);for(const N of h)S.add(u(N,void 0,v,y,w));return S}if(typeof Buffer<"u"&&Buffer.isBuffer(h))return h.subarray();if(i.isTypedArray(h)){const S=new(Object.getPrototypeOf(h)).constructor(h.length);y.set(h,S);for(let N=0;N<h.length;N++)S[N]=u(h[N],N,v,y,w);return S}if(h instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&h instanceof SharedArrayBuffer)return h.slice(0);if(h instanceof DataView){const S=new DataView(h.buffer.slice(0),h.byteOffset,h.byteLength);return y.set(h,S),m(S,h,v,y,w),S}if(typeof File<"u"&&h instanceof File){const S=new File([h],h.name,{type:h.type});return y.set(h,S),m(S,h,v,y,w),S}if(h instanceof Blob){const S=new Blob([h],{type:h.type});return y.set(h,S),m(S,h,v,y,w),S}if(h instanceof Error){const S=new h.constructor;return y.set(h,S),S.message=h.message,S.name=h.name,S.stack=h.stack,S.cause=h.cause,m(S,h,v,y,w),S}if(typeof h=="object"&&f(h)){const S=Object.create(Object.getPrototypeOf(h));return y.set(h,S),m(S,h,v,y,w),S}return h}function m(h,x,v=h,y,w){const b=[...Object.keys(x),...t.getSymbols(x)];for(let S=0;S<b.length;S++){const N=b[S],_=Object.getOwnPropertyDescriptor(h,N);(_==null||_.writable)&&(h[N]=u(x[N],N,v,y,w))}}function f(h){switch(r.getTag(h)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=o,e.cloneDeepWithImpl=u,e.copyProperties=m}(Qg)),Qg}var v4;function oX(){return v4||(v4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=m6();function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r}(Zg)),Zg}var g4;function cX(){return g4||(g4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=T2(),r=oX();function n(a){return a=r.cloneDeep(a),i=>t.isMatch(i,a)}e.matches=n}(Vg)),Vg}var n1={},a1={},i1={},y4;function uX(){return y4||(y4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=m6(),r=C2();function n(a,i){return t.cloneDeepWith(a,(o,u,m,f)=>{const h=i?.(o,u,m,f);if(h!=null)return h;if(typeof a=="object")switch(Object.prototype.toString.call(a)){case r.numberTag:case r.stringTag:case r.booleanTag:{const x=new a.constructor(a?.valueOf());return t.copyProperties(x,a),x}case r.argumentsTag:{const x={};return t.copyProperties(x,a),x.length=a.length,x[Symbol.iterator]=a[Symbol.iterator],x}default:return}})}e.cloneDeepWith=n}(i1)),i1}var b4;function dX(){return b4||(b4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=uX();function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r}(a1)),a1}var s1={},l1={},w4;function p6(){return w4||(w4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,a=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<a;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r}(l1)),l1}var o1={},S4;function fX(){return S4||(S4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=k2();function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r}(o1)),o1}var j4;function hX(){return j4||(j4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=U5(),r=p6(),n=fX(),a=x2();function i(o,u){let m;if(Array.isArray(u)?m=u:typeof u=="string"&&t.isDeepKey(u)&&o?.[u]==null?m=a.toPath(u):m=[u],m.length===0)return!1;let f=o;for(let h=0;h<m.length;h++){const x=m[h];if((f==null||!Object.hasOwn(f,x))&&!((Array.isArray(f)||n.isArguments(f))&&r.isIndex(x)&&x<f.length))return!1;f=f[x]}return!0}e.has=i}(s1)),s1}var N4;function mX(){return N4||(N4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=T2(),r=$5(),n=dX(),a=v2(),i=hX();function o(u,m){switch(typeof u){case"object":{Object.is(u?.valueOf(),-0)&&(u="-0");break}case"number":{u=r.toKey(u);break}}return m=n.cloneDeep(m),function(f){const h=a.get(f,u);return h===void 0?i.has(f,u):m===void 0?h===void 0:t.isMatch(h,m)}}e.matchesProperty=o}(n1)),n1}var E4;function pX(){return E4||(E4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=u6(),r=iX(),n=cX(),a=mX();function i(o){if(o==null)return t.identity;switch(typeof o){case"function":return o;case"object":return Array.isArray(o)&&o.length===2?a.matchesProperty(o[0],o[1]):n.matches(o);case"string":case"symbol":case"number":return r.property(o)}}e.iteratee=i}(Hg)),Hg}var A4;function xX(){return A4||(A4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=tX(),r=u6(),n=aX(),a=pX();function i(o,u=r.identity){return n.isArrayLikeObject(o)?t.uniqBy(Array.from(o),a.iteratee(u)):[]}e.uniqBy=i}(Fg)),Fg}var c1,_4;function vX(){return _4||(_4=1,c1=xX().uniqBy),c1}var gX=vX();const T4=fi(gX);function x6(e,t,r){return t===!0?T4(e,r):typeof t=="function"?T4(e,t):e}var u1={exports:{}},d1={},f1={exports:{}},h1={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var k4;function yX(){if(k4)return h1;k4=1;var e=Qc();function t(x,v){return x===v&&(x!==0||1/x===1/v)||x!==x&&v!==v}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,a=e.useEffect,i=e.useLayoutEffect,o=e.useDebugValue;function u(x,v){var y=v(),w=n({inst:{value:y,getSnapshot:v}}),b=w[0].inst,S=w[1];return i(function(){b.value=y,b.getSnapshot=v,m(b)&&S({inst:b})},[x,y,v]),a(function(){return m(b)&&S({inst:b}),x(function(){m(b)&&S({inst:b})})},[x]),o(y),y}function m(x){var v=x.getSnapshot;x=x.value;try{var y=v();return!r(x,y)}catch{return!0}}function f(x,v){return v()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?f:u;return h1.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:h,h1}var C4;function bX(){return C4||(C4=1,f1.exports=yX()),f1.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var O4;function wX(){if(O4)return d1;O4=1;var e=Qc(),t=bX();function r(f,h){return f===h&&(f!==0||1/f===1/h)||f!==f&&h!==h}var n=typeof Object.is=="function"?Object.is:r,a=t.useSyncExternalStore,i=e.useRef,o=e.useEffect,u=e.useMemo,m=e.useDebugValue;return d1.useSyncExternalStoreWithSelector=function(f,h,x,v,y){var w=i(null);if(w.current===null){var b={hasValue:!1,value:null};w.current=b}else b=w.current;w=u(function(){function N(O){if(!_){if(_=!0,A=O,O=v(O),y!==void 0&&b.hasValue){var T=b.value;if(y(T,O))return k=T}return k=O}if(T=k,n(A,O))return T;var z=v(O);return y!==void 0&&y(T,z)?(A=O,T):(A=O,k=z)}var _=!1,A,k,C=x===void 0?null:x;return[function(){return N(h())},C===null?void 0:function(){return N(C())}]},[h,x,v,y]);var S=a(f,w[0],w[1]);return o(function(){b.hasValue=!0,b.value=S},[S]),m(S),S},d1}var D4;function SX(){return D4||(D4=1,u1.exports=wX()),u1.exports}var jX=SX(),O2=g.createContext(null),NX=e=>e,br=()=>{var e=g.useContext(O2);return e?e.store.dispatch:NX},Fh=()=>{},EX=()=>Fh,AX=(e,t)=>e===t;function lt(e){var t=g.useContext(O2);return jX.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:EX,t?t.store.getState:Fh,t?t.store.getState:Fh,t?e:Fh,AX)}function _X(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function TX(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function kX(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var P4=e=>Array.isArray(e)?e:[e];function CX(e){const t=Array.isArray(e[0])?e[0]:e;return kX(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function OX(e,t){const r=[],{length:n}=e;for(let a=0;a<n;a++)r.push(e[a].apply(null,t));return r}var DX=class{constructor(e){this.value=e}deref(){return this.value}},PX=typeof WeakRef<"u"?WeakRef:DX,RX=0,R4=1;function hh(){return{s:RX,v:void 0,o:null,p:null}}function v6(e,t={}){let r=hh();const{resultEqualityCheck:n}=t;let a,i=0;function o(){let u=r;const{length:m}=arguments;for(let x=0,v=m;x<v;x++){const y=arguments[x];if(typeof y=="function"||typeof y=="object"&&y!==null){let w=u.o;w===null&&(u.o=w=new WeakMap);const b=w.get(y);b===void 0?(u=hh(),w.set(y,u)):u=b}else{let w=u.p;w===null&&(u.p=w=new Map);const b=w.get(y);b===void 0?(u=hh(),w.set(y,u)):u=b}}const f=u;let h;if(u.s===R4)h=u.v;else if(h=e.apply(null,arguments),i++,n){const x=a?.deref?.()??a;x!=null&&n(x,h)&&(h=x,i!==0&&i--),a=typeof h=="object"&&h!==null||typeof h=="function"?new PX(h):h}return f.s=R4,f.v=h,h}return o.clearCache=()=>{r=hh(),o.resetResultsCount()},o.resultsCount=()=>i,o.resetResultsCount=()=>{i=0},o}function MX(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...a)=>{let i=0,o=0,u,m={},f=a.pop();typeof f=="object"&&(m=f,f=a.pop()),_X(f,`createSelector expects an output function after the inputs, but received: [${typeof f}]`);const h={...r,...m},{memoize:x,memoizeOptions:v=[],argsMemoize:y=v6,argsMemoizeOptions:w=[]}=h,b=P4(v),S=P4(w),N=CX(a),_=x(function(){return i++,f.apply(null,arguments)},...b),A=y(function(){o++;const C=OX(N,arguments);return u=_.apply(null,C),u},...S);return Object.assign(A,{resultFunc:f,memoizedResultFunc:_,dependencies:N,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>u,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:x,argsMemoize:y})};return Object.assign(n,{withTypes:()=>n}),n}var _e=MX(v6),FX=Object.assign((e,t=_e)=>{TX(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(i=>e[i]);return t(n,(...i)=>i.reduce((o,u,m)=>(o[r[m]]=u,o),{}))},{withTypes:()=>FX}),m1={},p1={},x1={},M4;function IX(){return M4||(M4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,a,i)=>{if(n!==a){const o=t(n),u=t(a);if(o===u&&o===0){if(n<a)return i==="desc"?1:-1;if(n>a)return i==="desc"?-1:1}return i==="desc"?u-o:o-u}return 0};e.compareValues=r}(x1)),x1}var v1={},g1={},F4;function g6(){return F4||(F4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t}(g1)),g1}var I4;function LX(){return I4||(I4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=g6(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(i,o){return Array.isArray(i)?!1:typeof i=="number"||typeof i=="boolean"||i==null||t.isSymbol(i)?!0:typeof i=="string"&&(n.test(i)||!r.test(i))||o!=null&&Object.hasOwn(o,i)}e.isKey=a}(v1)),v1}var L4;function BX(){return L4||(L4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=IX(),r=LX(),n=x2();function a(i,o,u,m){if(i==null)return[];u=m?void 0:u,Array.isArray(i)||(i=Object.values(i)),Array.isArray(o)||(o=o==null?[null]:[o]),o.length===0&&(o=[null]),Array.isArray(u)||(u=u==null?[]:[u]),u=u.map(y=>String(y));const f=(y,w)=>{let b=y;for(let S=0;S<w.length&&b!=null;++S)b=b[w[S]];return b},h=(y,w)=>w==null||y==null?w:typeof y=="object"&&"key"in y?Object.hasOwn(w,y.key)?w[y.key]:f(w,y.path):typeof y=="function"?y(w):Array.isArray(y)?f(w,y):typeof w=="object"?w[y]:w,x=o.map(y=>(Array.isArray(y)&&y.length===1&&(y=y[0]),y==null||typeof y=="function"||Array.isArray(y)||r.isKey(y)?y:{key:y,path:n.toPath(y)}));return i.map(y=>({original:y,criteria:x.map(w=>h(w,y))})).slice().sort((y,w)=>{for(let b=0;b<x.length;b++){const S=t.compareValues(y.criteria[b],w.criteria[b],u[b]);if(S!==0)return S}return 0}).map(y=>y.original)}e.orderBy=a}(p1)),p1}var y1={},B4;function UX(){return B4||(B4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const a=[],i=Math.floor(n),o=(u,m)=>{for(let f=0;f<u.length;f++){const h=u[f];Array.isArray(h)&&m<i?o(h,m+1):a.push(h)}};return o(r,0),a}e.flatten=t}(y1)),y1}var b1={},U4;function y6(){return U4||(U4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=p6(),r=A2(),n=d6(),a=_2();function i(o,u,m){return n.isObject(m)&&(typeof u=="number"&&r.isArrayLike(m)&&t.isIndex(u)&&u<m.length||typeof u=="string"&&u in m)?a.eq(m[u],o):!1}e.isIterateeCall=i}(b1)),b1}var $4;function $X(){return $4||($4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=BX(),r=UX(),n=y6();function a(i,...o){const u=o.length;return u>1&&n.isIterateeCall(i,o[0],o[1])?o=[]:u>2&&n.isIterateeCall(o[0],o[1],o[2])&&(o=[o[0]]),t.orderBy(i,r.flatten(o),["asc"])}e.sortBy=a}(m1)),m1}var w1,z4;function zX(){return z4||(z4=1,w1=$X().sortBy),w1}var HX=zX();const sp=fi(HX);var b6=e=>e.legend.settings,qX=e=>e.legend.size,VX=e=>e.legend.payload,KX=_e([VX,b6],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?sp(n,r):n});function GX(){return lt(KX)}var mh=1;function w6(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=g.useState({height:0,left:0,top:0,width:0}),n=g.useCallback(a=>{if(a!=null){var i=a.getBoundingClientRect(),o={height:i.height,left:i.left,top:i.top,width:i.width};(Math.abs(o.height-t.height)>mh||Math.abs(o.left-t.left)>mh||Math.abs(o.top-t.top)>mh||Math.abs(o.width-t.width)>mh)&&r({height:o.height,left:o.left,top:o.top,width:o.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function wn(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var WX=typeof Symbol=="function"&&Symbol.observable||"@@observable",H4=WX,S1=()=>Math.random().toString(36).substring(7).split("").join("."),XX={INIT:`@@redux/INIT${S1()}`,REPLACE:`@@redux/REPLACE${S1()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${S1()}`},am=XX;function D2(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function S6(e,t,r){if(typeof e!="function")throw new Error(wn(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(wn(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(wn(1));return r(S6)(e,t)}let n=e,a=t,i=new Map,o=i,u=0,m=!1;function f(){o===i&&(o=new Map,i.forEach((S,N)=>{o.set(N,S)}))}function h(){if(m)throw new Error(wn(3));return a}function x(S){if(typeof S!="function")throw new Error(wn(4));if(m)throw new Error(wn(5));let N=!0;f();const _=u++;return o.set(_,S),function(){if(N){if(m)throw new Error(wn(6));N=!1,f(),o.delete(_),i=null}}}function v(S){if(!D2(S))throw new Error(wn(7));if(typeof S.type>"u")throw new Error(wn(8));if(typeof S.type!="string")throw new Error(wn(17));if(m)throw new Error(wn(9));try{m=!0,a=n(a,S)}finally{m=!1}return(i=o).forEach(_=>{_()}),S}function y(S){if(typeof S!="function")throw new Error(wn(10));n=S,v({type:am.REPLACE})}function w(){const S=x;return{subscribe(N){if(typeof N!="object"||N===null)throw new Error(wn(11));function _(){const k=N;k.next&&k.next(h())}return _(),{unsubscribe:S(_)}},[H4](){return this}}}return v({type:am.INIT}),{dispatch:v,subscribe:x,getState:h,replaceReducer:y,[H4]:w}}function YX(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:am.INIT})>"u")throw new Error(wn(12));if(typeof r(void 0,{type:am.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(wn(13))})}function j6(e){const t=Object.keys(e),r={};for(let i=0;i<t.length;i++){const o=t[i];typeof e[o]=="function"&&(r[o]=e[o])}const n=Object.keys(r);let a;try{YX(r)}catch(i){a=i}return function(o={},u){if(a)throw a;let m=!1;const f={};for(let h=0;h<n.length;h++){const x=n[h],v=r[x],y=o[x],w=v(y,u);if(typeof w>"u")throw u&&u.type,new Error(wn(14));f[x]=w,m=m||w!==y}return m=m||n.length!==Object.keys(o).length,m?f:o}}function im(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function ZX(...e){return t=>(r,n)=>{const a=t(r,n);let i=()=>{throw new Error(wn(15))};const o={getState:a.getState,dispatch:(m,...f)=>i(m,...f)},u=e.map(m=>m(o));return i=im(...u)(a.dispatch),{...a,dispatch:i}}}function N6(e){return D2(e)&&"type"in e&&typeof e.type=="string"}var E6=Symbol.for("immer-nothing"),q4=Symbol.for("immer-draftable"),Ia=Symbol.for("immer-state");function Ni(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var $c=Object.getPrototypeOf;function _o(e){return!!e&&!!e[Ia]}function Ds(e){return e?A6(e)||Array.isArray(e)||!!e[q4]||!!e.constructor?.[q4]||op(e)||cp(e):!1}var QX=Object.prototype.constructor.toString();function A6(e){if(!e||typeof e!="object")return!1;const t=$c(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===QX}function sm(e,t){lp(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function lp(e){const t=e[Ia];return t?t.type_:Array.isArray(e)?1:op(e)?2:cp(e)?3:0}function $y(e,t){return lp(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function _6(e,t,r){const n=lp(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function JX(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function op(e){return e instanceof Map}function cp(e){return e instanceof Set}function ao(e){return e.copy_||e.base_}function zy(e,t){if(op(e))return new Map(e);if(cp(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=A6(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[Ia];let a=Reflect.ownKeys(n);for(let i=0;i<a.length;i++){const o=a[i],u=n[o];u.writable===!1&&(u.writable=!0,u.configurable=!0),(u.get||u.set)&&(n[o]={configurable:!0,writable:!0,enumerable:u.enumerable,value:e[o]})}return Object.create($c(e),n)}else{const n=$c(e);if(n!==null&&r)return{...e};const a=Object.create(n);return Object.assign(a,e)}}function P2(e,t=!1){return up(e)||_o(e)||!Ds(e)||(lp(e)>1&&(e.set=e.add=e.clear=e.delete=eY),Object.freeze(e),t&&Object.entries(e).forEach(([r,n])=>P2(n,!0))),e}function eY(){Ni(2)}function up(e){return Object.isFrozen(e)}var tY={};function To(e){const t=tY[e];return t||Ni(0,e),t}var tf;function T6(){return tf}function rY(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function V4(e,t){t&&(To("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Hy(e){qy(e),e.drafts_.forEach(nY),e.drafts_=null}function qy(e){e===tf&&(tf=e.parent_)}function K4(e){return tf=rY(tf,e)}function nY(e){const t=e[Ia];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function G4(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[Ia].modified_&&(Hy(t),Ni(4)),Ds(e)&&(e=lm(t,e),t.parent_||om(t,e)),t.patches_&&To("Patches").generateReplacementPatches_(r[Ia].base_,e,t.patches_,t.inversePatches_)):e=lm(t,r,[]),Hy(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==E6?e:void 0}function lm(e,t,r){if(up(t))return t;const n=t[Ia];if(!n)return sm(t,(a,i)=>W4(e,n,t,a,i,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return om(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const a=n.copy_;let i=a,o=!1;n.type_===3&&(i=new Set(a),a.clear(),o=!0),sm(i,(u,m)=>W4(e,n,a,u,m,r,o)),om(e,a,!1),r&&e.patches_&&To("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function W4(e,t,r,n,a,i,o){if(_o(a)){const u=i&&t&&t.type_!==3&&!$y(t.assigned_,n)?i.concat(n):void 0,m=lm(e,a,u);if(_6(r,n,m),_o(m))e.canAutoFreeze_=!1;else return}else o&&r.add(a);if(Ds(a)&&!up(a)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;lm(e,a),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&om(e,a)}}function om(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&P2(t,r)}function aY(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:T6(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,i=R2;r&&(a=[n],i=rf);const{revoke:o,proxy:u}=Proxy.revocable(a,i);return n.draft_=u,n.revoke_=o,u}var R2={get(e,t){if(t===Ia)return e;const r=ao(e);if(!$y(r,t))return iY(e,r,t);const n=r[t];return e.finalized_||!Ds(n)?n:n===j1(e.base_,t)?(N1(e),e.copy_[t]=Ky(n,e)):n},has(e,t){return t in ao(e)},ownKeys(e){return Reflect.ownKeys(ao(e))},set(e,t,r){const n=k6(ao(e),t);if(n?.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const a=j1(ao(e),t),i=a?.[Ia];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(JX(r,a)&&(r!==void 0||$y(e.base_,t)))return!0;N1(e),Vy(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return j1(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,N1(e),Vy(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=ao(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){Ni(11)},getPrototypeOf(e){return $c(e.base_)},setPrototypeOf(){Ni(12)}},rf={};sm(R2,(e,t)=>{rf[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});rf.deleteProperty=function(e,t){return rf.set.call(this,e,t,void 0)};rf.set=function(e,t,r){return R2.set.call(this,e[0],t,r,e[0])};function j1(e,t){const r=e[Ia];return(r?ao(r):e)[t]}function iY(e,t,r){const n=k6(t,r);return n?"value"in n?n.value:n.get?.call(e.draft_):void 0}function k6(e,t){if(!(t in e))return;let r=$c(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=$c(r)}}function Vy(e){e.modified_||(e.modified_=!0,e.parent_&&Vy(e.parent_))}function N1(e){e.copy_||(e.copy_=zy(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var sY=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const i=r;r=t;const o=this;return function(m=i,...f){return o.produce(m,h=>r.call(this,h,...f))}}typeof r!="function"&&Ni(6),n!==void 0&&typeof n!="function"&&Ni(7);let a;if(Ds(t)){const i=K4(this),o=Ky(t,void 0);let u=!0;try{a=r(o),u=!1}finally{u?Hy(i):qy(i)}return V4(i,n),G4(a,i)}else if(!t||typeof t!="object"){if(a=r(t),a===void 0&&(a=t),a===E6&&(a=void 0),this.autoFreeze_&&P2(a,!0),n){const i=[],o=[];To("Patches").generateReplacementPatches_(t,a,i,o),n(i,o)}return a}else Ni(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(o,...u)=>this.produceWithPatches(o,m=>t(m,...u));let n,a;return[this.produce(t,r,(o,u)=>{n=o,a=u}),n,a]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Ds(e)||Ni(8),_o(e)&&(e=ks(e));const t=K4(this),r=Ky(e,void 0);return r[Ia].isManual_=!0,qy(t),r}finishDraft(e,t){const r=e&&e[Ia];(!r||!r.isManual_)&&Ni(9);const{scope_:n}=r;return V4(n,t),G4(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const a=t[r];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}r>-1&&(t=t.slice(r+1));const n=To("Patches").applyPatches_;return _o(e)?n(e,t):this.produce(e,a=>n(a,t))}};function Ky(e,t){const r=op(e)?To("MapSet").proxyMap_(e,t):cp(e)?To("MapSet").proxySet_(e,t):aY(e,t);return(t?t.scope_:T6()).drafts_.push(r),r}function ks(e){return _o(e)||Ni(10,e),C6(e)}function C6(e){if(!Ds(e)||up(e))return e;const t=e[Ia];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=zy(e,t.scope_.immer_.useStrictShallowCopy_)}else r=zy(e,!0);return sm(r,(n,a)=>{_6(r,n,C6(a))}),t&&(t.finalized_=!1),r}var La=new sY,O6=La.produce;La.produceWithPatches.bind(La);La.setAutoFreeze.bind(La);La.setUseStrictShallowCopy.bind(La);La.applyPatches.bind(La);La.createDraft.bind(La);La.finishDraft.bind(La);function D6(e){return({dispatch:r,getState:n})=>a=>i=>typeof i=="function"?i(r,n,e):a(i)}var lY=D6(),oY=D6,cY=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?im:im.apply(null,arguments)};function ci(e,t){function r(...n){if(t){let a=t(...n);if(!a)throw new Error(Pa(0));return{type:e,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>N6(n)&&n.type===e,r}var P6=class Ad extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Ad.prototype)}static get[Symbol.species](){return Ad}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new Ad(...t[0].concat(this)):new Ad(...t.concat(this))}};function X4(e){return Ds(e)?O6(e,()=>{}):e}function ph(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function uY(e){return typeof e=="boolean"}var dY=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:i=!0}=t??{};let o=new P6;return r&&(uY(r)?o.push(lY):o.push(oY(r.extraArgument))),o},fY="RTK_autoBatch",Y4=e=>t=>{setTimeout(t,e)},hY=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let a=!0,i=!1,o=!1;const u=new Set,m=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:Y4(10):e.type==="callback"?e.queueNotification:Y4(e.timeout),f=()=>{o=!1,i&&(i=!1,u.forEach(h=>h()))};return Object.assign({},n,{subscribe(h){const x=()=>a&&h(),v=n.subscribe(x);return u.add(h),()=>{v(),u.delete(h)}},dispatch(h){try{return a=!h?.meta?.[fY],i=!a,i&&(o||(o=!0,m(f))),n.dispatch(h)}finally{a=!0}}})},mY=e=>function(r){const{autoBatch:n=!0}=r??{};let a=new P6(e);return n&&a.push(hY(typeof n=="object"?n:void 0)),a};function pY(e){const t=dY(),{reducer:r=void 0,middleware:n,devTools:a=!0,preloadedState:i=void 0,enhancers:o=void 0}=e||{};let u;if(typeof r=="function")u=r;else if(D2(r))u=j6(r);else throw new Error(Pa(1));let m;typeof n=="function"?m=n(t):m=t();let f=im;a&&(f=cY({trace:!1,...typeof a=="object"&&a}));const h=ZX(...m),x=mY(h);let v=typeof o=="function"?o(x):x();const y=f(...v);return S6(u,i,y)}function R6(e){const t={},r=[];let n;const a={addCase(i,o){const u=typeof i=="string"?i:i.type;if(!u)throw new Error(Pa(28));if(u in t)throw new Error(Pa(29));return t[u]=o,a},addMatcher(i,o){return r.push({matcher:i,reducer:o}),a},addDefaultCase(i){return n=i,a}};return e(a),[t,r,n]}function xY(e){return typeof e=="function"}function vY(e,t){let[r,n,a]=R6(t),i;if(xY(e))i=()=>X4(e());else{const u=X4(e);i=()=>u}function o(u=i(),m){let f=[r[m.type],...n.filter(({matcher:h})=>h(m)).map(({reducer:h})=>h)];return f.filter(h=>!!h).length===0&&(f=[a]),f.reduce((h,x)=>{if(x)if(_o(h)){const y=x(h,m);return y===void 0?h:y}else{if(Ds(h))return O6(h,v=>x(v,m));{const v=x(h,m);if(v===void 0){if(h===null)return h;throw Error("A case reducer on a non-draftable value must not return undefined")}return v}}return h},u)}return o.getInitialState=i,o}var gY="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",yY=(e=21)=>{let t="",r=e;for(;r--;)t+=gY[Math.random()*64|0];return t},bY=Symbol.for("rtk-slice-createasyncthunk");function wY(e,t){return`${e}/${t}`}function SY({creators:e}={}){const t=e?.asyncThunk?.[bY];return function(n){const{name:a,reducerPath:i=a}=n;if(!a)throw new Error(Pa(11));const o=(typeof n.reducers=="function"?n.reducers(NY()):n.reducers)||{},u=Object.keys(o),m={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},f={addCase(A,k){const C=typeof A=="string"?A:A.type;if(!C)throw new Error(Pa(12));if(C in m.sliceCaseReducersByType)throw new Error(Pa(13));return m.sliceCaseReducersByType[C]=k,f},addMatcher(A,k){return m.sliceMatchers.push({matcher:A,reducer:k}),f},exposeAction(A,k){return m.actionCreators[A]=k,f},exposeCaseReducer(A,k){return m.sliceCaseReducersByName[A]=k,f}};u.forEach(A=>{const k=o[A],C={reducerName:A,type:wY(a,A),createNotation:typeof n.reducers=="function"};AY(k)?TY(C,k,f,t):EY(C,k,f)});function h(){const[A={},k=[],C=void 0]=typeof n.extraReducers=="function"?R6(n.extraReducers):[n.extraReducers],O={...A,...m.sliceCaseReducersByType};return vY(n.initialState,T=>{for(let z in O)T.addCase(z,O[z]);for(let z of m.sliceMatchers)T.addMatcher(z.matcher,z.reducer);for(let z of k)T.addMatcher(z.matcher,z.reducer);C&&T.addDefaultCase(C)})}const x=A=>A,v=new Map,y=new WeakMap;let w;function b(A,k){return w||(w=h()),w(A,k)}function S(){return w||(w=h()),w.getInitialState()}function N(A,k=!1){function C(T){let z=T[A];return typeof z>"u"&&k&&(z=ph(y,C,S)),z}function O(T=x){const z=ph(v,k,()=>new WeakMap);return ph(z,T,()=>{const P={};for(const[Z,q]of Object.entries(n.selectors??{}))P[Z]=jY(q,T,()=>ph(y,T,S),k);return P})}return{reducerPath:A,getSelectors:O,get selectors(){return O(C)},selectSlice:C}}const _={name:a,reducer:b,actions:m.actionCreators,caseReducers:m.sliceCaseReducersByName,getInitialState:S,...N(i),injectInto(A,{reducerPath:k,...C}={}){const O=k??i;return A.inject({reducerPath:O,reducer:b},C),{..._,...N(O,!0)}}};return _}}function jY(e,t,r,n){function a(i,...o){let u=t(i);return typeof u>"u"&&n&&(u=r()),e(u,...o)}return a.unwrapped=e,a}var pi=SY();function NY(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function EY({type:e,reducerName:t,createNotation:r},n,a){let i,o;if("reducer"in n){if(r&&!_Y(n))throw new Error(Pa(17));i=n.reducer,o=n.prepare}else i=n;a.addCase(e,i).exposeCaseReducer(t,i).exposeAction(t,o?ci(e,o):ci(e))}function AY(e){return e._reducerDefinitionType==="asyncThunk"}function _Y(e){return e._reducerDefinitionType==="reducerWithPrepare"}function TY({type:e,reducerName:t},r,n,a){if(!a)throw new Error(Pa(18));const{payloadCreator:i,fulfilled:o,pending:u,rejected:m,settled:f,options:h}=r,x=a(e,i,h);n.exposeAction(t,x),o&&n.addCase(x.fulfilled,o),u&&n.addCase(x.pending,u),m&&n.addCase(x.rejected,m),f&&n.addMatcher(x.settled,f),n.exposeCaseReducer(t,{fulfilled:o||xh,pending:u||xh,rejected:m||xh,settled:f||xh})}function xh(){}var kY="task",M6="listener",F6="completed",M2="cancelled",CY=`task-${M2}`,OY=`task-${F6}`,Gy=`${M6}-${M2}`,DY=`${M6}-${F6}`,dp=class{constructor(e){this.code=e,this.message=`${kY} ${M2} (reason: ${e})`}name="TaskAbortError";message},F2=(e,t)=>{if(typeof e!="function")throw new TypeError(Pa(32))},cm=()=>{},I6=(e,t=cm)=>(e.catch(t),e),L6=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),yo=(e,t)=>{const r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},bo=e=>{if(e.aborted){const{reason:t}=e;throw new dp(t)}};function B6(e,t){let r=cm;return new Promise((n,a)=>{const i=()=>a(new dp(e.reason));if(e.aborted){i();return}r=L6(e,i),t.finally(()=>r()).then(n,a)}).finally(()=>{r=cm})}var PY=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof dp?"cancelled":"rejected",error:r}}finally{t?.()}},um=e=>t=>I6(B6(e,t).then(r=>(bo(e),r))),U6=e=>{const t=um(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:Fc}=Object,Z4={},fp="listenerMiddleware",RY=(e,t)=>{const r=n=>L6(e,()=>yo(n,e.reason));return(n,a)=>{F2(n);const i=new AbortController;r(i);const o=PY(async()=>{bo(e),bo(i.signal);const u=await n({pause:um(i.signal),delay:U6(i.signal),signal:i.signal});return bo(i.signal),u},()=>yo(i,OY));return a?.autoJoin&&t.push(o.catch(cm)),{result:um(e)(o),cancel(){yo(i,CY)}}}},MY=(e,t)=>{const r=async(n,a)=>{bo(t);let i=()=>{};const u=[new Promise((m,f)=>{let h=e({predicate:n,effect:(x,v)=>{v.unsubscribe(),m([x,v.getState(),v.getOriginalState()])}});i=()=>{h(),f()}})];a!=null&&u.push(new Promise(m=>setTimeout(m,a,null)));try{const m=await B6(t,Promise.race(u));return bo(t),m}finally{i()}};return(n,a)=>I6(r(n,a))},$6=e=>{let{type:t,actionCreator:r,matcher:n,predicate:a,effect:i}=e;if(t)a=ci(t).match;else if(r)t=r.type,a=r.match;else if(n)a=n;else if(!a)throw new Error(Pa(21));return F2(i),{predicate:a,type:t,effect:i}},z6=Fc(e=>{const{type:t,predicate:r,effect:n}=$6(e);return{id:yY(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Pa(22))}}},{withTypes:()=>z6}),Q4=(e,t)=>{const{type:r,effect:n,predicate:a}=$6(t);return Array.from(e.values()).find(i=>(typeof r=="string"?i.type===r:i.predicate===a)&&i.effect===n)},Wy=e=>{e.pending.forEach(t=>{yo(t,Gy)})},FY=e=>()=>{e.forEach(Wy),e.clear()},J4=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},H6=Fc(ci(`${fp}/add`),{withTypes:()=>H6}),IY=ci(`${fp}/removeAll`),q6=Fc(ci(`${fp}/remove`),{withTypes:()=>q6}),LY=(...e)=>{console.error(`${fp}/error`,...e)},Af=(e={})=>{const t=new Map,{extra:r,onError:n=LY}=e;F2(n);const a=h=>(h.unsubscribe=()=>t.delete(h.id),t.set(h.id,h),x=>{h.unsubscribe(),x?.cancelActive&&Wy(h)}),i=h=>{const x=Q4(t,h)??z6(h);return a(x)};Fc(i,{withTypes:()=>i});const o=h=>{const x=Q4(t,h);return x&&(x.unsubscribe(),h.cancelActive&&Wy(x)),!!x};Fc(o,{withTypes:()=>o});const u=async(h,x,v,y)=>{const w=new AbortController,b=MY(i,w.signal),S=[];try{h.pending.add(w),await Promise.resolve(h.effect(x,Fc({},v,{getOriginalState:y,condition:(N,_)=>b(N,_).then(Boolean),take:b,delay:U6(w.signal),pause:um(w.signal),extra:r,signal:w.signal,fork:RY(w.signal,S),unsubscribe:h.unsubscribe,subscribe:()=>{t.set(h.id,h)},cancelActiveListeners:()=>{h.pending.forEach((N,_,A)=>{N!==w&&(yo(N,Gy),A.delete(N))})},cancel:()=>{yo(w,Gy),h.pending.delete(w)},throwIfCancelled:()=>{bo(w.signal)}})))}catch(N){N instanceof dp||J4(n,N,{raisedBy:"effect"})}finally{await Promise.all(S),yo(w,DY),h.pending.delete(w)}},m=FY(t);return{middleware:h=>x=>v=>{if(!N6(v))return x(v);if(H6.match(v))return i(v.payload);if(IY.match(v)){m();return}if(q6.match(v))return o(v.payload);let y=h.getState();const w=()=>{if(y===Z4)throw new Error(Pa(23));return y};let b;try{if(b=x(v),t.size>0){const S=h.getState(),N=Array.from(t.values());for(const _ of N){let A=!1;try{A=_.predicate(v,S,y)}catch(k){A=!1,J4(n,k,{raisedBy:"predicate"})}A&&u(_,v,h,w)}}}finally{y=Z4}return b},startListening:i,stopListening:o,clearListeners:m}};function Pa(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var BY={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},V6=pi({name:"chartLayout",initialState:BY,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){e.margin.top=t.payload.top,e.margin.right=t.payload.right,e.margin.bottom=t.payload.bottom,e.margin.left=t.payload.left},setScale(e,t){e.scale=t.payload}}}),{setMargin:UY,setLayout:$Y,setChartSize:zY,setScale:HY}=V6.actions,qY=V6.reducer;function eT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function tT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eT(Object(r),!0).forEach(function(n){VY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function VY(e,t,r){return(t=KY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KY(e){var t=GY(e,"string");return typeof t=="symbol"?t:t+""}function GY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dm=Math.PI/180,WY=e=>e*180/Math.PI,Wr=(e,t,r,n)=>({x:e+Math.cos(-dm*n)*r,y:t+Math.sin(-dm*n)*r}),K6=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},XY=(e,t)=>{var{x:r,y:n}=e,{x:a,y:i}=t;return Math.sqrt((r-a)**2+(n-i)**2)},YY=(e,t)=>{var{x:r,y:n}=e,{cx:a,cy:i}=t,o=XY({x:r,y:n},{x:a,y:i});if(o<=0)return{radius:o,angle:0};var u=(r-a)/o,m=Math.acos(u);return n>i&&(m=2*Math.PI-m),{radius:o,angle:WY(m),angleInRadian:m}},ZY=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),a=Math.floor(r/360),i=Math.min(n,a);return{startAngle:t-i*360,endAngle:r-i*360}},QY=(e,t)=>{var{startAngle:r,endAngle:n}=t,a=Math.floor(r/360),i=Math.floor(n/360),o=Math.min(a,i);return e+o*360},JY=(e,t)=>{var{x:r,y:n}=e,{radius:a,angle:i}=YY({x:r,y:n},t),{innerRadius:o,outerRadius:u}=t;if(a<o||a>u||a===0)return null;var{startAngle:m,endAngle:f}=ZY(t),h=i,x;if(m<=f){for(;h>f;)h-=360;for(;h<m;)h+=360;x=h>=m&&h<=f}else{for(;h>m;)h-=360;for(;h<f;)h+=360;x=h>=f&&h<=m}return x?tT(tT({},t),{},{radius:a,angle:QY(h,t)}):null};function rT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ai(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rT(Object(r),!0).forEach(function(n){eZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function eZ(e,t,r){return(t=tZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tZ(e){var t=rZ(e,"string");return typeof t=="symbol"?t:t+""}function rZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jt(e,t,r){return qt(e)||qt(t)?r:Wi(t)?Ol(e,t,r):typeof t=="function"?t(e):r}var nZ=(e,t,r,n,a)=>{var i,o=-1,u=(i=t?.length)!==null&&i!==void 0?i:0;if(u<=1||e==null)return 0;if(n==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var m=0;m<u;m++){var f=m>0?r[m-1].coordinate:r[u-1].coordinate,h=r[m].coordinate,x=m>=u-1?r[0].coordinate:r[m+1].coordinate,v=void 0;if(Gr(h-f)!==Gr(x-h)){var y=[];if(Gr(x-h)===Gr(a[1]-a[0])){v=x;var w=h+a[1]-a[0];y[0]=Math.min(w,(w+f)/2),y[1]=Math.max(w,(w+f)/2)}else{v=f;var b=x+a[1]-a[0];y[0]=Math.min(h,(b+h)/2),y[1]=Math.max(h,(b+h)/2)}var S=[Math.min(h,(v+h)/2),Math.max(h,(v+h)/2)];if(e>S[0]&&e<=S[1]||e>=y[0]&&e<=y[1]){({index:o}=r[m]);break}}else{var N=Math.min(f,x),_=Math.max(f,x);if(e>(N+h)/2&&e<=(_+h)/2){({index:o}=r[m]);break}}}else if(t){for(var A=0;A<u;A++)if(A===0&&e<=(t[A].coordinate+t[A+1].coordinate)/2||A>0&&A<u-1&&e>(t[A].coordinate+t[A-1].coordinate)/2&&e<=(t[A].coordinate+t[A+1].coordinate)/2||A===u-1&&e>(t[A].coordinate+t[A-1].coordinate)/2){({index:o}=t[A]);break}}return o},aZ=(e,t,r)=>{if(t&&r){var{width:n,height:a}=r,{align:i,verticalAlign:o,layout:u}=t;if((u==="vertical"||u==="horizontal"&&o==="middle")&&i!=="center"&&ot(e[i]))return ai(ai({},e),{},{[i]:e[i]+(n||0)});if((u==="horizontal"||u==="vertical"&&i==="center")&&o!=="middle"&&ot(e[o]))return ai(ai({},e),{},{[o]:e[o]+(a||0)})}return e},Ls=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",G6=(e,t,r,n)=>{if(n)return e.map(u=>u.coordinate);var a,i,o=e.map(u=>(u.coordinate===t&&(a=!0),u.coordinate===r&&(i=!0),u.coordinate));return a||o.push(t),i||o.push(r),o},W6=(e,t,r)=>{if(!e)return null;var{duplicateDomain:n,type:a,range:i,scale:o,realScaleType:u,isCategorical:m,categoricalDomain:f,tickCount:h,ticks:x,niceTicks:v,axisType:y}=e;if(!o)return null;var w=u==="scaleBand"&&o.bandwidth?o.bandwidth()/2:2,b=a==="category"&&o.bandwidth?o.bandwidth()/w:0;if(b=y==="angleAxis"&&i&&i.length>=2?Gr(i[0]-i[1])*2*b:b,x||v){var S=(x||v||[]).map((N,_)=>{var A=n?n.indexOf(N):N;return{coordinate:o(A)+b,value:N,offset:b,index:_}});return S.filter(N=>!Fa(N.coordinate))}return m&&f?f.map((N,_)=>({coordinate:o(N)+b,value:N,index:_,offset:b})):o.ticks&&h!=null?o.ticks(h).map((N,_)=>({coordinate:o(N)+b,value:N,offset:b,index:_})):o.domain().map((N,_)=>({coordinate:o(N)+b,value:n?n[N]:N,index:_,offset:b}))},nT=1e-4,iZ=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,n=e.range(),a=Math.min(n[0],n[1])-nT,i=Math.max(n[0],n[1])+nT,o=e(t[0]),u=e(t[r-1]);(o<a||o>i||u<a||u>i)&&e.domain([t[0],t[r-1]])}},X6=(e,t)=>{if(!t||t.length!==2||!ot(t[0])||!ot(t[1]))return e;var r=Math.min(t[0],t[1]),n=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!ot(e[0])||e[0]<r)&&(a[0]=r),(!ot(e[1])||e[1]>n)&&(a[1]=n),a[0]>n&&(a[0]=n),a[1]<r&&(a[1]=r),a},sZ=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var a=0,i=0,o=0;o<t;++o){var u=Fa(e[o][r][1])?e[o][r][0]:e[o][r][1];u>=0?(e[o][r][0]=a,e[o][r][1]=a+u,a=e[o][r][1]):(e[o][r][0]=i,e[o][r][1]=i+u,i=e[o][r][1])}},lZ=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var a=0,i=0;i<t;++i){var o=Fa(e[i][r][1])?e[i][r][0]:e[i][r][1];o>=0?(e[i][r][0]=a,e[i][r][1]=a+o,a=e[i][r][1]):(e[i][r][0]=0,e[i][r][1]=0)}},oZ={sign:sZ,expand:BW,none:Uc,silhouette:UW,wiggle:$W,positive:lZ},cZ=(e,t,r)=>{var n=oZ[r],a=LW().keys(t).value((i,o)=>+Jt(i,o,0)).order(Ly).offset(n);return a(e)};function Y6(e){return e==null?void 0:String(e)}function fm(e){var{axis:t,ticks:r,bandSize:n,entry:a,index:i,dataKey:o}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!qt(a[t.dataKey])){var u=H5(r,"value",a[t.dataKey]);if(u)return u.coordinate+n/2}return r[i]?r[i].coordinate+n/2:null}var m=Jt(a,qt(o)?t.dataKey:o);return qt(m)?null:t.scale(m)}var hm=e=>{var{axis:t,ticks:r,offset:n,bandSize:a,entry:i,index:o}=e;if(t.type==="category")return r[o]?r[o].coordinate+n:null;var u=Jt(i,t.dataKey,t.scale.domain()[o]);return qt(u)?null:t.scale(u)-a/2+n},Z6=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);return n<=0&&a>=0?0:a<0?a:n}return r[0]},uZ=e=>{var t=e.flat(2).filter(ot);return[Math.min(...t),Math.max(...t)]},dZ=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],fZ=(e,t,r)=>{if(e!=null)return dZ(Object.keys(e).reduce((n,a)=>{var i=e[a],{stackedData:o}=i,u=o.reduce((m,f)=>{var h=uZ(f.slice(t,r+1));return[Math.min(m[0],h[0]),Math.max(m[1],h[1])]},[1/0,-1/0]);return[Math.min(u[0],n[0]),Math.max(u[1],n[1])]},[1/0,-1/0]))},aT=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,iT=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Ps=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var a=sp(t,h=>h.coordinate),i=1/0,o=1,u=a.length;o<u;o++){var m=a[o],f=a[o-1];i=Math.min((m.coordinate||0)-(f.coordinate||0),i)}return i===1/0?0:i}return r?void 0:0};function sT(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:a,name:i}=e;return ai(ai({},t),{},{dataKey:r,payload:n,value:a,name:i})}function Bs(e,t){if(e)return String(e);if(typeof t=="string")return t}function hZ(e,t,r,n,a){if(r==="horizontal"||r==="vertical"){var i=e>=a.left&&e<=a.left+a.width&&t>=a.top&&t<=a.top+a.height;return i?{x:e,y:t}:null}return n?JY({x:e,y:t},n):null}var mZ=(e,t,r,n)=>{var a=t.find(f=>f&&f.index===r);if(a){if(e==="horizontal")return{x:a.coordinate,y:n.y};if(e==="vertical")return{x:n.x,y:a.coordinate};if(e==="centric"){var i=a.coordinate,{radius:o}=n;return ai(ai(ai({},n),Wr(n.cx,n.cy,o,i)),{},{angle:i,radius:o})}var u=a.coordinate,{angle:m}=n;return ai(ai(ai({},n),Wr(n.cx,n.cy,u,m)),{},{angle:m,radius:u})}return{x:0,y:0}},pZ=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius,Us=e=>e.layout.width,$s=e=>e.layout.height,xZ=e=>e.layout.scale,Q6=e=>e.layout.margin,I2=_e(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),L2=_e(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),B2="data-recharts-item-index",U2="data-recharts-item-data-key",hp=60;function lT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function pl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lT(Object(r),!0).forEach(function(n){vZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vZ(e,t,r){return(t=gZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gZ(e){var t=yZ(e,"string");return typeof t=="symbol"?t:t+""}function yZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bZ=e=>e.brush.height,nn=_e([Us,$s,Q6,bZ,I2,L2,b6,qX],(e,t,r,n,a,i,o,u)=>{var m=i.reduce((w,b)=>{var{orientation:S}=b;if(!b.mirror&&!b.hide){var N=typeof b.width=="number"?b.width:hp;return pl(pl({},w),{},{[S]:w[S]+N})}return w},{left:r.left||0,right:r.right||0}),f=a.reduce((w,b)=>{var{orientation:S}=b;return!b.mirror&&!b.hide?pl(pl({},w),{},{[S]:Ol(w,"".concat(S))+b.height}):w},{top:r.top||0,bottom:r.bottom||0}),h=pl(pl({},f),m),x=h.bottom;h.bottom+=n,h=aZ(h,o,u);var v=e-h.left-h.right,y=t-h.top-h.bottom;return pl(pl({brushBottom:x},h),{},{width:Math.max(v,0),height:Math.max(y,0)})}),wZ=_e(nn,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),J6=_e(Us,$s,(e,t)=>({x:0,y:0,width:e,height:t})),SZ=g.createContext(null),$n=()=>g.useContext(SZ)!=null,mp=e=>e.brush,pp=_e([mp,nn,Q6],(e,t,r)=>({height:e.height,x:ot(e.x)?e.x:t.left,y:ot(e.y)?e.y:t.top+t.height+t.brushBottom-(r?.bottom||0),width:ot(e.width)?e.width:t.width})),$2=()=>{var e,t=$n(),r=lt(wZ),n=lt(pp),a=(e=lt(mp))===null||e===void 0?void 0:e.padding;return!t||!n||!a?r:{width:n.width-a.left-a.right,height:n.height-a.top-a.bottom,x:a.left,y:a.top}},jZ={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},eD=()=>{var e;return(e=lt(nn))!==null&&e!==void 0?e:jZ},z2=()=>lt(Us),H2=()=>lt($s),NZ={top:0,right:0,bottom:0,left:0},EZ=()=>{var e;return(e=lt(t=>t.layout.margin))!==null&&e!==void 0?e:NZ},Ct=e=>e.layout.layoutType,xp=()=>lt(Ct),AZ={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},tD=pi({name:"legend",initialState:AZ,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload(e,t){e.payload.push(t.payload)},removeLegendPayload(e,t){var r=ks(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)}}}),{setLegendSize:oT,setLegendSettings:_Z,addLegendPayload:rD,removeLegendPayload:nD}=tD.actions,TZ=tD.reducer,kZ=["contextPayload"];function Xy(){return Xy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Xy.apply(null,arguments)}function cT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function zc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cT(Object(r),!0).forEach(function(n){q2(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function q2(e,t,r){return(t=CZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CZ(e){var t=OZ(e,"string");return typeof t=="symbol"?t:t+""}function OZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function DZ(e,t){if(e==null)return{};var r,n,a=PZ(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function PZ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function RZ(e){return e.value}function MZ(e){var{contextPayload:t}=e,r=DZ(e,kZ),n=x6(t,e.payloadUniqBy,RZ),a=zc(zc({},r),{},{payload:n});return g.isValidElement(e.content)?g.cloneElement(e.content,a):typeof e.content=="function"?g.createElement(e.content,a):g.createElement(E2,a)}function FZ(e,t,r,n,a,i){var{layout:o,align:u,verticalAlign:m}=t,f,h;return(!e||(e.left===void 0||e.left===null)&&(e.right===void 0||e.right===null))&&(u==="center"&&o==="vertical"?f={left:((n||0)-i.width)/2}:f=u==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!e||(e.top===void 0||e.top===null)&&(e.bottom===void 0||e.bottom===null))&&(m==="middle"?h={top:((a||0)-i.height)/2}:h=m==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),zc(zc({},f),h)}function IZ(e){var t=br();return g.useEffect(()=>{t(_Z(e))},[t,e]),null}function LZ(e){var t=br();return g.useEffect(()=>(t(oT(e)),()=>{t(oT({width:0,height:0}))}),[t,e]),null}function BZ(e){var t=GX(),r=oW(),n=EZ(),{width:a,height:i,wrapperStyle:o,portal:u}=e,[m,f]=w6([t]),h=z2(),x=H2(),v=h-(n.left||0)-(n.right||0),y=iu.getWidthOrHeight(e.layout,i,a,v),w=u?o:zc(zc({position:"absolute",width:y?.width||a||"auto",height:y?.height||i||"auto"},FZ(o,e,n,h,x,m)),o),b=u??r;if(b==null)return null;var S=g.createElement("div",{className:"recharts-legend-wrapper",style:w,ref:f},g.createElement(IZ,{layout:e.layout,align:e.align,verticalAlign:e.verticalAlign,itemSorter:e.itemSorter}),g.createElement(LZ,{width:m.width,height:m.height}),g.createElement(MZ,Xy({},e,y,{margin:n,chartWidth:h,chartHeight:x,contextPayload:t})));return qd.createPortal(S,b)}class iu extends g.PureComponent{static getWidthOrHeight(t,r,n,a){return t==="vertical"&&ot(r)?{height:r}:t==="horizontal"?{width:n||a}:null}render(){return g.createElement(BZ,this.props)}}q2(iu,"displayName","Legend");q2(iu,"defaultProps",{align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"});function Yy(){return Yy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Yy.apply(null,arguments)}function uT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function E1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uT(Object(r),!0).forEach(function(n){UZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function UZ(e,t,r){return(t=$Z(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $Z(e){var t=zZ(e,"string");return typeof t=="symbol"?t:t+""}function zZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function HZ(e){return Array.isArray(e)&&Wi(e[0])&&Wi(e[1])?e.join(" ~ "):e}var qZ=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:n={},labelStyle:a={},payload:i,formatter:o,itemSorter:u,wrapperClassName:m,labelClassName:f,label:h,labelFormatter:x,accessibilityLayer:v=!1}=e,y=()=>{if(i&&i.length){var C={padding:0,margin:0},O=(u?sp(i,u):i).map((T,z)=>{if(T.type==="none")return null;var P=T.formatter||o||HZ,{value:Z,name:q}=T,B=Z,fe=q;if(P){var Ne=P(Z,q,T,z,i);if(Array.isArray(Ne))[B,fe]=Ne;else if(Ne!=null)B=Ne;else return null}var he=E1({display:"block",paddingTop:4,paddingBottom:4,color:T.color||"#000"},n);return g.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(z),style:he},Wi(fe)?g.createElement("span",{className:"recharts-tooltip-item-name"},fe):null,Wi(fe)?g.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,g.createElement("span",{className:"recharts-tooltip-item-value"},B),g.createElement("span",{className:"recharts-tooltip-item-unit"},T.unit||""))});return g.createElement("ul",{className:"recharts-tooltip-item-list",style:C},O)}return null},w=E1({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),b=E1({margin:0},a),S=!qt(h),N=S?h:"",_=$t("recharts-default-tooltip",m),A=$t("recharts-tooltip-label",f);S&&x&&i!==void 0&&i!==null&&(N=x(h,i));var k=v?{role:"status","aria-live":"assertive"}:{};return g.createElement("div",Yy({className:_,style:w},k),g.createElement("p",{className:A,style:b},g.isValidElement(N)?N:"".concat(N)),y())},fd="recharts-tooltip-wrapper",VZ={visibility:"hidden"};function KZ(e){var{coordinate:t,translateX:r,translateY:n}=e;return $t(fd,{["".concat(fd,"-right")]:ot(r)&&t&&ot(t.x)&&r>=t.x,["".concat(fd,"-left")]:ot(r)&&t&&ot(t.x)&&r<t.x,["".concat(fd,"-bottom")]:ot(n)&&t&&ot(t.y)&&n>=t.y,["".concat(fd,"-top")]:ot(n)&&t&&ot(t.y)&&n<t.y})}function dT(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offsetTopLeft:a,position:i,reverseDirection:o,tooltipDimension:u,viewBox:m,viewBoxDimension:f}=e;if(i&&ot(i[n]))return i[n];var h=r[n]-u-(a>0?a:0),x=r[n]+a;if(t[n])return o[n]?h:x;var v=m[n];if(v==null)return 0;if(o[n]){var y=h,w=v;return y<w?Math.max(x,v):Math.max(h,v)}if(f==null)return 0;var b=x+u,S=v+f;return b>S?Math.max(h,v):Math.max(x,v)}function GZ(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function WZ(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:n,position:a,reverseDirection:i,tooltipBox:o,useTranslate3d:u,viewBox:m}=e,f,h,x;return o.height>0&&o.width>0&&r?(h=dT({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:o.width,viewBox:m,viewBoxDimension:m.width}),x=dT({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:o.height,viewBox:m,viewBoxDimension:m.height}),f=GZ({translateX:h,translateY:x,useTranslate3d:u})):f=VZ,{cssProperties:f,cssClasses:KZ({translateX:h,translateY:x,coordinate:r})}}function fT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function vh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fT(Object(r),!0).forEach(function(n){Zy(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Zy(e,t,r){return(t=XZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XZ(e){var t=YZ(e,"string");return typeof t=="symbol"?t:t+""}function YZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class ZZ extends g.PureComponent{constructor(){super(...arguments),Zy(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),Zy(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,a,i;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(a=(i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:a,children:i,coordinate:o,hasPayload:u,isAnimationActive:m,offset:f,position:h,reverseDirection:x,useTranslate3d:v,viewBox:y,wrapperStyle:w,lastBoundingBox:b,innerRef:S,hasPortalFromProps:N}=this.props,{cssClasses:_,cssProperties:A}=WZ({allowEscapeViewBox:r,coordinate:o,offsetTopLeft:f,position:h,reverseDirection:x,tooltipBox:{height:b.height,width:b.width},useTranslate3d:v,viewBox:y}),k=N?{}:vh(vh({transition:m&&t?"transform ".concat(n,"ms ").concat(a):void 0},A),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&u?"visible":"hidden",position:"absolute",top:0,left:0}),C=vh(vh({},k),{},{visibility:!this.state.dismissed&&t&&u?"visible":"hidden"},w);return g.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:_,style:C,ref:S},i)}}var QZ=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),zs={isSsr:QZ()},aD=()=>lt(e=>e.rootProps.accessibilityLayer);function Ba(e){return Number.isFinite(e)}function Hc(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function Qy(){return Qy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Qy.apply(null,arguments)}function hT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function mT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hT(Object(r),!0).forEach(function(n){JZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function JZ(e,t,r){return(t=eQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eQ(e){var t=tQ(e,"string");return typeof t=="symbol"?t:t+""}function tQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pT={curveBasisClosed:_W,curveBasisOpen:TW,curveBasis:AW,curveBumpX:fW,curveBumpY:hW,curveLinearClosed:kW,curveLinear:np,curveMonotoneX:CW,curveMonotoneY:OW,curveNatural:DW,curveStep:PW,curveStepAfter:MW,curveStepBefore:RW},gh=e=>Ba(e.x)&&Ba(e.y),hd=e=>e.x,md=e=>e.y,rQ=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(Ef(e));return(r==="curveMonotone"||r==="curveBump")&&t?pT["".concat(r).concat(t==="vertical"?"Y":"X")]:pT[r]||np},nQ=e=>{var{type:t="linear",points:r=[],baseLine:n,layout:a,connectNulls:i=!1}=e,o=rQ(t,a),u=i?r.filter(gh):r,m;if(Array.isArray(n)){var f=i?n.filter(x=>gh(x)):n,h=u.map((x,v)=>mT(mT({},x),{},{base:f[v]}));return a==="vertical"?m=fh().y(md).x1(hd).x0(x=>x.base.x):m=fh().x(hd).y1(md).y0(x=>x.base.y),m.defined(gh).curve(o),m(h)}return a==="vertical"&&ot(n)?m=fh().y(md).x1(hd).x0(n):ot(n)?m=fh().x(hd).y1(md).y0(n):m=Q5().x(hd).y(md),m.defined(gh).curve(o),m(u)},vp=e=>{var{className:t,points:r,path:n,pathRef:a}=e;if((!r||!r.length)&&!n)return null;var i=r&&r.length?nQ(e):n;return g.createElement("path",Qy({},kt(e,!1),y2(e),{className:$t("recharts-curve",t),d:i===null?void 0:i,ref:a}))},aQ=["x","y","top","left","width","height","className"];function Jy(){return Jy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Jy.apply(null,arguments)}function xT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function iQ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xT(Object(r),!0).forEach(function(n){sQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sQ(e,t,r){return(t=lQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lQ(e){var t=oQ(e,"string");return typeof t=="symbol"?t:t+""}function oQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cQ(e,t){if(e==null)return{};var r,n,a=uQ(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function uQ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var dQ=(e,t,r,n,a,i)=>"M".concat(e,",").concat(a,"v").concat(n,"M").concat(i,",").concat(t,"h").concat(r),fQ=e=>{var{x:t=0,y:r=0,top:n=0,left:a=0,width:i=0,height:o=0,className:u}=e,m=cQ(e,aQ),f=iQ({x:t,y:r,top:n,left:a,width:i,height:o},m);return!ot(t)||!ot(r)||!ot(i)||!ot(o)||!ot(n)||!ot(a)?null:g.createElement("path",Jy({},kt(f,!0),{className:$t("recharts-cross",u),d:dQ(t,r,i,o,n,a)}))};function hQ(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function vT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function mQ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vT(Object(r),!0).forEach(function(n){pQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pQ(e,t,r){return(t=xQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xQ(e){var t=vQ(e,"string");return typeof t=="symbol"?t:t+""}function vQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function da(e,t){var r=mQ({},e),n=t,a=Object.keys(t),i=a.reduce((o,u)=>(o[u]===void 0&&n[u]!==void 0&&(o[u]=n[u]),o),r);return i}var A1={},_1={},T1={},gT;function gQ(){return gT||(gT=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(!r||typeof r!="object")return!1;const n=Object.getPrototypeOf(r);return n===null||n===Object.prototype||Object.getPrototypeOf(n)===null?Object.prototype.toString.call(r)==="[object Object]":!1}e.isPlainObject=t}(T1)),T1}var yT;function yQ(){return yT||(yT=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=gQ(),r=h6(),n=k2(),a=C2(),i=_2();function o(f,h,x){return u(f,h,void 0,void 0,void 0,void 0,x)}function u(f,h,x,v,y,w,b){const S=b(f,h,x,v,y,w);if(S!==void 0)return S;if(typeof f==typeof h)switch(typeof f){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return f===h;case"number":return f===h||Object.is(f,h);case"function":return f===h;case"object":return m(f,h,w,b)}return m(f,h,w,b)}function m(f,h,x,v){if(Object.is(f,h))return!0;let y=n.getTag(f),w=n.getTag(h);if(y===a.argumentsTag&&(y=a.objectTag),w===a.argumentsTag&&(w=a.objectTag),y!==w)return!1;switch(y){case a.stringTag:return f.toString()===h.toString();case a.numberTag:{const N=f.valueOf(),_=h.valueOf();return i.eq(N,_)}case a.booleanTag:case a.dateTag:case a.symbolTag:return Object.is(f.valueOf(),h.valueOf());case a.regexpTag:return f.source===h.source&&f.flags===h.flags;case a.functionTag:return f===h}x=x??new Map;const b=x.get(f),S=x.get(h);if(b!=null&&S!=null)return b===h;x.set(f,h),x.set(h,f);try{switch(y){case a.mapTag:{if(f.size!==h.size)return!1;for(const[N,_]of f.entries())if(!h.has(N)||!u(_,h.get(N),N,f,h,x,v))return!1;return!0}case a.setTag:{if(f.size!==h.size)return!1;const N=Array.from(f.values()),_=Array.from(h.values());for(let A=0;A<N.length;A++){const k=N[A],C=_.findIndex(O=>u(k,O,void 0,f,h,x,v));if(C===-1)return!1;_.splice(C,1)}return!0}case a.arrayTag:case a.uint8ArrayTag:case a.uint8ClampedArrayTag:case a.uint16ArrayTag:case a.uint32ArrayTag:case a.bigUint64ArrayTag:case a.int8ArrayTag:case a.int16ArrayTag:case a.int32ArrayTag:case a.bigInt64ArrayTag:case a.float32ArrayTag:case a.float64ArrayTag:{if(typeof Buffer<"u"&&Buffer.isBuffer(f)!==Buffer.isBuffer(h)||f.length!==h.length)return!1;for(let N=0;N<f.length;N++)if(!u(f[N],h[N],N,f,h,x,v))return!1;return!0}case a.arrayBufferTag:return f.byteLength!==h.byteLength?!1:m(new Uint8Array(f),new Uint8Array(h),x,v);case a.dataViewTag:return f.byteLength!==h.byteLength||f.byteOffset!==h.byteOffset?!1:m(new Uint8Array(f),new Uint8Array(h),x,v);case a.errorTag:return f.name===h.name&&f.message===h.message;case a.objectTag:{if(!(m(f.constructor,h.constructor,x,v)||t.isPlainObject(f)&&t.isPlainObject(h)))return!1;const _=[...Object.keys(f),...r.getSymbols(f)],A=[...Object.keys(h),...r.getSymbols(h)];if(_.length!==A.length)return!1;for(let k=0;k<_.length;k++){const C=_[k],O=f[C];if(!Object.hasOwn(h,C))return!1;const T=h[C];if(!u(O,T,C,f,h,x,v))return!1}return!0}default:return!1}}finally{x.delete(f),x.delete(h)}}e.isEqualWith=o}(_1)),_1}var k1={},bT;function bQ(){return bT||(bT=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(){}e.noop=t}(k1)),k1}var wT;function wQ(){return wT||(wT=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=yQ(),r=bQ();function n(a,i){return t.isEqualWith(a,i,r.noop)}e.isEqual=n}(A1)),A1}var C1,ST;function SQ(){return ST||(ST=1,C1=wQ().isEqual),C1}var jQ=SQ();const NQ=fi(jQ);function EQ(e){var t={},r=()=>null,n=!1,a=null,i=o=>{if(!n){if(Array.isArray(o)){if(!o.length)return;var u=o,[m,...f]=u;if(typeof m=="number"){a=e.setTimeout(i.bind(null,f),m);return}i(m),a=e.setTimeout(i.bind(null,f));return}typeof o=="object"&&(t=o,r(t)),typeof o=="function"&&o()}};return{stop:()=>{n=!0},start:o=>{n=!1,a&&(a(),a=null),i(o)},subscribe:o=>(r=o,()=>{r=()=>null}),getTimeoutController:()=>e}}var mm=1e-4,iD=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],sD=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),jT=(e,t)=>r=>{var n=iD(e,t);return sD(n,r)},AQ=(e,t)=>r=>{var n=iD(e,t),a=[...n.map((i,o)=>i*o).slice(1),0];return sD(a,r)},NT=function(){for(var t,r,n,a,i=arguments.length,o=new Array(i),u=0;u<i;u++)o[u]=arguments[u];if(o.length===1)switch(o[0]){case"linear":[t,n,r,a]=[0,0,1,1];break;case"ease":[t,n,r,a]=[.25,.1,.25,1];break;case"ease-in":[t,n,r,a]=[.42,0,1,1];break;case"ease-out":[t,n,r,a]=[.42,0,.58,1];break;case"ease-in-out":[t,n,r,a]=[0,0,.58,1];break;default:{var m=o[0].split("(");m[0]==="cubic-bezier"&&m[1].split(")")[0].split(",").length===4&&([t,n,r,a]=m[1].split(")")[0].split(",").map(w=>parseFloat(w)))}}else o.length===4&&([t,n,r,a]=o);var f=jT(t,r),h=jT(n,a),x=AQ(t,r),v=w=>w>1?1:w<0?0:w,y=w=>{for(var b=w>1?1:w,S=b,N=0;N<8;++N){var _=f(S)-b,A=x(S);if(Math.abs(_-b)<mm||A<mm)return h(S);S=v(S-_/A)}return h(S)};return y.isStepper=!1,y},_Q=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:a=17}=t,i=(o,u,m)=>{var f=-(o-u)*r,h=m*n,x=m+(f-h)*a/1e3,v=m*a/1e3+o;return Math.abs(v-u)<mm&&Math.abs(x)<mm?[u,0]:[v,x]};return i.isStepper=!0,i.dt=a,i},TQ=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return NT(e);case"spring":return _Q();default:if(e.split("(")[0]==="cubic-bezier")return NT(e)}return typeof e=="function"?e:null};function ET(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function AT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ET(Object(r),!0).forEach(function(n){kQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ET(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kQ(e,t,r){return(t=CQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CQ(e){var t=OQ(e,"string");return typeof t=="symbol"?t:t+""}function OQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DQ=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),PQ=(e,t,r)=>e.map(n=>"".concat(DQ(n)," ").concat(t,"ms ").concat(r)).join(","),RQ=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(a=>n.includes(a))),nf=(e,t)=>Object.keys(t).reduce((r,n)=>AT(AT({},r),{},{[n]:e(n,t[n])}),{});function _T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Sn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_T(Object(r),!0).forEach(function(n){MQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_T(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function MQ(e,t,r){return(t=FQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FQ(e){var t=IQ(e,"string");return typeof t=="symbol"?t:t+""}function IQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pm=(e,t,r)=>e+(t-e)*r,eb=e=>{var{from:t,to:r}=e;return t!==r},lD=(e,t,r)=>{var n=nf((a,i)=>{if(eb(i)){var[o,u]=e(i.from,i.to,i.velocity);return Sn(Sn({},i),{},{from:o,velocity:u})}return i},t);return r<1?nf((a,i)=>eb(i)?Sn(Sn({},i),{},{velocity:pm(i.velocity,n[a].velocity,r),from:pm(i.from,n[a].from,r)}):i,t):lD(e,n,r-1)};function LQ(e,t,r,n,a,i){var o,u=n.reduce((v,y)=>Sn(Sn({},v),{},{[y]:{from:e[y],velocity:0,to:t[y]}}),{}),m=()=>nf((v,y)=>y.from,u),f=()=>!Object.values(u).filter(eb).length,h=null,x=v=>{o||(o=v);var y=v-o,w=y/r.dt;u=lD(r,u,w),a(Sn(Sn(Sn({},e),t),m())),o=v,f()||(h=i.setTimeout(x))};return()=>(h=i.setTimeout(x),()=>{h()})}function BQ(e,t,r,n,a,i,o){var u=null,m=a.reduce((x,v)=>Sn(Sn({},x),{},{[v]:[e[v],t[v]]}),{}),f,h=x=>{f||(f=x);var v=(x-f)/n,y=nf((b,S)=>pm(...S,r(v)),m);if(i(Sn(Sn(Sn({},e),t),y)),v<1)u=o.setTimeout(h);else{var w=nf((b,S)=>pm(...S,r(1)),m);i(Sn(Sn(Sn({},e),t),w))}};return()=>(u=o.setTimeout(h),()=>{u()})}const UQ=(e,t,r,n,a,i)=>{var o=RQ(e,t);return r.isStepper===!0?LQ(e,t,r,o,a,i):BQ(e,t,r,n,o,a,i)};class $Q{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),a=null,i=o=>{o-n>=r?t(o):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(i))};return a=requestAnimationFrame(i),()=>{cancelAnimationFrame(a)}}}var zQ=["children","begin","duration","attributeName","easing","isActive","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart","animationManager"];function tb(){return tb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tb.apply(null,arguments)}function HQ(e,t){if(e==null)return{};var r,n,a=qQ(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function qQ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function TT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function xl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TT(Object(r),!0).forEach(function(n){fo(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fo(e,t,r){return(t=VQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VQ(e){var t=KQ(e,"string");return typeof t=="symbol"?t:t+""}function KQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function GQ(){return EQ(new $Q)}class V2 extends g.PureComponent{constructor(t,r){super(t,r),fo(this,"mounted",!1),fo(this,"manager",null),fo(this,"stopJSAnimation",null),fo(this,"unSubscribe",null);var{isActive:n,attributeName:a,from:i,to:o,children:u,duration:m,animationManager:f}=this.props;if(this.manager=f,this.handleStyleChange=this.handleStyleChange.bind(this),this.changeStyle=this.changeStyle.bind(this),!n||m<=0){this.state={style:{}},typeof u=="function"&&(this.state={style:o});return}if(i){if(typeof u=="function"){this.state={style:i};return}this.state={style:a?{[a]:i}:i}}else this.state={style:{}}}componentDidMount(){var{isActive:t,canBegin:r}=this.props;this.mounted=!0,!(!t||!r)&&this.runAnimation(this.props)}componentDidUpdate(t){var{isActive:r,canBegin:n,attributeName:a,shouldReAnimate:i,to:o,from:u}=this.props,{style:m}=this.state;if(n){if(!r){var f={style:a?{[a]:o}:o};this.state&&m&&(a&&m[a]!==o||!a&&m!==o)&&this.setState(f);return}if(!(NQ(t.to,o)&&t.canBegin&&t.isActive)){var h=!t.canBegin||!t.isActive;this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var x=h||i?u:t.to;if(this.state&&m){var v={style:a?{[a]:x}:x};(a&&m[a]!==x||!a&&m!==x)&&this.setState(v)}this.runAnimation(xl(xl({},this.props),{},{from:x,begin:0}))}}}componentWillUnmount(){this.mounted=!1;var{onAnimationEnd:t}=this.props;this.unSubscribe&&this.unSubscribe(),this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation(),t&&t()}handleStyleChange(t){this.changeStyle(t)}changeStyle(t){this.mounted&&this.setState({style:t})}runJSAnimation(t){var{from:r,to:n,duration:a,easing:i,begin:o,onAnimationEnd:u,onAnimationStart:m}=t,f=UQ(r,n,TQ(i),a,this.changeStyle,this.manager.getTimeoutController()),h=()=>{this.stopJSAnimation=f()};this.manager.start([m,o,h,a,u])}runAnimation(t){var{begin:r,duration:n,attributeName:a,to:i,easing:o,onAnimationStart:u,onAnimationEnd:m,children:f}=t;if(this.unSubscribe=this.manager.subscribe(this.handleStyleChange),typeof o=="function"||typeof f=="function"||o==="spring"){this.runJSAnimation(t);return}var h=a?{[a]:i}:i,x=PQ(Object.keys(h),n,o);this.manager.start([u,r,xl(xl({},h),{},{transition:x}),n,m])}render(){var t=this.props,{children:r,begin:n,duration:a,attributeName:i,easing:o,isActive:u,from:m,to:f,canBegin:h,onAnimationEnd:x,shouldReAnimate:v,onAnimationReStart:y,animationManager:w}=t,b=HQ(t,zQ),S=g.Children.count(r),N=this.state.style;if(typeof r=="function")return r(N);if(!u||S===0||a<=0)return r;var _=A=>{var{style:k={},className:C}=A.props,O=g.cloneElement(A,xl(xl({},b),{},{style:xl(xl({},k),N),className:C}));return O};return S===1?_(g.Children.only(r)):g.createElement("div",null,g.Children.map(r,A=>_(A)))}}fo(V2,"displayName","Animate");fo(V2,"defaultProps",{begin:0,duration:1e3,attributeName:"",easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}});var WQ=g.createContext(null);function Xi(e){var t,r,n=g.useContext(WQ);return g.createElement(V2,tb({},e,{animationManager:(t=(r=e.animationManager)!==null&&r!==void 0?r:n)!==null&&t!==void 0?t:GQ()}))}function xm(){return xm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xm.apply(null,arguments)}var kT=(e,t,r,n,a)=>{var i=Math.min(Math.abs(r)/2,Math.abs(n)/2),o=n>=0?1:-1,u=r>=0?1:-1,m=n>=0&&r>=0||n<0&&r<0?1:0,f;if(i>0&&a instanceof Array){for(var h=[0,0,0,0],x=0,v=4;x<v;x++)h[x]=a[x]>i?i:a[x];f="M".concat(e,",").concat(t+o*h[0]),h[0]>0&&(f+="A ".concat(h[0],",").concat(h[0],",0,0,").concat(m,",").concat(e+u*h[0],",").concat(t)),f+="L ".concat(e+r-u*h[1],",").concat(t),h[1]>0&&(f+="A ".concat(h[1],",").concat(h[1],",0,0,").concat(m,`,
        `).concat(e+r,",").concat(t+o*h[1])),f+="L ".concat(e+r,",").concat(t+n-o*h[2]),h[2]>0&&(f+="A ".concat(h[2],",").concat(h[2],",0,0,").concat(m,`,
        `).concat(e+r-u*h[2],",").concat(t+n)),f+="L ".concat(e+u*h[3],",").concat(t+n),h[3]>0&&(f+="A ".concat(h[3],",").concat(h[3],",0,0,").concat(m,`,
        `).concat(e,",").concat(t+n-o*h[3])),f+="Z"}else if(i>0&&a===+a&&a>0){var y=Math.min(i,a);f="M ".concat(e,",").concat(t+o*y,`
            A `).concat(y,",").concat(y,",0,0,").concat(m,",").concat(e+u*y,",").concat(t,`
            L `).concat(e+r-u*y,",").concat(t,`
            A `).concat(y,",").concat(y,",0,0,").concat(m,",").concat(e+r,",").concat(t+o*y,`
            L `).concat(e+r,",").concat(t+n-o*y,`
            A `).concat(y,",").concat(y,",0,0,").concat(m,",").concat(e+r-u*y,",").concat(t+n,`
            L `).concat(e+u*y,",").concat(t+n,`
            A `).concat(y,",").concat(y,",0,0,").concat(m,",").concat(e,",").concat(t+n-o*y," Z")}else f="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(n," h ").concat(-r," Z");return f},XQ={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},oD=e=>{var t=da(e,XQ),r=g.useRef(null),[n,a]=g.useState(-1);g.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var N=r.current.getTotalLength();N&&a(N)}catch{}},[]);var{x:i,y:o,width:u,height:m,radius:f,className:h}=t,{animationEasing:x,animationDuration:v,animationBegin:y,isAnimationActive:w,isUpdateAnimationActive:b}=t;if(i!==+i||o!==+o||u!==+u||m!==+m||u===0||m===0)return null;var S=$t("recharts-rectangle",h);return b?g.createElement(Xi,{canBegin:n>0,from:{width:u,height:m,x:i,y:o},to:{width:u,height:m,x:i,y:o},duration:v,animationEasing:x,isActive:b},N=>{var{width:_,height:A,x:k,y:C}=N;return g.createElement(Xi,{canBegin:n>0,from:"0px ".concat(n===-1?1:n,"px"),to:"".concat(n,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:v,isActive:w,easing:x},g.createElement("path",xm({},kt(t,!0),{className:S,d:kT(k,C,_,A,f),ref:r})))}):g.createElement("path",xm({},kt(t,!0),{className:S,d:kT(i,o,u,m,f)}))};function cD(e){var{cx:t,cy:r,radius:n,startAngle:a,endAngle:i}=e,o=Wr(t,r,n,a),u=Wr(t,r,n,i);return{points:[o,u],cx:t,cy:r,radius:n,startAngle:a,endAngle:i}}function rb(){return rb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rb.apply(null,arguments)}var YQ=(e,t)=>{var r=Gr(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},yh=e=>{var{cx:t,cy:r,radius:n,angle:a,sign:i,isExternal:o,cornerRadius:u,cornerIsExternal:m}=e,f=u*(o?1:-1)+n,h=Math.asin(u/f)/dm,x=m?a:a+i*h,v=Wr(t,r,f,x),y=Wr(t,r,n,x),w=m?a-i*h:a,b=Wr(t,r,f*Math.cos(h*dm),w);return{center:v,circleTangency:y,lineTangency:b,theta:h}},uD=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:i,endAngle:o}=e,u=YQ(i,o),m=i+u,f=Wr(t,r,a,i),h=Wr(t,r,a,m),x="M ".concat(f.x,",").concat(f.y,`
    A `).concat(a,",").concat(a,`,0,
    `).concat(+(Math.abs(u)>180),",").concat(+(i>m),`,
    `).concat(h.x,",").concat(h.y,`
  `);if(n>0){var v=Wr(t,r,n,i),y=Wr(t,r,n,m);x+="L ".concat(y.x,",").concat(y.y,`
            A `).concat(n,",").concat(n,`,0,
            `).concat(+(Math.abs(u)>180),",").concat(+(i<=m),`,
            `).concat(v.x,",").concat(v.y," Z")}else x+="L ".concat(t,",").concat(r," Z");return x},ZQ=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,cornerRadius:i,forceCornerRadius:o,cornerIsExternal:u,startAngle:m,endAngle:f}=e,h=Gr(f-m),{circleTangency:x,lineTangency:v,theta:y}=yh({cx:t,cy:r,radius:a,angle:m,sign:h,cornerRadius:i,cornerIsExternal:u}),{circleTangency:w,lineTangency:b,theta:S}=yh({cx:t,cy:r,radius:a,angle:f,sign:-h,cornerRadius:i,cornerIsExternal:u}),N=u?Math.abs(m-f):Math.abs(m-f)-y-S;if(N<0)return o?"M ".concat(v.x,",").concat(v.y,`
        a`).concat(i,",").concat(i,",0,0,1,").concat(i*2,`,0
        a`).concat(i,",").concat(i,",0,0,1,").concat(-i*2,`,0
      `):uD({cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:m,endAngle:f});var _="M ".concat(v.x,",").concat(v.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(h<0),",").concat(x.x,",").concat(x.y,`
    A`).concat(a,",").concat(a,",0,").concat(+(N>180),",").concat(+(h<0),",").concat(w.x,",").concat(w.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(h<0),",").concat(b.x,",").concat(b.y,`
  `);if(n>0){var{circleTangency:A,lineTangency:k,theta:C}=yh({cx:t,cy:r,radius:n,angle:m,sign:h,isExternal:!0,cornerRadius:i,cornerIsExternal:u}),{circleTangency:O,lineTangency:T,theta:z}=yh({cx:t,cy:r,radius:n,angle:f,sign:-h,isExternal:!0,cornerRadius:i,cornerIsExternal:u}),P=u?Math.abs(m-f):Math.abs(m-f)-C-z;if(P<0&&i===0)return"".concat(_,"L").concat(t,",").concat(r,"Z");_+="L".concat(T.x,",").concat(T.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(h<0),",").concat(O.x,",").concat(O.y,`
      A`).concat(n,",").concat(n,",0,").concat(+(P>180),",").concat(+(h>0),",").concat(A.x,",").concat(A.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(h<0),",").concat(k.x,",").concat(k.y,"Z")}else _+="L".concat(t,",").concat(r,"Z");return _},QQ={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},_f=e=>{var t=da(e,QQ),{cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:o,forceCornerRadius:u,cornerIsExternal:m,startAngle:f,endAngle:h,className:x}=t;if(i<a||f===h)return null;var v=$t("recharts-sector",x),y=i-a,w=Zn(o,y,0,!0),b;return w>0&&Math.abs(f-h)<360?b=ZQ({cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:Math.min(w,y/2),forceCornerRadius:u,cornerIsExternal:m,startAngle:f,endAngle:h}):b=uD({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:f,endAngle:h}),g.createElement("path",rb({},kt(t,!0),{className:v,d:b}))};function JQ(e,t,r){var n,a,i,o;if(e==="horizontal")n=t.x,i=n,a=r.top,o=r.top+r.height;else if(e==="vertical")a=t.y,o=a,n=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:u,cy:m,innerRadius:f,outerRadius:h,angle:x}=t,v=Wr(u,m,f,x),y=Wr(u,m,h,x);n=v.x,a=v.y,i=y.x,o=y.y}else return cD(t);return[{x:n,y:a},{x:i,y:o}]}var O1={},D1={},P1={},CT;function eJ(){return CT||(CT=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=g6();function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r}(P1)),P1}var OT;function tJ(){return OT||(OT=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=eJ();function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r}(D1)),D1}var DT;function rJ(){return DT||(DT=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=y6(),r=tJ();function n(a,i,o){o&&typeof o!="number"&&t.isIterateeCall(a,i,o)&&(i=o=void 0),a=r.toFinite(a),i===void 0?(i=a,a=0):i=r.toFinite(i),o=o===void 0?a<i?1:-1:r.toFinite(o);const u=Math.max(Math.ceil((i-a)/(o||1)),0),m=new Array(u);for(let f=0;f<u;f++)m[f]=a,a+=o;return m}e.range=n}(O1)),O1}var R1,PT;function nJ(){return PT||(PT=1,R1=rJ().range),R1}var aJ=nJ();const dD=fi(aJ);function Al(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function iJ(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function K2(e){let t,r,n;e.length!==2?(t=Al,r=(u,m)=>Al(e(u),m),n=(u,m)=>e(u)-m):(t=e===Al||e===iJ?e:sJ,r=e,n=e);function a(u,m,f=0,h=u.length){if(f<h){if(t(m,m)!==0)return h;do{const x=f+h>>>1;r(u[x],m)<0?f=x+1:h=x}while(f<h)}return f}function i(u,m,f=0,h=u.length){if(f<h){if(t(m,m)!==0)return h;do{const x=f+h>>>1;r(u[x],m)<=0?f=x+1:h=x}while(f<h)}return f}function o(u,m,f=0,h=u.length){const x=a(u,m,f,h-1);return x>f&&n(u[x-1],m)>-n(u[x],m)?x-1:x}return{left:a,center:o,right:i}}function sJ(){return 0}function fD(e){return e===null?NaN:+e}function*lJ(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const oJ=K2(Al),Tf=oJ.right;K2(fD).center;class RT extends Map{constructor(t,r=dJ){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(MT(this,t))}has(t){return super.has(MT(this,t))}set(t,r){return super.set(cJ(this,t),r)}delete(t){return super.delete(uJ(this,t))}}function MT({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function cJ({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function uJ({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function dJ(e){return e!==null&&typeof e=="object"?e.valueOf():e}function fJ(e=Al){if(e===Al)return hD;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function hD(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const hJ=Math.sqrt(50),mJ=Math.sqrt(10),pJ=Math.sqrt(2);function vm(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),o=i>=hJ?10:i>=mJ?5:i>=pJ?2:1;let u,m,f;return a<0?(f=Math.pow(10,-a)/o,u=Math.round(e*f),m=Math.round(t*f),u/f<e&&++u,m/f>t&&--m,f=-f):(f=Math.pow(10,a)*o,u=Math.round(e/f),m=Math.round(t/f),u*f<e&&++u,m*f>t&&--m),m<u&&.5<=r&&r<2?vm(e,t,r*2):[u,m,f]}function nb(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,i,o]=n?vm(t,e,r):vm(e,t,r);if(!(i>=a))return[];const u=i-a+1,m=new Array(u);if(n)if(o<0)for(let f=0;f<u;++f)m[f]=(i-f)/-o;else for(let f=0;f<u;++f)m[f]=(i-f)*o;else if(o<0)for(let f=0;f<u;++f)m[f]=(a+f)/-o;else for(let f=0;f<u;++f)m[f]=(a+f)*o;return m}function ab(e,t,r){return t=+t,e=+e,r=+r,vm(e,t,r)[2]}function ib(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?ab(t,e,r):ab(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function FT(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function IT(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function mD(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?hD:fJ(a);n>r;){if(n-r>600){const m=n-r+1,f=t-r+1,h=Math.log(m),x=.5*Math.exp(2*h/3),v=.5*Math.sqrt(h*x*(m-x)/m)*(f-m/2<0?-1:1),y=Math.max(r,Math.floor(t-f*x/m+v)),w=Math.min(n,Math.floor(t+(m-f)*x/m+v));mD(e,t,y,w,a)}const i=e[t];let o=r,u=n;for(pd(e,r,t),a(e[n],i)>0&&pd(e,r,n);o<u;){for(pd(e,o,u),++o,--u;a(e[o],i)<0;)++o;for(;a(e[u],i)>0;)--u}a(e[r],i)===0?pd(e,r,u):(++u,pd(e,u,n)),u<=t&&(r=u+1),t<=u&&(n=u-1)}return e}function pd(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function xJ(e,t,r){if(e=Float64Array.from(lJ(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return IT(e);if(t>=1)return FT(e);var n,a=(n-1)*t,i=Math.floor(a),o=FT(mD(e,i).subarray(0,i+1)),u=IT(e.subarray(i+1));return o+(u-o)*(a-i)}}function vJ(e,t,r=fD){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),o=+r(e[i],i,e),u=+r(e[i+1],i+1,e);return o+(u-o)*(a-i)}}function gJ(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++n<a;)i[n]=e+n*r;return i}function xi(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Hs(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const sb=Symbol("implicit");function G2(){var e=new RT,t=[],r=[],n=sb;function a(i){let o=e.get(i);if(o===void 0){if(n!==sb)return n;e.set(i,o=t.push(i)-1)}return r[o%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new RT;for(const o of i)e.has(o)||e.set(o,t.push(o)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return G2(t,r).unknown(n)},xi.apply(a,arguments),a}function W2(){var e=G2().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,i,o,u=!1,m=0,f=0,h=.5;delete e.unknown;function x(){var v=t().length,y=a<n,w=y?a:n,b=y?n:a;i=(b-w)/Math.max(1,v-m+f*2),u&&(i=Math.floor(i)),w+=(b-w-i*(v-m))*h,o=i*(1-m),u&&(w=Math.round(w),o=Math.round(o));var S=gJ(v).map(function(N){return w+i*N});return r(y?S.reverse():S)}return e.domain=function(v){return arguments.length?(t(v),x()):t()},e.range=function(v){return arguments.length?([n,a]=v,n=+n,a=+a,x()):[n,a]},e.rangeRound=function(v){return[n,a]=v,n=+n,a=+a,u=!0,x()},e.bandwidth=function(){return o},e.step=function(){return i},e.round=function(v){return arguments.length?(u=!!v,x()):u},e.padding=function(v){return arguments.length?(m=Math.min(1,f=+v),x()):m},e.paddingInner=function(v){return arguments.length?(m=Math.min(1,v),x()):m},e.paddingOuter=function(v){return arguments.length?(f=+v,x()):f},e.align=function(v){return arguments.length?(h=Math.max(0,Math.min(1,v)),x()):h},e.copy=function(){return W2(t(),[n,a]).round(u).paddingInner(m).paddingOuter(f).align(h)},xi.apply(x(),arguments)}function pD(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return pD(t())},e}function yJ(){return pD(W2.apply(null,arguments).paddingInner(1))}function X2(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function xD(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function kf(){}var af=.7,gm=1/af,Ic="\\s*([+-]?\\d+)\\s*",sf="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ki="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",bJ=/^#([0-9a-f]{3,8})$/,wJ=new RegExp(`^rgb\\(${Ic},${Ic},${Ic}\\)$`),SJ=new RegExp(`^rgb\\(${Ki},${Ki},${Ki}\\)$`),jJ=new RegExp(`^rgba\\(${Ic},${Ic},${Ic},${sf}\\)$`),NJ=new RegExp(`^rgba\\(${Ki},${Ki},${Ki},${sf}\\)$`),EJ=new RegExp(`^hsl\\(${sf},${Ki},${Ki}\\)$`),AJ=new RegExp(`^hsla\\(${sf},${Ki},${Ki},${sf}\\)$`),LT={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};X2(kf,lf,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:BT,formatHex:BT,formatHex8:_J,formatHsl:TJ,formatRgb:UT,toString:UT});function BT(){return this.rgb().formatHex()}function _J(){return this.rgb().formatHex8()}function TJ(){return vD(this).formatHsl()}function UT(){return this.rgb().formatRgb()}function lf(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=bJ.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?$T(t):r===3?new ia(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?bh(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?bh(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=wJ.exec(e))?new ia(t[1],t[2],t[3],1):(t=SJ.exec(e))?new ia(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=jJ.exec(e))?bh(t[1],t[2],t[3],t[4]):(t=NJ.exec(e))?bh(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=EJ.exec(e))?qT(t[1],t[2]/100,t[3]/100,1):(t=AJ.exec(e))?qT(t[1],t[2]/100,t[3]/100,t[4]):LT.hasOwnProperty(e)?$T(LT[e]):e==="transparent"?new ia(NaN,NaN,NaN,0):null}function $T(e){return new ia(e>>16&255,e>>8&255,e&255,1)}function bh(e,t,r,n){return n<=0&&(e=t=r=NaN),new ia(e,t,r,n)}function kJ(e){return e instanceof kf||(e=lf(e)),e?(e=e.rgb(),new ia(e.r,e.g,e.b,e.opacity)):new ia}function lb(e,t,r,n){return arguments.length===1?kJ(e):new ia(e,t,r,n??1)}function ia(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}X2(ia,lb,xD(kf,{brighter(e){return e=e==null?gm:Math.pow(gm,e),new ia(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?af:Math.pow(af,e),new ia(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ia(wo(this.r),wo(this.g),wo(this.b),ym(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:zT,formatHex:zT,formatHex8:CJ,formatRgb:HT,toString:HT}));function zT(){return`#${ho(this.r)}${ho(this.g)}${ho(this.b)}`}function CJ(){return`#${ho(this.r)}${ho(this.g)}${ho(this.b)}${ho((isNaN(this.opacity)?1:this.opacity)*255)}`}function HT(){const e=ym(this.opacity);return`${e===1?"rgb(":"rgba("}${wo(this.r)}, ${wo(this.g)}, ${wo(this.b)}${e===1?")":`, ${e})`}`}function ym(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function wo(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function ho(e){return e=wo(e),(e<16?"0":"")+e.toString(16)}function qT(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Ei(e,t,r,n)}function vD(e){if(e instanceof Ei)return new Ei(e.h,e.s,e.l,e.opacity);if(e instanceof kf||(e=lf(e)),!e)return new Ei;if(e instanceof Ei)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),o=NaN,u=i-a,m=(i+a)/2;return u?(t===i?o=(r-n)/u+(r<n)*6:r===i?o=(n-t)/u+2:o=(t-r)/u+4,u/=m<.5?i+a:2-i-a,o*=60):u=m>0&&m<1?0:o,new Ei(o,u,m,e.opacity)}function OJ(e,t,r,n){return arguments.length===1?vD(e):new Ei(e,t,r,n??1)}function Ei(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}X2(Ei,OJ,xD(kf,{brighter(e){return e=e==null?gm:Math.pow(gm,e),new Ei(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?af:Math.pow(af,e),new Ei(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new ia(M1(e>=240?e-240:e+120,a,n),M1(e,a,n),M1(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new Ei(VT(this.h),wh(this.s),wh(this.l),ym(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=ym(this.opacity);return`${e===1?"hsl(":"hsla("}${VT(this.h)}, ${wh(this.s)*100}%, ${wh(this.l)*100}%${e===1?")":`, ${e})`}`}}));function VT(e){return e=(e||0)%360,e<0?e+360:e}function wh(e){return Math.max(0,Math.min(1,e||0))}function M1(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const Y2=e=>()=>e;function DJ(e,t){return function(r){return e+r*t}}function PJ(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function RJ(e){return(e=+e)==1?gD:function(t,r){return r-t?PJ(t,r,e):Y2(isNaN(t)?r:t)}}function gD(e,t){var r=t-e;return r?DJ(e,r):Y2(isNaN(e)?t:e)}const KT=function e(t){var r=RJ(t);function n(a,i){var o=r((a=lb(a)).r,(i=lb(i)).r),u=r(a.g,i.g),m=r(a.b,i.b),f=gD(a.opacity,i.opacity);return function(h){return a.r=o(h),a.g=u(h),a.b=m(h),a.opacity=f(h),a+""}}return n.gamma=e,n}(1);function MJ(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function FJ(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function IJ(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),o;for(o=0;o<n;++o)a[o]=su(e[o],t[o]);for(;o<r;++o)i[o]=t[o];return function(u){for(o=0;o<n;++o)i[o]=a[o](u);return i}}function LJ(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function bm(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function BJ(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=su(e[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var ob=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,F1=new RegExp(ob.source,"g");function UJ(e){return function(){return e}}function $J(e){return function(t){return e(t)+""}}function zJ(e,t){var r=ob.lastIndex=F1.lastIndex=0,n,a,i,o=-1,u=[],m=[];for(e=e+"",t=t+"";(n=ob.exec(e))&&(a=F1.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),u[o]?u[o]+=i:u[++o]=i),(n=n[0])===(a=a[0])?u[o]?u[o]+=a:u[++o]=a:(u[++o]=null,m.push({i:o,x:bm(n,a)})),r=F1.lastIndex;return r<t.length&&(i=t.slice(r),u[o]?u[o]+=i:u[++o]=i),u.length<2?m[0]?$J(m[0].x):UJ(t):(t=m.length,function(f){for(var h=0,x;h<t;++h)u[(x=m[h]).i]=x.x(f);return u.join("")})}function su(e,t){var r=typeof t,n;return t==null||r==="boolean"?Y2(t):(r==="number"?bm:r==="string"?(n=lf(t))?(t=n,KT):zJ:t instanceof lf?KT:t instanceof Date?LJ:FJ(t)?MJ:Array.isArray(t)?IJ:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?BJ:bm)(e,t)}function Z2(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function HJ(e,t){t===void 0&&(t=e,e=su);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(o){var u=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return i[u](o-u)}}function qJ(e){return function(){return e}}function wm(e){return+e}var GT=[0,1];function Xn(e){return e}function cb(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:qJ(isNaN(t)?NaN:.5)}function VJ(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function KJ(e,t,r){var n=e[0],a=e[1],i=t[0],o=t[1];return a<n?(n=cb(a,n),i=r(o,i)):(n=cb(n,a),i=r(i,o)),function(u){return i(n(u))}}function GJ(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),i=new Array(n),o=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<n;)a[o]=cb(e[o],e[o+1]),i[o]=r(t[o],t[o+1]);return function(u){var m=Tf(e,u,1,n)-1;return i[m](a[m](u))}}function Cf(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function gp(){var e=GT,t=GT,r=su,n,a,i,o=Xn,u,m,f;function h(){var v=Math.min(e.length,t.length);return o!==Xn&&(o=VJ(e[0],e[v-1])),u=v>2?GJ:KJ,m=f=null,x}function x(v){return v==null||isNaN(v=+v)?i:(m||(m=u(e.map(n),t,r)))(n(o(v)))}return x.invert=function(v){return o(a((f||(f=u(t,e.map(n),bm)))(v)))},x.domain=function(v){return arguments.length?(e=Array.from(v,wm),h()):e.slice()},x.range=function(v){return arguments.length?(t=Array.from(v),h()):t.slice()},x.rangeRound=function(v){return t=Array.from(v),r=Z2,h()},x.clamp=function(v){return arguments.length?(o=v?!0:Xn,h()):o!==Xn},x.interpolate=function(v){return arguments.length?(r=v,h()):r},x.unknown=function(v){return arguments.length?(i=v,x):i},function(v,y){return n=v,a=y,h()}}function Q2(){return gp()(Xn,Xn)}function WJ(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Sm(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function qc(e){return e=Sm(Math.abs(e)),e?e[1]:NaN}function XJ(e,t){return function(r,n){for(var a=r.length,i=[],o=0,u=e[0],m=0;a>0&&u>0&&(m+u+1>n&&(u=Math.max(1,n-m)),i.push(r.substring(a-=u,a+u)),!((m+=u+1)>n));)u=e[o=(o+1)%e.length];return i.reverse().join(t)}}function YJ(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var ZJ=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function of(e){if(!(t=ZJ.exec(e)))throw new Error("invalid format: "+e);var t;return new J2({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}of.prototype=J2.prototype;function J2(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}J2.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function QJ(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var yD;function JJ(e,t){var r=Sm(e,t);if(!r)return e+"";var n=r[0],a=r[1],i=a-(yD=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,o=n.length;return i===o?n:i>o?n+new Array(i-o+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+Sm(e,Math.max(0,t+i-1))[0]}function WT(e,t){var r=Sm(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const XT={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:WJ,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>WT(e*100,t),r:WT,s:JJ,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function YT(e){return e}var ZT=Array.prototype.map,QT=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function eee(e){var t=e.grouping===void 0||e.thousands===void 0?YT:XJ(ZT.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?YT:YJ(ZT.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",u=e.minus===void 0?"":e.minus+"",m=e.nan===void 0?"NaN":e.nan+"";function f(x){x=of(x);var v=x.fill,y=x.align,w=x.sign,b=x.symbol,S=x.zero,N=x.width,_=x.comma,A=x.precision,k=x.trim,C=x.type;C==="n"?(_=!0,C="g"):XT[C]||(A===void 0&&(A=12),k=!0,C="g"),(S||v==="0"&&y==="=")&&(S=!0,v="0",y="=");var O=b==="$"?r:b==="#"&&/[boxX]/.test(C)?"0"+C.toLowerCase():"",T=b==="$"?n:/[%p]/.test(C)?o:"",z=XT[C],P=/[defgprs%]/.test(C);A=A===void 0?6:/[gprs]/.test(C)?Math.max(1,Math.min(21,A)):Math.max(0,Math.min(20,A));function Z(q){var B=O,fe=T,Ne,he,K;if(C==="c")fe=z(q)+fe,q="";else{q=+q;var H=q<0||1/q<0;if(q=isNaN(q)?m:z(Math.abs(q),A),k&&(q=QJ(q)),H&&+q==0&&w!=="+"&&(H=!1),B=(H?w==="("?w:u:w==="-"||w==="("?"":w)+B,fe=(C==="s"?QT[8+yD/3]:"")+fe+(H&&w==="("?")":""),P){for(Ne=-1,he=q.length;++Ne<he;)if(K=q.charCodeAt(Ne),48>K||K>57){fe=(K===46?a+q.slice(Ne+1):q.slice(Ne))+fe,q=q.slice(0,Ne);break}}}_&&!S&&(q=t(q,1/0));var be=B.length+q.length+fe.length,te=be<N?new Array(N-be+1).join(v):"";switch(_&&S&&(q=t(te+q,te.length?N-fe.length:1/0),te=""),y){case"<":q=B+q+fe+te;break;case"=":q=B+te+q+fe;break;case"^":q=te.slice(0,be=te.length>>1)+B+q+fe+te.slice(be);break;default:q=te+B+q+fe;break}return i(q)}return Z.toString=function(){return x+""},Z}function h(x,v){var y=f((x=of(x),x.type="f",x)),w=Math.max(-8,Math.min(8,Math.floor(qc(v)/3)))*3,b=Math.pow(10,-w),S=QT[8+w/3];return function(N){return y(b*N)+S}}return{format:f,formatPrefix:h}}var Sh,ew,bD;tee({thousands:",",grouping:[3],currency:["$",""]});function tee(e){return Sh=eee(e),ew=Sh.format,bD=Sh.formatPrefix,Sh}function ree(e){return Math.max(0,-qc(Math.abs(e)))}function nee(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(qc(t)/3)))*3-qc(Math.abs(e)))}function aee(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,qc(t)-qc(e))+1}function wD(e,t,r,n){var a=ib(e,t,r),i;switch(n=of(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(i=nee(a,o))&&(n.precision=i),bD(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=aee(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=ree(a))&&(n.precision=i-(n.type==="%")*2);break}}return ew(n)}function Rl(e){var t=e.domain;return e.ticks=function(r){var n=t();return nb(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return wD(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,o=n[a],u=n[i],m,f,h=10;for(u<o&&(f=o,o=u,u=f,f=a,a=i,i=f);h-- >0;){if(f=ab(o,u,r),f===m)return n[a]=o,n[i]=u,t(n);if(f>0)o=Math.floor(o/f)*f,u=Math.ceil(u/f)*f;else if(f<0)o=Math.ceil(o*f)/f,u=Math.floor(u*f)/f;else break;m=f}return e},e}function SD(){var e=Q2();return e.copy=function(){return Cf(e,SD())},xi.apply(e,arguments),Rl(e)}function jD(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,wm),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return jD(e).unknown(t)},e=arguments.length?Array.from(e,wm):[0,1],Rl(r)}function ND(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],i=e[n],o;return i<a&&(o=r,r=n,n=o,o=a,a=i,i=o),e[r]=t.floor(a),e[n]=t.ceil(i),e}function JT(e){return Math.log(e)}function ek(e){return Math.exp(e)}function iee(e){return-Math.log(-e)}function see(e){return-Math.exp(-e)}function lee(e){return isFinite(e)?+("1e"+e):e<0?0:e}function oee(e){return e===10?lee:e===Math.E?Math.exp:t=>Math.pow(e,t)}function cee(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function tk(e){return(t,r)=>-e(-t,r)}function tw(e){const t=e(JT,ek),r=t.domain;let n=10,a,i;function o(){return a=cee(n),i=oee(n),r()[0]<0?(a=tk(a),i=tk(i),e(iee,see)):e(JT,ek),t}return t.base=function(u){return arguments.length?(n=+u,o()):n},t.domain=function(u){return arguments.length?(r(u),o()):r()},t.ticks=u=>{const m=r();let f=m[0],h=m[m.length-1];const x=h<f;x&&([f,h]=[h,f]);let v=a(f),y=a(h),w,b;const S=u==null?10:+u;let N=[];if(!(n%1)&&y-v<S){if(v=Math.floor(v),y=Math.ceil(y),f>0){for(;v<=y;++v)for(w=1;w<n;++w)if(b=v<0?w/i(-v):w*i(v),!(b<f)){if(b>h)break;N.push(b)}}else for(;v<=y;++v)for(w=n-1;w>=1;--w)if(b=v>0?w/i(-v):w*i(v),!(b<f)){if(b>h)break;N.push(b)}N.length*2<S&&(N=nb(f,h,S))}else N=nb(v,y,Math.min(y-v,S)).map(i);return x?N.reverse():N},t.tickFormat=(u,m)=>{if(u==null&&(u=10),m==null&&(m=n===10?"s":","),typeof m!="function"&&(!(n%1)&&(m=of(m)).precision==null&&(m.trim=!0),m=ew(m)),u===1/0)return m;const f=Math.max(1,n*u/t.ticks().length);return h=>{let x=h/i(Math.round(a(h)));return x*n<n-.5&&(x*=n),x<=f?m(h):""}},t.nice=()=>r(ND(r(),{floor:u=>i(Math.floor(a(u))),ceil:u=>i(Math.ceil(a(u)))})),t}function ED(){const e=tw(gp()).domain([1,10]);return e.copy=()=>Cf(e,ED()).base(e.base()),xi.apply(e,arguments),e}function rk(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function nk(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function rw(e){var t=1,r=e(rk(t),nk(t));return r.constant=function(n){return arguments.length?e(rk(t=+n),nk(t)):t},Rl(r)}function AD(){var e=rw(gp());return e.copy=function(){return Cf(e,AD()).constant(e.constant())},xi.apply(e,arguments)}function ak(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function uee(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function dee(e){return e<0?-e*e:e*e}function nw(e){var t=e(Xn,Xn),r=1;function n(){return r===1?e(Xn,Xn):r===.5?e(uee,dee):e(ak(r),ak(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},Rl(t)}function aw(){var e=nw(gp());return e.copy=function(){return Cf(e,aw()).exponent(e.exponent())},xi.apply(e,arguments),e}function fee(){return aw.apply(null,arguments).exponent(.5)}function ik(e){return Math.sign(e)*e*e}function hee(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function _D(){var e=Q2(),t=[0,1],r=!1,n;function a(i){var o=hee(e(i));return isNaN(o)?n:r?Math.round(o):o}return a.invert=function(i){return e.invert(ik(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,wm)).map(ik)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return _D(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},xi.apply(a,arguments),Rl(a)}function TD(){var e=[],t=[],r=[],n;function a(){var o=0,u=Math.max(1,t.length);for(r=new Array(u-1);++o<u;)r[o-1]=vJ(e,o/u);return i}function i(o){return o==null||isNaN(o=+o)?n:t[Tf(r,o)]}return i.invertExtent=function(o){var u=t.indexOf(o);return u<0?[NaN,NaN]:[u>0?r[u-1]:e[0],u<r.length?r[u]:e[e.length-1]]},i.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let u of o)u!=null&&!isNaN(u=+u)&&e.push(u);return e.sort(Al),a()},i.range=function(o){return arguments.length?(t=Array.from(o),a()):t.slice()},i.unknown=function(o){return arguments.length?(n=o,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return TD().domain(e).range(t).unknown(n)},xi.apply(i,arguments)}function kD(){var e=0,t=1,r=1,n=[.5],a=[0,1],i;function o(m){return m!=null&&m<=m?a[Tf(n,m,0,r)]:i}function u(){var m=-1;for(n=new Array(r);++m<r;)n[m]=((m+1)*t-(m-r)*e)/(r+1);return o}return o.domain=function(m){return arguments.length?([e,t]=m,e=+e,t=+t,u()):[e,t]},o.range=function(m){return arguments.length?(r=(a=Array.from(m)).length-1,u()):a.slice()},o.invertExtent=function(m){var f=a.indexOf(m);return f<0?[NaN,NaN]:f<1?[e,n[0]]:f>=r?[n[r-1],t]:[n[f-1],n[f]]},o.unknown=function(m){return arguments.length&&(i=m),o},o.thresholds=function(){return n.slice()},o.copy=function(){return kD().domain([e,t]).range(a).unknown(i)},xi.apply(Rl(o),arguments)}function CD(){var e=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[Tf(e,i,0,n)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var o=t.indexOf(i);return[e[o-1],e[o]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return CD().domain(e).range(t).unknown(r)},xi.apply(a,arguments)}const I1=new Date,L1=new Date;function an(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const o=a(i),u=a.ceil(i);return i-o<u-i?o:u},a.offset=(i,o)=>(t(i=new Date(+i),o==null?1:Math.floor(o)),i),a.range=(i,o,u)=>{const m=[];if(i=a.ceil(i),u=u==null?1:Math.floor(u),!(i<o)||!(u>0))return m;let f;do m.push(f=new Date(+i)),t(i,u),e(i);while(f<i&&i<o);return m},a.filter=i=>an(o=>{if(o>=o)for(;e(o),!i(o);)o.setTime(o-1)},(o,u)=>{if(o>=o)if(u<0)for(;++u<=0;)for(;t(o,-1),!i(o););else for(;--u>=0;)for(;t(o,1),!i(o););}),r&&(a.count=(i,o)=>(I1.setTime(+i),L1.setTime(+o),e(I1),e(L1),Math.floor(r(I1,L1))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?o=>n(o)%i===0:o=>a.count(0,o)%i===0):a)),a}const jm=an(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);jm.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?an(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):jm);jm.range;const js=1e3,ii=js*60,Ns=ii*60,Rs=Ns*24,iw=Rs*7,sk=Rs*30,B1=Rs*365,mo=an(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*js)},(e,t)=>(t-e)/js,e=>e.getUTCSeconds());mo.range;const sw=an(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*js)},(e,t)=>{e.setTime(+e+t*ii)},(e,t)=>(t-e)/ii,e=>e.getMinutes());sw.range;const lw=an(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*ii)},(e,t)=>(t-e)/ii,e=>e.getUTCMinutes());lw.range;const ow=an(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*js-e.getMinutes()*ii)},(e,t)=>{e.setTime(+e+t*Ns)},(e,t)=>(t-e)/Ns,e=>e.getHours());ow.range;const cw=an(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Ns)},(e,t)=>(t-e)/Ns,e=>e.getUTCHours());cw.range;const Of=an(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*ii)/Rs,e=>e.getDate()-1);Of.range;const yp=an(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Rs,e=>e.getUTCDate()-1);yp.range;const OD=an(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Rs,e=>Math.floor(e/Rs));OD.range;function Bo(e){return an(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*ii)/iw)}const bp=Bo(0),Nm=Bo(1),mee=Bo(2),pee=Bo(3),Vc=Bo(4),xee=Bo(5),vee=Bo(6);bp.range;Nm.range;mee.range;pee.range;Vc.range;xee.range;vee.range;function Uo(e){return an(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/iw)}const wp=Uo(0),Em=Uo(1),gee=Uo(2),yee=Uo(3),Kc=Uo(4),bee=Uo(5),wee=Uo(6);wp.range;Em.range;gee.range;yee.range;Kc.range;bee.range;wee.range;const uw=an(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());uw.range;const dw=an(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());dw.range;const Ms=an(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Ms.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:an(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Ms.range;const Fs=an(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Fs.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:an(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});Fs.range;function DD(e,t,r,n,a,i){const o=[[mo,1,js],[mo,5,5*js],[mo,15,15*js],[mo,30,30*js],[i,1,ii],[i,5,5*ii],[i,15,15*ii],[i,30,30*ii],[a,1,Ns],[a,3,3*Ns],[a,6,6*Ns],[a,12,12*Ns],[n,1,Rs],[n,2,2*Rs],[r,1,iw],[t,1,sk],[t,3,3*sk],[e,1,B1]];function u(f,h,x){const v=h<f;v&&([f,h]=[h,f]);const y=x&&typeof x.range=="function"?x:m(f,h,x),w=y?y.range(f,+h+1):[];return v?w.reverse():w}function m(f,h,x){const v=Math.abs(h-f)/x,y=K2(([,,S])=>S).right(o,v);if(y===o.length)return e.every(ib(f/B1,h/B1,x));if(y===0)return jm.every(Math.max(ib(f,h,x),1));const[w,b]=o[v/o[y-1][2]<o[y][2]/v?y-1:y];return w.every(b)}return[u,m]}const[See,jee]=DD(Fs,dw,wp,OD,cw,lw),[Nee,Eee]=DD(Ms,uw,bp,Of,ow,sw);function U1(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function $1(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function xd(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function Aee(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,o=e.shortDays,u=e.months,m=e.shortMonths,f=vd(a),h=gd(a),x=vd(i),v=gd(i),y=vd(o),w=gd(o),b=vd(u),S=gd(u),N=vd(m),_=gd(m),A={a:H,A:be,b:te,B:I,c:null,d:fk,e:fk,f:Xee,g:ite,G:lte,H:Kee,I:Gee,j:Wee,L:PD,m:Yee,M:Zee,p:se,q:R,Q:pk,s:xk,S:Qee,u:Jee,U:ete,V:tte,w:rte,W:nte,x:null,X:null,y:ate,Y:ste,Z:ote,"%":mk},k={a:W,A:Y,b:Q,B:L,c:null,d:hk,e:hk,f:fte,g:Ste,G:Nte,H:cte,I:ute,j:dte,L:MD,m:hte,M:mte,p:ne,q:ge,Q:pk,s:xk,S:pte,u:xte,U:vte,V:gte,w:yte,W:bte,x:null,X:null,y:wte,Y:jte,Z:Ete,"%":mk},C={a:Z,A:q,b:B,B:fe,c:Ne,d:uk,e:uk,f:zee,g:ck,G:ok,H:dk,I:dk,j:Lee,L:$ee,m:Iee,M:Bee,p:P,q:Fee,Q:qee,s:Vee,S:Uee,u:Oee,U:Dee,V:Pee,w:Cee,W:Ree,x:he,X:K,y:ck,Y:ok,Z:Mee,"%":Hee};A.x=O(r,A),A.X=O(n,A),A.c=O(t,A),k.x=O(r,k),k.X=O(n,k),k.c=O(t,k);function O(G,ue){return function(Se){var M=[],Qe=-1,xe=0,me=G.length,ze,oe,ke;for(Se instanceof Date||(Se=new Date(+Se));++Qe<me;)G.charCodeAt(Qe)===37&&(M.push(G.slice(xe,Qe)),(oe=lk[ze=G.charAt(++Qe)])!=null?ze=G.charAt(++Qe):oe=ze==="e"?" ":"0",(ke=ue[ze])&&(ze=ke(Se,oe)),M.push(ze),xe=Qe+1);return M.push(G.slice(xe,Qe)),M.join("")}}function T(G,ue){return function(Se){var M=xd(1900,void 0,1),Qe=z(M,G,Se+="",0),xe,me;if(Qe!=Se.length)return null;if("Q"in M)return new Date(M.Q);if("s"in M)return new Date(M.s*1e3+("L"in M?M.L:0));if(ue&&!("Z"in M)&&(M.Z=0),"p"in M&&(M.H=M.H%12+M.p*12),M.m===void 0&&(M.m="q"in M?M.q:0),"V"in M){if(M.V<1||M.V>53)return null;"w"in M||(M.w=1),"Z"in M?(xe=$1(xd(M.y,0,1)),me=xe.getUTCDay(),xe=me>4||me===0?Em.ceil(xe):Em(xe),xe=yp.offset(xe,(M.V-1)*7),M.y=xe.getUTCFullYear(),M.m=xe.getUTCMonth(),M.d=xe.getUTCDate()+(M.w+6)%7):(xe=U1(xd(M.y,0,1)),me=xe.getDay(),xe=me>4||me===0?Nm.ceil(xe):Nm(xe),xe=Of.offset(xe,(M.V-1)*7),M.y=xe.getFullYear(),M.m=xe.getMonth(),M.d=xe.getDate()+(M.w+6)%7)}else("W"in M||"U"in M)&&("w"in M||(M.w="u"in M?M.u%7:"W"in M?1:0),me="Z"in M?$1(xd(M.y,0,1)).getUTCDay():U1(xd(M.y,0,1)).getDay(),M.m=0,M.d="W"in M?(M.w+6)%7+M.W*7-(me+5)%7:M.w+M.U*7-(me+6)%7);return"Z"in M?(M.H+=M.Z/100|0,M.M+=M.Z%100,$1(M)):U1(M)}}function z(G,ue,Se,M){for(var Qe=0,xe=ue.length,me=Se.length,ze,oe;Qe<xe;){if(M>=me)return-1;if(ze=ue.charCodeAt(Qe++),ze===37){if(ze=ue.charAt(Qe++),oe=C[ze in lk?ue.charAt(Qe++):ze],!oe||(M=oe(G,Se,M))<0)return-1}else if(ze!=Se.charCodeAt(M++))return-1}return M}function P(G,ue,Se){var M=f.exec(ue.slice(Se));return M?(G.p=h.get(M[0].toLowerCase()),Se+M[0].length):-1}function Z(G,ue,Se){var M=y.exec(ue.slice(Se));return M?(G.w=w.get(M[0].toLowerCase()),Se+M[0].length):-1}function q(G,ue,Se){var M=x.exec(ue.slice(Se));return M?(G.w=v.get(M[0].toLowerCase()),Se+M[0].length):-1}function B(G,ue,Se){var M=N.exec(ue.slice(Se));return M?(G.m=_.get(M[0].toLowerCase()),Se+M[0].length):-1}function fe(G,ue,Se){var M=b.exec(ue.slice(Se));return M?(G.m=S.get(M[0].toLowerCase()),Se+M[0].length):-1}function Ne(G,ue,Se){return z(G,t,ue,Se)}function he(G,ue,Se){return z(G,r,ue,Se)}function K(G,ue,Se){return z(G,n,ue,Se)}function H(G){return o[G.getDay()]}function be(G){return i[G.getDay()]}function te(G){return m[G.getMonth()]}function I(G){return u[G.getMonth()]}function se(G){return a[+(G.getHours()>=12)]}function R(G){return 1+~~(G.getMonth()/3)}function W(G){return o[G.getUTCDay()]}function Y(G){return i[G.getUTCDay()]}function Q(G){return m[G.getUTCMonth()]}function L(G){return u[G.getUTCMonth()]}function ne(G){return a[+(G.getUTCHours()>=12)]}function ge(G){return 1+~~(G.getUTCMonth()/3)}return{format:function(G){var ue=O(G+="",A);return ue.toString=function(){return G},ue},parse:function(G){var ue=T(G+="",!1);return ue.toString=function(){return G},ue},utcFormat:function(G){var ue=O(G+="",k);return ue.toString=function(){return G},ue},utcParse:function(G){var ue=T(G+="",!0);return ue.toString=function(){return G},ue}}}var lk={"-":"",_:" ",0:"0"},xn=/^\s*\d+/,_ee=/^%/,Tee=/[\\^$*+?|[\]().{}]/g;function Xt(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function kee(e){return e.replace(Tee,"\\$&")}function vd(e){return new RegExp("^(?:"+e.map(kee).join("|")+")","i")}function gd(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function Cee(e,t,r){var n=xn.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function Oee(e,t,r){var n=xn.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function Dee(e,t,r){var n=xn.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function Pee(e,t,r){var n=xn.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function Ree(e,t,r){var n=xn.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function ok(e,t,r){var n=xn.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function ck(e,t,r){var n=xn.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function Mee(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function Fee(e,t,r){var n=xn.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function Iee(e,t,r){var n=xn.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function uk(e,t,r){var n=xn.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function Lee(e,t,r){var n=xn.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function dk(e,t,r){var n=xn.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function Bee(e,t,r){var n=xn.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function Uee(e,t,r){var n=xn.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function $ee(e,t,r){var n=xn.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function zee(e,t,r){var n=xn.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function Hee(e,t,r){var n=_ee.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function qee(e,t,r){var n=xn.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function Vee(e,t,r){var n=xn.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function fk(e,t){return Xt(e.getDate(),t,2)}function Kee(e,t){return Xt(e.getHours(),t,2)}function Gee(e,t){return Xt(e.getHours()%12||12,t,2)}function Wee(e,t){return Xt(1+Of.count(Ms(e),e),t,3)}function PD(e,t){return Xt(e.getMilliseconds(),t,3)}function Xee(e,t){return PD(e,t)+"000"}function Yee(e,t){return Xt(e.getMonth()+1,t,2)}function Zee(e,t){return Xt(e.getMinutes(),t,2)}function Qee(e,t){return Xt(e.getSeconds(),t,2)}function Jee(e){var t=e.getDay();return t===0?7:t}function ete(e,t){return Xt(bp.count(Ms(e)-1,e),t,2)}function RD(e){var t=e.getDay();return t>=4||t===0?Vc(e):Vc.ceil(e)}function tte(e,t){return e=RD(e),Xt(Vc.count(Ms(e),e)+(Ms(e).getDay()===4),t,2)}function rte(e){return e.getDay()}function nte(e,t){return Xt(Nm.count(Ms(e)-1,e),t,2)}function ate(e,t){return Xt(e.getFullYear()%100,t,2)}function ite(e,t){return e=RD(e),Xt(e.getFullYear()%100,t,2)}function ste(e,t){return Xt(e.getFullYear()%1e4,t,4)}function lte(e,t){var r=e.getDay();return e=r>=4||r===0?Vc(e):Vc.ceil(e),Xt(e.getFullYear()%1e4,t,4)}function ote(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Xt(t/60|0,"0",2)+Xt(t%60,"0",2)}function hk(e,t){return Xt(e.getUTCDate(),t,2)}function cte(e,t){return Xt(e.getUTCHours(),t,2)}function ute(e,t){return Xt(e.getUTCHours()%12||12,t,2)}function dte(e,t){return Xt(1+yp.count(Fs(e),e),t,3)}function MD(e,t){return Xt(e.getUTCMilliseconds(),t,3)}function fte(e,t){return MD(e,t)+"000"}function hte(e,t){return Xt(e.getUTCMonth()+1,t,2)}function mte(e,t){return Xt(e.getUTCMinutes(),t,2)}function pte(e,t){return Xt(e.getUTCSeconds(),t,2)}function xte(e){var t=e.getUTCDay();return t===0?7:t}function vte(e,t){return Xt(wp.count(Fs(e)-1,e),t,2)}function FD(e){var t=e.getUTCDay();return t>=4||t===0?Kc(e):Kc.ceil(e)}function gte(e,t){return e=FD(e),Xt(Kc.count(Fs(e),e)+(Fs(e).getUTCDay()===4),t,2)}function yte(e){return e.getUTCDay()}function bte(e,t){return Xt(Em.count(Fs(e)-1,e),t,2)}function wte(e,t){return Xt(e.getUTCFullYear()%100,t,2)}function Ste(e,t){return e=FD(e),Xt(e.getUTCFullYear()%100,t,2)}function jte(e,t){return Xt(e.getUTCFullYear()%1e4,t,4)}function Nte(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Kc(e):Kc.ceil(e),Xt(e.getUTCFullYear()%1e4,t,4)}function Ete(){return"+0000"}function mk(){return"%"}function pk(e){return+e}function xk(e){return Math.floor(+e/1e3)}var Ac,ID,LD;Ate({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Ate(e){return Ac=Aee(e),ID=Ac.format,Ac.parse,LD=Ac.utcFormat,Ac.utcParse,Ac}function _te(e){return new Date(e)}function Tte(e){return e instanceof Date?+e:+new Date(+e)}function fw(e,t,r,n,a,i,o,u,m,f){var h=Q2(),x=h.invert,v=h.domain,y=f(".%L"),w=f(":%S"),b=f("%I:%M"),S=f("%I %p"),N=f("%a %d"),_=f("%b %d"),A=f("%B"),k=f("%Y");function C(O){return(m(O)<O?y:u(O)<O?w:o(O)<O?b:i(O)<O?S:n(O)<O?a(O)<O?N:_:r(O)<O?A:k)(O)}return h.invert=function(O){return new Date(x(O))},h.domain=function(O){return arguments.length?v(Array.from(O,Tte)):v().map(_te)},h.ticks=function(O){var T=v();return e(T[0],T[T.length-1],O??10)},h.tickFormat=function(O,T){return T==null?C:f(T)},h.nice=function(O){var T=v();return(!O||typeof O.range!="function")&&(O=t(T[0],T[T.length-1],O??10)),O?v(ND(T,O)):h},h.copy=function(){return Cf(h,fw(e,t,r,n,a,i,o,u,m,f))},h}function kte(){return xi.apply(fw(Nee,Eee,Ms,uw,bp,Of,ow,sw,mo,ID).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Cte(){return xi.apply(fw(See,jee,Fs,dw,wp,yp,cw,lw,mo,LD).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Sp(){var e=0,t=1,r,n,a,i,o=Xn,u=!1,m;function f(x){return x==null||isNaN(x=+x)?m:o(a===0?.5:(x=(i(x)-r)*a,u?Math.max(0,Math.min(1,x)):x))}f.domain=function(x){return arguments.length?([e,t]=x,r=i(e=+e),n=i(t=+t),a=r===n?0:1/(n-r),f):[e,t]},f.clamp=function(x){return arguments.length?(u=!!x,f):u},f.interpolator=function(x){return arguments.length?(o=x,f):o};function h(x){return function(v){var y,w;return arguments.length?([y,w]=v,o=x(y,w),f):[o(0),o(1)]}}return f.range=h(su),f.rangeRound=h(Z2),f.unknown=function(x){return arguments.length?(m=x,f):m},function(x){return i=x,r=x(e),n=x(t),a=r===n?0:1/(n-r),f}}function Ml(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function BD(){var e=Rl(Sp()(Xn));return e.copy=function(){return Ml(e,BD())},Hs.apply(e,arguments)}function UD(){var e=tw(Sp()).domain([1,10]);return e.copy=function(){return Ml(e,UD()).base(e.base())},Hs.apply(e,arguments)}function $D(){var e=rw(Sp());return e.copy=function(){return Ml(e,$D()).constant(e.constant())},Hs.apply(e,arguments)}function hw(){var e=nw(Sp());return e.copy=function(){return Ml(e,hw()).exponent(e.exponent())},Hs.apply(e,arguments)}function Ote(){return hw.apply(null,arguments).exponent(.5)}function zD(){var e=[],t=Xn;function r(n){if(n!=null&&!isNaN(n=+n))return t((Tf(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Al),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>xJ(e,i/n))},r.copy=function(){return zD(t).domain(e)},Hs.apply(r,arguments)}function jp(){var e=0,t=.5,r=1,n=1,a,i,o,u,m,f=Xn,h,x=!1,v;function y(b){return isNaN(b=+b)?v:(b=.5+((b=+h(b))-i)*(n*b<n*i?u:m),f(x?Math.max(0,Math.min(1,b)):b))}y.domain=function(b){return arguments.length?([e,t,r]=b,a=h(e=+e),i=h(t=+t),o=h(r=+r),u=a===i?0:.5/(i-a),m=i===o?0:.5/(o-i),n=i<a?-1:1,y):[e,t,r]},y.clamp=function(b){return arguments.length?(x=!!b,y):x},y.interpolator=function(b){return arguments.length?(f=b,y):f};function w(b){return function(S){var N,_,A;return arguments.length?([N,_,A]=S,f=HJ(b,[N,_,A]),y):[f(0),f(.5),f(1)]}}return y.range=w(su),y.rangeRound=w(Z2),y.unknown=function(b){return arguments.length?(v=b,y):v},function(b){return h=b,a=b(e),i=b(t),o=b(r),u=a===i?0:.5/(i-a),m=i===o?0:.5/(o-i),n=i<a?-1:1,y}}function HD(){var e=Rl(jp()(Xn));return e.copy=function(){return Ml(e,HD())},Hs.apply(e,arguments)}function qD(){var e=tw(jp()).domain([.1,1,10]);return e.copy=function(){return Ml(e,qD()).base(e.base())},Hs.apply(e,arguments)}function VD(){var e=rw(jp());return e.copy=function(){return Ml(e,VD()).constant(e.constant())},Hs.apply(e,arguments)}function mw(){var e=nw(jp());return e.copy=function(){return Ml(e,mw()).exponent(e.exponent())},Hs.apply(e,arguments)}function Dte(){return mw.apply(null,arguments).exponent(.5)}const _d=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:W2,scaleDiverging:HD,scaleDivergingLog:qD,scaleDivergingPow:mw,scaleDivergingSqrt:Dte,scaleDivergingSymlog:VD,scaleIdentity:jD,scaleImplicit:sb,scaleLinear:SD,scaleLog:ED,scaleOrdinal:G2,scalePoint:yJ,scalePow:aw,scaleQuantile:TD,scaleQuantize:kD,scaleRadial:_D,scaleSequential:BD,scaleSequentialLog:UD,scaleSequentialPow:hw,scaleSequentialQuantile:zD,scaleSequentialSqrt:Ote,scaleSequentialSymlog:$D,scaleSqrt:fee,scaleSymlog:AD,scaleThreshold:CD,scaleTime:kte,scaleUtc:Cte,tickFormat:wD},Symbol.toStringTag,{value:"Module"}));var Fl=e=>e.chartData,Np=_e([Fl],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),Ep=(e,t,r,n)=>n?Np(e):Fl(e);function Gc(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(Ba(t)&&Ba(r))return!0}return!1}function vk(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function Pte(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,a,i;if(Ba(r))a=r;else if(typeof r=="function")return;if(Ba(n))i=n;else if(typeof n=="function")return;var o=[a,i];if(Gc(o))return o}}function Rte(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(Gc(n))return vk(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[a,i]=e,o,u;if(a==="auto")t!=null&&(o=Math.min(...t));else if(ot(a))o=a;else if(typeof a=="function")try{t!=null&&(o=a(t?.[0]))}catch{}else if(typeof a=="string"&&aT.test(a)){var m=aT.exec(a);if(m==null||t==null)o=void 0;else{var f=+m[1];o=t[0]-f}}else o=t?.[0];if(i==="auto")t!=null&&(u=Math.max(...t));else if(ot(i))u=i;else if(typeof i=="function")try{t!=null&&(u=i(t?.[1]))}catch{}else if(typeof i=="string"&&iT.test(i)){var h=iT.exec(i);if(h==null||t==null)u=void 0;else{var x=+h[1];u=t[1]+x}}else u=t?.[1];var v=[o,u];if(Gc(v))return t==null?v:vk(v,t,r)}}}var lu=1e9,Mte={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},xw,jr=!0,ui="[DecimalError] ",So=ui+"Invalid argument: ",pw=ui+"Exponent out of range: ",ou=Math.floor,io=Math.pow,Fte=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Oa,hn=1e7,gr=7,KD=9007199254740991,Am=ou(KD/gr),ct={};ct.absoluteValue=ct.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};ct.comparedTo=ct.cmp=function(e){var t,r,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};ct.decimalPlaces=ct.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*gr;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};ct.dividedBy=ct.div=function(e){return Cs(this,new this.constructor(e))};ct.dividedToIntegerBy=ct.idiv=function(e){var t=this,r=t.constructor;return hr(Cs(t,new r(e),0,1),r.precision)};ct.equals=ct.eq=function(e){return!this.cmp(e)};ct.exponent=function(){return Xr(this)};ct.greaterThan=ct.gt=function(e){return this.cmp(e)>0};ct.greaterThanOrEqualTo=ct.gte=function(e){return this.cmp(e)>=0};ct.isInteger=ct.isint=function(){return this.e>this.d.length-2};ct.isNegative=ct.isneg=function(){return this.s<0};ct.isPositive=ct.ispos=function(){return this.s>0};ct.isZero=function(){return this.s===0};ct.lessThan=ct.lt=function(e){return this.cmp(e)<0};ct.lessThanOrEqualTo=ct.lte=function(e){return this.cmp(e)<1};ct.logarithm=ct.log=function(e){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Oa))throw Error(ui+"NaN");if(r.s<1)throw Error(ui+(r.s?"NaN":"-Infinity"));return r.eq(Oa)?new n(0):(jr=!1,t=Cs(cf(r,i),cf(e,i),i),jr=!0,hr(t,a))};ct.minus=ct.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?XD(t,e):GD(t,(e.s=-e.s,e))};ct.modulo=ct.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(ui+"NaN");return r.s?(jr=!1,t=Cs(r,e,0,1).times(e),jr=!0,r.minus(t)):hr(new n(r),a)};ct.naturalExponential=ct.exp=function(){return WD(this)};ct.naturalLogarithm=ct.ln=function(){return cf(this)};ct.negated=ct.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};ct.plus=ct.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?GD(t,e):XD(t,(e.s=-e.s,e))};ct.precision=ct.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(So+e);if(t=Xr(a)+1,n=a.d.length-1,r=n*gr+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};ct.squareRoot=ct.sqrt=function(){var e,t,r,n,a,i,o,u=this,m=u.constructor;if(u.s<1){if(!u.s)return new m(0);throw Error(ui+"NaN")}for(e=Xr(u),jr=!1,a=Math.sqrt(+u),a==0||a==1/0?(t=Vi(u.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=ou((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new m(t)):n=new m(a.toString()),r=m.precision,a=o=r+3;;)if(i=n,n=i.plus(Cs(u,i,o+2)).times(.5),Vi(i.d).slice(0,o)===(t=Vi(n.d)).slice(0,o)){if(t=t.slice(o-3,o+1),a==o&&t=="4999"){if(hr(i,r+1,0),i.times(i).eq(u)){n=i;break}}else if(t!="9999")break;o+=4}return jr=!0,hr(n,r)};ct.times=ct.mul=function(e){var t,r,n,a,i,o,u,m,f,h=this,x=h.constructor,v=h.d,y=(e=new x(e)).d;if(!h.s||!e.s)return new x(0);for(e.s*=h.s,r=h.e+e.e,m=v.length,f=y.length,m<f&&(i=v,v=y,y=i,o=m,m=f,f=o),i=[],o=m+f,n=o;n--;)i.push(0);for(n=f;--n>=0;){for(t=0,a=m+n;a>n;)u=i[a]+y[n]*v[a-n-1]+t,i[a--]=u%hn|0,t=u/hn|0;i[a]=(i[a]+t)%hn|0}for(;!i[--o];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,jr?hr(e,x.precision):e};ct.toDecimalPlaces=ct.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Yi(e,0,lu),t===void 0?t=n.rounding:Yi(t,0,8),hr(r,e+Xr(r)+1,t))};ct.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=ko(n,!0):(Yi(e,0,lu),t===void 0?t=a.rounding:Yi(t,0,8),n=hr(new a(n),e+1,t),r=ko(n,!0,e+1)),r};ct.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?ko(a):(Yi(e,0,lu),t===void 0?t=i.rounding:Yi(t,0,8),n=hr(new i(a),e+Xr(a)+1,t),r=ko(n.abs(),!1,e+Xr(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};ct.toInteger=ct.toint=function(){var e=this,t=e.constructor;return hr(new t(e),Xr(e)+1,t.rounding)};ct.toNumber=function(){return+this};ct.toPower=ct.pow=function(e){var t,r,n,a,i,o,u=this,m=u.constructor,f=12,h=+(e=new m(e));if(!e.s)return new m(Oa);if(u=new m(u),!u.s){if(e.s<1)throw Error(ui+"Infinity");return u}if(u.eq(Oa))return u;if(n=m.precision,e.eq(Oa))return hr(u,n);if(t=e.e,r=e.d.length-1,o=t>=r,i=u.s,o){if((r=h<0?-h:h)<=KD){for(a=new m(Oa),t=Math.ceil(n/gr+4),jr=!1;r%2&&(a=a.times(u),yk(a.d,t)),r=ou(r/2),r!==0;)u=u.times(u),yk(u.d,t);return jr=!0,e.s<0?new m(Oa).div(a):hr(a,n)}}else if(i<0)throw Error(ui+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,u.s=1,jr=!1,a=e.times(cf(u,n+f)),jr=!0,a=WD(a),a.s=i,a};ct.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?(r=Xr(a),n=ko(a,r<=i.toExpNeg||r>=i.toExpPos)):(Yi(e,1,lu),t===void 0?t=i.rounding:Yi(t,0,8),a=hr(new i(a),e,t),r=Xr(a),n=ko(a,e<=r||r<=i.toExpNeg,e)),n};ct.toSignificantDigits=ct.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Yi(e,1,lu),t===void 0?t=n.rounding:Yi(t,0,8)),hr(new n(r),e,t)};ct.toString=ct.valueOf=ct.val=ct.toJSON=ct[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Xr(e),r=e.constructor;return ko(e,t<=r.toExpNeg||t>=r.toExpPos)};function GD(e,t){var r,n,a,i,o,u,m,f,h=e.constructor,x=h.precision;if(!e.s||!t.s)return t.s||(t=new h(e)),jr?hr(t,x):t;if(m=e.d,f=t.d,o=e.e,a=t.e,m=m.slice(),i=o-a,i){for(i<0?(n=m,i=-i,u=f.length):(n=f,a=o,u=m.length),o=Math.ceil(x/gr),u=o>u?o+1:u+1,i>u&&(i=u,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(u=m.length,i=f.length,u-i<0&&(i=u,n=f,f=m,m=n),r=0;i;)r=(m[--i]=m[i]+f[i]+r)/hn|0,m[i]%=hn;for(r&&(m.unshift(r),++a),u=m.length;m[--u]==0;)m.pop();return t.d=m,t.e=a,jr?hr(t,x):t}function Yi(e,t,r){if(e!==~~e||e<t||e>r)throw Error(So+e)}function Vi(e){var t,r,n,a=e.length-1,i="",o=e[0];if(a>0){for(i+=o,t=1;t<a;t++)n=e[t]+"",r=gr-n.length,r&&(i+=yl(r)),i+=n;o=e[t],n=o+"",r=gr-n.length,r&&(i+=yl(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return i+o}var Cs=function(){function e(n,a){var i,o=0,u=n.length;for(n=n.slice();u--;)i=n[u]*a+o,n[u]=i%hn|0,o=i/hn|0;return o&&n.unshift(o),n}function t(n,a,i,o){var u,m;if(i!=o)m=i>o?1:-1;else for(u=m=0;u<i;u++)if(n[u]!=a[u]){m=n[u]>a[u]?1:-1;break}return m}function r(n,a,i){for(var o=0;i--;)n[i]-=o,o=n[i]<a[i]?1:0,n[i]=o*hn+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,o){var u,m,f,h,x,v,y,w,b,S,N,_,A,k,C,O,T,z,P=n.constructor,Z=n.s==a.s?1:-1,q=n.d,B=a.d;if(!n.s)return new P(n);if(!a.s)throw Error(ui+"Division by zero");for(m=n.e-a.e,T=B.length,C=q.length,y=new P(Z),w=y.d=[],f=0;B[f]==(q[f]||0);)++f;if(B[f]>(q[f]||0)&&--m,i==null?_=i=P.precision:o?_=i+(Xr(n)-Xr(a))+1:_=i,_<0)return new P(0);if(_=_/gr+2|0,f=0,T==1)for(h=0,B=B[0],_++;(f<C||h)&&_--;f++)A=h*hn+(q[f]||0),w[f]=A/B|0,h=A%B|0;else{for(h=hn/(B[0]+1)|0,h>1&&(B=e(B,h),q=e(q,h),T=B.length,C=q.length),k=T,b=q.slice(0,T),S=b.length;S<T;)b[S++]=0;z=B.slice(),z.unshift(0),O=B[0],B[1]>=hn/2&&++O;do h=0,u=t(B,b,T,S),u<0?(N=b[0],T!=S&&(N=N*hn+(b[1]||0)),h=N/O|0,h>1?(h>=hn&&(h=hn-1),x=e(B,h),v=x.length,S=b.length,u=t(x,b,v,S),u==1&&(h--,r(x,T<v?z:B,v))):(h==0&&(u=h=1),x=B.slice()),v=x.length,v<S&&x.unshift(0),r(b,x,S),u==-1&&(S=b.length,u=t(B,b,T,S),u<1&&(h++,r(b,T<S?z:B,S))),S=b.length):u===0&&(h++,b=[0]),w[f++]=h,u&&b[0]?b[S++]=q[k]||0:(b=[q[k]],S=1);while((k++<C||b[0]!==void 0)&&_--)}return w[0]||w.shift(),y.e=m,hr(y,o?i+Xr(y)+1:i)}}();function WD(e,t){var r,n,a,i,o,u,m=0,f=0,h=e.constructor,x=h.precision;if(Xr(e)>16)throw Error(pw+Xr(e));if(!e.s)return new h(Oa);for(jr=!1,u=x,o=new h(.03125);e.abs().gte(.1);)e=e.times(o),f+=5;for(n=Math.log(io(2,f))/Math.LN10*2+5|0,u+=n,r=a=i=new h(Oa),h.precision=u;;){if(a=hr(a.times(e),u),r=r.times(++m),o=i.plus(Cs(a,r,u)),Vi(o.d).slice(0,u)===Vi(i.d).slice(0,u)){for(;f--;)i=hr(i.times(i),u);return h.precision=x,t==null?(jr=!0,hr(i,x)):i}i=o}}function Xr(e){for(var t=e.e*gr,r=e.d[0];r>=10;r/=10)t++;return t}function z1(e,t,r){if(t>e.LN10.sd())throw jr=!0,r&&(e.precision=r),Error(ui+"LN10 precision limit exceeded");return hr(new e(e.LN10),t)}function yl(e){for(var t="";e--;)t+="0";return t}function cf(e,t){var r,n,a,i,o,u,m,f,h,x=1,v=10,y=e,w=y.d,b=y.constructor,S=b.precision;if(y.s<1)throw Error(ui+(y.s?"NaN":"-Infinity"));if(y.eq(Oa))return new b(0);if(t==null?(jr=!1,f=S):f=t,y.eq(10))return t==null&&(jr=!0),z1(b,f);if(f+=v,b.precision=f,r=Vi(w),n=r.charAt(0),i=Xr(y),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)y=y.times(e),r=Vi(y.d),n=r.charAt(0),x++;i=Xr(y),n>1?(y=new b("0."+r),i++):y=new b(n+"."+r.slice(1))}else return m=z1(b,f+2,S).times(i+""),y=cf(new b(n+"."+r.slice(1)),f-v).plus(m),b.precision=S,t==null?(jr=!0,hr(y,S)):y;for(u=o=y=Cs(y.minus(Oa),y.plus(Oa),f),h=hr(y.times(y),f),a=3;;){if(o=hr(o.times(h),f),m=u.plus(Cs(o,new b(a),f)),Vi(m.d).slice(0,f)===Vi(u.d).slice(0,f))return u=u.times(2),i!==0&&(u=u.plus(z1(b,f+2,S).times(i+""))),u=Cs(u,new b(x),f),b.precision=S,t==null?(jr=!0,hr(u,S)):u;u=m,a+=2}}function gk(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=ou(r/gr),e.d=[],n=(r+1)%gr,r<0&&(n+=gr),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=gr;n<a;)e.d.push(+t.slice(n,n+=gr));t=t.slice(n),n=gr-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),jr&&(e.e>Am||e.e<-Am))throw Error(pw+r)}else e.s=0,e.e=0,e.d=[0];return e}function hr(e,t,r){var n,a,i,o,u,m,f,h,x=e.d;for(o=1,i=x[0];i>=10;i/=10)o++;if(n=t-o,n<0)n+=gr,a=t,f=x[h=0];else{if(h=Math.ceil((n+1)/gr),i=x.length,h>=i)return e;for(f=i=x[h],o=1;i>=10;i/=10)o++;n%=gr,a=n-gr+o}if(r!==void 0&&(i=io(10,o-a-1),u=f/i%10|0,m=t<0||x[h+1]!==void 0||f%i,m=r<4?(u||m)&&(r==0||r==(e.s<0?3:2)):u>5||u==5&&(r==4||m||r==6&&(n>0?a>0?f/io(10,o-a):0:x[h-1])%10&1||r==(e.s<0?8:7))),t<1||!x[0])return m?(i=Xr(e),x.length=1,t=t-i-1,x[0]=io(10,(gr-t%gr)%gr),e.e=ou(-t/gr)||0):(x.length=1,x[0]=e.e=e.s=0),e;if(n==0?(x.length=h,i=1,h--):(x.length=h+1,i=io(10,gr-n),x[h]=a>0?(f/io(10,o-a)%io(10,a)|0)*i:0),m)for(;;)if(h==0){(x[0]+=i)==hn&&(x[0]=1,++e.e);break}else{if(x[h]+=i,x[h]!=hn)break;x[h--]=0,i=1}for(n=x.length;x[--n]===0;)x.pop();if(jr&&(e.e>Am||e.e<-Am))throw Error(pw+Xr(e));return e}function XD(e,t){var r,n,a,i,o,u,m,f,h,x,v=e.constructor,y=v.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new v(e),jr?hr(t,y):t;if(m=e.d,x=t.d,n=t.e,f=e.e,m=m.slice(),o=f-n,o){for(h=o<0,h?(r=m,o=-o,u=x.length):(r=x,n=f,u=m.length),a=Math.max(Math.ceil(y/gr),u)+2,o>a&&(o=a,r.length=1),r.reverse(),a=o;a--;)r.push(0);r.reverse()}else{for(a=m.length,u=x.length,h=a<u,h&&(u=a),a=0;a<u;a++)if(m[a]!=x[a]){h=m[a]<x[a];break}o=0}for(h&&(r=m,m=x,x=r,t.s=-t.s),u=m.length,a=x.length-u;a>0;--a)m[u++]=0;for(a=x.length;a>o;){if(m[--a]<x[a]){for(i=a;i&&m[--i]===0;)m[i]=hn-1;--m[i],m[a]+=hn}m[a]-=x[a]}for(;m[--u]===0;)m.pop();for(;m[0]===0;m.shift())--n;return m[0]?(t.d=m,t.e=n,jr?hr(t,y):t):new v(0)}function ko(e,t,r){var n,a=Xr(e),i=Vi(e.d),o=i.length;return t?(r&&(n=r-o)>0?i=i.charAt(0)+"."+i.slice(1)+yl(n):o>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+yl(-a-1)+i,r&&(n=r-o)>0&&(i+=yl(n))):a>=o?(i+=yl(a+1-o),r&&(n=r-a-1)>0&&(i=i+"."+yl(n))):((n=a+1)<o&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-o)>0&&(a+1===o&&(i+="."),i+=yl(n))),e.s<0?"-"+i:i}function yk(e,t){if(e.length>t)return e.length=t,!0}function YD(e){var t,r,n;function a(i){var o=this;if(!(o instanceof a))return new a(i);if(o.constructor=a,i instanceof a){o.s=i.s,o.e=i.e,o.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(So+i);if(i>0)o.s=1;else if(i<0)i=-i,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(i===~~i&&i<1e7){o.e=0,o.d=[i];return}return gk(o,i.toString())}else if(typeof i!="string")throw Error(So+i);if(i.charCodeAt(0)===45?(i=i.slice(1),o.s=-1):o.s=1,Fte.test(i))gk(o,i);else throw Error(So+i)}if(a.prototype=ct,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=YD,a.config=a.set=Ite,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function Ite(e){if(!e||typeof e!="object")throw Error(ui+"Object expected");var t,r,n,a=["precision",1,lu,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(ou(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(So+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(So+r+": "+n);return this}var xw=YD(Mte);Oa=new xw(1);const ir=xw;var Lte=e=>e,ZD={},QD=e=>e===ZD,bk=e=>function t(){return arguments.length===0||arguments.length===1&&QD(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},JD=(e,t)=>e===1?t:bk(function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var i=n.filter(o=>o!==ZD).length;return i>=e?t(...n):JD(e-i,bk(function(){for(var o=arguments.length,u=new Array(o),m=0;m<o;m++)u[m]=arguments[m];var f=n.map(h=>QD(h)?u.shift():h);return t(...f,...u)}))}),Ap=e=>JD(e.length,e),ub=(e,t)=>{for(var r=[],n=e;n<t;++n)r[n-e]=n;return r},Bte=Ap((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),Ute=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return Lte;var a=r.reverse(),i=a[0],o=a.slice(1);return function(){return o.reduce((u,m)=>m(u),i(...arguments))}},db=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),eP=e=>{var t=null,r=null;return function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return t&&a.every((o,u)=>{var m;return o===((m=t)===null||m===void 0?void 0:m[u])})||(t=a,r=e(...a)),r}};function tP(e){var t;return e===0?t=1:t=Math.floor(new ir(e).abs().log(10).toNumber())+1,t}function rP(e,t,r){for(var n=new ir(e),a=0,i=[];n.lt(t)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}Ap((e,t,r)=>{var n=+e,a=+t;return n+r*(a-n)});Ap((e,t,r)=>{var n=t-+e;return n=n||1/0,(r-e)/n});Ap((e,t,r)=>{var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});var nP=e=>{var[t,r]=e,[n,a]=[t,r];return t>r&&([n,a]=[r,t]),[n,a]},aP=(e,t,r)=>{if(e.lte(0))return new ir(0);var n=tP(e.toNumber()),a=new ir(10).pow(n),i=e.div(a),o=n!==1?.05:.1,u=new ir(Math.ceil(i.div(o).toNumber())).add(r).mul(o),m=u.mul(a);return t?new ir(m.toNumber()):new ir(Math.ceil(m.toNumber()))},$te=(e,t,r)=>{var n=new ir(1),a=new ir(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(n=new ir(10).pow(tP(e)-1),a=new ir(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new ir(Math.floor(e)))}else e===0?a=new ir(Math.floor((t-1)/2)):r||(a=new ir(Math.floor(e)));var o=Math.floor((t-1)/2),u=Ute(Bte(m=>a.add(new ir(m-o).mul(n)).toNumber()),ub);return u(0,t)},iP=function(t,r,n,a){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new ir(0),tickMin:new ir(0),tickMax:new ir(0)};var o=aP(new ir(r).sub(t).div(n-1),a,i),u;t<=0&&r>=0?u=new ir(0):(u=new ir(t).add(r).div(2),u=u.sub(new ir(u).mod(o)));var m=Math.ceil(u.sub(t).div(o).toNumber()),f=Math.ceil(new ir(r).sub(u).div(o).toNumber()),h=m+f+1;return h>n?iP(t,r,n,a,i+1):(h<n&&(f=r>0?f+(n-h):f,m=r>0?m:m+(n-h)),{step:o,tickMin:u.sub(new ir(m).mul(o)),tickMax:u.add(new ir(f).mul(o))})};function zte(e){var[t,r]=e,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(n,2),[o,u]=nP([t,r]);if(o===-1/0||u===1/0){var m=u===1/0?[o,...ub(0,n-1).map(()=>1/0)]:[...ub(0,n-1).map(()=>-1/0),u];return t>r?db(m):m}if(o===u)return $te(o,n,a);var{step:f,tickMin:h,tickMax:x}=iP(o,u,i,a,0),v=rP(h,x.add(new ir(.1).mul(f)),f);return t>r?db(v):v}function Hte(e,t){var[r,n]=e,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[i,o]=nP([r,n]);if(i===-1/0||o===1/0)return[r,n];if(i===o)return[i];var u=Math.max(t,2),m=aP(new ir(o).sub(i).div(u-1),a,0),f=[...rP(new ir(i),new ir(o),m),o];return a===!1&&(f=f.map(h=>Math.round(h))),r>n?db(f):f}var qte=eP(zte),Vte=eP(Hte),_p=e=>e.rootProps.maxBarSize,sP=e=>e.rootProps.barGap,vw=e=>e.rootProps.barCategoryGap,lP=e=>e.rootProps.barSize,cu=e=>e.rootProps.stackOffset,gw=e=>e.options.chartName,yw=e=>e.rootProps.syncId,oP=e=>e.rootProps.syncMethod,bw=e=>e.options.eventEmitter,bs={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},_a={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},Tp=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},Kte={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:bs.angleAxisId,includeHidden:!1,name:void 0,reversed:bs.reversed,scale:bs.scale,tick:bs.tick,tickCount:void 0,ticks:void 0,type:bs.type,unit:void 0},Gte={allowDataOverflow:_a.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:_a.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:_a.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:_a.scale,tick:_a.tick,tickCount:_a.tickCount,ticks:void 0,type:_a.type,unit:void 0},Wte={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:bs.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:bs.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:bs.scale,tick:bs.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},Xte={allowDataOverflow:_a.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:_a.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:_a.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:_a.scale,tick:_a.tick,tickCount:_a.tickCount,ticks:void 0,type:"category",unit:void 0},Df=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?Wte:Kte,Pf=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?Xte:Gte,kp=e=>e.polarOptions,ww=_e([Us,$s,nn],K6),cP=_e([kp,ww],(e,t)=>{if(e!=null)return Zn(e.innerRadius,t,0)}),uP=_e([kp,ww],(e,t)=>{if(e!=null)return Zn(e.outerRadius,t,t*.8)}),Yte=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},dP=_e([kp],Yte),Zte=_e([Df,dP],Tp),fP=_e([ww,cP,uP],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]}),Qte=_e([Pf,fP],Tp),hP=_e([Ct,kp,cP,uP,Us,$s],(e,t,r,n,a,i)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:o,cy:u,startAngle:m,endAngle:f}=t;return{cx:Zn(o,a,a/2),cy:Zn(u,i,i/2),innerRadius:r,outerRadius:n,startAngle:m,endAngle:f,clockWise:!1}}}),Er=(e,t)=>t,Rf=(e,t,r)=>r;function wk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function _m(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wk(Object(r),!0).forEach(function(n){Jte(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Jte(e,t,r){return(t=ere(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ere(e){var t=tre(e,"string");return typeof t=="symbol"?t:t+""}function tre(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fb=[0,"auto"],Na={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},qs=(e,t)=>{var r=e.cartesianAxis.xAxis[t];return r??Na},Ea={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:fb,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:hp},Il=(e,t)=>{var r=e.cartesianAxis.yAxis[t];return r??Ea},Nl={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},Sw=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??Nl},Br=(e,t,r)=>{switch(t){case"xAxis":return qs(e,r);case"yAxis":return Il(e,r);case"zAxis":return Sw(e,r);case"angleAxis":return Df(e,r);case"radiusAxis":return Pf(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},rre=(e,t,r)=>{switch(t){case"xAxis":return qs(e,r);case"yAxis":return Il(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},uu=(e,t,r)=>{switch(t){case"xAxis":return qs(e,r);case"yAxis":return Il(e,r);case"angleAxis":return Df(e,r);case"radiusAxis":return Pf(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},mP=e=>e.graphicalItems.countOfBars>0;function jw(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var Mf=e=>e.graphicalItems.cartesianItems,nre=_e([Er,Rf],jw),Nw=(e,t,r)=>e.filter(r).filter(n=>t?.includeHidden===!0?!0:!n.hide),Ff=_e([Mf,Br,nre],Nw),pP=e=>e.filter(t=>t.stackId===void 0),are=_e([Ff],pP),Ew=e=>e.map(t=>t.data).filter(Boolean).flat(1),ire=_e([Ff],Ew),Aw=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:a}=t;return e.length>0?e:r.slice(n,a+1)},Cp=_e([ire,Ep],Aw),_w=(e,t,r)=>t?.dataKey!=null?e.map(n=>({value:Jt(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(a=>({value:Jt(a,n)}))):e.map(n=>({value:n})),Op=_e([Cp,Br,Ff],_w);function xP(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function $o(e){return e.filter(t=>Wi(t)||t instanceof Date).map(Number).filter(t=>Fa(t)===!1)}function sre(e,t,r){return!r||typeof t!="number"||Fa(t)?[]:r.length?$o(r.flatMap(n=>{var a=Jt(e,n.dataKey),i,o;if(Array.isArray(a)?[i,o]=a:i=o=a,!(!Ba(i)||!Ba(o)))return[t-i,t+o]})):[]}var Tw=(e,t,r)=>{var n={},a=t.reduce((i,o)=>(o.stackId==null||(i[o.stackId]==null&&(i[o.stackId]=[]),i[o.stackId].push(o)),i),n);return Object.fromEntries(Object.entries(a).map(i=>{var[o,u]=i,m=u.map(f=>f.dataKey);return[o,{stackedData:cZ(e,m,r),graphicalItems:u}]}))},hb=_e([Cp,Ff,cu],Tw),vP=(e,t,r)=>{var{dataStartIndex:n,dataEndIndex:a}=t;if(r!=="zAxis"){var i=fZ(e,n,a);if(!(i!=null&&i[0]===0&&i[1]===0))return i}},lre=_e([hb,Fl,Er],vP),gP=(e,t,r,n)=>r.length>0?e.flatMap(a=>r.flatMap(i=>{var o,u,m=(o=i.errorBars)===null||o===void 0?void 0:o.filter(h=>xP(n,h)),f=Jt(a,(u=t.dataKey)!==null&&u!==void 0?u:i.dataKey);return{value:f,errorDomain:sre(a,f,m)}})).filter(Boolean):t?.dataKey!=null?e.map(a=>({value:Jt(a,t.dataKey),errorDomain:[]})):e.map(a=>({value:a,errorDomain:[]})),ore=_e(Cp,Br,are,Er,gP);function cre(e){var{value:t}=e;if(Wi(t)||t instanceof Date)return t}var ure=e=>{var t=e.flatMap(n=>[n.value,n.errorDomain]).flat(1),r=$o(t);if(r.length!==0)return[Math.min(...r),Math.max(...r)]},dre=(e,t,r)=>{var n=e.map(cre).filter(a=>a!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&z5(n))?dD(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},kw=e=>{var t;if(e==null||!("domain"in e))return fb;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var r=$o(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e?.domain)!==null&&t!==void 0?t:fb},Cw=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r.filter(Boolean);if(a.length!==0){var i=a.flat(),o=Math.min(...i),u=Math.max(...i);return[o,u]}},yP=e=>e.referenceElements.dots,du=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),fre=_e([yP,Er,Rf],du),bP=e=>e.referenceElements.areas,hre=_e([bP,Er,Rf],du),wP=e=>e.referenceElements.lines,mre=_e([wP,Er,Rf],du),SP=(e,t)=>{var r=$o(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},pre=_e(fre,Er,SP),jP=(e,t)=>{var r=$o(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},xre=_e([hre,Er],jP),NP=(e,t)=>{var r=$o(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},vre=_e(mre,Er,NP),gre=_e(pre,vre,xre,(e,t,r)=>Cw(e,r,t)),EP=_e([Br],kw),Ow=(e,t,r,n,a)=>{var i=Pte(t,e.allowDataOverflow);return i??Rte(t,Cw(r,a,ure(n)),e.allowDataOverflow)},yre=_e([Br,EP,lre,ore,gre],Ow),bre=[0,1],Dw=(e,t,r,n,a,i,o)=>{if(!(e==null||r==null||r.length===0)){var{dataKey:u,type:m}=e,f=Ls(t,i);return f&&u==null?dD(0,r.length):m==="category"?dre(n,e,f):a==="expand"?bre:o}},Pw=_e([Br,Ct,Cp,Op,cu,Er,yre],Dw),AP=(e,t,r,n,a)=>{if(e!=null){var{scale:i,type:o}=e;if(i==="auto")return t==="radial"&&a==="radiusAxis"?"band":t==="radial"&&a==="angleAxis"?"linear":o==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":o==="category"?"band":"linear";if(typeof i=="string"){var u="scale".concat(Ef(i));return u in _d?u:"point"}}},Ll=_e([Br,Ct,mP,gw,Er],AP);function wre(e){if(e!=null){if(e in _d)return _d[e]();var t="scale".concat(Ef(e));if(t in _d)return _d[t]()}}function Dp(e,t,r,n){if(!(r==null||n==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(n);var a=wre(t);if(a!=null){var i=a.domain(r).range(n);return iZ(i),i}}}var Rw=(e,t,r)=>{var n=kw(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&Gc(e))return qte(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&Gc(e))return Vte(e,t.tickCount,t.allowDecimals)}},Mw=_e([Pw,uu,Ll],Rw),Fw=(e,t,r,n)=>{if(n!=="angleAxis"&&e?.type==="number"&&Gc(t)&&Array.isArray(r)&&r.length>0){var a=t[0],i=r[0],o=t[1],u=r[r.length-1];return[Math.min(a,i),Math.max(o,u)]}return t},Sre=_e([Br,Pw,Mw,Er],Fw),jre=_e(Op,Br,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from($o(e.map(u=>u.value))).sort((u,m)=>u-m);if(n.length<2)return 1/0;var a=n[n.length-1]-n[0];if(a===0)return 1/0;for(var i=0;i<n.length-1;i++){var o=n[i+1]-n[i];r=Math.min(r,o)}return r/a}}),_P=_e(jre,Ct,vw,nn,(e,t,r,n)=>n,(e,t,r,n,a)=>{if(!Ba(e))return 0;var i=t==="vertical"?n.height:n.width;if(a==="gap")return e*i/2;if(a==="no-gap"){var o=Zn(r,e*i),u=e*i/2;return u-o-(u-o)/i*o}return 0}),Nre=(e,t)=>{var r=qs(e,t);return r==null||typeof r.padding!="string"?0:_P(e,"xAxis",t,r.padding)},Ere=(e,t)=>{var r=Il(e,t);return r==null||typeof r.padding!="string"?0:_P(e,"yAxis",t,r.padding)},Are=_e(qs,Nre,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:a}=e;return typeof a=="string"?{left:t,right:t}:{left:((r=a.left)!==null&&r!==void 0?r:0)+t,right:((n=a.right)!==null&&n!==void 0?n:0)+t}}),_re=_e(Il,Ere,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:a}=e;return typeof a=="string"?{top:t,bottom:t}:{top:((r=a.top)!==null&&r!==void 0?r:0)+t,bottom:((n=a.bottom)!==null&&n!==void 0?n:0)+t}}),Tre=_e([nn,Are,pp,mp,(e,t,r)=>r],(e,t,r,n,a)=>{var{padding:i}=n;return a?[i.left,r.width-i.right]:[e.left+t.left,e.left+e.width-t.right]}),kre=_e([nn,Ct,_re,pp,mp,(e,t,r)=>r],(e,t,r,n,a,i)=>{var{padding:o}=a;return i?[n.height-o.bottom,o.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),If=(e,t,r,n)=>{var a;switch(t){case"xAxis":return Tre(e,r,n);case"yAxis":return kre(e,r,n);case"zAxis":return(a=Sw(e,r))===null||a===void 0?void 0:a.range;case"angleAxis":return dP(e);case"radiusAxis":return fP(e,r);default:return}},TP=_e([Br,If],Tp),fu=_e([Br,Ll,Sre,TP],Dp);_e(Ff,Er,(e,t)=>e.flatMap(r=>{var n;return(n=r.errorBars)!==null&&n!==void 0?n:[]}).filter(r=>xP(t,r)));function kP(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var Pp=(e,t)=>t,Rp=(e,t,r)=>r,Cre=_e(I2,Pp,Rp,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(kP)),Ore=_e(L2,Pp,Rp,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(kP)),CP=(e,t)=>({width:e.width,height:t.height}),Dre=(e,t)=>{var r=typeof t.width=="number"?t.width:hp;return{width:r,height:e.height}},OP=_e(nn,qs,CP),Pre=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},Rre=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},Mre=_e($s,nn,Cre,Pp,Rp,(e,t,r,n,a)=>{var i={},o;return r.forEach(u=>{var m=CP(t,u);o==null&&(o=Pre(t,n,e));var f=n==="top"&&!a||n==="bottom"&&a;i[u.id]=o-Number(f)*m.height,o+=(f?-1:1)*m.height}),i}),Fre=_e(Us,nn,Ore,Pp,Rp,(e,t,r,n,a)=>{var i={},o;return r.forEach(u=>{var m=Dre(t,u);o==null&&(o=Rre(t,n,e));var f=n==="left"&&!a||n==="right"&&a;i[u.id]=o-Number(f)*m.width,o+=(f?-1:1)*m.width}),i}),Ire=(e,t)=>{var r=nn(e),n=qs(e,t);if(n!=null){var a=Mre(e,n.orientation,n.mirror),i=a[t];return i==null?{x:r.left,y:0}:{x:r.left,y:i}}},Lre=(e,t)=>{var r=nn(e),n=Il(e,t);if(n!=null){var a=Fre(e,n.orientation,n.mirror),i=a[t];return i==null?{x:0,y:r.top}:{x:i,y:r.top}}},DP=_e(nn,Il,(e,t)=>{var r=typeof t.width=="number"?t.width:hp;return{width:r,height:e.height}}),Sk=(e,t,r)=>{switch(t){case"xAxis":return OP(e,r).width;case"yAxis":return DP(e,r).height;default:return}},PP=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:a,type:i,dataKey:o}=r,u=Ls(e,n),m=t.map(f=>f.value);if(o&&u&&i==="category"&&a&&z5(m))return m}},Lf=_e([Ct,Op,Br,Er],PP),Iw=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:a,scale:i}=r,o=Ls(e,n);if(o&&(a==="number"||i!=="auto"))return t.map(u=>u.value)}},Lw=_e([Ct,Op,uu,Er],Iw),jk=_e([Ct,rre,Ll,fu,Lf,Lw,If,Mw,Er],(e,t,r,n,a,i,o,u,m)=>{if(t==null)return null;var f=Ls(e,m);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:m,categoricalDomain:i,duplicateDomain:a,isCategorical:f,niceTicks:u,range:o,realScaleType:r,scale:n}}),RP=(e,t,r,n,a,i,o,u,m)=>{if(!(t==null||n==null)){var f=Ls(e,m),{type:h,ticks:x,tickCount:v}=t,y=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,w=h==="category"&&n.bandwidth?n.bandwidth()/y:0;w=m==="angleAxis"&&i!=null&&i.length>=2?Gr(i[0]-i[1])*2*w:w;var b=x||a;if(b){var S=b.map((N,_)=>{var A=o?o.indexOf(N):N;return{index:_,coordinate:n(A)+w,value:N,offset:w}});return S.filter(N=>!Fa(N.coordinate))}return f&&u?u.map((N,_)=>({coordinate:n(N)+w,value:N,index:_,offset:w})):n.ticks?n.ticks(v).map(N=>({coordinate:n(N)+w,value:N,offset:w})):n.domain().map((N,_)=>({coordinate:n(N)+w,value:o?o[N]:N,index:_,offset:w}))}},MP=_e([Ct,uu,Ll,fu,Mw,If,Lf,Lw,Er],RP),FP=(e,t,r,n,a,i,o)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var u=Ls(e,o),{tickCount:m}=t,f=0;return f=o==="angleAxis"&&n?.length>=2?Gr(n[0]-n[1])*2*f:f,u&&i?i.map((h,x)=>({coordinate:r(h)+f,value:h,index:x,offset:f})):r.ticks?r.ticks(m).map(h=>({coordinate:r(h)+f,value:h,offset:f})):r.domain().map((h,x)=>({coordinate:r(h)+f,value:a?a[h]:h,index:x,offset:f}))}},Zi=_e([Ct,uu,fu,If,Lf,Lw,Er],FP),di=_e(Br,fu,(e,t)=>{if(!(e==null||t==null))return _m(_m({},e),{},{scale:t})}),Bre=_e([Br,Ll,Pw,TP],Dp),Ure=_e((e,t,r)=>Sw(e,r),Bre,(e,t)=>{if(!(e==null||t==null))return _m(_m({},e),{},{scale:t})}),$re=_e([Ct,I2,L2],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),IP=e=>e.options.defaultTooltipEventType,LP=e=>e.options.validateTooltipEventTypes;function BP(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function Bw(e,t){var r=IP(e),n=LP(e);return BP(t,r,n)}function zre(e){return lt(t=>Bw(t,e))}var UP=(e,t)=>{var r,n=Number(t);if(!(Fa(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},Hre=e=>e.tooltip.settings,wl={active:!1,index:null,dataKey:void 0,coordinate:void 0},qre={itemInteraction:{click:wl,hover:wl},axisInteraction:{click:wl,hover:wl},keyboardInteraction:wl,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},$P=pi({name:"tooltip",initialState:qre,reducers:{addTooltipEntrySettings(e,t){e.tooltipItemPayloads.push(t.payload)},removeTooltipEntrySettings(e,t){var r=ks(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:Vre,removeTooltipEntrySettings:Kre,setTooltipSettingsState:Gre,setActiveMouseOverItemIndex:zP,mouseLeaveItem:Wre,mouseLeaveChart:HP,setActiveClickItemIndex:Xre,setMouseOverAxisIndex:qP,setMouseClickAxisIndex:Yre,setSyncInteraction:mb,setKeyboardInteraction:pb}=$P.actions,Zre=$P.reducer;function Nk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function jh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Nk(Object(r),!0).forEach(function(n){Qre(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Nk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Qre(e,t,r){return(t=Jre(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Jre(e){var t=ene(e,"string");return typeof t=="symbol"?t:t+""}function ene(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tne(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function rne(e){return e.index!=null}var VP=(e,t,r,n)=>{if(t==null)return wl;var a=tne(e,t,r);if(a==null)return wl;if(a.active)return a;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var i=e.settings.active===!0;if(rne(a)){if(i)return jh(jh({},a),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n};return jh(jh({},wl),{},{coordinate:a.coordinate})},Uw=(e,t)=>{var r=e?.index;if(r==null)return null;var n=Number(r);if(!Ba(n))return r;var a=0,i=1/0;return t.length>0&&(i=t.length-1),String(Math.max(a,Math.min(n,i)))},KP=(e,t,r,n,a,i,o,u)=>{if(!(i==null||u==null)){var m=o[0],f=m==null?void 0:u(m.positions,i);if(f!=null)return f;var h=a?.[Number(i)];if(h)switch(r){case"horizontal":return{x:h.coordinate,y:(n.top+t)/2};default:return{x:(n.left+e)/2,y:h.coordinate}}}},GP=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var a;return r==="hover"?a=e.itemInteraction.hover.dataKey:a=e.itemInteraction.click.dataKey,a==null&&n!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(i=>{var o;return((o=i.settings)===null||o===void 0?void 0:o.dataKey)===a})},Bf=e=>e.options.tooltipPayloadSearcher,hu=e=>e.tooltip;function Ek(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ak(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ek(Object(r),!0).forEach(function(n){nne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ek(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nne(e,t,r){return(t=ane(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ane(e){var t=ine(e,"string");return typeof t=="symbol"?t:t+""}function ine(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sne(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function lne(e,t){return e??t}var WP=(e,t,r,n,a,i,o)=>{if(!(t==null||i==null)){var{chartData:u,computedData:m,dataStartIndex:f,dataEndIndex:h}=r,x=[];return e.reduce((v,y)=>{var w,{dataDefinedOnItem:b,settings:S}=y,N=lne(b,u),_=sne(N,f,h),A=(w=S?.dataKey)!==null&&w!==void 0?w:n?.dataKey,k=S?.nameKey,C;if(n!=null&&n.dataKey&&Array.isArray(_)&&!Array.isArray(_[0])&&o==="axis"?C=H5(_,n.dataKey,a):C=i(_,t,m,k),Array.isArray(C))C.forEach(T=>{var z=Ak(Ak({},S),{},{name:T.name,unit:T.unit,color:void 0,fill:void 0});v.push(sT({tooltipEntrySettings:z,dataKey:T.dataKey,payload:T.payload,value:Jt(T.payload,T.dataKey),name:T.name}))});else{var O;v.push(sT({tooltipEntrySettings:S,dataKey:A,payload:C,value:Jt(C,A),name:(O=Jt(C,k))!==null&&O!==void 0?O:S?.name}))}return v},x)}},vn=e=>{var t=Ct(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},mu=e=>e.tooltip.settings.axisId,An=e=>{var t=vn(e),r=mu(e);return uu(e,t,r)},$w=_e([An,Ct,mP,gw,vn],AP),one=_e([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),cne=_e([vn,mu],jw),Mp=_e([one,An,cne],Nw),une=_e([Mp],Ew),zo=_e([une,Fl],Aw),zw=_e([zo,An,Mp],_w),dne=_e([An],kw),fne=_e([zo,Mp,cu],Tw),hne=_e([fne,Fl,vn],vP),mne=_e([Mp],pP),pne=_e([zo,An,mne,vn],gP),xne=_e([yP,vn,mu],du),vne=_e([xne,vn],SP),gne=_e([bP,vn,mu],du),yne=_e([gne,vn],jP),bne=_e([wP,vn,mu],du),wne=_e([bne,vn],NP),Sne=_e([vne,wne,yne],Cw),jne=_e([An,dne,hne,pne,Sne],Ow),XP=_e([An,Ct,zo,zw,cu,vn,jne],Dw),Nne=_e([XP,An,$w],Rw),Ene=_e([An,XP,Nne,vn],Fw),YP=e=>{var t=vn(e),r=mu(e),n=!1;return If(e,t,r,n)},ZP=_e([An,YP],Tp),QP=_e([An,$w,Ene,ZP],Dp),Ane=_e([Ct,zw,An,vn],PP),_ne=_e([Ct,zw,An,vn],Iw),Tne=(e,t,r,n,a,i,o,u)=>{if(t){var{type:m}=t,f=Ls(e,u);if(n){var h=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,x=m==="category"&&n.bandwidth?n.bandwidth()/h:0;return x=u==="angleAxis"&&a!=null&&a?.length>=2?Gr(a[0]-a[1])*2*x:x,f&&o?o.map((v,y)=>({coordinate:n(v)+x,value:v,index:y,offset:x})):n.domain().map((v,y)=>({coordinate:n(v)+x,value:i?i[v]:v,index:y,offset:x}))}}},Vs=_e([Ct,An,$w,QP,YP,Ane,_ne,vn],Tne),Hw=_e([IP,LP,Hre],(e,t,r)=>BP(r.shared,e,t)),JP=e=>e.tooltip.settings.trigger,qw=e=>e.tooltip.settings.defaultIndex,Fp=_e([hu,Hw,JP,qw],VP),Qi=_e([Fp,zo],Uw),eR=_e([Vs,Qi],UP),tR=_e([Fp],e=>{if(e)return e.dataKey}),rR=_e([hu,Hw,JP,qw],GP),kne=_e([Us,$s,Ct,nn,Vs,qw,rR,Bf],KP),Cne=_e([Fp,kne],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),One=_e([Fp],e=>e.active),Dne=_e([rR,Qi,Fl,An,eR,Bf,Hw],WP),Pne=_e([Dne],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function _k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Tk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_k(Object(r),!0).forEach(function(n){Rne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_k(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Rne(e,t,r){return(t=Mne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Mne(e){var t=Fne(e,"string");return typeof t=="symbol"?t:t+""}function Fne(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ine=()=>lt(An),Lne=()=>{var e=Ine(),t=lt(Vs),r=lt(QP);return Ps(Tk(Tk({},e),{},{scale:r}),t)},Bne=()=>lt(gw),Vw=(e,t)=>t,nR=(e,t,r)=>r,Kw=(e,t,r,n)=>n,Une=_e(Vs,e=>sp(e,t=>t.coordinate)),Gw=_e([hu,Vw,nR,Kw],VP),aR=_e([Gw,zo],Uw),$ne=(e,t,r)=>{if(t!=null){var n=hu(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},iR=_e([hu,Vw,nR,Kw],GP),Tm=_e([Us,$s,Ct,nn,Vs,Kw,iR,Bf],KP),zne=_e([Gw,Tm],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),sR=_e(Vs,aR,UP),Hne=_e([iR,aR,Fl,An,sR,Bf,Vw],WP),qne=_e([Gw],e=>({isActive:e.active,activeIndex:e.index})),Vne=(e,t,r,n,a,i,o,u)=>{if(!(!e||!t||!n||!a||!i)){var m=hZ(e.chartX,e.chartY,t,r,u);if(m){var f=pZ(m,t),h=nZ(f,o,i,n,a),x=mZ(t,i,h,m);return{activeIndex:String(h),activeCoordinate:x}}}};function xb(){return xb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xb.apply(null,arguments)}function kk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Nh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kk(Object(r),!0).forEach(function(n){Kne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Kne(e,t,r){return(t=Gne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gne(e){var t=Wne(e,"string");return typeof t=="symbol"?t:t+""}function Wne(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xne(e){var{coordinate:t,payload:r,index:n,offset:a,tooltipAxisBandSize:i,layout:o,cursor:u,tooltipEventType:m,chartName:f}=e,h=t,x=r,v=n;if(!u||!h||f!=="ScatterChart"&&m!=="axis")return null;var y,w;if(f==="ScatterChart")y=h,w=fQ;else if(f==="BarChart")y=hQ(o,h,a,i),w=oD;else if(o==="radial"){var{cx:b,cy:S,radius:N,startAngle:_,endAngle:A}=cD(h);y={cx:b,cy:S,startAngle:_,endAngle:A,innerRadius:N,outerRadius:N},w=_f}else y={points:JQ(o,h,a)},w=vp;var k=typeof u=="object"&&"className"in u?u.className:void 0,C=Nh(Nh(Nh(Nh({stroke:"#ccc",pointerEvents:"none"},a),y),kt(u,!1)),{},{payload:x,payloadIndex:v,className:$t("recharts-tooltip-cursor",k)});return g.isValidElement(u)?g.cloneElement(u,C):g.createElement(w,C)}function Yne(e){var t=Lne(),r=eD(),n=xp(),a=Bne();return g.createElement(Xne,xb({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:r,layout:n,tooltipAxisBandSize:t,chartName:a}))}var lR=g.createContext(null),Zne=()=>g.useContext(lR),H1={exports:{}},Ck;function Qne(){return Ck||(Ck=1,function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(m,f,h){this.fn=m,this.context=f,this.once=h||!1}function i(m,f,h,x,v){if(typeof h!="function")throw new TypeError("The listener must be a function");var y=new a(h,x||m,v),w=r?r+f:f;return m._events[w]?m._events[w].fn?m._events[w]=[m._events[w],y]:m._events[w].push(y):(m._events[w]=y,m._eventsCount++),m}function o(m,f){--m._eventsCount===0?m._events=new n:delete m._events[f]}function u(){this._events=new n,this._eventsCount=0}u.prototype.eventNames=function(){var f=[],h,x;if(this._eventsCount===0)return f;for(x in h=this._events)t.call(h,x)&&f.push(r?x.slice(1):x);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(h)):f},u.prototype.listeners=function(f){var h=r?r+f:f,x=this._events[h];if(!x)return[];if(x.fn)return[x.fn];for(var v=0,y=x.length,w=new Array(y);v<y;v++)w[v]=x[v].fn;return w},u.prototype.listenerCount=function(f){var h=r?r+f:f,x=this._events[h];return x?x.fn?1:x.length:0},u.prototype.emit=function(f,h,x,v,y,w){var b=r?r+f:f;if(!this._events[b])return!1;var S=this._events[b],N=arguments.length,_,A;if(S.fn){switch(S.once&&this.removeListener(f,S.fn,void 0,!0),N){case 1:return S.fn.call(S.context),!0;case 2:return S.fn.call(S.context,h),!0;case 3:return S.fn.call(S.context,h,x),!0;case 4:return S.fn.call(S.context,h,x,v),!0;case 5:return S.fn.call(S.context,h,x,v,y),!0;case 6:return S.fn.call(S.context,h,x,v,y,w),!0}for(A=1,_=new Array(N-1);A<N;A++)_[A-1]=arguments[A];S.fn.apply(S.context,_)}else{var k=S.length,C;for(A=0;A<k;A++)switch(S[A].once&&this.removeListener(f,S[A].fn,void 0,!0),N){case 1:S[A].fn.call(S[A].context);break;case 2:S[A].fn.call(S[A].context,h);break;case 3:S[A].fn.call(S[A].context,h,x);break;case 4:S[A].fn.call(S[A].context,h,x,v);break;default:if(!_)for(C=1,_=new Array(N-1);C<N;C++)_[C-1]=arguments[C];S[A].fn.apply(S[A].context,_)}}return!0},u.prototype.on=function(f,h,x){return i(this,f,h,x,!1)},u.prototype.once=function(f,h,x){return i(this,f,h,x,!0)},u.prototype.removeListener=function(f,h,x,v){var y=r?r+f:f;if(!this._events[y])return this;if(!h)return o(this,y),this;var w=this._events[y];if(w.fn)w.fn===h&&(!v||w.once)&&(!x||w.context===x)&&o(this,y);else{for(var b=0,S=[],N=w.length;b<N;b++)(w[b].fn!==h||v&&!w[b].once||x&&w[b].context!==x)&&S.push(w[b]);S.length?this._events[y]=S.length===1?S[0]:S:o(this,y)}return this},u.prototype.removeAllListeners=function(f){var h;return f?(h=r?r+f:f,this._events[h]&&o(this,h)):(this._events=new n,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=r,u.EventEmitter=u,e.exports=u}(H1)),H1.exports}var Jne=Qne();const eae=fi(Jne);var uf=new eae,vb="recharts.syncEvent.tooltip",Ok="recharts.syncEvent.brush";function Uf(e,t){if(t){var r=Number.parseInt(t,10);if(!Fa(r))return e?.[r]}}var tae={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},oR=pi({name:"options",initialState:tae,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),rae=oR.reducer,{createEventEmitter:nae}=oR.actions;function aae(e){return e.tooltip.syncInteraction}var iae={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},cR=pi({name:"chartData",initialState:iae,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:Dk,setDataStartEndIndexes:sae,setComputedData:bhe}=cR.actions,lae=cR.reducer,uR=()=>{};function oae(){var e=lt(yw),t=lt(bw),r=br(),n=lt(oP),a=lt(Vs),i=xp(),o=$2(),u=lt(m=>m.rootProps.className);g.useEffect(()=>{if(e==null)return uR;var m=(f,h,x)=>{if(t!==x&&e===f){if(n==="index"){r(h);return}if(a!=null){var v;if(typeof n=="function"){var y={activeTooltipIndex:h.payload.index==null?void 0:Number(h.payload.index),isTooltipActive:h.payload.active,activeIndex:h.payload.index==null?void 0:Number(h.payload.index),activeLabel:h.payload.label,activeDataKey:h.payload.dataKey,activeCoordinate:h.payload.coordinate},w=n(a,y);v=a[w]}else n==="value"&&(v=a.find(O=>String(O.value)===h.payload.label));var{coordinate:b}=h.payload;if(v==null||h.payload.active===!1||b==null||o==null){r(mb({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:S,y:N}=b,_=Math.min(S,o.x+o.width),A=Math.min(N,o.y+o.height),k={x:i==="horizontal"?v.coordinate:_,y:i==="horizontal"?A:v.coordinate},C=mb({active:h.payload.active,coordinate:k,dataKey:h.payload.dataKey,index:String(v.index),label:h.payload.label});r(C)}}};return uf.on(vb,m),()=>{uf.off(vb,m)}},[u,r,t,e,n,a,i,o])}function cae(){var e=lt(yw),t=lt(bw),r=br();g.useEffect(()=>{if(e==null)return uR;var n=(a,i,o)=>{t!==o&&e===a&&r(sae(i))};return uf.on(Ok,n),()=>{uf.off(Ok,n)}},[r,t,e])}function uae(){var e=br();g.useEffect(()=>{e(nae())},[e]),oae(),cae()}function dae(e,t,r,n,a,i){var o=lt(v=>$ne(v,e,t)),u=lt(bw),m=lt(yw),f=lt(oP),h=lt(aae),x=h?.active;g.useEffect(()=>{if(!x&&m!=null&&u!=null){var v=mb({active:i,coordinate:r,dataKey:o,index:a,label:typeof n=="number"?String(n):n});uf.emit(vb,m,v,u)}},[x,r,o,a,n,u,m,f,i])}function Pk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Rk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Pk(Object(r),!0).forEach(function(n){fae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fae(e,t,r){return(t=hae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hae(e){var t=mae(e,"string");return typeof t=="symbol"?t:t+""}function mae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pae(e){return e.dataKey}function xae(e,t){return g.isValidElement(e)?g.cloneElement(e,t):typeof e=="function"?g.createElement(e,t):g.createElement(qZ,t)}var Mk=[],vae={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!zs.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function sa(e){var t=da(e,vae),{active:r,allowEscapeViewBox:n,animationDuration:a,animationEasing:i,content:o,filterNull:u,isAnimationActive:m,offset:f,payloadUniqBy:h,position:x,reverseDirection:v,useTranslate3d:y,wrapperStyle:w,cursor:b,shared:S,trigger:N,defaultIndex:_,portal:A,axisId:k}=t,C=br(),O=typeof _=="number"?String(_):_;g.useEffect(()=>{C(Gre({shared:S,trigger:N,axisId:k,active:r,defaultIndex:O}))},[C,S,N,k,r,O]);var T=$2(),z=aD(),P=zre(S),{activeIndex:Z,isActive:q}=lt(Q=>qne(Q,P,N,O)),B=lt(Q=>Hne(Q,P,N,O)),fe=lt(Q=>sR(Q,P,N,O)),Ne=lt(Q=>zne(Q,P,N,O)),he=B,K=Zne(),H=r??q,[be,te]=w6([he,H]),I=P==="axis"?fe:void 0;dae(P,N,Ne,I,Z,H);var se=A??K;if(se==null)return null;var R=he??Mk;H||(R=Mk),u&&R.length&&(R=x6(he.filter(Q=>Q.value!=null&&(Q.hide!==!0||t.includeHidden)),h,pae));var W=R.length>0,Y=g.createElement(ZZ,{allowEscapeViewBox:n,animationDuration:a,animationEasing:i,isAnimationActive:m,active:H,coordinate:Ne,hasPayload:W,offset:f,position:x,reverseDirection:v,useTranslate3d:y,viewBox:T,wrapperStyle:w,lastBoundingBox:be,innerRef:te,hasPortalFromProps:!!A},xae(o,Rk(Rk({},t),{},{payload:R,label:I,active:H,coordinate:Ne,accessibilityLayer:z})));return g.createElement(g.Fragment,null,qd.createPortal(Y,se),H&&g.createElement(Yne,{cursor:b,tooltipEventType:P,coordinate:Ne,payload:he,index:Z}))}var q1={},V1={},Fk;function gae(){return Fk||(Fk=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=0,a={}){typeof a!="object"&&(a={});let i=null,o=null,u=null,m=0,f=null,h;const{leading:x=!1,trailing:v=!0,maxWait:y}=a,w="maxWait"in a,b=w?Math.max(Number(y)||0,n):0,S=T=>(i!==null&&(h=r.apply(o,i)),i=o=null,m=T,h),N=T=>(m=T,f=setTimeout(C,n),x&&i!==null?S(T):h),_=T=>(f=null,v&&i!==null?S(T):h),A=T=>{if(u===null)return!0;const z=T-u,P=z>=n||z<0,Z=w&&T-m>=b;return P||Z},k=T=>{const z=u===null?0:T-u,P=n-z,Z=b-(T-m);return w?Math.min(P,Z):P},C=()=>{const T=Date.now();if(A(T))return _(T);f=setTimeout(C,k(T))},O=function(...T){const z=Date.now(),P=A(z);if(i=T,o=this,u=z,P){if(f===null)return N(z);if(w)return clearTimeout(f),f=setTimeout(C,n),S(z)}return f===null&&(f=setTimeout(C,n)),h};return O.cancel=()=>{f!==null&&clearTimeout(f),m=0,u=i=o=f=null},O.flush=()=>f===null?h:_(Date.now()),O}e.debounce=t}(V1)),V1}var Ik;function yae(){return Ik||(Ik=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=gae();function r(n,a=0,i={}){const{leading:o=!0,trailing:u=!0}=i;return t.debounce(n,a,{leading:o,maxWait:a,trailing:u})}e.throttle=r}(q1)),q1}var K1,Lk;function bae(){return Lk||(Lk=1,K1=yae().throttle),K1}var wae=bae();const Sae=fi(wae);var Bd=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i]};function Bk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function G1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Bk(Object(r),!0).forEach(function(n){jae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Bk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jae(e,t,r){return(t=Nae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Nae(e){var t=Eae(e,"string");return typeof t=="symbol"?t:t+""}function Eae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var la=g.forwardRef((e,t)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:a="100%",height:i="100%",minWidth:o=0,minHeight:u,maxHeight:m,children:f,debounce:h=0,id:x,className:v,onResize:y,style:w={}}=e,b=g.useRef(null),S=g.useRef();S.current=y,g.useImperativeHandle(t,()=>b.current);var[N,_]=g.useState({containerWidth:n.width,containerHeight:n.height}),A=g.useCallback((C,O)=>{_(T=>{var z=Math.round(C),P=Math.round(O);return T.containerWidth===z&&T.containerHeight===P?T:{containerWidth:z,containerHeight:P}})},[]);g.useEffect(()=>{var C=P=>{var Z,{width:q,height:B}=P[0].contentRect;A(q,B),(Z=S.current)===null||Z===void 0||Z.call(S,q,B)};h>0&&(C=Sae(C,h,{trailing:!0,leading:!1}));var O=new ResizeObserver(C),{width:T,height:z}=b.current.getBoundingClientRect();return A(T,z),O.observe(b.current),()=>{O.disconnect()}},[A,h]);var k=g.useMemo(()=>{var{containerWidth:C,containerHeight:O}=N;if(C<0||O<0)return null;Bd(uo(a)||uo(i),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,a,i),Bd(!r||r>0,"The aspect(%s) must be greater than zero.",r);var T=uo(a)?C:a,z=uo(i)?O:i;return r&&r>0&&(T?z=T/r:z&&(T=z*r),m&&z>m&&(z=m)),Bd(T>0||z>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,T,z,a,i,o,u,r),g.Children.map(f,P=>g.cloneElement(P,{width:T,height:z,style:G1({width:T,height:z},P.props.style)}))},[r,f,i,m,u,o,N,a]);return g.createElement("div",{id:x?"".concat(x):void 0,className:$t("recharts-responsive-container",v),style:G1(G1({},w),{},{width:a,height:i,minWidth:o,minHeight:u,maxHeight:m}),ref:b},g.createElement("div",{style:{width:0,height:0,overflow:"visible"}},k))}),ns=e=>null;ns.displayName="Cell";function Uk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function gb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Uk(Object(r),!0).forEach(function(n){Aae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Uk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Aae(e,t,r){return(t=_ae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _ae(e){var t=Tae(e,"string");return typeof t=="symbol"?t:t+""}function Tae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _c={widthCache:{},cacheCount:0},kae=2e3,Cae={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},$k="recharts_measurement_span";function Oae(e){var t=gb({},e);return Object.keys(t).forEach(r=>{t[r]||delete t[r]}),t}var Ud=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||zs.isSsr)return{width:0,height:0};var n=Oae(r),a=JSON.stringify({text:t,copyStyle:n});if(_c.widthCache[a])return _c.widthCache[a];try{var i=document.getElementById($k);i||(i=document.createElement("span"),i.setAttribute("id",$k),i.setAttribute("aria-hidden","true"),document.body.appendChild(i));var o=gb(gb({},Cae),n);Object.assign(i.style,o),i.textContent="".concat(t);var u=i.getBoundingClientRect(),m={width:u.width,height:u.height};return _c.widthCache[a]=m,++_c.cacheCount>kae&&(_c.cacheCount=0,_c.widthCache={}),m}catch{return{width:0,height:0}}},zk=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Hk=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Dae=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,Pae=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,dR={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},Rae=Object.keys(dR),Cc="NaN";function Mae(e,t){return e*dR[t]}class aa{static parse(t){var r,[,n,a]=(r=Pae.exec(t))!==null&&r!==void 0?r:[];return new aa(parseFloat(n),a??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,Fa(t)&&(this.unit=""),r!==""&&!Dae.test(r)&&(this.num=NaN,this.unit=""),Rae.includes(r)&&(this.num=Mae(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new aa(NaN,""):new aa(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new aa(NaN,""):new aa(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new aa(NaN,""):new aa(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new aa(NaN,""):new aa(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Fa(this.num)}}function fR(e){if(e.includes(Cc))return Cc;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,a,i]=(r=zk.exec(t))!==null&&r!==void 0?r:[],o=aa.parse(n??""),u=aa.parse(i??""),m=a==="*"?o.multiply(u):o.divide(u);if(m.isNaN())return Cc;t=t.replace(zk,m.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var f,[,h,x,v]=(f=Hk.exec(t))!==null&&f!==void 0?f:[],y=aa.parse(h??""),w=aa.parse(v??""),b=x==="+"?y.add(w):y.subtract(w);if(b.isNaN())return Cc;t=t.replace(Hk,b.toString())}return t}var qk=/\(([^()]*)\)/;function Fae(e){for(var t=e,r;(r=qk.exec(t))!=null;){var[,n]=r;t=t.replace(qk,fR(n))}return t}function Iae(e){var t=e.replace(/\s+/g,"");return t=Fae(t),t=fR(t),t}function Lae(e){try{return Iae(e)}catch{return Cc}}function W1(e){var t=Lae(e.slice(5,-1));return t===Cc?"":t}var Bae=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],Uae=["dx","dy","angle","className","breakAll"];function yb(){return yb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yb.apply(null,arguments)}function Vk(e,t){if(e==null)return{};var r,n,a=$ae(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function $ae(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var hR=/[ \f\n\r\t\v\u2028\u2029]+/,mR=e=>{var{children:t,breakAll:r,style:n}=e;try{var a=[];qt(t)||(r?a=t.toString().split(""):a=t.toString().split(hR));var i=a.map(u=>({word:u,width:Ud(u,n).width})),o=r?0:Ud("",n).width;return{wordsWithComputedWidth:i,spaceWidth:o}}catch{return null}},zae=(e,t,r,n,a)=>{var{maxLines:i,children:o,style:u,breakAll:m}=e,f=ot(i),h=o,x=function(){var q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return q.reduce((B,fe)=>{var{word:Ne,width:he}=fe,K=B[B.length-1];if(K&&(n==null||a||K.width+he+r<Number(n)))K.words.push(Ne),K.width+=he+r;else{var H={words:[Ne],width:he};B.push(H)}return B},[])},v=x(t),y=Z=>Z.reduce((q,B)=>q.width>B.width?q:B);if(!f||a)return v;var w=v.length>i||y(v).width>Number(n);if(!w)return v;for(var b="",S=Z=>{var q=h.slice(0,Z),B=mR({breakAll:m,style:u,children:q+b}).wordsWithComputedWidth,fe=x(B),Ne=fe.length>i||y(fe).width>Number(n);return[Ne,fe]},N=0,_=h.length-1,A=0,k;N<=_&&A<=h.length-1;){var C=Math.floor((N+_)/2),O=C-1,[T,z]=S(O),[P]=S(C);if(!T&&!P&&(N=C+1),T&&P&&(_=C-1),!T&&P){k=z;break}A++}return k||v},Kk=e=>{var t=qt(e)?[]:e.toString().split(hR);return[{words:t}]},Hae=e=>{var{width:t,scaleToFit:r,children:n,style:a,breakAll:i,maxLines:o}=e;if((t||r)&&!zs.isSsr){var u,m,f=mR({breakAll:i,children:n,style:a});if(f){var{wordsWithComputedWidth:h,spaceWidth:x}=f;u=h,m=x}else return Kk(n);return zae({breakAll:i,children:n,maxLines:o,style:a},u,m,t,r)}return Kk(n)},Gk="#808080",Ip=g.forwardRef((e,t)=>{var{x:r=0,y:n=0,lineHeight:a="1em",capHeight:i="0.71em",scaleToFit:o=!1,textAnchor:u="start",verticalAnchor:m="end",fill:f=Gk}=e,h=Vk(e,Bae),x=g.useMemo(()=>Hae({breakAll:h.breakAll,children:h.children,maxLines:h.maxLines,scaleToFit:o,style:h.style,width:h.width}),[h.breakAll,h.children,h.maxLines,o,h.style,h.width]),{dx:v,dy:y,angle:w,className:b,breakAll:S}=h,N=Vk(h,Uae);if(!Wi(r)||!Wi(n))return null;var _=r+(ot(v)?v:0),A=n+(ot(y)?y:0),k;switch(m){case"start":k=W1("calc(".concat(i,")"));break;case"middle":k=W1("calc(".concat((x.length-1)/2," * -").concat(a," + (").concat(i," / 2))"));break;default:k=W1("calc(".concat(x.length-1," * -").concat(a,")"));break}var C=[];if(o){var O=x[0].width,{width:T}=h;C.push("scale(".concat(ot(T)?T/O:1,")"))}return w&&C.push("rotate(".concat(w,", ").concat(_,", ").concat(A,")")),C.length&&(N.transform=C.join(" ")),g.createElement("text",yb({},kt(N,!0),{ref:t,x:_,y:A,className:$t("recharts-text",b),textAnchor:u,fill:f.includes("url")?Gk:f}),x.map((z,P)=>{var Z=z.words.join(S?"":" ");return g.createElement("tspan",{x:_,dy:P===0?k:a,key:"".concat(Z,"-").concat(P)},Z)}))});Ip.displayName="Text";var qae=["offset"],Vae=["labelRef"];function Wk(e,t){if(e==null)return{};var r,n,a=Kae(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Kae(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Xk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Hr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Xk(Object(r),!0).forEach(function(n){Gae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Gae(e,t,r){return(t=Wae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wae(e){var t=Xae(e,"string");return typeof t=="symbol"?t:t+""}function Xae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ws(){return ws=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ws.apply(null,arguments)}var Yae=e=>{var{value:t,formatter:r}=e,n=qt(e.children)?t:e.children;return typeof r=="function"?r(n):n},Ww=e=>e!=null&&typeof e=="function",Zae=(e,t)=>{var r=Gr(t-e),n=Math.min(Math.abs(t-e),360);return r*n},Qae=(e,t,r)=>{var{position:n,viewBox:a,offset:i,className:o}=e,{cx:u,cy:m,innerRadius:f,outerRadius:h,startAngle:x,endAngle:v,clockWise:y}=a,w=(f+h)/2,b=Zae(x,v),S=b>=0?1:-1,N,_;n==="insideStart"?(N=x+S*i,_=y):n==="insideEnd"?(N=v-S*i,_=!y):n==="end"&&(N=v+S*i,_=y),_=b<=0?_:!_;var A=Wr(u,m,w,N),k=Wr(u,m,w,N+(_?1:-1)*359),C="M".concat(A.x,",").concat(A.y,`
    A`).concat(w,",").concat(w,",0,1,").concat(_?0:1,`,
    `).concat(k.x,",").concat(k.y),O=qt(e.id)?Dl("recharts-radial-line-"):e.id;return g.createElement("text",ws({},r,{dominantBaseline:"central",className:$t("recharts-radial-bar-label",o)}),g.createElement("defs",null,g.createElement("path",{id:O,d:C})),g.createElement("textPath",{xlinkHref:"#".concat(O)},t))},Jae=e=>{var{viewBox:t,offset:r,position:n}=e,{cx:a,cy:i,innerRadius:o,outerRadius:u,startAngle:m,endAngle:f}=t,h=(m+f)/2;if(n==="outside"){var{x,y:v}=Wr(a,i,u+r,h);return{x,y:v,textAnchor:x>=a?"start":"end",verticalAnchor:"middle"}}if(n==="center")return{x:a,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(n==="centerTop")return{x:a,y:i,textAnchor:"middle",verticalAnchor:"start"};if(n==="centerBottom")return{x:a,y:i,textAnchor:"middle",verticalAnchor:"end"};var y=(o+u)/2,{x:w,y:b}=Wr(a,i,y,h);return{x:w,y:b,textAnchor:"middle",verticalAnchor:"middle"}},eie=(e,t)=>{var{parentViewBox:r,offset:n,position:a}=e,{x:i,y:o,width:u,height:m}=t,f=m>=0?1:-1,h=f*n,x=f>0?"end":"start",v=f>0?"start":"end",y=u>=0?1:-1,w=y*n,b=y>0?"end":"start",S=y>0?"start":"end";if(a==="top"){var N={x:i+u/2,y:o-f*n,textAnchor:"middle",verticalAnchor:x};return Hr(Hr({},N),r?{height:Math.max(o-r.y,0),width:u}:{})}if(a==="bottom"){var _={x:i+u/2,y:o+m+h,textAnchor:"middle",verticalAnchor:v};return Hr(Hr({},_),r?{height:Math.max(r.y+r.height-(o+m),0),width:u}:{})}if(a==="left"){var A={x:i-w,y:o+m/2,textAnchor:b,verticalAnchor:"middle"};return Hr(Hr({},A),r?{width:Math.max(A.x-r.x,0),height:m}:{})}if(a==="right"){var k={x:i+u+w,y:o+m/2,textAnchor:S,verticalAnchor:"middle"};return Hr(Hr({},k),r?{width:Math.max(r.x+r.width-k.x,0),height:m}:{})}var C=r?{width:u,height:m}:{};return a==="insideLeft"?Hr({x:i+w,y:o+m/2,textAnchor:S,verticalAnchor:"middle"},C):a==="insideRight"?Hr({x:i+u-w,y:o+m/2,textAnchor:b,verticalAnchor:"middle"},C):a==="insideTop"?Hr({x:i+u/2,y:o+h,textAnchor:"middle",verticalAnchor:v},C):a==="insideBottom"?Hr({x:i+u/2,y:o+m-h,textAnchor:"middle",verticalAnchor:x},C):a==="insideTopLeft"?Hr({x:i+w,y:o+h,textAnchor:S,verticalAnchor:v},C):a==="insideTopRight"?Hr({x:i+u-w,y:o+h,textAnchor:b,verticalAnchor:v},C):a==="insideBottomLeft"?Hr({x:i+w,y:o+m-h,textAnchor:S,verticalAnchor:x},C):a==="insideBottomRight"?Hr({x:i+u-w,y:o+m-h,textAnchor:b,verticalAnchor:x},C):a&&typeof a=="object"&&(ot(a.x)||uo(a.x))&&(ot(a.y)||uo(a.y))?Hr({x:i+Zn(a.x,u),y:o+Zn(a.y,m),textAnchor:"end",verticalAnchor:"end"},C):Hr({x:i+u/2,y:o+m/2,textAnchor:"middle",verticalAnchor:"middle"},C)},tie=e=>"cx"in e&&ot(e.cx);function ka(e){var{offset:t=5}=e,r=Wk(e,qae),n=Hr({offset:t},r),{viewBox:a,position:i,value:o,children:u,content:m,className:f="",textBreakAll:h,labelRef:x}=n,v=$2(),y=a||v;if(!y||qt(o)&&qt(u)&&!g.isValidElement(m)&&typeof m!="function")return null;if(g.isValidElement(m)){var{labelRef:w}=n,b=Wk(n,Vae);return g.cloneElement(m,b)}var S;if(typeof m=="function"){if(S=g.createElement(m,n),g.isValidElement(S))return S}else S=Yae(n);var N=tie(y),_=kt(n,!0);if(N&&(i==="insideStart"||i==="insideEnd"||i==="end"))return Qae(n,S,_);var A=N?Jae(n):eie(n,y);return g.createElement(Ip,ws({ref:x,className:$t("recharts-label",f)},_,A,{breakAll:h}),S)}ka.displayName="Label";var pR=e=>{var{cx:t,cy:r,angle:n,startAngle:a,endAngle:i,r:o,radius:u,innerRadius:m,outerRadius:f,x:h,y:x,top:v,left:y,width:w,height:b,clockWise:S,labelViewBox:N}=e;if(N)return N;if(ot(w)&&ot(b)){if(ot(h)&&ot(x))return{x:h,y:x,width:w,height:b};if(ot(v)&&ot(y))return{x:v,y,width:w,height:b}}if(ot(h)&&ot(x))return{x:h,y:x,width:0,height:0};if(ot(t)&&ot(r))return{cx:t,cy:r,startAngle:a||n||0,endAngle:i||n||0,innerRadius:m||0,outerRadius:f||u||o||0,clockWise:S};if(e.viewBox)return e.viewBox},rie=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?g.createElement(ka,ws({key:"label-implicit"},n)):Wi(e)?g.createElement(ka,ws({key:"label-implicit",value:e},n)):g.isValidElement(e)?e.type===ka?g.cloneElement(e,Hr({key:"label-implicit"},n)):g.createElement(ka,ws({key:"label-implicit",content:e},n)):Ww(e)?g.createElement(ka,ws({key:"label-implicit",content:e},n)):e&&typeof e=="object"?g.createElement(ka,ws({},e,{key:"label-implicit"},n)):null},nie=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var{children:a,labelRef:i}=t,o=pR(t),u=Lo(a,ka).map((f,h)=>g.cloneElement(f,{viewBox:r||o,key:"label-".concat(h)}));if(!n)return u;var m=rie(t.label,r||o,i);return[m,...u]};ka.parseViewBox=pR;ka.renderCallByParent=nie;var X1={},Y1={},Yk;function aie(){return Yk||(Yk=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t}(Y1)),Y1}var Z1={},Zk;function iie(){return Zk||(Zk=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t}(Z1)),Z1}var Qk;function sie(){return Qk||(Qk=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=aie(),r=iie(),n=A2();function a(i){if(n.isArrayLike(i))return t.last(r.toArray(i))}e.last=a}(X1)),X1}var Q1,Jk;function lie(){return Jk||(Jk=1,Q1=sie().last),Q1}var oie=lie();const cie=fi(oie);var uie=["valueAccessor"],die=["data","dataKey","clockWise","id","textBreakAll"];function km(){return km=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},km.apply(null,arguments)}function e3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function t3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?e3(Object(r),!0).forEach(function(n){fie(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):e3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fie(e,t,r){return(t=hie(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hie(e){var t=mie(e,"string");return typeof t=="symbol"?t:t+""}function mie(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function r3(e,t){if(e==null)return{};var r,n,a=pie(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function pie(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var xie=e=>Array.isArray(e.value)?cie(e.value):e.value;function Gi(e){var{valueAccessor:t=xie}=e,r=r3(e,uie),{data:n,dataKey:a,clockWise:i,id:o,textBreakAll:u}=r,m=r3(r,die);return!n||!n.length?null:g.createElement(mr,{className:"recharts-label-list"},n.map((f,h)=>{var x=qt(a)?t(f,h):Jt(f&&f.payload,a),v=qt(o)?{}:{id:"".concat(o,"-").concat(h)};return g.createElement(ka,km({},kt(f,!0),m,v,{parentViewBox:f.parentViewBox,value:x,textBreakAll:u,viewBox:ka.parseViewBox(qt(i)?f:t3(t3({},f),{},{clockWise:i})),key:"label-".concat(h),index:h}))}))}Gi.displayName="LabelList";function vie(e,t){return e?e===!0?g.createElement(Gi,{key:"labelList-implicit",data:t}):g.isValidElement(e)||Ww(e)?g.createElement(Gi,{key:"labelList-implicit",data:t,content:e}):typeof e=="object"?g.createElement(Gi,km({data:t},e,{key:"labelList-implicit"})):null:null}function gie(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var{children:n}=e,a=Lo(n,Gi).map((o,u)=>g.cloneElement(o,{data:t,key:"labelList-".concat(u)}));if(!r)return a;var i=vie(e.label,t);return[i,...a]}Gi.renderCallByParent=gie;function bb(){return bb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},bb.apply(null,arguments)}var xR=e=>{var{cx:t,cy:r,r:n,className:a}=e,i=$t("recharts-dot",a);return t===+t&&r===+r&&n===+n?g.createElement("circle",bb({},kt(e,!1),y2(e),{className:i,cx:t,cy:r,r:n})):null},Lp=e=>e.graphicalItems.polarItems,yie=_e([Er,Rf],jw),Bp=_e([Lp,Br,yie],Nw),bie=_e([Bp],Ew),Up=_e([bie,Np],Aw),vR=_e([Up,Br,Bp],_w),wie=_e([Up,Br,Bp],(e,t,r)=>r.length>0?e.flatMap(n=>r.flatMap(a=>{var i,o=Jt(n,(i=t.dataKey)!==null&&i!==void 0?i:a.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):t?.dataKey!=null?e.map(n=>({value:Jt(n,t.dataKey),errorDomain:[]})):e.map(n=>({value:n,errorDomain:[]}))),n3=()=>{},Sie=_e([Br,EP,n3,wie,n3],Ow),gR=_e([Br,Ct,Up,vR,cu,Er,Sie],Dw),yR=_e([gR,Br,Ll],Rw),jie=_e([Br,gR,yR,Er],Fw),Xw=(e,t,r)=>{switch(t){case"angleAxis":return Df(e,r);case"radiusAxis":return Pf(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},Yw=(e,t,r)=>{switch(t){case"angleAxis":return Zte(e,r);case"radiusAxis":return Qte(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},$p=_e([Xw,Ll,jie,Yw],Dp),bR=_e([Ct,vR,uu,Er],Iw),Nie=_e([Ct,Xw,Ll,$p,yR,Yw,Lf,bR,Er],RP),Eie=_e([Ct,Xw,$p,Yw,Lf,bR,Er],FP),Aie={radiusAxis:{},angleAxis:{}},wR=pi({name:"polarAxis",initialState:Aie,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:whe,removeRadiusAxis:She,addAngleAxis:jhe,removeAngleAxis:Nhe}=wR.actions,_ie=wR.reducer;function a3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function i3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?a3(Object(r),!0).forEach(function(n){Tie(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Tie(e,t,r){return(t=kie(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kie(e){var t=Cie(e,"string");return typeof t=="symbol"?t:t+""}function Cie(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Zw=(e,t)=>t,Oie=[],Qw=(e,t,r)=>r?.length===0?Oie:r,SR=_e([Np,Zw,Qw],(e,t,r)=>{var{chartData:n}=e,a;if(t?.data!=null&&t.data.length>0?a=t.data:a=n,(!a||!a.length)&&r!=null&&(a=r.map(i=>i3(i3({},t.presentationProps),i.props))),a!=null)return a}),Die=_e([SR,Zw,Qw],(e,t,r)=>{if(e!=null)return e.map((n,a)=>{var i,o=Jt(n,t.nameKey,t.name),u;return r!=null&&(i=r[a])!==null&&i!==void 0&&(i=i.props)!==null&&i!==void 0&&i.fill?u=r[a].props.fill:typeof n=="object"&&n!=null&&"fill"in n?u=n.fill:u=t.fill,{value:Bs(o,t.dataKey),color:u,payload:n,type:t.legendType}})}),Pie=_e([Lp,Zw],(e,t)=>{if(e.some(r=>r.type==="pie"&&t.dataKey===r.dataKey&&t.data===r.data))return t}),Rie=_e([SR,Pie,Qw,nn],(e,t,r,n)=>{if(!(t==null||e==null))return jse({offset:n,pieSettings:t,displayedData:e,cells:r})}),Mie={countOfBars:0,cartesianItems:[],polarItems:[]},jR=pi({name:"graphicalItems",initialState:Mie,reducers:{addBar(e){e.countOfBars+=1},removeBar(e){e.countOfBars-=1},addCartesianGraphicalItem(e,t){e.cartesianItems.push(t.payload)},replaceCartesianGraphicalItem(e,t){var{prev:r,next:n}=t.payload,a=ks(e).cartesianItems.indexOf(r);a>-1&&(e.cartesianItems[a]=n)},removeCartesianGraphicalItem(e,t){var r=ks(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},addPolarGraphicalItem(e,t){e.polarItems.push(t.payload)},removePolarGraphicalItem(e,t){var r=ks(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)}}}),{addBar:Fie,removeBar:Iie,addCartesianGraphicalItem:Lie,replaceCartesianGraphicalItem:Bie,removeCartesianGraphicalItem:Uie,addPolarGraphicalItem:$ie,removePolarGraphicalItem:zie}=jR.actions,Hie=jR.reducer;function s3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function l3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?s3(Object(r),!0).forEach(function(n){qie(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qie(e,t,r){return(t=Vie(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Vie(e){var t=Kie(e,"string");return typeof t=="symbol"?t:t+""}function Kie(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gie(e){var t=br(),r=g.useRef(null);return g.useEffect(()=>{var n=l3(l3({},e),{},{stackId:Y6(e.stackId)});r.current===null?t(Lie(n)):r.current!==n&&t(Bie({prev:r.current,next:n})),r.current=n},[t,e]),g.useEffect(()=>()=>{r.current&&(t(Uie(r.current)),r.current=null)},[t]),null}function NR(e){var t=br();return g.useEffect(()=>(t($ie(e)),()=>{t(zie(e))}),[t,e]),null}var J1={},o3;function Wie(){return o3||(o3=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const a=r[Symbol.toStringTag];return a==null||!Object.getOwnPropertyDescriptor(r,Symbol.toStringTag)?.writable?!1:r.toString()===`[object ${a}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}e.isPlainObject=t}(J1)),J1}var ey,c3;function Xie(){return c3||(c3=1,ey=Wie().isPlainObject),ey}var Yie=Xie();const Zie=fi(Yie);function Cm(){return Cm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Cm.apply(null,arguments)}var u3=(e,t,r,n,a)=>{var i=r-n,o;return o="M ".concat(e,",").concat(t),o+="L ".concat(e+r,",").concat(t),o+="L ".concat(e+r-i/2,",").concat(t+a),o+="L ".concat(e+r-i/2-n,",").concat(t+a),o+="L ".concat(e,",").concat(t," Z"),o},Qie={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Jie=e=>{var t=da(e,Qie),r=g.useRef(),[n,a]=g.useState(-1);g.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var S=r.current.getTotalLength();S&&a(S)}catch{}},[]);var{x:i,y:o,upperWidth:u,lowerWidth:m,height:f,className:h}=t,{animationEasing:x,animationDuration:v,animationBegin:y,isUpdateAnimationActive:w}=t;if(i!==+i||o!==+o||u!==+u||m!==+m||f!==+f||u===0&&m===0||f===0)return null;var b=$t("recharts-trapezoid",h);return w?g.createElement(Xi,{canBegin:n>0,from:{upperWidth:0,lowerWidth:0,height:f,x:i,y:o},to:{upperWidth:u,lowerWidth:m,height:f,x:i,y:o},duration:v,animationEasing:x,isActive:w},S=>{var{upperWidth:N,lowerWidth:_,height:A,x:k,y:C}=S;return g.createElement(Xi,{canBegin:n>0,from:"0px ".concat(n===-1?1:n,"px"),to:"".concat(n,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:v,easing:x},g.createElement("path",Cm({},kt(t,!0),{className:b,d:u3(k,C,N,_,A),ref:r})))}):g.createElement("g",null,g.createElement("path",Cm({},kt(t,!0),{className:b,d:u3(i,o,u,m,f)})))},ese=["option","shapeType","propTransformer","activeClassName","isActive"];function tse(e,t){if(e==null)return{};var r,n,a=rse(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function rse(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function d3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Om(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?d3(Object(r),!0).forEach(function(n){nse(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nse(e,t,r){return(t=ase(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ase(e){var t=ise(e,"string");return typeof t=="symbol"?t:t+""}function ise(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sse(e,t){return Om(Om({},t),e)}function lse(e,t){return e==="symbols"}function f3(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return g.createElement(oD,r);case"trapezoid":return g.createElement(Jie,r);case"sector":return g.createElement(_f,r);case"symbols":if(lse(t))return g.createElement(ip,r);break;default:return null}}function ose(e){return g.isValidElement(e)?e.props:e}function df(e){var{option:t,shapeType:r,propTransformer:n=sse,activeClassName:a="recharts-active-shape",isActive:i}=e,o=tse(e,ese),u;if(g.isValidElement(t))u=g.cloneElement(t,Om(Om({},o),ose(t)));else if(typeof t=="function")u=t(o);else if(Zie(t)&&typeof t!="boolean"){var m=n(t,o);u=g.createElement(f3,{shapeType:r,elementProps:m})}else{var f=o;u=g.createElement(f3,{shapeType:r,elementProps:f})}return i?g.createElement(mr,{className:a},u):u}var $f=(e,t)=>{var r=br();return(n,a)=>i=>{e?.(n,a,i),r(zP({activeIndex:String(a),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}},zf=e=>{var t=br();return(r,n)=>a=>{e?.(r,n,a),t(Wre())}},Hf=(e,t)=>{var r=br();return(n,a)=>i=>{e?.(n,a,i),r(Xre({activeIndex:String(a),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}};function qf(e){var{fn:t,args:r}=e,n=br(),a=$n();return g.useEffect(()=>{if(!a){var i=t(r);return n(Vre(i)),()=>{n(Kre(i))}}},[t,r,n,a]),null}var ER=()=>{};function Jw(e){var{legendPayload:t}=e,r=br(),n=$n();return g.useEffect(()=>n?ER:(r(rD(t)),()=>{r(nD(t))}),[r,n,t]),null}function AR(e){var{legendPayload:t}=e,r=br(),n=lt(Ct);return g.useEffect(()=>n!=="centric"&&n!=="radial"?ER:(r(rD(t)),()=>{r(nD(t))}),[r,n,t]),null}function Vf(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=g.useRef(Dl(t)),n=g.useRef(e);return n.current!==e&&(r.current=Dl(t),n.current=e),r.current}var cse=["onMouseEnter","onClick","onMouseLeave"];function use(e,t){if(e==null)return{};var r,n,a=dse(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function dse(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function h3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Pr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?h3(Object(r),!0).forEach(function(n){zp(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zp(e,t,r){return(t=fse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fse(e){var t=hse(e,"string");return typeof t=="symbol"?t:t+""}function hse(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Co(){return Co=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Co.apply(null,arguments)}function mse(e){var t=g.useMemo(()=>kt(e,!1),[e]),r=g.useMemo(()=>Lo(e.children,ns),[e.children]),n=g.useMemo(()=>({name:e.name,nameKey:e.nameKey,tooltipType:e.tooltipType,data:e.data,dataKey:e.dataKey,cx:e.cx,cy:e.cy,startAngle:e.startAngle,endAngle:e.endAngle,minAngle:e.minAngle,paddingAngle:e.paddingAngle,innerRadius:e.innerRadius,outerRadius:e.outerRadius,cornerRadius:e.cornerRadius,legendType:e.legendType,fill:e.fill,presentationProps:t}),[e.cornerRadius,e.cx,e.cy,e.data,e.dataKey,e.endAngle,e.innerRadius,e.minAngle,e.name,e.nameKey,e.outerRadius,e.paddingAngle,e.startAngle,e.tooltipType,e.legendType,e.fill,t]),a=lt(i=>Die(i,n,r));return g.createElement(AR,{legendPayload:a})}function pse(e){var{dataKey:t,nameKey:r,sectors:n,stroke:a,strokeWidth:i,fill:o,name:u,hide:m,tooltipType:f}=e;return{dataDefinedOnItem:n?.map(h=>h.tooltipPayload),positions:n?.map(h=>h.tooltipPosition),settings:{stroke:a,strokeWidth:i,fill:o,dataKey:t,nameKey:r,name:Bs(u,t),hide:m,type:f,color:o,unit:""}}}var xse=(e,t)=>e>t?"start":e<t?"end":"middle",vse=(e,t,r)=>typeof t=="function"?t(e):Zn(t,r,r*.8),gse=(e,t,r)=>{var{top:n,left:a,width:i,height:o}=t,u=K6(i,o),m=a+Zn(e.cx,i,i/2),f=n+Zn(e.cy,o,o/2),h=Zn(e.innerRadius,u,0),x=vse(r,e.outerRadius,u),v=e.maxRadius||Math.sqrt(i*i+o*o)/2;return{cx:m,cy:f,innerRadius:h,outerRadius:x,maxRadius:v}},yse=(e,t)=>{var r=Gr(t-e),n=Math.min(Math.abs(t-e),360);return r*n},bse=(e,t)=>{if(g.isValidElement(e))return g.cloneElement(e,t);if(typeof e=="function")return e(t);var r=$t("recharts-pie-label-line",typeof e!="boolean"?e.className:"");return g.createElement(vp,Co({},t,{type:"linear",className:r}))},wse=(e,t,r)=>{if(g.isValidElement(e))return g.cloneElement(e,t);var n=r;if(typeof e=="function"&&(n=e(t),g.isValidElement(n)))return n;var a=$t("recharts-pie-label-text",typeof e!="boolean"&&typeof e!="function"?e.className:"");return g.createElement(Ip,Co({},t,{alignmentBaseline:"middle",className:a}),n)};function Sse(e){var{sectors:t,props:r,showLabels:n}=e,{label:a,labelLine:i,dataKey:o}=r;if(!n||!a||!t)return null;var u=kt(r,!1),m=kt(a,!1),f=kt(i,!1),h=typeof a=="object"&&"offsetRadius"in a&&a.offsetRadius||20,x=t.map((v,y)=>{var w=(v.startAngle+v.endAngle)/2,b=Wr(v.cx,v.cy,v.outerRadius+h,w),S=Pr(Pr(Pr(Pr({},u),v),{},{stroke:"none"},m),{},{index:y,textAnchor:xse(b.x,v.cx)},b),N=Pr(Pr(Pr(Pr({},u),v),{},{fill:"none",stroke:v.fill},f),{},{index:y,points:[Wr(v.cx,v.cy,v.outerRadius,w),b],key:"line"});return g.createElement(mr,{key:"label-".concat(v.startAngle,"-").concat(v.endAngle,"-").concat(v.midAngle,"-").concat(y)},i&&bse(i,N),wse(a,S,Jt(v,o)))});return g.createElement(mr,{className:"recharts-pie-labels"},x)}function _R(e){var{sectors:t,activeShape:r,inactiveShape:n,allOtherPieProps:a,showLabels:i}=e,o=lt(Qi),{onMouseEnter:u,onClick:m,onMouseLeave:f}=a,h=use(a,cse),x=$f(u,a.dataKey),v=zf(f),y=Hf(m,a.dataKey);return t==null?null:g.createElement(g.Fragment,null,t.map((w,b)=>{if(w?.startAngle===0&&w?.endAngle===0&&t.length!==1)return null;var S=r&&String(b)===o,N=o?n:null,_=S?r:N,A=Pr(Pr({},w),{},{stroke:w.stroke,tabIndex:-1,[B2]:b,[U2]:a.dataKey});return g.createElement(mr,Co({tabIndex:-1,className:"recharts-pie-sector"},Pl(h,w,b),{onMouseEnter:x(w,b),onMouseLeave:v(w,b),onClick:y(w,b),key:"sector-".concat(w?.startAngle,"-").concat(w?.endAngle,"-").concat(w.midAngle,"-").concat(b)}),g.createElement(df,Co({option:_,isActive:S,shapeType:"sector"},A)))}),g.createElement(Sse,{sectors:t,props:a,showLabels:i}))}function jse(e){var t,{pieSettings:r,displayedData:n,cells:a,offset:i}=e,{cornerRadius:o,startAngle:u,endAngle:m,dataKey:f,nameKey:h,tooltipType:x}=r,v=Math.abs(r.minAngle),y=yse(u,m),w=Math.abs(y),b=n.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,S=n.filter(O=>Jt(O,f,0)!==0).length,N=(w>=360?S:S-1)*b,_=w-S*v-N,A=n.reduce((O,T)=>{var z=Jt(T,f,0);return O+(ot(z)?z:0)},0),k;if(A>0){var C;k=n.map((O,T)=>{var z=Jt(O,f,0),P=Jt(O,h,T),Z=gse(r,i,O),q=(ot(z)?z:0)/A,B,fe=Pr(Pr({},O),a&&a[T]&&a[T].props);T?B=C.endAngle+Gr(y)*b*(z!==0?1:0):B=u;var Ne=B+Gr(y)*((z!==0?v:0)+q*_),he=(B+Ne)/2,K=(Z.innerRadius+Z.outerRadius)/2,H=[{name:P,value:z,payload:fe,dataKey:f,type:x}],be=Wr(Z.cx,Z.cy,K,he);return C=Pr(Pr(Pr(Pr({},r.presentationProps),{},{percent:q,cornerRadius:o,name:P,tooltipPayload:H,midAngle:he,middleRadius:K,tooltipPosition:be},fe),Z),{},{value:Jt(O,f),startAngle:B,endAngle:Ne,payload:fe,paddingAngle:Gr(y)*b}),C})}return k}function Nse(e){var{props:t,previousSectorsRef:r}=e,{sectors:n,isAnimationActive:a,animationBegin:i,animationDuration:o,animationEasing:u,activeShape:m,inactiveShape:f,onAnimationStart:h,onAnimationEnd:x}=t,v=Vf(t,"recharts-pie-"),y=r.current,[w,b]=g.useState(!0),S=g.useCallback(()=>{typeof x=="function"&&x(),b(!1)},[x]),N=g.useCallback(()=>{typeof h=="function"&&h(),b(!0)},[h]);return g.createElement(Xi,{begin:i,duration:o,isActive:a,easing:u,from:{t:0},to:{t:1},onAnimationStart:N,onAnimationEnd:S,key:v},_=>{var{t:A}=_,k=[],C=n&&n[0],O=C.startAngle;return n.forEach((T,z)=>{var P=y&&y[z],Z=z>0?Ol(T,"paddingAngle",0):0;if(P){var q=Kr(P.endAngle-P.startAngle,T.endAngle-T.startAngle),B=Pr(Pr({},T),{},{startAngle:O+Z,endAngle:O+q(A)+Z});k.push(B),O=B.endAngle}else{var{endAngle:fe,startAngle:Ne}=T,he=Kr(0,fe-Ne),K=he(A),H=Pr(Pr({},T),{},{startAngle:O+Z,endAngle:O+K+Z});k.push(H),O=H.endAngle}}),r.current=k,g.createElement(mr,null,g.createElement(_R,{sectors:k,activeShape:m,inactiveShape:f,allOtherPieProps:t,showLabels:!w}))})}function Ese(e){var{sectors:t,isAnimationActive:r,activeShape:n,inactiveShape:a}=e,i=g.useRef(null),o=i.current;return r&&t&&t.length&&(!o||o!==t)?g.createElement(Nse,{props:e,previousSectorsRef:i}):g.createElement(_R,{sectors:t,activeShape:n,inactiveShape:a,allOtherPieProps:e,showLabels:!0})}function Ase(e){var{hide:t,className:r,rootTabIndex:n}=e,a=$t("recharts-pie",r);return t?null:g.createElement(mr,{tabIndex:n,className:a},g.createElement(Ese,e))}var TR={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!zs.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff"};function _se(e){var t=da(e,TR),r=g.useMemo(()=>Lo(e.children,ns),[e.children]),n=kt(t,!1),a=g.useMemo(()=>({name:t.name,nameKey:t.nameKey,tooltipType:t.tooltipType,data:t.data,dataKey:t.dataKey,cx:t.cx,cy:t.cy,startAngle:t.startAngle,endAngle:t.endAngle,minAngle:t.minAngle,paddingAngle:t.paddingAngle,innerRadius:t.innerRadius,outerRadius:t.outerRadius,cornerRadius:t.cornerRadius,legendType:t.legendType,fill:t.fill,presentationProps:n}),[t.cornerRadius,t.cx,t.cy,t.data,t.dataKey,t.endAngle,t.innerRadius,t.minAngle,t.name,t.nameKey,t.outerRadius,t.paddingAngle,t.startAngle,t.tooltipType,t.legendType,t.fill,n]),i=lt(o=>Rie(o,a,r));return g.createElement(g.Fragment,null,g.createElement(qf,{fn:pse,args:Pr(Pr({},t),{},{sectors:i})}),g.createElement(Ase,Co({},t,{sectors:i})))}class pu extends g.PureComponent{constructor(){super(...arguments),zp(this,"id",Dl("recharts-pie-"))}render(){return g.createElement(g.Fragment,null,g.createElement(NR,{data:this.props.data,dataKey:this.props.dataKey,hide:this.props.hide,angleAxisId:0,radiusAxisId:0,stackId:void 0,barSize:void 0,type:"pie"}),g.createElement(mse,this.props),g.createElement(_se,this.props),this.props.children)}}zp(pu,"displayName","Pie");zp(pu,"defaultProps",TR);var Tse=_e([nn],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),kse=_e([Tse,Us,$s],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),Cse=e=>{var t=$n();return lt(r=>di(r,"xAxis",e,t))},Ose=e=>{var t=$n();return lt(r=>di(r,"yAxis",e,t))},eS=()=>lt(kse),Dse=()=>lt(Pne);function m3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function p3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?m3(Object(r),!0).forEach(function(n){Pse(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Pse(e,t,r){return(t=Rse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Rse(e){var t=Mse(e,"string");return typeof t=="symbol"?t:t+""}function Mse(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Fse=e=>{var{point:t,childIndex:r,mainColor:n,activeDot:a,dataKey:i}=e;if(a===!1||t.x==null||t.y==null)return null;var o=p3(p3({index:r,dataKey:i,cx:t.x,cy:t.y,r:4,fill:n??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},kt(a,!1)),y2(a)),u;return g.isValidElement(a)?u=g.cloneElement(a,o):typeof a=="function"?u=a(o):u=g.createElement(xR,o),g.createElement(mr,{className:"recharts-active-dot"},u)};function Ise(e){var{points:t,mainColor:r,activeDot:n,itemDataKey:a}=e,i=lt(Qi),o=Dse();if(t==null||o==null)return null;var u=t.find(m=>o.includes(m.payload));return qt(u)?null:Fse({point:u,childIndex:Number(i),mainColor:r,dataKey:a,activeDot:n})}var Lse=e=>g.createElement(NR,e);function wb(){return wb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},wb.apply(null,arguments)}function x3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ty(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?x3(Object(r),!0).forEach(function(n){Bse(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Bse(e,t,r){return(t=Use(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Use(e){var t=$se(e,"string");return typeof t=="symbol"?t:t+""}function $se(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kR(e){return typeof e=="string"?parseInt(e,10):e}function zse(e,t){var r="".concat(t.cx||e.cx),n=Number(r),a="".concat(t.cy||e.cy),i=Number(a);return ty(ty(ty({},t),e),{},{cx:n,cy:i})}function CR(e){return g.createElement(df,wb({shapeType:"sector",propTransformer:zse},e))}var OR=()=>{var e=br();return g.useEffect(()=>(e(Fie()),()=>{e(Iie())})),null},Hse=["children"];function qse(e,t){if(e==null)return{};var r,n,a=Vse(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Vse(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var v3=()=>{},DR=g.createContext({addErrorBar:v3,removeErrorBar:v3}),Kse={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},PR=g.createContext(Kse);function tS(e){var{children:t}=e,r=qse(e,Hse);return g.createElement(PR.Provider,{value:r},t)}var Gse=()=>g.useContext(PR),rS=e=>{var{children:t,xAxisId:r,yAxisId:n,zAxisId:a,dataKey:i,data:o,stackId:u,hide:m,type:f,barSize:h}=e,[x,v]=g.useState([]),y=g.useCallback(S=>{v(N=>[...N,S])},[v]),w=g.useCallback(S=>{v(N=>N.filter(_=>_!==S))},[v]),b=$n();return g.createElement(DR.Provider,{value:{addErrorBar:y,removeErrorBar:w}},g.createElement(Gie,{type:f,data:o,xAxisId:r,yAxisId:n,zAxisId:a,dataKey:i,errorBars:x,stackId:u,hide:m,barSize:h,isPanorama:b}),t)};function Wse(e){var{addErrorBar:t,removeErrorBar:r}=g.useContext(DR);return g.useEffect(()=>(t(e),()=>{r(e)}),[t,r,e]),null}var Xse=["direction","width","dataKey","isAnimationActive","animationBegin","animationDuration","animationEasing"];function RR(e,t,r){return(t=Yse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yse(e){var t=Zse(e,"string");return typeof t=="symbol"?t:t+""}function Zse(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ff(){return ff=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ff.apply(null,arguments)}function Qse(e,t){if(e==null)return{};var r,n,a=Jse(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Jse(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function ele(e){var{direction:t,width:r,dataKey:n,isAnimationActive:a,animationBegin:i,animationDuration:o,animationEasing:u}=e,m=Qse(e,Xse),f=kt(m,!1),{data:h,dataPointFormatter:x,xAxisId:v,yAxisId:y,errorBarOffset:w}=Gse(),b=Cse(v),S=Ose(y);if(b?.scale==null||S?.scale==null||h==null||t==="x"&&b.type!=="number")return null;var N=h.map(_=>{var{x:A,y:k,value:C,errorVal:O}=x(_,n,t);if(!O)return null;var T=[],z,P;if(Array.isArray(O)?[z,P]=O:z=P=O,t==="x"){var{scale:Z}=b,q=k+w,B=q+r,fe=q-r,Ne=Z(C-z),he=Z(C+P);T.push({x1:he,y1:B,x2:he,y2:fe}),T.push({x1:Ne,y1:q,x2:he,y2:q}),T.push({x1:Ne,y1:B,x2:Ne,y2:fe})}else if(t==="y"){var{scale:K}=S,H=A+w,be=H-r,te=H+r,I=K(C-z),se=K(C+P);T.push({x1:be,y1:se,x2:te,y2:se}),T.push({x1:H,y1:I,x2:H,y2:se}),T.push({x1:be,y1:I,x2:te,y2:I})}var R="".concat(A+w,"px ").concat(k+w,"px");return g.createElement(mr,ff({className:"recharts-errorBar",key:"bar-".concat(T.map(W=>"".concat(W.x1,"-").concat(W.x2,"-").concat(W.y1,"-").concat(W.y2)))},f),T.map(W=>{var Y=a?{transformOrigin:"".concat(W.x1-5,"px")}:void 0;return g.createElement(Xi,{from:{transform:"scaleY(0)",transformOrigin:R},to:{transform:"scaleY(1)",transformOrigin:R},begin:i,easing:u,isActive:a,duration:o,key:"line-".concat(W.x1,"-").concat(W.x2,"-").concat(W.y1,"-").concat(W.y2),style:{transformOrigin:R}},g.createElement("line",ff({},W,{style:Y})))}))});return g.createElement(mr,{className:"recharts-errorBars"},N)}var MR=g.createContext(void 0);function tle(e){var t=g.useContext(MR);return e??t??"x"}function FR(e){var{direction:t,children:r}=e;return g.createElement(MR.Provider,{value:t},r)}var IR={stroke:"black",strokeWidth:1.5,width:5,offset:0,isAnimationActive:!0,animationBegin:0,animationDuration:400,animationEasing:"ease-in-out"};function rle(e){var t=tle(e.direction),{width:r,isAnimationActive:n,animationBegin:a,animationDuration:i,animationEasing:o}=da(e,IR);return g.createElement(g.Fragment,null,g.createElement(Wse,{dataKey:e.dataKey,direction:t}),g.createElement(ele,ff({},e,{direction:t,width:r,isAnimationActive:n,animationBegin:a,animationDuration:i,animationEasing:o})))}class LR extends g.Component{render(){return g.createElement(rle,this.props)}}RR(LR,"defaultProps",IR);RR(LR,"displayName","ErrorBar");var nle="Invariant failed";function ale(e,t){throw new Error(nle)}var ile=["x","y"];function Sb(){return Sb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Sb.apply(null,arguments)}function g3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function yd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?g3(Object(r),!0).forEach(function(n){sle(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sle(e,t,r){return(t=lle(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lle(e){var t=ole(e,"string");return typeof t=="symbol"?t:t+""}function ole(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cle(e,t){if(e==null)return{};var r,n,a=ule(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function ule(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function dle(e,t){var{x:r,y:n}=e,a=cle(e,ile),i="".concat(r),o=parseInt(i,10),u="".concat(n),m=parseInt(u,10),f="".concat(t.height||a.height),h=parseInt(f,10),x="".concat(t.width||a.width),v=parseInt(x,10);return yd(yd(yd(yd(yd({},t),a),o?{x:o}:{}),m?{y:m}:{}),{},{height:h,width:v,name:t.name,radius:t.radius})}function BR(e){return g.createElement(df,Sb({shapeType:"rectangle",propTransformer:dle,activeClassName:"recharts-active-bar"},e))}var fle=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,a)=>{if(ot(t))return t;var i=ot(n)||qt(n);return i?t(n,a):(i||ale(),r)}};function Hp(e,t){var r,n,a=lt(f=>qs(f,e)),i=lt(f=>Il(f,t)),o=(r=a?.allowDataOverflow)!==null&&r!==void 0?r:Na.allowDataOverflow,u=(n=i?.allowDataOverflow)!==null&&n!==void 0?n:Ea.allowDataOverflow,m=o||u;return{needClip:m,needClipX:o,needClipY:u}}function nS(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,a=eS(),{needClipX:i,needClipY:o,needClip:u}=Hp(t,r);if(!u)return null;var{x:m,y:f,width:h,height:x}=a;return g.createElement("clipPath",{id:"clipPath-".concat(n)},g.createElement("rect",{x:i?m:m-h/2,y:o?f:f-x/2,width:i?h:h*2,height:o?x:x*2}))}var hle=["onMouseEnter","onMouseLeave","onClick"],mle=["value","background","tooltipPosition"],ple=["onMouseEnter","onClick","onMouseLeave"];function hf(){return hf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},hf.apply(null,arguments)}function y3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Pn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?y3(Object(r),!0).forEach(function(n){qp(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qp(e,t,r){return(t=xle(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xle(e){var t=vle(e,"string");return typeof t=="symbol"?t:t+""}function vle(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jb(e,t){if(e==null)return{};var r,n,a=gle(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function gle(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var yle=e=>{var{dataKey:t,name:r,fill:n,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:n,value:Bs(r,t),payload:e}]};function ble(e){var{dataKey:t,stroke:r,strokeWidth:n,fill:a,name:i,hide:o,unit:u}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:n,fill:a,dataKey:t,nameKey:void 0,name:Bs(i,t),hide:o,type:e.tooltipType,color:e.fill,unit:u}}}function wle(e){var t=lt(Qi),{data:r,dataKey:n,background:a,allOtherBarProps:i}=e,{onMouseEnter:o,onMouseLeave:u,onClick:m}=i,f=jb(i,hle),h=$f(o,n),x=zf(u),v=Hf(m,n);if(!a||r==null)return null;var y=kt(a,!1);return g.createElement(g.Fragment,null,r.map((w,b)=>{var{value:S,background:N,tooltipPosition:_}=w,A=jb(w,mle);if(!N)return null;var k=h(w,b),C=x(w,b),O=v(w,b),T=Pn(Pn(Pn(Pn(Pn({option:a,isActive:String(b)===t},A),{},{fill:"#eee"},N),y),Pl(f,w,b)),{},{onMouseEnter:k,onMouseLeave:C,onClick:O,dataKey:n,index:b,className:"recharts-bar-background-rectangle"});return g.createElement(BR,hf({key:"background-bar-".concat(b)},T))}))}function UR(e){var{data:t,props:r,showLabels:n}=e,a=kt(r,!1),{shape:i,dataKey:o,activeBar:u}=r,m=lt(Qi),f=lt(tR),{onMouseEnter:h,onClick:x,onMouseLeave:v}=r,y=jb(r,ple),w=$f(h,o),b=zf(v),S=Hf(x,o);return t?g.createElement(g.Fragment,null,t.map((N,_)=>{var A=u&&String(_)===m&&(f==null||o===f),k=A?u:i,C=Pn(Pn(Pn({},a),N),{},{isActive:A,option:k,index:_,dataKey:o});return g.createElement(mr,hf({className:"recharts-bar-rectangle"},Pl(y,N,_),{onMouseEnter:w(N,_),onMouseLeave:b(N,_),onClick:S(N,_),key:"rectangle-".concat(N?.x,"-").concat(N?.y,"-").concat(N?.value,"-").concat(_)}),g.createElement(BR,C))}),n&&Gi.renderCallByParent(r,t)):null}function Sle(e){var{props:t,previousRectanglesRef:r}=e,{data:n,layout:a,isAnimationActive:i,animationBegin:o,animationDuration:u,animationEasing:m,onAnimationEnd:f,onAnimationStart:h}=t,x=r.current,v=Vf(t,"recharts-bar-"),[y,w]=g.useState(!1),b=g.useCallback(()=>{typeof f=="function"&&f(),w(!1)},[f]),S=g.useCallback(()=>{typeof h=="function"&&h(),w(!0)},[h]);return g.createElement(Xi,{begin:o,duration:u,isActive:i,easing:m,from:{t:0},to:{t:1},onAnimationEnd:b,onAnimationStart:S,key:v},N=>{var{t:_}=N,A=_===1?n:n.map((k,C)=>{var O=x&&x[C];if(O){var T=Kr(O.x,k.x),z=Kr(O.y,k.y),P=Kr(O.width,k.width),Z=Kr(O.height,k.height);return Pn(Pn({},k),{},{x:T(_),y:z(_),width:P(_),height:Z(_)})}if(a==="horizontal"){var q=Kr(0,k.height),B=q(_);return Pn(Pn({},k),{},{y:k.y+k.height-B,height:B})}var fe=Kr(0,k.width),Ne=fe(_);return Pn(Pn({},k),{},{width:Ne})});return _>0&&(r.current=A),g.createElement(mr,null,g.createElement(UR,{props:t,data:A,showLabels:!y}))})}function jle(e){var{data:t,isAnimationActive:r}=e,n=g.useRef(null);return r&&t&&t.length&&(n.current==null||n.current!==t)?g.createElement(Sle,{previousRectanglesRef:n,props:e}):g.createElement(UR,{props:e,data:t,showLabels:!0})}var $R=0,Nle=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:Jt(e,t)}};class Ele extends g.PureComponent{constructor(){super(...arguments),qp(this,"id",Dl("recharts-bar-"))}render(){var{hide:t,data:r,dataKey:n,className:a,xAxisId:i,yAxisId:o,needClip:u,background:m,id:f,layout:h}=this.props;if(t)return null;var x=$t("recharts-bar",a),v=qt(f)?this.id:f;return g.createElement(mr,{className:x},u&&g.createElement("defs",null,g.createElement(nS,{clipPathId:v,xAxisId:i,yAxisId:o})),g.createElement(mr,{className:"recharts-bar-rectangles",clipPath:u?"url(#clipPath-".concat(v,")"):null},g.createElement(wle,{data:r,dataKey:n,background:m,allOtherBarProps:this.props}),g.createElement(jle,this.props)),g.createElement(FR,{direction:h==="horizontal"?"y":"x"},this.props.children))}}var zR={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!zs.isSsr,legendType:"rect",minPointSize:$R,xAxisId:0,yAxisId:0};function Ale(e){var{xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:o,animationBegin:u,animationDuration:m,animationEasing:f,isAnimationActive:h}=da(e,zR),{needClip:x}=Hp(t,r),v=xp(),y=$n(),w=g.useMemo(()=>({barSize:e.barSize,data:void 0,dataKey:e.dataKey,maxBarSize:e.maxBarSize,minPointSize:i,stackId:Y6(e.stackId)}),[e.barSize,e.dataKey,e.maxBarSize,i,e.stackId]),b=Lo(e.children,ns),S=lt(A=>Zle(A,t,r,y,w,b));if(v!=="vertical"&&v!=="horizontal")return null;var N,_=S?.[0];return _==null||_.height==null||_.width==null?N=0:N=v==="vertical"?_.height/2:_.width/2,g.createElement(tS,{xAxisId:t,yAxisId:r,data:S,dataPointFormatter:Nle,errorBarOffset:N},g.createElement(Ele,hf({},e,{layout:v,needClip:x,data:S,xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:o,animationBegin:u,animationDuration:m,animationEasing:f,isAnimationActive:h})))}function _le(e){var{layout:t,barSettings:{dataKey:r,minPointSize:n},pos:a,bandSize:i,xAxis:o,yAxis:u,xAxisTicks:m,yAxisTicks:f,stackedData:h,displayedData:x,offset:v,cells:y}=e,w=t==="horizontal"?u:o,b=h?w.scale.domain():null,S=Z6({numericAxis:w});return x.map((N,_)=>{var A,k,C,O,T,z;h?A=X6(h[_],b):(A=Jt(N,r),Array.isArray(A)||(A=[S,A]));var P=fle(n,$R)(A[1],_);if(t==="horizontal"){var Z,[q,B]=[u.scale(A[0]),u.scale(A[1])];k=hm({axis:o,ticks:m,bandSize:i,offset:a.offset,entry:N,index:_}),C=(Z=B??q)!==null&&Z!==void 0?Z:void 0,O=a.size;var fe=q-B;if(T=Fa(fe)?0:fe,z={x:k,y:v.top,width:O,height:v.height},Math.abs(P)>0&&Math.abs(T)<Math.abs(P)){var Ne=Gr(T||P)*(Math.abs(P)-Math.abs(T));C-=Ne,T+=Ne}}else{var[he,K]=[o.scale(A[0]),o.scale(A[1])];if(k=he,C=hm({axis:u,ticks:f,bandSize:i,offset:a.offset,entry:N,index:_}),O=K-he,T=a.size,z={x:v.left,y:C,width:v.width,height:T},Math.abs(P)>0&&Math.abs(O)<Math.abs(P)){var H=Gr(O||P)*(Math.abs(P)-Math.abs(O));O+=H}}var be=Pn(Pn({},N),{},{x:k,y:C,width:O,height:T,value:h?A:A[1],payload:N,background:z,tooltipPosition:{x:k+O/2,y:C+T/2}},y&&y[_]&&y[_].props);return be})}class Ji extends g.PureComponent{render(){return g.createElement(rS,{type:"bar",data:null,xAxisId:this.props.xAxisId,yAxisId:this.props.yAxisId,zAxisId:0,dataKey:this.props.dataKey,stackId:this.props.stackId,hide:this.props.hide,barSize:this.props.barSize},g.createElement(OR,null),g.createElement(Jw,{legendPayload:yle(this.props)}),g.createElement(qf,{fn:ble,args:this.props}),g.createElement(Ale,this.props))}}qp(Ji,"displayName","Bar");qp(Ji,"defaultProps",zR);function b3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Eh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?b3(Object(r),!0).forEach(function(n){Tle(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Tle(e,t,r){return(t=kle(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kle(e){var t=Cle(e,"string");return typeof t=="symbol"?t:t+""}function Cle(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ole=(e,t)=>t,Dle=(e,t,r)=>r,Ple=(e,t,r,n)=>n,aS=(e,t,r,n,a)=>a,Rle=(e,t,r,n,a)=>a.maxBarSize,Mle=(e,t,r,n,a,i)=>i,w3=(e,t,r)=>{var n=r??e;if(!qt(n))return Zn(n,t,0)},Fle=_e([Ct,Mf,Ole,Dle,Ple],(e,t,r,n,a)=>t.filter(i=>e==="horizontal"?i.xAxisId===r:i.yAxisId===n).filter(i=>i.isPanorama===a).filter(i=>i.hide===!1).filter(i=>i.type==="bar")),Ile=(e,t,r,n)=>{var a=Ct(e);return a==="horizontal"?hb(e,"yAxis",r,n):hb(e,"xAxis",t,n)},Lle=(e,t,r)=>{var n=Ct(e);return n==="horizontal"?Sk(e,"xAxis",t):Sk(e,"yAxis",r)};function Ble(e){return e.stackId!=null&&e.dataKey!=null}var HR=(e,t,r)=>{var n={},a=e.filter(Ble),i=e.filter(f=>f.stackId==null),o=a.reduce((f,h)=>(f[h.stackId]||(f[h.stackId]=[]),f[h.stackId].push(h),f),n),u=Object.entries(o).map(f=>{var[h,x]=f,v=x.map(w=>w.dataKey),y=w3(t,r,x[0].barSize);return{stackId:h,dataKeys:v,barSize:y}}),m=i.map(f=>{var h=[f.dataKey].filter(v=>v!=null),x=w3(t,r,f.barSize);return{stackId:void 0,dataKeys:h,barSize:x}});return[...u,...m]},Ule=_e([Fle,lP,Lle],HR),$le=(e,t,r,n,a)=>{var i,o,u=Ct(e),m=_p(e),{maxBarSize:f}=a,h=qt(f)?m:f,x,v;return u==="horizontal"?(x=di(e,"xAxis",t,n),v=Zi(e,"xAxis",t,n)):(x=di(e,"yAxis",r,n),v=Zi(e,"yAxis",r,n)),(i=(o=Ps(x,v,!0))!==null&&o!==void 0?o:h)!==null&&i!==void 0?i:0},qR=(e,t,r,n)=>{var a=Ct(e),i,o;return a==="horizontal"?(i=di(e,"xAxis",t,n),o=Zi(e,"xAxis",t,n)):(i=di(e,"yAxis",r,n),o=Zi(e,"yAxis",r,n)),Ps(i,o)};function zle(e,t,r,n,a){var i=n.length;if(!(i<1)){var o=Zn(e,r,0,!0),u,m=[];if(Ba(n[0].barSize)){var f=!1,h=r/i,x=n.reduce((N,_)=>N+(_.barSize||0),0);x+=(i-1)*o,x>=r&&(x-=(i-1)*o,o=0),x>=r&&h>0&&(f=!0,h*=.9,x=i*h);var v=(r-x)/2>>0,y={offset:v-o,size:0};u=n.reduce((N,_)=>{var A,k={stackId:_.stackId,dataKeys:_.dataKeys,position:{offset:y.offset+y.size+o,size:f?h:(A=_.barSize)!==null&&A!==void 0?A:0}},C=[...N,k];return y=C[C.length-1].position,C},m)}else{var w=Zn(t,r,0,!0);r-2*w-(i-1)*o<=0&&(o=0);var b=(r-2*w-(i-1)*o)/i;b>1&&(b>>=0);var S=Ba(a)?Math.min(b,a):b;u=n.reduce((N,_,A)=>[...N,{stackId:_.stackId,dataKeys:_.dataKeys,position:{offset:w+(b+o)*A+(b-S)/2,size:S}}],m)}return u}}var VR=(e,t,r,n,a,i,o)=>{var u=qt(o)?t:o,m=zle(r,n,a!==i?a:i,e,u);return a!==i&&m!=null&&(m=m.map(f=>Eh(Eh({},f),{},{position:Eh(Eh({},f.position),{},{offset:f.position.offset-a/2})}))),m},Hle=_e([Ule,_p,sP,vw,$le,qR,Rle],VR),qle=(e,t,r,n)=>di(e,"xAxis",t,n),Vle=(e,t,r,n)=>di(e,"yAxis",r,n),Kle=(e,t,r,n)=>Zi(e,"xAxis",t,n),Gle=(e,t,r,n)=>Zi(e,"yAxis",r,n),Wle=_e([Hle,aS],(e,t)=>{if(e!=null){var r=e.find(n=>n.stackId===t.stackId&&n.dataKeys.includes(t.dataKey));if(r!=null)return r.position}}),KR=(e,t)=>{if(!(!e||t?.dataKey==null)){var{stackId:r}=t;if(r!=null){var n=e[r];if(n){var{stackedData:a}=n;if(a){var i=a.find(o=>o.key===t.dataKey);return i}}}}},Xle=_e([Mf,aS],(e,t)=>{if(e.some(r=>r.type==="bar"&&t.dataKey===r.dataKey&&t.stackId===r.stackId&&t.stackId===r.stackId))return t}),Yle=_e([Ile,aS],KR),Zle=_e([nn,qle,Vle,Kle,Gle,Wle,Ct,Ep,qR,Yle,Xle,Mle],(e,t,r,n,a,i,o,u,m,f,h,x)=>{var{chartData:v,dataStartIndex:y,dataEndIndex:w}=u;if(!(h==null||i==null||o!=="horizontal"&&o!=="vertical"||t==null||r==null||n==null||a==null||m==null)){var{data:b}=h,S;if(b!=null&&b.length>0?S=b:S=v?.slice(y,w+1),S!=null)return _le({layout:o,barSettings:h,pos:i,bandSize:m,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:a,stackedData:f,displayedData:S,offset:e,cells:x})}});function S3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Dm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?S3(Object(r),!0).forEach(function(n){Qle(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Qle(e,t,r){return(t=Jle(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Jle(e){var t=eoe(e,"string");return typeof t=="symbol"?t:t+""}function eoe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var toe=(e,t)=>Pf(e,t),roe=(e,t)=>$p(e,"radiusAxis",t),Vp=_e([toe,roe],(e,t)=>{if(!(e==null||t==null))return Dm(Dm({},e),{},{scale:t})}),iS=(e,t,r,n)=>Eie(e,"radiusAxis",t,n),noe=(e,t,r)=>Df(e,r),aoe=(e,t,r)=>$p(e,"angleAxis",r),Kp=_e([noe,aoe],(e,t)=>{if(!(e==null||t==null))return Dm(Dm({},e),{},{scale:t})}),sS=(e,t,r,n)=>Nie(e,"angleAxis",r,n),ioe=(e,t,r,n)=>n,lS=_e([Lp,ioe],(e,t)=>{if(e.some(r=>r.type==="radialBar"&&t.dataKey===r.dataKey&&t.stackId===r.stackId))return t}),GR=_e([Ct,Vp,iS,Kp,sS],(e,t,r,n,a)=>Ls(e,"radiusAxis")?Ps(t,r,!1):Ps(n,a,!1)),soe=_e([Kp,Vp,Ct],(e,t,r)=>{var n=r==="radial"?e:t;if(!(n==null||n.scale==null))return Z6({numericAxis:n})}),loe=(e,t,r,n,a)=>a,ooe=(e,t,r,n,a)=>r,coe=(e,t,r,n,a)=>t,WR=(e,t,r,n,a)=>n.maxBarSize,uoe=_e([Ct,Lp,ooe,coe],(e,t,r,n)=>t.filter(a=>e==="centric"?a.angleAxisId===r:a.radiusAxisId===n).filter(a=>a.hide===!1).filter(a=>a.type==="radialBar")),doe=()=>{},foe=_e([uoe,lP,doe],HR),hoe=_e([Ct,_p,Kp,sS,Vp,iS,WR],(e,t,r,n,a,i,o)=>{var u,m,f=qt(o)?t:o;if(e==="centric"){var h,x;return(h=(x=Ps(r,n,!0))!==null&&x!==void 0?x:f)!==null&&h!==void 0?h:0}return(u=(m=Ps(a,i,!0))!==null&&m!==void 0?m:f)!==null&&u!==void 0?u:0}),moe=_e([foe,_p,sP,vw,hoe,GR,WR],VR),poe=_e([moe,lS],(e,t)=>{if(!(e==null||t==null)){var r=e.find(n=>n.stackId===t.stackId&&t.dataKey!=null&&n.dataKeys.includes(t.dataKey));if(r!=null)return r.position}}),j3=_e([Up,Bp,cu],Tw),xoe=(e,t,r)=>{var n=Ct(e);return n==="centric"?j3(e,"radiusAxis",t):j3(e,"angleAxis",r)},voe=_e([xoe,lS],KR),goe=_e([Kp,sS,Vp,iS,Fl,lS,GR,Ct,soe,hP,loe,poe,voe],(e,t,r,n,a,i,o,u,m,f,h,x,v)=>{var{chartData:y,dataStartIndex:w,dataEndIndex:b}=a;if(i==null||r==null||e==null||y==null||o==null||x==null||u!=="centric"&&u!=="radial"||n==null)return[];var{dataKey:S,minPointSize:N}=i,{cx:_,cy:A,startAngle:k,endAngle:C}=f,O=y.slice(w,b+1),T=u==="centric"?r:e,z=v?T.scale.domain():null;return Doe({angleAxis:e,angleAxisTicks:t,bandSize:o,baseValue:m,cells:h,cx:_,cy:A,dataKey:S,dataStartIndex:w,displayedData:O,endAngle:C,layout:u,minPointSize:N,pos:x,radiusAxis:r,radiusAxisTicks:n,stackedData:v,stackedDomain:z,startAngle:k})}),yoe=_e([Np,(e,t)=>t],(e,t)=>{var{chartData:r,dataStartIndex:n,dataEndIndex:a}=e;if(r==null)return[];var i=r.slice(n,a+1);return i.length===0?[]:i.map(o=>({type:t,value:o.name,color:o.fill,payload:o}))}),boe=["shape","activeShape","cornerRadius"],woe=["onMouseEnter","onClick","onMouseLeave"],Soe=["value","background"];function Nb(){return Nb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Nb.apply(null,arguments)}function N3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function mn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?N3(Object(r),!0).forEach(function(n){oS(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function oS(e,t,r){return(t=joe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function joe(e){var t=Noe(e,"string");return typeof t=="symbol"?t:t+""}function Noe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Eb(e,t){if(e==null)return{};var r,n,a=Eoe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Eoe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Ab=[];function XR(e){var{sectors:t,allOtherRadialBarProps:r,showLabels:n}=e,{shape:a,activeShape:i,cornerRadius:o}=r,u=Eb(r,boe),m=kt(u,!1),f=lt(Qi),{onMouseEnter:h,onClick:x,onMouseLeave:v}=r,y=Eb(r,woe),w=$f(h,r.dataKey),b=zf(v),S=Hf(x,r.dataKey);return t==null?null:g.createElement(g.Fragment,null,t.map((N,_)=>{var A=i&&f===String(_),k=w(N,_),C=b(N,_),O=S(N,_),T=mn(mn(mn(mn({},m),{},{cornerRadius:kR(o)},N),Pl(y,N,_)),{},{onMouseEnter:k,onMouseLeave:C,onClick:O,key:"sector-".concat(_),className:"recharts-radial-bar-sector ".concat(N.className),forceCornerRadius:u.forceCornerRadius,cornerIsExternal:u.cornerIsExternal,isActive:A,option:A?i:a});return g.createElement(CR,T)}),n&&Gi.renderCallByParent(r,t))}function Aoe(e){var{props:t,previousSectorsRef:r}=e,{data:n,isAnimationActive:a,animationBegin:i,animationDuration:o,animationEasing:u,onAnimationEnd:m,onAnimationStart:f}=t,h=Vf(t,"recharts-radialbar-"),x=r.current,[v,y]=g.useState(!0),w=g.useCallback(()=>{typeof m=="function"&&m(),y(!1)},[m]),b=g.useCallback(()=>{typeof f=="function"&&f(),y(!0)},[f]);return g.createElement(Xi,{begin:i,duration:o,isActive:a,easing:u,from:{t:0},to:{t:1},onAnimationStart:b,onAnimationEnd:w,key:h},S=>{var{t:N}=S,_=N===1?n:(n??Ab).map((A,k)=>{var C=x&&x[k];if(C){var O=Kr(C.startAngle,A.startAngle),T=Kr(C.endAngle,A.endAngle);return mn(mn({},A),{},{startAngle:O(N),endAngle:T(N)})}var{endAngle:z,startAngle:P}=A,Z=Kr(P,z);return mn(mn({},A),{},{endAngle:Z(N)})});return N>0&&(r.current=_??null),g.createElement(mr,null,g.createElement(XR,{sectors:_??Ab,allOtherRadialBarProps:t,showLabels:!v}))})}function _oe(e){var{data:t=[],isAnimationActive:r}=e,n=g.useRef(null),a=n.current;return r&&t&&t.length&&(!a||a!==t)?g.createElement(Aoe,{props:e,previousSectorsRef:n}):g.createElement(XR,{sectors:t,allOtherRadialBarProps:e,showLabels:!0})}function Toe(e){var t=lt(r=>yoe(r,e.legendType));return g.createElement(AR,{legendPayload:t??[]})}function koe(e){var{dataKey:t,data:r,stroke:n,strokeWidth:a,name:i,hide:o,fill:u,tooltipType:m}=e;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:n,strokeWidth:a,fill:u,nameKey:void 0,dataKey:t,name:Bs(i,t),hide:o,type:m,color:u,unit:""}}}class Coe extends g.PureComponent{renderBackground(t){if(t==null)return null;var{cornerRadius:r}=this.props,n=kt(this.props.background,!1);return t.map((a,i)=>{var{value:o,background:u}=a,m=Eb(a,Soe);if(!u)return null;var f=mn(mn(mn(mn(mn({cornerRadius:kR(r)},m),{},{fill:"#eee"},u),n),Pl(this.props,a,i)),{},{index:i,key:"sector-".concat(i),className:$t("recharts-radial-bar-background-sector",n?.className),option:u,isActive:!1});return g.createElement(CR,f)})}render(){var{hide:t,data:r,className:n,background:a}=this.props;if(t)return null;var i=$t("recharts-area",n);return g.createElement(mr,{className:i},a&&g.createElement(mr,{className:"recharts-radial-bar-background"},this.renderBackground(r)),g.createElement(mr,{className:"recharts-radial-bar-sectors"},g.createElement(_oe,this.props)))}}function Ooe(e){var t,r=Lo(e.children,ns),n={dataKey:e.dataKey,minPointSize:e.minPointSize,stackId:e.stackId,maxBarSize:e.maxBarSize,barSize:e.barSize},a=(t=lt(i=>goe(i,e.radiusAxisId,e.angleAxisId,n,r)))!==null&&t!==void 0?t:Ab;return g.createElement(g.Fragment,null,g.createElement(qf,{fn:koe,args:mn(mn({},e),{},{data:a})}),g.createElement(Coe,Nb({},e,{data:a})))}var Ih={angleAxisId:0,radiusAxisId:0,minPointSize:0,hide:!1,legendType:"rect",data:[],isAnimationActive:!zs.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease",forceCornerRadius:!1,cornerIsExternal:!1};function Doe(e){var{displayedData:t,stackedData:r,dataStartIndex:n,stackedDomain:a,dataKey:i,baseValue:o,layout:u,radiusAxis:m,radiusAxisTicks:f,bandSize:h,pos:x,angleAxis:v,minPointSize:y,cx:w,cy:b,angleAxisTicks:S,cells:N,startAngle:_,endAngle:A}=e;return(t??[]).map((k,C)=>{var O,T,z,P,Z,q;if(r?O=X6(r[n+C],a):(O=Jt(k,i),Array.isArray(O)||(O=[o,O])),u==="radial"){T=hm({axis:m,ticks:f,bandSize:h,offset:x.offset,entry:k,index:C}),Z=v.scale(O[1]),P=v.scale(O[0]),z=(T??0)+x.size;var B=Z-P;if(Math.abs(y)>0&&Math.abs(B)<Math.abs(y)){var fe=Gr(B||y)*(Math.abs(y)-Math.abs(B));Z+=fe}q={background:{cx:w,cy:b,innerRadius:T,outerRadius:z,startAngle:_,endAngle:A}}}else{T=m.scale(O[0]),z=m.scale(O[1]),P=hm({axis:v,ticks:S,bandSize:h,offset:x.offset,entry:k,index:C}),Z=(P??0)+x.size;var Ne=z-T;if(Math.abs(y)>0&&Math.abs(Ne)<Math.abs(y)){var he=Gr(Ne||y)*(Math.abs(y)-Math.abs(Ne));z+=he}}return mn(mn(mn({},k),q),{},{payload:k,value:r?O:O[1],cx:w,cy:b,innerRadius:T,outerRadius:z,startAngle:P,endAngle:Z},N&&N[C]&&N[C].props)})}class cS extends g.PureComponent{render(){var t,r,n;return g.createElement(g.Fragment,null,g.createElement(OR,null),g.createElement(Lse,{data:void 0,dataKey:this.props.dataKey,hide:(t=this.props.hide)!==null&&t!==void 0?t:Ih.hide,angleAxisId:(r=this.props.angleAxisId)!==null&&r!==void 0?r:Ih.angleAxisId,radiusAxisId:(n=this.props.radiusAxisId)!==null&&n!==void 0?n:Ih.radiusAxisId,stackId:this.props.stackId,barSize:this.props.barSize,type:"radialBar"}),g.createElement(Toe,this.props),g.createElement(Ooe,this.props))}}oS(cS,"displayName","RadialBar");oS(cS,"defaultProps",Ih);var YR=e=>{var{chartData:t}=e,r=br(),n=$n();return g.useEffect(()=>n?()=>{}:(r(Dk(t)),()=>{r(Dk(void 0))}),[t,r,n]),null},E3={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},ZR=pi({name:"brush",initialState:E3,reducers:{setBrushSettings(e,t){return t.payload==null?E3:t.payload}}}),{setBrushSettings:Ehe}=ZR.actions,Poe=ZR.reducer;function Roe(e,t,r){return(t=Moe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Moe(e){var t=Foe(e,"string");return typeof t=="symbol"?t:t+""}function Foe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class uS{static create(t){return new uS(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(n)switch(n){case"start":return this.scale(t);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+a}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(t)+i}default:return this.scale(t)}if(r){var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+o}return this.scale(t)}}isInRange(t){var r=this.range(),n=r[0],a=r[r.length-1];return n<=a?t>=n&&t<=a:t>=a&&t<=n}}Roe(uS,"EPS",1e-4);function Ioe(e){return(e%180+180)%180}var Loe=function(t){var{width:r,height:n}=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=Ioe(a),o=i*Math.PI/180,u=Math.atan(n/r),m=o>u&&o<Math.PI-u?n/Math.sin(o):r/Math.cos(o);return Math.abs(m)},Boe={dots:[],areas:[],lines:[]},QR=pi({name:"referenceElements",initialState:Boe,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=ks(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=ks(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=ks(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:Ahe,removeDot:_he,addArea:The,removeArea:khe,addLine:Che,removeLine:Ohe}=QR.actions,Uoe=QR.reducer,$oe=g.createContext(void 0),zoe=e=>{var{children:t}=e,[r]=g.useState("".concat(Dl("recharts"),"-clip")),n=eS();if(n==null)return null;var{x:a,y:i,width:o,height:u}=n;return g.createElement($oe.Provider,{value:r},g.createElement("defs",null,g.createElement("clipPath",{id:r},g.createElement("rect",{x:a,y:i,height:u,width:o}))),t)};function ry(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function JR(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],a=0;a<e.length;a+=t)n.push(e[a]);return n}function Hoe(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return Loe(n,r)}function qoe(e,t,r){var n=r==="width",{x:a,y:i,width:o,height:u}=e;return t===1?{start:n?a:i,end:n?a+o:i+u}:{start:n?a+o:i+u,end:n?a:i}}function Pm(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var i=r();return e*(t-e*i/2-n)>=0&&e*(t+e*i/2-a)<=0}function Voe(e,t){return JR(e,t+1)}function Koe(e,t,r,n,a){for(var i=(n||[]).slice(),{start:o,end:u}=t,m=0,f=1,h=o,x=function(){var w=n?.[m];if(w===void 0)return{v:JR(n,f)};var b=m,S,N=()=>(S===void 0&&(S=r(w,b)),S),_=w.coordinate,A=m===0||Pm(e,_,N,h,u);A||(m=0,h=o,f+=1),A&&(h=_+e*(N()/2+a),m+=f)},v;f<=i.length;)if(v=x(),v)return v.v;return[]}function A3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function On(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?A3(Object(r),!0).forEach(function(n){Goe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Goe(e,t,r){return(t=Woe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Woe(e){var t=Xoe(e,"string");return typeof t=="symbol"?t:t+""}function Xoe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yoe(e,t,r,n,a){for(var i=(n||[]).slice(),o=i.length,{start:u}=t,{end:m}=t,f=function(v){var y=i[v],w,b=()=>(w===void 0&&(w=r(y,v)),w);if(v===o-1){var S=e*(y.coordinate+e*b()/2-m);i[v]=y=On(On({},y),{},{tickCoord:S>0?y.coordinate-S*e:y.coordinate})}else i[v]=y=On(On({},y),{},{tickCoord:y.coordinate});var N=Pm(e,y.tickCoord,b,u,m);N&&(m=y.tickCoord-e*(b()/2+a),i[v]=On(On({},y),{},{isShow:!0}))},h=o-1;h>=0;h--)f(h);return i}function Zoe(e,t,r,n,a,i){var o=(n||[]).slice(),u=o.length,{start:m,end:f}=t;if(i){var h=n[u-1],x=r(h,u-1),v=e*(h.coordinate+e*x/2-f);o[u-1]=h=On(On({},h),{},{tickCoord:v>0?h.coordinate-v*e:h.coordinate});var y=Pm(e,h.tickCoord,()=>x,m,f);y&&(f=h.tickCoord-e*(x/2+a),o[u-1]=On(On({},h),{},{isShow:!0}))}for(var w=i?u-1:u,b=function(_){var A=o[_],k,C=()=>(k===void 0&&(k=r(A,_)),k);if(_===0){var O=e*(A.coordinate-e*C()/2-m);o[_]=A=On(On({},A),{},{tickCoord:O<0?A.coordinate-O*e:A.coordinate})}else o[_]=A=On(On({},A),{},{tickCoord:A.coordinate});var T=Pm(e,A.tickCoord,C,m,f);T&&(m=A.tickCoord+e*(C()/2+a),o[_]=On(On({},A),{},{isShow:!0}))},S=0;S<w;S++)b(S);return o}function dS(e,t,r){var{tick:n,ticks:a,viewBox:i,minTickGap:o,orientation:u,interval:m,tickFormatter:f,unit:h,angle:x}=e;if(!a||!a.length||!n)return[];if(ot(m)||zs.isSsr){var v;return(v=Voe(a,ot(m)?m:0))!==null&&v!==void 0?v:[]}var y=[],w=u==="top"||u==="bottom"?"width":"height",b=h&&w==="width"?Ud(h,{fontSize:t,letterSpacing:r}):{width:0,height:0},S=(A,k)=>{var C=typeof f=="function"?f(A.value,k):A.value;return w==="width"?Hoe(Ud(C,{fontSize:t,letterSpacing:r}),b,x):Ud(C,{fontSize:t,letterSpacing:r})[w]},N=a.length>=2?Gr(a[1].coordinate-a[0].coordinate):1,_=qoe(i,N,w);return m==="equidistantPreserveStart"?Koe(N,_,S,a,o):(m==="preserveStart"||m==="preserveStartEnd"?y=Zoe(N,_,S,a,o,m==="preserveStartEnd"):y=Yoe(N,_,S,a,o),y.filter(A=>A.isShow))}var Qoe=["viewBox"],Joe=["viewBox"];function Oc(){return Oc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Oc.apply(null,arguments)}function _3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Jr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_3(Object(r),!0).forEach(function(n){fS(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function T3(e,t){if(e==null)return{};var r,n,a=ece(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function ece(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function fS(e,t,r){return(t=tce(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tce(e){var t=rce(e,"string");return typeof t=="symbol"?t:t+""}function rce(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class Bl extends g.Component{constructor(t){super(t),this.tickRefs=g.createRef(),this.tickRefs.current=[],this.state={fontSize:"",letterSpacing:""}}shouldComponentUpdate(t,r){var{viewBox:n}=t,a=T3(t,Qoe),i=this.props,{viewBox:o}=i,u=T3(i,Joe);return!ry(n,o)||!ry(a,u)||!ry(r,this.state)}getTickLineCoord(t){var{x:r,y:n,width:a,height:i,orientation:o,tickSize:u,mirror:m,tickMargin:f}=this.props,h,x,v,y,w,b,S=m?-1:1,N=t.tickSize||u,_=ot(t.tickCoord)?t.tickCoord:t.coordinate;switch(o){case"top":h=x=t.coordinate,y=n+ +!m*i,v=y-S*N,b=v-S*f,w=_;break;case"left":v=y=t.coordinate,x=r+ +!m*a,h=x-S*N,w=h-S*f,b=_;break;case"right":v=y=t.coordinate,x=r+ +m*a,h=x+S*N,w=h+S*f,b=_;break;default:h=x=t.coordinate,y=n+ +m*i,v=y+S*N,b=v+S*f,w=_;break}return{line:{x1:h,y1:v,x2:x,y2:y},tick:{x:w,y:b}}}getTickTextAnchor(){var{orientation:t,mirror:r}=this.props,n;switch(t){case"left":n=r?"start":"end";break;case"right":n=r?"end":"start";break;default:n="middle";break}return n}getTickVerticalAnchor(){var{orientation:t,mirror:r}=this.props;switch(t){case"left":case"right":return"middle";case"top":return r?"start":"end";default:return r?"end":"start"}}renderAxisLine(){var{x:t,y:r,width:n,height:a,orientation:i,mirror:o,axisLine:u}=this.props,m=Jr(Jr(Jr({},kt(this.props,!1)),kt(u,!1)),{},{fill:"none"});if(i==="top"||i==="bottom"){var f=+(i==="top"&&!o||i==="bottom"&&o);m=Jr(Jr({},m),{},{x1:t,y1:r+f*a,x2:t+n,y2:r+f*a})}else{var h=+(i==="left"&&!o||i==="right"&&o);m=Jr(Jr({},m),{},{x1:t+h*n,y1:r,x2:t+h*n,y2:r+a})}return g.createElement("line",Oc({},m,{className:$t("recharts-cartesian-axis-line",Ol(u,"className"))}))}static renderTickItem(t,r,n){var a,i=$t(r.className,"recharts-cartesian-axis-tick-value");if(g.isValidElement(t))a=g.cloneElement(t,Jr(Jr({},r),{},{className:i}));else if(typeof t=="function")a=t(Jr(Jr({},r),{},{className:i}));else{var o="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(o=$t(o,t.className)),a=g.createElement(Ip,Oc({},r,{className:o}),n)}return a}renderTicks(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],{tickLine:a,stroke:i,tick:o,tickFormatter:u,unit:m}=this.props,f=dS(Jr(Jr({},this.props),{},{ticks:n}),t,r),h=this.getTickTextAnchor(),x=this.getTickVerticalAnchor(),v=kt(this.props,!1),y=kt(o,!1),w=Jr(Jr({},v),{},{fill:"none"},kt(a,!1)),b=f.map((S,N)=>{var{line:_,tick:A}=this.getTickLineCoord(S),k=Jr(Jr(Jr(Jr({textAnchor:h,verticalAnchor:x},v),{},{stroke:"none",fill:i},y),A),{},{index:N,payload:S,visibleTicksCount:f.length,tickFormatter:u});return g.createElement(mr,Oc({className:"recharts-cartesian-axis-tick",key:"tick-".concat(S.value,"-").concat(S.coordinate,"-").concat(S.tickCoord)},Pl(this.props,S,N)),a&&g.createElement("line",Oc({},w,_,{className:$t("recharts-cartesian-axis-tick-line",Ol(a,"className"))})),o&&Bl.renderTickItem(o,k,"".concat(typeof u=="function"?u(S.value,N):S.value).concat(m||"")))});return b.length>0?g.createElement("g",{className:"recharts-cartesian-axis-ticks"},b):null}render(){var{axisLine:t,width:r,height:n,className:a,hide:i}=this.props;if(i)return null;var{ticks:o}=this.props;return r!=null&&r<=0||n!=null&&n<=0?null:g.createElement(mr,{className:$t("recharts-cartesian-axis",a),ref:u=>{if(u){var m=u.getElementsByClassName("recharts-cartesian-axis-tick-value");this.tickRefs.current=Array.from(m);var f=m[0];if(f){var h=window.getComputedStyle(f).fontSize,x=window.getComputedStyle(f).letterSpacing;(h!==this.state.fontSize||x!==this.state.letterSpacing)&&this.setState({fontSize:window.getComputedStyle(f).fontSize,letterSpacing:window.getComputedStyle(f).letterSpacing})}}}},t&&this.renderAxisLine(),this.renderTicks(this.state.fontSize,this.state.letterSpacing,o),ka.renderCallByParent(this.props))}}fS(Bl,"displayName","CartesianAxis");fS(Bl,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var nce=["x1","y1","x2","y2","key"],ace=["offset"],ice=["xAxisId","yAxisId"],sce=["xAxisId","yAxisId"];function k3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Rn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?k3(Object(r),!0).forEach(function(n){lce(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lce(e,t,r){return(t=oce(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oce(e){var t=cce(e,"string");return typeof t=="symbol"?t:t+""}function cce(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function po(){return po=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},po.apply(null,arguments)}function Rm(e,t){if(e==null)return{};var r,n,a=uce(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function uce(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var dce=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:n,y:a,width:i,height:o,ry:u}=e;return g.createElement("rect",{x:n,y:a,ry:u,width:i,height:o,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function e8(e,t){var r;if(g.isValidElement(e))r=g.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var{x1:n,y1:a,x2:i,y2:o,key:u}=t,m=Rm(t,nce),f=kt(m,!1),{offset:h}=f,x=Rm(f,ace);r=g.createElement("line",po({},x,{x1:n,y1:a,x2:i,y2:o,fill:"none",key:u}))}return r}function fce(e){var{x:t,width:r,horizontal:n=!0,horizontalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:i,yAxisId:o}=e,u=Rm(e,ice),m=a.map((f,h)=>{var x=Rn(Rn({},u),{},{x1:t,y1:f,x2:t+r,y2:f,key:"line-".concat(h),index:h});return e8(n,x)});return g.createElement("g",{className:"recharts-cartesian-grid-horizontal"},m)}function hce(e){var{y:t,height:r,vertical:n=!0,verticalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:i,yAxisId:o}=e,u=Rm(e,sce),m=a.map((f,h)=>{var x=Rn(Rn({},u),{},{x1:f,y1:t,x2:f,y2:t+r,key:"line-".concat(h),index:h});return e8(n,x)});return g.createElement("g",{className:"recharts-cartesian-grid-vertical"},m)}function mce(e){var{horizontalFill:t,fillOpacity:r,x:n,y:a,width:i,height:o,horizontalPoints:u,horizontal:m=!0}=e;if(!m||!t||!t.length)return null;var f=u.map(x=>Math.round(x+a-a)).sort((x,v)=>x-v);a!==f[0]&&f.unshift(0);var h=f.map((x,v)=>{var y=!f[v+1],w=y?a+o-x:f[v+1]-x;if(w<=0)return null;var b=v%t.length;return g.createElement("rect",{key:"react-".concat(v),y:x,x:n,height:w,width:i,stroke:"none",fill:t[b],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return g.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},h)}function pce(e){var{vertical:t=!0,verticalFill:r,fillOpacity:n,x:a,y:i,width:o,height:u,verticalPoints:m}=e;if(!t||!r||!r.length)return null;var f=m.map(x=>Math.round(x+a-a)).sort((x,v)=>x-v);a!==f[0]&&f.unshift(0);var h=f.map((x,v)=>{var y=!f[v+1],w=y?a+o-x:f[v+1]-x;if(w<=0)return null;var b=v%r.length;return g.createElement("rect",{key:"react-".concat(v),x,y:i,width:w,height:u,stroke:"none",fill:r[b],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return g.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},h)}var xce=(e,t)=>{var{xAxis:r,width:n,height:a,offset:i}=e;return G6(dS(Rn(Rn(Rn({},Bl.defaultProps),r),{},{ticks:W6(r),viewBox:{x:0,y:0,width:n,height:a}})),i.left,i.left+i.width,t)},vce=(e,t)=>{var{yAxis:r,width:n,height:a,offset:i}=e;return G6(dS(Rn(Rn(Rn({},Bl.defaultProps),r),{},{ticks:W6(r),viewBox:{x:0,y:0,width:n,height:a}})),i.top,i.top+i.height,t)},gce={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function _l(e){var t=z2(),r=H2(),n=eD(),a=Rn(Rn({},da(e,gce)),{},{x:ot(e.x)?e.x:n.left,y:ot(e.y)?e.y:n.top,width:ot(e.width)?e.width:n.width,height:ot(e.height)?e.height:n.height}),{xAxisId:i,yAxisId:o,x:u,y:m,width:f,height:h,syncWithTicks:x,horizontalValues:v,verticalValues:y}=a,w=$n(),b=lt(P=>jk(P,"xAxis",i,w)),S=lt(P=>jk(P,"yAxis",o,w));if(!ot(f)||f<=0||!ot(h)||h<=0||!ot(u)||u!==+u||!ot(m)||m!==+m)return null;var N=a.verticalCoordinatesGenerator||xce,_=a.horizontalCoordinatesGenerator||vce,{horizontalPoints:A,verticalPoints:k}=a;if((!A||!A.length)&&typeof _=="function"){var C=v&&v.length,O=_({yAxis:S?Rn(Rn({},S),{},{ticks:C?v:S.ticks}):void 0,width:t,height:r,offset:n},C?!0:x);Bd(Array.isArray(O),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof O,"]")),Array.isArray(O)&&(A=O)}if((!k||!k.length)&&typeof N=="function"){var T=y&&y.length,z=N({xAxis:b?Rn(Rn({},b),{},{ticks:T?y:b.ticks}):void 0,width:t,height:r,offset:n},T?!0:x);Bd(Array.isArray(z),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof z,"]")),Array.isArray(z)&&(k=z)}return g.createElement("g",{className:"recharts-cartesian-grid"},g.createElement(dce,{fill:a.fill,fillOpacity:a.fillOpacity,x:a.x,y:a.y,width:a.width,height:a.height,ry:a.ry}),g.createElement(mce,po({},a,{horizontalPoints:A})),g.createElement(pce,po({},a,{verticalPoints:k})),g.createElement(fce,po({},a,{offset:n,horizontalPoints:A,xAxis:b,yAxis:S})),g.createElement(hce,po({},a,{offset:n,verticalPoints:k,xAxis:b,yAxis:S})))}_l.displayName="CartesianGrid";var t8=(e,t,r,n)=>di(e,"xAxis",t,n),r8=(e,t,r,n)=>Zi(e,"xAxis",t,n),n8=(e,t,r,n)=>di(e,"yAxis",r,n),a8=(e,t,r,n)=>Zi(e,"yAxis",r,n),yce=_e([Ct,t8,n8,r8,a8],(e,t,r,n,a)=>Ls(e,"xAxis")?Ps(t,n,!1):Ps(r,a,!1)),bce=(e,t,r,n,a)=>a,wce=_e([Mf,bce],(e,t)=>{if(e.some(r=>r.type==="line"&&t.dataKey===r.dataKey&&t.data===r.data))return t}),Sce=_e([Ct,t8,n8,r8,a8,wce,yce,Ep],(e,t,r,n,a,i,o,u)=>{var{chartData:m,dataStartIndex:f,dataEndIndex:h}=u;if(!(i==null||t==null||r==null||n==null||a==null||n.length===0||a.length===0||o==null)){var{dataKey:x,data:v}=i,y;if(v!=null&&v.length>0?y=v:y=m?.slice(f,h+1),y!=null)return $ce({layout:e,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:a,dataKey:x,bandSize:o,displayedData:y})}}),jce=["type","layout","connectNulls","needClip"],Nce=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId"];function i8(e,t){if(e==null)return{};var r,n,a=Ece(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Ece(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function C3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Si(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?C3(Object(r),!0).forEach(function(n){Gp(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Gp(e,t,r){return(t=Ace(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ace(e){var t=_ce(e,"string");return typeof t=="symbol"?t:t+""}function _ce(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wc(){return Wc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Wc.apply(null,arguments)}var Tce=e=>{var{dataKey:t,name:r,stroke:n,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:n,value:Bs(r,t),payload:e}]};function kce(e){var{dataKey:t,data:r,stroke:n,strokeWidth:a,fill:i,name:o,hide:u,unit:m}=e;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:n,strokeWidth:a,fill:i,dataKey:t,nameKey:void 0,name:Bs(o,t),hide:u,type:e.tooltipType,color:e.stroke,unit:m}}}var s8=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function Cce(e,t){for(var r=e.length%2!==0?[...e,0]:e,n=[],a=0;a<t;++a)n=[...n,...r];return n}var Oce=(e,t,r)=>{var n=r.reduce((x,v)=>x+v);if(!n)return s8(t,e);for(var a=Math.floor(e/n),i=e%n,o=t-e,u=[],m=0,f=0;m<r.length;f+=r[m],++m)if(f+r[m]>i){u=[...r.slice(0,m),i-f];break}var h=u.length%2===0?[0,o]:[o];return[...Cce(r,a),...u,...h].map(x=>"".concat(x,"px")).join(", ")};function Dce(e,t){var r;if(g.isValidElement(e))r=g.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var n=$t("recharts-line-dot",typeof e!="boolean"?e.className:"");r=g.createElement(xR,Wc({},t,{className:n}))}return r}function Pce(e,t){return e==null?!1:t?!0:e.length===1}function Rce(e){var{clipPathId:t,points:r,props:n}=e,{dot:a,dataKey:i,needClip:o}=n;if(!Pce(r,a))return null;var u=V5(a),m=kt(n,!1),f=kt(a,!0),h=r.map((v,y)=>{var w=Si(Si(Si({key:"dot-".concat(y),r:3},m),f),{},{index:y,cx:v.x,cy:v.y,dataKey:i,value:v.value,payload:v.payload,points:r});return Dce(a,w)}),x={clipPath:o?"url(#clipPath-".concat(u?"":"dots-").concat(t,")"):null};return g.createElement(mr,Wc({className:"recharts-line-dots",key:"dots"},x),h)}function _b(e){var{clipPathId:t,pathRef:r,points:n,strokeDasharray:a,props:i,showLabels:o}=e,{type:u,layout:m,connectNulls:f,needClip:h}=i,x=i8(i,jce),v=Si(Si({},kt(x,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:h?"url(#clipPath-".concat(t,")"):null,points:n,type:u,layout:m,connectNulls:f,strokeDasharray:a??i.strokeDasharray});return g.createElement(g.Fragment,null,n?.length>1&&g.createElement(vp,Wc({},v,{pathRef:r})),g.createElement(Rce,{points:n,clipPathId:t,props:i}),o&&Gi.renderCallByParent(i,n))}function Mce(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function Fce(e){var{clipPathId:t,props:r,pathRef:n,previousPointsRef:a,longestAnimatedLengthRef:i}=e,{points:o,strokeDasharray:u,isAnimationActive:m,animationBegin:f,animationDuration:h,animationEasing:x,animateNewValues:v,width:y,height:w,onAnimationEnd:b,onAnimationStart:S}=r,N=a.current,_=Vf(r,"recharts-line-"),[A,k]=g.useState(!1),C=g.useCallback(()=>{typeof b=="function"&&b(),k(!1)},[b]),O=g.useCallback(()=>{typeof S=="function"&&S(),k(!0)},[S]),T=Mce(n.current),z=i.current;return g.createElement(Xi,{begin:f,duration:h,isActive:m,easing:x,from:{t:0},to:{t:1},onAnimationEnd:C,onAnimationStart:O,key:_},P=>{var{t:Z}=P,q=Kr(z,T+z),B=Math.min(q(Z),T),fe;if(u){var Ne="".concat(u).split(/[,\s]+/gim).map(H=>parseFloat(H));fe=Oce(B,T,Ne)}else fe=s8(T,B);if(N){var he=N.length/o.length,K=Z===1?o:o.map((H,be)=>{var te=Math.floor(be*he);if(N[te]){var I=N[te],se=Kr(I.x,H.x),R=Kr(I.y,H.y);return Si(Si({},H),{},{x:se(Z),y:R(Z)})}if(v){var W=Kr(y*2,H.x),Y=Kr(w/2,H.y);return Si(Si({},H),{},{x:W(Z),y:Y(Z)})}return Si(Si({},H),{},{x:H.x,y:H.y})});return a.current=K,g.createElement(_b,{props:r,points:K,clipPathId:t,pathRef:n,showLabels:!A,strokeDasharray:fe})}return Z>0&&T>0&&(a.current=o,i.current=B),g.createElement(_b,{props:r,points:o,clipPathId:t,pathRef:n,showLabels:!A,strokeDasharray:fe})})}function Ice(e){var{clipPathId:t,props:r}=e,{points:n,isAnimationActive:a}=r,i=g.useRef(null),o=g.useRef(0),u=g.useRef(null),m=i.current;return a&&n&&n.length&&m!==n?g.createElement(Fce,{props:r,clipPathId:t,previousPointsRef:i,longestAnimatedLengthRef:o,pathRef:u}):g.createElement(_b,{props:r,points:n,clipPathId:t,pathRef:u,showLabels:!0})}var Lce=(e,t)=>({x:e.x,y:e.y,value:e.value,errorVal:Jt(e.payload,t)});class Bce extends g.Component{constructor(){super(...arguments),Gp(this,"id",Dl("recharts-line-"))}render(){var t,{hide:r,dot:n,points:a,className:i,xAxisId:o,yAxisId:u,top:m,left:f,width:h,height:x,id:v,needClip:y,layout:w}=this.props;if(r)return null;var b=$t("recharts-line",i),S=qt(v)?this.id:v,{r:N=3,strokeWidth:_=2}=(t=kt(n,!1))!==null&&t!==void 0?t:{r:3,strokeWidth:2},A=V5(n),k=N*2+_;return g.createElement(g.Fragment,null,g.createElement(mr,{className:b},y&&g.createElement("defs",null,g.createElement(nS,{clipPathId:S,xAxisId:o,yAxisId:u}),!A&&g.createElement("clipPath",{id:"clipPath-dots-".concat(S)},g.createElement("rect",{x:f-k/2,y:m-k/2,width:h+k,height:x+k}))),g.createElement(Ice,{props:this.props,clipPathId:S}),g.createElement(FR,{direction:w==="horizontal"?"y":"x"},g.createElement(tS,{xAxisId:o,yAxisId:u,data:a,dataPointFormatter:Lce,errorBarOffset:0},this.props.children))),g.createElement(Ise,{activeDot:this.props.activeDot,points:a,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var l8={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!zs.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0};function Uce(e){var t=da(e,l8),{activeDot:r,animateNewValues:n,animationBegin:a,animationDuration:i,animationEasing:o,connectNulls:u,dot:m,hide:f,isAnimationActive:h,label:x,legendType:v,xAxisId:y,yAxisId:w}=t,b=i8(t,Nce),{needClip:S}=Hp(y,w),{height:N,width:_,x:A,y:k}=eS(),C=xp(),O=$n(),T=g.useMemo(()=>({dataKey:e.dataKey,data:e.data}),[e.dataKey,e.data]),z=lt(P=>Sce(P,y,w,O,T));return C!=="horizontal"&&C!=="vertical"?null:g.createElement(Bce,Wc({},b,{connectNulls:u,dot:m,activeDot:r,animateNewValues:n,animationBegin:a,animationDuration:i,animationEasing:o,isAnimationActive:h,hide:f,label:x,legendType:v,xAxisId:y,yAxisId:w,points:z,layout:C,height:N,width:_,left:A,top:k,needClip:S}))}function $ce(e){var{layout:t,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:i,dataKey:o,bandSize:u,displayedData:m}=e;return m.map((f,h)=>{var x=Jt(f,o);return t==="horizontal"?{x:fm({axis:r,ticks:a,bandSize:u,entry:f,index:h}),y:qt(x)?null:n.scale(x),value:x,payload:f}:{x:qt(x)?null:r.scale(x),y:fm({axis:n,ticks:i,bandSize:u,entry:f,index:h}),value:x,payload:f}})}class Xc extends g.PureComponent{render(){return g.createElement(rS,{type:"line",data:this.props.data,xAxisId:this.props.xAxisId,yAxisId:this.props.yAxisId,zAxisId:0,dataKey:this.props.dataKey,stackId:void 0,hide:this.props.hide,barSize:void 0},g.createElement(Jw,{legendPayload:Tce(this.props)}),g.createElement(qf,{fn:kce,args:this.props}),g.createElement(Uce,this.props))}}Gp(Xc,"displayName","Line");Gp(Xc,"defaultProps",l8);function O3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function D3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?O3(Object(r),!0).forEach(function(n){zce(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zce(e,t,r){return(t=Hce(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hce(e){var t=qce(e,"string");return typeof t=="symbol"?t:t+""}function qce(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Vce={xAxis:{},yAxis:{},zAxis:{}},o8=pi({name:"cartesianAxis",initialState:Vce,reducers:{addXAxis(e,t){e.xAxis[t.payload.id]=t.payload},removeXAxis(e,t){delete e.xAxis[t.payload.id]},addYAxis(e,t){e.yAxis[t.payload.id]=t.payload},removeYAxis(e,t){delete e.yAxis[t.payload.id]},addZAxis(e,t){e.zAxis[t.payload.id]=t.payload},removeZAxis(e,t){delete e.zAxis[t.payload.id]},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload;e.yAxis[r]&&(e.yAxis[r]=D3(D3({},e.yAxis[r]),{},{width:n}))}}}),{addXAxis:Kce,removeXAxis:Gce,addYAxis:Wce,removeYAxis:Xce,addZAxis:Yce,removeZAxis:Zce,updateYAxisWidth:Qce}=o8.actions,Jce=o8.reducer;function c8(e,t,r){return(t=eue(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eue(e){var t=tue(e,"string");return typeof t=="symbol"?t:t+""}function tue(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rue(e){var t=br();return g.useEffect(()=>(t(Yce(e)),()=>{t(Zce(e))}),[e,t]),null}class Wp extends g.Component{render(){return g.createElement(rue,{domain:this.props.domain,id:this.props.zAxisId,dataKey:this.props.dataKey,name:this.props.name,unit:this.props.unit,range:this.props.range,scale:this.props.scale,type:this.props.type,allowDuplicatedCategory:Nl.allowDuplicatedCategory,allowDataOverflow:Nl.allowDataOverflow,reversed:Nl.reversed,includeHidden:Nl.includeHidden})}}c8(Wp,"displayName","ZAxis");c8(Wp,"defaultProps",{zAxisId:0,range:Nl.range,scale:Nl.scale,type:Nl.type});var nue=["option","isActive"];function $d(){return $d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$d.apply(null,arguments)}function aue(e,t){if(e==null)return{};var r,n,a=iue(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function iue(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function sue(e){var{option:t,isActive:r}=e,n=aue(e,nue);return typeof t=="string"?g.createElement(df,$d({option:g.createElement(ip,$d({type:t},n)),isActive:r,shapeType:"symbols"},n)):g.createElement(df,$d({option:t,isActive:r,shapeType:"symbols"},n))}var lue=(e,t,r,n,a,i,o)=>di(e,"xAxis",t,o),oue=(e,t,r,n,a,i,o)=>Zi(e,"xAxis",t,o),cue=(e,t,r,n,a,i,o)=>di(e,"yAxis",r,o),uue=(e,t,r,n,a,i,o)=>Zi(e,"yAxis",r,o),due=(e,t,r,n)=>Ure(e,"zAxis",n,!1),fue=(e,t,r,n,a)=>a,hue=(e,t,r,n,a,i)=>i,mue=(e,t,r,n,a,i,o)=>Ep(e,t,r,o),pue=_e([Mf,fue],(e,t)=>{if(e.some(r=>r.type==="scatter"&&t.dataKey===r.dataKey&&t.data===r.data))return t}),xue=_e([mue,lue,oue,cue,uue,due,pue,hue],(e,t,r,n,a,i,o,u)=>{var{chartData:m,dataStartIndex:f,dataEndIndex:h}=e;if(o!=null){var x;if(o?.data!=null&&o.data.length>0?x=o.data:x=m?.slice(f,h+1),!(x==null||t==null||n==null||r==null||a==null||r?.length===0||a?.length===0))return _ue({displayedData:x,xAxis:t,yAxis:n,zAxis:i,scatterSettings:o,xAxisTicks:r,yAxisTicks:a,cells:u})}}),vue=["onMouseEnter","onClick","onMouseLeave"],gue=["animationBegin","animationDuration","animationEasing","hide","isAnimationActive","legendType","lineJointType","lineType","shape","xAxisId","yAxisId","zAxisId"];function u8(e,t){if(e==null)return{};var r,n,a=yue(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function yue(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Yc(){return Yc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Yc.apply(null,arguments)}function P3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function oa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?P3(Object(r),!0).forEach(function(n){hS(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hS(e,t,r){return(t=bue(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bue(e){var t=wue(e,"string");return typeof t=="symbol"?t:t+""}function wue(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Sue=e=>{var{dataKey:t,name:r,fill:n,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:n,value:Bs(r,t),payload:e}]};function jue(e){var{points:t,props:r}=e,{line:n,lineType:a,lineJointType:i}=r;if(!n)return null;var o=kt(r,!1),u=kt(n,!1),m,f;if(a==="joint")m=t.map(S=>({x:S.cx,y:S.cy}));else if(a==="fitting"){var{xmin:h,xmax:x,a:v,b:y}=ZG(t),w=S=>v*S+y;m=[{x:h,y:w(h)},{x,y:w(x)}]}var b=oa(oa(oa({},o),{},{fill:"none",stroke:o&&o.fill},u),{},{points:m});return g.isValidElement(n)?f=g.cloneElement(n,b):typeof n=="function"?f=n(b):f=g.createElement(vp,Yc({},b,{type:i})),g.createElement(mr,{className:"recharts-scatter-line",key:"recharts-scatter-line"},f)}function d8(e){var{points:t,showLabels:r,allOtherScatterProps:n}=e,{shape:a,activeShape:i,dataKey:o}=n,u=kt(n,!1),m=lt(Qi),{onMouseEnter:f,onClick:h,onMouseLeave:x}=n,v=u8(n,vue),y=$f(f,n.dataKey),w=zf(x),b=Hf(h,n.dataKey);return t==null?null:g.createElement(g.Fragment,null,g.createElement(jue,{points:t,props:n}),t.map((S,N)=>{var _=i&&m===String(N),A=_?i:a,k=oa(oa(oa({key:"symbol-".concat(N)},u),S),{},{[B2]:N,[U2]:String(o)});return g.createElement(mr,Yc({className:"recharts-scatter-symbol"},Pl(v,S,N),{onMouseEnter:y(S,N),onMouseLeave:w(S,N),onClick:b(S,N),key:"symbol-".concat(S?.cx,"-").concat(S?.cy,"-").concat(S?.size,"-").concat(N)}),g.createElement(sue,Yc({option:A,isActive:_},k)))}),r&&Gi.renderCallByParent(n,t))}function Nue(e){var{previousPointsRef:t,props:r}=e,{points:n,isAnimationActive:a,animationBegin:i,animationDuration:o,animationEasing:u}=r,m=t.current,f=Vf(r,"recharts-scatter-"),[h,x]=g.useState(!1),v=g.useCallback(()=>{x(!1)},[]),y=g.useCallback(()=>{x(!0)},[]);return g.createElement(Xi,{begin:i,duration:o,isActive:a,easing:u,from:{t:0},to:{t:1},onAnimationEnd:v,onAnimationStart:y,key:f},w=>{var{t:b}=w,S=b===1?n:n.map((N,_)=>{var A=m&&m[_];if(A){var k=Kr(A.cx,N.cx),C=Kr(A.cy,N.cy),O=Kr(A.size,N.size);return oa(oa({},N),{},{cx:k(b),cy:C(b),size:O(b)})}var T=Kr(0,N.size);return oa(oa({},N),{},{size:T(b)})});return b>0&&(t.current=S),g.createElement(mr,null,g.createElement(d8,{points:S,allOtherScatterProps:r,showLabels:!h}))})}function Eue(e){var{points:t,isAnimationActive:r}=e,n=g.useRef(null),a=n.current;return r&&t&&t.length&&(!a||a!==t)?g.createElement(Nue,{props:e,previousPointsRef:n}):g.createElement(d8,{points:t,allOtherScatterProps:e,showLabels:!0})}function Aue(e){var{dataKey:t,points:r,stroke:n,strokeWidth:a,fill:i,name:o,hide:u,tooltipType:m}=e;return{dataDefinedOnItem:r?.map(f=>f.tooltipPayload),positions:r?.map(f=>f.tooltipPosition),settings:{stroke:n,strokeWidth:a,fill:i,nameKey:void 0,dataKey:t,name:Bs(o,t),hide:u,type:m,color:i,unit:""}}}function _ue(e){var{displayedData:t,xAxis:r,yAxis:n,zAxis:a,scatterSettings:i,xAxisTicks:o,yAxisTicks:u,cells:m}=e,f=qt(r.dataKey)?i.dataKey:r.dataKey,h=qt(n.dataKey)?i.dataKey:n.dataKey,x=a&&a.dataKey,v=a?a.range:Wp.defaultProps.range,y=v&&v[0],w=r.scale.bandwidth?r.scale.bandwidth():0,b=n.scale.bandwidth?n.scale.bandwidth():0;return t.map((S,N)=>{var _=Jt(S,f),A=Jt(S,h),k=!qt(x)&&Jt(S,x)||"-",C=[{name:qt(r.dataKey)?i.name:r.name||r.dataKey,unit:r.unit||"",value:_,payload:S,dataKey:f,type:i.tooltipType},{name:qt(n.dataKey)?i.name:n.name||n.dataKey,unit:n.unit||"",value:A,payload:S,dataKey:h,type:i.tooltipType}];k!=="-"&&C.push({name:a.name||a.dataKey,unit:a.unit||"",value:k,payload:S,dataKey:x,type:i.tooltipType});var O=fm({axis:r,ticks:o,bandSize:w,entry:S,index:N,dataKey:f}),T=fm({axis:n,ticks:u,bandSize:b,entry:S,index:N,dataKey:h}),z=k!=="-"?a.scale(k):y,P=Math.sqrt(Math.max(z,0)/Math.PI);return oa(oa({},S),{},{cx:O,cy:T,x:O-P,y:T-P,width:2*P,height:2*P,size:z,node:{x:_,y:A,z:k},tooltipPayload:C,tooltipPosition:{x:O,y:T},payload:S},m&&m[N]&&m[N].props)})}var Tue=(e,t,r)=>({x:e.cx,y:e.cy,value:r==="x"?+e.node.x:+e.node.y,errorVal:Jt(e,t)});function kue(e){var t=g.useRef(Dl("recharts-scatter-")),{hide:r,points:n,className:a,needClip:i,xAxisId:o,yAxisId:u,id:m,children:f}=e;if(r)return null;var h=$t("recharts-scatter",a),x=qt(m)?t.current:m;return g.createElement(mr,{className:h,clipPath:i?"url(#clipPath-".concat(x,")"):null},i&&g.createElement("defs",null,g.createElement(nS,{clipPathId:x,xAxisId:o,yAxisId:u})),g.createElement(tS,{xAxisId:o,yAxisId:u,data:n,dataPointFormatter:Tue,errorBarOffset:0},f),g.createElement(mr,{key:"recharts-scatter-symbols"},g.createElement(Eue,e)))}var f8={xAxisId:0,yAxisId:0,zAxisId:0,legendType:"circle",lineType:"joint",lineJointType:"linear",data:[],shape:"circle",hide:!1,isAnimationActive:!zs.isSsr,animationBegin:0,animationDuration:400,animationEasing:"linear"};function Cue(e){var t=da(e,f8),{animationBegin:r,animationDuration:n,animationEasing:a,hide:i,isAnimationActive:o,legendType:u,lineJointType:m,lineType:f,shape:h,xAxisId:x,yAxisId:v,zAxisId:y}=t,w=u8(t,gue),{needClip:b}=Hp(x,v),S=g.useMemo(()=>Lo(e.children,ns),[e.children]),N=g.useMemo(()=>({name:e.name,tooltipType:e.tooltipType,data:e.data,dataKey:e.dataKey}),[e.data,e.dataKey,e.name,e.tooltipType]),_=$n(),A=lt(k=>xue(k,x,v,y,N,S,_));return b==null?null:g.createElement(g.Fragment,null,g.createElement(qf,{fn:Aue,args:oa(oa({},e),{},{points:A})}),g.createElement(kue,Yc({},w,{xAxisId:x,yAxisId:v,zAxisId:y,lineType:f,lineJointType:m,legendType:u,shape:h,hide:i,isAnimationActive:o,animationBegin:r,animationDuration:n,animationEasing:a,points:A,needClip:b})))}class mS extends g.Component{render(){return g.createElement(rS,{type:"scatter",data:this.props.data,xAxisId:this.props.xAxisId,yAxisId:this.props.yAxisId,zAxisId:this.props.zAxisId,dataKey:this.props.dataKey,stackId:void 0,hide:this.props.hide,barSize:void 0},g.createElement(Jw,{legendPayload:Sue(this.props)}),g.createElement(Cue,this.props))}}hS(mS,"displayName","Scatter");hS(mS,"defaultProps",f8);var Oue=["children"],Due=["dangerouslySetInnerHTML","ticks"];function h8(e,t,r){return(t=Pue(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Pue(e){var t=Rue(e,"string");return typeof t=="symbol"?t:t+""}function Rue(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Tb(){return Tb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Tb.apply(null,arguments)}function m8(e,t){if(e==null)return{};var r,n,a=Mue(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Mue(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Fue(e){var t=br(),r=g.useMemo(()=>{var{children:i}=e,o=m8(e,Oue);return o},[e]),n=lt(i=>qs(i,r.id)),a=r===n;return g.useEffect(()=>(t(Kce(r)),()=>{t(Gce(r))}),[r,t]),a?e.children:null}var Iue=e=>{var{xAxisId:t,className:r}=e,n=lt(J6),a=$n(),i="xAxis",o=lt(y=>fu(y,i,t,a)),u=lt(y=>MP(y,i,t,a)),m=lt(y=>OP(y,t)),f=lt(y=>Ire(y,t));if(m==null||f==null)return null;var{dangerouslySetInnerHTML:h,ticks:x}=e,v=m8(e,Due);return g.createElement(Bl,Tb({},v,{scale:o,x:f.x,y:f.y,width:m.width,height:m.height,className:$t("recharts-".concat(i," ").concat(i),r),viewBox:n,ticks:u}))},Lue=e=>{var t,r,n,a,i;return g.createElement(Fue,{interval:(t=e.interval)!==null&&t!==void 0?t:"preserveEnd",id:e.xAxisId,scale:e.scale,type:e.type,padding:e.padding,allowDataOverflow:e.allowDataOverflow,domain:e.domain,dataKey:e.dataKey,allowDuplicatedCategory:e.allowDuplicatedCategory,allowDecimals:e.allowDecimals,tickCount:e.tickCount,includeHidden:(r=e.includeHidden)!==null&&r!==void 0?r:!1,reversed:e.reversed,ticks:e.ticks,height:e.height,orientation:e.orientation,mirror:e.mirror,hide:e.hide,unit:e.unit,name:e.name,angle:(n=e.angle)!==null&&n!==void 0?n:0,minTickGap:(a=e.minTickGap)!==null&&a!==void 0?a:5,tick:(i=e.tick)!==null&&i!==void 0?i:!0,tickFormatter:e.tickFormatter},g.createElement(Iue,e))};class ki extends g.Component{render(){return g.createElement(Lue,this.props)}}h8(ki,"displayName","XAxis");h8(ki,"defaultProps",{allowDataOverflow:Na.allowDataOverflow,allowDecimals:Na.allowDecimals,allowDuplicatedCategory:Na.allowDuplicatedCategory,height:Na.height,hide:!1,mirror:Na.mirror,orientation:Na.orientation,padding:Na.padding,reversed:Na.reversed,scale:Na.scale,tickCount:Na.tickCount,type:Na.type,xAxisId:0});var Bue=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:a=0,tickMargin:i=0}=e,o=0;if(t){t.forEach(h=>{if(h){var x=h.getBoundingClientRect();x.width>o&&(o=x.width)}});var u=r?r.getBoundingClientRect().width:0,m=a+i,f=o+m+u+(r?n:0);return Math.round(f)}return 0},Uue=["dangerouslySetInnerHTML","ticks"];function p8(e,t,r){return(t=$ue(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $ue(e){var t=zue(e,"string");return typeof t=="symbol"?t:t+""}function zue(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kb(){return kb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},kb.apply(null,arguments)}function Hue(e,t){if(e==null)return{};var r,n,a=que(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function que(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Vue(e){var t=br();return g.useEffect(()=>(t(Wce(e)),()=>{t(Xce(e))}),[e,t]),null}var Kue=e=>{var t,{yAxisId:r,className:n,width:a,label:i}=e,o=g.useRef(null),u=g.useRef(null),m=lt(J6),f=$n(),h=br(),x="yAxis",v=lt(A=>fu(A,x,r,f)),y=lt(A=>DP(A,r)),w=lt(A=>Lre(A,r)),b=lt(A=>MP(A,x,r,f));if(g.useLayoutEffect(()=>{var A;if(!(a!=="auto"||!y||Ww(i)||g.isValidElement(i))){var k=o.current,C=k==null||(A=k.tickRefs)===null||A===void 0?void 0:A.current,{tickSize:O,tickMargin:T}=k.props,z=Bue({ticks:C,label:u.current,labelGapWithTick:5,tickSize:O,tickMargin:T});Math.round(y.width)!==Math.round(z)&&h(Qce({id:r,width:z}))}},[o,o==null||(t=o.current)===null||t===void 0||(t=t.tickRefs)===null||t===void 0?void 0:t.current,y?.width,y,h,i,r,a]),y==null||w==null)return null;var{dangerouslySetInnerHTML:S,ticks:N}=e,_=Hue(e,Uue);return g.createElement(Bl,kb({},_,{ref:o,labelRef:u,scale:v,x:w.x,y:w.y,width:y.width,height:y.height,className:$t("recharts-".concat(x," ").concat(x),n),viewBox:m,ticks:b}))},Gue=e=>{var t,r,n,a,i;return g.createElement(g.Fragment,null,g.createElement(Vue,{interval:(t=e.interval)!==null&&t!==void 0?t:"preserveEnd",id:e.yAxisId,scale:e.scale,type:e.type,domain:e.domain,allowDataOverflow:e.allowDataOverflow,dataKey:e.dataKey,allowDuplicatedCategory:e.allowDuplicatedCategory,allowDecimals:e.allowDecimals,tickCount:e.tickCount,padding:e.padding,includeHidden:(r=e.includeHidden)!==null&&r!==void 0?r:!1,reversed:e.reversed,ticks:e.ticks,width:e.width,orientation:e.orientation,mirror:e.mirror,hide:e.hide,unit:e.unit,name:e.name,angle:(n=e.angle)!==null&&n!==void 0?n:0,minTickGap:(a=e.minTickGap)!==null&&a!==void 0?a:5,tick:(i=e.tick)!==null&&i!==void 0?i:!0,tickFormatter:e.tickFormatter}),g.createElement(Kue,e))},Wue={allowDataOverflow:Ea.allowDataOverflow,allowDecimals:Ea.allowDecimals,allowDuplicatedCategory:Ea.allowDuplicatedCategory,hide:!1,mirror:Ea.mirror,orientation:Ea.orientation,padding:Ea.padding,reversed:Ea.reversed,scale:Ea.scale,tickCount:Ea.tickCount,type:Ea.type,width:Ea.width,yAxisId:0};class si extends g.Component{render(){return g.createElement(Gue,this.props)}}p8(si,"displayName","YAxis");p8(si,"defaultProps",Wue);var ny={exports:{}},ay={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var R3;function Xue(){if(R3)return ay;R3=1;var e=Qc();function t(m,f){return m===f&&(m!==0||1/m===1/f)||m!==m&&f!==f}var r=typeof Object.is=="function"?Object.is:t,n=e.useSyncExternalStore,a=e.useRef,i=e.useEffect,o=e.useMemo,u=e.useDebugValue;return ay.useSyncExternalStoreWithSelector=function(m,f,h,x,v){var y=a(null);if(y.current===null){var w={hasValue:!1,value:null};y.current=w}else w=y.current;y=o(function(){function S(C){if(!N){if(N=!0,_=C,C=x(C),v!==void 0&&w.hasValue){var O=w.value;if(v(O,C))return A=O}return A=C}if(O=A,r(_,C))return O;var T=x(C);return v!==void 0&&v(O,T)?(_=C,O):(_=C,A=T)}var N=!1,_,A,k=h===void 0?null:h;return[function(){return S(f())},k===null?void 0:function(){return S(k())}]},[f,h,x,v]);var b=n(m,y[0],y[1]);return i(function(){w.hasValue=!0,w.value=b},[b]),u(b),b},ay}var M3;function Yue(){return M3||(M3=1,ny.exports=Xue()),ny.exports}Yue();function Zue(e){e()}function Que(){let e=null,t=null;return{clear(){e=null,t=null},notify(){Zue(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const a=t={callback:r,next:null,prev:t};return a.prev?a.prev.next=a:e=a,function(){!n||e===null||(n=!1,a.next?a.next.prev=a.prev:t=a.prev,a.prev?a.prev.next=a.next:e=a.next)}}}}var F3={notify(){},get:()=>[]};function Jue(e,t){let r,n=F3,a=0,i=!1;function o(b){h();const S=n.subscribe(b);let N=!1;return()=>{N||(N=!0,S(),x())}}function u(){n.notify()}function m(){w.onStateChange&&w.onStateChange()}function f(){return i}function h(){a++,r||(r=e.subscribe(m),n=Que())}function x(){a--,r&&a===0&&(r(),r=void 0,n.clear(),n=F3)}function v(){i||(i=!0,h())}function y(){i&&(i=!1,x())}const w={addNestedSub:o,notifyNestedSubs:u,handleChangeWrapper:m,isSubscribed:f,trySubscribe:v,tryUnsubscribe:y,getListeners:()=>n};return w}var ede=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",tde=ede(),rde=()=>typeof navigator<"u"&&navigator.product==="ReactNative",nde=rde(),ade=()=>tde||nde?g.useLayoutEffect:g.useEffect,ide=ade(),sde=Symbol.for("react-redux-context"),lde=typeof globalThis<"u"?globalThis:{};function ode(){if(!g.createContext)return{};const e=lde[sde]??=new Map;let t=e.get(g.createContext);return t||(t=g.createContext(null),e.set(g.createContext,t)),t}var cde=ode();function ude(e){const{children:t,context:r,serverState:n,store:a}=e,i=g.useMemo(()=>{const m=Jue(a);return{store:a,subscription:m,getServerState:n?()=>n:void 0}},[a,n]),o=g.useMemo(()=>a.getState(),[a]);ide(()=>{const{subscription:m}=i;return m.onStateChange=m.notifyNestedSubs,m.trySubscribe(),o!==a.getState()&&m.notifyNestedSubs(),()=>{m.tryUnsubscribe(),m.onStateChange=void 0}},[i,o]);const u=r||cde;return g.createElement(u.Provider,{value:i},t)}var dde=ude,fde=(e,t)=>t,pS=_e([fde,Ct,hP,vn,ZP,Vs,Une,nn],Vne),xS=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},x8=ci("mouseClick"),v8=Af();v8.startListening({actionCreator:x8,effect:(e,t)=>{var r=e.payload,n=pS(t.getState(),xS(r));n?.activeIndex!=null&&t.dispatch(Yre({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var Cb=ci("mouseMove"),g8=Af();g8.startListening({actionCreator:Cb,effect:(e,t)=>{var r=e.payload,n=t.getState(),a=Bw(n,n.tooltip.settings.shared),i=pS(n,xS(r));a==="axis"&&(i?.activeIndex!=null?t.dispatch(qP({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate})):t.dispatch(HP()))}});function hde(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":t}var I3={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},y8=pi({name:"rootProps",initialState:I3,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:I3.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),mde=y8.reducer,{updateOptions:pde}=y8.actions,b8=pi({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:xde}=b8.actions,vde=b8.reducer,w8=ci("keyDown"),S8=ci("focus"),vS=Af();vS.startListening({actionCreator:w8,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip,i=e.payload;if(!(i!=="ArrowRight"&&i!=="ArrowLeft"&&i!=="Enter")){var o=Number(Uw(a,zo(r))),u=Vs(r);if(i==="Enter"){var m=Tm(r,"axis","hover",String(a.index));t.dispatch(pb({active:!a.active,activeIndex:a.index,activeDataKey:a.dataKey,activeCoordinate:m}));return}var f=$re(r),h=f==="left-to-right"?1:-1,x=i==="ArrowRight"?1:-1,v=o+x*h;if(!(u==null||v>=u.length||v<0)){var y=Tm(r,"axis","hover",String(v));t.dispatch(pb({active:!0,activeIndex:v.toString(),activeDataKey:void 0,activeCoordinate:y}))}}}}});vS.startListening({actionCreator:S8,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip;if(!a.active&&a.index==null){var i="0",o=Tm(r,"axis","hover",String(i));t.dispatch(pb({activeDataKey:void 0,active:!0,activeIndex:i,activeCoordinate:o}))}}}});var ti=ci("externalEvent"),j8=Af();j8.startListening({actionCreator:ti,effect:(e,t)=>{if(e.payload.handler!=null){var r=t.getState(),n={activeCoordinate:Cne(r),activeDataKey:tR(r),activeIndex:Qi(r),activeLabel:eR(r),activeTooltipIndex:Qi(r),isTooltipActive:One(r)};e.payload.handler(n,e.payload.reactEvent)}}});var gde=_e([hu],e=>e.tooltipItemPayloads),yde=_e([gde,Bf,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,n)=>{var a=e.find(u=>u.settings.dataKey===n);if(a!=null){var{positions:i}=a;if(i!=null){var o=t(i,r);return o}}}),N8=ci("touchMove"),E8=Af();E8.startListening({actionCreator:N8,effect:(e,t)=>{var r=e.payload,n=t.getState(),a=Bw(n,n.tooltip.settings.shared);if(a==="axis"){var i=pS(n,xS({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));i?.activeIndex!=null&&t.dispatch(qP({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate}))}else if(a==="item"){var o,u=r.touches[0],m=document.elementFromPoint(u.clientX,u.clientY);if(!m||!m.getAttribute)return;var f=m.getAttribute(B2),h=(o=m.getAttribute(U2))!==null&&o!==void 0?o:void 0,x=yde(t.getState(),f,h);t.dispatch(zP({activeDataKey:h,activeIndex:f,activeCoordinate:x}))}}});var bde=j6({brush:Poe,cartesianAxis:Jce,chartData:lae,graphicalItems:Hie,layout:qY,legend:TZ,options:rae,polarAxis:_ie,polarOptions:vde,referenceElements:Uoe,rootProps:mde,tooltip:Zre}),wde=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return pY({reducer:bde,preloadedState:t,middleware:n=>n({serializableCheck:!1}).concat([v8.middleware,g8.middleware,vS.middleware,j8.middleware,E8.middleware]),devTools:{serialize:{replacer:hde},name:"recharts-".concat(r)}})};function A8(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,a=$n(),i=g.useRef(null);if(a)return r;i.current==null&&(i.current=wde(t,n));var o=O2;return g.createElement(dde,{context:o,store:i.current},r)}function _8(e){var{layout:t,width:r,height:n,margin:a}=e,i=br(),o=$n();return g.useEffect(()=>{o||(i($Y(t)),i(zY({width:r,height:n})),i(UY(a)))},[i,o,t,r,n,a]),null}function T8(e){var t=br();return g.useEffect(()=>{t(pde(e))},[t,e]),null}var Sde=["children"];function jde(e,t){if(e==null)return{};var r,n,a=Nde(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Nde(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Mm(){return Mm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Mm.apply(null,arguments)}var Ede={width:"100%",height:"100%"},Ade=g.forwardRef((e,t)=>{var r=z2(),n=H2(),a=aD();if(!Hc(r)||!Hc(n))return null;var{children:i,otherAttributes:o,title:u,desc:m}=e,f,h;return typeof o.tabIndex=="number"?f=o.tabIndex:f=a?0:void 0,typeof o.role=="string"?h=o.role:h=a?"application":void 0,g.createElement(b2,Mm({},o,{title:u,desc:m,role:h,tabIndex:f,width:r,height:n,style:Ede,ref:t}),i)}),_de=e=>{var{children:t}=e,r=lt(pp);if(!r)return null;var{width:n,height:a,y:i,x:o}=r;return g.createElement(b2,{width:n,height:a,x:o,y:i},t)},L3=g.forwardRef((e,t)=>{var{children:r}=e,n=jde(e,Sde),a=$n();return a?g.createElement(_de,null,r):g.createElement(Ade,Mm({ref:t},n),r)});function Tde(){var e=br(),[t,r]=g.useState(null),n=lt(xZ);return g.useEffect(()=>{if(t!=null){var a=t.getBoundingClientRect(),i=a.width/t.offsetWidth;Ba(i)&&i!==n&&e(HY(i))}},[t,e,n]),r}function B3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function kde(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?B3(Object(r),!0).forEach(function(n){Cde(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Cde(e,t,r){return(t=Ode(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ode(e){var t=Dde(e,"string");return typeof t=="symbol"?t:t+""}function Dde(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Pde=g.forwardRef((e,t)=>{var{children:r,className:n,height:a,onClick:i,onContextMenu:o,onDoubleClick:u,onMouseDown:m,onMouseEnter:f,onMouseLeave:h,onMouseMove:x,onMouseUp:v,onTouchEnd:y,onTouchMove:w,onTouchStart:b,style:S,width:N}=e,_=br(),[A,k]=g.useState(null),[C,O]=g.useState(null);uae();var T=Tde(),z=g.useCallback(R=>{T(R),typeof t=="function"&&t(R),k(R),O(R)},[T,t,k,O]),P=g.useCallback(R=>{_(x8(R)),_(ti({handler:i,reactEvent:R}))},[_,i]),Z=g.useCallback(R=>{_(Cb(R)),_(ti({handler:f,reactEvent:R}))},[_,f]),q=g.useCallback(R=>{_(HP()),_(ti({handler:h,reactEvent:R}))},[_,h]),B=g.useCallback(R=>{_(Cb(R)),_(ti({handler:x,reactEvent:R}))},[_,x]),fe=g.useCallback(()=>{_(S8())},[_]),Ne=g.useCallback(R=>{_(w8(R.key))},[_]),he=g.useCallback(R=>{_(ti({handler:o,reactEvent:R}))},[_,o]),K=g.useCallback(R=>{_(ti({handler:u,reactEvent:R}))},[_,u]),H=g.useCallback(R=>{_(ti({handler:m,reactEvent:R}))},[_,m]),be=g.useCallback(R=>{_(ti({handler:v,reactEvent:R}))},[_,v]),te=g.useCallback(R=>{_(ti({handler:b,reactEvent:R}))},[_,b]),I=g.useCallback(R=>{_(N8(R)),_(ti({handler:w,reactEvent:R}))},[_,w]),se=g.useCallback(R=>{_(ti({handler:y,reactEvent:R}))},[_,y]);return g.createElement(lR.Provider,{value:A},g.createElement(K5.Provider,{value:C},g.createElement("div",{className:$t("recharts-wrapper",n),style:kde({position:"relative",cursor:"default",width:N,height:a},S),onClick:P,onContextMenu:he,onDoubleClick:K,onFocus:fe,onKeyDown:Ne,onMouseDown:H,onMouseEnter:Z,onMouseLeave:q,onMouseMove:B,onMouseUp:be,onTouchEnd:se,onTouchMove:I,onTouchStart:te,ref:z},r)))}),Rde=["children","className","width","height","style","compact","title","desc"];function Mde(e,t){if(e==null)return{};var r,n,a=Fde(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Fde(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var k8=g.forwardRef((e,t)=>{var{children:r,className:n,width:a,height:i,style:o,compact:u,title:m,desc:f}=e,h=Mde(e,Rde),x=kt(h,!1);return u?g.createElement(L3,{otherAttributes:x,title:m,desc:f},r):g.createElement(Pde,{className:n,style:o,width:a,height:i,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},g.createElement(L3,{otherAttributes:x,title:m,desc:f,ref:t},g.createElement(zoe,null,r)))}),Ide=["width","height"];function Ob(){return Ob=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ob.apply(null,arguments)}function Lde(e,t){if(e==null)return{};var r,n,a=Bde(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Bde(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Ude={top:5,right:5,bottom:5,left:5},$de={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:Ude,reverseStackOrder:!1,syncMethod:"index"},gS=g.forwardRef(function(t,r){var n,a=da(t.categoricalChartProps,$de),{width:i,height:o}=a,u=Lde(a,Ide);if(!Hc(i)||!Hc(o))return null;var{chartName:m,defaultTooltipEventType:f,validateTooltipEventTypes:h,tooltipPayloadSearcher:x,categoricalChartProps:v}=t,y={chartName:m,defaultTooltipEventType:f,validateTooltipEventTypes:h,tooltipPayloadSearcher:x,eventEmitter:void 0};return g.createElement(A8,{preloadedState:{options:y},reduxStoreName:(n=v.id)!==null&&n!==void 0?n:m},g.createElement(YR,{chartData:v.data}),g.createElement(_8,{width:i,height:o,layout:a.layout,margin:a.margin}),g.createElement(T8,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),g.createElement(k8,Ob({},u,{width:i,height:o,ref:r})))}),zde=["axis"],C8=g.forwardRef((e,t)=>g.createElement(gS,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:zde,tooltipPayloadSearcher:Uf,categoricalChartProps:e,ref:t})),Hde=["axis","item"],Zc=g.forwardRef((e,t)=>g.createElement(gS,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Hde,tooltipPayloadSearcher:Uf,categoricalChartProps:e,ref:t}));function qde(e){var t=br();return g.useEffect(()=>{t(xde(e))},[t,e]),null}var Vde=["width","height","layout"];function Db(){return Db=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Db.apply(null,arguments)}function Kde(e,t){if(e==null)return{};var r,n,a=Gde(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Gde(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Wde={top:5,right:5,bottom:5,left:5},Xde={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:Wde,reverseStackOrder:!1,syncMethod:"index",layout:"radial"},O8=g.forwardRef(function(t,r){var n,a=da(t.categoricalChartProps,Xde),{width:i,height:o,layout:u}=a,m=Kde(a,Vde);if(!Hc(i)||!Hc(o))return null;var{chartName:f,defaultTooltipEventType:h,validateTooltipEventTypes:x,tooltipPayloadSearcher:v}=t,y={chartName:f,defaultTooltipEventType:h,validateTooltipEventTypes:x,tooltipPayloadSearcher:v,eventEmitter:void 0};return g.createElement(A8,{preloadedState:{options:y},reduxStoreName:(n=a.id)!==null&&n!==void 0?n:f},g.createElement(YR,{chartData:a.data}),g.createElement(_8,{width:i,height:o,layout:u,margin:a.margin}),g.createElement(T8,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),g.createElement(qde,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),g.createElement(k8,Db({width:i,height:o},m,{ref:r})))}),Yde=["item"],Zde={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},Xp=g.forwardRef((e,t)=>{var r=da(e,Zde);return g.createElement(O8,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:Yde,tooltipPayloadSearcher:Uf,categoricalChartProps:r,ref:t})}),Qde=["item"],Jde=g.forwardRef((e,t)=>g.createElement(gS,{chartName:"ScatterChart",defaultTooltipEventType:"item",validateTooltipEventTypes:Qde,tooltipPayloadSearcher:Uf,categoricalChartProps:e,ref:t})),efe=["axis","item"],tfe={layout:"radial",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},rfe=g.forwardRef((e,t)=>{var r=da(e,tfe);return g.createElement(O8,{chartName:"RadialBarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:efe,tooltipPayloadSearcher:Uf,categoricalChartProps:r,ref:t})});const nfe={},Td=nfe?.VITE_API_BASE||"https://clarus.elpiscapital.com/api",Aa=e=>{if(e==null)return null;const t=typeof e=="number"?e:Number(String(e).replace(/[, ]/g,""));return Number.isFinite(t)?t:null},U3=e=>Aa(e)?.toLocaleString(void 0,{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2})??"",afe=e=>Aa(e)?.toLocaleString(void 0,{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0})??"",ife=e=>`$${Number(e||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`,sfe=e=>`${Number(e||0).toLocaleString(void 0,{maximumFractionDigits:2})}%`,$3=e=>{const t=Aa(e);return t==null?"":`${t>=0?"+ ":"- "}${Math.abs(t).toFixed(2)}%`},z3=e=>{const t=Aa(e);return t==null?"text-gray-800":t>0?"text-emerald-600":t<0?"text-red-600":"text-gray-800"},lfe=e=>{const t=Aa(e);return t==null?"text-gray-800":t>1?"text-emerald-600":t<1?"text-red-600":"text-gray-800"},Ah=e=>String(e).slice(0,7),ofe=(e,t)=>{const r=new Date(e),n=new Date(t);return(n.getFullYear()-r.getFullYear())*12+(n.getMonth()-r.getMonth())},zd=["#6366F1","#10B981","#60A5FA","#F59E0B","#EF4444","#8B5CF6","#14B8A6","#22C55E","#3B82F6","#EAB308","#F97316","#EC4899","#06B6D4","#84CC16"];function cfe({cx:e,cy:t,innerRadius:r,outerRadius:n,startAngle:a,endAngle:i,fill:o}){return l.jsx(_f,{cx:e,cy:t,innerRadius:r,outerRadius:n+8,startAngle:a,endAngle:i,fill:o,stroke:"#fff",strokeWidth:1.5})}function ufe({active:e,payload:t}){if(!e||!t||!t.length)return null;const r=t[0],n=r?.payload?.percent!=null?r.payload.percent:r?.percent!=null?r.percent*100:null,a=r?.payload?.name??r?.name??"";return l.jsxs("div",{className:"rounded-md bg-white/95 shadow px-3 py-2 border border-gray-200",style:{pointerEvents:"none"},children:[l.jsx("div",{className:"text-sm font-semibold text-gray-800",children:n==null?"":sfe(n)}),l.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[l.jsx("span",{className:"font-medium",children:a}),"  ",ife(r?.value)]})]})}function H3({data:e,title:t,total:r}){const n={inner:80,outer:112},[a,i]=g.useState(-1),o=a>=0&&e[a]?e[a].name:t,u=a>=0&&e[a]?e[a].value:r,m=g.useCallback((h,x)=>i(x),[]),f=g.useCallback(()=>i(-1),[]);return l.jsxs("div",{className:"relative h-64",children:[l.jsx(la,{width:"100%",height:"100%",children:l.jsxs(Xp,{children:[l.jsx(pu,{data:e,dataKey:"value",nameKey:"name",innerRadius:n.inner,outerRadius:n.outer,paddingAngle:1.2,isAnimationActive:!0,stroke:"#fff",strokeWidth:1.5,activeIndex:a,activeShape:cfe,onMouseEnter:m,onMouseLeave:f,children:e.map((h,x)=>l.jsx(ns,{fill:h.color||zd[x%zd.length]},x))}),l.jsx(sa,{content:l.jsx(ufe,{})})]})}),l.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:l.jsxs("div",{className:"text-center leading-tight",children:[l.jsx("div",{className:"text-gray-500 text-sm",children:o}),l.jsx("div",{className:"text-xl font-extrabold text-gray-900",children:afe(u)})]})})]})}function dfe(){const[e,t]=g.useState("all"),[r,n]=g.useState([]),[a,i]=g.useState(0),[o,u]=g.useState(!1),[m,f]=g.useState("");return g.useEffect(()=>{(async()=>{u(!0),f("");try{const x=await(await fetch(`${Td}/users?type=${encodeURIComponent(e)}`,{headers:{Accept:"application/json"},cache:"no-store"})).json();n(x.items||[]),i(x.count||0)}catch(h){f(h.message||"Failed to load users")}finally{u(!1)}})()},[e]),l.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white mt-8",children:[l.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200",children:[l.jsxs("div",{className:"text-sm font-semibold text-gray-700",children:["Users (",a,")"]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-sm text-gray-600",children:"Filter"}),l.jsxs("select",{className:"border rounded px-2 py-1 text-sm",value:e,onChange:h=>t(h.target.value),children:[l.jsx("option",{value:"all",children:"All"}),l.jsx("option",{value:"investor",children:"Investor"}),l.jsx("option",{value:"admin",children:"Admin"}),l.jsx("option",{value:"group-admin",children:"Group Admin"})]})]})]}),m&&l.jsx("div",{className:"px-4 py-3 text-sm text-red-600",children:m}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-600",children:"Name"}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-600",children:"Email"}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-600",children:"Type"}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-600",children:"Organization"}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-600",children:"Status"}),l.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-600",children:"Permission"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-100",children:r.length?r.map(h=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-4 py-2",children:h.name}),l.jsx("td",{className:"px-4 py-2",children:h.email}),l.jsx("td",{className:"px-4 py-2",children:h.user_type}),l.jsx("td",{className:"px-4 py-2",children:h.organization||""}),l.jsx("td",{className:"px-4 py-2",children:h.status}),l.jsx("td",{className:"px-4 py-2",children:h.permission})]},h.id)):l.jsx("tr",{children:l.jsx("td",{className:"px-4 py-4 text-gray-500",colSpan:6,children:m||"No users found."})})})]})})]})}function q3(){const[e,t]=g.useState("portfolio"),[r,n]=g.useState(null),[a,i]=g.useState(null),[o,u]=g.useState(null),[m,f]=g.useState(null),[h,x]=g.useState(null),[v,y]=g.useState(""),[w,b]=g.useState({source:"db",basis:"range",period_end:""}),[S,N]=g.useState([]),[_,A]=g.useState([]),[k,C]=g.useState(""),[O,T]=g.useState(""),[z,P]=g.useState({total:0,items:[],as_of:null}),[Z,q]=g.useState({total:0,items:[],as_of:null}),B=g.useCallback((H,be,te)=>{const I=Array.isArray(te)?te:S;if(!I.length||!H||!be)return{init:null,cur:null};const se=L=>I.find(ne=>Ah(ne.as_of_date)===L),R=se(H),W=se(be);let Y=null,Q=Aa(W?.ending_balance);if(H===be){if(Y=Aa(R?.beginning_balance),Y==null){const[L,ne]=H.split("-").map(Number),ge=ne===1?`${L-1}-12`:`${L}-${String(ne-1).padStart(2,"0")}`,G=se(ge);Y=Aa(G?.ending_balance)??Q??0}}else Y=Aa(R?.ending_balance);return{init:Y,cur:Q}},[S]),fe=(H,be,te,I)=>{if(!H||!be||!te||!I)return null;const R=Math.max(1,ofe(`${H}-01`,`${be}-01`))/12;return(Math.pow(I/te,1/R)-1)*100},Ne=(H,be,te)=>{if(!H||!be)return;const I=Array.isArray(te)?te:S;if(!I.length)return;const se=Array.from(new Set(I.map(ne=>Ah(ne.as_of_date))));if(se.indexOf(H)>se.indexOf(be)){y("Invalid month range");return}y("");const{init:R,cur:W}=B(H,be,I),Y=R?W/R:null,Q=R?(W-R)/R*100:null,L=fe(H,be,R,W);n(R),i(W),f(Y),u(Q),x(L),b({source:"db",basis:"range",period_end:be})};g.useEffect(()=>{(async()=>{y("");try{const be=await(await fetch(`${Td}/metrics/admin-periods`,{headers:{Accept:"application/json"},cache:"no-store"})).json();if(!Array.isArray(be)||!be.length)throw new Error("No data");be.sort((R,W)=>new Date(R.as_of_date)-new Date(W.as_of_date)),N(be);const te=Array.from(new Set(be.map(R=>Ah(R.as_of_date))));A(te);const I=te[0],se=te[te.length-1];C(I),T(se),Ne(I,se,be)}catch(H){y(H.message||"Failed to load data")}})()},[]),g.useEffect(()=>{let H;return(async()=>{try{H=new EventSource(`${Td}/metrics/stream`),H.addEventListener("refresh",async()=>{try{const te=await(await fetch(`${Td}/metrics/admin-periods`,{headers:{Accept:"application/json"},cache:"no-store"})).json();if(!Array.isArray(te)||!te.length)return;te.sort((W,Y)=>new Date(W.as_of_date)-new Date(Y.as_of_date)),N(te);const I=Array.from(new Set(te.map(W=>Ah(W.as_of_date))));A(I);const se=I.includes(k)?k:I[0],R=I.includes(O)?O:I[I.length-1];C(se),T(R),Ne(se,R,te)}catch{}})}catch{}})(),()=>H?.close()},[k,O]);const he=async H=>{try{const be=await fetch(`${Td}/metrics/allocation?period_end=${encodeURIComponent(H)}`,{headers:{Accept:"application/json"},cache:"no-store"}),te=await be.json();if(!be.ok)return{total:0,as_of:null,items:[]};const I=(te.items||[]).map((se,R)=>({name:se.name,value:Number(se.value||0),percent:Number(se.percent||0),color:se.color||zd[R%zd.length]})).filter(se=>se.value>0);return{total:Number(te.total||0),as_of:te.as_of,items:I}}catch{return{total:0,as_of:null,items:[]}}},K=(H,be)=>{const te=Aa(be)??Aa(H.total)??0,I=H.items&&H.items.length?H.items:te>0?[{name:"All",value:te,percent:100,color:zd[0]}]:[];return{...H,total:te,items:I}};return g.useEffect(()=>{(async()=>{if(!k||!O||!S.length)return;const[H,be]=await Promise.all([he(k),he(O)]),{init:te,cur:I}=B(k,O,S);P(K(H,te)),q(K(be,I))})()},[k,O,S,B]),l.jsxs("div",{className:"p-6 bg-white rounded-2xl shadow",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h2",{className:"text-sm font-semibold text-gray-700",children:"Overview"}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"text-sm text-gray-600",children:"From"}),l.jsx("select",{className:"border rounded px-2 py-1 text-sm",value:k,onChange:H=>C(H.target.value),children:_.map(H=>l.jsx("option",{value:H,children:H},H))}),l.jsx("div",{className:"text-sm text-gray-600",children:"to"}),l.jsx("select",{className:"border rounded px-2 py-1 text-sm",value:O,onChange:H=>T(H.target.value),children:_.map(H=>l.jsx("option",{value:H,children:H},H))}),l.jsx("button",{className:"px-3 py-1 rounded text-sm bg-sky-600 text-white hover:bg-sky-700",onClick:()=>Ne(k,O),title:"Apply month range",children:"Apply"}),l.jsx("button",{className:"text-sky-600 text-sm hover:underline",onClick:()=>{if(!_.length)return;const H=_[0],be=_[_.length-1];C(H),T(be),Ne(H,be)},title:"Reset to full span",children:"Reset"})]})]}),v&&l.jsxs("div",{className:"mb-4 text-sm text-red-600",children:["Error: ",v]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"rounded-xl border border-gray-200 bg-slate-50 p-6",children:l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 items-center gap-4",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-xs text-gray-500",children:"Initial value"}),l.jsx("div",{className:"text-2xl font-semibold text-sky-700",children:U3(r)})]}),l.jsx("div",{className:"text-center text-2xl text-gray-400",children:""}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-xs text-gray-500",children:"Current value"}),l.jsx("div",{className:"text-2xl font-semibold text-sky-700",children:U3(a)})]})]})}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"rounded-xl border border-gray-200 p-4",children:[l.jsx("div",{className:"text-xs text-gray-500",children:"ROI"}),l.jsx("div",{className:`mt-2 text-lg font-semibold ${z3(o)}`,children:$3(o)})]}),l.jsxs("div",{className:"rounded-xl border border-gray-200 p-4",children:[l.jsx("div",{className:"text-xs text-gray-500",children:"MOIC"}),l.jsx("div",{className:`mt-2 text-lg font-semibold ${lfe(m)}`,children:Aa(m)==null?"":`${Aa(m).toFixed(2)}x`})]}),l.jsxs("div",{className:"rounded-xl border border-gray-200 p-4",children:[l.jsx("div",{className:"text-xs text-gray-500",children:"IRR (annualized)"}),l.jsx("div",{className:`mt-2 text-lg font-semibold ${z3(h)}`,children:h==null?"":$3(h)})]})]})]}),l.jsxs("div",{className:"rounded-xl border border-gray-200 p-4",children:[l.jsx("div",{className:"flex gap-6 text-sm mb-3 border-b border-gray-200",children:l.jsx("button",{onClick:()=>t("portfolio"),className:`pb-2 -mb-px ${e==="portfolio"?"text-sky-700 border-b-2 border-sky-600 font-medium":"text-gray-500 hover:text-gray-700"}`,children:"Portfolio Allocation"})}),l.jsx("div",{className:"text-center text-sm text-gray-600 mb-2",children:"All"}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 items-center",children:[l.jsxs("div",{children:[l.jsx(H3,{data:z.items,title:"Initial Value",total:z.total}),k&&l.jsxs("div",{className:"text-center text-[11px] text-gray-500 -mt-1",children:["as of ",k]})]}),l.jsx("div",{className:"hidden sm:flex items-center justify-center text-2xl text-gray-400",children:""}),l.jsxs("div",{children:[l.jsx(H3,{data:Z.items,title:"Current Value",total:Z.total}),O&&l.jsxs("div",{className:"text-center text-[11px] text-gray-500 -mt-1",children:["as of ",O]})]})]})]})]}),l.jsx(dfe,{})]})}const ffe=()=>l.jsx("style",{children:`
    .inner-x-scroll{overflow-x:auto;overflow-y:hidden;max-width:100%}
    .inner-x-scroll::-webkit-scrollbar{height:10px}
    .inner-x-scroll::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:8px}
    .inner-x-scroll::-webkit-scrollbar-track{background:#f1f5f9}
    .btn{display:inline-flex;align-items:center;gap:.5rem;padding:.5rem .9rem;border-radius:.6rem;border:1px solid #cbd5e1;background:#fff}
    .btn:hover{background:#f8fafc}
    .btn-primary{border-color:#0284c7;background:#0ea5e9;color:white}
    .btn-primary:hover{background:#0284c7}
    .btn-muted{border-color:#e2e8f0;background:#f8fafc;color:#334155}
    .select{padding:.5rem .6rem;border:1px solid #cbd5e1;border-radius:.6rem;background:#fff}
    .label{font-size:.85rem;color:#475569}

    /* Help tooltip */
    .qwrap{position:relative;display:inline-flex;align-items:center}
    .qmark{display:inline-flex;align-items:center;justify-content:center;width:18px;height:18px;border-radius:9999px;border:1px solid #cbd5e1;color:#64748b;background:#fff;font-weight:700;font-size:.75rem;line-height:1}
    .qtip{position:absolute; bottom:150%; left:0; background:#ffffff; color:#111827; border:1px solid #e5e7eb; border-radius:12px; padding:.6rem .8rem; font-size:.8rem; line-height:1.2; white-space:normal; min-width:160px; max-width:280px; box-shadow:0 10px 24px rgba(2,6,23,.15); opacity:0; pointer-events:none; transform:translateY(0); transition:opacity .16s ease, transform .16s ease; z-index:40}
    .qtip:before{content:""; position:absolute; top:100%; left:13px; border-width:11px 10px 0 10px; border-style:solid; border-color:rgba(2,6,23,.08) transparent transparent transparent}
    .qtip:after{content:""; position:absolute; top:calc(100% - 1px); left:14px; border-width:10px 9px 0 9px; border-style:solid; border-color:#ffffff transparent transparent transparent}
    .qwrap:hover .qtip{opacity:1; transform:translateY(-6px); pointer-events:auto}
  `}),Fm=e=>`$${Number(e||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`,hfe=e=>e==null||Number.isNaN(Number(e))?"":`${Number(e).toFixed(2)}%`,iy=e=>{const t=Number(e||0);return Number.isFinite(t)?`${t>0?"+":t<0?"-":""} ${Math.abs(t).toFixed(2)}%`:""},mfe=e=>{const t=Number(e||0);return`${t>0?"+":"-"} ${Math.abs(t).toFixed(2)}x`},_h=(e,{allowMuted:t}={})=>t&&(e==null||Number.isNaN(Number(e)))?"muted":Number(e)>0?"positive":Number(e)<0?"negative":"muted",Im=["#6366F1","#10B981","#60A5FA","#F59E0B","#EF4444","#8B5CF6","#14B8A6","#22C55E","#3B82F6","#EAB308","#F97316","#EC4899","#06B6D4","#84CC16"],_r=e=>typeof e=="string"&&/^\d{4}-(0[1-9]|1[0-2])$/.test(e),Ja=e=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}`,lo=e=>{const[t,r]=e.split("-").map(Number);return new Date(t,r-1,1).toLocaleString(void 0,{month:"short",year:"numeric"})},V3=e=>{if(!_r(e))return null;const[t,r]=e.split("-").map(Number);return new Date(t,r-1,1)},pfe=e=>document.cookie.split("; ").find(t=>t.startsWith(e+"="))?.split("=")[1]??"",sy=(e={})=>({credentials:"include",headers:{"X-XSRF-TOKEN":pfe("XSRF-TOKEN"),...e.headers||{}},...e});function xfe({text:e}){return l.jsxs("span",{className:"qwrap ml-1",children:[l.jsx("span",{className:"qmark","aria-label":"Help",children:"?"}),l.jsx("span",{className:"qtip",children:e})]})}function vfe({title:e,totalLabel:t,totalValue:r,data:n}){const a=Array.isArray(n)?n:[],[i,o]=g.useState(-1),u=a.some(v=>Number(v?.value)>0),m=u?a:[{name:"Total",value:Math.max(1,Number(r)||1),percent:100,color:"#E2E8F0"}],f=i>=0&&m[i]?m[i].value:r,h=({active:v,payload:y})=>{if(!v||!y||!y.length)return null;const w=y[0]?.payload||{};return l.jsxs("div",{className:"bg-white shadow rounded-lg px-3 py-2 border border-slate-200 text-sm",children:[l.jsx("div",{className:"font-semibold text-slate-800",children:w.name||""}),l.jsx("div",{className:"text-emerald-600",children:hfe(w.percent)}),l.jsx("div",{className:"text-slate-700",children:Fm(w.value)})]})},x=({cx:v,cy:y,innerRadius:w,outerRadius:b,startAngle:S,endAngle:N,fill:_})=>l.jsx(_f,{cx:v,cy:y,innerRadius:w,outerRadius:b+8,startAngle:S,endAngle:N,fill:_});return l.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[e?l.jsx("div",{className:"text-center mb-3 text-sm text-slate-500",children:e}):null,l.jsx("div",{className:"h-72",children:l.jsx(la,{width:"100%",height:"100%",children:l.jsxs(Xp,{children:[l.jsx(sa,{content:l.jsx(h,{})}),l.jsx(pu,{data:m,dataKey:"value",nameKey:"name",innerRadius:70,outerRadius:105,paddingAngle:u?2:0,isAnimationActive:!1,activeIndex:i,activeShape:x,onMouseEnter:(v,y)=>o(y),onMouseMove:(v,y)=>o(y),onMouseLeave:()=>o(-1),children:m.map((v,y)=>l.jsx(ns,{fill:v.color||Im[y%Im.length]},y))}),l.jsx("foreignObject",{pointerEvents:"none",x:"0",y:"0",width:"100%",height:"100%",children:l.jsx("div",{className:"w-full h-full grid place-items-center pointer-events-none",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-xs text-slate-500",children:t}),l.jsx("div",{className:"font-bold text-lg",children:Fm(f)})]})})})]})})})]})}function Th({label:e,value:t,footnote:r,accent:n="default",help:a}){const i=n==="positive"?"text-emerald-600":n==="negative"?"text-rose-600":n==="muted"?"text-slate-700":"text-slate-800";return l.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[l.jsxs("div",{className:"text-sm text-slate-500 flex items-center",children:[l.jsx("span",{children:e}),a?l.jsx(xfe,{text:a}):null]}),l.jsx("div",{className:`mt-2 text-2xl font-semibold ${i}`,children:t}),r&&l.jsx("div",{className:"mt-1 text-xs text-slate-500",children:r})]})}function K3({months:e,pendingFrom:t,pendingTo:r,setPendingFrom:n,setPendingTo:a,onApply:i,onReset:o}){const u=g.useMemo(()=>{if(!_r(t)||!_r(r))return!1;const f=e.findIndex(x=>x===t),h=e.findIndex(x=>x===r);return f!==-1&&h!==-1&&f<=h},[e,t,r]),m=g.useMemo(()=>{if(!_r(t))return e;const f=e.findIndex(h=>h===t);return f===-1?e:e.slice(f)},[e,t]);return l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"label",children:"From"}),l.jsx("select",{className:"select",value:t,onChange:f=>n(f.target.value),children:e.map(f=>l.jsx("option",{value:f,children:lo(f)},f))})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"label",children:"to"}),l.jsx("select",{className:"select",value:r,onChange:f=>a(f.target.value),children:m.map(f=>l.jsx("option",{value:f,children:lo(f)},f))})]}),l.jsx("button",{className:"btn btn-primary",disabled:!u,onClick:i,children:"Apply"}),l.jsx("button",{className:"btn btn-muted",onClick:o,children:"Reset"})]})}function gfe({active:e,payload:t,label:r,benchmark:n}){if(!e||!t||!t.length)return null;const a=t.find(f=>f.dataKey==="elopRoi"),i=t.find(f=>f.dataKey==="benchRoi"),o=a?Number(a.value||0).toFixed(2):"0.00",u=i?Number(i.value||0).toFixed(2):"0.00",m=!!(a&&a.payload&&a.payload.elopMissing);return l.jsxs("div",{className:"bg-white shadow rounded-lg px-3 py-2 border border-slate-200 text-sm",children:[l.jsx("div",{className:"font-medium text-slate-800 mb-1",children:r}),l.jsxs("div",{className:"text-slate-700",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-semibold",children:"ELOP ROI"}),": ",o,"%",m?"  missing data":""]}),l.jsxs("div",{children:[l.jsxs("span",{className:"font-semibold",children:[n," ROI"]}),":"," ",u,"%"]})]})]})}function yS(){const{user:e}=g.useContext(Di),r=(e?.user_type||"").toString().replace(/\s+/g,"").toLowerCase()==="groupadmin",n=["Portfolio Allocation"],[a,i]=g.useState(n[0]),[o,u]=g.useState(""),[m,f]=g.useState([]),[h,x]=g.useState(!1),[v,y]=g.useState(""),[w,b]=g.useState(0),[S,N]=g.useState(0),[_,A]=g.useState(0),[k,C]=g.useState(0),[O,T]=g.useState(null),[z,P]=g.useState(""),[Z,q]=g.useState(null),[B,fe]=g.useState(""),[Ne,he]=g.useState("");g.useEffect(()=>{fetch("/api/market/refresh",sy({method:"POST"})).catch(()=>{})},[]),g.useEffect(()=>{if(!r)return;let ie=!1;return(async()=>{try{x(!0),y("");const ve=await fetch("/api/group-admin/my-group",sy()),ce=await ve.json();if(!ve.ok)throw new Error(ce?.message||ce?.error||`HTTP ${ve.status}`);if(!ie){const ye=ce||{},je=Array.isArray(ye.members)?ye.members:Array.isArray(ye.investors)?ye.investors:[];f(je)}}catch(ve){console.error("Failed to load group members",ve),ie||(y(ve.message||"Failed to load group members"),f([]))}finally{ie||x(!1)}})(),()=>{ie=!0}},[r]);const K="bCAS (Q4 Adj)",[H,be]=g.useState([]),[te,I]=g.useState(!0);g.useEffect(()=>{let ie=!0;return(async()=>{try{I(!0);const ce=await(await fetch(`/api/metrics/periods?sheet=${encodeURIComponent(K)}`)).json(),je=(Array.isArray(ce?.periods)?ce.periods:Array.isArray(ce)?ce:[]).map(Ie=>{const Ke=typeof Ie=="string"?Ie:Ie?.as_of_date||Ie?.date||Ie?.as_of||"",Ve=new Date(Ke);return Number.isNaN(Ve.getTime())?null:Ja(Ve)}).filter(Boolean),Pe=Array.from(new Set(je)).sort((Ie,Ke)=>Ie.localeCompare(Ke));ie&&be(Pe)}catch{ie&&be([])}finally{ie&&I(!1)}})(),()=>{ie=!1}},[K]);const[se,R]=g.useState(""),[W,Y]=g.useState(""),[Q,L]=g.useState(""),[ne,ge]=g.useState("");g.useEffect(()=>{if(!H.length)return;const ie=H[0],ve=H[H.length-1];R(ie),Y(ve),L(ie),ge(ve)},[H]);const G=g.useCallback(()=>{if(!_r(se)||!_r(W))return;const ie=H.findIndex(ce=>ce===se),ve=H.findIndex(ce=>ce===W);ie===-1||ve===-1||ie>ve||(L(se),ge(W))},[se,W,H]),ue=g.useCallback(()=>{if(!H.length)return;const ie=H[0],ve=H[H.length-1];R(ie),Y(ve),L(ie),ge(ve)},[H]),Se=()=>{const ie={};try{const ve=localStorage.getItem("accessToken");if(ve&&ve.split(".").length===3){const ce=JSON.parse(atob(ve.split(".")[1])),ye=ce.email||ce.upn||ce.preferred_username,je=ce.name;ye&&(ie["X-User-Email"]=ye),je&&(ie["X-User-Name"]=je)}}catch{}return ie},M=g.useMemo(()=>{try{const ve=(new URL(window.location.href).searchParams.get("investor")||"").trim();let ce="";try{ce=localStorage.getItem("investorHint")||""}catch{ce=""}if(ve)try{localStorage.setItem("investorHint",ve)}catch{}return r?ve:ve||ce}catch{if(r)return"";try{return localStorage.getItem("investorHint")||""}catch{return""}}},[r]);g.useEffect(()=>{if(!_r(Q)||!_r(ne)||r&&h)return;const ie=new URLSearchParams({sheet:K});ie.set("from",`${Q}-01`),ie.set("to",`${ne}-01`);const ve=Se(),ce=async ye=>{const je=new URLSearchParams(ie);ye&&je.set("investor",ye);const Pe=await fetch(`/api/metrics/investor-overview?${je.toString()}`,{credentials:"include",headers:ve}),Ie=await Pe.json();if(!Pe.ok)throw new Error(Ie?.error||`HTTP ${Pe.status}`);return Ie};(async()=>{try{if(fe(""),r&&m.length>0&&!M){const Ie=m.map(Dt=>{const Vt=Dt.name||Dt.investor_name||Dt.full_name||Dt.investor||Dt.email;return typeof Vt=="string"?Vt.trim():""}).filter(Dt=>Dt.length);if(!Ie.length){const Dt=await ce(null);if(u(Dt.investor||""),b(Number(Dt.initial_value||0)),N(Number(Dt.current_value||0)),C(Number(Dt.moic||0)),A(Number(Dt.roi_pct||0)),T(Dt.irr_pct!==void 0?Number(Dt.irr_pct):null),P(Dt.current_date||Dt.latest_date||""),q(Dt.time_span||null),Dt.join_date){const Vt=new Date(Dt.join_date);Number.isNaN(Vt.getTime())||he(Ja(Vt))}return}let Ke=0,Ve=0,Je=null,ft=null,Nt=null,jt=0,Rt=0;for(const Dt of Ie)try{const Vt=await ce(Dt),Yr=Number(Vt.initial_value||0),ae=Number(Vt.current_value||0);Ke+=Yr,Ve+=ae;const He=Vt.time_span||{};if(He.start_date){const tt=new Date(He.start_date);Number.isNaN(tt.getTime())||(!Je||tt<Je)&&(Je=tt)}if(He.end_date){const tt=new Date(He.end_date);Number.isNaN(tt.getTime())||(!ft||tt>ft)&&(ft=tt)}if(Vt.join_date){const tt=new Date(Vt.join_date);Number.isNaN(tt.getTime())||(!Nt||tt<Nt)&&(Nt=tt)}Vt.irr_pct!==void 0&&Vt.irr_pct!==null&&!Number.isNaN(Number(Vt.irr_pct))&&Yr>0&&(jt+=Number(Vt.irr_pct)*Yr,Rt+=Yr)}catch(Vt){console.warn("Skipping investor in group aggregate due to error:",Dt,Vt)}const Mr=Ke>0?(Ve-Ke)/Ke*100:0,sn=Ke>0?Ve/Ke:0;u(Ie.length===1?Ie[0]:`${Ie[0]} + ${Ie.length-1} more`),b(Ke),N(Ve),C(sn),A(Mr),T(Rt>0?jt/Rt:null);const ln=ft||(H.length?V3(H[H.length-1]):null);if(P(ln?ln.toISOString().slice(0,10):""),Je&&ft){const Vt=(ft-Je)/(1e3*60*60*24*365.25);q({start_date:Je.toISOString().slice(0,10),end_date:ft.toISOString().slice(0,10),years:Vt})}else q(null);Nt&&he(Ja(Nt));return}const ye=new URLSearchParams(ie);M&&ye.set("investor",M);const je=await fetch(`/api/metrics/investor-overview?${ye.toString()}`,{credentials:"include",headers:ve}),Pe=await je.json();if(!je.ok)throw new Error(Pe?.error||`HTTP ${je.status}`);if(u(Pe.investor||""),b(Number(Pe.initial_value||0)),N(Number(Pe.current_value||0)),C(Number(Pe.moic||0)),A(Number(Pe.roi_pct||0)),T(Pe.irr_pct!==void 0?Number(Pe.irr_pct):null),P(Pe.current_date||Pe.latest_date||""),q(Pe.time_span||null),Pe.join_date){const Ie=new Date(Pe.join_date);if(!Number.isNaN(Ie.getTime()))he(Ja(Ie));else if(Pe.time_span?.start_date){const Ke=new Date(Pe.time_span.start_date);Number.isNaN(Ke.getTime())?H.length&&he(H[0]):he(Ja(Ke))}else H.length&&he(H[0])}else if(Pe.time_span?.start_date){const Ie=new Date(Pe.time_span.start_date);Number.isNaN(Ie.getTime())?H.length&&he(H[0]):he(Ja(Ie))}else H.length&&he(H[0])}catch(ye){console.error("Investor overview fetch error:",ye),fe(ye.message||"Investor data not found."),u(""),b(0),N(0),C(0),A(0),T(null),P(""),q(null),he("")}})()},[Q,ne,M,H,r,m,h]);const[Qe,xe]=g.useState({as_of:null,total:0,items:[]}),me=g.useMemo(()=>z?`${String(new Date(z).getFullYear())}-${String(new Date(z).getMonth()+1).padStart(2,"0")}`:_r(ne)?ne:"",[z,ne]);g.useEffect(()=>{let ie=!1;return(async()=>{if(!me){xe({as_of:null,total:0,items:[]});return}try{const ve=await fetch(`/api/metrics/allocation?period_end=${encodeURIComponent(me)}`),ce=await ve.json();if(!ve.ok)throw new Error(ce?.error||`HTTP ${ve.status}`);ie||xe(ce)}catch(ve){console.warn("allocation fetch failed:",ve),ie||xe({as_of:null,total:0,items:[]})}})(),()=>{ie=!0}},[me]);const ze=g.useMemo(()=>!S||!Qe?.items?.length?[]:Qe.items.filter(ie=>(ie.percent||0)>0).map((ie,ve)=>({name:ie.name,value:Number((S*(ie.percent/100)).toFixed(2)),percent:Number(ie.percent),color:ie.color||Im[ve%Im.length]})).filter(ie=>ie.value>0),[Qe,S]),oe=["S&P 500","Dow","Nasdaq","Russell","VIX","Gold"],ke={"S&P 500":"^GSPC",Dow:"^DJI",Nasdaq:"^IXIC",Russell:"^RUT",VIX:"^VIX",Gold:"GC=F"},[Ge,Fe]=g.useState(oe[0]),[Be,xt]=g.useState(()=>`${new Date().getFullYear()}-01`),[Ze,ht]=g.useState(()=>Ja(new Date)),[At,De]=g.useState(Be),[Xe,at]=g.useState(Ze);g.useEffect(()=>{_r(Q)&&(xt(Q),De(Q)),_r(ne)&&(ht(ne),at(ne))},[Q,ne]);const rt=ie=>V3(ie);g.useEffect(()=>{if(!_r(Be)||!_r(Ze))return;let ie=rt(Be),ve=rt(Ze);if(!ie||!ve)return;ie>ve&&([ie,ve]=[ve,ie]);const ce=new Date,ye=new Date(ce.getFullYear(),ce.getMonth(),1);ve>ye&&(ve=ye);const je=Ja(ie),Pe=Ja(ve);je!==Be&&xt(je),Pe!==Ze&&ht(Pe),De(je),at(Pe)},[Be,Ze]);const de=g.useMemo(()=>{if(H.length)return H;if(_r(Be)&&_r(Ze)){const ie=[],ve=new Date(rt(Be)),ce=rt(Ze);for(;ve<=ce;)ie.push(Ja(ve)),ve.setMonth(ve.getMonth()+1);return ie}return[]},[H,Be,Ze]),[Ce,st]=g.useState(null),nt=g.useMemo(()=>{if(!Ce)return(de||[]).map(ce=>({key:ce,label:lo(ce)}));const ie=de.findIndex(ce=>ce===Ce);return(ie===-1?de:de.slice(0,ie+1)).map(ce=>({key:ce,label:lo(ce)}))},[de,Ce]),[gt,lr]=g.useState({}),[Zt,Ue]=g.useState({}),[et,ut]=g.useState(!1),[Bt,er]=g.useState(""),tr=g.useRef(0);g.useEffect(()=>{if(!_r(Be)||!_r(Ze)||!de.length)return;const ie=`${Be}-01`,[ve,ce]=Ze.split("-").map(Number);if(!ve||!ce)return;const je=new Date(ve,ce,0).toISOString().slice(0,10),Pe=++tr.current;ut(!0),er(""),(async()=>{try{const Ie=await fetch(`/api/portfolio/roi_monthly?sheet=${encodeURIComponent(K)}&start=${ie}&end=${je}`);let Ke;try{Ke=await Ie.json()}catch{Ke=null}if(tr.current!==Pe)return;if(!Ie.ok||!Ke||Ke.error||Ke.ok===!1)throw new Error(Ke?.error||`Request failed (${Ie.status})`);const Ve=Array.isArray(Ke.rows)?Ke.rows:[],Je={},ft={};let Nt=null;for(const jt of Ve){if(!jt.date)continue;const Rt=new Date(jt.date);if(Number.isNaN(Rt.getTime()))continue;const Mr=Ja(Rt);if(!Mr)continue;Nt=Mr;const sn=typeof jt.roi_pct=="number"?jt.roi_pct:Number(jt.roi_pct||0);Je[Mr]=Number.isFinite(sn)?sn:0,jt.missing&&(ft[Mr]=!0)}st(Nt),lr(Je),Ue(ft)}catch(Ie){if(tr.current!==Pe)return;er(Ie?.message||String(Ie)),lr({}),Ue({})}finally{tr.current===Pe&&ut(!1)}})()},[Be,Ze,de,K]);const[Me,Ye]=g.useState({}),[it,Ot]=g.useState(""),[ha,zn]=g.useState(!1),Ri=g.useRef(0);g.useEffect(()=>{if(!_r(Be)||!_r(Ze)||!de.length)return;const ie=ke[Ge]||"^GSPC",ve=`${Be}-01`,[ce,ye]=Ze.split("-").map(Number);if(!ce||!ye)return;const Pe=new Date(ce,ye,0).toISOString().slice(0,10),Ie=++Ri.current;zn(!0),Ot(""),(async()=>{try{await fetch(`/api/market/store_history?symbol=${encodeURIComponent(ie)}&start=${ve}&end=${Pe}&interval=1mo`,sy({method:"POST"}));const Ke=await fetch(`/api/market/roi_monthly?symbols=${encodeURIComponent(ie)}&start=${ve}&end=${Pe}`);let Ve;try{Ve=await Ke.json()}catch{Ve=null}if(Ri.current!==Ie)return;if(!Ke.ok||!Ve||Ve.error)throw new Error(Ve?.error||`Benchmark request failed (${Ke.status})`);const Je=Ve.by_symbol||{},ft=Array.isArray(Je[ie])?Je[ie]:[],Nt={};for(const jt of ft){if(!jt.date)continue;const Rt=new Date(jt.date);if(Number.isNaN(Rt.getTime()))continue;const Mr=Ja(Rt);if(!Mr)continue;const sn=typeof jt.roi_pct=="number"?jt.roi_pct:Number(jt.roi_pct||0);Nt[Mr]=Number.isFinite(sn)?sn:0}Ye(Nt)}catch(Ke){if(Ri.current!==Ie)return;Ot(Ke?.message||String(Ke)),Ye({})}finally{Ri.current===Ie&&zn(!1)}})()},[Ge,Be,Ze,de]);const Qn=g.useMemo(()=>nt.map((ie,ve)=>{const ce=ie.key,ye=gt&&Object.prototype.hasOwnProperty.call(gt,ce)?gt[ce]:null,je=Me&&Object.prototype.hasOwnProperty.call(Me,ce)?Me[ce]:null,Pe=typeof ye=="number"?ye:ye!=null?Number(ye)||0:null,Ie=typeof je=="number"?je:je!=null?Number(je)||0:null;return{name:ie.label,elopRoi:Pe,benchRoi:Ie,elopMissing:!!(Zt&&Object.prototype.hasOwnProperty.call(Zt,ce)&&Zt[ce]),idx:ve}}),[nt,gt,Me,Zt]),Tr=g.useCallback(()=>{!_r(At)||!_r(Xe)||(xt(At),ht(Xe))},[At,Xe]),kr=g.useCallback(()=>{const ie=_r(Q)?Q:Be,ve=_r(ne)?ne:Ze;De(ie),at(ve),xt(ie),ht(ve)},[Q,ne,Be,Ze]),$a=iy(_),Mi=_h(_),Ul=mfe(k),F=_h(k),ee=O==null?"muted":_h(O,{allowMuted:!0}),V=O==null?"":iy(O),X=g.useMemo(()=>{const ie=Object.values(Me||{}).filter(ce=>typeof ce=="number"&&Number.isFinite(ce));return ie.length?ie.reduce((ce,ye)=>ce+ye,0)/ie.length:null},[Me]),J=iy(X),re=_h(X,{allowMuted:!0});return l.jsxs("div",{className:"space-y-8",children:[l.jsxs("div",{className:"bg-sky-100 border border-sky-200 rounded-xl p-4 flex flex-col gap-3",children:[l.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[l.jsx("div",{className:"text-slate-700 text-sm",children:o?l.jsxs(l.Fragment,{children:["Viewing as"," ",l.jsx("span",{className:"font-semibold",children:o}),r&&!M&&l.jsx("span",{className:"ml-2 inline-flex items-center rounded-full border border-amber-300 bg-amber-100 px-2 py-0.5 text-[11px] font-semibold uppercase tracking-wide text-amber-800",children:"Group Admin"})]}):l.jsx(l.Fragment,{children:"Your portfolio overview"})}),Ne&&l.jsxs("div",{className:"text-slate-600 text-sm",children:["Since"," ",l.jsx("span",{className:"font-semibold",children:lo(Ne)})]})]}),l.jsxs("div",{className:"flex items-center justify-between gap-3",children:[l.jsx("div",{className:"text-sm font-medium text-slate-700",children:"Investor data range"}),te?l.jsx("div",{className:"text-sm text-slate-500",children:"Loading periods"}):H.length?l.jsx(K3,{months:H,pendingFrom:se,pendingTo:W,setPendingFrom:R,setPendingTo:Y,onApply:G,onReset:ue}):l.jsx("div",{className:"text-sm text-rose-600",children:"No periods available"})]}),B&&l.jsx("div",{className:"mt-2 text-xs text-rose-600",children:B}),v&&r&&l.jsxs("div",{className:"mt-1 text-xs text-rose-600",children:["Group data: ",v]})]}),l.jsx("div",{className:"space-y-4",children:l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"bg-white rounded-xl shadow p-6",children:l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 items-center gap-4",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-slate-500 text-sm",children:"Initial value"}),l.jsx("div",{className:"text-3xl font-bold text-slate-800 mt-1",children:Fm(w)})]}),l.jsx("div",{className:"hidden sm:flex items-center justify-center",children:l.jsxs("svg",{width:"48",height:"24",viewBox:"0 0 48 24",fill:"none",children:[l.jsx("path",{d:"M4 12h36",stroke:"#94a3b8",strokeWidth:"2"}),l.jsx("path",{d:"M32 6l8 6-8 6",fill:"none",stroke:"#94a3b8",strokeWidth:"2"})]})}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-slate-500 text-sm",children:"Current value"}),l.jsx("div",{className:"text-3xl font-bold text-slate-800 mt-1",children:Fm(S)})]})]})}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[l.jsx(Th,{label:"ROI",help:"Return on Investment: (Current  Initial)  Initial within the selected range.",value:$a,accent:Mi}),l.jsx(Th,{label:"MOIC",help:"Multiple on Invested Capital: Current Value  Initial Value.",value:Ul,accent:F})]}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[l.jsx(Th,{label:"IRR",help:"Annualized internal rate of return over the selected time span.",value:V,accent:ee,footnote:Z?.years?`Time span: ${Number(Z.years).toFixed(2)} yrs (${new Date(Z.start_date).toLocaleDateString()}  ${new Date(Z.end_date).toLocaleDateString()})`:void 0}),l.jsx(Th,{label:`ROI Growth (${Ge})`,help:`Average monthly ROI of ${Ge} from ${lo(Be)} to ${lo(Ze)}.`,value:J,accent:re})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow overflow-hidden",children:[l.jsx("div",{className:"flex items-center gap-6 px-6 pt-4 border-b",children:l.jsx("button",{onClick:()=>i("Portfolio Allocation"),className:"py-3 border-b-2 -mb-px transition border-sky-600 text-sky-700",children:"Portfolio Allocation"})}),l.jsx("div",{className:"p-6 grid grid-cols-1 gap-6",children:l.jsx(vfe,{title:"",totalLabel:"Current Value",totalValue:Math.round(S),data:ze})})]})]})}),l.jsxs("div",{className:"bg-white rounded-xl shadow",children:[l.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-3 px-6 py-4 border-b",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-sm text-slate-600",children:"Compare monthly ROI with"}),l.jsx("select",{className:"px-3 py-2 rounded-lg border border-slate-300 bg-white",value:Ge,onChange:ie=>Fe(ie.target.value),children:["S&P 500","Dow","Nasdaq","Russell","VIX","Gold"].map(ie=>l.jsx("option",{value:ie,children:ie},ie))})]}),l.jsx(K3,{months:de,pendingFrom:At,pendingTo:Xe,setPendingFrom:De,setPendingTo:at,onApply:Tr,onReset:kr})]}),l.jsxs("div",{className:"px-6 pt-4",children:[l.jsxs("div",{className:"text-center font-semibold text-slate-800 text-lg",children:["Monthly ROI  ELOP vs ",Ge]}),l.jsxs("div",{className:"text-center text-slate-500 text-xs mb-2",children:[nt[0]?.label??""," "," ",nt[nt.length-1]?.label??""]}),(et||ha)&&l.jsx("div",{className:"text-center text-xs text-slate-500 mb-2",children:"Loading"}),Bt&&l.jsx("div",{className:"text-center text-xs text-rose-600 mb-2",children:Bt}),it&&l.jsx("div",{className:"text-center text-xs text-rose-600 mb-2",children:it})]}),l.jsxs("div",{className:"p-6",children:[l.jsx("div",{className:"h-[440px]",children:l.jsx(la,{width:"100%",height:"100%",children:l.jsxs(Zc,{data:Qn,margin:{top:24,right:20,left:8,bottom:56},barCategoryGap:16,children:[l.jsxs("defs",{children:[l.jsxs("linearGradient",{id:"elopSolid",x1:"0",y1:"0",x2:"0",y2:"1",children:[l.jsx("stop",{offset:"0%",stopColor:"#5B8DEF"}),l.jsx("stop",{offset:"100%",stopColor:"#93C5FD"})]}),l.jsxs("linearGradient",{id:"benchSolid",x1:"0",y1:"0",x2:"0",y2:"1",children:[l.jsx("stop",{offset:"0%",stopColor:"#FF9056"}),l.jsx("stop",{offset:"100%",stopColor:"#FFC2A6"})]})]}),l.jsx(_l,{strokeDasharray:"3 3",vertical:!1}),l.jsx(ki,{dataKey:"name",tick:{fill:"#475569",fontSize:11},angle:-45,textAnchor:"end",height:70}),l.jsx(si,{tickFormatter:ie=>`${Number(ie).toFixed(0)}%`,tick:{fill:"#475569",fontSize:12},domain:["auto","auto"]}),l.jsx(sa,{content:l.jsx(gfe,{benchmark:Ge})}),l.jsx(Ji,{dataKey:"elopRoi",name:"ELOP ROI",radius:[6,6,0,0],fill:"url(#elopSolid)"}),l.jsx(Ji,{dataKey:"benchRoi",name:`${Ge} ROI`,radius:[6,6,0,0],fill:"url(#benchSolid)"})]})})}),l.jsxs("div",{className:"flex justify-center gap-6 mt-4",children:[l.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-700",children:[l.jsx("span",{className:"inline-block w-4 h-3 rounded",style:{background:"linear-gradient(#5B8DEF,#93C5FD)"}})," ","ELOP ROI"]}),l.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-700",children:[l.jsx("span",{className:"inline-block w-4 h-3 rounded",style:{background:"linear-gradient(#FF9056,#FFC2A6)"}})," ",Ge," ROI"]})]})]})]}),l.jsx(ffe,{})]})}const Dc=e=>Number(e||0).toLocaleString(void 0,{style:"currency",currency:"USD",maximumFractionDigits:2}),D8=e=>e==null||Number.isNaN(Number(e))?"":`${Number(e).toFixed(2)}%`,Lm=["#6366F1","#10B981","#60A5FA","#F59E0B","#EF4444","#8B5CF6","#14B8A6","#22C55E","#3B82F6","#EAB308","#F97316","#EC4899","#06B6D4","#84CC16"],kh=e=>typeof e=="string"&&/^\d{4}-(0[1-9]|1[0-2])$/.test(e),yfe=e=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}`,bfe=e=>{if(!e)return"";const[t,r]=e.split("-").map(Number);return new Date(t,r,0).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"2-digit"})},wfe=e=>{if(!e)return null;const[t,r]=e.split("-").map(Number);return new Date(t,r,0)},G3=()=>{if(typeof window>"u")return"";try{const t=(new URLSearchParams(window.location.search).get("investor")||"").trim();return t||(window.localStorage.getItem("investorHint")||"").trim()}catch{return""}};function Sfe({title:e,totalLabel:t,totalValue:r,data:n}){const a=Array.isArray(n)?n:[],[i,o]=g.useState(-1),u=i>=0&&a[i]?a[i].value:r,m=({active:h,payload:x})=>{if(!h||!x||!x.length)return null;const v=x[0]?.payload||{};return l.jsxs("div",{className:"bg-white shadow rounded-lg px-3 py-2 border border-slate-200 text-sm",children:[l.jsx("div",{className:"font-semibold text-slate-800",children:v.name||""}),l.jsx("div",{className:"text-emerald-600",children:D8(v.percent)}),l.jsx("div",{className:"text-slate-700",children:Dc(v.value)})]})},f=h=>{const{cx:x,cy:v,innerRadius:y,outerRadius:w,startAngle:b,endAngle:S,fill:N}=h;return l.jsx(_f,{cx:x,cy:v,innerRadius:y,outerRadius:w+8,startAngle:b,endAngle:S,fill:N})};return l.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[e?l.jsx("div",{className:"text-center mb-3 text-sm text-slate-500",children:e}):null,l.jsx("div",{className:"h-72",children:l.jsx(la,{width:"100%",height:"100%",children:l.jsxs(Xp,{children:[l.jsx(sa,{content:l.jsx(m,{})}),l.jsx(pu,{data:a,dataKey:"value",nameKey:"name",innerRadius:70,outerRadius:105,paddingAngle:2,isAnimationActive:!1,activeIndex:i,activeShape:f,onMouseEnter:(h,x)=>o(x),onMouseMove:(h,x)=>o(x),onMouseLeave:()=>o(-1),children:a.map((h,x)=>l.jsx(ns,{fill:h.color||Lm[x%Lm.length]},x))}),l.jsx("foreignObject",{pointerEvents:"none",x:"0",y:"0",width:"100%",height:"100%",children:l.jsx("div",{className:"w-full h-full grid place-items-center pointer-events-none",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-xs text-slate-500",children:t}),l.jsx("div",{className:"font-bold text-lg",children:Dc(u)})]})})})]})})})]})}const W3="bCAS (Q4 Adj)";function bS(){const{user:e}=g.useContext(Di),r=(e?.user_type||"").toString().replace(/\s+/g,"").toLowerCase()==="groupadmin",[n,a]=g.useState("All"),[i,o]=g.useState("All"),[u,m]=g.useState("All"),[f,h]=g.useState("All"),[x,v]=g.useState(""),y=()=>{const me={};try{const oe=localStorage.getItem("accessToken");if(oe&&oe.split(".").length===3){const ke=JSON.parse(atob(oe.split(".")[1])),Ge=ke.email||ke.upn||ke.preferred_username,Fe=ke.name;Ge&&(me["X-User-Email"]=Ge),Fe&&(me["X-User-Name"]=Fe)}}catch{}const ze=We?.defaults?.headers?.common?.["X-View-As-Investor"];return ze&&(me["X-View-As-Investor"]=String(ze)),me},[w,b]=g.useState([]),[S,N]=g.useState(!0);g.useEffect(()=>{let me=!0;return(async()=>{try{N(!0);const oe=await(await fetch(`/api/metrics/periods?sheet=${encodeURIComponent(W3)}`,{credentials:"include",headers:y()})).json(),Ge=(Array.isArray(oe?.periods)?oe.periods:Array.isArray(oe)?oe:[]).map(Be=>{const xt=typeof Be=="string"?Be:Be?.as_of_date||Be?.date||Be?.as_of||"",Ze=new Date(xt);return Number.isNaN(Ze.getTime())?null:yfe(Ze)}).filter(Boolean),Fe=Array.from(new Set(Ge)).sort((Be,xt)=>Be.localeCompare(xt));me&&b(Fe)}catch{me&&b([])}finally{me&&N(!1)}})(),()=>{me=!1}},[]);const[_,A]=g.useState(""),[k,C]=g.useState(""),[O,T]=g.useState(""),[z,P]=g.useState("");g.useEffect(()=>{if(!w.length)return;const me=w[0],ze=w[w.length-1];A(me),C(ze),T(me),P(ze)},[w]);const Z=g.useCallback(()=>{if(!kh(_)||!kh(k))return;const me=w.findIndex(oe=>oe===_),ze=w.findIndex(oe=>oe===k);me===-1||ze===-1||me>ze||(T(_),P(k))},[_,k,w]),q=g.useCallback(()=>{if(!w.length)return;const me=w[0],ze=w[w.length-1];A(me),C(ze),T(me),P(ze)},[w]),[B,fe]=g.useState([]),[Ne,he]=g.useState(!1);g.useEffect(()=>{if(!r){fe([]),he(!1);return}let me=!0;return(async()=>{he(!0);try{const{data:ze}=await We.get("/api/group-admin/my-group",{headers:{Accept:"application/json"}});if(!me)return;const oe=ze||{},ke=Array.isArray(oe.members)?oe.members:Array.isArray(oe.investors)?oe.investors:[];fe(ke)}catch{me&&fe([])}finally{me&&he(!1)}})(),()=>{me=!1}},[r]);const[K,H]=g.useState(0),[be,te]=g.useState(0),[I,se]=g.useState(0),[R,W]=g.useState(0),[Y,Q]=g.useState("");g.useEffect(()=>{if(!kh(O)||!kh(z)||r&&Ne)return;const me=new URLSearchParams({sheet:W3});me.set("from",`${O}-01`),me.set("to",`${z}-01`);const ze=y(),oe=async ke=>{const Ge=new URLSearchParams(me);ke&&Ge.set("investor",ke);const Fe=await fetch(`/api/metrics/investor-overview?${Ge.toString()}`,{credentials:"include",headers:ze}),Be=await Fe.json();if(!Fe.ok)throw new Error(Be?.error||`HTTP ${Fe.status}`);return Be};(async()=>{try{const ke=G3();if(r&&B.length>0&&!ke){const xt=B.map(rt=>{const de=rt.name||rt.investor_name||rt.full_name||rt.investor||rt.email;return typeof de=="string"?de.trim():""}).filter(rt=>rt.length);if(!xt.length){const rt=await oe(null);H(Number(rt.initial_value||0)),te(Number(rt.current_value||0)),W(Number(rt.moic||0)),se(Number(rt.roi_pct||0)),Q(rt.current_date||rt.latest_date||"");return}let Ze=0,ht=0,At=null;for(const rt of xt)try{const de=await oe(rt),Ce=Number(de.initial_value||0),st=Number(de.current_value||0);Ze+=Ce,ht+=st;const nt=de.time_span||{};if(nt.end_date){const gt=new Date(nt.end_date);Number.isNaN(gt.getTime())||(!At||gt>At)&&(At=gt)}}catch(de){console.warn("Skipping investor in portfolio aggregate due to error:",rt,de)}const De=Ze>0?(ht-Ze)/Ze*100:0,Xe=Ze>0?ht/Ze:0;H(Ze),te(ht),W(Xe),se(De);const at=At||(w.length?wfe(w[w.length-1]):null);Q(at?at.toISOString().slice(0,10):"");return}const Ge=new URLSearchParams(me);ke&&Ge.set("investor",ke);const Fe=await fetch(`/api/metrics/investor-overview?${Ge.toString()}`,{credentials:"include",headers:ze}),Be=await Fe.json();if(!Fe.ok)throw new Error(Be?.error||`HTTP ${Fe.status}`);H(Number(Be.initial_value||0)),te(Number(Be.current_value||0)),W(Number(Be.moic||0)),se(Number(Be.roi_pct||0)),Q(Be.current_date||Be.latest_date||"")}catch(ke){console.warn("Portfolio KPI load failed:",ke),H(0),te(0),W(0),se(0),Q("")}})()},[O,z,r,B,Ne,w]);const L=g.useMemo(()=>{if(Y){const me=new Date(Y);return`${me.getFullYear()}-${String(me.getMonth()+1).padStart(2,"0")}`}return z||""},[Y,z]),[ne,ge]=g.useState([]);g.useEffect(()=>{(async()=>{if(!L){ge([]);return}try{const me=new URLSearchParams({period_end:L}),ze=G3();ze&&me.set("investor",ze);const ke=await(await fetch(`/api/metrics/allocation?${me.toString()}`,{credentials:"include",headers:y()})).json(),Fe=(Array.isArray(ke?.items)?ke.items:[]).filter(Be=>Number(Be.percent)>0).map((Be,xt)=>({name:Be.name,percent:Number(Be.percent),value:Number((be*(Number(Be.percent)/100)).toFixed(2)),color:Be.color||Lm[xt%Lm.length]}));ge(Fe)}catch{ge([])}})()},[L,be]);const[G,ue]=g.useState([]),[Se,M]=g.useState(!1);g.useEffect(()=>{async function me(){M(!0);try{const ze=ne.map((oe,ke)=>({id:ke+1,name:oe.name,current:oe.value,dateYm:L}));ue(ze)}finally{M(!1)}}me()},[ne,L]);const Qe=g.useMemo(()=>{const me=x.trim().toLowerCase();return me?G.filter(ze=>ze.name?.toLowerCase().includes(me)):G},[G,x]),xe=g.useMemo(()=>Qe.reduce((me,ze)=>me+Number(ze.current||0),0),[Qe]);return l.jsxs("div",{className:"space-y-6",children:[l.jsx("h1",{className:"text-2xl font-semibold text-slate-800",children:"Portfolio Summary"}),l.jsx("div",{className:"rounded-xl bg-sky-200/60 border border-sky-200 p-3 flex flex-wrap items-center gap-3",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("select",{className:"rounded-lg bg-white border border-slate-300 px-3 py-2",value:_,onChange:me=>A(me.target.value),children:w.map(me=>l.jsx("option",{value:me,children:me},me))}),l.jsx("span",{className:"text-slate-700",children:"to"}),l.jsx("select",{className:"rounded-lg bg-white border border-slate-300 px-3 py-2",value:k,onChange:me=>C(me.target.value),children:w.slice(Math.max(0,w.indexOf(_))).map(me=>l.jsx("option",{value:me,children:me},me))}),l.jsx("button",{onClick:Z,className:"rounded-lg bg-sky-600 text-white px-3 py-2 text-sm font-medium",children:"Apply"}),l.jsx("button",{onClick:q,className:"rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm",children:"Reset"})]})}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-5",children:[l.jsx("div",{className:"text-slate-700 mb-3 font-medium",children:"Overview"}),l.jsx("div",{className:"rounded-lg bg-slate-50 border border-slate-200 p-5",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-slate-500 text-sm",children:"Initial value"}),l.jsx("div",{className:"text-xl text-sky-700 font-semibold",children:Dc(K)})]}),l.jsx("div",{className:"text-slate-400",children:""}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-slate-500 text-sm",children:"Current value"}),l.jsx("div",{className:"text-xl text-sky-700 font-semibold",children:Dc(be)})]})]})})]}),l.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white grid grid-cols-1 md:grid-cols-2 gap-4 p-5",children:[l.jsxs("div",{className:"rounded-lg border border-slate-200 p-4",children:[l.jsx("div",{className:"text-slate-500 text-sm",children:"ROI"}),l.jsxs("div",{className:"text-emerald-600 text-xl font-semibold",children:[I>=0?"+":"",D8(I)]})]}),l.jsxs("div",{className:"rounded-lg border border-slate-200 p-4",children:[l.jsx("div",{className:"text-slate-500 text-sm",children:"MOIC"}),l.jsxs("div",{className:"text-slate-800 text-xl font-semibold",children:[Number(R||0).toFixed(2),"x"]})]})]})]}),l.jsx("div",{className:"bg-white rounded-xl shadow overflow-hidden",children:l.jsx("div",{className:"p-6 grid grid-cols-1 gap-6",children:l.jsx(Sfe,{title:"Portfolio Allocation",totalLabel:"Current Value",totalValue:Math.round(be),data:ne})})})]}),l.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white",children:[l.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-slate-200",children:[l.jsx("input",{className:"w-80 rounded-lg border border-slate-300 px-3 py-2 bg-slate-50 outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100",placeholder:"Search by anything",value:x,onChange:me=>v(me.target.value)}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{className:"rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm",children:"Export"}),l.jsx("button",{className:"rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm",children:"Edit columns"})]})]}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full text-sm",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"bg-slate-50 text-slate-600",children:[l.jsx("th",{colSpan:3,className:"text-left px-5 py-3 font-medium",children:"NAME"}),l.jsx("th",{className:"text-right px-5 py-3 font-medium",children:"INVESTMENT"}),l.jsx("th",{className:"px-5 py-3 font-medium"}),l.jsx("th",{className:"px-5 py-3 font-medium"}),l.jsx("th",{className:"px-5 py-3 font-medium"}),l.jsx("th",{className:"px-5 py-3 font-medium"}),l.jsx("th",{className:"px-5 py-3 font-medium"}),l.jsx("th",{colSpan:2,className:"text-left px-5 py-3 font-medium",children:"DATE"})]})}),l.jsx("tbody",{children:Se?l.jsx("tr",{children:l.jsx("td",{className:"px-5 py-6 text-slate-500",colSpan:11,children:"Loading..."})}):Qe.length===0?l.jsx("tr",{children:l.jsx("td",{className:"px-5 py-6 text-slate-500",colSpan:11,children:"No results"})}):l.jsxs(l.Fragment,{children:[Qe.map(me=>l.jsxs("tr",{className:"border-t",children:[l.jsx("td",{colSpan:3,className:"px-5 py-3 text-sky-700",children:me.name}),l.jsx("td",{className:"px-5 py-3 text-right tabular-nums",children:Dc(me.current)}),l.jsx("td",{className:"px-5 py-3"}),l.jsx("td",{className:"px-5 py-3"}),l.jsx("td",{className:"px-5 py-3"}),l.jsx("td",{className:"px-5 py-3"}),l.jsx("td",{className:"px-5 py-3"}),l.jsx("td",{colSpan:2,className:"px-5 py-3",children:bfe(me.dateYm)})]},me.id)),l.jsxs("tr",{className:"border-t bg-slate-50",children:[l.jsx("td",{className:"px-5 py-3 font-semibold text-left",children:"Total Investment"}),l.jsx("td",{className:"px-5 py-3"}),l.jsx("td",{className:"px-5 py-3"}),l.jsx("td",{className:"px-5 py-3 font-semibold text-right tabular-nums",children:Dc(xe)}),l.jsx("td",{className:"px-5 py-3"}),l.jsx("td",{className:"px-5 py-3"}),l.jsx("td",{className:"px-5 py-3"}),l.jsx("td",{className:"px-5 py-3"}),l.jsx("td",{className:"px-5 py-3"}),l.jsx("td",{colSpan:2,className:"px-5 py-3"})]})]})})]})})]})]})}var P8={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},X3=tn.createContext&&tn.createContext(P8),jfe=["attr","size","title"];function Nfe(e,t){if(e==null)return{};var r=Efe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Efe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Bm(){return Bm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Bm.apply(this,arguments)}function Y3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Um(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Y3(Object(r),!0).forEach(function(n){Afe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Y3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Afe(e,t,r){return t=_fe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _fe(e){var t=Tfe(e,"string");return typeof t=="symbol"?t:t+""}function Tfe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function R8(e){return e&&e.map((t,r)=>tn.createElement(t.tag,Um({key:r},t.attr),R8(t.child)))}function fa(e){return t=>tn.createElement(kfe,Bm({attr:Um({},e.attr)},t),R8(e.child))}function kfe(e){var t=r=>{var{attr:n,size:a,title:i}=e,o=Nfe(e,jfe),u=a||r.size||"1em",m;return r.className&&(m=r.className),e.className&&(m=(m?m+" ":"")+e.className),tn.createElement("svg",Bm({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,n,o,{className:m,style:Um(Um({color:e.color||r.color},r.style),e.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),i&&tn.createElement("title",null,i),e.children)};return X3!==void 0?tn.createElement(X3.Consumer,null,r=>t(r)):t(P8)}function Cfe(e){return fa({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 48C141.31 48 48 141.31 48 256s93.31 208 208 208 208-93.31 208-208S370.69 48 256 48zm108.25 138.29-134.4 160a16 16 0 0 1-12 5.71h-.27a16 16 0 0 1-11.89-5.3l-57.6-64a16 16 0 1 1 23.78-21.4l45.29 50.32 122.59-145.91a16 16 0 0 1 24.5 20.58z"},child:[]}]})(e)}function Pb(e){return fa({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"m289.94 256 95-95A24 24 0 0 0 351 127l-95 95-95-95a24 24 0 0 0-34 34l95 95-95 95a24 24 0 1 0 34 34l95-95 95 95a24 24 0 0 0 34-34z"},child:[]}]})(e)}const Z3=(...e)=>e.filter(Boolean).join(" "),Q3=e=>e==null||Number.isNaN(e)?"":new Intl.NumberFormat(void 0,{style:"currency",currency:"USD"}).format(Number(e)),gs=e=>{if(!e)return"";const t=e instanceof Date?e:new Date(e);return Number.isNaN(t.getTime())?"":t.toISOString().slice(0,10)},Ofe=(e="")=>{const t=(e||"").toLowerCase().match(/\.([a-z0-9]+)$/i);return t?t[1]:""};function Dfe(e,t){const r=t.map(o=>o.map(u=>{const m=u==null?"":String(u);return/[",\n]/.test(m)?`"${m.replace(/"/g,'""')}"`:m}).join(",")).join(`
`),n=new Blob([r],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(n),i=document.createElement("a");i.href=a,i.download=e,i.click(),setTimeout(()=>URL.revokeObjectURL(a),600)}function Pfe(){if(typeof window>"u")return null;try{const t=new URL(window.location.href).searchParams.get("investorId"),r=window.localStorage.getItem("currentInvestorId"),n=t||r;return n?Number(n):null}catch{return null}}function wS({profiles:e=[],adminView:t=!1,investorId:r=null}){const[n,a]=g.useState([]),[i,o]=g.useState(!1),[u,m]=g.useState(""),[f,h]=g.useState([]),[x,v]=g.useState(!1),[y,w]=g.useState(""),[b,S]=g.useState({ready:!1,user:null,investor:null}),[N,_]=g.useState("All profiles"),[A,k]=g.useState("All"),[C,O]=g.useState(""),[T,z]=g.useState(!0),[P,Z]=g.useState(!1),q=g.useRef(null),[B,fe]=g.useState(null),[Ne,he]=g.useState({top:0,left:0}),K=g.useRef(null),H=g.useRef(null),[be,te]=g.useState(null),[I,se]=g.useState(null),[R,W]=g.useState(!1),[Y,Q]=g.useState(""),[L,ne]=g.useState(""),[ge,G]=g.useState(""),ue=g.useRef(null),Se=new Date,[M,Qe]=g.useState(Se.getFullYear()),[xe,me]=g.useState(Math.floor(Se.getMonth()/3)+1),[ze,oe]=g.useState("Elpis Opportunity Fund LP"),[ke,Ge]=g.useState(!1),[Fe,Be]=g.useState({name:!0,investor:!0,entity:!0,dueDate:!0,status:!0,amountDue:!0,paidDate:!0,download:!0,actions:!0}),[xt,Ze]=g.useState(!1),[ht,At]=g.useState(null),[De,Xe]=g.useState(null),[at,rt]=g.useState(null),[de,Ce]=g.useState(!1);g.useEffect(()=>{let Me=!0;return(async()=>{try{const{data:Ye}=await We.get("/auth/me",{headers:{Accept:"application/json"}});if(!Me)return;S({ready:!0,user:Ye?.user||null,investor:Ye?.investor||null})}catch{if(!Me)return;S({ready:!0,user:null,investor:null})}})(),()=>{Me=!1}},[]);const st=Pfe(),nt=t&&r!=null&&r!==void 0?r:st??null;async function gt(){o(!0),m("");try{const Me=nt?{investor_id:nt}:void 0,{data:Ye}=await We.get("/api/statements",{...Me?{params:Me}:{}});let it=[];Array.isArray(Ye)?it=Ye:Ye&&typeof Ye=="object"&&(Array.isArray(Ye.items)?it=Ye.items:Array.isArray(Ye.data)?it=Ye.data:Array.isArray(Ye.statements)&&(it=Ye.statements)),a(it)}catch(Me){m(String(Me?.response?.data?.error||Me.message||Me))}finally{o(!1)}}async function lr(){v(!0),w("");try{const Me={share_type:"statement"};nt&&(Me.investor_id=nt);const{data:Ye}=await We.get("/api/documents",{params:Me});let it=[];Array.isArray(Ye?.documents)?it=Ye.documents:Array.isArray(Ye)&&(it=Ye),h(it)}catch(Me){w(String(Me?.response?.data?.error||Me.message||Me))}finally{v(!1)}}g.useEffect(()=>{b.ready&&(gt(),lr())},[b.ready,nt,t]);const Zt=g.useMemo(()=>{const Me=C.trim().toLowerCase();let Ye=n.map(it=>({...it,_due:new Date(it.dueDate)}));return N&&N!=="All profiles"&&N!=="Filter by all profiles"&&(Ye=Ye.filter(it=>(it.profile||it.entity||"").toLowerCase().includes(N.toLowerCase()))),A==="Outstanding"&&(Ye=Ye.filter(it=>String(it.status).toLowerCase()==="outstanding")),A==="Paid"&&(Ye=Ye.filter(it=>String(it.status).toLowerCase()==="paid")),Me&&(Ye=Ye.filter(it=>[it.name,it.investor,it.entity,it.status,gs(it.dueDate),gs(it.paidDate),it.amountDue].map(Ot=>Ot==null?"":String(Ot)).some(Ot=>Ot.toLowerCase().includes(Me)))),Ye.sort((it,Ot)=>(it._due-Ot._due)*(T?1:-1)),Ye},[n,N,A,C,T]);function Ue(){const Me=[Fe.name&&"Name",Fe.investor&&"Investor",Fe.entity&&"Entity",Fe.dueDate&&"Due Date",Fe.status&&"Status",Fe.amountDue&&"Amount Due",Fe.paidDate&&"Paid Date"].filter(Boolean),Ye=Zt.map(it=>[Fe.name&&it.name,Fe.investor&&it.investor,Fe.entity&&it.entity,Fe.dueDate&&gs(it.dueDate),Fe.status&&it.status,Fe.amountDue&&it.amountDue,Fe.paidDate&&gs(it.paidDate)].filter(Boolean));Dfe("statements.csv",[Me,...Ye])}async function et(Me){te(Me),se(null),Q(""),G(""),W(!0);try{const Ye=await We.get(`/api/statements/${Me}/pdf`,{responseType:"blob",params:{inline:1}});ue.current&&URL.revokeObjectURL(ue.current);const it=URL.createObjectURL(Ye.data);ue.current=it,ne(`${it}#toolbar=0`)}catch(Ye){G(Ye?.response?.data?.error||Ye.message||"Failed to load the PDF preview."),ne("")}try{const{data:Ye,headers:it}=await We.get(`/api/statements/${Me}`,{headers:{Accept:"application/json"}});if(typeof Ye!="object"){const Ot=it?.["content-type"]||"unknown";throw new Error(`Server did not return JSON (content-type: ${Ot}).`)}se(Ye)}catch(Ye){Q(String(Ye?.response?.data?.error||Ye.message||Ye))}finally{W(!1)}}function ut(){te(null),se(null),Q(""),ne(""),G(""),ue.current&&(URL.revokeObjectURL(ue.current),ue.current=null)}g.useEffect(()=>()=>{ue.current&&(URL.revokeObjectURL(ue.current),ue.current=null)},[]);async function Bt(Me){if(Me?.id&&window.confirm(`Delete this statement?

${Me.name}
Investor: ${Me.investor}
Entity: ${Me.entity}`))try{await We.delete(`/api/statements/${Me.id}`),a(Ye=>Ye.filter(it=>it.id!==Me.id))}catch(Ye){alert(`Failed to delete: ${Ye?.response?.data?.error||Ye.message||Ye}`)}finally{fe(null)}}async function er(Me){Ze(!0),At(Me),Xe(null),rt(null),Ce(!0);try{const Ye=await We.get(`/api/documents/view/${Me.id}`,{responseType:"blob"});if((Ye.headers["content-type"]||Me.mime_type||"application/octet-stream").startsWith("text/")||["csv","json","txt","md"].includes(Ofe(Me.original_name))){const Ot=await Ye.data.text();rt(Ot)}else{const Ot=URL.createObjectURL(Ye.data);Xe(Ot)}}catch{alert("Could not open preview. Try Download.")}finally{Ce(!1)}}function tr(){Ze(!1),De&&URL.revokeObjectURL(De),Xe(null),rt(null),At(null)}return g.useEffect(()=>()=>{De&&URL.revokeObjectURL(De)},[De]),g.useEffect(()=>{const Me=it=>{H.current&&H.current.contains(it.target)||(q.current&&!q.current.contains(it.target)&&Z(!1),K.current&&!K.current.contains(it.target)&&fe(null))},Ye=()=>fe(null);return document.addEventListener("mousedown",Me),window.addEventListener("scroll",Ye,!0),window.addEventListener("resize",Ye),()=>{document.removeEventListener("mousedown",Me),window.removeEventListener("scroll",Ye,!0),window.removeEventListener("resize",Ye)}},[]),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white shadow-sm",children:[l.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 border-b border-slate-200 px-4 py-3",children:[l.jsx("input",{type:"text",value:C,onChange:Me=>O(Me.target.value),placeholder:"Search by anything",className:"w-72 max-w-[60%] flex-1 rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-sky-200"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("button",{onClick:Ue,className:"inline-flex items-center gap-2 rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50",title:"Export visible rows to CSV",children:[l.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"opacity-70",children:[l.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),l.jsx("polyline",{points:"7 10 12 15 17 10"}),l.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),"Export"]}),l.jsxs("div",{className:"relative hidden md:block",ref:q,children:[l.jsxs("button",{onClick:()=>Z(Me=>!Me),className:"inline-flex items-center gap-2 rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50",title:"Show / hide columns",children:[l.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"opacity-70",children:[l.jsx("line",{x1:"4",y1:"21",x2:"4",y2:"14"}),l.jsx("line",{x1:"4",y1:"10",x2:"4",y2:"3"}),l.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"12"}),l.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"3"}),l.jsx("line",{x1:"20",y1:"21",x2:"20",y2:"16"}),l.jsx("line",{x1:"20",y1:"12",x2:"20",y2:"3"}),l.jsx("line",{x1:"1",y1:"14",x2:"7",y2:"14"}),l.jsx("line",{x1:"9",y1:"8",x2:"15",y2:"8"}),l.jsx("line",{x1:"17",y1:"16",x2:"23",y2:"16"})]}),"Edit columns"]}),P&&l.jsx("div",{className:"absolute right-0 z-10 mt-2 w-64 rounded-xl border border-slate-200 bg-white p-2 text-sm shadow-lg",children:Object.keys(Fe).map(Me=>l.jsxs("label",{className:"flex items-center justify-between rounded-lg px-2 py-1.5 hover:bg-slate-50",children:[l.jsx("span",{className:"capitalize text-slate-700",children:Me==="dueDate"?"Due Date":Me==="paidDate"?"Paid Date":Me==="actions"?"Actions":Me.charAt(0).toUpperCase()+Me.slice(1)}),l.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:Fe[Me],onChange:()=>Be(Ye=>({...Ye,[Me]:!Ye[Me]}))})]},Me))})]})]})]}),l.jsx("div",{className:"hidden overflow-x-auto md:block",children:l.jsxs("table",{className:"min-w-full table-fixed",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"text-left text-xs font-semibold uppercase tracking-wide text-slate-500",children:[Fe.name&&l.jsx("th",{className:"w-[17%] px-4 py-3",children:"Name"}),Fe.investor&&l.jsx("th",{className:"w-[17%] px-4 py-3",children:"Investor"}),Fe.entity&&l.jsx("th",{className:"w-[17%] px-4 py-3",children:"Entity"}),Fe.dueDate&&l.jsx("th",{className:"w-[12%] px-4 py-3",children:l.jsxs("button",{onClick:()=>z(Me=>!Me),className:"inline-flex items-center gap-1 text-slate-500 hover:text-slate-700",title:"Sort by Due Date",children:[l.jsx("span",{children:"Due Date"}),l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:T?l.jsx("polyline",{points:"6 15 12 9 18 15"}):l.jsx("polyline",{points:"6 9 12 15 18 9"})})]})}),Fe.status&&l.jsx("th",{className:"w-[10%] px-4 py-3",children:"Status"}),Fe.amountDue&&l.jsx("th",{className:"w-[10%] px-4 py-3",children:"Amount Due"}),Fe.paidDate&&l.jsx("th",{className:"w-[10%] px-4 py-3",children:"Paid Date"}),Fe.download&&l.jsx("th",{className:"w-[7%] px-4 py-3",children:"PDF"}),Fe.actions&&l.jsx("th",{className:"w-[7%] px-4 py-3",children:"Actions"})]})}),l.jsxs("tbody",{className:"divide-y divide-slate-100 text-sm",children:[i&&l.jsx("tr",{children:l.jsx("td",{className:"px-4 py-10 text-center text-slate-500",colSpan:9,children:"Loading"})}),!!u&&!i&&l.jsx("tr",{children:l.jsx("td",{className:"px-4 py-10 text-center text-rose-600",colSpan:9,children:u})}),!i&&!u&&Zt.length===0&&l.jsx("tr",{children:l.jsx("td",{className:"px-4 py-12 text-center text-slate-500",colSpan:9,children:b.ready?"Nothing to display":"Loading"})}),Zt.map(Me=>l.jsxs("tr",{className:"hover:bg-slate-50/60",children:[Fe.name&&l.jsx("td",{className:"truncate px-4 py-3 font-medium text-slate-800",title:Me.name,children:Me.name}),Fe.investor&&l.jsx("td",{className:"truncate px-4 py-3 text-slate-700",title:Me.investor,children:Me.investor}),Fe.entity&&l.jsx("td",{className:"truncate px-4 py-3 text-slate-700",title:Me.entity,children:Me.entity}),Fe.dueDate&&l.jsx("td",{className:"px-4 py-3 text-slate-700",children:gs(Me.dueDate)||""}),Fe.status&&l.jsx("td",{className:"px-4 py-3",children:l.jsx("span",{className:Z3("inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium",String(Me.status).toLowerCase()==="paid"?"bg-green-50 text-green-700 ring-1 ring-green-200":"bg-amber-50 text-amber-700 ring-1 ring-amber-200"),children:Me.status})}),Fe.amountDue&&l.jsx("td",{className:"px-4 py-3 tabular-nums text-slate-800",children:Q3(Me.amountDue)}),Fe.paidDate&&l.jsx("td",{className:"px-4 py-3 text-slate-700",children:gs(Me.paidDate)||""}),Fe.download&&l.jsx("td",{className:"px-4 py-3",children:Me.pdfAvailable?l.jsx("a",{href:`/api/statements/${Me.id}/pdf`,className:"rounded-lg border border-slate-300 bg-white px-3 py-1.5 text-sm text-slate-700 hover:bg-slate-50",children:"Download"}):l.jsx("span",{className:"text-slate-400",children:""})}),Fe.actions&&l.jsxs("td",{className:"px-4 py-3",ref:K,children:[l.jsx("button",{onClick:Ye=>{const it=Ye.currentTarget.getBoundingClientRect();he({top:it.bottom+8,left:Math.max(8,it.right-144)}),fe(Ot=>Ot===Me.id?null:Me.id)},className:"inline-flex h-9 w-9 items-center justify-center rounded-full border border-slate-300 bg-white text-slate-700 hover:bg-slate-50",title:"Actions",children:l.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:[l.jsx("circle",{cx:"12",cy:"5",r:"2"}),l.jsx("circle",{cx:"12",cy:"12",r:"2"}),l.jsx("circle",{cx:"12",cy:"19",r:"2"})]})}),B===Me.id&&qd.createPortal(l.jsxs("div",{ref:H,style:{position:"fixed",top:Ne.top,left:Ne.left,zIndex:1e3},className:"w-36 overflow-hidden rounded-lg border border-slate-200 bg-white shadow-lg",children:[l.jsx("button",{onClick:()=>{fe(null),et(Me.id)},className:"block w-full px-3 py-2 text-left text-sm text-slate-700 hover:bg-slate-50",children:"View"}),l.jsx("button",{onClick:()=>Bt(Me),className:"block w-full px-3 py-2 text-left text-sm text-rose-600 hover:bg-rose-50",children:"Delete"})]}),document.body)]})]},Me.id))]})]})}),l.jsxs("div",{className:"md:hidden",children:[i&&l.jsx("div",{className:"px-4 py-8 text-center text-slate-500",children:"Loading"}),!!u&&!i&&l.jsx("div",{className:"px-4 py-8 text-center text-rose-600",children:u}),!i&&!u&&Zt.length===0&&l.jsx("div",{className:"px-4 py-12 text-center text-slate-500",children:b.ready?"Nothing to display":"Loading"}),l.jsx("ul",{className:"divide-y divide-slate-100",children:Zt.map(Me=>l.jsxs("li",{className:"p-4",children:[l.jsxs("div",{className:"flex items-start justify-between gap-3",children:[l.jsxs("div",{className:"min-w-0",children:[l.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:Me.name}),l.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[Me.investor,"  ",Me.entity]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[Me.pdfAvailable?l.jsx("a",{href:`/api/statements/${Me.id}/pdf`,className:"rounded-lg border border-slate-300 bg-white px-2.5 py-1 text-xs text-slate-700 hover:bg-slate-50",children:"PDF"}):null,l.jsx("button",{onClick:Ye=>{const it=Ye.currentTarget.getBoundingClientRect();he({top:it.bottom+8,left:Math.max(8,it.right-144)}),fe(Ot=>Ot===Me.id?null:Me.id)},className:"inline-flex h-8 w-8 items-center justify-center rounded-full border border-slate-300 bg-white text-slate-700 hover:bg-slate-50",title:"Actions",ref:K,children:l.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:[l.jsx("circle",{cx:"12",cy:"5",r:"2"}),l.jsx("circle",{cx:"12",cy:"12",r:"2"}),l.jsx("circle",{cx:"12",cy:"19",r:"2"})]})})]})]}),l.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-3 text-sm",children:[l.jsxs("div",{className:"rounded-lg bg-slate-50 px-3 py-2",children:[l.jsx("div",{className:"text-xs text-slate-500",children:"Due"}),l.jsx("div",{className:"text-slate-800",children:gs(Me.dueDate)||""})]}),l.jsxs("div",{className:"rounded-lg bg-slate-50 px-3 py-2",children:[l.jsx("div",{className:"text-xs text-slate-500",children:"Amount"}),l.jsx("div",{className:"tabular-nums text-slate-800",children:Q3(Me.amountDue)})]}),l.jsxs("div",{className:"rounded-lg bg-slate-50 px-3 py-2",children:[l.jsx("div",{className:"text-xs text-slate-500",children:"Status"}),l.jsx("div",{className:Z3("inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium",String(Me.status).toLowerCase()==="paid"?"bg-green-50 text-green-700 ring-1 ring-green-200":"bg-amber-50 text-amber-700 ring-1 ring-amber-200"),children:Me.status})]}),l.jsxs("div",{className:"rounded-lg bg-slate-50 px-3 py-2",children:[l.jsx("div",{className:"text-xs text-slate-500",children:"Paid"}),l.jsx("div",{className:"text-slate-800",children:gs(Me.paidDate)||""})]})]}),B===Me.id&&qd.createPortal(l.jsxs("div",{ref:H,style:{position:"fixed",top:Ne.top,left:Ne.left,zIndex:1e3},className:"w-36 overflow-hidden rounded-lg border border-slate-200 bg-white shadow-lg",children:[l.jsx("button",{onClick:()=>{fe(null),et(Me.id)},className:"block w-full px-3 py-2 text-left text-sm text-slate-700 hover:bg-slate-50",children:"View"}),l.jsx("button",{onClick:()=>Bt(Me),className:"block w-full px-3 py-2 text-left text-sm text-rose-600 hover:bg-rose-50",children:"Delete"})]}),document.body)]},Me.id))})]})]}),l.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white shadow-sm",children:[l.jsxs("div",{className:"flex items-center justify-between border-b border-slate-200 px-4 py-3",children:[l.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Uploaded statements (shared files)"}),x&&l.jsx("span",{className:"text-xs text-slate-500",children:"Loading"})]}),l.jsxs("div",{className:"px-4 py-3",children:[y&&l.jsx("div",{className:"text-sm text-rose-600",children:y}),!y&&!x&&f.length===0&&l.jsx("div",{className:"text-sm text-slate-500",children:"No uploaded statements have been shared with you yet."}),!y&&f.length>0&&l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full table-fixed text-sm",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"text-left text-xs font-semibold uppercase tracking-wide text-slate-500",children:[l.jsx("th",{className:"w-[55%] px-2 py-2",children:"Name"}),l.jsx("th",{className:"w-[25%] px-2 py-2",children:"Uploaded"}),l.jsx("th",{className:"w-[20%] px-2 py-2",children:"Actions"})]})}),l.jsx("tbody",{className:"divide-y divide-slate-100",children:f.map(Me=>l.jsxs("tr",{className:"hover:bg-slate-50/60",children:[l.jsx("td",{className:"truncate px-2 py-2 font-medium text-slate-800",title:Me.title||Me.original_name,children:Me.title||Me.original_name}),l.jsx("td",{className:"px-2 py-2 text-slate-700",children:gs(Me.uploaded_at)}),l.jsx("td",{className:"px-2 py-2",children:l.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[l.jsx("button",{type:"button",className:"inline-flex items-center rounded-lg border border-slate-300 bg-white px-3 py-1.5 text-xs text-slate-700 hover:bg-slate-50",onClick:()=>er(Me),children:"View"}),l.jsx("a",{href:`/api/documents/download/${Me.id}`,className:"inline-flex items-center rounded-lg border border-slate-300 bg-white px-3 py-1.5 text-xs text-slate-700 hover:bg-slate-50",children:"Download"})]})})]},Me.id))})]})})]})]}),xt&&l.jsx("div",{className:"fixed inset-0 z-40 bg-black/60 flex items-center justify-center",onMouseDown:tr,children:l.jsxs("div",{className:"bg-white w-[92vw] max-w-5xl max-h-[85vh] rounded-2xl shadow-2xl overflow-hidden",onMouseDown:Me=>Me.stopPropagation(),children:[l.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",children:[l.jsx("div",{className:"font-semibold text-gray-800 truncate",children:ht?.title||ht?.original_name}),l.jsxs("div",{className:"flex items-center gap-3",children:[ht&&l.jsx("a",{className:"text-blue-600 hover:underline",href:`/api/documents/download/${ht.id}`,target:"_blank",rel:"noreferrer",children:"Download"}),l.jsx("button",{className:"p-2 rounded hover:bg-slate-100",onClick:tr,"aria-label":"Close",children:l.jsx(Pb,{size:18})})]})]}),l.jsxs("div",{className:"p-0 bg-slate-50 h-[75vh] overflow-hidden",children:[de&&l.jsx("div",{className:"h-full grid place-items-center text-sm text-slate-600",children:"Loading preview"}),!de&&De&&(ht?.mime_type||"").includes("pdf")&&l.jsx("iframe",{title:"File preview",src:De,className:"w-full h-full"}),!de&&De&&ht&&ht.mime_type&&ht.mime_type.startsWith("image/")&&l.jsx("img",{src:De,alt:"preview",className:"max-h-full max-w-full object-contain mx-auto"}),!de&&at&&l.jsx("pre",{className:"h-full overflow-auto p-4 whitespace-pre-wrap text-[13px] leading-5",children:at}),!de&&!De&&!at&&l.jsx("div",{className:"h-full grid place-items-center text-sm text-slate-600",children:"No preview available. Use Download instead."})]})]})}),be!==null&&l.jsxs("div",{className:"fixed inset-0 z-30",children:[l.jsx("div",{className:"absolute inset-0 bg-black/20",onClick:ut}),l.jsxs("div",{className:"absolute right-0 top-0 h-full w-full max-w-[920px] overflow-y-auto rounded-l-2xl bg-white shadow-2xl",children:[l.jsxs("div",{className:"flex items-center justify-between border-b border-slate-200 px-5 py-4",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"text-sm text-slate-500",children:[I?.entity,"  ",I?.investor]}),l.jsxs("div",{className:"text-base font-semibold text-slate-900",children:["Statement ",I?.period?.start," "," ",I?.period?.end]})]}),l.jsx("button",{onClick:ut,className:"rounded-full border border-slate-300 bg-white px-3 py-1.5 text-sm hover:bg-slate-50",children:"Close"})]}),l.jsxs("div",{className:"p-5",children:[l.jsx("div",{className:"mb-4 rounded-xl border border-slate-200 bg-slate-50",children:L?l.jsx("iframe",{title:"Statement PDF preview",src:L,style:{width:"100%",height:"72vh",border:0},onError:()=>G("Failed to load the PDF preview.")},be):null}),ge&&l.jsxs("div",{className:"mb-4 text-center text-sm text-rose-600",children:[ge," ",be?l.jsx("a",{className:"underline",href:`/api/statements/${be}/pdf`,children:"Download instead"}):null]}),R&&l.jsx("div",{className:"py-10 text-center text-slate-500",children:"Loading"}),!!Y&&l.jsx("div",{className:"whitespace-pre-wrap py-10 text-center text-rose-600",children:Y})]})]})]})]})}function Rfe(e){return fa({attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M854.6 288.7L639.4 73.4c-6-6-14.2-9.4-22.7-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.6-9.4-22.6zM400 402c22.1 0 40 17.9 40 40s-17.9 40-40 40-40-17.9-40-40 17.9-40 40-40zm296 294H328c-6.7 0-10.4-7.7-6.3-12.9l99.8-127.2a8 8 0 0 1 12.6 0l41.1 52.4 77.8-99.2a8 8 0 0 1 12.6 0l136.5 174c4.3 5.2.5 12.9-6.1 12.9zm-94-370V137.8L790.2 326H602z"},child:[]}]})(e)}function Rb(e){return fa({attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M880 298.4H521L403.7 186.2a8.15 8.15 0 0 0-5.5-2.2H144c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V330.4c0-17.7-14.3-32-32-32z"},child:[]}]})(e)}function J3(e){return fa({attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M518.3 459a8 8 0 0 0-12.6 0l-112 141.7a7.98 7.98 0 0 0 6.3 12.9h73.9V856c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V613.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 459z"},child:[]},{tag:"path",attr:{d:"M811.4 366.7C765.6 245.9 648.9 160 512.2 160S258.8 245.8 213 366.6C127.3 389.1 64 467.2 64 560c0 110.5 89.5 200 199.9 200H304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8h-40.1c-33.7 0-65.4-13.4-89-37.7-23.5-24.2-36-56.8-34.9-90.6.9-26.4 9.9-51.2 26.2-72.1 16.7-21.3 40.1-36.8 66.1-43.7l37.9-9.9 13.9-36.6c8.6-22.8 20.6-44.1 35.7-63.4a245.6 245.6 0 0 1 52.4-49.9c41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.2c19.9 14 37.5 30.8 52.4 49.9 15.1 19.3 27.1 40.7 35.7 63.4l13.8 36.5 37.8 10C846.1 454.5 884 503.8 884 560c0 33.1-12.9 64.3-36.3 87.7a123.07 123.07 0 0 1-87.6 36.3H720c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h40.1C870.5 760 960 670.5 960 560c0-92.7-63.1-170.7-148.6-193.3z"},child:[]}]})(e)}function Mfe(e){return fa({attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0 0 42 42h216v494z"},child:[]}]})(e)}const eC="/api/documents",Ffe="/api/document-folders";function tC(...e){return e.filter(Boolean).join(" ")}function ly(e){if(!e)return"";const t=e instanceof Date?e:new Date(e);return Number.isNaN(t.getTime())?"":t.toLocaleDateString()}function SS(e=""){const t=String(e).toLowerCase().match(/\.([a-z0-9]+)$/);return t?t[1]:""}const Ife=new Set(["png","jpg","jpeg","gif","webp","bmp","svg"]),Lfe=new Set(["txt","csv","log","json","md","ts","js","py","xml","yaml","yml"]),Bfe=e=>Ife.has(SS(e)),Ufe=e=>SS(e)==="pdf",$fe=e=>Lfe.has(SS(e));function zfe(){if(typeof window>"u")return null;try{const t=new URL(window.location.href).searchParams.get("investorId"),r=window.localStorage.getItem("currentInvestorId"),n=t||r;return n?Number(n):null}catch{return null}}function rC({anchorRect:e,onClose:t,children:r}){const[n,a]=g.useState({top:0,left:0}),i=g.useRef(null);return g.useEffect(()=>{function o(){if(!e)return;const f=i.current?.getBoundingClientClientRect?.()??i.current?.getBoundingClientRect?.(),h=window.innerWidth,x=window.innerHeight,v=8;let y=e.left,w=e.bottom+6;const b=f?.width||220,S=f?.height||240;y+b+v>h&&(y=Math.max(v,h-b-v)),w+S+v>x&&(w=Math.max(v,e.top-S-6)),a({top:w,left:y})}o();const u=()=>o(),m=()=>t();return window.addEventListener("resize",u),window.addEventListener("scroll",u,!0),window.addEventListener("mousedown",m),()=>{window.removeEventListener("resize",u),window.removeEventListener("scroll",u,!0),window.removeEventListener("mousedown",m)}},[e,t]),Hb.createPortal(l.jsx("div",{ref:i,style:{position:"fixed",top:n.top,left:n.left,zIndex:1e4},className:"w-52 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",onMouseDown:o=>o.stopPropagation(),children:r}),document.body)}function Hfe({open:e,onClose:t,file:r,fetchBlob:n,onDownload:a}){const[i,o]=g.useState(null),[u,m]=g.useState(""),[f,h]=g.useState(!1),[x,v]=g.useState("");if(g.useEffect(()=>{if(!e||!r)return;let N=!1,_=null;return(async()=>{try{h(!0),v("");const A=await n(r);if(N)return;m(A?.type||""),_=URL.createObjectURL(A),o(_)}catch(A){N||v(String(A?.message||A))}finally{N||h(!1)}})(),()=>{N=!0,_&&URL.revokeObjectURL(_),o(null)}},[e,r,n]),g.useEffect(()=>{function N(_){_.key==="Escape"&&t?.()}return e&&window.addEventListener("keydown",N),()=>window.removeEventListener("keydown",N)},[e,t]),!e)return null;const y=r?.name||r?.__doc?.title||"Document",w=Bfe(y)||u.startsWith("image/"),b=Ufe(y)||u==="application/pdf",S=$fe(y)||/^text\/|\/json$/.test(u);return Hb.createPortal(l.jsx("div",{className:"fixed inset-0 z-[10002] bg-black/50",onMouseDown:t,children:l.jsxs("div",{className:"absolute inset-6 md:inset-12 lg:inset-16 bg-white rounded-2xl shadow-2xl overflow-hidden",onMouseDown:N=>N.stopPropagation(),children:[l.jsxs("div",{className:"flex items-center justify-between border-b border-slate-200 px-4 py-3",children:[l.jsx("div",{className:"truncate text-sm font-medium text-slate-800",children:y}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>a(r),className:"rounded-md border border-slate-300 px-3 py-1.5 text-sm hover:bg-slate-50",children:"Download"}),l.jsx("button",{onClick:t,className:"rounded-md border border-slate-300 px-3 py-1.5 text-sm hover:bg-slate-50",children:"Close"})]})]}),l.jsxs("div",{className:"h-full overflow-auto bg-slate-50",children:[f&&l.jsx("div",{className:"p-6 text-center text-slate-600",children:"Loading preview"}),x&&l.jsxs("div",{className:"p-6 text-center text-rose-700",children:["Preview failed: ",x]}),!f&&!x&&i&&l.jsxs(l.Fragment,{children:[w&&l.jsx("img",{src:i,alt:y,className:"mx-auto block max-h-[calc(100vh-220px)] object-contain"}),b&&l.jsx("iframe",{title:"pdf",src:i,className:"w-full h-[calc(100vh-220px)]"}),S&&l.jsx("div",{className:"p-4",children:l.jsx("iframe",{title:"text",src:i,className:"w-full h-[calc(100vh-220px)] bg-white border rounded-lg"})}),!w&&!b&&!S&&l.jsxs("div",{className:"p-6 text-center text-slate-700",children:["Preview is not supported for this file type. Use"," ",l.jsx("span",{className:"font-medium",children:"Download"})," to open it locally."]})]})]})]})}),document.body)}function jS(){const[e,t]=g.useState(""),[r,n]=g.useState("dateDesc"),[a,i]=g.useState(!1),[o,u]=g.useState(!1),[m,f]=g.useState(""),[h,x]=g.useState([]),[v,y]=g.useState([]),[w,b]=g.useState(null),[S,N]=g.useState([]),[_,A]=g.useState(!1),[k,C]=g.useState(null),[O,T]=g.useState(null),[z,P]=g.useState(null),Z=zfe(),q=24,B=8;async function fe(L,ne={}){const ge=await fetch(L,{...ne,headers:{"Content-Type":"application/json",...ne.headers||{}},credentials:"include"});if(ge.status===401)throw f("Youre not signed in or your session expired. Please log in again."),new Error("Unauthorized");if(!ge.ok){let G=`Request failed (${ge.status})`;try{const ue=await ge.json();G=ue?.error||ue?.message||G}catch{}throw new Error(G)}return ge.json()}async function Ne(L){const ne=await fetch(`${eC}${L}`,{credentials:"include"});if(ne.status===401)throw f("Youre not signed in or your session expired. Please log in again."),new Error("Unauthorized");if(!ne.ok)throw new Error(`Request failed (${ne.status})`);return ne.blob()}g.useEffect(()=>{(async()=>{try{u(!0),f("");const L=`${Ffe}?include_counts=1`,ne=await fe(L),ge=Array.isArray(ne.folders)?ne.folders:[];y(ge)}catch{}finally{u(!1)}})()},[]),g.useEffect(()=>{(async()=>{try{i(!0),f("");const L=[];Z&&L.push(`investor_id=${Z}`);const ne=L.length?`?${L.join("&")}`:"",ge=`${eC}${ne}`,G=await fe(ge),Se=(Array.isArray(G.documents)?G.documents:[]).map(M=>({id:`doc:${M.id}`,name:M.title||M.original_name||`Document ${M.id}`,type:"file",dateUploaded:M.uploaded_at,__doc:M}));x(Se)}catch{}finally{i(!1)}})()},[Z]);const he=g.useMemo(()=>{const L=e.trim().toLowerCase();let ne=L?h.filter(xe=>(xe.name||"").toLowerCase().includes(L)):[...h];const ge=(xe,me)=>(xe.name||"").localeCompare(me.name||""),G=(xe,me)=>-ge(xe,me),ue=xe=>{const me=xe?.dateUploaded?new Date(xe.dateUploaded):null;return me&&!Number.isNaN(me.getTime())?me.getTime():-1/0},Se=(xe,me)=>ue(xe)-ue(me)||ge(xe,me),M=(xe,me)=>-Se(xe,me),Qe={az:ge,za:G,dateAsc:Se,dateDesc:M};return ne.sort(Qe[r]||M),ne},[h,e,r]),K=g.useMemo(()=>{const L=new Map;return he.forEach(ne=>{const ge=ne.__doc?.folder_id??null,G=L.get(ge)||[];G.push(ne),L.set(ge,G)}),L},[he]),H=g.useMemo(()=>{const L=new Map;return(v||[]).forEach(ne=>{const ge=ne.parent_id??null,G=L.get(ge)||[];G.push(ne),L.set(ge,G)}),L.forEach(ne=>ne.sort((ge,G)=>(ge.name||"").localeCompare(G.name||""))),L},[v]),be=H.get(null)||[],te=K.get(null)||[],I=w==null?"All documents":v.find(L=>L.id===w)?.name||"Folder";async function se(L){const ne=L.__doc?.id??String(L.id).replace(/^doc:/,""),ge=await Ne(`/download/${ne}`),G=URL.createObjectURL(ge),ue=document.createElement("a");ue.href=G,ue.download=L.name||`document-${ne}`,document.body.appendChild(ue),ue.click(),ue.remove(),URL.revokeObjectURL(G)}async function R(L){const ne=L.__doc?.id??String(L.id).replace(/^doc:/,"");return Ne(`/download/${ne}`)}const W=L=>{N(ne=>ne.includes(L)?ne.filter(ge=>ge!==L):[...ne,L])};function Y(L,ne){const ge=B+ne*q,G=ly(L.dateUploaded)||"";return l.jsxs("tr",{className:"hover:bg-slate-50/60 cursor-default border-t border-slate-100",children:[l.jsx("td",{className:"px-4 py-3",children:l.jsx("div",{className:"flex items-center",style:{paddingLeft:ge},children:l.jsx("button",{onClick:()=>{C(L),A(!0)},className:"truncate font-medium text-slate-800 hover:underline text-left",title:"Preview",children:L.name})})}),l.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{children:G}),l.jsx("button",{onClick:ue=>{const Se=ue.currentTarget.getBoundingClientRect();P(Se),T(L.id===O?null:L.id)},className:"rounded-md p-1 text-slate-500 hover:bg-slate-100","aria-label":"Row menu",children:l.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:[l.jsx("circle",{cx:"12",cy:"5",r:"1.5"}),l.jsx("circle",{cx:"12",cy:"12",r:"1.5"}),l.jsx("circle",{cx:"12",cy:"19",r:"1.5"})]})})]}),O===L.id&&z&&l.jsxs(rC,{anchorRect:z,onClose:()=>T(null),children:[l.jsx("button",{className:"w-full rounded-lg px-3 py-2 text-left text-sm hover:bg-slate-50",onClick:()=>{T(null),C(L),A(!0)},children:"Preview"}),l.jsx("button",{className:"w-full rounded-lg px-3 py-2 text-left text-sm hover:bg-slate-50",onClick:()=>{T(null),se(L).catch(ue=>alert(String(ue?.message||ue)))},children:"Download"})]})]})]},L.id)}function Q(L,ne){const ge=S.includes(L.id)||!!e.trim(),G=w===L.id,ue=B+ne*q,Se=H.get(L.id)||[],M=K.get(L.id)||[];return l.jsxs(tn.Fragment,{children:[l.jsxs("tr",{className:tC("cursor-pointer border-t border-slate-100 hover:bg-slate-50/60",G&&"bg-slate-50"),onClick:()=>{b(L.id),N(Qe=>Qe.includes(L.id)?Qe:[...Qe,L.id])},children:[l.jsx("td",{className:"px-4 py-3",children:l.jsxs("div",{className:"flex items-center gap-2",style:{paddingLeft:ue},children:[l.jsx("button",{type:"button",className:"rounded p-1 hover:bg-slate-100",onClick:Qe=>{Qe.stopPropagation(),W(L.id)},children:l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",className:tC("transition-transform text-slate-500",ge&&"rotate-90"),children:l.jsx("path",{d:"M9 6l6 6-6 6"})})}),l.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-sky-50",children:l.jsx(Rb,{className:"text-sky-600",size:18})}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"text-sm font-medium text-slate-800",children:L.name}),typeof L.doc_count=="number"&&l.jsxs("span",{className:"text-xs text-slate-500",children:[L.doc_count," ",L.doc_count===1?"item":"items"]})]})]})}),l.jsx("td",{className:"px-4 py-3 text-xs text-slate-500",children:ly(L.created_at)||""})]}),ge&&Se.map(Qe=>Q(Qe,ne+1)),ge&&M.map(Qe=>Y(Qe,ne+1))]},`folder-${L.id}`)}return l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"flex items-center justify-between",children:l.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:"Documents"})}),m&&l.jsx("div",{className:"rounded-lg border border-amber-300 bg-amber-50 px-3 py-2 text-sm text-amber-800",children:m}),l.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white shadow-sm",children:[l.jsxs("div",{className:"flex flex-col gap-3 border-b border-slate-200 px-4 py-3 md:flex-row md:items-center md:justify-between",children:[l.jsxs("div",{className:"space-y-1 text-sm text-slate-600",children:[l.jsx("div",{children:"Documents shared with you by admin."}),l.jsxs("div",{className:"text-xs text-slate-500",children:["Current folder:"," ",l.jsx("span",{className:"font-medium text-slate-800",children:I})]})]}),l.jsxs("div",{className:"grid w-full grid-cols-1 gap-2 md:w-auto md:auto-cols-max md:grid-flow-col md:items-center",children:[l.jsx("input",{value:e,onChange:L=>t(L.target.value),placeholder:"Search across all folders...",className:"w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-sky-200"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("label",{className:"text-sm text-slate-600",children:"Sort:"}),l.jsxs("select",{value:r,onChange:L=>n(L.target.value),className:"rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm",children:[l.jsx("option",{value:"dateDesc",children:"Date  (New  Old)"}),l.jsx("option",{value:"dateAsc",children:"Date  (Old  New)"}),l.jsx("option",{value:"az",children:"A  Z (Name)"}),l.jsx("option",{value:"za",children:"Z  A (Name)"})]})]})]})]}),l.jsx("div",{className:"border-b border-slate-200 px-4 py-2 text-xs text-slate-500",children:"Folder structure is shown below. Click the arrow to expand folders and see nested subfolders and files."}),l.jsx("div",{className:"hidden overflow-x-auto md:block",children:l.jsxs("table",{className:"min-w-full table-fixed",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"text-left text-xs font-semibold uppercase tracking-wide text-slate-500",children:[l.jsx("th",{className:"w-[70%] px-4 py-3",children:"Name"}),l.jsx("th",{className:"w-[30%] px-4 py-3",children:"Uploaded"})]})}),l.jsxs("tbody",{className:"text-sm",children:[a&&!he.length&&!be.length?l.jsx("tr",{children:l.jsx("td",{colSpan:2,className:"px-4 py-10 text-center text-slate-500",children:"Loading"})}):null,!a&&!he.length&&!be.length&&!te.length&&l.jsx("tr",{children:l.jsx("td",{colSpan:2,className:"px-4 py-10 text-center text-slate-500",children:"No documents available."})}),be.map(L=>Q(L,0)),te.map(L=>Y(L,0))]})]})}),l.jsx("div",{className:"md:hidden",children:he.length===0?l.jsx("div",{className:"px-4 py-10 text-center text-slate-500",children:a?"Loading":"No documents available."}):l.jsx("ul",{className:"divide-y divide-slate-100",children:he.map(L=>l.jsxs("li",{className:"px-4 py-3",children:[l.jsxs("div",{className:"flex items-start",children:[l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("button",{onClick:()=>{C(L),A(!0)},className:"block w-full text-left truncate font-medium text-slate-800 hover:underline",children:L.name}),l.jsx("div",{className:"mt-0.5 text-xs text-slate-500",children:ly(L.dateUploaded)||""})]}),l.jsx("div",{className:"ml-2",children:l.jsx("button",{onClick:ne=>{const ge=ne.currentTarget.getBoundingClientRect();P(ge),T(L.id===O?null:L.id)},className:"rounded-md p-1 text-slate-500 hover:bg-slate-100","aria-label":"Row menu",children:l.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:[l.jsx("circle",{cx:"12",cy:"5",r:"1.5"}),l.jsx("circle",{cx:"12",cy:"12",r:"1.5"}),l.jsx("circle",{cx:"12",cy:"19",r:"1.5"})]})})})]}),O===L.id&&z&&l.jsxs(rC,{anchorRect:z,onClose:()=>T(null),children:[l.jsx("button",{className:"w-full rounded-lg px-3 py-2 text-left text-sm hover:bg-slate-50",onClick:()=>{T(null),C(L),A(!0)},children:"Preview"}),l.jsx("button",{className:"w-full rounded-lg px-3 py-2 text-left text-sm hover:bg-slate-50",onClick:()=>{T(null),se(L).catch(ne=>alert(String(ne?.message||ne)))},children:"Download"})]})]},L.id))})})]}),l.jsx(Hfe,{open:_,onClose:()=>{A(!1),C(null)},file:k,fetchBlob:L=>R(L),onDownload:L=>se(L).catch(ne=>alert(String(ne?.message||ne)))})]})}function qfe(){if(typeof window>"u")return null;try{const t=new URL(window.location.href).searchParams.get("investorId"),r=window.localStorage.getItem("currentInvestorId"),n=t||r;return n?Number(n):null}catch{return null}}function NS({onSaved:e}){const[t,r]=g.useState(!1),[n,a]=g.useState(!1),[i,o]=g.useState(""),[u,m]=g.useState(!1),[f,h]=g.useState(null),[x,v]=g.useState(""),[y,w]=g.useState(null),[b,S]=g.useState({first_name:"",last_name:"",birthdate:"",citizenship:"",email:"",phone:"",ssn:"",emergency_contact:"",note:"",address1:"",address2:"",country:"",city:"",state:"",zip:"",bank_name:"",bank_account_name:"",bank_account_number:"",bank_account_type:"",bank_routing_number:"",bank_address:""}),N=g.useMemo(()=>{const Z=(b.first_name||"").trim()[0]||"",q=(b.last_name||"").trim()[0]||"";return(Z+q||"AI").toUpperCase()},[b.first_name,b.last_name]),_=g.useMemo(()=>f?URL.createObjectURL(f):"",[f]);g.useEffect(()=>()=>{_&&URL.revokeObjectURL(_)},[_]),g.useEffect(()=>{w(qfe())},[]),g.useEffect(()=>{(async()=>{a(!0);try{const{data:Z}=await We.get("/api/auth/me",{headers:{Accept:"application/json"},...y?{params:{investor_id:y}}:{}}),q=Z.user||Z,B=Z.profile||{};S({first_name:q.first_name||B.first_name||"",last_name:q.last_name||B.last_name||"",birthdate:B.birthdate||"",citizenship:B.citizenship||"",email:q.email||B.email||"",phone:q.phone||B.phone||"",ssn:B.ssn||B.ssn_tax_id||"",emergency_contact:B.emergency_contact||"",note:B.note||"",address1:B.address1||q.address||"",address2:B.address2||"",country:B.country||"",city:B.city||"",state:B.state||"",zip:B.zip||"",bank_name:B.bank_name||"",bank_account_name:B.bank_account_name||"",bank_account_number:B.bank_account_number||"",bank_account_type:B.bank_account_type||"",bank_routing_number:B.bank_routing_number||"",bank_address:B.bank_address||""}),v(B.avatar_url||q.avatar_url||""),o("")}catch(Z){const q=Z?.response?.data?.msg||Z?.response?.data?.error||(Z?.response?`Failed to load profile (${Z.response.status})`:"Failed to load your profile.");o(q)}finally{a(!1),m(!0)}})()},[y]);const A=Z=>S(q=>({...q,[Z.target.name]:Z.target.value})),k=()=>{o(""),r(!0)},C=()=>{h(null),r(!1),o("")},O=Z=>{const q=Z.target.files?.[0];q&&h(q)},T=()=>{h(null),v("")},z=async Z=>{Z.preventDefault(),o("");const q=["first_name","last_name","birthdate","citizenship","email","phone","ssn","emergency_contact","address1","country","city","state","zip","bank_name","bank_account_name","bank_account_number","bank_account_type","bank_routing_number"];for(const B of q)if(!String(b[B]||"").trim()){o(`${B.replace(/_/g," ")} is required`);return}a(!0);try{if(await We.put("/api/auth/profile",b,y?{params:{investor_id:y}}:void 0),f||x===""){const B=new FormData;f&&B.append("avatar",f,f.name),x===""&&B.append("remove_avatar","1");const{data:fe}=await We.put("/api/auth/profile/avatar",B,{headers:{"Content-Type":"multipart/form-data"},...y?{params:{investor_id:y}}:{}});fe?.avatar_url!==void 0&&v(fe.avatar_url||"")}r(!1),e?.(!0)}catch(B){const fe=B?.response?.data?.msg||B?.response?.data?.error||(B?.response?`Save failed (${B.response.status})`:"Failed to save profile.");o(fe)}finally{a(!1)}},P=({label:Z,name:q,required:B,type:fe="text",placeholder:Ne="",disabled:he=!t})=>l.jsxs("div",{className:"space-y-1",children:[l.jsxs("label",{className:"block text-sm font-semibold text-gray-700",children:[Z,B&&l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{name:q,type:fe,value:b[q],onChange:A,disabled:he,placeholder:Ne,className:`w-full rounded-lg border px-3 py-2.5 bg-gray-50 focus:bg-white focus:outline-none focus:ring-4 focus:ring-indigo-100 ${he?"text-gray-600 border-gray-200":"border-gray-300"}`})]});return l.jsxs("form",{onSubmit:z,className:"space-y-10",children:[l.jsxs("section",{className:"rounded-2xl border border-gray-200 bg-white shadow-sm",children:[l.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between p-6 border-b",children:[l.jsx("h2",{className:"text-xl font-semibold",children:"Personal Information"}),t?l.jsxs("div",{className:"flex items-center gap-3 self-start sm:self-auto",children:[l.jsx("button",{type:"button",onClick:C,className:"rounded-lg border px-3 py-1.5 text-gray-700 hover:bg-gray-50",disabled:n,children:"Cancel"}),l.jsx("button",{type:"submit",className:"rounded-lg bg-indigo-600 text-white px-4 py-2 hover:brightness-110 disabled:opacity-60",disabled:n,children:n?"Saving":"Save"})]}):l.jsx("button",{type:"button",onClick:k,className:"inline-flex items-center gap-2 rounded-lg border border-sky-300 text-sky-700 px-3 py-1.5 hover:bg-sky-50 disabled:opacity-60 self-start sm:self-auto",disabled:n||!u,children:"Edit"})]}),l.jsx("div",{className:"p-6",children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[112px_1fr] gap-6 items-start",children:[l.jsxs("div",{className:"flex flex-col items-start md:items-center gap-3",children:[l.jsx("div",{className:"relative h-24 w-24 rounded-full bg-teal-500 text-white grid place-items-center text-3xl font-semibold overflow-hidden",children:_||x?l.jsx("img",{src:_||x,alt:"Profile",className:"h-full w-full object-cover"}):N}),t&&l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("label",{className:"inline-flex items-center gap-2 rounded-lg border px-3 py-1.5 text-gray-700 hover:bg-gray-50 cursor-pointer",children:[l.jsx("input",{type:"file",accept:"image/*",onChange:O,className:"hidden"}),"Change"]}),(_||x)&&l.jsx("button",{type:"button",onClick:T,className:"text-rose-600 hover:underline text-sm",children:"Remove"})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsx(P,{label:"First Name",name:"first_name",required:!0,placeholder:"Benjamin"}),l.jsx(P,{label:"Last Name",name:"last_name",required:!0,placeholder:"Jones"}),l.jsx(P,{label:"Birthdate",name:"birthdate",required:!0,placeholder:"11/02/1968"}),l.jsx(P,{label:"Citizenship",name:"citizenship",required:!0,placeholder:"United States"}),l.jsx(P,{label:"Email",name:"email",required:!0,type:"email",placeholder:"ben@educounting.com"}),l.jsx(P,{label:"Phone",name:"phone",required:!0,placeholder:"3177015050"}),l.jsx(P,{label:"SSN / Tax ID",name:"ssn",required:!0,placeholder:"308-92-2338"}),l.jsx(P,{label:"Emergency Contact",name:"emergency_contact",required:!0,type:"tel",placeholder:"+1 555 987 6543"}),l.jsx("div",{className:"text-xs text-gray-500 self-end md:col-span-1",children:"SSN / Tax ID is an encrypted attribute"}),l.jsx("div",{className:"md:col-span-2",children:l.jsx(P,{label:"Note",name:"note",placeholder:"Add any extra personal notes here"})})]})]})})]}),l.jsxs("section",{className:"rounded-2xl border border-gray-200 bg-white shadow-sm",children:[l.jsxs("div",{className:"p-6 border-b",children:[l.jsx("h3",{className:"text-xl font-semibold",children:"Bank Information"}),l.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"These details are used for your bank, investment, credit, business and digital payment accounts."})]}),l.jsxs("div",{className:"p-6 grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsx(P,{label:"Bank Name",name:"bank_name",required:!0,placeholder:"ABC Bank"}),l.jsx(P,{label:"Account Name",name:"bank_account_name",required:!0,placeholder:"Benjamin Jones"}),l.jsx(P,{label:"Account Number",name:"bank_account_number",required:!0,placeholder:""}),l.jsxs("div",{className:"space-y-1",children:[l.jsxs("label",{className:"block text-sm font-semibold text-gray-700",children:["Account Type",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsxs("select",{name:"bank_account_type",value:b.bank_account_type,onChange:A,disabled:!t,className:`w-full rounded-lg border px-3 py-2.5 bg-gray-50 focus:bg-white focus:outline-none focus:ring-4 focus:ring-indigo-100 ${t?"border-gray-300":"text-gray-600 border-gray-200"}`,children:[l.jsx("option",{value:"",children:"Select account type"}),l.jsx("option",{value:"Bank Accounts",children:"Bank Accounts"}),l.jsx("option",{value:"Investment Accounts",children:"Investment Accounts"}),l.jsx("option",{value:"Credit Accounts",children:"Credit Accounts"}),l.jsx("option",{value:"Business & Corporate Accounts",children:"Business & Corporate Accounts"}),l.jsx("option",{value:"Digital & Payment Accounts",children:"Digital & Payment Accounts"})]})]}),l.jsx(P,{label:"Routing Number",name:"bank_routing_number",required:!0,placeholder:""}),l.jsx("div",{className:"md:col-span-2",children:l.jsx(P,{label:"Bank Address (Optional)",name:"bank_address",placeholder:"123 Main St, Suite 100, City, State ZIP"})})]})]}),l.jsxs("section",{className:"rounded-2xl border border-gray-200 bg-white shadow-sm",children:[l.jsx("div",{className:"p-6 border-b",children:l.jsx("h3",{className:"text-xl font-semibold",children:"Residential Address"})}),l.jsxs("div",{className:"p-6 grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsx("div",{className:"md:col-span-2",children:l.jsx(P,{label:"Street Address 1",name:"address1",required:!0,placeholder:"1496 Daylight Dr."})}),l.jsx("div",{className:"md:col-span-2",children:l.jsx(P,{label:"Street Address 2 (Optional)",name:"address2",placeholder:""})}),l.jsx(P,{label:"Country",name:"country",required:!0,placeholder:"United States"}),l.jsx(P,{label:"City",name:"city",required:!0,placeholder:"Carmel"}),l.jsx(P,{label:"State / Province",name:"state",required:!0,placeholder:"Indiana"}),l.jsx(P,{label:"Zip / Postal Code",name:"zip",required:!0,placeholder:"46280"})]})]}),i&&l.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 text-rose-700 px-4 py-3",children:i})]})}const Vfe=[{key:"name",label:"NAME",visible:!0},{key:"email",label:"EMAIL",visible:!0},{key:"phone",label:"PHONE",visible:!0},{key:"notes",label:"NOTES",visible:!0}];function Kfe(){try{const t=new URL(window.location.href).searchParams.get("investorId"),r=localStorage.getItem("currentInvestorId");return Number(t||r||1)}catch{return 1}}function ES(){const e=Kfe(),[t,r]=g.useState([]),[n,a]=g.useState(""),[i,o]=g.useState(Vfe),[u,m]=g.useState(!1),[f,h]=g.useState(!1),[x,v]=g.useState("add"),[y,w]=g.useState(null),[b,S]=g.useState(!1),[N,_]=g.useState("");g.useEffect(()=>{let P=!1;const Z=setTimeout(async()=>{S(!0),_("");try{const B=(await We.get(`/api/contacts/${e}`,{params:{q:n,page:1,page_size:200}})).data;P||r(Array.isArray(B?.data)?B.data:[])}catch(q){if(!P){const B=q?.response?.data?.error||q?.message||"Failed to load contacts.";_(B)}}finally{P||S(!1)}},300);return()=>{P=!0,clearTimeout(Z)}},[e,n]);const A=g.useMemo(()=>i.filter(P=>P.visible),[i]);function k(P){o(Z=>Z.map(q=>q.key===P?{...q,visible:!q.visible}:q))}function C(){const P=A,Z=P.map(K=>K.label).join(","),q=t.map(K=>P.map(H=>{const be=K[H.key]??"";return`"${String(be).replaceAll('"','""')}"`}).join(",")),B=[Z,...q].join(`
`),fe=new Blob([B],{type:"text/csv;charset=utf-8;"}),Ne=URL.createObjectURL(fe),he=document.createElement("a");he.href=Ne,he.download="contacts.csv",he.click(),URL.revokeObjectURL(Ne)}async function O(P){if(P&&window.confirm("Are you sure you want to delete this contact?"))try{await We.delete(`/api/contacts/item/${P}`),r(Z=>Z.filter(q=>q.id!==P))}catch(Z){const q=Z?.response?.data?.error||Z?.message||"Failed to delete contact.";_(q)}}function T(){v("add"),w(null),h(!0)}function z(P){v("edit"),w(P),h(!0)}return l.jsxs("div",{className:"w-full",children:[l.jsxs("div",{className:"flex items-center justify-between gap-3 py-4",children:[l.jsx("div",{className:"flex-1 max-w-sm",children:l.jsxs("div",{className:"relative",children:[l.jsx("input",{value:n,onChange:P=>a(P.target.value),placeholder:"Search by anything",className:"w-full rounded-xl border border-gray-200 bg-white px-4 py-2.5 text-sm outline-none ring-0 placeholder:text-gray-400 focus:border-gray-300 focus:ring-2 focus:ring-gray-100"}),l.jsxs("svg",{viewBox:"0 0 24 24",className:"pointer-events-none absolute right-3 top-1/2 h-5 w-5 -translate-y-1/2 opacity-50",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M21 21l-4.3-4.3"}),l.jsx("circle",{cx:"10",cy:"10",r:"7"})]})]})}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:C,className:"rounded-xl border border-gray-200 bg-white px-4 py-2 text-sm font-medium hover:bg-gray-50 active:scale-[.99]",title:"Export CSV",children:"Export"}),l.jsxs("div",{className:"relative",children:[l.jsx("button",{onClick:()=>m(P=>!P),className:"rounded-xl border border-gray-200 bg-white px-4 py-2 text-sm font-medium hover:bg-gray-50 active:scale-[.99]",title:"Show / hide columns",children:"Hide columns"}),u&&l.jsxs("div",{className:"absolute right-0 z-20 mt-2 w-56 overflow-hidden rounded-xl border border-gray-200 bg-white shadow-lg",onMouseLeave:()=>m(!1),children:[l.jsx("div",{className:"p-2 text-xs font-semibold text-gray-500",children:"Columns"}),l.jsx("div",{className:"max-h-64 overflow-auto p-2",children:i.map(P=>l.jsxs("label",{className:"flex cursor-pointer items-center gap-3 rounded-lg px-2 py-2 text-sm hover:bg-gray-50",children:[l.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded",checked:P.visible,onChange:()=>k(P.key)}),l.jsx("span",{children:P.label})]},P.key))})]})]}),l.jsxs("button",{onClick:T,className:"inline-flex items-center gap-2 rounded-xl bg-[#2B86C5] px-4 py-2 text-sm font-semibold text-white shadow-sm hover:brightness-110 active:scale-[.99]",children:[l.jsx("span",{className:"inline-flex h-5 w-5 items-center justify-center rounded-md bg-white/20",children:"+"}),"Add Contact"]})]})]}),l.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white",children:[l.jsxs("div",{className:"grid grid-cols-5 gap-4 border-b border-gray-100 px-5 py-3 text-xs font-semibold tracking-wide text-gray-500",children:[A.map(P=>l.jsx("div",{children:P.label},P.key)),l.jsx("div",{className:"text-right",children:"Action"})]}),b?l.jsx("div",{className:"flex min-h-[220px] items-center justify-center p-8",children:l.jsx("span",{className:"text-sm text-gray-500",children:"Loading"})}):N?l.jsx("div",{className:"flex min-h-[220px] items-center justify-center p-8",children:l.jsx("span",{className:"text-sm text-red-500",children:N})}):t.length>0?l.jsx("div",{className:"divide-y divide-gray-100",children:t.map(P=>l.jsxs("div",{className:"grid grid-cols-5 gap-4 px-5 py-4 text-sm",children:[A.map(Z=>l.jsx("div",{children:P[Z.key]||l.jsx("span",{className:"text-gray-400",children:""})},Z.key)),l.jsx("div",{className:"flex items-center justify-end",children:l.jsx(Gfe,{onEdit:()=>z(P),onDelete:()=>O(P.id)})})]},P.id??`${P.name}-${P.email}`))}):l.jsxs("div",{className:"flex min-h-[260px] flex-col items-center justify-center gap-2 px-6 py-16 text-center",children:[l.jsx("p",{className:"max-w-2xl text-base font-semibold text-gray-700",children:"Please add anyone here you would like copied on correspondence such as emails and invoices."}),l.jsx("p",{className:"text-sm text-gray-400",children:"Nothing to display"})]})]}),f&&l.jsx(Wfe,{mode:x,investorId:e,contactId:y?.id,initial:y,onClose:()=>{h(!1),w(null)},onSaved:(P,Z)=>{P&&r(q=>Z==="edit"?q.map(B=>B.id===P.id?P:B):[P,...q]),h(!1),w(null)}})]})}function Gfe({onEdit:e,onDelete:t}){const[r,n]=g.useState(!1),a=g.useRef(null);return g.useEffect(()=>{function i(o){a.current&&!a.current.contains(o.target)&&n(!1)}return r&&document.addEventListener("mousedown",i),()=>{document.removeEventListener("mousedown",i)}},[r]),l.jsxs("div",{className:"relative",ref:a,children:[l.jsx("button",{type:"button",onClick:()=>n(i=>!i),className:"inline-flex h-8 w-8 items-center justify-center rounded-full hover:bg-gray-100 text-gray-600",title:"Actions",children:l.jsxs("svg",{viewBox:"0 0 24 24",className:"h-5 w-5",fill:"currentColor","aria-hidden":"true",children:[l.jsx("circle",{cx:"12",cy:"5",r:"1.6"}),l.jsx("circle",{cx:"12",cy:"12",r:"1.6"}),l.jsx("circle",{cx:"12",cy:"19",r:"1.6"})]})}),r&&l.jsxs("div",{className:"absolute right-0 z-30 mt-1 w-32 rounded-lg border border-gray-200 bg-white py-1 text-sm shadow-lg",children:[l.jsx("button",{type:"button",onClick:()=>{n(!1),e?.()},className:"flex w-full items-center px-3 py-1.5 text-left hover:bg-gray-50",children:"Edit"}),l.jsx("button",{type:"button",onClick:()=>{n(!1),t?.()},className:"flex w-full items-center px-3 py-1.5 text-left text-red-600 hover:bg-red-50",children:"Delete"})]})]})}function Wfe({mode:e="add",investorId:t,contactId:r,initial:n,onClose:a,onSaved:i}){const[o,u]=g.useState({name:n?.name||"",email:n?.email||"",phone:n?.phone||"",notes:n?.notes||""}),[m,f]=g.useState(!1),[h,x]=g.useState("");g.useEffect(()=>{u({name:n?.name||"",email:n?.email||"",phone:n?.phone||"",notes:n?.notes||""})},[n,e]);async function v(){if(!o.name.trim()||!o.email.trim()){x("Name and Email are required.");return}f(!0),x("");try{let b;e==="edit"&&r?b=await We.put(`/api/contacts/item/${r}`,{name:o.name.trim(),email:o.email.trim(),phone:o.phone.trim()||null,notes:o.notes.trim()||null}):b=await We.post(`/api/contacts/${t}`,{name:o.name.trim(),email:o.email.trim(),phone:o.phone.trim()||null,notes:o.notes.trim()||null});const S=b.data;i?.(S?.data||null,e)}catch(b){const S=b?.response?.data?.error||b?.message||"Failed to save contact.";x(S)}finally{f(!1)}}const y=e==="edit"?"Edit Contact":"Add Contact",w=e==="edit"?"Save Changes":"Save Contact";return l.jsxs("div",{className:"fixed inset-0 z-40 flex items-center justify-center",children:[l.jsx("div",{className:"absolute inset-0 bg-black/30 backdrop-blur-[2px]",onClick:a}),l.jsxs("div",{className:"relative z-50 w-full max-w-lg rounded-2xl bg-white p-6 shadow-2xl",children:[l.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[l.jsx("h3",{className:"text-lg font-semibold",children:y}),l.jsx("button",{className:"rounded-lg p-2 text-gray-500 hover:bg-gray-50",onClick:a,"aria-label":"Close",title:"Close",children:""})]}),l.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[l.jsx(Ch,{label:"Name",value:o.name,onChange:b=>u(S=>({...S,name:b})),placeholder:"Jane Cooper",required:!0}),l.jsx(Ch,{label:"Email",type:"email",value:o.email,onChange:b=>u(S=>({...S,email:b})),placeholder:"jane@example.com",required:!0}),l.jsx(Ch,{label:"Phone",value:o.phone,onChange:b=>u(S=>({...S,phone:b})),placeholder:"+1 555 0123"}),l.jsx(Ch,{label:"Notes",as:"textarea",value:o.notes,onChange:b=>u(S=>({...S,notes:b})),placeholder:"Optional notes"})]}),h&&l.jsx("div",{className:"mt-3 rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700",children:h}),l.jsxs("div",{className:"mt-6 flex items-center justify-end gap-2",children:[l.jsx("button",{onClick:a,className:"rounded-xl border border-gray-200 bg-white px-4 py-2 text-sm font-medium hover:bg-gray-50",disabled:m,children:"Cancel"}),l.jsx("button",{onClick:v,className:"rounded-xl bg-[#2B86C5] px-4 py-2 text-sm font-semibold text-white hover:brightness-110 disabled:opacity-60",disabled:m,children:m?"Saving":w})]})]})]})}function Ch({label:e,value:t,onChange:r,placeholder:n,as:a="input",type:i="text",required:o=!1}){const u=a;return l.jsxs("label",{className:"block text-sm",children:[l.jsxs("span",{className:"mb-1 block font-medium text-gray-700",children:[e," ",o&&l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx(u,{type:i,value:t,onChange:m=>r(m.target.value),placeholder:n,className:`w-full rounded-xl border border-gray-200 bg-white px-3 py-2 outline-none ring-0 placeholder:text-gray-400 focus:border-gray-300 focus:ring-2 focus:ring-gray-100 ${a==="textarea"?"min-h-[88px]":""}`})]})}const M8=g.createContext(null);function Xfe({children:e}){const[t,r]=g.useState([]),n=g.useRef(1),a=g.useCallback((o,u)=>{const m=n.current++;r(f=>[...f,{id:m,type:o,message:u}]),setTimeout(()=>r(f=>f.filter(h=>h.id!==m)),4e3)},[]),i=g.useMemo(()=>({success:o=>a("success",o),error:o=>a("error",o),info:o=>a("info",o)}),[a]);return l.jsxs(M8.Provider,{value:i,children:[e,l.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-[100] flex w-[320px] flex-col gap-2",children:t.map(o=>l.jsx("div",{className:`pointer-events-auto rounded-xl border px-3 py-2 text-sm shadow ${o.type==="success"?"border-emerald-200 bg-emerald-50 text-emerald-900":o.type==="error"?"border-red-200 bg-red-50 text-red-900":"border-gray-200 bg-white text-gray-900"}`,children:o.message},o.id))})]})}const Yfe=()=>g.useContext(M8);function Zfe(){const e=Yfe(),[t,r]=g.useState([]),[n,a]=g.useState(!0),[i,o]=g.useState(""),[u,m]=g.useState(""),[f,h]=g.useState(""),[x,v]=g.useState(null);g.useEffect(()=>{try{if(x){const xe=x.investor_id||x.id,ze=[x.workbook_investor_name,x.investor_name,x.name,[x.first_name,x.last_name].filter(Boolean).join(" ")].map(oe=>(oe||"").trim()).filter(Boolean)[0];ze&&window.localStorage.setItem("investorHint",ze),xe?(window.localStorage.setItem("currentInvestorId",String(xe)),We.defaults.headers.common["X-View-As-Investor"]=String(xe)):(window.localStorage.removeItem("currentInvestorId"),delete We.defaults.headers.common["X-View-As-Investor"])}else window.localStorage.removeItem("currentInvestorId"),delete We.defaults.headers.common["X-View-As-Investor"]}catch(xe){console.warn("Failed to set view-as investor context:",xe)}},[x]);const[y,w]=g.useState(0),[b,S]=g.useState(!1),[N,_]=g.useState([]),[A,k]=g.useState(!1),C=["All","IRA","ROTH IRA","Retirement","Depends"],[O,T]=g.useState("All"),[z,P]=g.useState(!1),[Z,q]=g.useState(!1),[B,fe]=g.useState("invite"),[Ne,he]=g.useState(null),[K,H]=g.useState({name:"",email:"",investor_type:"IRA",depends_on_id:null,parent_relationship:""}),be=()=>{fe("invite"),he(null),H({name:"",email:"",investor_type:"IRA",depends_on_id:null,parent_relationship:""})},te=g.useMemo(()=>new Intl.NumberFormat(void 0,{style:"currency",currency:"USD",maximumFractionDigits:2}),[]),I=xe=>{if(!xe)return"";try{const me=new Date(xe);return Number.isNaN(me.getTime())?xe:me.toLocaleString()}catch{return xe}},se=g.useCallback(async()=>{let xe=!0;a(!0),m("");try{const{data:me}=await We.get("/api/invitations",{params:{status:"accepted"},headers:{Accept:"application/json"}});if(!xe)return;const oe=(Array.isArray(me)?me:Array.isArray(me?.items)?me.items:Array.isArray(me?.data)?me.data:[]).filter(ke=>(ke.status||"accepted").toLowerCase()==="accepted").map(ke=>{const Ge=ke.investor||{};return{id:ke.id??ke.invitation_id??Ge.id??crypto.randomUUID(),investor_id:Ge.id??null,name:Ge.name||ke.name||"",email:Ge.email||ke.email||"",company_name:Ge.company_name||"",contact_phone:Ge.contact_phone||"",investor_type:Ge.investor_type||"",parent_investor_id:Ge.parent_investor_id??null,parent_relationship:Ge.parent_relationship||null,created_at:ke.created_at||null,used_at:ke.used_at||null,current_balance:ke.current_balance??ke.ending_balance??ke.balance??null,balance_source:ke.balance_source||null,balance_as_of:ke.balance_as_of||null}});r(oe),o("/api/invitations?status=accepted")}catch(me){m(me?.response?.data?.error||me?.message||"Failed to load accepted investors."),e.error("Failed to load accepted investors.")}finally{a(!1)}return()=>{xe=!1}},[e]);g.useEffect(()=>{se()},[se]);const R=g.useCallback(async()=>{try{const{data:xe}=await We.get("/api/invitations/stats"),me=Number(xe?.pending||0);w(Number.isFinite(me)?me:0)}catch{try{const{data:xe}=await We.get("/api/invitations",{params:{status:"pending",per_page:1}});w(Number(xe?.total||0))}catch{w(0)}}},[]),W=g.useCallback(async()=>{k(!0);try{const{data:xe}=await We.get("/api/invitations",{params:{status:"pending",per_page:200,page:1,sort:"created_at",order:"desc"}}),me=Array.isArray(xe)?xe:Array.isArray(xe?.items)?xe.items:[];_(me)}catch{e.error("Failed to load pending invitations.")}finally{k(!1)}},[e]);g.useEffect(()=>{R()},[R]);const Y=async xe=>{if(xe&&confirm("Cancel this invitation?"))try{await We.delete(`/api/invitations/${xe}`),e.success("Invitation cancelled."),await Promise.all([R(),W()])}catch(me){e.error(me?.response?.data?.error||me?.message||"Cancel failed.")}},Q=g.useMemo(()=>{const xe=new Map;return t.forEach(me=>{me.investor_id&&xe.set(Number(me.investor_id),me.name||me.email)}),xe},[t]),L=g.useMemo(()=>{const xe=f.trim().toLowerCase();return t.filter(me=>{const ze=!xe||me.name.toLowerCase().includes(xe)||me.email.toLowerCase().includes(xe)||me.company_name.toLowerCase().includes(xe),oe=O==="All"||(me.investor_type||"").toLowerCase()===O.toLowerCase();return ze&&oe})},[t,f,O]),ne=g.useMemo(()=>{const xe=Number(Ne||0);return t.map(me=>({value:Number(me.investor_id||me.id),label:me.name||me.email||`Investor ${me.id}`})).filter(me=>Number.isFinite(me.value)&&(!xe||me.value!==xe))},[t,Ne]),ge=xe=>{const{name:me,value:ze}=xe.target;H(oe=>({...oe,[me]:ze}))},G=async()=>{await We.post("/admin/invite",{email:K.email.trim(),name:K.name.trim(),user_type:"investor",investor_type:K.investor_type,...K.investor_type==="Depends"&&K.depends_on_id?{depends_on_id:K.depends_on_id,parent_relationship:K.parent_relationship.trim()||null}:{}},{headers:{"Content-Type":"application/json"}})},ue=async xe=>{await We.put(`/api/investors/${xe}`,{name:K.name.trim(),email:K.email.trim(),investor_type:K.investor_type,depends_on_ids:K.investor_type==="Depends"&&K.depends_on_id?[K.depends_on_id]:[],parent_relationship:K.investor_type==="Depends"&&K.parent_relationship.trim()||null},{headers:{"Content-Type":"application/json"}})},Se=async xe=>{if(xe.preventDefault(),!K.name.trim()||!K.email.trim()){e.error("Please provide both Name and Email.");return}if(K.investor_type==="Depends"){if(ne.length===0){e.error("No existing investors to select as a dependent. Create one first.");return}if(!K.depends_on_id){e.error("Please select one dependent investor.");return}if(!K.parent_relationship.trim()){e.error("Please enter the relationship between the investors.");return}}q(!0);try{B==="invite"?(await G(),e.success(`Invitation sent to ${K.email}.`),await R()):B==="edit"&&Ne&&(await ue(Ne),e.success("Investor updated.")),await se(),be(),P(!1)}catch(me){e.error(me?.response?.data?.msg||me?.response?.data?.error||me?.message||"Action failed.")}finally{q(!1)}},M=xe=>{fe("edit"),he(xe.investor_id||xe.id),H({name:xe.name||"",email:xe.email||"",investor_type:xe.investor_type||"IRA",depends_on_id:null,parent_relationship:xe.parent_relationship||""}),P(!0)},Qe=async xe=>{const me=xe.investor_id||xe.id;if(!me){e.error("Missing investor id.");return}if(confirm(`Delete investor "${xe.name||xe.email}"?`))try{await We.delete(`/api/investors/${me}`),await se(),e.success("Investor deleted.")}catch(ze){e.error(ze?.response?.data?.error||ze?.message||"Delete failed.")}};if(x){const xe=x.investor_id||x.id||null;return l.jsx("div",{className:"p-6",children:l.jsx(Qfe,{investor:x,investorId:xe,onBack:()=>v(null)})})}return l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"mb-4 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[l.jsx("h2",{className:"text-xl font-semibold",children:"Investors (Invitation Accepted)"}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("button",{type:"button",onClick:async()=>{await W(),S(!0)},className:"rounded-full border border-amber-200 bg-amber-50 px-3 py-1 text-xs font-medium text-amber-900 hover:bg-amber-100",title:"View pending invitations",children:["Pending: ",y]}),l.jsx("select",{className:"rounded-lg border px-3 py-2 text-sm",value:O,onChange:xe=>T(xe.target.value),title:"Filter by type",children:C.map(xe=>l.jsx("option",{value:xe,children:xe},xe))}),l.jsx("button",{type:"button",onClick:()=>{be(),fe("invite"),P(!0)},className:"rounded-xl border bg-black px-4 py-2 text-sm font-medium text-white shadow hover:opacity-90 active:opacity-80",children:"+ Add Investor"})]})]}),l.jsx("div",{className:"mb-4 flex gap-3",children:l.jsx("input",{type:"text",value:f,onChange:xe=>h(xe.target.value),placeholder:"Search by name, company, or email",className:"w-full max-w-sm rounded-lg border px-3 py-2 outline-none focus:ring"})}),n&&l.jsx("div",{className:"rounded-lg border p-6 text-gray-600",children:"Loading"}),!n&&u&&l.jsx("div",{className:"rounded-lg border border-red-300 bg-red-50 p-4 text-red-700",children:u}),!n&&!u&&l.jsx("div",{className:"overflow-x-auto rounded-lg border",children:l.jsxs("table",{className:"min-w-full text-left text-sm",children:[l.jsx("thead",{className:"bg-gray-50 text-gray-700",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 font-medium",children:"Investor"}),l.jsx("th",{className:"px-4 py-3 font-medium",children:"Company"}),l.jsx("th",{className:"px-4 py-3 font-medium",children:"Email"}),l.jsx("th",{className:"px-4 py-3 font-medium",children:"Contact"}),l.jsx("th",{className:"px-4 py-3 font-medium",children:"Type"}),l.jsx("th",{className:"px-4 py-3 font-medium",children:"Parent"}),l.jsx("th",{className:"px-4 py-3 font-medium",children:"Invited On"}),l.jsx("th",{className:"px-4 py-3 font-medium",children:"Accepted On"}),l.jsx("th",{className:"px-4 py-3 font-medium",children:"Current Balance"}),l.jsx("th",{className:"px-4 py-3 font-medium",children:"Action"})]})}),l.jsxs("tbody",{className:"divide-y",children:[L.map(xe=>{const me=xe.current_balance==null?"":te.format(Number(xe.current_balance)),ze=xe.parent_investor_id&&Q.get(Number(xe.parent_investor_id))?Q.get(Number(xe.parent_investor_id)):xe.parent_investor_id?`#${xe.parent_investor_id}`:"";return l.jsxs("tr",{children:[l.jsx("td",{className:"px-4 py-3",children:l.jsx("button",{type:"button",onClick:()=>v(xe),className:"text-sky-700 hover:underline font-medium",title:"View investor dashboard",children:xe.name||""})}),l.jsx("td",{className:"px-4 py-3",children:xe.company_name||""}),l.jsx("td",{className:"px-4 py-3",children:xe.email||""}),l.jsx("td",{className:"px-4 py-3",children:xe.contact_phone||""}),l.jsx("td",{className:"px-4 py-3",children:xe.investor_type||""}),l.jsx("td",{className:"px-4 py-3",children:ze}),l.jsx("td",{className:"px-4 py-3",children:I(xe.created_at)}),l.jsx("td",{className:"px-4 py-3",children:I(xe.used_at)}),l.jsx("td",{className:"px-4 py-3",children:l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{children:me}),xe.balance_as_of&&l.jsxs("span",{className:"text-xs text-gray-500",children:["as of ",I(xe.balance_as_of)]})]})}),l.jsx("td",{className:"px-4 py-3",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{type:"button",onClick:()=>M(xe),className:"rounded-lg border px-2 py-1 text-xs hover:bg-gray-50",title:"Edit",children:"Edit"}),l.jsx("button",{type:"button",onClick:()=>Qe(xe),className:"rounded-lg border px-2 py-1 text-xs hover:bg-gray-50",title:"Delete",children:"Delete"})]})})]},xe.id)}),L.length===0&&l.jsx("tr",{children:l.jsx("td",{className:"px-4 py-6 text-gray-600",colSpan:10,children:"No investors found."})})]})]})}),z&&l.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center",children:[l.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>Z?null:P(!1)}),l.jsxs("div",{className:"relative z-[61] w-full max-w-lg rounded-2xl bg-white p-6 shadow-xl",children:[l.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[l.jsx("h3",{className:"text-lg font-semibold",children:B==="edit"?"Edit Investor":"Invite Investor"}),l.jsxs("button",{type:"button",onClick:async()=>{await W(),S(!0)},className:"rounded-full border border-amber-200 bg-amber-50 px-2.5 py-1 text-xs font-medium text-amber-900 hover:bg-amber-100",title:"View pending invitations",children:["Pending: ",y]}),l.jsx("button",{onClick:()=>Z?null:P(!1),className:"rounded-full px-2 py-1 text-gray-500 hover:bg-gray-100",title:"Close",type:"button",children:""})]}),l.jsxs("form",{onSubmit:Se,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Name"}),l.jsx("input",{name:"name",type:"text",value:K.name,onChange:ge,placeholder:"Investor full name",className:"w-full rounded-lg border px-3 py-2 outline-none focus:ring",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Email"}),l.jsx("input",{name:"email",type:"email",value:K.email,onChange:ge,placeholder:"email@example.com",className:"w-full rounded-lg border px-3 py-2 outline-none focus:ring",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Investor Type"}),l.jsxs("select",{name:"investor_type",value:K.investor_type,onChange:ge,className:"w-full rounded-lg border px-3 py-2 outline-none focus:ring",children:[l.jsx("option",{value:"IRA",children:"IRA"}),l.jsx("option",{value:"ROTH IRA",children:"ROTH IRA"}),l.jsx("option",{value:"Retirement",children:"Retirement"}),l.jsx("option",{value:"Depends",children:"Depends"})]})]}),K.investor_type==="Depends"&&(ne.length>0?l.jsxs(l.Fragment,{children:[l.jsx(Jfe,{label:"Dependent investor (required)",options:ne,value:K.depends_on_id,onChange:xe=>H(me=>({...me,depends_on_id:xe}))}),l.jsxs("div",{className:"mt-3",children:[l.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Relationship with parent investor"}),l.jsx("input",{type:"text",name:"parent_relationship",value:K.parent_relationship,onChange:ge,placeholder:"e.g., Self, Spouse, Child, Trust",className:"w-full rounded-lg border px-3 py-2 text-sm outline-none focus:ring"})]})]}):l.jsx("p",{className:"text-xs text-red-600",children:"No existing investors found. Create at least one investor first to set as dependent."})),l.jsxs("div",{className:"flex items-center justify-end gap-3 pt-2",children:[l.jsx("button",{type:"button",onClick:()=>Z?null:P(!1),className:"rounded-lg border px-4 py-2 text-sm hover:bg-gray-50",disabled:Z,children:"Cancel"}),l.jsx("button",{type:"submit",className:"rounded-lg bg-black px-4 py-2 text-sm font-medium text-white shadow hover:opacity-90 disabled:opacity-60",disabled:Z,children:Z?B==="edit"?"Saving":"Sending":B==="edit"?"Update":"Send Invite"})]})]})]})]}),b&&l.jsxs("div",{className:"fixed inset-0 z-[70]",children:[l.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>S(!1)}),l.jsxs("div",{className:"absolute right-0 top-0 h-full w-full max-w-md bg-white shadow-xl",children:[l.jsxs("div",{className:"flex items-center justify-between border-b px-5 py-4",children:[l.jsxs("div",{className:"text-lg font-semibold",children:["Pending Invitations (",y,")"]}),l.jsx("button",{className:"rounded-full px-2 py-1 text-gray-500 hover:bg-gray-100",onClick:()=>S(!1),title:"Close",children:""})]}),l.jsxs("div",{className:"p-4",children:[A&&l.jsx("div",{className:"rounded-lg border p-4 text-gray-600",children:"Loading"}),!A&&N.length===0&&l.jsx("div",{className:"rounded-lg border p-4 text-gray-600",children:"No pending invitations."}),!A&&N.length>0&&l.jsx("div",{className:"space-y-2",children:N.map(xe=>l.jsxs("div",{className:"flex items-center justify-between rounded-lg border px-3 py-2",children:[l.jsxs("div",{children:[l.jsx("div",{className:"font-medium",children:xe.name||xe.email||""}),l.jsxs("div",{className:"text-xs text-gray-500",children:[xe.email,"  invited ",I(xe.created_at)]})]}),l.jsx("button",{className:"rounded-lg border px-3 py-1 text-xs hover:bg-gray-50",onClick:()=>Y(xe.id),title:"Cancel invitation",children:"Cancel"})]},xe.id))})]})]})]})]})}function Qfe({investor:e,investorId:t,onBack:r}){const[n,a]=g.useState("overview"),i=[{id:"overview",label:"Overview"},{id:"portfolio",label:"Portfolio"},{id:"statements",label:"Statements"},{id:"documents",label:"Documents"},{id:"personalinformation",label:"Personal Information"},{id:"contacts",label:"Contacts"}],o="inline-flex items-center whitespace-nowrap px-3 sm:px-4 py-2 text-sm font-medium rounded-t-md border-b-2 transition-colors focus:outline-none focus-visible:ring-2 focus-visible:ring-sky-500",u="border-transparent text-slate-600 hover:text-sky-700 hover:bg-sky-50",m="border-sky-500 text-sky-700 bg-sky-50",f=e?.name||e?.email||`Investor #${t||""}`;return l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("button",{type:"button",onClick:r,className:"inline-flex items-center gap-2 rounded-full border px-3 py-1 text-xs font-medium text-slate-700 hover:bg-gray-50",children:[l.jsx("span",{className:"text-lg leading-none",children:""}),l.jsx("span",{children:"Back to investor list"})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Admin  Investor Dashboard"}),l.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-slate-900",children:f}),e?.investor_type&&l.jsxs("div",{className:"text-xs text-slate-500",children:["Type: ",e.investor_type]})]})]})}),l.jsx("div",{className:"border-b border-slate-200",children:l.jsx("nav",{className:"flex gap-1 sm:gap-2 overflow-x-auto",children:i.map(h=>l.jsx("button",{type:"button",onClick:()=>a(h.id),className:`${o} ${n===h.id?m:u}`,children:h.label},h.id))})}),l.jsxs("div",{className:"mt-4",children:[n==="overview"&&l.jsx(yS,{adminView:!0,investorId:t}),n==="portfolio"&&l.jsx(bS,{adminView:!0,investorId:t}),n==="statements"&&l.jsx(wS,{adminView:!0,investorId:t}),n==="documents"&&l.jsx(jS,{adminView:!0,investorId:t}),n==="personalinformation"&&l.jsx(NS,{adminView:!0,investorId:t}),n==="contacts"&&l.jsx(ES,{adminView:!0,investorId:t})]})]})}function Jfe({label:e,options:t,value:r,onChange:n}){const[a,i]=g.useState(!1),o=g.useRef(null);g.useEffect(()=>{function f(h){o.current&&(o.current.contains(h.target)||i(!1))}return document.addEventListener("mousedown",f),()=>document.removeEventListener("mousedown",f)},[]);const u=t.find(f=>f.value===r)||null,m=u?u.label:"Select an investor";return l.jsxs("div",{className:"relative",ref:o,children:[l.jsx("label",{className:"mb-1 block text-sm font-medium",children:e}),l.jsxs("button",{type:"button",className:"flex w-full items-center justify-between rounded-lg border px-3 py-2 text-left text-sm outline-none focus:ring",onClick:()=>i(f=>!f),children:[l.jsx("span",{className:"truncate",children:m}),l.jsx("svg",{className:`h-4 w-4 transition ${a?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:l.jsx("path",{d:"M5.23 7.21a.75.75 0 011.06.02L10 10.585l3.71-3.354a.75.75 0 111.02 1.1l-4.22 3.81a.75.75 0 01-1.02 0l-4.22-3.81a.75.75 0 01-.02-1.06z"})})]}),a&&l.jsxs("div",{className:"absolute z-10 mt-1 w-full rounded-lg border bg-white shadow",children:[l.jsxs("div",{className:"max-h-60 overflow-auto py-1",children:[t.map(f=>l.jsxs("label",{className:"flex cursor-pointer items-center gap-2 px-3 py-2 text-sm hover:bg-gray-50",onClick:()=>{n(f.value),i(!1)},children:[l.jsx("input",{type:"radio",name:"single-select",checked:r===f.value,onChange:()=>{},className:"h-4 w-4"}),l.jsx("span",{className:"truncate",children:f.label})]},f.value)),t.length===0&&l.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No investors found."})]}),l.jsx("div",{className:"flex items-center justify-end gap-2 border-t px-3 py-2 text-xs",children:r!==null&&l.jsx("button",{type:"button",onClick:()=>n(null),className:"rounded border px-2 py-1 hover:bg-gray-50",children:"Clear"})})]})]})}function e0e(){return l.jsx(Xfe,{children:l.jsx(Zfe,{})})}function t0e(e){return fa({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M14 3v4a1 1 0 0 0 1 1h4"},child:[]},{tag:"path",attr:{d:"M5 12v-7a2 2 0 0 1 2 -2h7l5 5v4"},child:[]},{tag:"path",attr:{d:"M7 16.5a1.5 1.5 0 0 0 -3 0v3a1.5 1.5 0 0 0 3 0"},child:[]},{tag:"path",attr:{d:"M10 20.25c0 .414 .336 .75 .75 .75h1.25a1 1 0 0 0 1 -1v-1a1 1 0 0 0 -1 -1h-1a1 1 0 0 1 -1 -1v-1a1 1 0 0 1 1 -1h1.25a.75 .75 0 0 1 .75 .75"},child:[]},{tag:"path",attr:{d:"M16 15l2 6l2 -6"},child:[]}]})(e)}function r0e(e){return fa({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M14 3v4a1 1 0 0 0 1 1h4"},child:[]},{tag:"path",attr:{d:"M5 12v-7a2 2 0 0 1 2 -2h7l5 5v4"},child:[]},{tag:"path",attr:{d:"M5 15v6h1a2 2 0 0 0 2 -2v-2a2 2 0 0 0 -2 -2h-1z"},child:[]},{tag:"path",attr:{d:"M20 16.5a1.5 1.5 0 0 0 -3 0v3a1.5 1.5 0 0 0 3 0"},child:[]},{tag:"path",attr:{d:"M12.5 15a1.5 1.5 0 0 1 1.5 1.5v3a1.5 1.5 0 0 1 -3 0v-3a1.5 1.5 0 0 1 1.5 -1.5z"},child:[]}]})(e)}function n0e(e){return fa({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M14 3v4a1 1 0 0 0 1 1h4"},child:[]},{tag:"path",attr:{d:"M5 12v-7a2 2 0 0 1 2 -2h7l5 5v4"},child:[]},{tag:"path",attr:{d:"M5 18h1.5a1.5 1.5 0 0 0 0 -3h-1.5v6"},child:[]},{tag:"path",attr:{d:"M17 18h2"},child:[]},{tag:"path",attr:{d:"M20 15h-3v6"},child:[]},{tag:"path",attr:{d:"M11 15v6h1a2 2 0 0 0 2 -2v-2a2 2 0 0 0 -2 -2h-1z"},child:[]}]})(e)}function a0e(e){return fa({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M14 3v4a1 1 0 0 0 1 1h4"},child:[]},{tag:"path",attr:{d:"M14 3v4a1 1 0 0 0 1 1h4"},child:[]},{tag:"path",attr:{d:"M5 18h1.5a1.5 1.5 0 0 0 0 -3h-1.5v6"},child:[]},{tag:"path",attr:{d:"M11 18h1.5a1.5 1.5 0 0 0 0 -3h-1.5v6"},child:[]},{tag:"path",attr:{d:"M16.5 15h3"},child:[]},{tag:"path",attr:{d:"M18 15v6"},child:[]},{tag:"path",attr:{d:"M5 12v-7a2 2 0 0 1 2 -2h7l5 5v4"},child:[]}]})(e)}function nC(e){return fa({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M14 3v4a1 1 0 0 0 1 1h4"},child:[]},{tag:"path",attr:{d:"M14 3v4a1 1 0 0 0 1 1h4"},child:[]},{tag:"path",attr:{d:"M16.5 15h3"},child:[]},{tag:"path",attr:{d:"M5 12v-7a2 2 0 0 1 2 -2h7l5 5v4"},child:[]},{tag:"path",attr:{d:"M4.5 15h3"},child:[]},{tag:"path",attr:{d:"M6 15v6"},child:[]},{tag:"path",attr:{d:"M18 15v6"},child:[]},{tag:"path",attr:{d:"M10 15l4 6"},child:[]},{tag:"path",attr:{d:"M10 21l4 -6"},child:[]}]})(e)}function i0e(e){return fa({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M14 3v4a1 1 0 0 0 1 1h4"},child:[]},{tag:"path",attr:{d:"M5 12v-7a2 2 0 0 1 2 -2h7l5 5v4"},child:[]},{tag:"path",attr:{d:"M4 15l4 6"},child:[]},{tag:"path",attr:{d:"M4 21l4 -6"},child:[]},{tag:"path",attr:{d:"M17 20.25c0 .414 .336 .75 .75 .75h1.25a1 1 0 0 0 1 -1v-1a1 1 0 0 0 -1 -1h-1a1 1 0 0 1 -1 -1v-1a1 1 0 0 1 1 -1h1.25a.75 .75 0 0 1 .75 .75"},child:[]},{tag:"path",attr:{d:"M11 15v6h3"},child:[]}]})(e)}function s0e(e){return fa({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M6 20.735a2 2 0 0 1 -1 -1.735v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2h-1"},child:[]},{tag:"path",attr:{d:"M11 17a2 2 0 0 1 2 2v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1v-2a2 2 0 0 1 2 -2z"},child:[]},{tag:"path",attr:{d:"M11 5l-1 0"},child:[]},{tag:"path",attr:{d:"M13 7l-1 0"},child:[]},{tag:"path",attr:{d:"M11 9l-1 0"},child:[]},{tag:"path",attr:{d:"M13 11l-1 0"},child:[]},{tag:"path",attr:{d:"M11 13l-1 0"},child:[]},{tag:"path",attr:{d:"M13 15l-1 0"},child:[]}]})(e)}function l0e(e){return fa({attr:{viewBox:"0 0 16 16",fill:"currentColor"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M10.57 1.14l3.28 3.3.15.36v9.7l-.5.5h-11l-.5-.5v-13l.5-.5h7.72l.35.14zM10 5h3l-3-3v3zM3 2v12h10V6H9.5L9 5.5V2H3zm2.062 7.533l1.817-1.828L6.17 7 4 9.179v.707l2.171 2.174.707-.707-1.816-1.82zM8.8 7.714l.7-.709 2.189 2.175v.709L9.5 12.062l-.705-.709 1.831-1.82L8.8 7.714z"},child:[]}]})(e)}function o0e(e,t){g.useEffect(()=>{function r(n){!e.current||e.current.contains(n.target)||t?.()}return document.addEventListener("mousedown",r),()=>document.removeEventListener("mousedown",r)},[t,e])}function oy({anchorRect:e,children:t,onClose:r,width:n=260}){const a=g.useRef(null);o0e(a,r);const[i,o]=g.useState({top:0,left:0});return g.useEffect(()=>{if(!e)return;const u=8,m=document.documentElement.clientWidth,f=document.documentElement.clientHeight,h=window.pageXOffset,x=window.pageYOffset;let v=h+e.left,y=x+e.bottom+6;const w=h+m-n-u,b=h+u;v=Math.min(Math.max(b,v),w),o({top:y,left:v});const S=()=>{const A=a.current;if(!A)return;const k=A.offsetHeight||320;let C=y;const O=x+f-k-u;if(C>O){const T=x+e.top-k-6;C=Math.max(x+u,Math.min(T,O))}o(T=>T.top===C&&T.left===v?T:{top:C,left:v})},N=requestAnimationFrame(S),_=()=>requestAnimationFrame(S);return window.addEventListener("resize",_),window.addEventListener("scroll",_,{passive:!0}),()=>{cancelAnimationFrame(N),window.removeEventListener("resize",_),window.removeEventListener("scroll",_)}},[e,n]),e?Hb.createPortal(l.jsx("div",{style:{position:"absolute",inset:0,zIndex:1e4,pointerEvents:"none"},children:l.jsx("div",{ref:a,style:{position:"absolute",top:i.top,left:i.left,width:n,pointerEvents:"auto"},className:"rounded-md border border-slate-200 bg-white p-1 shadow-xl",children:t})}),document.body):null}function cy(e=""){const t=(e||"").toLowerCase().match(/\.([a-z0-9]+)$/i);return t?t[1]:""}function c0e(e,t){if(!e&&t){if(t.includes("pdf"))return"pdf";if(t.includes("excel")||t.includes("spreadsheet"))return"xls";if(t.includes("word"))return"doc";if(t.includes("powerpoint"))return"ppt";if(t.startsWith("image/"))return"image";if(t.includes("json"))return"json";if(t.includes("zip")||t.includes("compressed"))return"zip";if(t.startsWith("text/"))return"txt"}switch(e){case"pdf":return"pdf";case"xls":case"xlsx":return"xls";case"csv":return"csv";case"doc":case"docx":return"doc";case"ppt":case"pptx":return"ppt";case"png":case"jpg":case"jpeg":case"gif":case"webp":case"svg":return"image";case"zip":case"rar":case"7z":return"zip";case"json":return"json";case"txt":case"log":case"md":return"txt";case"js":case"ts":case"tsx":case"py":case"java":case"go":case"rb":case"php":case"c":case"cpp":case"cs":return"code";default:return"file"}}function aC({ext:e,mime:t,size:r=22,className:n=""}){const a=c0e(e,t),i={size:r,className:`shrink-0 ${n}`};switch(a){case"pdf":return l.jsx(n0e,{...i,className:`text-red-600 ${i.className}`});case"xls":return l.jsx(i0e,{...i,className:`text-emerald-600 ${i.className}`});case"csv":return l.jsx(t0e,{...i,className:`text-teal-600 ${i.className}`});case"doc":return l.jsx(r0e,{...i,className:`text-blue-600 ${i.className}`});case"ppt":return l.jsx(a0e,{...i,className:`text-orange-600 ${i.className}`});case"json":return l.jsx(nC,{...i,className:`text-cyan-600 ${i.className}`});case"txt":return l.jsx(nC,{...i,className:`text-slate-600 ${i.className}`});case"zip":return l.jsx(s0e,{...i,className:`text-amber-600 ${i.className}`});case"image":return l.jsx(Rfe,{...i,className:`text-fuchsia-600 ${i.className}`});case"code":return l.jsx(l0e,{...i,className:`text-indigo-600 ${i.className}`});default:return l.jsx(Mfe,{...i,className:`text-slate-700 ${i.className}`})}}function u0e(){const[e,t]=g.useState([]),[r,n]=g.useState([]),[a,i]=g.useState(null),[o,u]=g.useState([]),[m,f]=g.useState(!1),[h,x]=g.useState(""),[v,y]=g.useState(null),[w,b]=g.useState(null),[S,N]=g.useState(""),[_,A]=g.useState(""),k=24,C=8,[O,T]=g.useState([]),[z,P]=g.useState(!1),[Z,q]=g.useState(""),[B,fe]=g.useState(!1),Ne=g.useMemo(()=>{const ae=new Map;return O.forEach(He=>{He.file&&He.file.type?.startsWith?.("image/")&&ae.set(He.id,URL.createObjectURL(He.file))}),ae},[O]);g.useEffect(()=>()=>{Ne.forEach(ae=>URL.revokeObjectURL(ae))},[Ne]);const[he,K]=g.useState(null),[H,be]=g.useState(null),[te,I]=g.useState([]),[se,R]=g.useState([]),[W,Y]=g.useState(""),[Q,L]=g.useState("document"),ne=g.useMemo(()=>{const ae=W.trim().toLowerCase();return ae?te.filter(He=>(He.label||"").toLowerCase().includes(ae)||(He.email||"").toLowerCase().includes(ae)):te},[te,W]),ge=ne.length>0&&ne.every(ae=>se.includes(ae.user_id)),[G,ue]=g.useState(null),[Se,M]=g.useState(null),[Qe,xe]=g.useState(!1),[me,ze]=g.useState(null),[oe,ke]=g.useState(null),[Ge,Fe]=g.useState(null),[Be,xt]=g.useState(!1),[Ze,ht]=g.useState(null),[At,De]=g.useState(null),[Xe,at]=g.useState(null),[rt,de]=g.useState(null),[Ce,st]=g.useState(null),[nt,gt]=g.useState(null),[lr,Zt]=g.useState(null),Ue=ae=>ae>=1e6?(ae/1e6).toFixed(2)+" MB":ae>=1e3?(ae/1e3).toFixed(1)+" KB":(ae||0)+" B",et=g.useMemo(()=>r.find(ae=>ae.id===a)||null,[r,a]),ut=g.useMemo(()=>{const ae=_.trim().toLowerCase();return ae?e.filter(He=>((He.title||He.original_name||"")+"").toLowerCase().includes(ae)):e},[e,_]),Bt=g.useMemo(()=>new Set(ut.map(ae=>ae.id)),[ut]),er=g.useMemo(()=>{const ae=_.trim().toLowerCase();if(!ae)return r;const He=new Map(r.map(Kt=>[Kt.id,Kt])),tt=new Set(ut.filter(Kt=>Kt.folder_id!=null).map(Kt=>Kt.folder_id)),mt=new Set(r.filter(Kt=>(Kt.name||"").toLowerCase().includes(ae)).map(Kt=>Kt.id)),vt=new Set([...Array.from(tt),...Array.from(mt)]);function rr(Kt){let Hn=He.get(Kt);const Qt=new Set;for(;Hn&&Hn.parent_id!=null&&!Qt.has(Hn.parent_id);)Qt.add(Hn.parent_id),vt.add(Hn.parent_id),Hn=He.get(Hn.parent_id)}return Array.from(vt).forEach(Kt=>rr(Kt)),r.filter(Kt=>vt.has(Kt.id))},[r,ut,_]),tr=g.useMemo(()=>{const ae=new Map;return e.forEach(He=>{const tt=He.folder_id??null,mt=ae.get(tt)||[];mt.push(He),ae.set(tt,mt)}),ae},[e]),Me=g.useMemo(()=>ut.filter(ae=>ae.folder_id==null),[ut]),Ye=g.useMemo(()=>{const ae=new Map;return er.forEach(He=>{const tt=He.parent_id??null,mt=ae.get(tt)||[];mt.push(He),ae.set(tt,mt)}),ae.forEach(He=>He.sort((tt,mt)=>(tt.name||"").localeCompare(mt.name||""))),ae},[er]),it=Ye.get(null)||[],Ot=g.useMemo(()=>{if(Ce!=="folder"||!nt)return new Set;const ae=new Set([nt.id]),He=tt=>{(Ye.get(tt)||[]).forEach(vt=>{ae.has(vt.id)||(ae.add(vt.id),He(vt.id))})};return He(nt.id),ae},[Ce,nt,Ye]);g.useEffect(()=>{ha(),zn()},[]),g.useEffect(()=>{function ae(He){const tt=Array.from(He.clipboardData?.files||[])[0];tt&&V([tt])}return window.addEventListener("paste",ae),()=>window.removeEventListener("paste",ae)},[]);async function ha(){try{const{data:ae}=await We.get("/api/document-folders",{params:{include_counts:1}});ae?.ok&&n(ae.folders||[])}catch{n([])}}async function zn(){try{const{data:ae}=await We.get("/api/documents");ae?.ok&&t(ae.documents||[])}catch{t([]),q("Not authorized. Please sign in again.")}}async function Ri(ae){ae.preventDefault();const He=h.trim();if(He)try{const tt={name:He},mt=v??a??null;mt!=null&&(tt.parent_id=mt);const{data:vt}=await We.post("/api/document-folders",tt);if(!vt?.ok)throw new Error(vt?.error||"Create failed");f(!1),x(""),y(null),await ha(),vt.folder?.id&&(i(vt.folder.id),u(rr=>rr.includes(vt.folder.id)?rr:[...rr,vt.folder.id]))}catch(tt){alert(tt?.message||"Could not create folder")}}function Qn(ae){b(ae),N(ae.name||"")}async function Tr(ae){if(ae.preventDefault(),!w)return;const He=S.trim();if(He)try{const{data:tt}=await We.patch(`/api/document-folders/${w.id}`,{name:He});if(!tt?.ok)throw new Error(tt?.error||"Rename failed");b(null),N(""),await ha()}catch(tt){alert(tt?.message||"Could not rename folder")}}async function kr(ae){if(window.confirm(`Delete folder ${ae.name} and all its sharing settings?`))try{const{data:He}=await We.delete(`/api/document-folders/${ae.id}`);if(!He?.ok)throw new Error(He?.error||"Delete failed");a===ae.id&&i(null),u(tt=>tt.filter(mt=>mt!==ae.id)),await zn(),await ha()}catch(He){alert(He?.message||"Could not delete folder")}}const $a=ae=>{u(He=>He.includes(ae)?He.filter(tt=>tt!==ae):[...He,ae])},Mi=".pdf,.csv,.xls,.xlsx,.doc,.docx,.ppt,.pptx,.png,.jpg,.jpeg,.gif,.webp,.svg,.zip,.rar,.7z,.json,.txt,.md",Ul=50*1024*1024,F=()=>`${Date.now()}_${Math.random().toString(36).slice(2,8)}`,ee=ae=>ae?.name?ae.name.replace(/\.[^.]+$/,""):"Untitled";function V(ae){const He=Array.from(ae||[]);if(!He.length)return;const tt=[],mt=[];He.forEach(vt=>{vt.size>Ul?mt.push(`${vt.name} is too large (max 50MB).`):tt.push({id:F(),file:vt,title:ee(vt),progress:0,status:"idle"})}),T(vt=>[...vt,...tt]),mt.length&&q(mt.join(" "))}function X(ae){V(ae.target.files),ae.target.value=""}function J(ae){ae.preventDefault(),P(!1),V(ae.dataTransfer?.files)}function re(ae){ae.preventDefault(),P(!0)}function ie(ae){ae.preventDefault(),P(!1)}function ve(ae){T(He=>He.filter(tt=>tt.id!==ae))}function ce(){T([]),q("")}async function ye(ae){if(ae.preventDefault(),!O.length){q("Pick files first.");return}fe(!0),q("");for(let He=0;He<O.length;He++){const tt=O[He].id;await je(tt)}fe(!1),T(He=>He.filter(tt=>tt.status!=="done")),zn()}async function je(ae){T(mt=>mt.map(vt=>vt.id===ae?{...vt,status:"uploading",progress:8}:vt));const He=setInterval(()=>{T(mt=>mt.map(vt=>vt.id!==ae||vt.status!=="uploading"?vt:{...vt,progress:Math.min(94,vt.progress+Math.random()*8)}))},120),tt=O.find(mt=>mt.id===ae);try{const mt=tt.title?{title:tt.title}:{};a!=null&&(mt.folder_id=a);const{data:vt}=await eB("/api/documents/upload",tt.file,mt);if(clearInterval(He),!vt?.ok){const rr=vt?.error||"Upload failed";T(Kt=>Kt.map(Hn=>Hn.id===ae?{...Hn,status:"error",progress:0,error:rr}:Hn)),q(rr);return}T(rr=>rr.map(Kt=>Kt.id===ae?{...Kt,status:"done",progress:100}:Kt))}catch(mt){clearInterval(He);const vt=mt?.response?.data?.error||mt?.message||"Upload failed";T(rr=>rr.map(Kt=>Kt.id===ae?{...Kt,status:"error",progress:0,error:vt}:Kt)),q(vt)}}async function Pe(ae,He){K(ae),be(He),R([]),Y(""),L("document");try{const{data:tt}=await We.get("/api/documents/share-options",{params:{role:He}});if(!tt?.ok)throw new Error(tt?.error||"Failed to load options");I(tt.options||[])}catch(tt){I([]),alert(tt?.message||"Failed to load options")}}function Ie(ae){R(He=>He.includes(ae)?He.filter(tt=>tt!==ae):[...He,ae])}function Ke(){if(ge)R(ae=>ae.filter(He=>!ne.some(tt=>tt.user_id===He)));else{const ae=ne.map(He=>He.user_id);R(He=>Array.from(new Set([...He,...ae])))}}async function Ve(){if(!(!he||!se.length))try{const ae={document_id:he.id,investor_ids:se};H==="investor"&&(ae.share_target=Q);const{data:He}=await We.post("/api/documents/share",ae);if(!He?.ok)throw new Error(He?.error||"Share failed");K(null),be(null),I([]),R([]),Y(""),L("document"),zn()}catch(ae){alert(ae?.message||"Share failed")}}async function Je(ae,He){try{const{data:tt}=await We.delete("/api/documents/share",{data:{document_id:ae,investor_id:He}});if(!tt?.ok)throw new Error(tt?.error||"Revoke failed");zn()}catch(tt){alert(tt?.message||"Revoke failed")}}async function ft(ae){xe(!0),ze(ae),ke(null),Fe(null),xt(!0);try{const He=await We.get(`/api/documents/view/${ae.id}`,{responseType:"blob"});if((He.headers["content-type"]||ae.mime_type||"application/octet-stream").startsWith("text/")||["csv","json","txt","md"].includes(cy(ae.original_name))){const mt=await He.data.text();Fe(mt)}else{const mt=URL.createObjectURL(He.data);ke(mt)}}catch{Fe(null),ke(null),alert("Could not open preview. Try Download.")}finally{xt(!1)}}function Nt(){xe(!1),oe&&URL.revokeObjectURL(oe),ke(null),Fe(null),ze(null)}async function jt(ae){if(window.confirm(`Delete ${ae.title||ae.original_name}? This cannot be undone.`))try{const{data:He}=await We.delete(`/api/documents/${ae.id}`);if(!He?.ok)throw new Error(He?.error||"Delete failed");zn()}catch(He){alert(He?.message||"Delete failed")}}function Rt(ae){st("doc"),gt(ae),Zt(ae.folder_id??null)}function Mr(ae){st("folder"),gt(ae),Zt(ae.parent_id??null)}async function sn(){if(!(!Ce||!nt))try{if(Ce==="doc"){const{data:ae}=await We.patch(`/api/documents/${nt.id}`,{folder_id:lr});if(!ae?.ok)throw new Error(ae?.error||"Move failed");await zn()}else if(Ce==="folder"){const{data:ae}=await We.patch(`/api/document-folders/${nt.id}`,{parent_id:lr});if(!ae?.ok)throw new Error(ae?.error||"Move failed");await ha()}st(null),gt(null),Zt(null)}catch(ae){alert(ae?.message||"Move failed")}}function ln(ae,He=0){const tt=cy(ae.original_name),mt=(ae.shares||[]).map(rr=>rr.label||`User ${rr.investor_user_id}`),vt=mt.length===0?"":mt.length<=2?mt.join(", "):`${mt.slice(0,2).join(", ")} +${mt.length-2}`;return l.jsxs("tr",{className:"border-t",children:[l.jsx("td",{className:"px-2 py-2",children:l.jsxs("div",{className:"flex items-center gap-2",style:{paddingLeft:C+He*k},children:[l.jsx(aC,{ext:tt,mime:ae.mime_type}),l.jsx("button",{type:"button",className:"text-left truncate max-w-[32ch] hover:underline",title:"View",onClick:()=>ft(ae),children:ae.title||ae.original_name})]})}),l.jsx("td",{className:"px-2 py-2",children:l.jsx("span",{className:"truncate max-w-[32ch] inline-block",title:ae.original_name,children:ae.original_name})}),l.jsx("td",{className:"px-2 py-2",children:Ue(ae.size_bytes)}),l.jsx("td",{className:"px-2 py-2",children:new Date(ae.uploaded_at).toLocaleString()}),l.jsx("td",{className:"px-2 py-2",children:mt.length?l.jsxs("button",{className:"inline-flex items-center gap-1 px-2 py-1 rounded border hover:bg-slate-50",onClick:rr=>{ue(ae),M(rr.currentTarget.getBoundingClientRect())},title:mt.join(", "),children:[l.jsx("span",{className:"truncate max-w-[26ch]",children:vt}),l.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",className:"opacity-60",children:l.jsx("path",{d:"M7 10l5 5 5-5z"})})]}):l.jsx("span",{className:"text-gray-500",children:""})}),l.jsx("td",{className:"px-2 py-2 text-right",children:l.jsxs("div",{className:"inline-flex items-center gap-3",children:[l.jsx("button",{className:"text-blue-600 hover:underline",onClick:()=>ft(ae),children:"View"}),l.jsx("a",{className:"text-blue-600 hover:underline",href:`/api/documents/download/${ae.id}`,target:"_blank",rel:"noopener noreferrer",children:"Download"}),l.jsx("button",{className:"text-red-600 hover:underline",onClick:()=>jt(ae),title:"Delete",children:"Delete"}),l.jsx("button",{className:"inline-flex items-center justify-center rounded-md p-2 hover:bg-gray-100",title:"More",onClick:rr=>{ht(ae),De(rr.currentTarget.getBoundingClientRect())},children:l.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:[l.jsx("circle",{cx:"12",cy:"5",r:"1.5"}),l.jsx("circle",{cx:"12",cy:"12",r:"1.5"}),l.jsx("circle",{cx:"12",cy:"19",r:"1.5"})]})})]})})]},`doc-${ae.id}`)}function Dt(ae,He=0){const tt=ae.created_at?new Date(ae.created_at).toLocaleDateString():"",mt=a===ae.id,vt=o.includes(ae.id)||!!_,Kt=(tr.get(ae.id)||[]).filter(Qt=>Bt.has(Qt.id)),Hn=Ye.get(ae.id)||[];return l.jsxs(tn.Fragment,{children:[l.jsxs("tr",{className:"border-t cursor-pointer hover:bg-slate-50 "+(mt?"bg-slate-50":""),onClick:()=>{i(ae.id),u(Qt=>Qt.includes(ae.id)?Qt:[...Qt,ae.id])},children:[l.jsx("td",{className:"px-2 py-2",children:l.jsxs("div",{className:"flex items-center gap-2",style:{paddingLeft:C+He*k},children:[l.jsx("button",{type:"button",className:"p-1 rounded hover:bg-slate-100",onClick:Qt=>{Qt.stopPropagation(),$a(ae.id)},children:l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",className:"transition-transform "+(vt?"rotate-90":""),children:l.jsx("path",{d:"M9 6l6 6-6 6"})})}),l.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-lg bg-blue-50",children:l.jsx(Rb,{className:"text-blue-600",size:22})}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"font-medium text-gray-800",children:ae.name}),typeof ae.doc_count=="number"&&l.jsxs("span",{className:"text-xs text-gray-500",children:[ae.doc_count," ",ae.doc_count===1?"item":"items"]})]})]})}),l.jsx("td",{className:"px-2 py-2 text-gray-500",children:"Folder"}),l.jsx("td",{className:"px-2 py-2 text-gray-500",children:""}),l.jsx("td",{className:"px-2 py-2",children:tt}),l.jsx("td",{className:"px-2 py-2 text-gray-500",children:""}),l.jsx("td",{className:"px-2 py-2 text-right",children:l.jsx("button",{type:"button",className:"inline-flex items-center justify-center rounded-md p-2 hover:bg-gray-100",title:"More",onClick:Qt=>{Qt.stopPropagation(),at(ae),de(Qt.currentTarget.getBoundingClientRect())},children:l.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:[l.jsx("circle",{cx:"12",cy:"5",r:"1.5"}),l.jsx("circle",{cx:"12",cy:"12",r:"1.5"}),l.jsx("circle",{cx:"12",cy:"19",r:"1.5"})]})})})]}),vt&&Hn.map(Qt=>Dt(Qt,He+1)),vt&&Kt.map(Qt=>ln(Qt,He+1))]},`folder-${ae.id}`)}const Vt=()=>{at(null),de(null)};function Yr(ae,He=0){return(Ye.get(ae??null)||[]).map(mt=>{const vt=Ot.has(mt.id),rr=lr===mt.id;return l.jsxs(tn.Fragment,{children:[l.jsx("button",{type:"button",disabled:vt,onClick:()=>!vt&&Zt(mt.id),className:"flex w-full items-center justify-between px-3 py-1.5 text-sm "+(rr?"bg-blue-50 text-blue-700":"hover:bg-slate-50")+(vt?" opacity-50 cursor-not-allowed":""),style:{paddingLeft:C+He*k},children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"flex h-7 w-7 items-center justify-center rounded-md bg-blue-50",children:l.jsx(Rb,{className:"text-blue-600",size:18})}),l.jsx("span",{className:"truncate",children:mt.name})]})}),Yr(mt.id,He+1)]},`move-folder-${mt.id}`)})}return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white border rounded-xl shadow-sm",children:[l.jsxs("div",{className:"px-4 py-3 border-b flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[l.jsxs("div",{className:"space-y-1",children:[l.jsx("h3",{className:"text-base font-semibold text-gray-800",children:"Upload"}),l.jsxs("p",{className:"text-xs text-gray-500",children:["Destination folder:"," ",l.jsx("span",{className:"font-medium text-gray-800",children:et?et.name:"All documents"}),". Use the dropdown below to choose where files will go."]}),l.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-3",children:[l.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[l.jsx("span",{className:"text-gray-500",children:"Folder:"}),l.jsxs("select",{className:"border rounded-md px-2 py-1 text-xs",value:a??"",onChange:ae=>{const He=ae.target.value,tt=He===""?null:Number(He);i(tt),tt!=null&&u(mt=>mt.includes(tt)?mt:[...mt,tt])},children:[l.jsx("option",{value:"",children:"All documents (no folder)"}),r.map(ae=>l.jsx("option",{value:ae.id,children:ae.name},ae.id))]})]}),a!=null&&e.some(ae=>ae.folder_id===a)&&l.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[l.jsx("span",{className:"text-gray-500",children:"Files in folder:"}),l.jsxs("select",{className:"border rounded-md px-2 py-1 text-xs max-w-[220px]",children:[l.jsx("option",{value:"",children:"Select a file"}),e.filter(ae=>ae.folder_id===a).map(ae=>l.jsx("option",{value:ae.id,children:ae.title||ae.original_name},ae.id))]})]})]})]}),l.jsxs("div",{className:"text-xs md:text-sm text-gray-600",children:["Tip: You can also"," ",l.jsx("span",{className:"font-medium",children:"paste"})," a file (Ctrl/Cmd+V) directly into this page."]})]}),l.jsxs("form",{className:"p-4",onSubmit:ye,children:[l.jsx("label",{className:"block text-sm font-medium mb-2",children:"Your files"}),l.jsx("div",{onDrop:J,onDragOver:re,onDragLeave:ie,className:["relative rounded-2xl border-2 border-dashed px-5 py-6 transition-all w-full",z?"border-emerald-500 bg-emerald-50":"border-slate-200 hover:border-slate-300"].join(" "),children:O.length===0?l.jsxs("div",{className:"flex flex-col items-center text-center gap-3",children:[l.jsx("div",{className:"w-14 h-14 rounded-full bg-slate-50 flex items-center justify-center",children:l.jsx(J3,{className:"text-slate-500",size:28})}),l.jsxs("div",{className:"text-sm text-slate-600",children:[l.jsx("span",{className:"font-medium text-slate-800",children:"Drag & drop"})," ","files here, or"," ",l.jsxs("label",{className:"text-emerald-700 cursor-pointer hover:underline",children:["browse",l.jsx("input",{type:"file",accept:Mi,multiple:!0,onChange:X,className:"sr-only"})]})]}),l.jsx("div",{className:"text-xs text-slate-500",children:"Accepted: PDF, XLS/XLSX, CSV, DOC/DOCX, PPT/PPTX, Images, ZIP, JSON, TXT (max 50MB each)"})]}):l.jsx("div",{className:"space-y-3",children:O.map(ae=>{const He=cy(ae.file?.name),tt=Ne.get(ae.id);return l.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg ring-1 ring-slate-200",children:[tt?l.jsx("img",{src:tt,alt:"preview",className:"w-12 h-12 rounded-md object-cover"}):l.jsx("div",{className:"w-12 h-12 rounded-md bg-slate-50 flex items-center justify-center",children:l.jsx(aC,{ext:He,mime:ae.file?.type,size:22})}),l.jsxs("div",{className:"min-w-0 flex-1",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"text-sm font-medium text-slate-800 truncate",title:ae.file?.name,children:ae.file?.name}),l.jsx("div",{className:"text-xs text-slate-500 shrink-0",children:Ue(ae.file?.size)})]}),l.jsx("div",{className:"mt-1",children:l.jsx("input",{className:"w-full border rounded-md px-2 py-1 text-sm",value:ae.title,onChange:mt=>T(vt=>vt.map(rr=>rr.id===ae.id?{...rr,title:mt.target.value}:rr)),placeholder:"Title (optional)"})}),(ae.status==="uploading"||ae.status==="done")&&l.jsx("div",{className:"mt-2 h-2 w-full rounded-full bg-slate-100 overflow-hidden",children:l.jsx("div",{className:"h-full bg-emerald-600 transition-all",style:{width:`${ae.progress}%`}})}),ae.status==="error"&&l.jsx("div",{className:"mt-1 text-xs text-red-600",children:ae.error||"Upload failed"})]}),l.jsx("button",{type:"button",className:"p-2 rounded-md hover:bg-slate-100 text-slate-500",onClick:()=>ve(ae.id),title:"Remove",disabled:ae.status==="uploading",children:l.jsx(Pb,{size:18})})]},ae.id)})})}),l.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-3 justify-end",children:[l.jsxs("label",{children:[l.jsx("input",{type:"file",accept:Mi,multiple:!0,onChange:X,className:"sr-only"}),l.jsx("span",{className:"inline-flex items-center px-3 py-2 rounded-lg border hover:bg-slate-50 cursor-pointer",children:"Choose files"})]}),l.jsx("button",{type:"button",className:"inline-flex items-center px-3 py-2 rounded-lg border",onClick:ce,disabled:!O.length||B,children:"Clear"}),l.jsxs("button",{type:"submit",disabled:!O.length||B,className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-gray-900 text-white hover:bg-black disabled:opacity-50",children:[l.jsx(J3,{size:18}),B?"Uploading":`Upload ${O.length} file${O.length>1?"s":""}`]})]}),Z&&l.jsxs("div",{className:"mt-3 flex items-center gap-2 text-sm",children:[l.jsx(Cfe,{className:"text-emerald-600"}),l.jsx("span",{children:Z})]})]})]}),l.jsxs("div",{className:"bg-white border rounded-xl shadow-sm",children:[l.jsxs("div",{className:"px-4 py-3 border-b space-y-3",children:[l.jsxs("div",{className:"flex items-center justify-between gap-3",children:[l.jsx("h3",{className:"text-base font-semibold text-gray-800",children:"Documents"}),l.jsx("button",{type:"button",className:"inline-flex items-center px-3 py-1.5 rounded-lg border text-sm hover:bg-slate-50",onClick:()=>{f(!0),x(""),y(a??null)},children:"+ New folder"})]}),l.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[l.jsx("div",{className:"flex-1 min-w-[220px]",children:l.jsx("input",{value:_,onChange:ae=>A(ae.target.value),placeholder:"Search folders and files...",className:"w-full rounded-lg border px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-emerald-500"})}),l.jsxs("div",{className:"text-xs text-gray-500",children:["Current folder:"," ",l.jsx("span",{className:"font-medium text-gray-800",children:et?et.name:"All documents"})]})]})]}),l.jsx("div",{className:"p-4 overflow-auto",children:it.length||ut.length?l.jsxs("table",{className:"min-w-full text-sm",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"text-left px-2 py-2 w-[40%]",children:"Name"}),l.jsx("th",{className:"text-left px-2 py-2 w-[15%]",children:"Original / Info"}),l.jsx("th",{className:"text-left px-2 py-2 w-[10%]",children:"Size"}),l.jsx("th",{className:"text-left px-2 py-2 w-[20%]",children:"Uploaded"}),l.jsx("th",{className:"text-left px-2 py-2 w-[15%]",children:"Shared With"}),l.jsx("th",{className:"text-right px-2 py-2 w-[10%]",children:"Actions"})]})}),l.jsxs("tbody",{children:[it.map(ae=>Dt(ae,0)),Me.length>0&&Me.map(ae=>ln(ae,0))]})]}):l.jsx("div",{className:"text-gray-500 text-sm",children:"No folders or documents yet."})})]}),Xe&&rt&&l.jsxs(oy,{anchorRect:rt,onClose:Vt,children:[l.jsx("div",{className:"px-3 py-2 text-sm text-slate-600",children:"Folder actions"}),l.jsx("div",{className:"my-1 border-t"}),l.jsx("button",{className:"w-full text-left px-3 py-2 text-sm hover:bg-slate-50",onClick:()=>{f(!0),x(""),y(Xe.id),Vt()},children:"New subfolder"}),l.jsx("button",{className:"w-full text-left px-3 py-2 text-sm hover:bg-slate-50",onClick:()=>{Mr(Xe),Vt()},children:"Move to folder"}),l.jsx("div",{className:"my-1 border-t"}),l.jsx("button",{className:"w-full text-left px-3 py-2 text-sm hover:bg-slate-50",onClick:()=>{Qn(Xe),Vt()},children:"Rename"}),l.jsx("button",{className:"w-full text-left px-3 py-2 text-sm hover:bg-slate-50 text-red-600",onClick:()=>{kr(Xe),Vt()},children:"Delete"})]}),Ze&&At&&l.jsxs(oy,{anchorRect:At,onClose:()=>{ht(null),De(null)},children:[l.jsx("div",{className:"px-3 py-2 text-sm text-slate-600",children:"Document actions"}),l.jsx("div",{className:"my-1 border-t"}),l.jsx("button",{className:"w-full text-left px-3 py-2 text-sm hover:bg-slate-50",onClick:()=>{Rt(Ze),ht(null),De(null)},children:"Move to folder"}),l.jsx("div",{className:"my-1 border-t"}),l.jsx("button",{className:"w-full text-left px-3 py-2 text-sm hover:bg-slate-50",onClick:()=>{Pe(Ze,"admin"),ht(null),De(null)},children:" Share with Admin"}),l.jsx("button",{className:"w-full text-left px-3 py-2 text-sm hover:bg-slate-50",onClick:()=>{Pe(Ze,"group_admin"),ht(null),De(null)},children:" Share with Group Admin"}),l.jsx("button",{className:"w-full text-left px-3 py-2 text-sm hover:bg-slate-50",onClick:()=>{Pe(Ze,"investor"),ht(null),De(null)},children:" Share with Investor"})]}),G&&Se&&l.jsxs(oy,{anchorRect:Se,onClose:()=>{ue(null),M(null)},width:280,children:[l.jsx("div",{className:"px-3 py-2 text-sm text-slate-600",children:"Shared With"}),l.jsx("div",{className:"my-1 border-t"}),l.jsx("div",{className:"max-h-[260px] overflow-auto",children:(G.shares||[]).map(ae=>l.jsxs("div",{className:"flex items-center justify-between px-3 py-2",children:[l.jsxs("div",{className:"truncate pr-2",children:[l.jsx("div",{className:"text-sm font-medium truncate",children:ae.label||`User ${ae.investor_user_id}`}),ae.email?l.jsx("div",{className:"text-xs text-gray-500 truncate",children:ae.email}):null]}),l.jsx("button",{className:"text-red-600 hover:underline text-sm",onClick:()=>{Je(G.id,ae.investor_user_id),ue(null),M(null)},title:"Revoke access",children:"Revoke"})]},ae.investor_user_id))})]}),he&&l.jsx("div",{className:"fixed inset-0 z-30 flex items-center justify-center bg-black/30",onMouseDown:()=>{K(null),be(null)},children:l.jsxs("div",{className:"w-[560px] max-h-[75vh] overflow-auto rounded-2xl bg-white p-4 shadow-2xl",onMouseDown:ae=>ae.stopPropagation(),children:[l.jsxs("div",{className:"mb-3",children:[l.jsxs("div",{className:"text-lg font-semibold",children:["Share ",he.title||he.original_name,""]}),l.jsxs("div",{className:"text-sm text-gray-500 flex flex-wrap items-center gap-2",children:[l.jsxs("span",{children:["Role: ",l.jsx("span",{className:"font-medium",children:H})]}),H==="investor"&&l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"mx-1 text-gray-300",children:""}),l.jsxs("label",{className:"inline-flex items-center gap-2",children:[l.jsx("span",{children:"Share as:"}),l.jsxs("select",{value:Q,onChange:ae=>L(ae.target.value),className:"border rounded-md px-2 py-1 text-sm",children:[l.jsx("option",{value:"document",children:"Document (Documents tab)"}),l.jsx("option",{value:"statement",children:"Statement (Statements tab)"})]})]})]})]})]}),l.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[l.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-gray-50 border-b",children:[l.jsx("label",{className:"inline-flex items-center gap-2 text-sm",children:l.jsx("input",{type:"checkbox",checked:ge,onChange:Ke})}),l.jsxs("div",{className:"text-xs text-gray-500",children:[se.length," selected "," ",ne.length," shown"]})]}),l.jsxs("div",{className:"px-3 py-2 border-b flex items-center gap-2",children:[l.jsx("input",{value:W,onChange:ae=>Y(ae.target.value),placeholder:"Search by name or email",className:"w-full rounded-md border px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-emerald-500"}),W&&l.jsx("button",{type:"button",className:"text-xs text-gray-500 hover:underline",onClick:()=>Y(""),title:"Clear",children:"Clear"})]}),l.jsx("div",{className:"max-h-[320px] overflow-auto divide-y",children:ne.length?ne.map(ae=>l.jsxs("label",{className:"flex items-center gap-3 px-3 py-2",children:[l.jsx("input",{type:"checkbox",checked:se.includes(ae.user_id),onChange:()=>Ie(ae.user_id)}),l.jsxs("div",{className:"flex-1",children:[l.jsx("div",{className:"text-sm font-medium",children:ae.label}),ae.email&&l.jsx("div",{className:"text-xs text-gray-500",children:ae.email})]})]},ae.user_id)):l.jsxs("div",{className:"px-3 py-8 text-center text-sm text-gray-500",children:["No matches for ",W,"."]})})]}),l.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[l.jsx("button",{className:"px-3 py-2 rounded-lg border border-gray-300",onClick:()=>{K(null),be(null),I([]),R([]),Y(""),L("document")},children:"Cancel"}),l.jsx("button",{className:"px-3 py-2 rounded-lg bg-gray-900 text-white disabled:opacity-50",disabled:!se.length,onClick:Ve,children:"Share"})]})]})}),m&&l.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/30",onMouseDown:()=>f(!1),children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-[380px] max-w-full p-4",onMouseDown:ae=>ae.stopPropagation(),children:[l.jsx("h3",{className:"text-base font-semibold mb-2",children:"Create new folder"}),l.jsxs("form",{onSubmit:Ri,className:"space-y-4",children:[l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:"text-sm text-gray-700",children:"Folder name"}),l.jsx("input",{autoFocus:!0,className:"w-full border rounded-md px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-emerald-500",value:h,onChange:ae=>x(ae.target.value)})]}),l.jsxs("div",{className:"text-xs text-gray-500",children:["Parent folder:"," ",l.jsx("span",{className:"font-medium text-gray-800",children:v==null?"Top level (no parent)":r.find(ae=>ae.id===v)?.name||"Selected folder"})]}),l.jsxs("div",{className:"flex justify-end gap-2",children:[l.jsx("button",{type:"button",className:"px-3 py-2 rounded-lg border text-sm",onClick:()=>f(!1),children:"Cancel"}),l.jsx("button",{type:"submit",className:"px-3 py-2 rounded-lg bg-gray-900 text-white text-sm disabled:opacity-50",disabled:!h.trim(),children:"Create"})]})]})]})}),w&&l.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/30",onMouseDown:()=>b(null),children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-[380px] max-w-full p-4",onMouseDown:ae=>ae.stopPropagation(),children:[l.jsx("h3",{className:"text-base font-semibold mb-2",children:"Rename folder"}),l.jsxs("form",{onSubmit:Tr,className:"space-y-4",children:[l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:"text-sm text-gray-700",children:"Folder name"}),l.jsx("input",{autoFocus:!0,className:"w-full border rounded-md px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-emerald-500",value:S,onChange:ae=>N(ae.target.value)})]}),l.jsxs("div",{className:"flex justify-end gap-2",children:[l.jsx("button",{type:"button",className:"px-3 py-2 rounded-lg border text-sm",onClick:()=>b(null),children:"Cancel"}),l.jsx("button",{type:"submit",className:"px-3 py-2 rounded-lg bg-gray-900 text-white text-sm disabled:opacity-50",disabled:!S.trim(),children:"Save"})]})]})]})}),Ce&&nt&&l.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/30",onMouseDown:()=>{st(null),gt(null),Zt(null)},children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-[420px] max-w-full p-4",onMouseDown:ae=>ae.stopPropagation(),children:[l.jsxs("h3",{className:"text-base font-semibold mb-2",children:["Move ",nt.name||nt.title||nt.original_name,""]}),l.jsxs("p",{className:"text-xs text-gray-500 mb-3",children:["Choose the destination folder for this"," ",Ce==="doc"?"file":"folder","."]}),l.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[l.jsx("button",{type:"button",onClick:()=>Zt(null),className:"flex w-full items-center justify-between px-3 py-1.5 text-sm "+(lr==null?"bg-blue-50 text-blue-700":"hover:bg-slate-50"),children:l.jsx("span",{children:"Top level (no folder)"})}),l.jsx("div",{className:"max-h-[260px] overflow-auto border-t",children:Yr(null,0)})]}),l.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[l.jsx("button",{type:"button",className:"px-3 py-2 rounded-lg border text-sm",onClick:()=>{st(null),gt(null),Zt(null)},children:"Cancel"}),l.jsx("button",{type:"button",className:"px-3 py-2 rounded-lg bg-gray-900 text-white text-sm",onClick:sn,children:"Move here"})]})]})}),Qe&&l.jsx("div",{className:"fixed inset-0 z-40 bg-black/60 flex items-center justify-center",onMouseDown:Nt,children:l.jsxs("div",{className:"bg-white w-[92vw] max-w-5xl max-h-[85vh] rounded-2xl shadow-2xl overflow-hidden",onMouseDown:ae=>ae.stopPropagation(),children:[l.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",children:[l.jsx("div",{className:"font-semibold text-gray-800 truncate",children:me?.title||me?.original_name}),l.jsxs("div",{className:"flex items-center gap-3",children:[me&&l.jsx("a",{className:"text-blue-600 hover:underline",href:`/api/documents/download/${me.id}`,target:"_blank",rel:"noreferrer",children:"Download"}),l.jsx("button",{className:"p-2 rounded hover:bg-slate-100",onClick:Nt,"aria-label":"Close",children:l.jsx(Pb,{size:18})})]})]}),l.jsxs("div",{className:"p-0 bg-slate-50 h-[75vh] overflow-hidden",children:[Be&&l.jsx("div",{className:"h-full grid place-items-center text-sm text-slate-600",children:"Loading preview"}),!Be&&oe&&(me?.mime_type||"").includes("pdf")&&l.jsx("iframe",{title:"PDF",src:oe,className:"w-full h-full"}),!Be&&oe&&me&&me.mime_type&&me.mime_type.startsWith("image/")&&l.jsx("img",{src:oe,alt:"preview",className:"max-h-full max-w-full object-contain mx-auto"}),!Be&&Ge&&l.jsx("pre",{className:"h-full overflow-auto p-4 whitespace-pre-wrap text-[13px] leading-5",children:Ge}),!Be&&!oe&&!Ge&&l.jsx("div",{className:"h-full grid place-items-center text-sm text-slate-600",children:"No preview available. Use Download instead."})]})]})})]})}function d0e(){const[e,t]=g.useState(!1),[r,n]=g.useState(!1),[a,i]=g.useState([]),o=g.useRef(null),u=()=>{const b=localStorage.getItem("accessToken");return b?{Authorization:`Bearer ${b}`}:{}},m=b=>b==null?"":b<1024?`${b} B`:b<1024*1024?`${(b/1024).toFixed(1)} KB`:`${(b/(1024*1024)).toFixed(1)} MB`,f=b=>{if(!b)return"";try{return new Date(b*1e3).toLocaleString()}catch{return""}},h=async()=>{try{const b=await fetch("/api/kb/list",{credentials:"include",headers:{...u()}}),S=await b.json();b.ok?i(S.items||[]):console.error(S)}catch(b){console.error(b)}};g.useEffect(()=>{h()},[]);const x=async b=>{if(b?.length){t(!0);try{for(const S of b)try{const N=new FormData;N.append("file",S);const _=await fetch("/api/kb/upload",{method:"POST",body:N,credentials:"include",headers:{...u()}}),A=await _.json();_.ok||console.error(A)}catch(N){console.error(N)}await h()}finally{t(!1)}}},v=b=>x(Array.from(b.target.files||[])),y=g.useCallback(b=>{b.preventDefault(),b.stopPropagation(),n(!1);const S=Array.from(b.dataTransfer?.files||[]);x(S)},[]),w=async b=>{if(window.confirm("Delete this file from your knowledge base?"))try{const S=await fetch(`/api/kb/${b}`,{method:"DELETE",credentials:"include",headers:{...u()}}),N=await S.json();S.ok?i(N.items||[]):alert(N.error||"Delete failed")}catch(S){alert(String(S))}};return l.jsxs("div",{className:"space-y-5",children:[l.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm p-5",children:[l.jsxs("div",{className:"flex items-start justify-between gap-4",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Knowledge Base"}),l.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Upload any file. We ",l.jsx("span",{className:"font-medium",children:"only"})," keep the embeddings (never the file). Your chatbot answers strictly from ",l.jsx("span",{className:"font-medium",children:"your"})," indexed content."]}),l.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-3 text-xs",children:[l.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 rounded-full bg-blue-50 text-blue-700",children:[l.jsx(TB,{size:14})," txt  md  csv  xlsx  pdf  docx  pptx  "]}),l.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 rounded-full bg-emerald-50 text-emerald-700",children:[l.jsx(LB,{size:14})," Per-user isolated index"]})]})]}),l.jsxs("button",{onClick:()=>o.current?.click(),className:"inline-flex items-center gap-2 text-sm px-3 py-2 rounded-md border hover:bg-gray-50 text-gray-700",title:"Upload files",children:[l.jsx(CA,{size:16})," Upload"]})]}),l.jsx("div",{onDragOver:b=>{b.preventDefault(),n(!0)},onDragLeave:()=>n(!1),onDrop:y,className:`mt-5 rounded-xl border-2 border-dashed ${r?"border-blue-400 bg-blue-50/40":"border-gray-300 bg-gray-50"}`,children:l.jsxs("div",{className:"flex flex-col items-center justify-center p-10 text-center",children:[l.jsx("div",{className:`rounded-full p-3 ${r?"bg-blue-100":"bg-white border"}`,children:e?l.jsx(aO,{className:"animate-spin text-blue-600",size:22}):l.jsx(CA,{size:22,className:"text-blue-600"})}),l.jsxs("p",{className:"mt-3 text-sm text-gray-800",children:["Drag & drop files here, or"," ",l.jsx("button",{type:"button",onClick:()=>o.current?.click(),className:"text-blue-700 font-medium hover:underline",children:"browse"})]}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Multiple files supported. Max recommended 50 MB per file."}),l.jsx("input",{ref:o,type:"file",multiple:!0,className:"hidden",onChange:v})]})})]}),l.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm overflow-hidden",children:[l.jsxs("div",{className:"px-5 py-3 border-b flex items-center justify-between",children:[l.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Activity"}),l.jsx("button",{onClick:h,className:"text-xs px-2 py-1 rounded-md border hover:bg-gray-50 text-gray-700",children:"Refresh"})]}),a.length===0?l.jsx("div",{className:"p-6 text-sm text-gray-500",children:"No uploads yet. Drop a few files above to start indexing."}):l.jsx("ul",{className:"divide-y",children:a.map(b=>l.jsxs("li",{className:"px-5 py-3 flex items-start gap-3",children:[l.jsx("div",{className:"mt-0.5",children:l.jsx(bB,{className:"text-emerald-600",size:18})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[l.jsx(AB,{size:16,className:"text-gray-500"}),l.jsx("span",{className:"text-sm font-medium text-gray-900 truncate",children:b.name}),l.jsxs("span",{className:"text-xs text-gray-500",children:[" ",m(b.size)]}),l.jsxs("span",{className:"text-xs text-gray-400",children:[" ",f(b.created)]})]}),l.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["ID: ",l.jsx("span",{className:"font-mono",children:b.id})]})]}),l.jsxs("button",{onClick:()=>w(b.id),className:"ml-auto inline-flex items-center gap-1 text-xs px-2 py-1 rounded-md border text-rose-700 hover:bg-rose-50",title:"Delete from knowledge base",children:[l.jsx(iO,{size:14})," Delete"]})]},b.id))})]}),l.jsx("p",{className:"text-[11px] text-gray-500",children:"Tip: After uploading, open the chat and ask naturally. The bot retrieves from your user-scoped FAISS index."})]})}function f0e(e){return document.cookie.split("; ").find(t=>t.startsWith(e+"="))?.split("=")[1]||""}async function Sa(e,t={}){const r=new Headers(t.headers||{});if(t.method&&t.method!=="GET"||t.forceXsrf){const n=f0e("XSRF-TOKEN");n&&r.set("X-XSRF-TOKEN",n)}return fetch(e,{...t,headers:r,credentials:"include"})}function h0e(){const[e,t]=g.useState([]),[r,n]=g.useState(""),[a,i]=g.useState(!1),[o,u]=g.useState(null),[m,f]=g.useState({}),[h,x]=g.useState(null),[v,y]=g.useState(!1),[w,b]=g.useState(null),[S,N]=g.useState([]),[_,A]=g.useState([]),[k,C]=g.useState(!1),[O,T]=g.useState(!1),[z,P]=g.useState(!1),[Z,q]=g.useState([]),[B,fe]=g.useState(""),[Ne,he]=g.useState(!1),[K,H]=g.useState(!1),[be,te]=g.useState(!1),[I,se]=g.useState(null),[R,W]=g.useState(""),[Y,Q]=g.useState(""),[L,ne]=g.useState([]),[ge,G]=g.useState([]),[ue,Se]=g.useState([]),[M,Qe]=g.useState(!1),[xe,me]=g.useState(null),[ze,oe]=g.useState(null);g.useEffect(()=>{ke()},[]);const ke=async()=>{i(!0),n("");try{const Ue=await Sa("/api/admin/users?per_page=500",{method:"GET"}),et=await Ue.json().catch(()=>({}));if(!Ue.ok||et.ok===!1)throw new Error(et.error||`Failed to load users (${Ue.status})`);const Bt=(Array.isArray(et.data)?et.data:[]).filter(er=>(er.role||"").toLowerCase().includes("group"));t(Bt)}catch(Ue){console.error(Ue),n(Ue.message||"Failed to load Group Investor Admins")}finally{i(!1)}},Ge=async Ue=>{x(Ue),n("");try{const et=await Sa(`/api/admin/group-admins/${Ue}/investors`,{method:"GET"}),ut=await et.json().catch(()=>({}));if(!et.ok||ut.ok===!1)throw new Error(ut.message||`Failed to load members (${et.status})`);f(Bt=>({...Bt,[Ue]:ut.members||[]}))}catch(et){console.error(et),n(et.message||"Failed to load group members")}finally{x(null)}},Fe=async Ue=>{b(Ue),y(!0),A([]),await xt(Ue.id)},Be=()=>{y(!1),b(null),N([]),A([])},xt=async Ue=>{C(!0),n("");try{const et=await Sa(`/api/admin/group-admins/${Ue}/available-investors`,{method:"GET"}),ut=await et.json().catch(()=>({}));if(!et.ok||ut.ok===!1)throw new Error(ut.message||`Failed to load available investors (${et.status})`);N(ut.investors||[])}catch(et){console.error(et),n(et.message||"Failed to load available investors")}finally{C(!1)}},Ze=Ue=>{A(et=>et.includes(Ue)?et.filter(ut=>ut!==Ue):[...et,Ue])},ht=async Ue=>{if(Ue.preventDefault(),!(!w||_.length===0)){T(!0),n("");try{const et=await Sa(`/api/admin/group-admins/${w.id}/investors`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({investor_ids:_})}),ut=await et.json().catch(()=>({}));if(!et.ok||ut.ok===!1)throw new Error(ut.message||`Failed to add investors to group (status ${et.status})`);await Ge(w.id),Be()}catch(et){console.error(et),n(et.message||"Failed to add investors to group")}finally{T(!1)}}},At=async(Ue,et)=>{try{const ut=await Sa(`/api/admin/group-admins/${Ue}/investors/${et}`,{method:"DELETE"}),Bt=await ut.json().catch(()=>({}));if(!ut.ok||Bt.ok===!1)throw new Error(Bt.message||`Failed to remove investor from group (status ${ut.status})`);await Ge(Ue)}catch(ut){console.error(ut),n(ut.message||"Failed to remove investor from group")}},De=async Ue=>{try{const et=await Sa(`/api/admin/group-investor-admin/${Ue}`,{method:"DELETE"}),ut=await et.json().catch(()=>({}));if(!et.ok||ut.ok===!1)throw new Error(ut.message||`Failed to delete Group Investor Admin (status ${et.status})`);t(Bt=>Bt.filter(er=>er.id!==Ue)),f(Bt=>{const er={...Bt};return delete er[Ue],er})}catch(et){console.error(et),n(et.message||"Failed to delete Group Investor Admin")}},Xe=async()=>{P(!0),fe(""),await rt()},at=()=>{P(!1),q([]),fe("")},rt=async()=>{he(!0),n("");try{const Ue=await Sa("/api/admin/investors",{method:"GET"}),et=await Ue.json().catch(()=>({}));if(!Ue.ok||et.ok===!1)throw new Error(et.message||`Failed to load investors (${Ue.status})`);q(et.investors||[])}catch(Ue){console.error(Ue),n(Ue.message||"Failed to load investors for admin selection")}finally{he(!1)}},de=async Ue=>{if(Ue.preventDefault(),!!B){H(!0),n("");try{const et=await Sa("/api/admin/group-investor-admin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({investor_id:B})}),ut=await et.json().catch(()=>({}));if(!et.ok||ut.ok===!1)throw new Error(ut.message||`Failed to create Group Investor Admin (status ${et.status})`);await ke(),at()}catch(et){console.error(et),n(et.message||"Failed to create Group Investor Admin")}finally{H(!1)}}},Ce=async Ue=>{Qe(!0),n("");try{const[et,ut]=await Promise.all([Sa(`/api/admin/group-admins/${Ue}/investors`,{method:"GET"}),Sa(`/api/admin/group-admins/${Ue}/available-investors`,{method:"GET"})]),Bt=await et.json().catch(()=>({})),er=await ut.json().catch(()=>({}));if(!et.ok||Bt.ok===!1)throw new Error(Bt.message||`Failed to load members (${et.status})`);if(!ut.ok||er.ok===!1)throw new Error(er.message||`Failed to load available investors (${ut.status})`);const tr=Bt.members||[],Me=er.investors||[],Ye=[...tr.map(Ot=>({id:Ot.investor_id,name:Ot.name,email:Ot.email,isMember:!0})),...Me.map(Ot=>({id:Ot.id,name:Ot.name,email:Ot.email,isMember:!1}))],it=tr.map(Ot=>Ot.investor_id);ne(Ye),G(it),Se(it),f(Ot=>({...Ot,[Ue]:tr}))}catch(et){console.error(et),n(et.message||"Failed to load investors for editing")}finally{Qe(!1)}},st=Ue=>{se(Ue),W(Ue.status||""),Q(Ue.permission||""),te(!0),ne([]),G([]),Se([]),Ce(Ue.id)},nt=()=>{te(!1),se(null),W(""),Q(""),ne([]),G([]),Se([])},gt=Ue=>{G(et=>et.includes(Ue)?et.filter(ut=>ut!==Ue):[...et,Ue])},lr=async Ue=>{if(Ue.preventDefault(),!!I){H(!0),n("");try{const et=await Sa(`/api/admin/group-investor-admin/${I.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:R,permission:Y})}),ut=await et.json().catch(()=>({}));if(!et.ok||ut.ok===!1)throw new Error(ut.message||`Failed to update Group Investor Admin (status ${et.status})`);const Bt=ut.user||{};t(Me=>Me.map(Ye=>Ye.id===Bt.id?{...Ye,...Bt}:Ye));const er=ge.filter(Me=>!ue.includes(Me)),tr=ue.filter(Me=>!ge.includes(Me));if(er.length){const Me=await Sa(`/api/admin/group-admins/${I.id}/investors`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({investor_ids:er})}),Ye=await Me.json().catch(()=>({}));if(!Me.ok||Ye.ok===!1)throw new Error(Ye.message||`Failed to add investors to group (status ${Me.status})`)}if(tr.length)for(const Me of tr){const Ye=await Sa(`/api/admin/group-admins/${I.id}/investors/${Me}`,{method:"DELETE"}),it=await Ye.json().catch(()=>({}));if(!Ye.ok||it.ok===!1)throw new Error(it.message||`Failed to remove investor from group (status ${Ye.status})`)}await Ge(I.id),nt()}catch(et){console.error(et),n(et.message||"Failed to update Group Investor Admin")}finally{H(!1)}}},Zt=Ue=>{u(et=>et===Ue?null:Ue),m[Ue]||Ge(Ue)};return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Group Investor Admin"}),l.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Manage investor groups, assign admins, and control group-level access."})]}),r&&l.jsx("div",{className:"rounded-md bg-red-50 border border-red-200 px-4 py-3 text-sm text-red-700",children:r}),l.jsxs("div",{className:"rounded-xl border border-gray-200 bg-white p-4 space-y-4 shadow-sm",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Group Investor Admins"}),l.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Click the arrow on the left to view investors in each group."})]}),l.jsxs("button",{type:"button",onClick:Xe,className:"inline-flex items-center gap-2 rounded-md bg-blue-600 px-3 py-1.5 text-xs font-medium text-white shadow-sm hover:bg-blue-700",children:[l.jsx(FB,{size:14}),"Add Group Investor Admin"]})]}),a?l.jsx("p",{className:"text-sm text-gray-500",children:"Loading group admins..."}):e.length===0?l.jsxs("p",{className:"text-sm text-gray-500",children:["No Group Investor Admins yet. Click"," ",l.jsx("span",{className:"font-semibold",children:"Add Group Investor Admin"})," ","to create one."]}):l.jsx("div",{className:"overflow-x-auto rounded-lg border border-gray-100",children:l.jsxs("table",{className:"min-w-full text-sm",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"bg-gray-50 text-xs font-semibold uppercase text-gray-500",children:[l.jsx("th",{className:"w-10 px-3 py-2"}),l.jsx("th",{className:"px-3 py-2 text-left",children:"Name"}),l.jsx("th",{className:"px-3 py-2 text-left",children:"Email"}),l.jsx("th",{className:"px-3 py-2 text-left",children:"Created"}),l.jsx("th",{className:"px-3 py-2 text-right",children:"Actions"})]})}),l.jsx("tbody",{children:e.map((Ue,et)=>{const ut=m[Ue.id]||[],Bt=o===Ue.id,er=et%2===0?"bg-white":"bg-gray-50";return l.jsxs(tn.Fragment,{children:[l.jsxs("tr",{className:`${er} border-b border-gray-100`,children:[l.jsx("td",{className:"px-3 py-2 align-top",children:l.jsx("button",{type:"button",onClick:()=>Zt(Ue.id),className:"inline-flex h-7 w-7 items-center justify-center rounded hover:bg-gray-100 text-gray-500","aria-label":Bt?"Collapse investors list":"Expand to see investors",children:Bt?l.jsx(xB,{size:16}):l.jsx(gB,{size:16})})}),l.jsx("td",{className:"px-3 py-2 whitespace-nowrap align-middle",children:l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"font-medium text-gray-900",children:Ue.name||""}),ut.length>0&&l.jsxs("span",{className:"mt-0.5 inline-flex items-center rounded-full bg-blue-50 px-2 py-0.5 text-[11px] font-medium text-blue-700",children:[ut.length," investor",ut.length!==1?"s":""]})]})}),l.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-gray-700 align-middle",children:Ue.email||""}),l.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-gray-500 text-xs align-middle",children:Ue.created_at?new Date(Ue.created_at).toLocaleDateString():""}),l.jsx("td",{className:"px-3 py-2 whitespace-nowrap align-middle",children:l.jsxs("div",{className:"flex items-center justify-end gap-2",children:[l.jsxs("button",{type:"button",onClick:()=>Fe(Ue),className:"inline-flex items-center gap-1 rounded-md border border-gray-300 px-2 py-1 text-xs text-gray-700 hover:bg-gray-100",children:[l.jsx(sO,{size:14}),"Add Investor"]}),l.jsxs("button",{type:"button",onClick:()=>st(Ue),className:"inline-flex items-center gap-1 rounded-md border border-gray-300 px-2 py-1 text-xs text-gray-700 hover:bg-gray-100",children:[l.jsx(RB,{size:14}),"Edit"]}),l.jsxs("button",{type:"button",onClick:()=>me(Ue),className:"inline-flex items-center gap-1 rounded-md border border-red-200 px-2 py-1 text-xs text-red-600 hover:bg-red-50",children:[l.jsx(iO,{size:14}),"Delete"]})]})})]}),Bt&&l.jsxs("tr",{className:"bg-gray-50 border-b border-gray-100",children:[l.jsx("td",{className:"px-3 py-3"}),l.jsxs("td",{className:"px-3 py-3 text-sm text-gray-700",colSpan:4,children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("div",{className:"font-semibold",children:"Investors in this group"}),l.jsxs("span",{className:"text-xs text-gray-500",children:[ut.length," ",ut.length===1?"investor":"investors"]})]}),h===Ue.id?l.jsx("div",{className:"text-gray-500",children:"Loading investors..."}):ut.length===0?l.jsxs("div",{className:"text-gray-500",children:["No investors in this group yet. Use"," ",l.jsx("span",{className:"font-semibold",children:"Add Investor"})," ","to add one or more."]}):l.jsx("div",{className:"rounded-md border border-gray-200 bg-white",children:l.jsxs("table",{className:"min-w-full text-xs",children:[l.jsx("thead",{className:"bg-gray-50 text-gray-500 uppercase",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-3 py-1 text-left",children:"Investor"}),l.jsx("th",{className:"px-3 py-1 text-left",children:"Email"}),l.jsx("th",{className:"px-3 py-1 text-right",children:"Actions"})]})}),l.jsx("tbody",{children:ut.map(tr=>l.jsxs("tr",{className:"border-t border-gray-100",children:[l.jsx("td",{className:"px-3 py-1.5",children:tr.name||""}),l.jsx("td",{className:"px-3 py-1.5 text-gray-600",children:tr.email||""}),l.jsx("td",{className:"px-3 py-1.5 text-right",children:l.jsx("button",{type:"button",onClick:()=>oe({admin:Ue,member:tr}),className:"text-xs text-red-600 hover:text-red-800",children:"Remove"})})]},tr.investor_id))})]})})]})]})]},Ue.id)})})]})})]}),v&&w&&l.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/30",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-xl",children:[l.jsxs("div",{className:"flex items-center justify-between border-b px-4 py-3",children:[l.jsxs("h3",{className:"text-sm font-semibold",children:["Add Investors to Group "," ",l.jsx("span",{className:"font-bold",children:w.name||w.email})]}),l.jsx("button",{type:"button",onClick:Be,className:"text-gray-400 hover:text-gray-600",children:l.jsx(ys,{size:18})})]}),l.jsxs("form",{onSubmit:ht,children:[l.jsxs("div",{className:"max-h-80 overflow-y-auto px-4 py-3 space-y-2",children:[l.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Select one or more investors to add under this Group Investor Admin. Investors who are already in this group are not shown."}),k?l.jsx("div",{className:"text-sm text-gray-500",children:"Loading investors..."}):S.length===0?l.jsx("div",{className:"text-sm text-gray-500",children:"No available investors to add."}):S.map(Ue=>l.jsxs("label",{className:"flex items-center gap-2 rounded-md border border-gray-200 px-3 py-2 text-sm hover:bg-gray-50",children:[l.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:_.includes(Ue.id),onChange:()=>Ze(Ue.id)}),l.jsxs("span",{children:[Ue.name||""," ",l.jsxs("span",{className:"text-gray-500",children:["(",Ue.email||"",")"]})]})]},Ue.id))]}),l.jsxs("div",{className:"flex items-center justify-end gap-2 border-t px-4 py-3",children:[l.jsx("button",{type:"button",onClick:Be,className:"inline-flex items-center rounded-md border border-gray-300 px-3 py-1.5 text-xs font-medium text-gray-700 hover:bg-gray-100",children:"Cancel"}),l.jsx("button",{type:"submit",disabled:O||_.length===0,className:"inline-flex items-center rounded-md bg-blue-600 px-4 py-1.5 text-xs font-medium text-white shadow-sm hover:bg-blue-700 disabled:opacity-50",children:O?"Saving...":"Add Selected"})]})]})]})}),z&&l.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/30",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-md",children:[l.jsxs("div",{className:"flex items-center justify-between border-b px-4 py-3",children:[l.jsx("h3",{className:"text-sm font-semibold",children:"Add Group Investor Admin"}),l.jsx("button",{type:"button",onClick:at,className:"text-gray-400 hover:text-gray-600",children:l.jsx(ys,{size:18})})]}),l.jsxs("form",{onSubmit:de,children:[l.jsxs("div",{className:"px-4 py-3 space-y-3",children:[l.jsx("p",{className:"text-xs text-gray-500",children:"Select an investor user to promote to Group Investor Admin."}),Ne?l.jsx("div",{className:"text-sm text-gray-500",children:"Loading investors..."}):Z.length===0?l.jsx("div",{className:"text-sm text-gray-500",children:"No eligible investors found."}):l.jsxs("select",{className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-1 focus:ring-blue-500",value:B,onChange:Ue=>fe(Ue.target.value),children:[l.jsx("option",{value:"",children:"Select an investor"}),Z.map(Ue=>l.jsxs("option",{value:Ue.id,children:[Ue.name," (",Ue.email,")"]},Ue.id))]})]}),l.jsxs("div",{className:"flex items-center justify-end gap-2 border-t px-4 py-3",children:[l.jsx("button",{type:"button",onClick:at,className:"inline-flex items-center rounded-md border border-gray-300 px-3 py-1.5 text-xs font-medium text-gray-700 hover:bg-gray-100",children:"Cancel"}),l.jsx("button",{type:"submit",disabled:K||!B||Z.length===0,className:"inline-flex items-center rounded-md bg-blue-600 px-4 py-1.5 text-xs font-medium text-white shadow-sm hover:bg-blue-700 disabled:opacity-50",children:K?"Saving...":"Save as Group Admin"})]})]})]})}),be&&I&&l.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/30",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-lg",children:[l.jsxs("div",{className:"flex items-center justify-between border-b px-4 py-3",children:[l.jsx("h3",{className:"text-sm font-semibold",children:"Edit Group Investor Admin"}),l.jsx("button",{type:"button",onClick:nt,className:"text-gray-400 hover:text-gray-600",children:l.jsx(ys,{size:18})})]}),l.jsxs("form",{onSubmit:lr,children:[l.jsxs("div",{className:"px-4 py-3 space-y-4 text-sm",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-xs font-medium text-gray-500 mb-1",children:"Name"}),l.jsx("div",{className:"text-gray-800",children:I.name||""})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-xs font-medium text-gray-500 mb-1",children:"Email"}),l.jsx("div",{className:"text-gray-800",children:I.email||""})]}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Status"}),l.jsx("input",{type:"text",className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-1 focus:ring-blue-500",value:R,onChange:Ue=>W(Ue.target.value),placeholder:"e.g. Active, Inactive"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Permission"}),l.jsx("input",{type:"text",className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-1 focus:ring-blue-500",value:Y,onChange:Ue=>Q(Ue.target.value),placeholder:"e.g. Viewer, Editor, Owner"})]})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsx("span",{className:"text-xs font-medium text-gray-600",children:"Group investors"}),l.jsx("span",{className:"text-[11px] text-gray-500",children:"Checked investors belong to this group."})]}),M?l.jsx("div",{className:"text-sm text-gray-500",children:"Loading investors..."}):L.length===0?l.jsx("div",{className:"text-sm text-gray-500",children:"No eligible investors found."}):l.jsx("div",{className:"max-h-64 overflow-y-auto space-y-1 mt-1",children:L.map(Ue=>l.jsxs("label",{className:"flex items-center gap-2 rounded-md border border-gray-200 px-3 py-1.5 text-sm hover:bg-gray-50",children:[l.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:ge.includes(Ue.id),onChange:()=>gt(Ue.id)}),l.jsxs("span",{children:[Ue.name||""," ",l.jsxs("span",{className:"text-gray-500",children:["(",Ue.email||"",")"]}),ue.includes(Ue.id)&&l.jsx("span",{className:"ml-1 text-[10px] text-green-600",children:"current"})]})]},Ue.id))}),l.jsx("p",{className:"mt-1 text-[11px] text-gray-500",children:"Unchecking an investor will remove them from this group when you save."})]})]}),l.jsxs("div",{className:"flex items-center justify-end gap-2 border-t px-4 py-3",children:[l.jsx("button",{type:"button",onClick:nt,className:"inline-flex items-center rounded-md border border-gray-300 px-3 py-1.5 text-xs font-medium text-gray-700 hover:bg-gray-100",children:"Cancel"}),l.jsx("button",{type:"submit",disabled:K,className:"inline-flex items-center rounded-md bg-blue-600 px-4 py-1.5 text-xs font-medium text-white shadow-sm hover:bg-blue-700 disabled:opacity-50",children:K?"Saving...":"Save changes"})]})]})]})}),xe&&l.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/30",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-sm",children:[l.jsxs("div",{className:"flex items-center justify-between border-b px-4 py-3",children:[l.jsx("h3",{className:"text-sm font-semibold",children:"Delete Group Admin"}),l.jsx("button",{type:"button",onClick:()=>me(null),className:"text-gray-400 hover:text-gray-600",children:l.jsx(ys,{size:18})})]}),l.jsxs("div",{className:"px-4 py-3 text-sm text-gray-700 space-y-2",children:[l.jsx("p",{children:"Are you sure you want to delete this Group Investor Admin?"}),l.jsx("p",{className:"font-medium",children:xe.name||xe.email}),l.jsx("p",{className:"text-xs text-gray-500",children:"This will demote them back to a regular investor and remove their group memberships."})]}),l.jsxs("div",{className:"flex items-center justify-end gap-2 border-t px-4 py-3",children:[l.jsx("button",{type:"button",onClick:()=>me(null),className:"inline-flex items-center rounded-md border border-gray-300 px-3 py-1.5 text-xs font-medium text-gray-700 hover:bg-gray-100",children:"Cancel"}),l.jsx("button",{type:"button",onClick:async()=>{const Ue=xe.id;await De(Ue),me(null)},className:"inline-flex items-center rounded-md bg-red-600 px-4 py-1.5 text-xs font-medium text-white shadow-sm hover:bg-red-700",children:"Delete"})]})]})}),ze&&l.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/30",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-sm",children:[l.jsxs("div",{className:"flex items-center justify-between border-b px-4 py-3",children:[l.jsx("h3",{className:"text-sm font-semibold",children:"Remove Investor"}),l.jsx("button",{type:"button",onClick:()=>oe(null),className:"text-gray-400 hover:text-gray-600",children:l.jsx(ys,{size:18})})]}),l.jsxs("div",{className:"px-4 py-3 text-sm text-gray-700 space-y-2",children:[l.jsx("p",{children:"Remove this investor from the group?"}),l.jsxs("p",{className:"font-medium",children:[ze.member.name," (",ze.member.email||"",")"]})]}),l.jsxs("div",{className:"flex items-center justify-end gap-2 border-t px-4 py-3",children:[l.jsx("button",{type:"button",onClick:()=>oe(null),className:"inline-flex items-center rounded-md border border-gray-300 px-3 py-1.5 text-xs font-medium text-gray-700 hover:bg-gray-100",children:"Cancel"}),l.jsx("button",{type:"button",onClick:async()=>{const Ue=ze.admin.id,et=ze.member.investor_id;await At(Ue,et),oe(null)},className:"inline-flex items-center rounded-md bg-red-600 px-4 py-1.5 text-xs font-medium text-white shadow-sm hover:bg-red-700",children:"Remove"})]})]})})]})}const m0e=()=>{const[e,t]=g.useState("overview"),{user:r,logout:n}=g.useContext(Di);if(r===void 0)return l.jsx("div",{className:"p-6",children:"Loading"});const a={fullName:r?.name||[r?.first_name,r?.last_name].filter(Boolean).join(" ")||"Admin",email:r?.email||"",userType:(r?.user_type||"").toLowerCase()},i=({title:de,children:Ce})=>l.jsx("div",{className:"space-y-4",children:l.jsxs("div",{className:"bg-white border rounded-xl shadow-sm",children:[l.jsx("div",{className:"px-4 py-3 border-b",children:l.jsx("h3",{className:"text-base font-semibold text-gray-800",children:de})}),l.jsx("div",{className:"p-4 text-sm text-gray-600",children:Ce})]})}),o=()=>{switch(e){case"overview":return l.jsx(q3,{});case"investors":return l.jsx(e0e,{});case"groupInvestorAdmin":return l.jsx(h0e,{});case"companies":return l.jsx(i,{title:"Companies",children:"Portfolio companies with metrics, documents, and valuations. (Placeholder UI)"});case"management":return l.jsx(i,{title:"Management",children:"Management company items: fees, expenses, approvals, workflows. (Placeholder UI)"});case"documents":return l.jsx(u0e,{});case"settings":return l.jsx(qB,{});case"addUser":return l.jsx(VB,{});case"AllAdmins":return l.jsx(JB,{});case"excel":return l.jsx(UG,{});case"quickbooks":return l.jsx($G,{});case"manual":return l.jsx(HG,{});case"knowledge":return l.jsx(d0e,{});default:return l.jsx(q3,{})}},u=({label:de,tabKey:Ce,icon:st})=>l.jsxs("button",{onClick:()=>t(Ce),className:`flex items-center gap-2 w-full px-4 py-2 rounded-md text-sm transition font-medium ${e===Ce?"bg-blue-100 text-blue-800":"text-gray-700 hover:bg-gray-200"}`,children:[st,de]}),[m,f]=g.useState(!1),[h,x]=g.useState("invites"),[v,y]=g.useState({invites:0,deletes:0,dependents:0,groups:0}),[w,b]=g.useState(!1),[S,N]=g.useState([]),[_,A]=g.useState(!1),[k,C]=g.useState([]),[O,T]=g.useState(!1),[z,P]=g.useState([]),[Z,q]=g.useState(!1),[B,fe]=g.useState([]),[Ne,he]=g.useState(!1),K=g.useRef(null),H=g.useRef(null),be=g.useMemo(()=>Number(v.invites||0)+Number(v.deletes||0)+Number(v.dependents||0)+Number(v.groups||0),[v]),te=de=>{if(!de)return"";const Ce=new Date(de);return Number.isNaN(Ce.getTime())?de:Ce.toLocaleString()},I=async()=>{b(!0);try{let de=0,Ce=0,st=0,nt=0;try{const{data:gt}=await We.get("/api/invitations/stats");de=Number(gt?.pending||0)}catch(gt){console.error("Error loading invite stats",gt)}try{const{data:gt}=await We.get("/api/deletion-requests/stats");Ce=Number(gt?.pending||0)}catch(gt){console.error("Error loading delete stats",gt)}try{const{data:gt}=await We.get("/api/notifications/admin/dependent-requests/unread-count");st=Number(gt?.count||0)}catch(gt){console.error("Error loading dependent stats",gt)}try{const{data:gt}=await We.get("/api/notifications/admin/group-requests/unread-count");nt=Number(gt?.count||0)}catch(gt){console.error("Error loading group-request stats",gt)}y({invites:de,deletes:Ce,dependents:st,groups:nt})}finally{b(!1)}},se=async()=>{A(!0);try{const{data:de}=await We.get("/api/invitations",{params:{status:"pending",per_page:100,page:1,sort:"created_at",order:"desc"}}),Ce=Array.isArray(de)?de:de?.items||[];N(Ce)}catch(de){console.error("Error loading pending invites",de)}finally{A(!1)}},R=async()=>{T(!0);try{const{data:de}=await We.get("/api/deletion-requests"),Ce=Array.isArray(de)?de:[];C(Ce)}catch(de){console.error("Error loading delete requests",de)}finally{T(!1)}},W=async()=>{q(!0);try{const{data:de}=await We.get("/api/notifications/admin/dependent-requests"),Ce=Array.isArray(de)?de:[];P(Ce)}catch(de){console.error("Error loading dependent requests",de)}finally{q(!1)}},Y=async()=>{he(!0);try{const{data:de}=await We.get("/api/notifications/admin/group-requests"),Ce=Array.isArray(de)?de:[];fe(Ce)}catch(de){console.error("Error loading group requests",de)}finally{he(!1)}};g.useEffect(()=>{I();const de=setInterval(I,6e4);return()=>clearInterval(de)},[]),g.useEffect(()=>{function de(Ce){K.current&&(K.current.contains(Ce.target)||f(!1))}return m&&document.addEventListener("mousedown",de),()=>document.removeEventListener("mousedown",de)},[m]);const Q=async()=>{f(de=>!de),m||await Promise.all([se(),R(),W(),Y(),I()])},L=async de=>{if(window.confirm("Cancel this invitation?"))try{await We.delete(`/api/invitations/${de}`),await Promise.all([se(),I()])}catch(Ce){alert(Ce?.response?.data?.error||Ce?.message||"Cancel failed.")}},ne=async de=>{try{await We.post(`/api/invitations/${de}/approve-dependent`),await Promise.all([se(),I()])}catch(Ce){alert(Ce?.response?.data?.error||Ce?.message||"Approve failed.")}},ge=async de=>{try{await We.post(`/api/deletion-requests/${de}/approve`)}catch(Ce){alert(Ce?.response?.data?.error||Ce?.message||"Approve failed.")}finally{await Promise.all([R(),I()])}},G=async de=>{try{await We.post(`/api/deletion-requests/${de}/reject`)}catch(Ce){alert(Ce?.response?.data?.error||Ce?.message||"Reject failed.")}finally{await Promise.all([R(),I()])}},ue=(de="")=>{const st=de.replace(/<[^>]+>/g," ").match(/for\s+(.+?)\s*\(([^()]+@[^()]+)\)/i);return st?{name:st[1].trim(),email:st[2].trim().toLowerCase()}:{name:"",email:""}},Se=(de="")=>de.toLowerCase().includes("existing account detected"),M=async de=>{if(window.confirm("Mark this dependent account request as approved?"))try{await We.post("/api/notifications/admin/dependent-requests/mark-read",{ids:[de.id]}),await Promise.all([W(),I()]),f(!1)}catch(Ce){alert(Ce?.response?.data?.error||Ce?.message||"Failed to approve dependent request.")}},Qe=async de=>{const{name:Ce,email:st}=ue(de.message||"");if(!st){alert("Could not detect an email address in this request.");return}if(window.confirm(`Send invitation to ${Ce||st}? (${st})`))try{const nt=await We.post("/api/invitations",{name:Ce||st,email:st,user_type:"Investor"});await We.post("/api/notifications/admin/dependent-requests/mark-read",{ids:[de.id]}),await Promise.all([se(),W(),I()]);const gt=nt?.data?.msg;alert(gt==="resent"?"Invitation resent to this email.":"Invitation sent."),f(!1)}catch(nt){alert(nt?.response?.data?.error||nt?.message||"Failed to send invitation.")}},xe=async de=>{try{await We.post("/api/notifications/admin/dependent-requests/mark-read",{ids:[de.id]}),await Promise.all([W(),I()]),f(!1)}catch(Ce){alert(Ce?.response?.data?.error||Ce?.message||"Failed to dismiss notification.")}},me=(de="")=>{const st=de.replace(/\r/g,"").split(`
`).map(lr=>lr.trim());let nt="";const gt=[];return st.forEach(lr=>{if(!lr)return;const Zt=lr.match(/^Group account request from (.+)\.?$/i);if(Zt){nt=Zt[1].trim();return}const Ue=lr.match(/^[-]\s*(.+?)\s*<([^>]+)>/);Ue&&gt.push({name:Ue[1].trim(),email:Ue[2].trim().toLowerCase()})}),{requester:nt,members:gt}},ze=async de=>{try{await We.post("/api/notifications/admin/group-requests/mark-read",{ids:[de.id]}),await Promise.all([Y(),I()]),f(!1)}catch(Ce){alert(Ce?.response?.data?.error||Ce?.message||"Failed to dismiss group request.")}},oe=async(de,Ce)=>{if(window.confirm(`Mark ${Ce.name||Ce.email} as approved for this group request?`))try{await We.post("/api/admin/group-requests/approve",{notification_id:de.id,member_email:Ce.email}),await Promise.all([Y(),I()]),f(!1)}catch(st){alert(st?.response?.data?.message||st?.response?.data?.error||st?.message||"Failed to approve group request.")}},ke=async(de,Ce)=>{if(!Ce.email){alert("Could not detect an email address for this member.");return}if(window.confirm(`Send invitation to ${Ce.name||Ce.email}? (${Ce.email})`))try{const st=await We.post("/api/invitations",{name:Ce.name||Ce.email,email:Ce.email,user_type:"Investor"});await We.post("/api/notifications/admin/group-requests/mark-read",{ids:[de.id]}),await Promise.all([se(),Y(),I()]);const nt=st?.data?.msg;alert(nt==="resent"?"Invitation resent to this email.":"Invitation sent."),f(!1)}catch(st){alert(st?.response?.data?.error||st?.message||"Failed to send invitation.")}},[Ge,Fe]=g.useState(!1),[Be,xt]=g.useState(0),[Ze,ht]=g.useState([]),[At,De]=g.useState(!1),Xe=async()=>{try{const{data:de}=await We.get("/api/admin/messages/unread-count");xt(de.count||0)}catch{}},at=async()=>{De(!0);try{const{data:de}=await We.get("/api/admin/messages");ht(Array.isArray(de)?de:[]),await Xe()}finally{De(!1)}},rt=async de=>{alert(`Subject: ${de.subject||"No subject"}

${de.body||"No message body"}`);try{await We.post(`/api/admin/messages/${de.id}/mark-read`),await at()}catch{}};return g.useEffect(()=>{Xe();const de=setInterval(Xe,6e4);return()=>clearInterval(de)},[]),g.useEffect(()=>{function de(Ce){H.current&&(H.current.contains(Ce.target)||Fe(!1))}return Ge&&document.addEventListener("mousedown",de),()=>document.removeEventListener("mousedown",de)},[Ge]),l.jsxs("div",{className:"flex min-h-screen bg-gray-50",children:[l.jsxs("aside",{className:"w-64 bg-gray-100 border-r border-gray-200 flex flex-col justify-between shadow-sm",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"px-6 py-5 border-b border-gray-200",children:[l.jsx("h2",{className:"text-xl font-bold text-center tracking-tight cursor-pointer hover:text-blue-600",onClick:()=>t("overview"),children:"Admin Panel"}),l.jsx("p",{className:"text-lg text-black-600 text-center",children:"Financial Reporting Agent"})]}),l.jsxs("nav",{className:"p-4 space-y-6 ml-[10px]",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-base font-bold text-gray-500 uppercase mb-2",children:"Dashboard"}),l.jsx(u,{label:"Overview",tabKey:"overview",icon:l.jsx(OA,{size:16})}),l.jsx(u,{label:"Investors",tabKey:"investors",icon:l.jsx(kd,{size:16})}),l.jsx(u,{label:"Group Investor Admin",tabKey:"groupInvestorAdmin",icon:l.jsx(kd,{size:16})}),l.jsx(u,{label:"Documents",tabKey:"documents",icon:l.jsx($h,{size:16})}),l.jsx(u,{label:"Settings",tabKey:"settings",icon:l.jsx(OA,{size:16})})]}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-base font-bold text-gray-500 uppercase mb-2",children:"Users"}),l.jsx(u,{label:"Add User",tabKey:"addUser",icon:l.jsx(sO,{size:16})}),l.jsx(u,{label:"All Admins",tabKey:"AllAdmins",icon:l.jsx(kd,{size:16})})]}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-base font-bold text-gray-500 uppercase mb-2",children:"Integration"}),l.jsx(u,{label:"Excel Sheet",tabKey:"excel",icon:l.jsx(jB,{size:16})}),l.jsx(u,{label:"QuickBooks",tabKey:"quickbooks",icon:l.jsx($h,{size:16})})]})]})]}),l.jsxs("div",{className:"p-4 border-t border-gray-200",children:[l.jsxs("button",{onClick:n,className:"flex items-center gap-2 text-red-500 hover:text-red-700 transition w-full text-sm font-medium",children:[l.jsx(Zm,{size:16}),"Logout"]}),l.jsx("p",{className:"text-xs mt-2 text-gray-400",children:"Logged in as Admin"})]})]}),l.jsxs("div",{className:"flex-1 flex flex-col",children:[l.jsxs("header",{className:"flex justify-end items-center gap-4 p-4 bg-white border-b relative",children:[l.jsxs("div",{className:"relative",ref:K,children:[l.jsxs("button",{type:"button",onClick:Q,className:"relative inline-flex items-center justify-center rounded-full h-10 w-10 border border-gray-200 bg-white hover:bg-gray-50",title:"Notifications",children:[l.jsx(dB,{size:18}),l.jsx("span",{className:"sr-only",children:"Notifications"}),w?l.jsx("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center h-5 w-5 rounded-full bg-gray-300 text-[10px] text-white",children:l.jsx(aO,{className:"animate-spin",size:12})}):be>0?l.jsx("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center h-5 min-w-[20px] rounded-full bg-rose-600 text-[10px] text-white px-1",children:be}):null]}),m&&l.jsxs("div",{className:"absolute right-0 mt-2 w-[460px] bg-white border rounded-xl shadow-xl z-50",children:[l.jsxs("div",{className:"flex items-center justify-between border-b px-4 py-3",children:[l.jsx("div",{className:"font-semibold text-gray-800",children:"Notifications"}),l.jsx("div",{className:"text-xs text-gray-500",children:w?"Refreshing":"Up to date"})]}),l.jsx("div",{className:"px-4 pt-3",children:l.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.jsxs("button",{className:`px-3 py-1.5 rounded-md text-sm border ${h==="invites"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200 hover:bg-gray-50"}`,onClick:()=>x("invites"),children:["Invites"," ",v.invites?`(${v.invites})`:""]}),l.jsxs("button",{className:`px-3 py-1.5 rounded-md text-sm border ${h==="deletes"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200 hover:bg-gray-50"}`,onClick:()=>x("deletes"),children:["Delete Requests"," ",v.deletes?`(${v.deletes})`:""]}),l.jsxs("button",{className:`px-3 py-1.5 rounded-md text-sm border ${h==="dependents"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200 hover:bg-gray-50"}`,onClick:()=>x("dependents"),children:["Dependent Requests"," ",v.dependents?`(${v.dependents})`:""]}),l.jsxs("button",{className:`px-3 py-1.5 rounded-md text-sm border ${h==="groups"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200 hover:bg-gray-50"}`,onClick:()=>x("groups"),children:["Group Requests"," ",v.groups?`(${v.groups})`:""]})]})}),l.jsx("div",{className:"max-h-[60vh] overflow-y-auto px-4 py-3",children:h==="invites"?l.jsx(l.Fragment,{children:_?l.jsx("div",{className:"text-sm text-gray-500 p-3",children:"Loading pending invitations"}):S.length===0?l.jsx("div",{className:"text-sm text-gray-500 p-3",children:"No pending invitations."}):l.jsx("ul",{className:"space-y-2",children:S.map(de=>{const Ce=de.is_dependent_request||!!de.invited_parent_investor_id;return l.jsxs("li",{className:"border rounded-lg p-3 flex items-center justify-between",children:[l.jsxs("div",{className:"text-sm",children:[l.jsx("div",{className:"font-medium text-gray-800",children:de.name||de.email||""}),l.jsxs("div",{className:"text-gray-500",children:[de.email,"  invited"," ",te(de.created_at)]}),Ce&&l.jsx("div",{className:"text-xs text-blue-600 mt-1",children:"Dependent investor request"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[Ce&&l.jsxs("button",{onClick:()=>ne(de.id),className:"inline-flex items-center gap-1 rounded-md border border-emerald-200 bg-emerald-50 text-emerald-800 px-2 py-1 text-xs hover:bg-emerald-100",title:"Approve dependent investor",children:[l.jsx(J0,{size:14}),"Accept"]}),l.jsxs("button",{onClick:()=>L(de.id),className:"inline-flex items-center gap-1 rounded-md border px-2 py-1 text-xs hover:bg-gray-50",title:"Cancel invitation",children:[l.jsx(ys,{size:14}),"Cancel"]})]})]},de.id)})})}):h==="deletes"?l.jsx(l.Fragment,{children:O?l.jsx("div",{className:"text-sm text-gray-500 p-3",children:"Loading delete requests"}):k.length===0?l.jsx("div",{className:"text-sm text-gray-500 p-3",children:"No delete requests."}):l.jsx("ul",{className:"space-y-2",children:k.map(de=>l.jsx("li",{className:"border rounded-lg p-3",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"text-sm",children:[l.jsxs("div",{className:"font-medium text-gray-800",children:["Investor #",de.investor_id]}),l.jsxs("div",{className:"text-gray-500",children:["Requested by #",de.requested_by_investor_id||""," "," ",te(de.created_at)]}),de.reason&&l.jsxs("div",{className:"text-gray-600 mt-1",children:[l.jsx("span",{className:"text-gray-500",children:"Reason:"})," ",de.reason]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("button",{onClick:()=>ge(de.id),className:"inline-flex items-center gap-1 rounded-md border border-emerald-200 bg-emerald-50 text-emerald-800 px-2 py-1 text-xs hover:bg-emerald-100",title:"Approve deletion",children:[l.jsx(J0,{size:14}),"Approve"]}),l.jsxs("button",{onClick:()=>G(de.id),className:"inline-flex items-center gap-1 rounded-md border border-rose-200 bg-rose-50 text-rose-700 px-2 py-1 text-xs hover:bg-rose-100",title:"Reject deletion",children:[l.jsx(ys,{size:14}),"Reject"]})]})]})},de.id))})}):h==="dependents"?l.jsx(l.Fragment,{children:Z?l.jsx("div",{className:"text-sm text-gray-500 p-3",children:"Loading dependent account requests"}):z.length===0?l.jsx("div",{className:"text-sm text-gray-500 p-3",children:"No dependent account requests."}):l.jsx("ul",{className:"space-y-2",children:z.map(de=>{const Ce=Se(de.message||""),{name:st,email:nt}=ue(de.message||"");return l.jsxs("li",{className:"border rounded-lg p-3 space-y-2",children:[l.jsxs("div",{className:"flex items-start justify-between gap-3",children:[l.jsxs("div",{className:"text-sm",children:[l.jsx("div",{className:"font-medium text-gray-800",children:de.title||"Dependent account request submitted"}),de.message&&l.jsx("div",{className:"text-gray-700 mt-1 whitespace-pre-line",dangerouslySetInnerHTML:{__html:de.message}}),l.jsx("div",{className:"text-xs text-gray-500 mt-1",children:te(de.created_at)}),nt&&l.jsxs("div",{className:"text-xs text-gray-500 mt-0.5",children:[st||"Dependent","  ",nt]})]}),l.jsx("button",{onClick:()=>xe(de),className:"inline-flex items-center gap-1 rounded-md border px-2 py-1 text-xs text-gray-500 hover:bg-gray-50",title:"Dismiss request",children:l.jsx(ys,{size:14})})]}),l.jsx("div",{className:"flex items-center gap-2",children:Ce?l.jsxs("button",{onClick:()=>M(de),className:"inline-flex items-center gap-1 rounded-md border px-2 py-1 text-xs hover:bg-gray-50",children:[l.jsx(J0,{size:14}),"Approve request"]}):l.jsxs("button",{onClick:()=>Qe(de),className:"inline-flex items-center gap-1 rounded-md border px-2 py-1 text-xs hover:bg-gray-50",children:[l.jsx(ug,{size:14}),"Send invitation"]})})]},de.id)})})}):l.jsx(l.Fragment,{children:Ne?l.jsx("div",{className:"text-sm text-gray-500 p-3",children:"Loading group account requests"}):B.length===0?l.jsx("div",{className:"text-sm text-gray-500 p-3",children:"No group account requests."}):l.jsx("ul",{className:"space-y-2",children:B.map(de=>{const{requester:Ce,members:st}=me(de.message||"");return l.jsxs("li",{className:"border rounded-lg p-3 space-y-2",children:[l.jsxs("div",{className:"flex items-start justify-between gap-3",children:[l.jsxs("div",{className:"text-sm",children:[l.jsx("div",{className:"font-medium text-gray-800",children:de.title||"Group account request submitted"}),Ce&&l.jsxs("div",{className:"text-gray-700 mt-1",children:["Request from:"," ",l.jsx("span",{className:"font-medium",children:Ce})]}),l.jsx("div",{className:"text-xs text-gray-500 mt-1",children:te(de.created_at)})]}),l.jsx("button",{onClick:()=>ze(de),className:"inline-flex items-center gap-1 rounded-md border px-2 py-1 text-xs text-gray-500 hover:bg-gray-50",title:"Dismiss request",children:l.jsx(ys,{size:14})})]}),st.length>0&&l.jsx("div",{className:"mt-2 space-y-2",children:st.map(nt=>l.jsxs("div",{className:"flex items-center justify-between gap-2 rounded-md bg-gray-50 px-2 py-1",children:[l.jsxs("div",{className:"text-xs text-gray-700",children:[l.jsx("div",{className:"font-medium",children:nt.name||"Group member"}),l.jsx("div",{className:"text-gray-500",children:nt.email})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("button",{onClick:()=>oe(de,nt),className:"inline-flex items-center gap-1 rounded-md border px-2 py-1 text-[11px] hover:bg-gray-50",children:[l.jsx(J0,{size:13}),"Approve"]}),l.jsxs("button",{onClick:()=>ke(de,nt),className:"inline-flex items-center gap-1 rounded-md border px-2 py-1 text-[11px] hover:bg-gray-50",children:[l.jsx(ug,{size:13}),"Send invite"]})]})]},nt.email))})]},de.id)})})})}),l.jsx("div",{className:"border-t px-4 py-2 text-right",children:l.jsx("button",{onClick:async()=>{await Promise.all([se(),R(),W(),Y(),I()])},className:"text-xs rounded-md border px-3 py-1 hover:bg-gray-50",children:"Refresh"})})]})]}),l.jsxs("div",{className:"relative",ref:H,children:[l.jsxs("button",{onClick:()=>{Fe(de=>{const Ce=!de;return de||at(),Ce})},className:"relative inline-flex items-center justify-center rounded-full h-10 w-10 border border-gray-200 bg-white hover:bg-gray-50",title:"Mailbox",children:[l.jsx(ug,{size:18}),Be>0&&l.jsx("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center h-5 min-w-[20px] rounded-full bg-blue-600 text-[10px] text-white px-1",children:Be})]}),Ge&&l.jsxs("div",{className:"absolute right-0 mt-2 w-[420px] bg-white border rounded-xl shadow-xl z-50",children:[l.jsxs("div",{className:"flex items-center justify-between border-b px-4 py-3",children:[l.jsx("div",{className:"font-semibold text-gray-800",children:"Mailbox"}),l.jsx("button",{className:"text-xs rounded-md border px-2 py-0.5 hover:bg-gray-50",onClick:at,children:"Refresh"})]}),l.jsx("div",{className:"max-h-[60vh] overflow-y-auto px-4 py-3",children:At?l.jsx("div",{className:"text-sm text-gray-500 p-3",children:"Loading"}):Ze.length===0?l.jsx("div",{className:"text-sm text-gray-500 p-3",children:"No messages."}):l.jsx("ul",{className:"space-y-2",children:Ze.map(de=>l.jsxs("li",{className:"border rounded-lg p-3 cursor-pointer hover:bg-gray-50",onClick:()=>rt(de),children:[l.jsx("div",{className:"font-medium text-gray-800",children:de.subject||"No subject"}),l.jsxs("div",{className:"text-gray-500 text-xs",children:["From: ",de.investor_name||"Unknown"," "," ",new Date(de.created_at).toLocaleString()]}),!de.read_at&&l.jsx("span",{className:"text-blue-600 text-xs font-semibold",children:"Unread"})]},de.id))})})]})]}),l.jsxs("div",{className:"relative group cursor-pointer",children:[l.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-600 text-white flex items-center justify-center text-lg font-bold",children:a.fullName?.charAt(0).toUpperCase()||"A"}),l.jsxs("div",{className:"absolute right-0 mt-2 hidden group-hover:block bg-white shadow-lg border rounded-md w-64 p-4 z-50",children:[l.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-2",children:"Admin Info"}),l.jsxs("div",{className:"text-sm text-gray-600",children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Full Name:"})," ",a.fullName]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Email:"})," ",a.email]}),l.jsxs("div",{children:[l.jsx("strong",{children:"User Type:"})," ",a.userType]})]})]})]})]}),l.jsx("main",{className:"p-6 overflow-y-auto bg-white shadow-inner flex-1",children:o()})]})]})},p0e=[{investor:"TOTAL",ownership:"100%",commitment:"271,000,003",capitalPaid:"70,500,000",distributions:"(62,736,000)",realizedGains:"19,331,000",unrealizedGains:"21,202,000",isSection:!0},{investor:"TOTAL FOR INVESTORS",ownership:"100%",commitment:"271,000,003",capitalPaid:"70,500,000",distributions:"(62,736,000)",realizedGains:"19,331,000",unrealizedGains:"21,202,000",isSection:!0},{investor:"General Partner",ownership:"0.4%",commitment:"1,000,000",capitalPaid:"705,000",distributions:"(627,000)",realizedGains:"193,000",unrealizedGains:"222,000",group:"Carried interest partner"},{investor:"Investor X",ownership:"9.2%",commitment:"25,000,000",capitalPaid:"17,625,000",distributions:"(15,684,000)",realizedGains:"4,833,000",unrealizedGains:"5,554,000",group:"Carried interest partner"},{investor:"Investor X",ownership:"7.4%",commitment:"20,000,000",capitalPaid:"14,100,000",distributions:"(12,547,000)",realizedGains:"3,866,000",unrealizedGains:"4,443,000",group:"Carried interest partner"},{investor:"Investor X",ownership:"3.0%",commitment:"8,000,000",capitalPaid:"5,640,000",distributions:"(5,019,000)",realizedGains:"1,546,000",unrealizedGains:"1,777,000",group:"Carried interest partner"}],x0e=()=>{const[e,t]=g.useState(""),r=p0e.filter(n=>n.investor.toLowerCase().includes(e.toLowerCase()));return l.jsxs("div",{className:"p-6 bg-white rounded shadow space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h3",{className:"text-sm text-gray-500",children:"Total Invested Amount"}),l.jsx("p",{className:"text-2xl font-bold text-pink-600 mt-2",children:"$79,155M"})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h3",{className:"text-sm text-gray-500",children:"Number of Investors"}),l.jsx("p",{className:"text-2xl font-bold text-purple-600 mt-2",children:"2216"})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h3",{className:"text-sm text-gray-500",children:"Rate of Return"}),l.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-2",children:"-4.16%"})]})]}),l.jsx("input",{type:"text",placeholder:"Search investor",value:e,onChange:n=>t(n.target.value),className:"mb-4 p-2 border rounded w-full"}),l.jsxs("table",{className:"w-full table-auto border text-sm",children:[l.jsx("thead",{className:"bg-gray-100",children:l.jsxs("tr",{children:[l.jsx("th",{className:"border p-2 text-left",children:"Investor"}),l.jsx("th",{className:"border p-2 text-right",children:"Ownership"}),l.jsx("th",{className:"border p-2 text-right",children:"Commitment"}),l.jsx("th",{className:"border p-2 text-right",children:"Paid in Capital"}),l.jsx("th",{className:"border p-2 text-right",children:"Distributions"}),l.jsx("th",{className:"border p-2 text-right",children:"Realised Gains"}),l.jsx("th",{className:"border p-2 text-right",children:"Unrealised Gains"})]})}),l.jsx("tbody",{children:r.map((n,a)=>l.jsxs("tr",{className:n.isSection?"font-bold bg-gray-50":"hover:bg-gray-50",children:[l.jsx("td",{className:"border p-2",children:n.investor}),l.jsx("td",{className:"border p-2 text-right",children:n.ownership}),l.jsx("td",{className:"border p-2 text-right",children:n.commitment}),l.jsx("td",{className:"border p-2 text-right",children:n.capitalPaid}),l.jsx("td",{className:"border p-2 text-right text-red-500",children:n.distributions}),l.jsx("td",{className:"border p-2 text-right",children:n.realizedGains}),l.jsx("td",{className:"border p-2 text-right",children:n.unrealizedGains})]},a))})]})]})},v0e=[{quarter:"Q2 2019",investment:4,gain:0,moic:1},{quarter:"Q3 2019",investment:8,gain:0,moic:1},{quarter:"Q4 2019",investment:15,gain:0,moic:1},{quarter:"Q1 2020",investment:17,gain:4,moic:1.1},{quarter:"Q2 2020",investment:21,gain:4,moic:1.1},{quarter:"Q3 2020",investment:25,gain:5,moic:1.2},{quarter:"Q4 2020",investment:42,gain:6,moic:1.3},{quarter:"Q1 2021",investment:48,gain:10,moic:1.5},{quarter:"Q2 2021",investment:82,gain:20,moic:1.8},{quarter:"Q3 2021",investment:88,gain:28,moic:2},{quarter:"Q4 2021",investment:88,gain:30,moic:2.1},{quarter:"Q1 2022",investment:96,gain:34,moic:2.2},{quarter:"Q2 2022",investment:109,gain:39,moic:2.3},{quarter:"Q3 2022",investment:120,gain:44,moic:2.4},{quarter:"Q4 2022",investment:148,gain:50,moic:2.5},{quarter:"Q1 2023",investment:154,gain:55,moic:2.5},{quarter:"Q2 2023",investment:164,gain:60,moic:2.6},{quarter:"Q3 2023",investment:162,gain:58,moic:2.4}],g0e=[{title:"Net Fund performance",data:[{label:"Contribution",value:"$82.0M"},{label:"NAV & Distribution",value:"$162.8M"},{label:"Gain",value:"$80.8M"},{label:"Fund size",value:"$140.0M"},{label:"TVPI",value:"1.99x"},{label:"IRR",value:"29.80%"}]},{title:"Total Portfolio performance",data:[{label:"Investment",value:"$78.3M"},{label:"Fair value",value:"$161.7M"},{label:"Gain",value:"$83.4M"},{label:"Companies",value:"2"},{label:"MOIC",value:"x2.06"},{label:"IRR",value:"33.23%"}]}],y0e=()=>l.jsxs("div",{className:"space-y-8",children:[l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:g0e.map((e,t)=>l.jsxs("div",{className:"bg-white shadow p-6 rounded-lg",children:[l.jsx("h3",{className:"text-md font-semibold mb-4 text-gray-700",children:e.title}),l.jsx("div",{className:"grid grid-cols-2 gap-4",children:e.data.map((r,n)=>l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-500",children:r.label}),l.jsx("p",{className:"font-bold text-gray-900",children:r.value})]},n))})]},t))}),l.jsxs("div",{className:"bg-white shadow p-6 rounded-lg",children:[l.jsx("h3",{className:"text-md font-semibold mb-4 text-gray-700",children:"Total Portfolio Performance"}),l.jsx(la,{width:"100%",height:300,children:l.jsxs(Zc,{data:v0e,margin:{top:20,right:30,left:0,bottom:5},children:[l.jsx(_l,{strokeDasharray:"3 3"}),l.jsx(ki,{dataKey:"quarter"}),l.jsx(si,{yAxisId:"left"}),l.jsx(si,{yAxisId:"right",orientation:"right",domain:[1,3]}),l.jsx(sa,{}),l.jsx(iu,{}),l.jsx(Ji,{yAxisId:"left",dataKey:"investment",stackId:"a",fill:"#606060",name:"Investment"}),l.jsx(Ji,{yAxisId:"left",dataKey:"gain",stackId:"a",fill:"#49C5B6",name:"Net Gain/(Loss)"}),l.jsx(Xc,{yAxisId:"right",type:"monotone",dataKey:"moic",stroke:"#FFA500",name:"MOIC",strokeWidth:2})]})})]})]}),b0e=[{date:"13 Oct",actual:3},{date:"14 Oct",actual:3},{date:"15 Oct",actual:5},{date:"16 Oct",actual:4},{date:"17 Oct",actual:0},{date:"18 Oct",forecast:3},{date:"19 Oct",forecast:3},{date:"20 Oct",forecast:5},{date:"21 Oct",forecast:3.8},{date:"22 Oct",forecast:6}],w0e=[{name:"Account Receivables",value:9.8},{name:"Royalties",value:5.1},{name:"Commissions",value:.9},{name:"Interest Receipts",value:.2},{name:"Tax Refunds",value:.1}],S0e=[{name:"Account Payables",value:-8.3},{name:"Payroll",value:-6.1},{name:"Tax Payments",value:-2.5},{name:"Capex",value:-1.8},{name:"Rent/Admin Charges",value:-.9}],j0e=[{name:"Inflow",value:60,fill:"#06b6d4"},{name:"Outflow",value:40,fill:"#f43f5e"}],N0e=[{label:"Maximum Variance",value:"$5,767,899.32",percentage:"21%",date:"10th Sep 2022",color:"rose"},{label:"Minimum Variance",value:"$1,197,359.80",percentage:"15.45%",date:"18th Sep 2022",color:"green"},{label:"Average Variance",value:"$1,678,899.32",percentage:"21%",date:"10th Sep 2022",color:"amber"}],E0e=()=>l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[l.jsxs("div",{className:"col-span-2 bg-white p-6 rounded shadow",children:[l.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Net Cashflow - Past 30 Days"}),l.jsx(la,{width:"100%",height:250,children:l.jsxs(C8,{data:b0e,children:[l.jsx(_l,{strokeDasharray:"3 3"}),l.jsx(ki,{dataKey:"date"}),l.jsx(si,{domain:[-2,10],tickFormatter:e=>`${e}M`}),l.jsx(sa,{formatter:e=>`$${e}M`}),l.jsx(Xc,{type:"monotone",dataKey:"actual",stroke:"#f97316",name:"Actual"}),l.jsx(Xc,{type:"monotone",dataKey:"forecast",stroke:"#16a34a",name:"Forecast"})]})})]}),l.jsxs("div",{className:"bg-white p-6 rounded shadow",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Net Cashflow"}),l.jsx(la,{width:"100%",height:250,children:l.jsxs(rfe,{cx:"50%",cy:"50%",innerRadius:"40%",outerRadius:"80%",barSize:20,data:j0e,children:[l.jsx(cS,{background:!0,clockWise:!0,dataKey:"value"}),l.jsx(iu,{iconSize:10,layout:"vertical",verticalAlign:"middle",align:"right"}),l.jsx(sa,{formatter:e=>`${e}%`})]})})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[l.jsxs("div",{className:"bg-white p-6 rounded shadow",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Inflows"}),l.jsx(la,{width:"100%",height:200,children:l.jsxs(Zc,{layout:"vertical",data:w0e,children:[l.jsx(ki,{type:"number",domain:[0,10],tickFormatter:e=>`${e}M`}),l.jsx(si,{type:"category",dataKey:"name",width:130}),l.jsx(sa,{formatter:e=>`$${e}M`}),l.jsx(Ji,{dataKey:"value",fill:"#22c55e"})]})})]}),l.jsxs("div",{className:"bg-white p-6 rounded shadow",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Outflows"}),l.jsx(la,{width:"100%",height:200,children:l.jsxs(Zc,{layout:"vertical",data:S0e,children:[l.jsx(ki,{type:"number",domain:[-10,0],tickFormatter:e=>`${-e}M`}),l.jsx(si,{type:"category",dataKey:"name",width:130}),l.jsx(sa,{formatter:e=>`$${-e}M`}),l.jsx(Ji,{dataKey:"value",fill:"#ef4444"})]})})]})]}),l.jsx("div",{className:"grid grid-cols-3 gap-6",children:N0e.map((e,t)=>l.jsxs("div",{className:`border-l-4 border-${e.color}-500 bg-white p-4 rounded shadow`,children:[l.jsx("p",{className:`text-${e.color}-600 font-semibold`,children:e.label}),l.jsxs("h2",{className:"text-xl font-bold mt-1",children:[e.value," ",l.jsxs("span",{className:"text-sm text-gray-500",children:["(",e.percentage,")"]})]}),l.jsxs("p",{className:"text-sm text-gray-500",children:["Measured on ",e.date]})]},t))})]}),iC=[{category:"other income",amount:5261},{category:"primary paycheck",amount:3742}],sC=[{account:"Chase Sapphire",balance:-216},{account:"Chase Ink",balance:-15},{account:"Chase Freedom Unlimited",balance:-1},{account:"Amex Gold",balance:-56}],A0e=[{category:"subscriptions",amount:-402,budget:-626},{category:"groceries",amount:-1057,budget:-1200},{category:"gym",amount:-318,budget:-200},{category:"education",amount:-17,budget:-50},{category:"restaurants & other",amount:-242,budget:-600},{category:"other expenses",amount:-2770,budget:-8e3},{category:"other shopping",amount:-343,budget:0},{category:"bills & utilities",amount:-3692,budget:-60},{category:"other health & wellness",amount:-108,budget:-250},{category:"travel & vacation",amount:-471,budget:-200},{category:"other transportation",amount:-163,budget:-50}],_0e=[{month:"Jan Y24",amount:1e3},{month:"Feb Y24",amount:3e3},{month:"Mar Y24",amount:2e3},{month:"Apr Y24",amount:5e3},{month:"May Y24",amount:4e3},{month:"Jun Y24",amount:3e3}],T0e=[{label:"Maximum Variance",value:"$5,767,899.32",percentage:"21%",date:"10th Sep 2022",color:"rose"},{label:"Minimum Variance",value:"$1,197,359.80",percentage:"15.45%",date:"18th Sep 2022",color:"green"},{label:"Average Variance",value:"$1,678,899.32",percentage:"21%",date:"10th Sep 2022",color:"amber"}],k0e=()=>l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[l.jsxs("div",{className:"bg-white p-6 rounded shadow",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Income by Category"}),l.jsxs("table",{className:"w-full table-auto border",children:[l.jsx("thead",{className:"bg-gray-100",children:l.jsxs("tr",{children:[l.jsx("th",{className:"border p-2 text-left",children:"Category"}),l.jsx("th",{className:"border p-2 text-left",children:"Amount"})]})}),l.jsxs("tbody",{children:[iC.map((e,t)=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"border p-2",children:e.category}),l.jsxs("td",{className:"border p-2 text-right",children:["$",e.amount]})]},t)),l.jsxs("tr",{className:"font-bold",children:[l.jsx("td",{className:"border p-2",children:"Total"}),l.jsxs("td",{className:"border p-2 text-right",children:["$",iC.reduce((e,t)=>e+t.amount,0)]})]})]})]})]}),l.jsxs("div",{className:"bg-white p-6 rounded shadow",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Current Debt Balances"}),l.jsxs("table",{className:"w-full table-auto border",children:[l.jsx("thead",{className:"bg-gray-100",children:l.jsxs("tr",{children:[l.jsx("th",{className:"border p-2 text-left",children:"Account"}),l.jsx("th",{className:"border p-2 text-left",children:"Balance"})]})}),l.jsxs("tbody",{children:[sC.map((e,t)=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"border p-2",children:e.account}),l.jsxs("td",{className:"border p-2 text-right",children:["$",e.balance]})]},t)),l.jsxs("tr",{className:"font-bold",children:[l.jsx("td",{className:"border p-2",children:"Total"}),l.jsxs("td",{className:"border p-2 text-right",children:["$",sC.reduce((e,t)=>e+t.balance,0)]})]})]})]})]})]}),l.jsxs("div",{className:"bg-white p-6 rounded shadow",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Expense by Category with Budget"}),l.jsxs("table",{className:"w-full table-auto border",children:[l.jsx("thead",{className:"bg-gray-100",children:l.jsxs("tr",{children:[l.jsx("th",{className:"border p-2 text-left",children:"Category"}),l.jsx("th",{className:"border p-2 text-left",children:"Amount"}),l.jsx("th",{className:"border p-2 text-left",children:"Budget"})]})}),l.jsx("tbody",{children:A0e.map((e,t)=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"border p-2",children:e.category}),l.jsxs("td",{className:`border p-2 text-right ${e.amount<0?"text-red-500":"text-green-500"}`,children:["$",e.amount]}),l.jsxs("td",{className:`border p-2 text-right ${e.budget<0?"text-red-500":"text-green-500"}`,children:["$",e.budget]})]},t))})]})]}),l.jsxs("div",{className:"bg-white p-6 rounded shadow",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Bills and Subscriptions"}),l.jsx(la,{width:"100%",height:250,children:l.jsxs(Zc,{data:_0e,children:[l.jsx(_l,{strokeDasharray:"3 3"}),l.jsx(ki,{dataKey:"month"}),l.jsx(si,{}),l.jsx(sa,{}),l.jsx(Ji,{dataKey:"amount",fill:"#f43f5e"})]})})]}),l.jsx("div",{className:"grid grid-cols-3 gap-6",children:T0e.map((e,t)=>l.jsxs("div",{className:`border-l-4 border-${e.color}-500 bg-white p-4 rounded shadow`,children:[l.jsx("p",{className:`text-${e.color}-600 font-semibold`,children:e.label}),l.jsxs("h2",{className:"text-xl font-bold mt-1",children:[e.value," ",l.jsxs("span",{className:"text-sm text-gray-500",children:["(",e.percentage,")"]})]}),l.jsxs("p",{className:"text-sm text-gray-500",children:["Measured on ",e.date]})]},t))})]}),C0e=()=>l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[l.jsxs("div",{className:"bg-white p-6 rounded shadow",children:[l.jsx("h3",{className:"text-sm text-gray-500",children:"Management Fees"}),l.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-2",children:"$2.1M"})]}),l.jsxs("div",{className:"bg-white p-6 rounded shadow",children:[l.jsx("h3",{className:"text-sm text-gray-500",children:"Organizational Expenses"}),l.jsx("p",{className:"text-2xl font-bold text-orange-500 mt-2",children:"$0.3M"})]}),l.jsxs("div",{className:"bg-white p-6 rounded shadow",children:[l.jsx("h3",{className:"text-sm text-gray-500",children:"Other Expenses"}),l.jsx("p",{className:"text-2xl font-bold text-red-500 mt-2",children:"$0.1M"})]})]}),l.jsxs("div",{className:"bg-white p-6 rounded shadow",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Expenses Breakdown"}),l.jsxs("table",{className:"w-full table-auto text-sm border",children:[l.jsx("thead",{className:"bg-gray-100",children:l.jsxs("tr",{children:[l.jsx("th",{className:"border p-2 text-left",children:"Category"}),l.jsx("th",{className:"border p-2 text-right",children:"Amount"}),l.jsx("th",{className:"border p-2 text-right",children:"Percentage"})]})}),l.jsxs("tbody",{children:[l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"border p-2",children:"Management Fees"}),l.jsx("td",{className:"border p-2 text-right",children:"$2,100,000"}),l.jsx("td",{className:"border p-2 text-right",children:"84%"})]}),l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"border p-2",children:"Organizational Expenses"}),l.jsx("td",{className:"border p-2 text-right",children:"$300,000"}),l.jsx("td",{className:"border p-2 text-right",children:"12%"})]}),l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"border p-2",children:"Other Expenses"}),l.jsx("td",{className:"border p-2 text-right",children:"$100,000"}),l.jsx("td",{className:"border p-2 text-right",children:"4%"})]})]})]})]})]}),O0e=()=>{const[e,t]=g.useState([]),[r,n]=g.useState("Overview"),a=es(),{logout:i}=g.useContext(Di);g.useEffect(()=>{o()},[]);const o=()=>{const w=localStorage.getItem("accessToken");w&&Rr.get("/api/group-admin/users",{headers:{Authorization:`Bearer ${w}`}}).then(b=>t(b.data)).catch(b=>console.error(b))},u=()=>{i(),a("/login")},m=[{year:"2010",investment:8e3},{year:"2011",investment:12e3},{year:"2012",investment:18e3},{year:"2013",investment:15e3},{year:"2014",investment:25e3},{year:"2015",investment:12e3}],f=[{group:"AAA",value:28e3},{group:"A",value:26e3},{group:"AA",value:12e3},{group:"BB",value:5e3},{group:"BBB",value:15e3}],h=[{name:"CMO",value:27},{name:"Corporates",value:60},{name:"Municipal",value:4},{name:"MBS",value:1},{name:"Cash",value:8}],x=[{book:100,market:28e3,group:"AAA"},{book:700,market:26e3,group:"A"},{book:400,market:12e3,group:"AA"},{book:200,market:5e3,group:"BB"},{book:300,market:15e3,group:"BBB"}],v=["#8884d8","#82ca9d","#ffc658","#ff8042","#00C49F"],y=()=>l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h3",{className:"text-sm text-gray-500",children:"Total Invested Amount"}),l.jsx("p",{className:"text-2xl font-bold text-pink-600 mt-2",children:"$79,155M"})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h3",{className:"text-sm text-gray-500",children:"Number of Investments"}),l.jsx("p",{className:"text-2xl font-bold text-purple-600 mt-2",children:"2216"})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h3",{className:"text-sm text-gray-500",children:"Rate of Return"}),l.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-2",children:"-4.16%"})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-6 mt-6",children:[l.jsxs("div",{className:"bg-white p-6 rounded shadow",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Yearly Total Investment"}),l.jsx(la,{width:"100%",height:200,children:l.jsxs(C8,{data:m,children:[l.jsx(Xc,{type:"monotone",dataKey:"investment",stroke:"#8884d8"}),l.jsx(_l,{stroke:"#ccc"}),l.jsx(ki,{dataKey:"year"}),l.jsx(si,{}),l.jsx(sa,{})]})})]}),l.jsxs("div",{className:"bg-white p-6 rounded shadow",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Total Investment by Rating Group"}),l.jsx(la,{width:"100%",height:200,children:l.jsxs(Zc,{data:f,children:[l.jsx(_l,{strokeDasharray:"3 3"}),l.jsx(ki,{dataKey:"group"}),l.jsx(si,{}),l.jsx(sa,{}),l.jsx(iu,{}),l.jsx(Ji,{dataKey:"value",fill:"#82ca9d"})]})})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-6 mt-6",children:[l.jsxs("div",{className:"bg-white p-6 rounded shadow",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Total Investment by Asset Class"}),l.jsx(la,{width:"100%",height:200,children:l.jsxs(Xp,{children:[l.jsx(pu,{data:h,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:80,label:!0,children:h.map((w,b)=>l.jsx(ns,{fill:v[b%v.length]},`cell-${b}`))}),l.jsx(sa,{})]})})]}),l.jsxs("div",{className:"bg-white p-6 rounded shadow",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Market vs Book Value by Rating"}),l.jsx(la,{width:"100%",height:200,children:l.jsxs(Jde,{children:[l.jsx(_l,{}),l.jsx(ki,{dataKey:"market",name:"Market Value",unit:"$"}),l.jsx(si,{dataKey:"book",name:"Book Value",unit:"$"}),l.jsx(Wp,{range:[60]}),l.jsx(sa,{cursor:{strokeDasharray:"3 3"}}),l.jsx(mS,{name:"Rating",data:x,fill:"#8884d8"})]})})]})]}),l.jsxs("div",{className:"bg-white p-6 mt-6 rounded shadow",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Top Investment Companies"}),l.jsxs("table",{className:"w-full table-auto border",children:[l.jsx("thead",{className:"bg-gray-100",children:l.jsxs("tr",{children:[l.jsx("th",{className:"border p-2 text-left",children:"Company"}),l.jsx("th",{className:"border p-2 text-left",children:"Industry"}),l.jsx("th",{className:"border p-2 text-left",children:"Investment"}),l.jsx("th",{className:"border p-2 text-left",children:"Return"})]})}),l.jsxs("tbody",{children:[l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"border p-2",children:"Alpha Capital"}),l.jsx("td",{className:"border p-2",children:"Finance"}),l.jsx("td",{className:"border p-2",children:"$10,000,000"}),l.jsx("td",{className:"border p-2 text-green-600",children:"+5%"})]}),l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"border p-2",children:"Zenith Ventures"}),l.jsx("td",{className:"border p-2",children:"Tech"}),l.jsx("td",{className:"border p-2",children:"$7,500,000"}),l.jsx("td",{className:"border p-2 text-red-500",children:"-2%"})]})]})]})]})]});return l.jsxs("div",{className:"flex min-h-screen bg-gray-100",children:[l.jsxs("aside",{className:"w-64 bg-white border-r flex flex-col justify-between shadow-sm",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"px-6 py-5 border-b",children:[l.jsx("h2",{className:"text-xl font-bold text-center",children:"Group Admin"}),l.jsx("p",{className:"text-sm text-gray-500 text-center",children:"Dashboard"})]}),l.jsx("nav",{className:"p-4 space-y-2",children:["Overview","Fund Performance Status","Cash Flow and Net IRR","Capital Account","GP Fees & carry and Expenses"].map(w=>l.jsx("button",{onClick:()=>n(w),className:`flex items-center gap-2 px-4 py-2 rounded-md text-sm w-full text-left font-medium ${r===w?"bg-blue-100 text-blue-800":"text-gray-700 hover:bg-gray-200"}`,children:w},w))})]}),l.jsx("div",{className:"p-4 border-t",children:l.jsxs("button",{onClick:u,className:"flex items-center gap-2 text-red-500 hover:text-red-700 text-sm",children:[l.jsx(Zm,{size:16})," Logout"]})})]}),l.jsxs("main",{className:"flex-1 p-6 space-y-6",children:[r==="Overview"&&y(),r==="Fund Performance Status"&&l.jsx(y0e,{}),r==="Cash Flow and Net IRR"&&l.jsx(E0e,{}),r==="Capital Account"&&l.jsx(x0e,{}),r==="GP Fees & carry and Expenses"&&l.jsx(k0e,{}),r==="Expenses"&&l.jsx(C0e,{})]})]})},D0e=[{id:"inv_5m",label:"I have at least $5M in investments"},{id:"assets_2_5m",label:"I have between $2.2M and $5M in assets"},{id:"assets_1_2_2m",label:"I have between $1M and $2.2M in assets"},{id:"income",label:"I have income of $200k (or $300k jointly with spouse) for the past 2 years and expect the same this year"},{id:"license",label:"I am a Series 7, Series 65, or Series 82 holder and my license is active and in good standing"},{id:"not_yet",label:"I'm not accredited yet"}],uy=e=>!!(e&&e!=="not_yet");function lC(){if(typeof window>"u")return null;try{const t=new URL(window.location.href).searchParams.get("investorId"),r=window.localStorage.getItem("currentInvestorId"),n=t||r;return n?Number(n):null}catch{return null}}function F8({onAccredited:e}){const t=Ua(),[r,n]=g.useState(!1),[a,i]=g.useState("not_yet"),[o,u]=g.useState(!0),[m,f]=g.useState(!1),[h,x]=g.useState("");g.useEffect(()=>{let w=!0;return(async()=>{u(!0),x("");try{const b=lC(),S=b?{investor_id:b}:void 0,{data:N}=await We.get("/api/investor/accreditation",{headers:{Accept:"application/json"},params:S});if(!w)return;N&&N.selection?(i(N.selection),uy(N.selection)?e?.(!0):e?.(!1)):e?.(!1)}catch(b){if(!w)return;const S=b?.response?.data?.error||(b?.response?`Load failed (${b.response.status})`:"Unable to load accreditation.");x(S),e?.(!1)}finally{w&&u(!1)}})(),()=>{w=!1}},[t.search,e]);async function v(){f(!0),x("");try{const w=uy(a),b=lC(),S=b?{investor_id:b}:void 0;await We.post("/api/investor/accreditation",{selection:a,accredited:w},{params:S}),n(!1),e?.(w)}catch(w){const b=w?.response?.data?.error||(w?.response?`Save failed (${w.response.status})`:"Unable to save accreditation.");x(b)}finally{f(!1)}}const y=uy(a);return l.jsx("div",{className:"max-w-4xl",children:l.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white shadow-sm",children:[l.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-200",children:[l.jsx("h2",{className:"text-xl font-semibold text-slate-800",children:"Accreditation Status"}),r?l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:v,disabled:m,className:"rounded-lg bg-blue-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-blue-700 disabled:opacity-60",children:m?"Saving...":"Save"}),l.jsx("button",{onClick:()=>{n(!1),x("")},className:"rounded-lg border border-slate-300 bg-white px-3 py-1.5 text-sm font-medium text-slate-700 hover:bg-slate-50",children:"Cancel"})]}):l.jsxs("button",{onClick:()=>n(!0),className:"inline-flex items-center gap-2 rounded-lg border border-slate-300 bg-white px-3 py-1.5 text-sm font-medium text-slate-700 hover:bg-slate-50 disabled:opacity-60",disabled:o,children:["Edit",l.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M12 20h9"}),l.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4 12.5-12.5z"})]})]})]}),!o&&h&&l.jsx("div",{className:"px-6 pt-4",children:l.jsx("div",{className:"rounded-lg bg-rose-50 text-rose-700 border border-rose-200 px-4 py-2 text-sm",children:h})}),l.jsx("div",{className:"px-6 pt-5",children:o?l.jsx("div",{className:"h-12 rounded-lg bg-slate-100 animate-pulse"}):y?l.jsxs("div",{className:"rounded-lg bg-green-600/95 text-white px-4 py-3 shadow-inner",children:[l.jsx("div",{className:"text-lg font-semibold",children:"Accredited"}),l.jsx("div",{className:"text-sm opacity-90",children:"You meet the criteria to be an accredited investor."})]}):l.jsxs("div",{className:"rounded-lg bg-red-700/95 text-white px-4 py-3 shadow-inner",children:[l.jsx("div",{className:"text-lg font-semibold",children:"Not Accredited"}),l.jsx("div",{className:"text-sm opacity-90",children:"You do not meet the criteria to be an accredited investor."})]})}),l.jsxs("div",{className:"px-6 py-5",children:[l.jsx("fieldset",{className:"space-y-3",children:D0e.map(w=>l.jsxs("label",{className:"flex cursor-pointer items-start gap-3",children:[l.jsx("input",{type:"radio",name:"accreditation",className:"mt-1 h-4 w-4",checked:a===w.id,onChange:()=>r&&i(w.id),disabled:!r||o}),l.jsx("span",{className:"text-slate-800",children:w.label})]},w.id))}),!r&&!o&&l.jsx("p",{className:"mt-4 text-xs text-slate-500",children:"Edit to update your accreditation. Your selection determines the banner above."})]})]})})}const dy="https://clarus.elpiscapital.com";function I8(){const[e,t]=g.useState(!1),[r,n]=g.useState(1),[a,i]=g.useState(""),[o,u]=g.useState(""),[m,f]=g.useState(""),[h,x]=g.useState(""),[v,y]=g.useState(!1),[w,b]=g.useState(""),[S,N]=g.useState(""),_=()=>{n(1),i(""),u(""),f(""),x(""),b(""),N("")},A=()=>{_(),t(!0)},k=()=>{t(!1)},C=async Fe=>{if(Fe.preventDefault(),b(""),N(""),!a.trim()){b("Email is required");return}try{y(!0);const Be=await fetch(`${dy}/api/auth/password/code/start`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a})}),xt=await Be.json().catch(()=>({}));if(!Be.ok)throw new Error(xt?.msg||"Unable to send code");N("If this email exists, a 6-digit code has been sent."),n(2)}catch(Be){b(Be.message||"Unable to send code")}finally{y(!1)}},O=async Fe=>{if(Fe.preventDefault(),b(""),N(""),!o.trim()){b("Verification code is required");return}try{y(!0);const Be=await fetch(`${dy}/api/auth/password/code/verify`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a,code:o})}),xt=await Be.json().catch(()=>({}));if(!Be.ok)throw new Error(xt?.msg||"Invalid or expired code");N("Code verified. You can now choose a new password."),n(3)}catch(Be){b(Be.message||"Invalid or expired code")}finally{y(!1)}},T=async Fe=>{if(Fe.preventDefault(),b(""),N(""),!m||!h){b("Please enter and confirm your new password.");return}if(m!==h){b("Passwords do not match.");return}try{y(!0);const Be=await fetch(`${dy}/api/auth/password/code/complete`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a,code:o,password:m,confirm:h})}),xt=await Be.json().catch(()=>({}));if(!Be.ok)throw new Error(xt?.msg||"Unable to update password");N("Password updated. Redirecting to login"),localStorage.removeItem("accessToken"),localStorage.removeItem("access_token"),localStorage.removeItem("token"),setTimeout(()=>{window.location.href="/login"},1e3)}catch(Be){b(Be.message||"Unable to update password")}finally{y(!1)}},[z,P]=g.useState(!1),[Z,q]=g.useState(""),[B,fe]=g.useState(""),[Ne,he]=g.useState(!1),[K,H]=g.useState(""),[be,te]=g.useState(""),I=(Fe=!1)=>{q(""),fe(""),H(""),Fe||te(""),he(!1)},se=()=>{I(!1),P(!0)},R=()=>{P(!1),I(!1)},W=async Fe=>{Fe.preventDefault(),H(""),te("");const Be=Z.trim(),xt=B.trim().toLowerCase();if(!Be||!xt){H("Please provide both Investor Name and Investor Email.");return}try{he(!0);const{data:Ze}=await We.post("/investor/dependents/request",{investor_name:Be,investor_email:xt},{headers:{"Content-Type":"application/json"}}),ht=Ze?.message||Ze?.msg||"Request sent. An admin will review it shortly.";te(ht),I(!0)}catch(Ze){H(Ze?.response?.data?.error||Ze?.response?.data?.message||Ze.message||"Unable to send request.")}finally{he(!1)}},[Y,Q]=g.useState(!1),[L,ne]=g.useState(""),[ge,G]=g.useState(""),[ue,Se]=g.useState(!1),[M,Qe]=g.useState(""),[xe,me]=g.useState(""),ze=(Fe=!1)=>{ne(""),G(""),Qe(""),Fe||me(""),Se(!1)},oe=()=>{ze(!1),Q(!0)},ke=()=>{Q(!1),ze(!1)},Ge=async Fe=>{Fe.preventDefault(),Qe(""),me("");const Be=L.trim(),xt=ge.trim().toLowerCase();if(!Be||!xt){Qe("Please provide both Investor Name and Investor Email.");return}try{Se(!0);const{data:Ze}=await We.post("/investor/group-investor/request",{investor_name:Be,investor_email:xt},{headers:{"Content-Type":"application/json"}}),ht=Ze?.message||Ze?.msg||"Your request to become a Group Investor Admin has been submitted.";me(ht),ze(!0)}catch(Ze){Qe(Ze?.response?.data?.error||Ze?.response?.data?.message||Ze.message||"Unable to submit request.")}finally{Se(!1)}};return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h2",{className:"text-xl font-semibold text-slate-800",children:"Settings"}),l.jsx("p",{className:"text-sm text-slate-500",children:"Manage your investor account preferences."})]}),l.jsxs("div",{className:"grid gap-6 md:grid-cols-1 max-w-2xl",children:[l.jsxs("section",{className:"rounded-xl border bg-white shadow-sm p-4 space-y-3",children:[l.jsx("h3",{className:"font-semibold text-slate-800 text-sm",children:"Security"}),l.jsx("p",{className:"text-xs text-slate-500",children:"We recommend changing your password regularly."}),l.jsx("button",{type:"button",onClick:A,className:"inline-flex items-center justify-center rounded-lg bg-indigo-600 text-white text-sm font-medium px-4 py-2 mt-2 hover:brightness-110",children:"Change password"})]}),l.jsxs("section",{className:"rounded-xl border bg-white shadow-sm p-4 space-y-3",children:[l.jsx("h3",{className:"font-semibold text-slate-800 text-sm",children:"Dependent Investors"}),l.jsx("p",{className:"text-xs text-slate-500",children:"Add an existing investor as your dependent. Your request will be reviewed and approved by an administrator."}),l.jsx("button",{type:"button",onClick:se,className:"inline-flex items-center justify-center rounded-lg bg-sky-600 text-white text-sm font-medium px-4 py-2 mt-2 hover:brightness-110",children:"Add Dependent Investor"})]}),l.jsxs("section",{className:"rounded-xl border bg-white shadow-sm p-4 space-y-3",children:[l.jsx("h3",{className:"font-semibold text-slate-800 text-sm",children:"Group Investor"}),l.jsx("p",{className:"text-xs text-slate-500",children:"Request to become a Group Investor Admin. Enter the investor you want to include in your group. Your request will be reviewed by an administrator."}),l.jsx("button",{type:"button",onClick:oe,className:"inline-flex items-center justify-center rounded-lg bg-emerald-600 text-white text-sm font-medium px-4 py-2 mt-2 hover:brightness-110",children:"Create Group Investor"})]})]}),l.jsx("p",{className:"text-xs text-slate-400",children:"You can wire additional controls to real API endpoints as they are implemented."}),e&&l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4",children:l.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-white shadow-xl p-6 space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Change password"}),l.jsx("button",{type:"button",onClick:k,className:"text-slate-400 hover:text-slate-600 text-xl leading-none",children:""})]}),l.jsxs("p",{className:"text-xs text-slate-500",children:["Step ",r," of 3"]}),w&&l.jsx("div",{className:"rounded-md border border-rose-200 bg-rose-50 text-rose-700 px-3 py-2 text-sm",children:w}),S&&l.jsx("div",{className:"rounded-md border border-emerald-200 bg-emerald-50 text-emerald-700 px-3 py-2 text-sm",children:S}),r===1&&l.jsxs("form",{onSubmit:C,className:"space-y-4",children:[l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Email address"}),l.jsx("input",{type:"email",value:a,onChange:Fe=>i(Fe.target.value),className:"w-full rounded-lg border px-3 py-2 text-sm bg-gray-50 focus:bg-white focus:outline-none focus:ring-2 focus:ring-indigo-100 border-gray-300",placeholder:"you@example.com",required:!0})]}),l.jsx("button",{type:"submit",disabled:v,className:"w-full inline-flex items-center justify-center rounded-lg bg-indigo-600 text-white text-sm font-medium px-4 py-2 hover:brightness-110 disabled:opacity-60",children:v?"Sending code":"Send verification code"})]}),r===2&&l.jsxs("form",{onSubmit:O,className:"space-y-4",children:[l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Verification code"}),l.jsx("input",{type:"text",value:o,onChange:Fe=>u(Fe.target.value),className:"w-full rounded-lg border px-3 py-2 text-sm bg-gray-50 focus:bg-white focus:outline-none focus:ring-2 focus:ring-indigo-100 border-gray-300 tracking-[0.2em]",placeholder:"123456",required:!0}),l.jsxs("p",{className:"text-xs text-slate-500",children:["Enter the 6-digit code sent to ",l.jsx("strong",{children:a}),"."]})]}),l.jsx("button",{type:"submit",disabled:v,className:"w-full inline-flex items-center justify-center rounded-lg bg-indigo-600 text-white text-sm font-medium px-4 py-2 hover:brightness-110 disabled:opacity-60",children:v?"Verifying":"Verify code"})]}),r===3&&l.jsxs("form",{onSubmit:T,className:"space-y-4",children:[l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:"text-sm font-medium text-slate-700",children:"New password"}),l.jsx("input",{type:"password",value:m,onChange:Fe=>f(Fe.target.value),className:"w-full rounded-lg border px-3 py-2 text-sm bg-gray-50 focus:bg-white focus:outline-none focus:ring-2 focus:ring-indigo-100 border-gray-300",required:!0})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Confirm new password"}),l.jsx("input",{type:"password",value:h,onChange:Fe=>x(Fe.target.value),className:"w-full rounded-lg border px-3 py-2 text-sm bg-gray-50 focus:bg-white focus:outline-none focus:ring-2 focus:ring-indigo-100 border-gray-300",required:!0})]}),l.jsx("button",{type:"submit",disabled:v,className:"w-full inline-flex items-center justify-center rounded-lg bg-indigo-600 text-white text-sm font-medium px-4 py-2 hover:brightness-110 disabled:opacity-60",children:v?"Updating":"Update password"})]})]})}),z&&l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4",children:l.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-white shadow-xl p-6 space-y-4",children:[l.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[l.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Add Dependent Investor"}),l.jsx("button",{type:"button",onClick:R,className:"text-slate-400 hover:text-slate-600 text-xl leading-none",children:""})]}),K&&l.jsx("div",{className:"rounded-md border border-rose-200 bg-rose-50 text-rose-700 px-3 py-2 text-sm",children:K}),be&&l.jsx("div",{className:"rounded-md border border-emerald-200 bg-emerald-50 text-emerald-700 px-3 py-2 text-sm",children:be}),l.jsxs("form",{onSubmit:W,className:"space-y-4",children:[l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Investor Name"}),l.jsx("input",{type:"text",className:"w-full rounded-lg border px-3 py-2 text-sm bg-gray-50 focus:bg-white focus:outline-none focus:ring-2 focus:ring-sky-100 border-gray-300",value:Z,onChange:Fe=>q(Fe.target.value),placeholder:"Full name as on the account"})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Investor Email"}),l.jsx("input",{type:"email",className:"w-full rounded-lg border px-3 py-2 text-sm bg-gray-50 focus:bg-white focus:outline-none focus:ring-2 focus:ring-sky-100 border-gray-300",value:B,onChange:Fe=>fe(Fe.target.value),placeholder:"their.email@example.com"})]}),l.jsxs("div",{className:"flex justify-end gap-2",children:[l.jsx("button",{type:"button",onClick:R,className:"rounded-lg border border-slate-200 px-4 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50",children:"Cancel"}),l.jsx("button",{type:"submit",disabled:Ne,className:"inline-flex items-center justify-center rounded-lg bg-sky-600 text-white text-sm font-medium px-4 py-2 hover:brightness-110 disabled:opacity-60",children:Ne?"Sending":"Send Request"})]})]})]})}),Y&&l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4",children:l.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-white shadow-xl p-6 space-y-4",children:[l.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[l.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Create Group Investor"}),l.jsx("button",{type:"button",onClick:ke,className:"text-slate-400 hover:text-slate-600 text-xl leading-none",children:""})]}),l.jsx("p",{className:"text-xs text-slate-500",children:"Enter the investor you want to include in your group. You can send multiple requests to add more investors."}),M&&l.jsx("div",{className:"rounded-md border border-rose-200 bg-rose-50 text-rose-700 px-3 py-2 text-sm",children:M}),xe&&l.jsx("div",{className:"rounded-md border border-emerald-200 bg-emerald-50 text-emerald-700 px-3 py-2 text-sm",children:xe}),l.jsxs("form",{onSubmit:Ge,className:"space-y-4",children:[l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Investor Name"}),l.jsx("input",{type:"text",className:"w-full rounded-lg border px-3 py-2 text-sm bg-gray-50 focus:bg-white focus:outline-none focus:ring-2 focus:ring-emerald-100 border-gray-300",placeholder:"Full name as on the account",value:L,onChange:Fe=>ne(Fe.target.value)})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Investor Email"}),l.jsx("input",{type:"email",className:"w-full rounded-lg border px-3 py-2 text-sm bg-gray-50 focus:bg-white focus:outline-none focus:ring-2 focus:ring-emerald-100 border-gray-300",placeholder:"their.email@example.com",value:ge,onChange:Fe=>G(Fe.target.value)})]}),l.jsxs("div",{className:"flex justify-end gap-2",children:[l.jsx("button",{type:"button",onClick:ke,className:"rounded-lg border border-slate-200 px-4 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50",children:"Cancel"}),l.jsx("button",{type:"submit",disabled:ue,className:"inline-flex items-center justify-center rounded-lg bg-emerald-600 text-white text-sm font-medium px-4 py-2 hover:brightness-110 disabled:opacity-60",children:ue?"Submitting":"Submit Request"})]})]})]})})]})}const ja={width:"1em",height:"1em",fill:"none","aria-hidden":!0},Cn={menu:()=>l.jsx("svg",{viewBox:"0 0 24 24",...ja,children:l.jsx("path",{d:"M4 6h16M4 12h16M4 18h16",stroke:"currentColor",strokeWidth:"2"})}),close:()=>l.jsx("svg",{viewBox:"0 0 24 24",...ja,children:l.jsx("path",{d:"M6 6l12 12M18 6l-12 12",stroke:"currentColor",strokeWidth:"2"})}),overview:()=>l.jsx("svg",{viewBox:"0 0 24 24",...ja,children:l.jsx("path",{d:"M3 12l9-7 9 7v7a2 2 0 01-2 2h-4a2 2 0 01-2-2v-3H9v3a2 2 0 01-2 2H3v-9z",stroke:"currentColor",strokeWidth:"2"})}),portfolio:()=>l.jsxs("svg",{viewBox:"0 0 24 24",...ja,children:[l.jsx("path",{d:"M3 7h18v10H3z",stroke:"currentColor",strokeWidth:"2"}),l.jsx("path",{d:"M8 7V5a2 2 0 012-2h4a2 2 0 012 2v2",stroke:"currentColor",strokeWidth:"2"})]}),statements:()=>l.jsxs("svg",{viewBox:"0 0 24 24",...ja,children:[l.jsx("path",{d:"M8 7h8M8 11h8M8 15h5",stroke:"currentColor",strokeWidth:"2"}),l.jsx("rect",{x:"4",y:"3",width:"16",height:"18",rx:"2",stroke:"currentColor",strokeWidth:"2"})]}),documents:()=>l.jsxs("svg",{viewBox:"0 0 24 24",...ja,children:[l.jsx("path",{d:"M14 3H6a2 2 0 00-2 2v14a2 2 0 002 2h8l6-6V5a2 2 0 00-2-2h-4z",stroke:"currentColor",strokeWidth:"2"}),l.jsx("path",{d:"M14 3v6h6",stroke:"currentColor",strokeWidth:"2"})]}),person:()=>l.jsxs("svg",{viewBox:"0 0 24 24",...ja,children:[l.jsx("circle",{cx:"12",cy:"8",r:"4",stroke:"currentColor",strokeWidth:"2"}),l.jsx("path",{d:"M6 20a6 6 0 0112 0",stroke:"currentColor",strokeWidth:"2"})]}),badge:()=>l.jsx("svg",{viewBox:"0 0 24 24",...ja,children:l.jsx("path",{d:"M12 3l2.5 5 5.5.8-4 3.9.9 5.6L12 16l-4.9 2.3.9-5.6-4-3.9 5.5-.8L12 3z",stroke:"currentColor",strokeWidth:"2"})}),contacts:()=>l.jsxs("svg",{viewBox:"0 0 24 24",...ja,children:[l.jsx("circle",{cx:"8",cy:"8",r:"3",stroke:"currentColor",strokeWidth:"2"}),l.jsx("path",{d:"M2 21a6 6 0 0112 0",stroke:"currentColor",strokeWidth:"2"}),l.jsx("rect",{x:"14",y:"7",width:"8",height:"10",rx:"2",stroke:"currentColor",strokeWidth:"2"})]}),group:()=>l.jsxs("svg",{viewBox:"0 0 24 24",...ja,children:[l.jsx("path",{d:"M16 11a4 4 0 10-8 0 4 4 0 008 0z",stroke:"currentColor",strokeWidth:"2"}),l.jsx("path",{d:"M3 21a7 7 0 0114 0M17 7a3 3 0 013-3 3 3 0 013 3M22 21a5 5 0 00-6-4",stroke:"currentColor",strokeWidth:"2"})]}),settings:()=>l.jsxs("svg",{viewBox:"0 0 24 24",...ja,children:[l.jsx("path",{d:"M10.3 4.3a1 1 0 011.4 0l1.1 1.1a1 1 0 00.9.27l1.5-.34a1 1 0 011.16.58l.7 1.4a1 1 0 01-.18 1.11l-1.02 1.02a1 1 0 000 1.4l1.02 1.02a1 1 0 01.18 1.11l-.7 1.4a1 1 0 01-1.16.58l-1.5-.34a1 1 0 00-.9.27l-1.1 1.1a1 1 0 01-1.4 0l-1.1-1.1a1 1 0 00-.9-.27l-1.5.34a1 1 0 01-1.16-.58l-.7-1.4a1 1 0 01-.18-1.11L6.4 13.3a1 1 0 000-1.4L5.38 10.9a1 1 0 01-.18-1.11l.7-1.4a1 1 0 011.16-.58l1.5.34a1 1 0 00.9-.27l1.1-1.1z",stroke:"currentColor",strokeWidth:"2"}),l.jsx("circle",{cx:"12",cy:"12",r:"2.5",stroke:"currentColor",strokeWidth:"2"})]}),logout:()=>l.jsxs("svg",{viewBox:"0 0 24 24",...ja,children:[l.jsx("path",{d:"M15 17l5-5-5-5M20 12H9",stroke:"currentColor",strokeWidth:"2"}),l.jsx("path",{d:"M4 4h6a2 2 0 012 2v2",stroke:"currentColor",strokeWidth:"2"}),l.jsx("path",{d:"M12 16v2a2 2 0 01-2 2H4",stroke:"currentColor",strokeWidth:"2"})]}),bell:()=>l.jsxs("svg",{viewBox:"0 0 24 24",...ja,children:[l.jsx("path",{d:"M12 3a4 4 0 00-4 4v2.1c0 .5-.2 1-.6 1.3L6 12.5V14h12v-1.5l-1.4-2.1a1.7 1.7 0 01-.6-1.3V7a4 4 0 00-4-4z",stroke:"currentColor",strokeWidth:"2"}),l.jsx("path",{d:"M10 18a2 2 0 004 0",stroke:"currentColor",strokeWidth:"2"})]})},P0e="w-full text-left px-3 py-2 rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-sky-400 flex items-center gap-2 text-sm leading-5",R0e="hover:bg-sky-50 text-slate-700",M0e="bg-sky-100 text-sky-700";function F0e(){const{user:e,logout:t}=g.useContext(Di);if(e===void 0)return l.jsx("p",{className:"p-6",children:"Loading dashboard"});const[r,n]=g.useState(!0),[a,i]=g.useState("accreditation"),[o,u]=g.useState(null),[m,f]=g.useState(""),[h,x]=g.useState({investor_type:null,parent_investor_id:null,dependents:[]}),[v,y]=g.useState(!1),b=(e?.user_type||"").toString().replace(/\s+/g,"").toLowerCase()==="groupadmin",S=(e?.full_name||"").trim().split(/\s+/)[0]||"",[N,_]=g.useState(!1),[A,k]=g.useState(0),[C,O]=g.useState([]),[T,z]=g.useState(!1),[P,Z]=g.useState(""),q=g.useRef(null),[B,fe]=g.useState(!1),Ne=g.useRef(null),he=((e?.full_name||e?.email||"?").trim()[0]||"?").toUpperCase(),K=(e?.user_type||"investor").toString();g.useEffect(()=>{const L=ne=>{Ne.current&&!Ne.current.contains(ne.target)&&fe(!1)};return B&&document.addEventListener("mousedown",L),()=>document.removeEventListener("mousedown",L)},[B]),g.useEffect(()=>{let L=!0;return(async()=>{f("");try{const{data:ne}=await We.get("/api/investor/accreditation",{headers:{Accept:"application/json"}});if(!L)return;const ge=!!(ne&&ne.selection&&ne.selection!=="not_yet");u(ge),i(ge?"overview":"accreditation")}catch(ne){if(!L)return;u(!1),i("accreditation"),f(ne?.response?.data?.error||(ne?.response?`Accreditation check failed (${ne.response.status})`:"Unable to check accreditation."))}})(),()=>{L=!1}},[]),g.useEffect(()=>{let L=!0;return(async()=>{try{const{data:ne}=await We.get("/api/investor/me",{headers:{Accept:"application/json"}});if(!L)return;x({investor_type:ne?.investor_type??null,parent_investor_id:ne?.parent_investor_id??null,dependents:Array.isArray(ne?.dependents)?ne.dependents:[]})}finally{L&&y(!0)}})(),()=>{L=!1}},[]);const H=g.useMemo(()=>{const L=String(h.investor_type||"").trim().toLowerCase(),ne=h.parent_investor_id!==null&&h.parent_investor_id!==void 0;return L.startsWith("depend")||ne},[h.investor_type,h.parent_investor_id]),be=g.useMemo(()=>Array.isArray(h.dependents)&&h.dependents.length>0,[h.dependents]);g.useEffect(()=>{v&&H&&a!=="portfolio"&&i("portfolio")},[v,H,a]),g.useEffect(()=>(v&&H&&h.parent_investor_id&&a==="portfolio"?We.defaults.headers.common["X-View-As-Investor"]=String(h.parent_investor_id):delete We.defaults.headers.common["X-View-As-Investor"],()=>{delete We.defaults.headers.common["X-View-As-Investor"]}),[v,H,h.parent_investor_id,a]);const te=L=>{try{const ne=!!L&&(L.name||L.investor_name||L.full_name),ge=L&&(L.name||L.investor_name||L.full_name)||"",G=(L&&(L.investor_id??L.id??L.investorId))??null;if(ne&&ge?(localStorage.setItem("investorHint",ge),G!=null?localStorage.setItem("currentInvestorId",String(G)):localStorage.removeItem("currentInvestorId")):(localStorage.removeItem("investorHint"),localStorage.removeItem("currentInvestorId")),typeof window<"u"&&window.location){const ue=new URL(window.location.href);ne&&ge?(ue.searchParams.set("investor",ge),G!=null?ue.searchParams.set("investorId",String(G)):ue.searchParams.delete("investorId")):(ue.searchParams.delete("investor"),ue.searchParams.delete("investorId")),window.history.replaceState({},"",ue.toString())}}catch{}};g.useEffect(()=>{let L=!0;const ne=async()=>{try{const{data:G}=await We.get("/api/notifications/unread-count",{headers:{Accept:"application/json"}});if(!L)return;k(G?.count||0)}catch{if(!L)return}};ne();const ge=setInterval(ne,6e4);return()=>{L=!1,clearInterval(ge)}},[]);const I=async()=>{z(!0),Z("");try{const{data:L}=await We.get("/api/notifications",{headers:{Accept:"application/json"}});O(Array.isArray(L)?L:[])}catch(L){Z(L?.response?.data?.error||L?.message||"Unable to load notifications.")}finally{z(!1)}},se=()=>{const L=!N;_(L),L&&I()},R=async()=>{const L=C.filter(ne=>!ne.read_at).map(ne=>ne.id);if(!L.length){k(0);return}try{await We.post("/api/notifications/mark-read",{ids:L},{headers:{"Content-Type":"application/json"}}),O(ne=>ne.map(ge=>ge.read_at?ge:{...ge,read_at:new Date().toISOString()})),k(0)}catch(ne){Z(ne?.response?.data?.error||ne?.message||"Failed to mark notifications as read.")}},W=g.useMemo(()=>{if(v&&H)return[{title:"INVESTMENTS",items:[{id:"portfolio",label:"Portfolio",icon:Cn.portfolio}]},{title:"ACCOUNT",items:[{id:"logout",label:"Logout",icon:Cn.logout}]}];const L=[{id:"overview",label:"Overview",icon:Cn.overview}],ne=[{id:"portfolio",label:"Portfolio",icon:Cn.portfolio}];if(b){const Se=S?`${S}'s Group`:"My Group";ne.push({id:"group-members",label:Se,icon:Cn.group})}ne.push({id:"statements",label:"Statements",icon:Cn.statements},{id:"documents",label:"Documents",icon:Cn.documents});const ge=[{id:"personalinformation",label:"Personal Information",icon:Cn.person},{id:"accreditation",label:"Accreditation",icon:Cn.badge},{id:"contacts",label:"Contacts",icon:Cn.contacts},{id:"settings",label:"Settings",icon:Cn.settings}],ue=v&&!H&&be?[{title:"DEPENDENT",items:[{id:"dependents",label:"Dependent",icon:Cn.group}]}]:[];return[{title:"DASHBOARD",items:L},{title:"INVESTMENTS",items:ne},{title:"PROFILE",items:ge},...ue,{title:"ACCOUNT",items:[{id:"logout",label:"Logout",icon:Cn.logout}]}]},[v,H,be,b,S]),Y=L=>{if(L==="logout"){t();return}if(v&&H&&L!=="portfolio")return;if(o===!1&&!H&&L!=="accreditation"){i("accreditation");return}if(!(L==="dependents"&&!(v&&!H&&be))){if(i(L),L!=="group-members"){try{localStorage.removeItem("investorHint"),localStorage.removeItem("currentInvestorId")}catch{}if(typeof window<"u"&&window.location)try{const ge=new URL(window.location.href);ge.searchParams.delete("investor"),ge.searchParams.delete("investorId"),window.history.replaceState({},"",ge.toString())}catch{}}window?.matchMedia&&window.matchMedia("(max-width: 1023px)").matches&&n(!1)}},Q=L=>v&&H?L!=="portfolio"&&L!=="logout":o===!1&&L!=="accreditation"&&L!=="logout";return l.jsxs("div",{className:"min-h-screen bg-slate-100 flex flex-col",children:[l.jsxs("header",{className:"flex items-center justify-between gap-3 bg-white border-b px-3 sm:px-4 md:px-6 py-3 sticky top-0 z-40",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{type:"button",className:"inline-flex items-center justify-center p-2 rounded-md border border-slate-300 text-slate-700 hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-sky-500",onClick:()=>n(L=>!L),"aria-label":r?"Close menu":"Open menu",children:r?l.jsx(Cn.close,{}):l.jsx(Cn.menu,{})}),l.jsx("h1",{className:"text-base sm:text-lg md:text-2xl font-semibold text-blue-600",children:"Investor Panel"})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("div",{className:"relative",ref:q,children:[l.jsxs("button",{type:"button",onClick:se,className:"relative inline-flex items-center justify-center rounded-full border border-slate-300 bg-white p-2 text-slate-600 hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-sky-500","aria-label":"Investor notifications",children:[l.jsx(Cn.bell,{}),A>0&&l.jsx("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center rounded-full bg-rose-500 px-1.5 py-0.5 text-[10px] font-semibold text-white",children:A>9?"9+":A})]}),N&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>_(!1)}),l.jsxs("div",{className:"absolute right-0 mt-2 w-72 rounded-xl border border-slate-200 bg-white shadow-lg z-50",children:[l.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b border-slate-100",children:[l.jsx("span",{className:"text-xs font-semibold text-slate-600",children:"Notifications"}),l.jsx("button",{type:"button",onClick:R,className:"text-[11px] text-sky-600 hover:underline",children:"Mark all read"})]}),l.jsx("div",{className:"max-h-72 overflow-y-auto",children:T?l.jsx("div",{className:"px-3 py-3 text-xs text-slate-500",children:"Loading"}):P?l.jsx("div",{className:"px-3 py-3 text-xs text-rose-600",children:P}):C.length?C.map(L=>l.jsxs("div",{className:`px-3 py-2 text-xs border-b border-slate-50 last:border-0 ${L.read_at?"":"bg-slate-50"}`,children:[l.jsx("div",{className:"font-semibold text-slate-700",children:L.title||"Notification"}),L.message&&l.jsx("div",{className:"mt-0.5 text-slate-600",children:L.message}),l.jsxs("div",{className:"mt-0.5 flex justify-between items-center text-[10px] text-slate-400",children:[l.jsx("span",{children:L.created_at?new Date(L.created_at).toLocaleString():""}),L.link_url&&l.jsx("a",{href:L.link_url,target:"_blank",rel:"noreferrer",className:"text-sky-600 hover:underline",children:"View"})]})]},L.id)):l.jsx("div",{className:"px-3 py-3 text-xs text-slate-500",children:"No notifications yet."})})]})]})]}),l.jsxs("div",{className:"relative",ref:Ne,children:[l.jsx("button",{type:"button",onClick:()=>fe(L=>!L),className:"inline-flex h-9 w-9 items-center justify-center rounded-full bg-blue-600 text-white text-sm font-semibold shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-sky-500","aria-label":"Account info",children:he}),B&&l.jsxs("div",{className:"absolute right-0 mt-2 w-64 rounded-xl border border-slate-200 bg-white px-3 py-2 text-xs shadow-lg z-[110]",children:[l.jsx("div",{className:"mb-1 font-semibold text-slate-800",children:`${K[0]?.toUpperCase()||""}${K.slice(1).toLowerCase()} Info`}),l.jsxs("div",{className:"space-y-1 text-slate-700",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-semibold",children:"Full Name: "}),l.jsx("span",{children:e?.full_name||""})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-semibold",children:"Email: "}),l.jsx("span",{children:e?.email||""})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-semibold",children:"User Type: "}),l.jsx("span",{children:K||"investor"})]})]})]})]})]})]}),v&&H&&a==="portfolio"&&l.jsx("div",{className:"bg-sky-50 text-sky-800 border-b border-sky-200 px-4 py-2 text-sm",children:"You are a dependent investor. This Portfolio shows your parent investors data."}),l.jsxs("div",{className:"flex-1 flex relative",children:[r&&l.jsx("div",{className:"fixed inset-0 bg-black/25 z-30 lg:hidden",onClick:()=>n(!1),"aria-hidden":"true"}),l.jsx("aside",{className:["fixed lg:static z-40 lg:z-0 inset-y-0 left-0 w-60 bg-white border-r","transform transition-transform duration-200 ease-in-out",r?"translate-x-0":"-translate-x-full"].join(" "),"aria-label":"Sidebar navigation",children:l.jsx("nav",{className:"h-full overflow-y-auto px-3 py-4 space-y-6",children:W.map(L=>l.jsxs("div",{children:[l.jsx("div",{className:"font-semibold text-slate-400 uppercase text-[11px] tracking-wide mb-2",children:L.title}),l.jsx("ul",{className:"space-y-1",children:L.items.map(ne=>{const ge=a===ne.id,G=Q(ne.id),ue=ne.icon;return l.jsx("li",{children:l.jsxs("button",{className:`${P0e} ${ge?M0e:R0e} ${G?"opacity-50 cursor-not-allowed":""}`,onClick:()=>G?null:Y(ne.id),"aria-disabled":G?"true":"false",title:G?"Not available for this account":ne.label,children:[l.jsx("span",{className:"shrink-0 leading-none inline-flex items-center",children:l.jsx(ue,{})}),l.jsx("span",{className:"truncate",children:ne.label})]})},ne.id)})})]},L.title))})}),l.jsxs("main",{className:"flex-1 px-3 sm:px-4 md:px-6 lg:px-8 py-4 z-10",children:[!H&&o===!1&&l.jsxs("div",{className:"mb-4 rounded-lg border border-amber-200 bg-amber-50 text-amber-800 px-4 py-3 text-sm",children:["Please complete your ",l.jsx("strong",{children:"Accreditation"})," to access the rest of the dashboard."]}),m&&l.jsx("div",{className:"mb-4 rounded-lg border border-rose-200 bg-rose-50 text-rose-700 px-4 py-3 text-sm",children:m}),l.jsxs("div",{className:"w-full",children:[!H&&a==="overview"&&l.jsx(yS,{}),a==="portfolio"&&l.jsx(bS,{}),!H&&b&&a==="group-members"&&l.jsx(L0e,{onSelectInvestor:te}),!H&&a==="statements"&&l.jsx(wS,{}),!H&&a==="documents"&&l.jsx(jS,{}),!H&&a==="personalinformation"&&l.jsx(NS,{}),!H&&a==="contacts"&&l.jsx(ES,{}),!H&&a==="settings"&&l.jsx(I8,{}),a==="accreditation"&&!H&&l.jsx(F8,{onAccredited:u}),!H&&be&&a==="dependents"&&l.jsx(B0e,{})]})]})]})]})}const I0e=[{id:"overview",label:"Overview"},{id:"portfolio",label:"Portfolio"},{id:"statements",label:"Statements"},{id:"documents",label:"Documents"},{id:"personalinformation",label:"Personal Information"},{id:"accreditation",label:"Accreditation"},{id:"contacts",label:"Contacts"},{id:"settings",label:"Settings"}],L0e=({onSelectInvestor:e})=>{const[t,r]=g.useState(!0),[n,a]=g.useState(null),[i,o]=g.useState([]),[u,m]=g.useState(null),[f,h]=g.useState("overview");g.useEffect(()=>{(async()=>{try{r(!0),a(null);const{data:w}=await We.get("/api/group-admin/my-group",{headers:{Accept:"application/json"}}),b=w||{},N=(Array.isArray(b.members)?b.members:Array.isArray(b.investors)?b.investors:[]).map(_=>({id:_.id??_.investor_id,investor_id:_.id??_.investor_id,name:_.name,email:_.email,added_at:_.added_at||null}));o(N)}catch(w){a(w?.response?.data?.error||w?.message||"Failed to load group investors.")}finally{r(!1)}})()},[]);const x=y=>{m(y),h("overview"),e&&e(y)},v=()=>{m(null),h("overview"),e&&e(null)};return t?l.jsx("p",{className:"text-sm text-slate-600",children:"Loading group investors"}):n?l.jsx("div",{className:"rounded-md border border-rose-100 bg-rose-50 px-4 py-3 text-sm text-rose-700",children:n}):i.length?u?l.jsxs("div",{className:"rounded-xl border border-slate-100 bg-white",children:[l.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2 border-b border-slate-100 px-4 py-3",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-xs font-semibold text-sky-700 uppercase tracking-wide",children:"Viewing child investor"}),l.jsx("div",{className:"text-base font-semibold text-slate-900",children:u.name}),l.jsx("div",{className:"text-xs text-slate-500",children:u.email})]}),l.jsx("button",{type:"button",onClick:v,className:"inline-flex items-center px-3 py-1.5 rounded-lg border border-slate-300 text-xs font-semibold text-slate-700 bg-white hover:bg-slate-50",children:" Back to investor list"})]}),l.jsx("div",{className:"border-b border-slate-100 flex flex-wrap items-center gap-1 px-4 pt-2",children:I0e.map(y=>l.jsx("button",{type:"button",onClick:()=>h(y.id),className:`px-3 py-2 text-xs sm:text-sm border-b-2 -mb-px transition ${f===y.id?"border-sky-500 text-sky-700 font-semibold":"border-transparent text-slate-500 hover:text-slate-700"}`,children:y.label},y.id))}),l.jsxs("div",{className:"p-4 sm:p-6",children:[f==="overview"&&l.jsx(yS,{}),f==="portfolio"&&l.jsx(bS,{}),f==="statements"&&l.jsx(wS,{}),f==="documents"&&l.jsx(jS,{}),f==="personalinformation"&&l.jsx(NS,{}),f==="accreditation"&&l.jsx(F8,{}),f==="contacts"&&l.jsx(ES,{}),f==="settings"&&l.jsx(I8,{})]})]}):l.jsxs("div",{className:"rounded-xl border border-slate-100 bg-white p-4 space-y-3",children:[l.jsx("h2",{className:"text-sm sm:text-base font-semibold text-slate-800",children:"Investors in your group"}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full text-left text-xs sm:text-sm",children:[l.jsx("thead",{className:"border-b border-slate-100 text-slate-500",children:l.jsxs("tr",{children:[l.jsx("th",{className:"py-2 pr-4 font-medium",children:"Name"}),l.jsx("th",{className:"py-2 px-4 font-medium",children:"Email"}),l.jsx("th",{className:"py-2 px-4 font-medium",children:"Added"})]})}),l.jsx("tbody",{className:"divide-y divide-slate-50",children:i.map(y=>l.jsxs("tr",{children:[l.jsx("td",{className:"py-2 pr-4 text-slate-800",children:l.jsx("button",{type:"button",onClick:()=>x(y),className:"text-sky-700 hover:underline",children:y.name})}),l.jsx("td",{className:"py-2 px-4 text-sky-700",children:y.email}),l.jsx("td",{className:"py-2 px-4 text-slate-500",children:y.added_at?new Date(y.added_at).toLocaleDateString():""})]},y.investor_id??y.id))})]})})]}):l.jsx("div",{className:"rounded-md border border-slate-100 bg-white px-4 py-3 text-sm text-slate-600",children:"No investors have been added to your group yet."})};function B0e(){const[e,t]=g.useState([]),[r,n]=g.useState(!0),[a,i]=g.useState(""),[o,u]=g.useState({}),[m,f]=g.useState({type:"",msg:""});g.useEffect(()=>{h()},[]);const h=async()=>{i(""),n(!0);try{const{data:v}=await We.get("/api/investors/dependents",{headers:{Accept:"application/json"}}),y=Array.isArray(v)?v:Array.isArray(v?.items)?v.items:Array.isArray(v?.data)?v.data:[];t(y)}catch(v){i(v?.response?.data?.error||v?.message||"Unable to load dependents.")}finally{n(!1)}},x=async v=>{if(v){u(y=>({...y,[v]:!0})),f({type:"",msg:""});try{await We.post("/api/deletion-requests",{investor_id:v},{headers:{"Content-Type":"application/json"}}),t(y=>y.map(w=>w.id===v?{...w,delete_request_status:"pending"}:w)),f({type:"success",msg:"Delete request sent to admin."})}catch(y){f({type:"error",msg:y?.response?.data?.error||y?.message||"Request failed."})}finally{u(y=>({...y,[v]:!1})),setTimeout(()=>f({type:"",msg:""}),3500)}}};return l.jsxs("div",{className:"space-y-4",children:[l.jsx("h2",{className:"text-lg font-semibold",children:"Dependent Accounts"}),m.msg&&l.jsx("div",{className:`rounded-lg border px-4 py-3 text-sm ${m.type==="success"?"border-emerald-200 bg-emerald-50 text-emerald-800":"border-rose-200 bg-rose-50 text-rose-700"}`,children:m.msg}),a&&l.jsx("div",{className:"rounded-lg border border-rose-200 bg-rose-50 text-rose-700 px-4 py-3 text-sm",children:a}),r?l.jsx("div",{className:"rounded-lg border p-6 text-sm text-slate-600",children:"Loading"}):e.length===0?l.jsx("div",{className:"rounded-lg border p-6 text-sm text-slate-600",children:"No dependent accounts found."}):l.jsx("div",{className:"overflow-x-auto rounded-lg border",children:l.jsxs("table",{className:"min-w-full text-left text-sm",children:[l.jsx("thead",{className:"bg-gray-50 text-gray-700",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 font-medium",children:"Investor"}),l.jsx("th",{className:"px-4 py-3 font-medium",children:"Email"}),l.jsx("th",{className:"px-4 py-3 font-medium",children:"Type"}),l.jsx("th",{className:"px-4 py-3 font-medium",children:"Relation"}),l.jsx("th",{className:"px-4 py-3 font-medium",children:"Delete Request"})]})}),l.jsx("tbody",{className:"divide-y",children:e.map(v=>{const y=(v.delete_request_status||"").toLowerCase(),w=!!o[v.id],b=v.parent_relationship||v.relationship||"";return l.jsxs("tr",{children:[l.jsx("td",{className:"px-4 py-3",children:v.name||""}),l.jsx("td",{className:"px-4 py-3",children:v.email||""}),l.jsx("td",{className:"px-4 py-3",children:v.investor_type||"Depends"}),l.jsx("td",{className:"px-4 py-3",children:b}),l.jsx("td",{className:"px-4 py-3",children:y==="pending"?l.jsx("span",{className:"inline-flex items-center rounded-full border border-amber-200 bg-amber-50 px-2 py-0.5 text-xs text-amber-900",children:"Pending"}):y==="approved"?l.jsx("span",{className:"inline-flex items-center rounded-full border border-emerald-200 bg-emerald-50 px-2 py-0.5 text-xs text-emerald-900",children:"Approved"}):y==="rejected"?l.jsx("span",{className:"inline-flex items-center rounded-full border border-rose-200 bg-rose-50 px-2 py-0.5 text-xs text-rose-700",children:"Rejected"}):l.jsx("button",{onClick:()=>x(v.id),disabled:w,className:"rounded-lg border px-2.5 py-1 text-xs hover:bg-gray-50 disabled:opacity-60",title:"Ask admin to remove this dependent account",children:w?"Sending":"Request delete"})})]},v.id||v.investor_id)})})]})})]})}const vl={name:"Antigravity Fund 1",status:"ACTIVE",date:"June 5th, 2023",committedCapital:"$1,000,000",calledSoFar:"$100,000",fundsAvailable:"$90,000",leftToCall:"$900,000",investments:[{company:"Brex",currentValue:"$1,345,223",initialInvestment:"$1,000,000",lastUpdated:"1/11/23",positive:!0},{company:"Cardless",currentValue:"$100,000",initialInvestment:"$100,000",lastUpdated:"2/17/23",positive:!0},{company:"Kaycakes",currentValue:"$432,567",initialInvestment:"$600,000",lastUpdated:"2/14/23",positive:!1},{company:"Pipe",currentValue:"$710,436",initialInvestment:"$800,000",lastUpdated:"10/02/23",positive:!1}]},U0e=[{date:"5/10/23",value:"$78,000",doc:"Statement.pdf"},{date:"2/12/22",value:"$92,000",doc:"Statement.pdf"},{date:"7/19/21",value:"$100,000",doc:"Statement.pdf"}],bd=({icon:e,label:t,active:r,onClick:n})=>l.jsxs("button",{onClick:n,className:`flex items-center gap-3 w-full px-3 py-2 rounded-md text-sm font-medium transition
      ${r?"bg-blue-100 text-blue-700":"text-gray-700 hover:bg-blue-50 hover:text-blue-600"}`,children:[e,t]});function $0e(){const[e,t]=g.useState(!1),[r,n]=g.useState("Fund"),a=es();return l.jsxs("div",{className:"flex min-h-screen bg-gray-50",children:[l.jsxs("aside",{className:"w-64 bg-white border-r border-gray-200 shadow-sm flex flex-col justify-between",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"p-5 border-b border-gray-100 text-center",children:[l.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Opportunity Fund"}),l.jsx("p",{className:"text-md text-gray-500",children:"Dashboard"})]}),l.jsxs("nav",{className:"flex flex-col p-4 space-y-1",children:[l.jsx(bd,{icon:l.jsx(nO,{size:18}),label:"Fund",active:r==="Fund",onClick:()=>n("Fund")}),l.jsx(bd,{icon:l.jsx(rO,{size:18}),label:"Lead",active:r==="Lead",onClick:()=>n("Lead")}),l.jsx(bd,{icon:l.jsx($h,{size:18}),label:"Documents",active:r==="Documents",onClick:()=>n("Documents")}),l.jsx(bd,{icon:l.jsx(kd,{size:18}),label:"Profiles & Teams",active:r==="Profiles & Teams",onClick:()=>n("Profiles & Teams")}),l.jsx(bd,{icon:l.jsx(eO,{size:18}),label:"Tax Center",active:r==="Tax Center",onClick:()=>n("Tax Center")})]})]}),l.jsxs("div",{className:"p-4 border-t border-gray-200 space-y-2",children:[l.jsxs("button",{onClick:()=>a("/admin-dashboard"),className:"flex items-center gap-2 text-gray-600 hover:text-blue-600 w-full text-sm",children:[l.jsx(tO,{size:16})," Back to Admin Panel"]}),l.jsxs("button",{onClick:()=>a("/login"),className:"flex items-center gap-2 text-red-500 hover:text-red-700 w-full text-sm",children:[l.jsx(Zm,{size:16})," Logout"]})]})]}),l.jsxs("main",{className:"flex-1 p-8 space-y-8",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-sm bg-green-100 text-green-700 px-2 py-1 rounded",children:vl.status}),l.jsx("h1",{className:"text-2xl font-bold mt-2",children:vl.name}),l.jsx("p",{className:"text-gray-500",children:vl.date})]}),l.jsxs("div",{className:"space-x-2",children:[l.jsx("button",{className:"px-4 py-2 bg-gray-900 text-white rounded",children:"Start Investment"}),l.jsx("button",{className:"px-4 py-2 bg-gray-200 rounded",children:"Call Capital"})]})]}),r==="Fund"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"grid grid-cols-4 gap-4 bg-white shadow rounded-lg p-4",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-500",children:"Committed Capital"}),l.jsx("p",{className:"text-lg font-semibold",children:vl.committedCapital})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-500",children:"Called So Far"}),l.jsx("p",{className:"text-lg font-semibold",children:vl.calledSoFar})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-500",children:"Funds Available"}),l.jsx("p",{className:"text-lg font-semibold",children:vl.fundsAvailable})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-500",children:"Left to Call"}),l.jsx("p",{className:"text-lg font-semibold",children:vl.leftToCall})]})]}),l.jsxs("div",{className:"bg-white shadow rounded-lg p-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h2",{className:"text-xl font-semibold",children:"Fund Investments"}),l.jsx("input",{type:"text",placeholder:"Search",className:"border rounded px-2 py-1 text-sm"})]}),l.jsxs("table",{className:"min-w-full border text-center",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"bg-gray-50 text-center",children:[l.jsx("th",{className:"p-2 border ",children:"Company"}),l.jsx("th",{className:"p-2 border",children:"Current Value"}),l.jsx("th",{className:"p-2 border",children:"Initial Investment"}),l.jsx("th",{className:"p-2 border",children:"Last Updated"}),l.jsx("th",{className:"p-2 border",children:"Action"})]})}),l.jsx("tbody",{children:vl.investments.map((i,o)=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"p-2 border",children:i.company}),l.jsx("td",{className:`p-2 border font-medium ${i.positive?"text-green-600":"text-red-600"}`,children:i.currentValue}),l.jsx("td",{className:"p-2 border",children:i.initialInvestment}),l.jsx("td",{className:"p-2 border",children:i.lastUpdated}),l.jsx("td",{className:"p-2 border text-blue-600 cursor-pointer",onClick:()=>t(!0),children:"View"})]},o))})]})]})]}),r!=="Fund"&&l.jsxs("div",{className:"bg-white p-6 rounded shadow text-gray-600",children:[l.jsx("h2",{className:"text-xl font-semibold mb-2",children:r}),l.jsxs("p",{children:['Content for the "',r,'" section will go here.']})]})]}),e&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex justify-center items-center",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 w-96 shadow-lg",children:[l.jsxs("div",{className:"flex justify-between mb-4",children:[l.jsx("h3",{className:"text-lg font-bold",children:"Kaycakes history"}),l.jsx("button",{onClick:()=>t(!1),className:"text-gray-500 hover:text-gray-700",children:"X"})]}),l.jsxs("table",{className:"w-full border",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"p-2 border",children:"Date"}),l.jsx("th",{className:"p-2 border",children:"Value"}),l.jsx("th",{className:"p-2 border",children:"Docs"})]})}),l.jsx("tbody",{children:U0e.map((i,o)=>l.jsxs("tr",{children:[l.jsx("td",{className:"p-2 border",children:i.date}),l.jsx("td",{className:"p-2 border text-red-600",children:i.value}),l.jsx("td",{className:"p-2 border text-blue-600 cursor-pointer",children:i.doc})]},o))})]}),l.jsx("div",{className:"text-right mt-4",children:l.jsx("button",{onClick:()=>t(!1),className:"bg-gray-900 text-white px-4 py-2 rounded",children:"Close"})})]})})]})}const gl={name:"General Partner Fund ",status:"ACTIVE",committedCapital:"$6,000,000",calledSoFar:"$100,000",fundsAvailable:"$30,000",leftToCall:"$90,000",investments:[{company:"Brex",currentValue:"$1,345,223",initialInvestment:"$1,000,000",lastUpdated:"1/11/23",positive:!0},{company:"Cardless",currentValue:"$100,000",initialInvestment:"$100,000",lastUpdated:"2/17/23",positive:!0},{company:"Kaycakes",currentValue:"$432,567",initialInvestment:"$600,000",lastUpdated:"2/14/23",positive:!1},{company:"Pipe",currentValue:"$710,436",initialInvestment:"$800,000",lastUpdated:"10/02/23",positive:!1}]},z0e=[{date:"5/10/23",value:"$78,000",doc:"Statement.pdf"},{date:"2/12/22",value:"$92,000",doc:"Statement.pdf"},{date:"7/19/21",value:"$100,000",doc:"Statement.pdf"}],wd=({icon:e,label:t,active:r,onClick:n})=>l.jsxs("button",{onClick:n,className:`flex items-center gap-3 w-full px-3 py-2 rounded-md text-sm font-medium transition ${r?"bg-blue-100 text-blue-700":"text-gray-700 hover:bg-blue-50 hover:text-blue-600"}`,children:[e,t]});function H0e(){const[e,t]=g.useState(!1),[r,n]=g.useState("Fund"),a=es(),{user:i}=g.useContext(Di);return l.jsxs("div",{className:"flex min-h-screen bg-gray-50",children:[l.jsxs("aside",{className:"w-64 bg-white border-r border-gray-200 shadow-sm flex flex-col justify-between",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"p-5 border-b border-gray-100 text-center",children:[l.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"General Partner"}),l.jsx("p",{className:"text-md text-gray-500",children:"Dashboard"})]}),l.jsxs("nav",{className:"flex flex-col p-4 space-y-1",children:[l.jsx(wd,{icon:l.jsx(nO,{size:18}),label:"Fund",active:r==="Fund",onClick:()=>n("Fund")}),l.jsx(wd,{icon:l.jsx(rO,{size:18}),label:"Lead",active:r==="Lead",onClick:()=>n("Lead")}),l.jsx(wd,{icon:l.jsx($h,{size:18}),label:"Documents",active:r==="Documents",onClick:()=>n("Documents")}),l.jsx(wd,{icon:l.jsx(kd,{size:18}),label:"Profiles & Teams",active:r==="Profiles & Teams",onClick:()=>n("Profiles & Teams")}),l.jsx(wd,{icon:l.jsx(eO,{size:18}),label:"Tax Center",active:r==="Tax Center",onClick:()=>n("Tax Center")})]})]}),i&&l.jsxs("div",{className:"p-4 border-t border-gray-200 space-y-2",children:[l.jsxs("button",{onClick:()=>a("/admin-dashboard"),className:"flex items-center gap-2 text-gray-800 hover:text-blue-600 w-full text-md",children:[l.jsx(tO,{size:18})," Back to Admin Panel"]}),l.jsxs("button",{onClick:()=>a("/login"),className:"flex items-center gap-2 text-red-500 hover:text-red-700 w-full text-sm",children:[l.jsx(Zm,{size:16})," Logout"]})]})]}),l.jsxs("main",{className:"flex-1 p-8 space-y-8",children:[l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{children:[l.jsx("span",{className:"text-sm bg-green-100 text-green-700 px-2 py-1 rounded",children:gl.status}),l.jsx("h1",{className:"text-2xl font-bold mt-2",children:gl.name}),l.jsx("p",{className:"text-gray-500",children:gl.date})]})}),r==="Fund"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"grid grid-cols-4 gap-4 bg-white shadow rounded-lg p-4",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-500",children:"Committed Capital"}),l.jsx("p",{className:"text-lg font-semibold",children:gl.committedCapital})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-500",children:"Called So Far"}),l.jsx("p",{className:"text-lg font-semibold",children:gl.calledSoFar})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-500",children:"Funds Available"}),l.jsx("p",{className:"text-lg font-semibold",children:gl.fundsAvailable})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-500",children:"Left to Call"}),l.jsx("p",{className:"text-lg font-semibold",children:gl.leftToCall})]})]}),l.jsxs("div",{className:"bg-white shadow rounded-lg p-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h2",{className:"text-xl font-semibold",children:"Fund Investments"}),l.jsx("input",{type:"text",placeholder:"Search",className:"border rounded px-2 py-1 text-sm"})]}),l.jsxs("table",{className:"min-w-full border text-center",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"bg-gray-50 text-center",children:[l.jsx("th",{className:"p-2 border",children:"Company"}),l.jsx("th",{className:"p-2 border",children:"Current Value"}),l.jsx("th",{className:"p-2 border",children:"Initial Investment"}),l.jsx("th",{className:"p-2 border",children:"Last Updated"}),l.jsx("th",{className:"p-2 border",children:"Action"})]})}),l.jsx("tbody",{children:gl.investments.map((o,u)=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"p-2 border",children:o.company}),l.jsx("td",{className:`p-2 border font-medium ${o.positive?"text-green-600":"text-red-600"}`,children:o.currentValue}),l.jsx("td",{className:"p-2 border",children:o.initialInvestment}),l.jsx("td",{className:"p-2 border",children:o.lastUpdated}),l.jsx("td",{className:"p-2 border text-blue-600 cursor-pointer",onClick:()=>t(!0),children:"View"})]},u))})]})]})]}),r!=="Fund"&&l.jsxs("div",{className:"bg-white p-6 rounded shadow text-gray-600",children:[l.jsx("h2",{className:"text-xl font-semibold mb-2",children:r}),l.jsxs("p",{children:['Content for the "',r,'" section will go here.']})]})]}),e&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex justify-center items-center",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 w-96 shadow-lg",children:[l.jsxs("div",{className:"flex justify-between mb-4",children:[l.jsx("h3",{className:"text-lg font-bold",children:"Company History"}),l.jsx("button",{onClick:()=>t(!1),className:"text-gray-500 hover:text-gray-700",children:"X"})]}),l.jsxs("table",{className:"w-full border",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"p-2 border",children:"Date"}),l.jsx("th",{className:"p-2 border",children:"Value"}),l.jsx("th",{className:"p-2 border",children:"Docs"})]})}),l.jsx("tbody",{children:z0e.map((o,u)=>l.jsxs("tr",{children:[l.jsx("td",{className:"p-2 border",children:o.date}),l.jsx("td",{className:"p-2 border text-red-600",children:o.value}),l.jsx("td",{className:"p-2 border text-blue-600 cursor-pointer",children:o.doc})]},u))})]}),l.jsx("div",{className:"text-right mt-4",children:l.jsx("button",{onClick:()=>t(!1),className:"bg-gray-900 text-white px-4 py-2 rounded",children:"Close"})})]})})]})}function oC(){const[e]=AC(),t=e.get("token"),r=es(),[n,a]=g.useState(!0),[i,o]=g.useState(""),[u,m]=g.useState(""),[f,h]=g.useState({first_name:"",last_name:"",birthdate:"",citizenship:"",email:"",phone:"",ssn:"",emergency_contact:"",address1:"",address2:"",country:"",city:"",state:"",zip:"",password:""}),x=g.useMemo(()=>{const b=(f.first_name||"").trim()[0]||"",S=(f.last_name||"").trim()[0]||"";return(b+S||"A").toUpperCase()},[f.first_name,f.last_name]);g.useEffect(()=>{if(!t){o("Invite token missing."),a(!1);return}(async()=>{try{const{data:b}=await We.get(`/admin/invite/${t}`),S=(b?.name||"").trim();let N="",_="";if(S){const A=S.split(" ");A.length===1?N=A[0]:(_=A.pop(),N=A.join(" "))}h(A=>({...A,first_name:N,last_name:_,email:b?.email||""})),o("")}catch(b){const S=b?.response?.data?.msg||b?.response?.data?.error||b?.message||"Invalid or expired link.";o(S)}finally{a(!1)}})()},[t]);const v=b=>h(S=>({...S,[b.target.name]:b.target.value})),y=["first_name","last_name","birthdate","citizenship","email","phone","ssn","address1","country","city","state","zip","password"],w=async b=>{b.preventDefault(),o(""),m("");for(const S of y)if(!String(f[S]||"").trim()){const N=S.replace(/_/g," ");o(`${N} is required`);return}try{const{data:S}=await We.post(`/admin/invite/${t}`,f);m(S?.msg||"Account created. Redirecting to login"),setTimeout(()=>r("/login"),900)}catch(S){const N=S?.response?.data?.msg||S?.response?.data?.error||S?.message||"Something went wrong.";o(N)}};return n?l.jsx("div",{className:"p-6 text-gray-600",children:"Loading invitation"}):l.jsx("div",{className:"max-w-5xl mx-auto p-6",children:l.jsxs("form",{onSubmit:w,className:"space-y-10",children:[l.jsxs("section",{className:"rounded-2xl border border-gray-200 bg-white shadow-sm",children:[l.jsx("div",{className:"flex items-start justify-between p-6 border-b",children:l.jsx("h2",{className:"text-xl font-semibold",children:"Personal Information"})}),l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"grid grid-cols-[96px_1fr] gap-6 items-start",children:[l.jsx("div",{className:"h-24 w-24 rounded-full bg-teal-500 text-white grid place-items-center text-3xl font-semibold",children:x}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsx(Vn,{label:"First Name",name:"first_name",value:f.first_name,onChange:v,required:!0}),l.jsx(Vn,{label:"Last Name",name:"last_name",value:f.last_name,onChange:v,required:!0}),l.jsx(Vn,{label:"Birthdate",name:"birthdate",value:f.birthdate,onChange:v,required:!0,placeholder:"MM/DD/YYYY"}),l.jsx(Vn,{label:"Citizenship",name:"citizenship",value:f.citizenship,onChange:v,required:!0,placeholder:"United States"}),l.jsx(Vn,{label:"Email",name:"email",type:"email",value:f.email,onChange:v,required:!0}),l.jsx(Vn,{label:"Phone",name:"phone",value:f.phone,onChange:v,required:!0}),l.jsx(Vn,{label:"SSN / Tax ID",name:"ssn",value:f.ssn,onChange:v,required:!0}),l.jsx(Vn,{label:"Emergency Contact (Phone Number)",name:"emergency_contact",value:f.emergency_contact,onChange:v,placeholder:"+1 555 0100"}),l.jsx("div",{className:"text-xs text-gray-500 self-end md:col-span-1",children:"SSN / Tax ID is an encrypted attribute"})]})]}),l.jsx("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 gap-6",children:l.jsx(Vn,{label:"Password",name:"password",type:"password",value:f.password,onChange:v,required:!0})})]})]}),l.jsxs("section",{className:"rounded-2xl border border-gray-200 bg-white shadow-sm",children:[l.jsx("div",{className:"p-6 border-b",children:l.jsx("h3",{className:"text-xl font-semibold",children:"Residential Address"})}),l.jsxs("div",{className:"p-6 grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsx("div",{className:"md:col-span-2",children:l.jsx(Vn,{label:"Street Address 1",name:"address1",value:f.address1,onChange:v,required:!0})}),l.jsx("div",{className:"md:col-span-2",children:l.jsx(Vn,{label:"Street Address 2 (Optional)",name:"address2",value:f.address2,onChange:v})}),l.jsx(Vn,{label:"Country",name:"country",value:f.country,onChange:v,required:!0}),l.jsx(Vn,{label:"City",name:"city",value:f.city,onChange:v,required:!0}),l.jsx(Vn,{label:"State / Province",name:"state",value:f.state,onChange:v,required:!0}),l.jsx(Vn,{label:"Zip / Postal Code",name:"zip",value:f.zip,onChange:v,required:!0})]})]}),i&&l.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 text-rose-700 px-4 py-3",children:i}),u&&l.jsx("div",{className:"rounded-xl border border-emerald-200 bg-emerald-50 text-emerald-700 px-4 py-3",children:u}),l.jsx("div",{children:l.jsx("button",{type:"submit",className:"inline-flex items-center justify-center rounded-xl bg-indigo-600 text-white font-medium px-6 py-3 shadow hover:brightness-110 active:scale-[0.99]",children:"Create Account"})})]})})}function Vn({label:e,name:t,value:r,onChange:n,required:a,type:i="text",placeholder:o=""}){return l.jsxs("div",{className:"space-y-1",children:[l.jsxs("label",{className:"block text-sm font-semibold text-gray-700",children:[e,a&&l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{name:t,type:i,value:r,onChange:n,placeholder:o,required:a,className:"w-full rounded-lg border px-3 py-2.5 bg-gray-50 focus:bg-white focus:outline-none focus:ring-4 focus:ring-indigo-100 border-gray-300"})]})}function q0e(e){return document.cookie.split("; ").find(t=>t.startsWith(e+"="))?.split("=")[1]||""}async function cC(e,t={}){const r=new Headers(t.headers||{});if(t.method&&t.method!=="GET"||t.forceXsrf){const n=q0e("XSRF-TOKEN");n&&r.set("X-XSRF-TOKEN",n)}return fetch(e,{...t,headers:r,credentials:"include"})}function V0e(){const e=es(),{token:t}=TI(),[r,n]=g.useState(!0),[a,i]=g.useState({email:"",name:""}),[o,u]=g.useState(""),[m,f]=g.useState(!1),[h,x]=g.useState({first_name:"",last_name:"",password:"",confirm:"",phone:"",address:"",company:"",country:"",state:"",city:"",tax_id:""}),[v,y]=g.useState(!1);g.useEffect(()=>{let N=!1;async function _(){n(!0),u("");try{const A=await cC(`/api/admin/invitations/${t}`,{method:"GET"}),k=await A.json();if(!A.ok||k.ok===!1)throw new Error(k.error||"Invalid or expired invitation.");if(!N&&(i({email:k.email,name:k.name||""}),k.name)){const C=k.name.trim().split(/\s+/);x(O=>({...O,first_name:C[0]||"",last_name:C.slice(1).join(" ")||"",company:k.name||""}))}}catch(A){N||u(A.message||"Unable to load invitation.")}finally{N||n(!1)}}return t&&_(),()=>{N=!0}},[t]);function w(N){const{name:_,value:A}=N.target;x(k=>({...k,[_]:A}))}function b(N){return N.length<8?"Password must be at least 8 characters.":/[A-Z]/.test(N)?/[a-z]/.test(N)?/[0-9]/.test(N)?"":"Password must include a number.":"Password must include a lowercase letter.":"Password must include an uppercase letter."}async function S(N){N.preventDefault(),u("");const _=["first_name","last_name","password","confirm"];for(const k of _)if(!h[k]){u("Please fill in all required fields.");return}const A=b(h.password);if(A)return u(A);if(h.password!==h.confirm)return u("Passwords do not match.");f(!0);try{const k=await cC(`/api/admin/invitations/${t}/accept`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({first_name:h.first_name.trim(),last_name:h.last_name.trim(),password:h.password,phone:h.phone.trim()||null,address:h.address.trim()||null,company:h.company.trim()||null,country:h.country.trim()||null,state:h.state.trim()||null,city:h.city.trim()||null,tax_id:h.tax_id.trim()||null})}),C=await k.json().catch(()=>({}));if(!k.ok||C.ok===!1)throw new Error(C.error||"Unable to accept invitation.");e("/login",{replace:!0,state:{flash:"Account created. Please log in."}})}catch(k){u(k.message||"Something went wrong.")}finally{f(!1)}}return r?l.jsx("div",{className:"p-6",children:l.jsx("div",{className:"mx-auto max-w-xl",children:l.jsx("div",{className:"animate-pulse h-24 rounded-2xl bg-gray-100"})})}):o?l.jsx("div",{className:"p-6",children:l.jsx("div",{className:"mx-auto max-w-xl rounded-2xl border border-red-200 bg-red-50 p-6",children:l.jsx("p",{className:"text-red-700 font-medium",children:o})})}):l.jsx("div",{className:"p-6",children:l.jsxs("div",{className:"mx-auto max-w-2xl",children:[l.jsxs("div",{className:"rounded-2xl bg-white shadow-sm ring-1 ring-black/5 p-6",children:[l.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Accept Admin Invitation"}),l.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Create your admin account. Youll be redirected to the login page after submitting."}),l.jsxs("form",{onSubmit:S,className:"mt-6 space-y-5",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-800",children:"Email"}),l.jsx("input",{value:a.email,disabled:!0,className:"mt-1 w-full rounded-xl border border-gray-200 bg-gray-100 px-4 py-2.5 text-gray-700"}),l.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Email is locked to the invited address."})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-800",children:"First name*"}),l.jsx("input",{name:"first_name",value:h.first_name,onChange:w,autoComplete:"given-name",className:"mt-1 w-full rounded-xl border border-gray-200 px-4 py-2.5 focus:ring-4 focus:ring-indigo-100 focus:border-indigo-400",placeholder:"Jane"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-800",children:"Last name*"}),l.jsx("input",{name:"last_name",value:h.last_name,onChange:w,autoComplete:"family-name",className:"mt-1 w-full rounded-xl border border-gray-200 px-4 py-2.5 focus:ring-4 focus:ring-indigo-100 focus:border-indigo-400",placeholder:"Doe"})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-800",children:"Password*"}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:v?"text":"password",name:"password",value:h.password,onChange:w,autoComplete:"new-password",className:"mt-1 w-full rounded-xl border border-gray-200 px-4 py-2.5 pr-12 focus:ring-4 focus:ring-indigo-100 focus:border-indigo-400"}),l.jsx("button",{type:"button",onClick:()=>y(N=>!N),className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-gray-500",children:v?"Hide":"Show"})]}),l.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"At least 8 chars incl. upper/lowercase and a number."})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-800",children:"Confirm password*"}),l.jsx("input",{type:"password",name:"confirm",value:h.confirm,onChange:w,autoComplete:"new-password",className:"mt-1 w-full rounded-xl border border-gray-200 px-4 py-2.5 focus:ring-4 focus:ring-indigo-100 focus:border-indigo-400"})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-800",children:"Phone"}),l.jsx("input",{name:"phone",value:h.phone,onChange:w,className:"mt-1 w-full rounded-xl border border-gray-200 px-4 py-2.5",placeholder:"+1 555 123 4567"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-800",children:"Company"}),l.jsx("input",{name:"company",value:h.company,onChange:w,className:"mt-1 w-full rounded-xl border border-gray-200 px-4 py-2.5",placeholder:"Acme Corp"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-800",children:"Address"}),l.jsx("input",{name:"address",value:h.address,onChange:w,className:"mt-1 w-full rounded-xl border border-gray-200 px-4 py-2.5",placeholder:"123 Main St, Suite 100"})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-800",children:"City"}),l.jsx("input",{name:"city",value:h.city,onChange:w,className:"mt-1 w-full rounded-xl border border-gray-200 px-4 py-2.5",placeholder:"City"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-800",children:"State/Province"}),l.jsx("input",{name:"state",value:h.state,onChange:w,className:"mt-1 w-full rounded-xl border border-gray-200 px-4 py-2.5",placeholder:"State"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-800",children:"Country"}),l.jsx("input",{name:"country",value:h.country,onChange:w,className:"mt-1 w-full rounded-xl border border-gray-200 px-4 py-2.5",placeholder:"Country"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-800",children:"Tax ID"}),l.jsx("input",{name:"tax_id",value:h.tax_id,onChange:w,className:"mt-1 w-full rounded-xl border border-gray-200 px-4 py-2.5",placeholder:"EIN / VAT / GST"})]}),o?l.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 p-3 text-red-700 text-sm",children:o}):null,l.jsx("div",{className:"pt-2",children:l.jsx("button",{type:"submit",disabled:m,className:"inline-flex items-center justify-center rounded-xl bg-indigo-600 px-5 py-2.5 font-medium text-white shadow-sm hover:bg-indigo-700 disabled:opacity-60 disabled:cursor-not-allowed",children:m?"Creating account":"Create admin account"})})]})]}),l.jsxs("p",{className:"mt-6 text-center text-sm text-gray-500",children:["Already have an account?"," ",l.jsx("button",{className:"text-indigo-600 hover:underline",onClick:()=>e("/login"),children:"Log in"})]})]})})}function K0e(e){return document.cookie.split("; ").find(t=>t.startsWith(e+"="))?.split("=")[1]||""}async function G0e(e,t={}){const r=new Headers(t.headers||{});if(t.method&&t.method!=="GET"||t.forceXsrf){const n=K0e("XSRF-TOKEN");n&&r.set("X-XSRF-TOKEN",n)}return fetch(e,{...t,headers:r,credentials:"include"})}function W0e(){const[e,t]=g.useState(""),[r,n]=g.useState(!1),[a,i]=g.useState(!1),[o,u]=g.useState("");async function m(x){i(!0),u("");try{const v=await G0e(`/api/auth/password/${x}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})}),y=await v.json().catch(()=>({}));if(!v.ok&&y?.error)throw new Error(y.error);n(!0),y?.sent===!1?u("We couldn't send the email right now. Try again in a moment."):u("If that email exists, weve sent a reset link.")}catch(v){u(v.message||"Something went wrong. Please try again.")}finally{i(!1)}}const f=x=>{x.preventDefault(),e&&m("forgot")},h=()=>m("resend");return l.jsx("div",{className:"min-h-screen grid place-items-center bg-emerald-500/10 p-6",children:l.jsxs("div",{className:"w-full max-w-xl rounded-2xl bg-white p-8 shadow",children:[l.jsx("h1",{className:"text-2xl font-semibold mb-2",children:"Forgot password"}),r?l.jsxs("div",{className:"space-y-4",children:[l.jsx("p",{className:"text-sm",children:o||"If that email exists, weve sent a reset link."}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:h,disabled:a,className:"rounded-lg border px-3 py-2 text-sm hover:bg-gray-50 disabled:opacity-60",children:a?"Resending...":"Didnt get it? Resend"}),l.jsx("button",{onClick:()=>n(!1),className:"text-sm text-emerald-700 hover:underline",children:"Use a different email"})]})]}):l.jsxs("form",{onSubmit:f,className:"space-y-4",children:[l.jsx("input",{type:"email",required:!0,value:e,onChange:x=>t(x.target.value),className:"w-full rounded-xl border px-4 py-2",placeholder:"you@example.com"}),l.jsx("button",{disabled:a,className:"w-full rounded-xl bg-emerald-600 text-white py-2",children:a?"Sending...":"Send reset link"})]})]})})}function X0e(e){return document.cookie.split("; ").find(t=>t.startsWith(e+"="))?.split("=")[1]||""}async function uC(e,t={}){const r=new Headers(t.headers||{});if(t.method&&t.method!=="GET"||t.forceXsrf){const n=X0e("XSRF-TOKEN");n&&r.set("X-XSRF-TOKEN",n)}return fetch(e,{...t,headers:r,credentials:"include"})}function Y0e(){const[e]=AC(),t=g.useMemo(()=>e.get("token")||"",[e]),[r,n]=g.useState("set"),[a,i]=g.useState(""),[o,u]=g.useState(""),[m,f]=g.useState(""),[h,x]=g.useState(""),[v,y]=g.useState(!1);g.useEffect(()=>{t||x("Invalid or missing reset link.")},[t]);async function w(S){if(S.preventDefault(),!!t){if(a!==o||a.length<8){x("Passwords must match and be at least 8 characters.");return}try{y(!0),x("");const N=await uC("/api/auth/password/set",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:t,password:a})}),_=await N.json().catch(()=>({}));N.ok&&_.ok?(n("verify"),x(_.phone_mask?`We sent a 6-digit code to ${_.phone_mask}.`:"We sent a 6-digit code to your phone.")):x(_.error||"Unable to proceed.")}catch{x("Network error. Please try again.")}finally{y(!1)}}}async function b(S){if(S.preventDefault(),!!t){if(!/^\d{6}$/.test(m)){x("Please enter the 6-digit code.");return}try{y(!0),x("");const N=await uC("/api/auth/password/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:t,code:m})}),_=await N.json().catch(()=>({}));N.ok&&_.ok?(n("done"),x("Password reset complete. You can now log in.")):x(_.error||"Verification failed.")}catch{x("Network error. Please try again.")}finally{y(!1)}}}return t?l.jsx("div",{className:"min-h-[60vh] flex items-center justify-center px-4",children:l.jsxs("div",{className:"w-full max-w-md mx-auto p-8 bg-white rounded-2xl shadow",children:[l.jsx("h1",{className:"text-2xl font-semibold mb-4",children:"Reset password"}),h&&l.jsx("div",{className:"mb-4 text-sm text-amber-700",children:h}),r==="set"&&l.jsxs("form",{onSubmit:w,className:"space-y-4",children:[l.jsx("input",{type:"password",className:"w-full rounded-xl border px-4 py-2",placeholder:"New password",value:a,onChange:S=>i(S.target.value),autoFocus:!0}),l.jsx("input",{type:"password",className:"w-full rounded-xl border px-4 py-2",placeholder:"Confirm password",value:o,onChange:S=>u(S.target.value)}),l.jsx("button",{className:"w-full rounded-xl bg-emerald-600 text-white py-2 disabled:opacity-60",disabled:v,children:v?"Sending code":"Continue"})]}),r==="verify"&&l.jsxs("form",{onSubmit:b,className:"space-y-4",children:[l.jsx("input",{inputMode:"numeric",pattern:"\\d{6}",maxLength:6,className:"w-full rounded-xl border px-4 py-2 tracking-widest text-center",placeholder:"Enter 6-digit code",value:m,onChange:S=>f(S.target.value.replace(/\D/g,"")),autoFocus:!0}),l.jsx("button",{className:"w-full rounded-xl bg-emerald-600 text-white py-2 disabled:opacity-60",disabled:v,children:v?"Verifying":"Verify & Finish"})]}),r==="done"&&l.jsxs("div",{className:"space-y-3",children:[l.jsx("p",{children:"Your password has been updated."}),l.jsx(Hm,{to:"/login",className:"text-emerald-700 underline",children:"Return to login"})]})]})}):l.jsx("div",{className:"p-6 text-center",children:h})}function Z0e({onSubmit:e,loading:t}){const[r,n]=g.useState(""),[a,i]=g.useState(""),o=u=>{u.preventDefault();const m=r.trim(),f=a.trim();!m||!f||e({name:m,email:f})};return l.jsxs("form",{onSubmit:o,className:"mt-3 space-y-2 rounded-2xl border border-violet-100 bg-violet-50/80 px-3 py-3 text-sm",children:[l.jsx("div",{className:"font-semibold text-violet-800 mb-1",children:"Dependent account details"}),l.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[l.jsx("input",{type:"text",className:"w-full rounded-md border border-gray-300 px-2 py-1 text-sm",placeholder:"Dependent full name",value:r,onChange:u=>n(u.target.value)}),l.jsx("input",{type:"email",className:"w-full rounded-md border border-gray-300 px-2 py-1 text-sm",placeholder:"Dependent email address",value:a,onChange:u=>i(u.target.value)})]}),l.jsx("button",{type:"submit",disabled:t,className:"mt-1 inline-flex items-center justify-center rounded-md bg-violet-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-violet-700 disabled:opacity-60",children:t?"Sending...":"Send dependent request"})]})}function Q0e({onSubmit:e,loading:t}){const[r,n]=g.useState([{name:"",email:""}]),a=(m,f,h)=>{n(x=>x.map((v,y)=>y===m?{...v,[f]:h}:v))},i=()=>n(m=>[...m,{name:"",email:""}]),o=m=>n(f=>f.filter((h,x)=>x!==m)),u=m=>{m.preventDefault();const f=r.map(h=>({name:h.name.trim(),email:h.email.trim()})).filter(h=>h.name&&h.email);f.length&&e(f)};return l.jsxs("form",{onSubmit:u,className:"mt-3 space-y-2 rounded-2xl border border-violet-100 bg-violet-50/80 px-3 py-3 text-sm",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("div",{className:"font-semibold text-violet-800",children:"Group members (name + email)"}),l.jsx("button",{type:"button",onClick:i,className:"text-xs text-violet-700 hover:underline",children:"+ Add member"})]}),l.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto pr-1",children:r.map((m,f)=>l.jsxs("div",{className:"grid grid-cols-[1fr,1fr,auto] gap-2",children:[l.jsx("input",{type:"text",className:"rounded-md border border-gray-300 px-2 py-1 text-xs",placeholder:"Full name",value:m.name,onChange:h=>a(f,"name",h.target.value)}),l.jsx("input",{type:"email",className:"rounded-md border border-gray-300 px-2 py-1 text-xs",placeholder:"Email address",value:m.email,onChange:h=>a(f,"email",h.target.value)}),r.length>1&&l.jsx("button",{type:"button",onClick:()=>o(f),className:"text-[10px] text-red-500 hover:underline self-center",children:"Remove"})]},f))}),l.jsx("button",{type:"submit",disabled:t,className:"mt-1 inline-flex items-center justify-center rounded-md bg-violet-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-violet-700 disabled:opacity-60",children:t?"Sending...":"Send group request"})]})}function J0e({apiBase:e="/api",authBase:t="/auth",brand:r="Clarus AI",defaultOpen:n=!1,autoSendOnFinal:a=!1,lang:i="en-US",ttsDefaultEnabled:o=!0}){const[u,m]=g.useState(n),[f,h]=g.useState(!1),[x,v]=g.useState([]),[y,w]=g.useState({user:null,investor:null,ready:!1,error:null}),[b,S]=g.useState(null),N=g.useRef(null),_=g.useRef(null);g.useEffect(()=>{let oe=!0;return(async()=>{try{const{data:ke}=await We.get(`${t}/me`,{headers:{Accept:"application/json"}});if(!oe)return;if(!ke?.ok){w({user:null,investor:null,ready:!0,error:"Auth error"});return}w({user:ke.user||null,investor:ke.investor||null,ready:!0,error:null})}catch{if(!oe)return;w({user:null,investor:null,ready:!0,error:"Cannot reach /auth/me"})}})(),()=>{oe=!1}},[t]);const A=g.useMemo(()=>{const oe=y?.investor??{},ke=y?.user??{},Ge=Ze=>String(Ze??"").trim().toLowerCase(),Fe=Ze=>Ze===!0||Ze===1||Ze==="1"||Ge(Ze)==="true"||Ge(Ze)==="yes",Be=Ge(oe.investor_type)||Ge(oe.type)||Ge(ke.investor_type)||Ge(ke.type),xt=oe.parent_investor_id!=null||oe.parent_id!=null||ke.parent_investor_id!=null||ke.parent_id!=null||oe.dependent_parent_id!=null;return Be==="depends"||Be==="dependent"||Be==="dependant"||Fe(oe.is_dependent)||Fe(ke.is_dependent)||xt},[y]),k=!y.ready||A;function C(){try{const oe="clarus_cid_global";let ke=localStorage.getItem(oe);return ke||(ke=crypto.randomUUID?crypto.randomUUID():Math.random().toString(36).slice(2)),localStorage.setItem(oe,ke),ke}catch{return Math.random().toString(36).slice(2)}}const O=typeof window<"u"&&(window.SpeechRecognition||window.webkitSpeechRecognition),T=!!O,z=g.useRef(null),[P,Z]=g.useState(!1),[q,B]=g.useState(""),fe=typeof window<"u"?window.speechSynthesis:void 0,Ne=!!fe,[he,K]=g.useState(o&&Ne),[H,be]=g.useState([]),[te,I]=g.useState(!1),se=g.useRef(null);g.useEffect(()=>{if(!Ne)return;function oe(){const ke=fe.getVoices();ke&&ke.length&&be(ke)}return oe(),window.speechSynthesis.onvoiceschanged=oe,()=>{window.speechSynthesis.onvoiceschanged=null}},[Ne,fe]);const R=g.useMemo(()=>H.length?H.find(ke=>/en/i.test(ke.lang))||H[0]:null,[H]);function W(oe){if(!(!he||!Ne||!oe))try{fe.cancel(),I(!1);const ke=new SpeechSynthesisUtterance(oe);se.current=ke,ke.lang=R?.lang||"en-US",ke.voice=R||null,ke.rate=1,ke.pitch=1,ke.volume=1,ke.onstart=()=>I(!0),ke.onend=()=>I(!1),ke.onerror=()=>I(!1),fe.speak(ke)}catch{}}g.useEffect(()=>{if(!he||!Ne||x.length===0)return;const oe=x[x.length-1];if(oe.role==="assistant"){const ke=(oe.content||"").replace(/\*\*/g,"").replace(/<br\s*\/?>/gi,`
`);W(ke)}},[x,he,Ne]),g.useEffect(()=>{Ne&&(u||(fe.cancel(),I(!1)))},[u,fe,Ne]),g.useEffect(()=>{_.current&&(_.current.scrollTop=_.current.scrollHeight)},[x,f,u]);async function Y(oe){const ke=oe.target.closest('a[data-chat-dl="1"]');if(!ke)return;oe.preventDefault();const Ge=ke.getAttribute("href");let Fe="";try{const Be=new URL(Ge,window.location.origin);Fe=Be.searchParams.get("filename")||Be.searchParams.get("fn")||""}catch{}try{const Be=await We.get(Ge,{responseType:"blob"}),xt=Be.data,ht=(Be.headers["content-disposition"]||"").match(/filename\*?=(?:UTF-8''|")(.*?)(?:\"|;|$)/i),At=Fe||(Ge.split("/").pop()||"download").split("?")[0],De=ht?decodeURIComponent(ht[1]):At,Xe=document.createElement("a");Xe.href=URL.createObjectURL(xt),Xe.download=De,document.body.appendChild(Xe),Xe.click(),URL.revokeObjectURL(Xe.href),Xe.remove()}catch(Be){console.error(Be),v(xt=>[...xt,{role:"assistant",content:"Sorrycouldnt download that file."}])}}const Q=oe=>(oe||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");function L(oe){let ke=Q(oe||"");return ke=ke.replace(/\[([^\]]+)\]\(((?:https?:\/\/|\/)[^) \t\r\n]+)\)/g,(Ge,Fe,Be)=>{const Ze=/download/i.test(Fe)?' data-chat-dl="1"':"";return`<a href="${Be}"${Ze} class="text-violet-600 hover:underline" target="_blank" rel="noopener noreferrer">${Q(Fe)}</a>`}),ke=ke.replace(/((?:https?:\/\/|\/)[^\s<>"'()]+)(?=[\s)<]|$)/g,Ge=>`<a href="${Ge}" data-chat-dl="1" class="text-violet-600 hover:underline" target="_blank" rel="noopener noreferrer">${Ge}</a>`),ke=ke.replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>"),ke=ke.replace(/\n/g,"<br/>"),ke}async function ne(oe){const ke=(oe||"").trim();if(!ke)return;if(Ne&&(fe.cancel(),I(!1)),v(Ze=>[...Ze,{role:"user",content:ke}]),h(!0),/^(\s*(hi|hello|hey|hola|howdy|yo|good\s+(morning|afternoon|evening))\b[!.]?\s*)$/i.test(ke)){const ht=`Hello ${y?.user?.first_name&&y.user.first_name.trim()||y?.user?.username&&String(y.user.username)||y?.user?.email&&String(y.user.email).split("@")[0]||y?.investor?.name&&String(y.investor.name)||"there"}! How can I assist you?`;v(At=>[...At,{role:"assistant",content:ht}]),h(!1);return}const Fe=C(),Be=y.user?{id:y.user.id??null,email:y.user.email??null,username:y.user.username??null,name:y.user.name??null,first_name:y.user.first_name??null,last_name:y.user.last_name??null,user_type:y.user.user_type??"Investor"}:{user_type:"Investor"},xt=y.investor?{investor_id:y.investor.id??null,investor_name:y.investor.name??null}:{};try{const{data:Ze}=await We.post(`${e}/chat`,{message:ke,conversation_id:Fe,user:Be,...xt}),ht=G(Ze);v(At=>[...At,ht])}catch(Ze){const ht=Ze?.response?.data?.error||Ze?.response?.data?.message||Ze?.message||"Sorryserver unavailable right now.";v(At=>[...At,{role:"assistant",content:ht}])}finally{h(!1)}}async function ge(oe){oe&&oe.preventDefault();const ke=(N.current?.value||"").trim();if(!ke)return;const Ge=ke.toLowerCase();Ge.includes("group account")?S("group"):Ge.includes("dependent account")||Ge.includes("depends account")?S("dependent"):S(null),N.current&&(N.current.value=""),await ne(ke)}function G(oe){if(oe?.answer)return{role:"assistant",content:oe.answer};if(oe?.type==="db")return{role:"assistant",content:oe.answer||"(No response)"};if(oe?.type==="metric"){const ke=typeof oe.value=="number"?new Intl.NumberFormat().format(oe.value):oe.value,Ge=(oe.metric||"").replace(/_/g," "),Fe=oe.period?`
Period: ${oe.period}`:"";return{role:"assistant",content:`**${Ge}**: ${ke}${Fe}
${oe.note||""}`}}return oe?.type==="explanation"||oe?.type==="nlp"?{role:"assistant",content:oe.answer||""}:oe?.error||oe?.message?{role:"assistant",content:oe.error||oe.message}:{role:"assistant",content:"(No response)"}}const ue=O,Se=()=>{if(B(""),!ue){B("Voice input not supported in this browser.");return}if(!P)try{const oe=new ue;z.current=oe,oe.lang=i,oe.interimResults=!0,oe.continuous=!1;let ke="";oe.onstart=()=>Z(!0),oe.onresult=Ge=>{let Fe="";for(let Be=Ge.resultIndex;Be<Ge.results.length;Be++){const xt=Ge.results[Be][0].transcript;Ge.results[Be].isFinal?ke+=xt+" ":Fe+=xt}if(N.current){const Be=N.current.dataset.base||N.current.value;N.current.dataset.base||(N.current.dataset.base=Be),N.current.value=(Be+" "+Fe).trim()}},oe.onerror=Ge=>{B(Ge.error||"Voice input error"),Z(!1)},oe.onend=()=>{if(Z(!1),N.current?.dataset?.base&&delete N.current.dataset.base,ke.trim()){if(a)N.current&&(N.current.value=ke.trim()),ge();else if(N.current){const Ge=N.current.value||"";N.current.value=(Ge+" "+ke).trim(),N.current.focus()}}},oe.start()}catch(oe){B(oe.message||"Failed to start voice input"),Z(!1)}},M=async({name:oe,email:ke})=>{const Ge=`${oe}, ${ke}`;await ne(Ge),S(null)},Qe=async oe=>{const ke=(oe||[]).filter(Fe=>Fe.name&&Fe.email);if(!ke.length)return;const Ge=ke.map(Fe=>`${Fe.name}, ${Fe.email}`).join(`
`);await ne(Ge),S(null)};if(k)return null;const xe=({className:oe=""})=>l.jsx("svg",{viewBox:"0 0 20 20",className:oe,xmlns:"http://www.w3.org/2000/svg",children:l.jsx("g",{transform:"translate(-25.414562,-111.28127)",children:l.jsx("path",{d:"m 35.412312,115.5918 c -1.442046,0 -2.880739,0.49168 -4.052401,1.4748 -0.705182,0.59173 -1.2502,1.31171 -1.628713,2.10012 -0.05253,-0.005 -0.103652,-0.0164 -0.157588,-0.0164 -0.941869,0 -1.70024,0.75836 -1.70024,1.70021 v 2.10134 c 0,0.94184 0.758371,1.70021 1.70024,1.70021 0.05394,0 0.105059,-0.0117 0.157588,-0.0164 0.06777,0.14047 0.137889,0.27991 0.216918,0.41689 0.308938,0.55139 1.134304,0.0793 0.815588,-0.46655 -1.304955,-2.26029 -0.799571,-5.12447 1.199708,-6.80208 1.999326,-1.67765 4.903352,-1.67765 6.902655,0 1.999326,1.67761 2.50471,4.54174 1.199732,6.80208 l -0.01407,0.0234 -0.0094,0.0234 c 0,0 -0.633799,1.40211 -1.878344,1.40211 l -1.575387,-0.0141 c -0.147739,-0.21575 -0.384191,-0.366 -0.666512,-0.366 h -1.015533 c -0.45534,0 -0.821638,0.36752 -0.821638,0.82286 0,0.28087 0.178225,0.49415 0.586056,0.49415 l 3.493009,2.8e-4 c 1.867604,0 2.675336,-1.8335 2.712107,-1.91835 v -0.005 c 0.07832,-0.13578 0.147269,-0.27521 0.214572,-0.41444 0.05488,0.005 0.108342,0.0164 0.164858,0.0164 0.941869,0 1.700237,-0.75836 1.700237,-1.70021 v -2.10134 c 0,-0.94184 -0.75837,-1.70021 -1.700237,-1.70021 -0.05441,0 -0.105762,0.009 -0.158761,0.0164 -0.377627,-0.78846 -0.921023,-1.50837 -1.6263,-2.10014 -1.171614,-0.98312 -2.616355,-1.47481 -4.058451,-1.47481 z m -2.049205,2.98718 c -0.366019,-0.0239 -0.700354,0.0535 -0.992502,0.36114 -0.779049,0.82018 -1.260325,1.9365 -1.260325,3.12533 0,0.98061 0.327722,2.07941 0.879793,2.11951 0.786511,0.0572 2.027657,-0.45928 3.424676,-0.45928 1.480437,0 2.786843,0.57951 3.561606,0.44232 0.469528,-0.083 0.744064,-1.20536 0.744064,-2.10255 0,-1.18883 -0.482452,-2.30515 -1.261524,-3.12533 -0.779054,-0.82021 -1.855342,0 -3.044146,0 -0.743006,0 -1.441646,-0.32109 -2.051642,-0.36114 z m -0.174473,2.02134 c 0.434305,1.7e-4 0.786345,0.35219 0.786486,0.78651 -1.41e-4,0.43431 -0.352181,0.78633 -0.786486,0.78649 -0.434304,-1.6e-4 -0.786345,-0.35218 -0.786485,-0.78649 1.4e-4,-0.43432 0.352181,-0.78634 0.786485,-0.78651 z m 4.452304,0 c 0.434329,1.7e-4 0.786345,0.35219 0.786509,0.78651 -1.66e-4,0.43431 -0.35218,0.78633 -0.786509,0.78649 -0.434304,-1.6e-4 -0.786321,-0.35218 -0.786485,-0.78649 1.64e-4,-0.43432 0.352181,-0.78634 0.786485,-0.78651 z",fill:"currentColor",fillRule:"evenodd"})})}),me=({className:oe=""})=>l.jsx("svg",{viewBox:"0 0 24 24",className:`h-5 w-5 ${oe}`,children:l.jsx("path",{d:"M6 6l12 12M18 6L6 18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})}),ze=({active:oe})=>l.jsx("svg",{viewBox:"0 0 24 24",className:`h-5 w-5 ${oe?"text-rose-600":""}`,children:l.jsx("path",{fill:"currentColor",d:"M12 14a3 3 0 0 0 3-3V6a3 3 0 1 0-6 0v5a3 3 0 0 0 3 3Zm6-3a6 6 0 0 1-12 0H4a8 8 0 0 0 7 7.93V21h2v-2.07A8 8 0 0 0 20 11h-2Z"})});return l.jsxs("div",{className:"fixed bottom-6 right-6 z-50",children:[l.jsx("button",{onClick:()=>m(!u),className:"group rounded-full shadow-2xl bg-gradient-to-r from-violet-600 to-indigo-600 text-white h-14 w-14 flex items-center justify-center hover:from-violet-500 hover:to-indigo-500 transition transform hover:scale-[1.03]","aria-label":u?"Close chatbot":"Open financial chatbot",children:u?l.jsx(me,{className:"group-hover:rotate-90 transition-transform"}):l.jsx(xe,{className:"h-10 w-10 group-hover:scale-110 transition-transform"})}),u&&l.jsxs("div",{className:"mt-3 w-[420px] max-h-[78vh] rounded-3xl overflow-hidden shadow-[0_20px_70px_rgba(0,0,0,0.25)] border border-white/20 bg-white/80 backdrop-blur-xl",children:[l.jsx("div",{className:"relative h-16 bg-gradient-to-r from-violet-600 via-indigo-600 to-fuchsia-600",children:l.jsxs("div",{className:"absolute inset-0 px-4 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3 text-white",children:[l.jsx("div",{className:"h-9 w-9 rounded-xl bg-white/20 flex items-center justify-center ring-1 ring-white/30",children:l.jsx(xe,{className:"h-6 w-6 text-white"})}),l.jsxs("div",{className:"leading-tight",children:[l.jsx("div",{className:"font-semibold text-[15px]",children:r}),l.jsxs("div",{className:"text-[12px] flex items-center gap-1 opacity-90",children:[l.jsx("span",{className:"inline-block h-2.5 w-2.5 rounded-full bg-emerald-400 shadow-[0_0_0_2px_rgba(255,255,255,0.35)]"}),"Online"]})]})]}),l.jsx("button",{type:"button",onClick:()=>K(!he),className:"text-white/90 hover:text-white bg-white/10 hover:bg-white/15 border border-white/20 rounded-xl px-3 py-1.5 text-xs",title:he?"Turn voice off":"Turn voice on",children:he?"Voice On":"Voice Off"})]})}),l.jsxs("div",{ref:_,onClick:Y,className:"flex-1 max-h-[52vh] overflow-y-auto px-4 py-4 space-y-4 bg-gradient-to-b from-white/60 to-white",children:[y.error&&l.jsxs("div",{className:"text-amber-700 bg-amber-50 border border-amber-200 text-sm rounded-lg p-2",children:[y.error,". You may need to log in again."]}),x.map((oe,ke)=>l.jsxs("div",{className:"flex flex-col gap-1",children:[l.jsx("div",{className:"text-[11px] text-gray-400 pl-1",children:oe.role==="user"?"You":r}),l.jsx("div",{className:`flex ${oe.role==="user"?"justify-end":"justify-start"}`,children:l.jsx("div",{className:`max-w-[78%] leading-relaxed text-[15px] ${oe.role==="user"?"bg-gradient-to-r from-violet-600 to-indigo-600 text-white shadow-md rounded-2xl rounded-br-md":"bg-white border border-gray-100 text-gray-800 shadow-sm rounded-2xl rounded-bl-md"} px-4 py-2.5`,dangerouslySetInnerHTML:{__html:L(oe.content||"")}})})]},ke)),f&&l.jsxs("div",{className:"flex items-center gap-2 text-gray-500 pl-1",children:[l.jsx("div",{className:"h-2 w-2 rounded-full bg-gray-400 animate-bounce"}),l.jsx("div",{className:"h-2 w-2 rounded-full bg-gray-300 animate-bounce [animation-delay:150ms]"}),l.jsx("div",{className:"h-2 w-2 rounded-full bg-gray-200 animate-bounce [animation-delay:300ms]"})]}),b==="dependent"&&l.jsx(Z0e,{onSubmit:M,loading:f}),b==="group"&&l.jsx(Q0e,{onSubmit:Qe,loading:f})]}),l.jsxs("form",{onSubmit:ge,className:"border-t border-gray-100 bg-white/80 backdrop-blur px-3 py-3",children:[l.jsxs("div",{className:"flex items-center gap-2 rounded-2xl border border-gray-200 bg-white px-3 py-2 shadow-sm focus-within:ring-2 focus-within:ring-violet-300",children:[l.jsx("input",{ref:N,className:"flex-1 outline-none text-[15px] placeholder-gray-400",placeholder:P?"Listening":"Type or use the mic to speak",autoComplete:"off"}),l.jsx("button",{type:"button",onClick:Se,disabled:!T,className:`relative shrink-0 inline-flex items-center justify-center rounded-xl px-2.5 py-2 text-sm border
                  ${P?"border-rose-200 text-rose-600 bg-rose-50":"border-gray-200 text-gray-700 hover:bg-gray-50"} disabled:opacity-50`,title:T?"Speak your question":"Voice input not supported",children:l.jsx(ze,{active:P})}),l.jsxs("button",{type:"submit",className:"shrink-0 inline-flex items-center gap-2 rounded-xl px-3 py-2 text-sm text-white bg-gradient-to-r from-violet-600 to-indigo-600 hover:from-violet-500 hover:to-indigo-500 transition shadow-md",children:[l.jsx("svg",{viewBox:"0 0 24 24",className:"h-5 w-5",children:l.jsx("path",{fill:"currentColor",d:"M3.4 20.6 22 12 3.4 3.4 3 10l12 2-12 2z"})}),"Send"]})]}),q&&l.jsx("div",{className:"pt-2 text-xs text-rose-600",children:q})]}),l.jsx("div",{className:"px-5 py-2 text-[11px] text-gray-400 bg-white/70",children:"Secure  Scoped answers for the logged-in investor"})]})]})}function Mb(e){return(e||"").toString().replace(/\s+/g,"").toLowerCase()}function ehe(){const{user:e}=tn.useContext(Di),t=Ua();return e===void 0?l.jsx("div",{children:"Loading..."}):e===null?l.jsx(ni,{to:"/login",replace:!0,state:{from:t}}):l.jsx(my,{})}function fy({role:e}){const{user:t}=tn.useContext(Di),r=Ua();if(t===void 0)return l.jsx("div",{children:"Loading..."});if(t===null)return l.jsx(ni,{to:"/login",replace:!0,state:{from:r}});const n=Mb(t.user_type),a=Mb(e);return a==="investor"&&n==="groupadmin"?l.jsx(my,{}):n!==a?n==="admin"?l.jsx(ni,{to:"/admin-dashboard",replace:!0}):n==="groupadmin"?l.jsx(ni,{to:"/investor-dashboard",replace:!0}):l.jsx(ni,{to:"/investor-dashboard",replace:!0}):l.jsx(my,{})}function the(){const{user:e}=tn.useContext(Di),t=Ua(),r=e?.user_type||"",n=Mb(r),[a,i]=tn.useState(()=>(typeof window<"u"?window.__INVESTOR__:null)||null);tn.useEffect(()=>{let w=!1;async function b(){if(!e||n!=="investor"){i(null);return}if(window.__INVESTOR__){i(window.__INVESTOR__);return}try{const{data:S}=await We.get("/api/investor/me");w||(i(S||null),window.__INVESTOR__=S||null)}catch{w||i(null)}}return b(),()=>{w=!0}},[e?.id,n]);const o=tn.useMemo(()=>a?(a.investor_type||"").toLowerCase().startsWith("depend")||a.parent_investor_id!=null:!1,[a]),m=tn.useMemo(()=>new Set(["/login","/invite/accept","/accept-invite","/admin/generalpartner","/forgot-password","/reset-password"]),[]).has(t.pathname),f=t.pathname.startsWith("/invite/admin/"),x=!!e&&!(m||f)&&!(n==="investor"&&o);function v(){return e===void 0?l.jsx("div",{children:"Loading..."}):e===null?l.jsx(rB,{}):n==="admin"?l.jsx(ni,{to:"/admin-dashboard",replace:!0}):n==="groupadmin"||n==="investor"?l.jsx(ni,{to:"/investor-dashboard",replace:!0}):l.jsx(ni,{to:"/investor-dashboard",replace:!0})}function y(){return e===void 0?l.jsx("div",{children:"Loading..."}):e?n==="admin"?l.jsx(ni,{to:"/admin-dashboard",replace:!0}):n==="groupadmin"||n==="investor"?l.jsx(ni,{to:"/investor-dashboard",replace:!0}):l.jsx(ni,{to:"/investor-dashboard",replace:!0}):l.jsx(ni,{to:"/login",replace:!0})}return l.jsxs(l.Fragment,{children:[l.jsxs(HI,{children:[l.jsx(dn,{path:"/login",element:l.jsx(v,{})}),l.jsx(dn,{path:"/invite/accept",element:l.jsx(oC,{})}),l.jsx(dn,{path:"/accept-invite",element:l.jsx(oC,{})}),l.jsx(dn,{path:"/invite/admin/:token",element:l.jsx(V0e,{})}),l.jsx(dn,{path:"/forgot-password",element:l.jsx(W0e,{})}),l.jsx(dn,{path:"/reset-password",element:l.jsx(Y0e,{})}),l.jsx(dn,{path:"/admin/generalpartner",element:l.jsx(H0e,{})}),l.jsx(dn,{element:l.jsx(ehe,{}),children:l.jsx(dn,{path:"/dashboard",element:l.jsx(y,{})})}),l.jsxs(dn,{element:l.jsx(fy,{role:"admin"}),children:[l.jsx(dn,{path:"/admin-dashboard",element:l.jsx(m0e,{})}),l.jsx(dn,{path:"/admin/opportunity",element:l.jsx($0e,{})})]}),l.jsx(dn,{element:l.jsx(fy,{role:"groupadmin"}),children:l.jsx(dn,{path:"/group-admin-dashboard",element:l.jsx(O0e,{})})}),l.jsx(dn,{element:l.jsx(fy,{role:"investor"}),children:l.jsx(dn,{path:"/investor-dashboard",element:l.jsx(F0e,{})})}),l.jsx(dn,{path:"*",element:l.jsx(y,{})})]}),x&&l.jsx(J0e,{user:window.__PORTAL_USER__,investor:window.__INVESTOR__,tenant:"default",ttsDefaultEnabled:!1,autoSendOnFinal:!0,defaultOpen:!0,apiBase:"/api"})]})}YF.createRoot(document.getElementById("root")).render(l.jsx(tn.StrictMode,{children:l.jsx(hL,{children:l.jsx(tB,{children:l.jsx(the,{})})})}));
