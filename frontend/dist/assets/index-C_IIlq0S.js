(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();function Ga(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Xv={exports:{}},rf={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ZN;function LF(){if(ZN)return rf;ZN=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(n,a,i){var l=null;if(i!==void 0&&(l=""+i),a.key!==void 0&&(l=""+a.key),"key"in a){i={};for(var u in a)u!=="key"&&(i[u]=a[u])}else i=a;return a=i.ref,{$$typeof:e,type:n,key:l,ref:a!==void 0?a:null,props:i}}return rf.Fragment=t,rf.jsx=r,rf.jsxs=r,rf}var QN;function BF(){return QN||(QN=1,Xv.exports=LF()),Xv.exports}var c=BF(),Zv={exports:{}},mt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var JN;function UF(){if(JN)return mt;JN=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),p=Symbol.iterator;function v(z){return z===null||typeof z!="object"?null:(z=p&&z[p]||z["@@iterator"],typeof z=="function"?z:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,b={};function S(z,Y,P){this.props=z,this.context=Y,this.refs=b,this.updater=P||g}S.prototype.isReactComponent={},S.prototype.setState=function(z,Y){if(typeof z!="object"&&typeof z!="function"&&z!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,z,Y,"setState")},S.prototype.forceUpdate=function(z){this.updater.enqueueForceUpdate(this,z,"forceUpdate")};function j(){}j.prototype=S.prototype;function _(z,Y,P){this.props=z,this.context=Y,this.refs=b,this.updater=P||g}var A=_.prototype=new j;A.constructor=_,w(A,S.prototype),A.isPureReactComponent=!0;var k=Array.isArray,O={H:null,A:null,T:null,S:null,V:null},C=Object.prototype.hasOwnProperty;function T(z,Y,P,q,G,Z){return P=Z.ref,{$$typeof:e,type:z,key:Y,ref:P!==void 0?P:null,props:Z}}function I(z,Y){return T(z.type,Y,void 0,void 0,void 0,z.props)}function M(z){return typeof z=="object"&&z!==null&&z.$$typeof===e}function W(z){var Y={"=":"=0",":":"=2"};return"$"+z.replace(/[=:]/g,function(P){return Y[P]})}var U=/\/+/g;function F(z,Y){return typeof z=="object"&&z!==null&&z.key!=null?W(""+z.key):Y.toString(36)}function oe(){}function je(z){switch(z.status){case"fulfilled":return z.value;case"rejected":throw z.reason;default:switch(typeof z.status=="string"?z.then(oe,oe):(z.status="pending",z.then(function(Y){z.status==="pending"&&(z.status="fulfilled",z.value=Y)},function(Y){z.status==="pending"&&(z.status="rejected",z.reason=Y)})),z.status){case"fulfilled":return z.value;case"rejected":throw z.reason}}throw z}function ue(z,Y,P,q,G){var Z=typeof z;(Z==="undefined"||Z==="boolean")&&(z=null);var fe=!1;if(z===null)fe=!0;else switch(Z){case"bigint":case"string":case"number":fe=!0;break;case"object":switch(z.$$typeof){case e:case t:fe=!0;break;case m:return fe=z._init,ue(fe(z._payload),Y,P,q,G)}}if(fe)return G=G(z),fe=q===""?"."+F(z,0):q,k(G)?(P="",fe!=null&&(P=fe.replace(U,"$&/")+"/"),ue(G,Y,P,"",function(re){return re})):G!=null&&(M(G)&&(G=I(G,P+(G.key==null||z&&z.key===G.key?"":(""+G.key).replace(U,"$&/")+"/")+fe)),Y.push(G)),1;fe=0;var Oe=q===""?".":q+":";if(k(z))for(var Re=0;Re<z.length;Re++)q=z[Re],Z=Oe+F(q,Re),fe+=ue(q,Y,P,Z,G);else if(Re=v(z),typeof Re=="function")for(z=Re.call(z),Re=0;!(q=z.next()).done;)q=q.value,Z=Oe+F(q,Re++),fe+=ue(q,Y,P,Z,G);else if(Z==="object"){if(typeof z.then=="function")return ue(je(z),Y,P,q,G);throw Y=String(z),Error("Objects are not valid as a React child (found: "+(Y==="[object Object]"?"object with keys {"+Object.keys(z).join(", ")+"}":Y)+"). If you meant to render a collection of children, use an array instead.")}return fe}function V(z,Y,P){if(z==null)return z;var q=[],G=0;return ue(z,q,"","",function(Z){return Y.call(P,Z,G++)}),q}function H(z){if(z._status===-1){var Y=z._result;Y=Y(),Y.then(function(P){(z._status===0||z._status===-1)&&(z._status=1,z._result=P)},function(P){(z._status===0||z._status===-1)&&(z._status=2,z._result=P)}),z._status===-1&&(z._status=0,z._result=Y)}if(z._status===1)return z._result.default;throw z._result}var Se=typeof reportError=="function"?reportError:function(z){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Y=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof z=="object"&&z!==null&&typeof z.message=="string"?String(z.message):String(z),error:z});if(!window.dispatchEvent(Y))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",z);return}console.error(z)};function Q(){}return mt.Children={map:V,forEach:function(z,Y,P){V(z,function(){Y.apply(this,arguments)},P)},count:function(z){var Y=0;return V(z,function(){Y++}),Y},toArray:function(z){return V(z,function(Y){return Y})||[]},only:function(z){if(!M(z))throw Error("React.Children.only expected to receive a single React element child.");return z}},mt.Component=S,mt.Fragment=r,mt.Profiler=a,mt.PureComponent=_,mt.StrictMode=n,mt.Suspense=h,mt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=O,mt.__COMPILER_RUNTIME={__proto__:null,c:function(z){return O.H.useMemoCache(z)}},mt.cache=function(z){return function(){return z.apply(null,arguments)}},mt.cloneElement=function(z,Y,P){if(z==null)throw Error("The argument must be a React element, but you passed "+z+".");var q=w({},z.props),G=z.key,Z=void 0;if(Y!=null)for(fe in Y.ref!==void 0&&(Z=void 0),Y.key!==void 0&&(G=""+Y.key),Y)!C.call(Y,fe)||fe==="key"||fe==="__self"||fe==="__source"||fe==="ref"&&Y.ref===void 0||(q[fe]=Y[fe]);var fe=arguments.length-2;if(fe===1)q.children=P;else if(1<fe){for(var Oe=Array(fe),Re=0;Re<fe;Re++)Oe[Re]=arguments[Re+2];q.children=Oe}return T(z.type,G,void 0,void 0,Z,q)},mt.createContext=function(z){return z={$$typeof:l,_currentValue:z,_currentValue2:z,_threadCount:0,Provider:null,Consumer:null},z.Provider=z,z.Consumer={$$typeof:i,_context:z},z},mt.createElement=function(z,Y,P){var q,G={},Z=null;if(Y!=null)for(q in Y.key!==void 0&&(Z=""+Y.key),Y)C.call(Y,q)&&q!=="key"&&q!=="__self"&&q!=="__source"&&(G[q]=Y[q]);var fe=arguments.length-2;if(fe===1)G.children=P;else if(1<fe){for(var Oe=Array(fe),Re=0;Re<fe;Re++)Oe[Re]=arguments[Re+2];G.children=Oe}if(z&&z.defaultProps)for(q in fe=z.defaultProps,fe)G[q]===void 0&&(G[q]=fe[q]);return T(z,Z,void 0,void 0,null,G)},mt.createRef=function(){return{current:null}},mt.forwardRef=function(z){return{$$typeof:u,render:z}},mt.isValidElement=M,mt.lazy=function(z){return{$$typeof:m,_payload:{_status:-1,_result:z},_init:H}},mt.memo=function(z,Y){return{$$typeof:d,type:z,compare:Y===void 0?null:Y}},mt.startTransition=function(z){var Y=O.T,P={};O.T=P;try{var q=z(),G=O.S;G!==null&&G(P,q),typeof q=="object"&&q!==null&&typeof q.then=="function"&&q.then(Q,Se)}catch(Z){Se(Z)}finally{O.T=Y}},mt.unstable_useCacheRefresh=function(){return O.H.useCacheRefresh()},mt.use=function(z){return O.H.use(z)},mt.useActionState=function(z,Y,P){return O.H.useActionState(z,Y,P)},mt.useCallback=function(z,Y){return O.H.useCallback(z,Y)},mt.useContext=function(z){return O.H.useContext(z)},mt.useDebugValue=function(){},mt.useDeferredValue=function(z,Y){return O.H.useDeferredValue(z,Y)},mt.useEffect=function(z,Y,P){var q=O.H;if(typeof P=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return q.useEffect(z,Y)},mt.useId=function(){return O.H.useId()},mt.useImperativeHandle=function(z,Y,P){return O.H.useImperativeHandle(z,Y,P)},mt.useInsertionEffect=function(z,Y){return O.H.useInsertionEffect(z,Y)},mt.useLayoutEffect=function(z,Y){return O.H.useLayoutEffect(z,Y)},mt.useMemo=function(z,Y){return O.H.useMemo(z,Y)},mt.useOptimistic=function(z,Y){return O.H.useOptimistic(z,Y)},mt.useReducer=function(z,Y,P){return O.H.useReducer(z,Y,P)},mt.useRef=function(z){return O.H.useRef(z)},mt.useState=function(z){return O.H.useState(z)},mt.useSyncExternalStore=function(z,Y,P){return O.H.useSyncExternalStore(z,Y,P)},mt.useTransition=function(){return O.H.useTransition()},mt.version="19.1.0",mt}var eA;function Vc(){return eA||(eA=1,Zv.exports=UF()),Zv.exports}var y=Vc();const pn=Ga(y);var Qv={exports:{}},nf={},Jv={exports:{}},eg={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tA;function $F(){return tA||(tA=1,function(e){function t(V,H){var Se=V.length;V.push(H);e:for(;0<Se;){var Q=Se-1>>>1,z=V[Q];if(0<a(z,H))V[Q]=H,V[Se]=z,Se=Q;else break e}}function r(V){return V.length===0?null:V[0]}function n(V){if(V.length===0)return null;var H=V[0],Se=V.pop();if(Se!==H){V[0]=Se;e:for(var Q=0,z=V.length,Y=z>>>1;Q<Y;){var P=2*(Q+1)-1,q=V[P],G=P+1,Z=V[G];if(0>a(q,Se))G<z&&0>a(Z,q)?(V[Q]=Z,V[G]=Se,Q=G):(V[Q]=q,V[P]=Se,Q=P);else if(G<z&&0>a(Z,Se))V[Q]=Z,V[G]=Se,Q=G;else break e}}return H}function a(V,H){var Se=V.sortIndex-H.sortIndex;return Se!==0?Se:V.id-H.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var l=Date,u=l.now();e.unstable_now=function(){return l.now()-u}}var h=[],d=[],m=1,p=null,v=3,g=!1,w=!1,b=!1,S=!1,j=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;function k(V){for(var H=r(d);H!==null;){if(H.callback===null)n(d);else if(H.startTime<=V)n(d),H.sortIndex=H.expirationTime,t(h,H);else break;H=r(d)}}function O(V){if(b=!1,k(V),!w)if(r(h)!==null)w=!0,C||(C=!0,F());else{var H=r(d);H!==null&&ue(O,H.startTime-V)}}var C=!1,T=-1,I=5,M=-1;function W(){return S?!0:!(e.unstable_now()-M<I)}function U(){if(S=!1,C){var V=e.unstable_now();M=V;var H=!0;try{e:{w=!1,b&&(b=!1,_(T),T=-1),g=!0;var Se=v;try{t:{for(k(V),p=r(h);p!==null&&!(p.expirationTime>V&&W());){var Q=p.callback;if(typeof Q=="function"){p.callback=null,v=p.priorityLevel;var z=Q(p.expirationTime<=V);if(V=e.unstable_now(),typeof z=="function"){p.callback=z,k(V),H=!0;break t}p===r(h)&&n(h),k(V)}else n(h);p=r(h)}if(p!==null)H=!0;else{var Y=r(d);Y!==null&&ue(O,Y.startTime-V),H=!1}}break e}finally{p=null,v=Se,g=!1}H=void 0}}finally{H?F():C=!1}}}var F;if(typeof A=="function")F=function(){A(U)};else if(typeof MessageChannel<"u"){var oe=new MessageChannel,je=oe.port2;oe.port1.onmessage=U,F=function(){je.postMessage(null)}}else F=function(){j(U,0)};function ue(V,H){T=j(function(){V(e.unstable_now())},H)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(V){V.callback=null},e.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<V?Math.floor(1e3/V):5},e.unstable_getCurrentPriorityLevel=function(){return v},e.unstable_next=function(V){switch(v){case 1:case 2:case 3:var H=3;break;default:H=v}var Se=v;v=H;try{return V()}finally{v=Se}},e.unstable_requestPaint=function(){S=!0},e.unstable_runWithPriority=function(V,H){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var Se=v;v=V;try{return H()}finally{v=Se}},e.unstable_scheduleCallback=function(V,H,Se){var Q=e.unstable_now();switch(typeof Se=="object"&&Se!==null?(Se=Se.delay,Se=typeof Se=="number"&&0<Se?Q+Se:Q):Se=Q,V){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=Se+z,V={id:m++,callback:H,priorityLevel:V,startTime:Se,expirationTime:z,sortIndex:-1},Se>Q?(V.sortIndex=Se,t(d,V),r(h)===null&&V===r(d)&&(b?(_(T),T=-1):b=!0,ue(O,Se-Q))):(V.sortIndex=z,t(h,V),w||g||(w=!0,C||(C=!0,F()))),V},e.unstable_shouldYield=W,e.unstable_wrapCallback=function(V){var H=v;return function(){var Se=v;v=H;try{return V.apply(this,arguments)}finally{v=Se}}}}(eg)),eg}var rA;function zF(){return rA||(rA=1,Jv.exports=$F()),Jv.exports}var tg={exports:{}},on={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nA;function HF(){if(nA)return on;nA=1;var e=Vc();function t(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)d+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},a=Symbol.for("react.portal");function i(h,d,m){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:p==null?null:""+p,children:h,containerInfo:d,implementation:m}}var l=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return on.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,on.createPortal=function(h,d){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(t(299));return i(h,d,null,m)},on.flushSync=function(h){var d=l.T,m=n.p;try{if(l.T=null,n.p=2,h)return h()}finally{l.T=d,n.p=m,n.d.f()}},on.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,n.d.C(h,d))},on.prefetchDNS=function(h){typeof h=="string"&&n.d.D(h)},on.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var m=d.as,p=u(m,d.crossOrigin),v=typeof d.integrity=="string"?d.integrity:void 0,g=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;m==="style"?n.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:p,integrity:v,fetchPriority:g}):m==="script"&&n.d.X(h,{crossOrigin:p,integrity:v,fetchPriority:g,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},on.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var m=u(d.as,d.crossOrigin);n.d.M(h,{crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&n.d.M(h)},on.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var m=d.as,p=u(m,d.crossOrigin);n.d.L(h,m,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},on.preloadModule=function(h,d){if(typeof h=="string")if(d){var m=u(d.as,d.crossOrigin);n.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else n.d.m(h)},on.requestFormReset=function(h){n.d.r(h)},on.unstable_batchedUpdates=function(h,d){return h(d)},on.useFormState=function(h,d,m){return l.H.useFormState(h,d,m)},on.useFormStatus=function(){return l.H.useHostTransitionStatus()},on.version="19.1.0",on}var aA;function lC(){if(aA)return tg.exports;aA=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),tg.exports=HF(),tg.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iA;function qF(){if(iA)return nf;iA=1;var e=zF(),t=Vc(),r=lC();function n(s){var o="https://react.dev/errors/"+s;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)o+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+s+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function i(s){var o=s,f=s;if(s.alternate)for(;o.return;)o=o.return;else{s=o;do o=s,(o.flags&4098)!==0&&(f=o.return),s=o.return;while(s)}return o.tag===3?f:null}function l(s){if(s.tag===13){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function u(s){if(i(s)!==s)throw Error(n(188))}function h(s){var o=s.alternate;if(!o){if(o=i(s),o===null)throw Error(n(188));return o!==s?null:s}for(var f=s,x=o;;){var E=f.return;if(E===null)break;var N=E.alternate;if(N===null){if(x=E.return,x!==null){f=x;continue}break}if(E.child===N.child){for(N=E.child;N;){if(N===f)return u(E),s;if(N===x)return u(E),o;N=N.sibling}throw Error(n(188))}if(f.return!==x.return)f=E,x=N;else{for(var R=!1,B=E.child;B;){if(B===f){R=!0,f=E,x=N;break}if(B===x){R=!0,x=E,f=N;break}B=B.sibling}if(!R){for(B=N.child;B;){if(B===f){R=!0,f=N,x=E;break}if(B===x){R=!0,x=N,f=E;break}B=B.sibling}if(!R)throw Error(n(189))}}if(f.alternate!==x)throw Error(n(190))}if(f.tag!==3)throw Error(n(188));return f.stateNode.current===f?s:o}function d(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s;for(s=s.child;s!==null;){if(o=d(s),o!==null)return o;s=s.sibling}return null}var m=Object.assign,p=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),j=Symbol.for("react.provider"),_=Symbol.for("react.consumer"),A=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),C=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),M=Symbol.for("react.activity"),W=Symbol.for("react.memo_cache_sentinel"),U=Symbol.iterator;function F(s){return s===null||typeof s!="object"?null:(s=U&&s[U]||s["@@iterator"],typeof s=="function"?s:null)}var oe=Symbol.for("react.client.reference");function je(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===oe?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case w:return"Fragment";case S:return"Profiler";case b:return"StrictMode";case O:return"Suspense";case C:return"SuspenseList";case M:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case g:return"Portal";case A:return(s.displayName||"Context")+".Provider";case _:return(s._context.displayName||"Context")+".Consumer";case k:var o=s.render;return s=s.displayName,s||(s=o.displayName||o.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case T:return o=s.displayName||null,o!==null?o:je(s.type)||"Memo";case I:o=s._payload,s=s._init;try{return je(s(o))}catch{}}return null}var ue=Array.isArray,V=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,H=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Se={pending:!1,data:null,method:null,action:null},Q=[],z=-1;function Y(s){return{current:s}}function P(s){0>z||(s.current=Q[z],Q[z]=null,z--)}function q(s,o){z++,Q[z]=s.current,s.current=o}var G=Y(null),Z=Y(null),fe=Y(null),Oe=Y(null);function Re(s,o){switch(q(fe,o),q(Z,s),q(G,null),o.nodeType){case 9:case 11:s=(s=o.documentElement)&&(s=s.namespaceURI)?NN(s):0;break;default:if(s=o.tagName,o=o.namespaceURI)o=NN(o),s=AN(o,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}P(G),q(G,s)}function re(){P(G),P(Z),P(fe)}function be(s){s.memoizedState!==null&&q(Oe,s);var o=G.current,f=AN(o,s.type);o!==f&&(q(Z,s),q(G,f))}function Ae(s){Z.current===s&&(P(G),P(Z)),Oe.current===s&&(P(Oe),Zu._currentValue=Se)}var D=Object.prototype.hasOwnProperty,Me=e.unstable_scheduleCallback,ae=e.unstable_cancelCallback,de=e.unstable_shouldYield,me=e.unstable_requestPaint,ce=e.unstable_now,ze=e.unstable_getCurrentPriorityLevel,Qe=e.unstable_ImmediatePriority,Ke=e.unstable_UserBlockingPriority,qe=e.unstable_NormalPriority,it=e.unstable_LowPriority,Je=e.unstable_IdlePriority,Fe=e.log,Ye=e.unstable_setDisableYieldValue,ge=null,Ge=null;function ve(s){if(typeof Fe=="function"&&Ye(s),Ge&&typeof Ge.setStrictMode=="function")try{Ge.setStrictMode(ge,s)}catch{}}var ne=Math.clz32?Math.clz32:Ze,xe=Math.log,Be=Math.LN2;function Ze(s){return s>>>=0,s===0?32:31-(xe(s)/Be|0)|0}var tt=256,At=4194304;function nn(s){var o=s&42;if(o!==0)return o;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function En(s,o,f){var x=s.pendingLanes;if(x===0)return 0;var E=0,N=s.suspendedLanes,R=s.pingedLanes;s=s.warmLanes;var B=x&134217727;return B!==0?(x=B&~N,x!==0?E=nn(x):(R&=B,R!==0?E=nn(R):f||(f=B&~s,f!==0&&(E=nn(f))))):(B=x&~N,B!==0?E=nn(B):R!==0?E=nn(R):f||(f=x&~s,f!==0&&(E=nn(f)))),E===0?0:o!==0&&o!==E&&(o&N)===0&&(N=E&-E,f=o&-o,N>=f||N===32&&(f&4194048)!==0)?o:E}function xi(s,o){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&o)===0}function Ro(s,o){switch(s){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function As(){var s=tt;return tt<<=1,(tt&4194048)===0&&(tt=256),s}function _s(){var s=At;return At<<=1,(At&62914560)===0&&(At=4194304),s}function Ts(s){for(var o=[],f=0;31>f;f++)o.push(s);return o}function ba(s,o){s.pendingLanes|=o,o!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Gn(s,o,f,x,E,N){var R=s.pendingLanes;s.pendingLanes=f,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=f,s.entangledLanes&=f,s.errorRecoveryDisabledLanes&=f,s.shellSuspendCounter=0;var B=s.entanglements,se=s.expirationTimes,_e=s.hiddenUpdates;for(f=R&~f;0<f;){var Le=31-ne(f),$e=1<<Le;B[Le]=0,se[Le]=-1;var ke=_e[Le];if(ke!==null)for(_e[Le]=null,Le=0;Le<ke.length;Le++){var Ce=ke[Le];Ce!==null&&(Ce.lane&=-536870913)}f&=~$e}x!==0&&_l(s,x,0),N!==0&&E===0&&s.tag!==0&&(s.suspendedLanes|=N&~(R&~o))}function _l(s,o,f){s.pendingLanes|=o,s.suspendedLanes&=~o;var x=31-ne(o);s.entangledLanes|=o,s.entanglements[x]=s.entanglements[x]|1073741824|f&4194090}function Tl(s,o){var f=s.entangledLanes|=o;for(s=s.entanglements;f;){var x=31-ne(f),E=1<<x;E&o|s[x]&o&&(s[x]|=o),f&=~E}}function ks(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function kl(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Cl(){var s=H.p;return s!==0?s:(s=window.event,s===void 0?32:VN(s.type))}function Cs(s,o){var f=H.p;try{return H.p=s,o()}finally{H.p=f}}var wa=Math.random().toString(36).slice(2),vr="__reactFiber$"+wa,gr="__reactProps$"+wa,vi="__reactContainer$"+wa,Ol="__reactEvents$"+wa,cu="__reactListeners$"+wa,L="__reactHandles$"+wa,ee="__reactResources$"+wa,K="__reactMarker$"+wa;function X(s){delete s[vr],delete s[gr],delete s[Ol],delete s[cu],delete s[L]}function J(s){var o=s[vr];if(o)return o;for(var f=s.parentNode;f;){if(o=f[vi]||f[vr]){if(f=o.alternate,o.child!==null||f!==null&&f.child!==null)for(s=CN(s);s!==null;){if(f=s[vr])return f;s=CN(s)}return o}s=f,f=s.parentNode}return null}function te(s){if(s=s[vr]||s[vi]){var o=s.tag;if(o===5||o===6||o===13||o===26||o===27||o===3)return s}return null}function ie(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s.stateNode;throw Error(n(33))}function pe(s){var o=s[ee];return o||(o=s[ee]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function le(s){s[K]=!0}var ye=new Set,Ee={};function De(s,o){Ie(s,o),Ie(s+"Capture",o)}function Ie(s,o){for(Ee[s]=o,s=0;s<o.length;s++)ye.add(o[s])}var Ve=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),He={},Xe={};function st(s){return D.call(Xe,s)?!0:D.call(He,s)?!1:Ve.test(s)?Xe[s]=!0:(He[s]=!0,!1)}function pt(s,o,f){if(st(o))if(f===null)s.removeAttribute(o);else{switch(typeof f){case"undefined":case"function":case"symbol":s.removeAttribute(o);return;case"boolean":var x=o.toLowerCase().slice(0,5);if(x!=="data-"&&x!=="aria-"){s.removeAttribute(o);return}}s.setAttribute(o,""+f)}}function dt(s,o,f){if(f===null)s.removeAttribute(o);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttribute(o,""+f)}}function jt(s,o,f,x){if(x===null)s.removeAttribute(f);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(f);return}s.setAttributeNS(o,f,""+x)}}var kr,an;function jn(s){if(kr===void 0)try{throw Error()}catch(f){var o=f.stack.trim().match(/\n( *(at )?)/);kr=o&&o[1]||"",an=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+kr+s+an}var Nt=!1;function Vt(s,o){if(!s||Nt)return"";Nt=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var x={DetermineComponentFrameRoot:function(){try{if(o){var $e=function(){throw Error()};if(Object.defineProperty($e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct($e,[])}catch(Ce){var ke=Ce}Reflect.construct(s,[],$e)}else{try{$e.call()}catch(Ce){ke=Ce}s.call($e.prototype)}}else{try{throw Error()}catch(Ce){ke=Ce}($e=s())&&typeof $e.catch=="function"&&$e.catch(function(){})}}catch(Ce){if(Ce&&ke&&typeof Ce.stack=="string")return[Ce.stack,ke.stack]}return[null,null]}};x.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var E=Object.getOwnPropertyDescriptor(x.DetermineComponentFrameRoot,"name");E&&E.configurable&&Object.defineProperty(x.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var N=x.DetermineComponentFrameRoot(),R=N[0],B=N[1];if(R&&B){var se=R.split(`
`),_e=B.split(`
`);for(E=x=0;x<se.length&&!se[x].includes("DetermineComponentFrameRoot");)x++;for(;E<_e.length&&!_e[E].includes("DetermineComponentFrameRoot");)E++;if(x===se.length||E===_e.length)for(x=se.length-1,E=_e.length-1;1<=x&&0<=E&&se[x]!==_e[E];)E--;for(;1<=x&&0<=E;x--,E--)if(se[x]!==_e[E]){if(x!==1||E!==1)do if(x--,E--,0>E||se[x]!==_e[E]){var Le=`
`+se[x].replace(" at new "," at ");return s.displayName&&Le.includes("<anonymous>")&&(Le=Le.replace("<anonymous>",s.displayName)),Le}while(1<=x&&0<=E);break}}}finally{Nt=!1,Error.prepareStackTrace=f}return(f=s?s.displayName||s.name:"")?jn(f):""}function sn(s){switch(s.tag){case 26:case 27:case 5:return jn(s.type);case 16:return jn("Lazy");case 13:return jn("Suspense");case 19:return jn("SuspenseList");case 0:case 15:return Vt(s.type,!1);case 11:return Vt(s.type.render,!1);case 1:return Vt(s.type,!0);case 31:return jn("Activity");default:return""}}function $d(s){try{var o="";do o+=sn(s),s=s.return;while(s);return o}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}function Gr(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Pn(s){var o=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function PM(s){var o=Pn(s)?"checked":"value",f=Object.getOwnPropertyDescriptor(s.constructor.prototype,o),x=""+s[o];if(!s.hasOwnProperty(o)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var E=f.get,N=f.set;return Object.defineProperty(s,o,{configurable:!0,get:function(){return E.call(this)},set:function(R){x=""+R,N.call(this,R)}}),Object.defineProperty(s,o,{enumerable:f.enumerable}),{getValue:function(){return x},setValue:function(R){x=""+R},stopTracking:function(){s._valueTracker=null,delete s[o]}}}}function zd(s){s._valueTracker||(s._valueTracker=PM(s))}function wS(s){if(!s)return!1;var o=s._valueTracker;if(!o)return!0;var f=o.getValue(),x="";return s&&(x=Pn(s)?s.checked?"true":"false":s.value),s=x,s!==f?(o.setValue(s),!0):!1}function Hd(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var RM=/[\n"\\]/g;function Sa(s){return s.replace(RM,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function Gp(s,o,f,x,E,N,R,B){s.name="",R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"?s.type=R:s.removeAttribute("type"),o!=null?R==="number"?(o===0&&s.value===""||s.value!=o)&&(s.value=""+Gr(o)):s.value!==""+Gr(o)&&(s.value=""+Gr(o)):R!=="submit"&&R!=="reset"||s.removeAttribute("value"),o!=null?Wp(s,R,Gr(o)):f!=null?Wp(s,R,Gr(f)):x!=null&&s.removeAttribute("value"),E==null&&N!=null&&(s.defaultChecked=!!N),E!=null&&(s.checked=E&&typeof E!="function"&&typeof E!="symbol"),B!=null&&typeof B!="function"&&typeof B!="symbol"&&typeof B!="boolean"?s.name=""+Gr(B):s.removeAttribute("name")}function SS(s,o,f,x,E,N,R,B){if(N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"&&(s.type=N),o!=null||f!=null){if(!(N!=="submit"&&N!=="reset"||o!=null))return;f=f!=null?""+Gr(f):"",o=o!=null?""+Gr(o):f,B||o===s.value||(s.value=o),s.defaultValue=o}x=x??E,x=typeof x!="function"&&typeof x!="symbol"&&!!x,s.checked=B?s.checked:!!x,s.defaultChecked=!!x,R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"&&(s.name=R)}function Wp(s,o,f){o==="number"&&Hd(s.ownerDocument)===s||s.defaultValue===""+f||(s.defaultValue=""+f)}function Mo(s,o,f,x){if(s=s.options,o){o={};for(var E=0;E<f.length;E++)o["$"+f[E]]=!0;for(f=0;f<s.length;f++)E=o.hasOwnProperty("$"+s[f].value),s[f].selected!==E&&(s[f].selected=E),E&&x&&(s[f].defaultSelected=!0)}else{for(f=""+Gr(f),o=null,E=0;E<s.length;E++){if(s[E].value===f){s[E].selected=!0,x&&(s[E].defaultSelected=!0);return}o!==null||s[E].disabled||(o=s[E])}o!==null&&(o.selected=!0)}}function ES(s,o,f){if(o!=null&&(o=""+Gr(o),o!==s.value&&(s.value=o),f==null)){s.defaultValue!==o&&(s.defaultValue=o);return}s.defaultValue=f!=null?""+Gr(f):""}function jS(s,o,f,x){if(o==null){if(x!=null){if(f!=null)throw Error(n(92));if(ue(x)){if(1<x.length)throw Error(n(93));x=x[0]}f=x}f==null&&(f=""),o=f}f=Gr(o),s.defaultValue=f,x=s.textContent,x===f&&x!==""&&x!==null&&(s.value=x)}function Fo(s,o){if(o){var f=s.firstChild;if(f&&f===s.lastChild&&f.nodeType===3){f.nodeValue=o;return}}s.textContent=o}var MM=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function NS(s,o,f){var x=o.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?x?s.setProperty(o,""):o==="float"?s.cssFloat="":s[o]="":x?s.setProperty(o,f):typeof f!="number"||f===0||MM.has(o)?o==="float"?s.cssFloat=f:s[o]=(""+f).trim():s[o]=f+"px"}function AS(s,o,f){if(o!=null&&typeof o!="object")throw Error(n(62));if(s=s.style,f!=null){for(var x in f)!f.hasOwnProperty(x)||o!=null&&o.hasOwnProperty(x)||(x.indexOf("--")===0?s.setProperty(x,""):x==="float"?s.cssFloat="":s[x]="");for(var E in o)x=o[E],o.hasOwnProperty(E)&&f[E]!==x&&NS(s,E,x)}else for(var N in o)o.hasOwnProperty(N)&&NS(s,N,o[N])}function Yp(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var FM=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),IM=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function qd(s){return IM.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var Xp=null;function Zp(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Io=null,Lo=null;function _S(s){var o=te(s);if(o&&(s=o.stateNode)){var f=s[gr]||null;e:switch(s=o.stateNode,o.type){case"input":if(Gp(s,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),o=f.name,f.type==="radio"&&o!=null){for(f=s;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+Sa(""+o)+'"][type="radio"]'),o=0;o<f.length;o++){var x=f[o];if(x!==s&&x.form===s.form){var E=x[gr]||null;if(!E)throw Error(n(90));Gp(x,E.value,E.defaultValue,E.defaultValue,E.checked,E.defaultChecked,E.type,E.name)}}for(o=0;o<f.length;o++)x=f[o],x.form===s.form&&wS(x)}break e;case"textarea":ES(s,f.value,f.defaultValue);break e;case"select":o=f.value,o!=null&&Mo(s,!!f.multiple,o,!1)}}}var Qp=!1;function TS(s,o,f){if(Qp)return s(o,f);Qp=!0;try{var x=s(o);return x}finally{if(Qp=!1,(Io!==null||Lo!==null)&&(k0(),Io&&(o=Io,s=Lo,Lo=Io=null,_S(o),s)))for(o=0;o<s.length;o++)_S(s[o])}}function uu(s,o){var f=s.stateNode;if(f===null)return null;var x=f[gr]||null;if(x===null)return null;f=x[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(s=s.type,x=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!x;break e;default:s=!1}if(s)return null;if(f&&typeof f!="function")throw Error(n(231,o,typeof f));return f}var Ui=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Jp=!1;if(Ui)try{var fu={};Object.defineProperty(fu,"passive",{get:function(){Jp=!0}}),window.addEventListener("test",fu,fu),window.removeEventListener("test",fu,fu)}catch{Jp=!1}var Os=null,ex=null,Vd=null;function kS(){if(Vd)return Vd;var s,o=ex,f=o.length,x,E="value"in Os?Os.value:Os.textContent,N=E.length;for(s=0;s<f&&o[s]===E[s];s++);var R=f-s;for(x=1;x<=R&&o[f-x]===E[N-x];x++);return Vd=E.slice(s,1<x?1-x:void 0)}function Kd(s){var o=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&o===13&&(s=13)):s=o,s===10&&(s=13),32<=s||s===13?s:0}function Gd(){return!0}function CS(){return!1}function Rn(s){function o(f,x,E,N,R){this._reactName=f,this._targetInst=E,this.type=x,this.nativeEvent=N,this.target=R,this.currentTarget=null;for(var B in s)s.hasOwnProperty(B)&&(f=s[B],this[B]=f?f(N):N[B]);return this.isDefaultPrevented=(N.defaultPrevented!=null?N.defaultPrevented:N.returnValue===!1)?Gd:CS,this.isPropagationStopped=CS,this}return m(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=Gd)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=Gd)},persist:function(){},isPersistent:Gd}),o}var Dl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Wd=Rn(Dl),du=m({},Dl,{view:0,detail:0}),LM=Rn(du),tx,rx,hu,Yd=m({},du,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ax,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==hu&&(hu&&s.type==="mousemove"?(tx=s.screenX-hu.screenX,rx=s.screenY-hu.screenY):rx=tx=0,hu=s),tx)},movementY:function(s){return"movementY"in s?s.movementY:rx}}),OS=Rn(Yd),BM=m({},Yd,{dataTransfer:0}),UM=Rn(BM),$M=m({},du,{relatedTarget:0}),nx=Rn($M),zM=m({},Dl,{animationName:0,elapsedTime:0,pseudoElement:0}),HM=Rn(zM),qM=m({},Dl,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),VM=Rn(qM),KM=m({},Dl,{data:0}),DS=Rn(KM),GM={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},WM={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},YM={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function XM(s){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(s):(s=YM[s])?!!o[s]:!1}function ax(){return XM}var ZM=m({},du,{key:function(s){if(s.key){var o=GM[s.key]||s.key;if(o!=="Unidentified")return o}return s.type==="keypress"?(s=Kd(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?WM[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ax,charCode:function(s){return s.type==="keypress"?Kd(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Kd(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),QM=Rn(ZM),JM=m({},Yd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),PS=Rn(JM),e8=m({},du,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ax}),t8=Rn(e8),r8=m({},Dl,{propertyName:0,elapsedTime:0,pseudoElement:0}),n8=Rn(r8),a8=m({},Yd,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),i8=Rn(a8),s8=m({},Dl,{newState:0,oldState:0}),l8=Rn(s8),o8=[9,13,27,32],ix=Ui&&"CompositionEvent"in window,mu=null;Ui&&"documentMode"in document&&(mu=document.documentMode);var c8=Ui&&"TextEvent"in window&&!mu,RS=Ui&&(!ix||mu&&8<mu&&11>=mu),MS=" ",FS=!1;function IS(s,o){switch(s){case"keyup":return o8.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function LS(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Bo=!1;function u8(s,o){switch(s){case"compositionend":return LS(o);case"keypress":return o.which!==32?null:(FS=!0,MS);case"textInput":return s=o.data,s===MS&&FS?null:s;default:return null}}function f8(s,o){if(Bo)return s==="compositionend"||!ix&&IS(s,o)?(s=kS(),Vd=ex=Os=null,Bo=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return RS&&o.locale!=="ko"?null:o.data;default:return null}}var d8={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function BS(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o==="input"?!!d8[s.type]:o==="textarea"}function US(s,o,f,x){Io?Lo?Lo.push(x):Lo=[x]:Io=x,o=M0(o,"onChange"),0<o.length&&(f=new Wd("onChange","change",null,f,x),s.push({event:f,listeners:o}))}var pu=null,xu=null;function h8(s){bN(s,0)}function Xd(s){var o=ie(s);if(wS(o))return s}function $S(s,o){if(s==="change")return o}var zS=!1;if(Ui){var sx;if(Ui){var lx="oninput"in document;if(!lx){var HS=document.createElement("div");HS.setAttribute("oninput","return;"),lx=typeof HS.oninput=="function"}sx=lx}else sx=!1;zS=sx&&(!document.documentMode||9<document.documentMode)}function qS(){pu&&(pu.detachEvent("onpropertychange",VS),xu=pu=null)}function VS(s){if(s.propertyName==="value"&&Xd(xu)){var o=[];US(o,xu,s,Zp(s)),TS(h8,o)}}function m8(s,o,f){s==="focusin"?(qS(),pu=o,xu=f,pu.attachEvent("onpropertychange",VS)):s==="focusout"&&qS()}function p8(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Xd(xu)}function x8(s,o){if(s==="click")return Xd(o)}function v8(s,o){if(s==="input"||s==="change")return Xd(o)}function g8(s,o){return s===o&&(s!==0||1/s===1/o)||s!==s&&o!==o}var Wn=typeof Object.is=="function"?Object.is:g8;function vu(s,o){if(Wn(s,o))return!0;if(typeof s!="object"||s===null||typeof o!="object"||o===null)return!1;var f=Object.keys(s),x=Object.keys(o);if(f.length!==x.length)return!1;for(x=0;x<f.length;x++){var E=f[x];if(!D.call(o,E)||!Wn(s[E],o[E]))return!1}return!0}function KS(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function GS(s,o){var f=KS(s);s=0;for(var x;f;){if(f.nodeType===3){if(x=s+f.textContent.length,s<=o&&x>=o)return{node:f,offset:o-s};s=x}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=KS(f)}}function WS(s,o){return s&&o?s===o?!0:s&&s.nodeType===3?!1:o&&o.nodeType===3?WS(s,o.parentNode):"contains"in s?s.contains(o):s.compareDocumentPosition?!!(s.compareDocumentPosition(o)&16):!1:!1}function YS(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var o=Hd(s.document);o instanceof s.HTMLIFrameElement;){try{var f=typeof o.contentWindow.location.href=="string"}catch{f=!1}if(f)s=o.contentWindow;else break;o=Hd(s.document)}return o}function ox(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o&&(o==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||o==="textarea"||s.contentEditable==="true")}var y8=Ui&&"documentMode"in document&&11>=document.documentMode,Uo=null,cx=null,gu=null,ux=!1;function XS(s,o,f){var x=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;ux||Uo==null||Uo!==Hd(x)||(x=Uo,"selectionStart"in x&&ox(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),gu&&vu(gu,x)||(gu=x,x=M0(cx,"onSelect"),0<x.length&&(o=new Wd("onSelect","select",null,o,f),s.push({event:o,listeners:x}),o.target=Uo)))}function Pl(s,o){var f={};return f[s.toLowerCase()]=o.toLowerCase(),f["Webkit"+s]="webkit"+o,f["Moz"+s]="moz"+o,f}var $o={animationend:Pl("Animation","AnimationEnd"),animationiteration:Pl("Animation","AnimationIteration"),animationstart:Pl("Animation","AnimationStart"),transitionrun:Pl("Transition","TransitionRun"),transitionstart:Pl("Transition","TransitionStart"),transitioncancel:Pl("Transition","TransitionCancel"),transitionend:Pl("Transition","TransitionEnd")},fx={},ZS={};Ui&&(ZS=document.createElement("div").style,"AnimationEvent"in window||(delete $o.animationend.animation,delete $o.animationiteration.animation,delete $o.animationstart.animation),"TransitionEvent"in window||delete $o.transitionend.transition);function Rl(s){if(fx[s])return fx[s];if(!$o[s])return s;var o=$o[s],f;for(f in o)if(o.hasOwnProperty(f)&&f in ZS)return fx[s]=o[f];return s}var QS=Rl("animationend"),JS=Rl("animationiteration"),eE=Rl("animationstart"),b8=Rl("transitionrun"),w8=Rl("transitionstart"),S8=Rl("transitioncancel"),tE=Rl("transitionend"),rE=new Map,dx="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");dx.push("scrollEnd");function Qa(s,o){rE.set(s,o),De(o,[s])}var nE=new WeakMap;function Ea(s,o){if(typeof s=="object"&&s!==null){var f=nE.get(s);return f!==void 0?f:(o={value:s,source:o,stack:$d(o)},nE.set(s,o),o)}return{value:s,source:o,stack:$d(o)}}var ja=[],zo=0,hx=0;function Zd(){for(var s=zo,o=hx=zo=0;o<s;){var f=ja[o];ja[o++]=null;var x=ja[o];ja[o++]=null;var E=ja[o];ja[o++]=null;var N=ja[o];if(ja[o++]=null,x!==null&&E!==null){var R=x.pending;R===null?E.next=E:(E.next=R.next,R.next=E),x.pending=E}N!==0&&aE(f,E,N)}}function Qd(s,o,f,x){ja[zo++]=s,ja[zo++]=o,ja[zo++]=f,ja[zo++]=x,hx|=x,s.lanes|=x,s=s.alternate,s!==null&&(s.lanes|=x)}function mx(s,o,f,x){return Qd(s,o,f,x),Jd(s)}function Ho(s,o){return Qd(s,null,null,o),Jd(s)}function aE(s,o,f){s.lanes|=f;var x=s.alternate;x!==null&&(x.lanes|=f);for(var E=!1,N=s.return;N!==null;)N.childLanes|=f,x=N.alternate,x!==null&&(x.childLanes|=f),N.tag===22&&(s=N.stateNode,s===null||s._visibility&1||(E=!0)),s=N,N=N.return;return s.tag===3?(N=s.stateNode,E&&o!==null&&(E=31-ne(f),s=N.hiddenUpdates,x=s[E],x===null?s[E]=[o]:x.push(o),o.lane=f|536870912),N):null}function Jd(s){if(50<Hu)throw Hu=0,bv=null,Error(n(185));for(var o=s.return;o!==null;)s=o,o=s.return;return s.tag===3?s.stateNode:null}var qo={};function E8(s,o,f,x){this.tag=s,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Yn(s,o,f,x){return new E8(s,o,f,x)}function px(s){return s=s.prototype,!(!s||!s.isReactComponent)}function $i(s,o){var f=s.alternate;return f===null?(f=Yn(s.tag,o,s.key,s.mode),f.elementType=s.elementType,f.type=s.type,f.stateNode=s.stateNode,f.alternate=s,s.alternate=f):(f.pendingProps=o,f.type=s.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=s.flags&65011712,f.childLanes=s.childLanes,f.lanes=s.lanes,f.child=s.child,f.memoizedProps=s.memoizedProps,f.memoizedState=s.memoizedState,f.updateQueue=s.updateQueue,o=s.dependencies,f.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},f.sibling=s.sibling,f.index=s.index,f.ref=s.ref,f.refCleanup=s.refCleanup,f}function iE(s,o){s.flags&=65011714;var f=s.alternate;return f===null?(s.childLanes=0,s.lanes=o,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=f.childLanes,s.lanes=f.lanes,s.child=f.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=f.memoizedProps,s.memoizedState=f.memoizedState,s.updateQueue=f.updateQueue,s.type=f.type,o=f.dependencies,s.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),s}function e0(s,o,f,x,E,N){var R=0;if(x=s,typeof s=="function")px(s)&&(R=1);else if(typeof s=="string")R=NF(s,f,G.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case M:return s=Yn(31,f,o,E),s.elementType=M,s.lanes=N,s;case w:return Ml(f.children,E,N,o);case b:R=8,E|=24;break;case S:return s=Yn(12,f,o,E|2),s.elementType=S,s.lanes=N,s;case O:return s=Yn(13,f,o,E),s.elementType=O,s.lanes=N,s;case C:return s=Yn(19,f,o,E),s.elementType=C,s.lanes=N,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case j:case A:R=10;break e;case _:R=9;break e;case k:R=11;break e;case T:R=14;break e;case I:R=16,x=null;break e}R=29,f=Error(n(130,s===null?"null":typeof s,"")),x=null}return o=Yn(R,f,o,E),o.elementType=s,o.type=x,o.lanes=N,o}function Ml(s,o,f,x){return s=Yn(7,s,x,o),s.lanes=f,s}function xx(s,o,f){return s=Yn(6,s,null,o),s.lanes=f,s}function vx(s,o,f){return o=Yn(4,s.children!==null?s.children:[],s.key,o),o.lanes=f,o.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},o}var Vo=[],Ko=0,t0=null,r0=0,Na=[],Aa=0,Fl=null,zi=1,Hi="";function Il(s,o){Vo[Ko++]=r0,Vo[Ko++]=t0,t0=s,r0=o}function sE(s,o,f){Na[Aa++]=zi,Na[Aa++]=Hi,Na[Aa++]=Fl,Fl=s;var x=zi;s=Hi;var E=32-ne(x)-1;x&=~(1<<E),f+=1;var N=32-ne(o)+E;if(30<N){var R=E-E%5;N=(x&(1<<R)-1).toString(32),x>>=R,E-=R,zi=1<<32-ne(o)+E|f<<E|x,Hi=N+s}else zi=1<<N|f<<E|x,Hi=s}function gx(s){s.return!==null&&(Il(s,1),sE(s,1,0))}function yx(s){for(;s===t0;)t0=Vo[--Ko],Vo[Ko]=null,r0=Vo[--Ko],Vo[Ko]=null;for(;s===Fl;)Fl=Na[--Aa],Na[Aa]=null,Hi=Na[--Aa],Na[Aa]=null,zi=Na[--Aa],Na[Aa]=null}var Nn=null,or=null,Mt=!1,Ll=null,gi=!1,bx=Error(n(519));function Bl(s){var o=Error(n(418,""));throw wu(Ea(o,s)),bx}function lE(s){var o=s.stateNode,f=s.type,x=s.memoizedProps;switch(o[vr]=s,o[gr]=x,f){case"dialog":Et("cancel",o),Et("close",o);break;case"iframe":case"object":case"embed":Et("load",o);break;case"video":case"audio":for(f=0;f<Vu.length;f++)Et(Vu[f],o);break;case"source":Et("error",o);break;case"img":case"image":case"link":Et("error",o),Et("load",o);break;case"details":Et("toggle",o);break;case"input":Et("invalid",o),SS(o,x.value,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name,!0),zd(o);break;case"select":Et("invalid",o);break;case"textarea":Et("invalid",o),jS(o,x.value,x.defaultValue,x.children),zd(o)}f=x.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||o.textContent===""+f||x.suppressHydrationWarning===!0||jN(o.textContent,f)?(x.popover!=null&&(Et("beforetoggle",o),Et("toggle",o)),x.onScroll!=null&&Et("scroll",o),x.onScrollEnd!=null&&Et("scrollend",o),x.onClick!=null&&(o.onclick=F0),o=!0):o=!1,o||Bl(s)}function oE(s){for(Nn=s.return;Nn;)switch(Nn.tag){case 5:case 13:gi=!1;return;case 27:case 3:gi=!0;return;default:Nn=Nn.return}}function yu(s){if(s!==Nn)return!1;if(!Mt)return oE(s),Mt=!0,!1;var o=s.tag,f;if((f=o!==3&&o!==27)&&((f=o===5)&&(f=s.type,f=!(f!=="form"&&f!=="button")||Fv(s.type,s.memoizedProps)),f=!f),f&&or&&Bl(s),oE(s),o===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));e:{for(s=s.nextSibling,o=0;s;){if(s.nodeType===8)if(f=s.data,f==="/$"){if(o===0){or=ei(s.nextSibling);break e}o--}else f!=="$"&&f!=="$!"&&f!=="$?"||o++;s=s.nextSibling}or=null}}else o===27?(o=or,Gs(s.type)?(s=Uv,Uv=null,or=s):or=o):or=Nn?ei(s.stateNode.nextSibling):null;return!0}function bu(){or=Nn=null,Mt=!1}function cE(){var s=Ll;return s!==null&&(In===null?In=s:In.push.apply(In,s),Ll=null),s}function wu(s){Ll===null?Ll=[s]:Ll.push(s)}var wx=Y(null),Ul=null,qi=null;function Ds(s,o,f){q(wx,o._currentValue),o._currentValue=f}function Vi(s){s._currentValue=wx.current,P(wx)}function Sx(s,o,f){for(;s!==null;){var x=s.alternate;if((s.childLanes&o)!==o?(s.childLanes|=o,x!==null&&(x.childLanes|=o)):x!==null&&(x.childLanes&o)!==o&&(x.childLanes|=o),s===f)break;s=s.return}}function Ex(s,o,f,x){var E=s.child;for(E!==null&&(E.return=s);E!==null;){var N=E.dependencies;if(N!==null){var R=E.child;N=N.firstContext;e:for(;N!==null;){var B=N;N=E;for(var se=0;se<o.length;se++)if(B.context===o[se]){N.lanes|=f,B=N.alternate,B!==null&&(B.lanes|=f),Sx(N.return,f,s),x||(R=null);break e}N=B.next}}else if(E.tag===18){if(R=E.return,R===null)throw Error(n(341));R.lanes|=f,N=R.alternate,N!==null&&(N.lanes|=f),Sx(R,f,s),R=null}else R=E.child;if(R!==null)R.return=E;else for(R=E;R!==null;){if(R===s){R=null;break}if(E=R.sibling,E!==null){E.return=R.return,R=E;break}R=R.return}E=R}}function Su(s,o,f,x){s=null;for(var E=o,N=!1;E!==null;){if(!N){if((E.flags&524288)!==0)N=!0;else if((E.flags&262144)!==0)break}if(E.tag===10){var R=E.alternate;if(R===null)throw Error(n(387));if(R=R.memoizedProps,R!==null){var B=E.type;Wn(E.pendingProps.value,R.value)||(s!==null?s.push(B):s=[B])}}else if(E===Oe.current){if(R=E.alternate,R===null)throw Error(n(387));R.memoizedState.memoizedState!==E.memoizedState.memoizedState&&(s!==null?s.push(Zu):s=[Zu])}E=E.return}s!==null&&Ex(o,s,f,x),o.flags|=262144}function n0(s){for(s=s.firstContext;s!==null;){if(!Wn(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function $l(s){Ul=s,qi=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function ln(s){return uE(Ul,s)}function a0(s,o){return Ul===null&&$l(s),uE(s,o)}function uE(s,o){var f=o._currentValue;if(o={context:o,memoizedValue:f,next:null},qi===null){if(s===null)throw Error(n(308));qi=o,s.dependencies={lanes:0,firstContext:o},s.flags|=524288}else qi=qi.next=o;return f}var j8=typeof AbortController<"u"?AbortController:function(){var s=[],o=this.signal={aborted:!1,addEventListener:function(f,x){s.push(x)}};this.abort=function(){o.aborted=!0,s.forEach(function(f){return f()})}},N8=e.unstable_scheduleCallback,A8=e.unstable_NormalPriority,Cr={$$typeof:A,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function jx(){return{controller:new j8,data:new Map,refCount:0}}function Eu(s){s.refCount--,s.refCount===0&&N8(A8,function(){s.controller.abort()})}var ju=null,Nx=0,Go=0,Wo=null;function _8(s,o){if(ju===null){var f=ju=[];Nx=0,Go=_v(),Wo={status:"pending",value:void 0,then:function(x){f.push(x)}}}return Nx++,o.then(fE,fE),o}function fE(){if(--Nx===0&&ju!==null){Wo!==null&&(Wo.status="fulfilled");var s=ju;ju=null,Go=0,Wo=null;for(var o=0;o<s.length;o++)(0,s[o])()}}function T8(s,o){var f=[],x={status:"pending",value:null,reason:null,then:function(E){f.push(E)}};return s.then(function(){x.status="fulfilled",x.value=o;for(var E=0;E<f.length;E++)(0,f[E])(o)},function(E){for(x.status="rejected",x.reason=E,E=0;E<f.length;E++)(0,f[E])(void 0)}),x}var dE=V.S;V.S=function(s,o){typeof o=="object"&&o!==null&&typeof o.then=="function"&&_8(s,o),dE!==null&&dE(s,o)};var zl=Y(null);function Ax(){var s=zl.current;return s!==null?s:Yt.pooledCache}function i0(s,o){o===null?q(zl,zl.current):q(zl,o.pool)}function hE(){var s=Ax();return s===null?null:{parent:Cr._currentValue,pool:s}}var Nu=Error(n(460)),mE=Error(n(474)),s0=Error(n(542)),_x={then:function(){}};function pE(s){return s=s.status,s==="fulfilled"||s==="rejected"}function l0(){}function xE(s,o,f){switch(f=s[f],f===void 0?s.push(o):f!==o&&(o.then(l0,l0),o=f),o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,gE(s),s;default:if(typeof o.status=="string")o.then(l0,l0);else{if(s=Yt,s!==null&&100<s.shellSuspendCounter)throw Error(n(482));s=o,s.status="pending",s.then(function(x){if(o.status==="pending"){var E=o;E.status="fulfilled",E.value=x}},function(x){if(o.status==="pending"){var E=o;E.status="rejected",E.reason=x}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,gE(s),s}throw Au=o,Nu}}var Au=null;function vE(){if(Au===null)throw Error(n(459));var s=Au;return Au=null,s}function gE(s){if(s===Nu||s===s0)throw Error(n(483))}var Ps=!1;function Tx(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function kx(s,o){s=s.updateQueue,o.updateQueue===s&&(o.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Rs(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Ms(s,o,f){var x=s.updateQueue;if(x===null)return null;if(x=x.shared,(It&2)!==0){var E=x.pending;return E===null?o.next=o:(o.next=E.next,E.next=o),x.pending=o,o=Jd(s),aE(s,null,f),o}return Qd(s,x,o,f),Jd(s)}function _u(s,o,f){if(o=o.updateQueue,o!==null&&(o=o.shared,(f&4194048)!==0)){var x=o.lanes;x&=s.pendingLanes,f|=x,o.lanes=f,Tl(s,f)}}function Cx(s,o){var f=s.updateQueue,x=s.alternate;if(x!==null&&(x=x.updateQueue,f===x)){var E=null,N=null;if(f=f.firstBaseUpdate,f!==null){do{var R={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};N===null?E=N=R:N=N.next=R,f=f.next}while(f!==null);N===null?E=N=o:N=N.next=o}else E=N=o;f={baseState:x.baseState,firstBaseUpdate:E,lastBaseUpdate:N,shared:x.shared,callbacks:x.callbacks},s.updateQueue=f;return}s=f.lastBaseUpdate,s===null?f.firstBaseUpdate=o:s.next=o,f.lastBaseUpdate=o}var Ox=!1;function Tu(){if(Ox){var s=Wo;if(s!==null)throw s}}function ku(s,o,f,x){Ox=!1;var E=s.updateQueue;Ps=!1;var N=E.firstBaseUpdate,R=E.lastBaseUpdate,B=E.shared.pending;if(B!==null){E.shared.pending=null;var se=B,_e=se.next;se.next=null,R===null?N=_e:R.next=_e,R=se;var Le=s.alternate;Le!==null&&(Le=Le.updateQueue,B=Le.lastBaseUpdate,B!==R&&(B===null?Le.firstBaseUpdate=_e:B.next=_e,Le.lastBaseUpdate=se))}if(N!==null){var $e=E.baseState;R=0,Le=_e=se=null,B=N;do{var ke=B.lane&-536870913,Ce=ke!==B.lane;if(Ce?(kt&ke)===ke:(x&ke)===ke){ke!==0&&ke===Go&&(Ox=!0),Le!==null&&(Le=Le.next={lane:0,tag:B.tag,payload:B.payload,callback:null,next:null});e:{var ut=s,ot=B;ke=o;var Ht=f;switch(ot.tag){case 1:if(ut=ot.payload,typeof ut=="function"){$e=ut.call(Ht,$e,ke);break e}$e=ut;break e;case 3:ut.flags=ut.flags&-65537|128;case 0:if(ut=ot.payload,ke=typeof ut=="function"?ut.call(Ht,$e,ke):ut,ke==null)break e;$e=m({},$e,ke);break e;case 2:Ps=!0}}ke=B.callback,ke!==null&&(s.flags|=64,Ce&&(s.flags|=8192),Ce=E.callbacks,Ce===null?E.callbacks=[ke]:Ce.push(ke))}else Ce={lane:ke,tag:B.tag,payload:B.payload,callback:B.callback,next:null},Le===null?(_e=Le=Ce,se=$e):Le=Le.next=Ce,R|=ke;if(B=B.next,B===null){if(B=E.shared.pending,B===null)break;Ce=B,B=Ce.next,Ce.next=null,E.lastBaseUpdate=Ce,E.shared.pending=null}}while(!0);Le===null&&(se=$e),E.baseState=se,E.firstBaseUpdate=_e,E.lastBaseUpdate=Le,N===null&&(E.shared.lanes=0),Hs|=R,s.lanes=R,s.memoizedState=$e}}function yE(s,o){if(typeof s!="function")throw Error(n(191,s));s.call(o)}function bE(s,o){var f=s.callbacks;if(f!==null)for(s.callbacks=null,s=0;s<f.length;s++)yE(f[s],o)}var Yo=Y(null),o0=Y(0);function wE(s,o){s=Qi,q(o0,s),q(Yo,o),Qi=s|o.baseLanes}function Dx(){q(o0,Qi),q(Yo,Yo.current)}function Px(){Qi=o0.current,P(Yo),P(o0)}var Fs=0,yt=null,$t=null,yr=null,c0=!1,Xo=!1,Hl=!1,u0=0,Cu=0,Zo=null,k8=0;function hr(){throw Error(n(321))}function Rx(s,o){if(o===null)return!1;for(var f=0;f<o.length&&f<s.length;f++)if(!Wn(s[f],o[f]))return!1;return!0}function Mx(s,o,f,x,E,N){return Fs=N,yt=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,V.H=s===null||s.memoizedState===null?aj:ij,Hl=!1,N=f(x,E),Hl=!1,Xo&&(N=EE(o,f,x,E)),SE(s),N}function SE(s){V.H=x0;var o=$t!==null&&$t.next!==null;if(Fs=0,yr=$t=yt=null,c0=!1,Cu=0,Zo=null,o)throw Error(n(300));s===null||Ir||(s=s.dependencies,s!==null&&n0(s)&&(Ir=!0))}function EE(s,o,f,x){yt=s;var E=0;do{if(Xo&&(Zo=null),Cu=0,Xo=!1,25<=E)throw Error(n(301));if(E+=1,yr=$t=null,s.updateQueue!=null){var N=s.updateQueue;N.lastEffect=null,N.events=null,N.stores=null,N.memoCache!=null&&(N.memoCache.index=0)}V.H=F8,N=o(f,x)}while(Xo);return N}function C8(){var s=V.H,o=s.useState()[0];return o=typeof o.then=="function"?Ou(o):o,s=s.useState()[0],($t!==null?$t.memoizedState:null)!==s&&(yt.flags|=1024),o}function Fx(){var s=u0!==0;return u0=0,s}function Ix(s,o,f){o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~f}function Lx(s){if(c0){for(s=s.memoizedState;s!==null;){var o=s.queue;o!==null&&(o.pending=null),s=s.next}c0=!1}Fs=0,yr=$t=yt=null,Xo=!1,Cu=u0=0,Zo=null}function Mn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return yr===null?yt.memoizedState=yr=s:yr=yr.next=s,yr}function br(){if($t===null){var s=yt.alternate;s=s!==null?s.memoizedState:null}else s=$t.next;var o=yr===null?yt.memoizedState:yr.next;if(o!==null)yr=o,$t=s;else{if(s===null)throw yt.alternate===null?Error(n(467)):Error(n(310));$t=s,s={memoizedState:$t.memoizedState,baseState:$t.baseState,baseQueue:$t.baseQueue,queue:$t.queue,next:null},yr===null?yt.memoizedState=yr=s:yr=yr.next=s}return yr}function Bx(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ou(s){var o=Cu;return Cu+=1,Zo===null&&(Zo=[]),s=xE(Zo,s,o),o=yt,(yr===null?o.memoizedState:yr.next)===null&&(o=o.alternate,V.H=o===null||o.memoizedState===null?aj:ij),s}function f0(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Ou(s);if(s.$$typeof===A)return ln(s)}throw Error(n(438,String(s)))}function Ux(s){var o=null,f=yt.updateQueue;if(f!==null&&(o=f.memoCache),o==null){var x=yt.alternate;x!==null&&(x=x.updateQueue,x!==null&&(x=x.memoCache,x!=null&&(o={data:x.data.map(function(E){return E.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),f===null&&(f=Bx(),yt.updateQueue=f),f.memoCache=o,f=o.data[o.index],f===void 0)for(f=o.data[o.index]=Array(s),x=0;x<s;x++)f[x]=W;return o.index++,f}function Ki(s,o){return typeof o=="function"?o(s):o}function d0(s){var o=br();return $x(o,$t,s)}function $x(s,o,f){var x=s.queue;if(x===null)throw Error(n(311));x.lastRenderedReducer=f;var E=s.baseQueue,N=x.pending;if(N!==null){if(E!==null){var R=E.next;E.next=N.next,N.next=R}o.baseQueue=E=N,x.pending=null}if(N=s.baseState,E===null)s.memoizedState=N;else{o=E.next;var B=R=null,se=null,_e=o,Le=!1;do{var $e=_e.lane&-536870913;if($e!==_e.lane?(kt&$e)===$e:(Fs&$e)===$e){var ke=_e.revertLane;if(ke===0)se!==null&&(se=se.next={lane:0,revertLane:0,action:_e.action,hasEagerState:_e.hasEagerState,eagerState:_e.eagerState,next:null}),$e===Go&&(Le=!0);else if((Fs&ke)===ke){_e=_e.next,ke===Go&&(Le=!0);continue}else $e={lane:0,revertLane:_e.revertLane,action:_e.action,hasEagerState:_e.hasEagerState,eagerState:_e.eagerState,next:null},se===null?(B=se=$e,R=N):se=se.next=$e,yt.lanes|=ke,Hs|=ke;$e=_e.action,Hl&&f(N,$e),N=_e.hasEagerState?_e.eagerState:f(N,$e)}else ke={lane:$e,revertLane:_e.revertLane,action:_e.action,hasEagerState:_e.hasEagerState,eagerState:_e.eagerState,next:null},se===null?(B=se=ke,R=N):se=se.next=ke,yt.lanes|=$e,Hs|=$e;_e=_e.next}while(_e!==null&&_e!==o);if(se===null?R=N:se.next=B,!Wn(N,s.memoizedState)&&(Ir=!0,Le&&(f=Wo,f!==null)))throw f;s.memoizedState=N,s.baseState=R,s.baseQueue=se,x.lastRenderedState=N}return E===null&&(x.lanes=0),[s.memoizedState,x.dispatch]}function zx(s){var o=br(),f=o.queue;if(f===null)throw Error(n(311));f.lastRenderedReducer=s;var x=f.dispatch,E=f.pending,N=o.memoizedState;if(E!==null){f.pending=null;var R=E=E.next;do N=s(N,R.action),R=R.next;while(R!==E);Wn(N,o.memoizedState)||(Ir=!0),o.memoizedState=N,o.baseQueue===null&&(o.baseState=N),f.lastRenderedState=N}return[N,x]}function jE(s,o,f){var x=yt,E=br(),N=Mt;if(N){if(f===void 0)throw Error(n(407));f=f()}else f=o();var R=!Wn(($t||E).memoizedState,f);R&&(E.memoizedState=f,Ir=!0),E=E.queue;var B=_E.bind(null,x,E,s);if(Du(2048,8,B,[s]),E.getSnapshot!==o||R||yr!==null&&yr.memoizedState.tag&1){if(x.flags|=2048,Qo(9,h0(),AE.bind(null,x,E,f,o),null),Yt===null)throw Error(n(349));N||(Fs&124)!==0||NE(x,o,f)}return f}function NE(s,o,f){s.flags|=16384,s={getSnapshot:o,value:f},o=yt.updateQueue,o===null?(o=Bx(),yt.updateQueue=o,o.stores=[s]):(f=o.stores,f===null?o.stores=[s]:f.push(s))}function AE(s,o,f,x){o.value=f,o.getSnapshot=x,TE(o)&&kE(s)}function _E(s,o,f){return f(function(){TE(o)&&kE(s)})}function TE(s){var o=s.getSnapshot;s=s.value;try{var f=o();return!Wn(s,f)}catch{return!0}}function kE(s){var o=Ho(s,2);o!==null&&ea(o,s,2)}function Hx(s){var o=Mn();if(typeof s=="function"){var f=s;if(s=f(),Hl){ve(!0);try{f()}finally{ve(!1)}}}return o.memoizedState=o.baseState=s,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ki,lastRenderedState:s},o}function CE(s,o,f,x){return s.baseState=f,$x(s,$t,typeof x=="function"?x:Ki)}function O8(s,o,f,x,E){if(p0(s))throw Error(n(485));if(s=o.action,s!==null){var N={payload:E,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(R){N.listeners.push(R)}};V.T!==null?f(!0):N.isTransition=!1,x(N),f=o.pending,f===null?(N.next=o.pending=N,OE(o,N)):(N.next=f.next,o.pending=f.next=N)}}function OE(s,o){var f=o.action,x=o.payload,E=s.state;if(o.isTransition){var N=V.T,R={};V.T=R;try{var B=f(E,x),se=V.S;se!==null&&se(R,B),DE(s,o,B)}catch(_e){qx(s,o,_e)}finally{V.T=N}}else try{N=f(E,x),DE(s,o,N)}catch(_e){qx(s,o,_e)}}function DE(s,o,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(x){PE(s,o,x)},function(x){return qx(s,o,x)}):PE(s,o,f)}function PE(s,o,f){o.status="fulfilled",o.value=f,RE(o),s.state=f,o=s.pending,o!==null&&(f=o.next,f===o?s.pending=null:(f=f.next,o.next=f,OE(s,f)))}function qx(s,o,f){var x=s.pending;if(s.pending=null,x!==null){x=x.next;do o.status="rejected",o.reason=f,RE(o),o=o.next;while(o!==x)}s.action=null}function RE(s){s=s.listeners;for(var o=0;o<s.length;o++)(0,s[o])()}function ME(s,o){return o}function FE(s,o){if(Mt){var f=Yt.formState;if(f!==null){e:{var x=yt;if(Mt){if(or){t:{for(var E=or,N=gi;E.nodeType!==8;){if(!N){E=null;break t}if(E=ei(E.nextSibling),E===null){E=null;break t}}N=E.data,E=N==="F!"||N==="F"?E:null}if(E){or=ei(E.nextSibling),x=E.data==="F!";break e}}Bl(x)}x=!1}x&&(o=f[0])}}return f=Mn(),f.memoizedState=f.baseState=o,x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ME,lastRenderedState:o},f.queue=x,f=tj.bind(null,yt,x),x.dispatch=f,x=Hx(!1),N=Yx.bind(null,yt,!1,x.queue),x=Mn(),E={state:o,dispatch:null,action:s,pending:null},x.queue=E,f=O8.bind(null,yt,E,N,f),E.dispatch=f,x.memoizedState=s,[o,f,!1]}function IE(s){var o=br();return LE(o,$t,s)}function LE(s,o,f){if(o=$x(s,o,ME)[0],s=d0(Ki)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var x=Ou(o)}catch(R){throw R===Nu?s0:R}else x=o;o=br();var E=o.queue,N=E.dispatch;return f!==o.memoizedState&&(yt.flags|=2048,Qo(9,h0(),D8.bind(null,E,f),null)),[x,N,s]}function D8(s,o){s.action=o}function BE(s){var o=br(),f=$t;if(f!==null)return LE(o,f,s);br(),o=o.memoizedState,f=br();var x=f.queue.dispatch;return f.memoizedState=s,[o,x,!1]}function Qo(s,o,f,x){return s={tag:s,create:f,deps:x,inst:o,next:null},o=yt.updateQueue,o===null&&(o=Bx(),yt.updateQueue=o),f=o.lastEffect,f===null?o.lastEffect=s.next=s:(x=f.next,f.next=s,s.next=x,o.lastEffect=s),s}function h0(){return{destroy:void 0,resource:void 0}}function UE(){return br().memoizedState}function m0(s,o,f,x){var E=Mn();x=x===void 0?null:x,yt.flags|=s,E.memoizedState=Qo(1|o,h0(),f,x)}function Du(s,o,f,x){var E=br();x=x===void 0?null:x;var N=E.memoizedState.inst;$t!==null&&x!==null&&Rx(x,$t.memoizedState.deps)?E.memoizedState=Qo(o,N,f,x):(yt.flags|=s,E.memoizedState=Qo(1|o,N,f,x))}function $E(s,o){m0(8390656,8,s,o)}function zE(s,o){Du(2048,8,s,o)}function HE(s,o){return Du(4,2,s,o)}function qE(s,o){return Du(4,4,s,o)}function VE(s,o){if(typeof o=="function"){s=s();var f=o(s);return function(){typeof f=="function"?f():o(null)}}if(o!=null)return s=s(),o.current=s,function(){o.current=null}}function KE(s,o,f){f=f!=null?f.concat([s]):null,Du(4,4,VE.bind(null,o,s),f)}function Vx(){}function GE(s,o){var f=br();o=o===void 0?null:o;var x=f.memoizedState;return o!==null&&Rx(o,x[1])?x[0]:(f.memoizedState=[s,o],s)}function WE(s,o){var f=br();o=o===void 0?null:o;var x=f.memoizedState;if(o!==null&&Rx(o,x[1]))return x[0];if(x=s(),Hl){ve(!0);try{s()}finally{ve(!1)}}return f.memoizedState=[x,o],x}function Kx(s,o,f){return f===void 0||(Fs&1073741824)!==0?s.memoizedState=o:(s.memoizedState=f,s=Zj(),yt.lanes|=s,Hs|=s,f)}function YE(s,o,f,x){return Wn(f,o)?f:Yo.current!==null?(s=Kx(s,f,x),Wn(s,o)||(Ir=!0),s):(Fs&42)===0?(Ir=!0,s.memoizedState=f):(s=Zj(),yt.lanes|=s,Hs|=s,o)}function XE(s,o,f,x,E){var N=H.p;H.p=N!==0&&8>N?N:8;var R=V.T,B={};V.T=B,Yx(s,!1,o,f);try{var se=E(),_e=V.S;if(_e!==null&&_e(B,se),se!==null&&typeof se=="object"&&typeof se.then=="function"){var Le=T8(se,x);Pu(s,o,Le,Jn(s))}else Pu(s,o,x,Jn(s))}catch($e){Pu(s,o,{then:function(){},status:"rejected",reason:$e},Jn())}finally{H.p=N,V.T=R}}function P8(){}function Gx(s,o,f,x){if(s.tag!==5)throw Error(n(476));var E=ZE(s).queue;XE(s,E,o,Se,f===null?P8:function(){return QE(s),f(x)})}function ZE(s){var o=s.memoizedState;if(o!==null)return o;o={memoizedState:Se,baseState:Se,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ki,lastRenderedState:Se},next:null};var f={};return o.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ki,lastRenderedState:f},next:null},s.memoizedState=o,s=s.alternate,s!==null&&(s.memoizedState=o),o}function QE(s){var o=ZE(s).next.queue;Pu(s,o,{},Jn())}function Wx(){return ln(Zu)}function JE(){return br().memoizedState}function ej(){return br().memoizedState}function R8(s){for(var o=s.return;o!==null;){switch(o.tag){case 24:case 3:var f=Jn();s=Rs(f);var x=Ms(o,s,f);x!==null&&(ea(x,o,f),_u(x,o,f)),o={cache:jx()},s.payload=o;return}o=o.return}}function M8(s,o,f){var x=Jn();f={lane:x,revertLane:0,action:f,hasEagerState:!1,eagerState:null,next:null},p0(s)?rj(o,f):(f=mx(s,o,f,x),f!==null&&(ea(f,s,x),nj(f,o,x)))}function tj(s,o,f){var x=Jn();Pu(s,o,f,x)}function Pu(s,o,f,x){var E={lane:x,revertLane:0,action:f,hasEagerState:!1,eagerState:null,next:null};if(p0(s))rj(o,E);else{var N=s.alternate;if(s.lanes===0&&(N===null||N.lanes===0)&&(N=o.lastRenderedReducer,N!==null))try{var R=o.lastRenderedState,B=N(R,f);if(E.hasEagerState=!0,E.eagerState=B,Wn(B,R))return Qd(s,o,E,0),Yt===null&&Zd(),!1}catch{}finally{}if(f=mx(s,o,E,x),f!==null)return ea(f,s,x),nj(f,o,x),!0}return!1}function Yx(s,o,f,x){if(x={lane:2,revertLane:_v(),action:x,hasEagerState:!1,eagerState:null,next:null},p0(s)){if(o)throw Error(n(479))}else o=mx(s,f,x,2),o!==null&&ea(o,s,2)}function p0(s){var o=s.alternate;return s===yt||o!==null&&o===yt}function rj(s,o){Xo=c0=!0;var f=s.pending;f===null?o.next=o:(o.next=f.next,f.next=o),s.pending=o}function nj(s,o,f){if((f&4194048)!==0){var x=o.lanes;x&=s.pendingLanes,f|=x,o.lanes=f,Tl(s,f)}}var x0={readContext:ln,use:f0,useCallback:hr,useContext:hr,useEffect:hr,useImperativeHandle:hr,useLayoutEffect:hr,useInsertionEffect:hr,useMemo:hr,useReducer:hr,useRef:hr,useState:hr,useDebugValue:hr,useDeferredValue:hr,useTransition:hr,useSyncExternalStore:hr,useId:hr,useHostTransitionStatus:hr,useFormState:hr,useActionState:hr,useOptimistic:hr,useMemoCache:hr,useCacheRefresh:hr},aj={readContext:ln,use:f0,useCallback:function(s,o){return Mn().memoizedState=[s,o===void 0?null:o],s},useContext:ln,useEffect:$E,useImperativeHandle:function(s,o,f){f=f!=null?f.concat([s]):null,m0(4194308,4,VE.bind(null,o,s),f)},useLayoutEffect:function(s,o){return m0(4194308,4,s,o)},useInsertionEffect:function(s,o){m0(4,2,s,o)},useMemo:function(s,o){var f=Mn();o=o===void 0?null:o;var x=s();if(Hl){ve(!0);try{s()}finally{ve(!1)}}return f.memoizedState=[x,o],x},useReducer:function(s,o,f){var x=Mn();if(f!==void 0){var E=f(o);if(Hl){ve(!0);try{f(o)}finally{ve(!1)}}}else E=o;return x.memoizedState=x.baseState=E,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:E},x.queue=s,s=s.dispatch=M8.bind(null,yt,s),[x.memoizedState,s]},useRef:function(s){var o=Mn();return s={current:s},o.memoizedState=s},useState:function(s){s=Hx(s);var o=s.queue,f=tj.bind(null,yt,o);return o.dispatch=f,[s.memoizedState,f]},useDebugValue:Vx,useDeferredValue:function(s,o){var f=Mn();return Kx(f,s,o)},useTransition:function(){var s=Hx(!1);return s=XE.bind(null,yt,s.queue,!0,!1),Mn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,o,f){var x=yt,E=Mn();if(Mt){if(f===void 0)throw Error(n(407));f=f()}else{if(f=o(),Yt===null)throw Error(n(349));(kt&124)!==0||NE(x,o,f)}E.memoizedState=f;var N={value:f,getSnapshot:o};return E.queue=N,$E(_E.bind(null,x,N,s),[s]),x.flags|=2048,Qo(9,h0(),AE.bind(null,x,N,f,o),null),f},useId:function(){var s=Mn(),o=Yt.identifierPrefix;if(Mt){var f=Hi,x=zi;f=(x&~(1<<32-ne(x)-1)).toString(32)+f,o=""+o+"R"+f,f=u0++,0<f&&(o+="H"+f.toString(32)),o+=""}else f=k8++,o=""+o+"r"+f.toString(32)+"";return s.memoizedState=o},useHostTransitionStatus:Wx,useFormState:FE,useActionState:FE,useOptimistic:function(s){var o=Mn();o.memoizedState=o.baseState=s;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=f,o=Yx.bind(null,yt,!0,f),f.dispatch=o,[s,o]},useMemoCache:Ux,useCacheRefresh:function(){return Mn().memoizedState=R8.bind(null,yt)}},ij={readContext:ln,use:f0,useCallback:GE,useContext:ln,useEffect:zE,useImperativeHandle:KE,useInsertionEffect:HE,useLayoutEffect:qE,useMemo:WE,useReducer:d0,useRef:UE,useState:function(){return d0(Ki)},useDebugValue:Vx,useDeferredValue:function(s,o){var f=br();return YE(f,$t.memoizedState,s,o)},useTransition:function(){var s=d0(Ki)[0],o=br().memoizedState;return[typeof s=="boolean"?s:Ou(s),o]},useSyncExternalStore:jE,useId:JE,useHostTransitionStatus:Wx,useFormState:IE,useActionState:IE,useOptimistic:function(s,o){var f=br();return CE(f,$t,s,o)},useMemoCache:Ux,useCacheRefresh:ej},F8={readContext:ln,use:f0,useCallback:GE,useContext:ln,useEffect:zE,useImperativeHandle:KE,useInsertionEffect:HE,useLayoutEffect:qE,useMemo:WE,useReducer:zx,useRef:UE,useState:function(){return zx(Ki)},useDebugValue:Vx,useDeferredValue:function(s,o){var f=br();return $t===null?Kx(f,s,o):YE(f,$t.memoizedState,s,o)},useTransition:function(){var s=zx(Ki)[0],o=br().memoizedState;return[typeof s=="boolean"?s:Ou(s),o]},useSyncExternalStore:jE,useId:JE,useHostTransitionStatus:Wx,useFormState:BE,useActionState:BE,useOptimistic:function(s,o){var f=br();return $t!==null?CE(f,$t,s,o):(f.baseState=s,[s,f.queue.dispatch])},useMemoCache:Ux,useCacheRefresh:ej},Jo=null,Ru=0;function v0(s){var o=Ru;return Ru+=1,Jo===null&&(Jo=[]),xE(Jo,s,o)}function Mu(s,o){o=o.props.ref,s.ref=o!==void 0?o:null}function g0(s,o){throw o.$$typeof===p?Error(n(525)):(s=Object.prototype.toString.call(o),Error(n(31,s==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":s)))}function sj(s){var o=s._init;return o(s._payload)}function lj(s){function o(we,he){if(s){var Ne=we.deletions;Ne===null?(we.deletions=[he],we.flags|=16):Ne.push(he)}}function f(we,he){if(!s)return null;for(;he!==null;)o(we,he),he=he.sibling;return null}function x(we){for(var he=new Map;we!==null;)we.key!==null?he.set(we.key,we):he.set(we.index,we),we=we.sibling;return he}function E(we,he){return we=$i(we,he),we.index=0,we.sibling=null,we}function N(we,he,Ne){return we.index=Ne,s?(Ne=we.alternate,Ne!==null?(Ne=Ne.index,Ne<he?(we.flags|=67108866,he):Ne):(we.flags|=67108866,he)):(we.flags|=1048576,he)}function R(we){return s&&we.alternate===null&&(we.flags|=67108866),we}function B(we,he,Ne,Ue){return he===null||he.tag!==6?(he=xx(Ne,we.mode,Ue),he.return=we,he):(he=E(he,Ne),he.return=we,he)}function se(we,he,Ne,Ue){var at=Ne.type;return at===w?Le(we,he,Ne.props.children,Ue,Ne.key):he!==null&&(he.elementType===at||typeof at=="object"&&at!==null&&at.$$typeof===I&&sj(at)===he.type)?(he=E(he,Ne.props),Mu(he,Ne),he.return=we,he):(he=e0(Ne.type,Ne.key,Ne.props,null,we.mode,Ue),Mu(he,Ne),he.return=we,he)}function _e(we,he,Ne,Ue){return he===null||he.tag!==4||he.stateNode.containerInfo!==Ne.containerInfo||he.stateNode.implementation!==Ne.implementation?(he=vx(Ne,we.mode,Ue),he.return=we,he):(he=E(he,Ne.children||[]),he.return=we,he)}function Le(we,he,Ne,Ue,at){return he===null||he.tag!==7?(he=Ml(Ne,we.mode,Ue,at),he.return=we,he):(he=E(he,Ne),he.return=we,he)}function $e(we,he,Ne){if(typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint")return he=xx(""+he,we.mode,Ne),he.return=we,he;if(typeof he=="object"&&he!==null){switch(he.$$typeof){case v:return Ne=e0(he.type,he.key,he.props,null,we.mode,Ne),Mu(Ne,he),Ne.return=we,Ne;case g:return he=vx(he,we.mode,Ne),he.return=we,he;case I:var Ue=he._init;return he=Ue(he._payload),$e(we,he,Ne)}if(ue(he)||F(he))return he=Ml(he,we.mode,Ne,null),he.return=we,he;if(typeof he.then=="function")return $e(we,v0(he),Ne);if(he.$$typeof===A)return $e(we,a0(we,he),Ne);g0(we,he)}return null}function ke(we,he,Ne,Ue){var at=he!==null?he.key:null;if(typeof Ne=="string"&&Ne!==""||typeof Ne=="number"||typeof Ne=="bigint")return at!==null?null:B(we,he,""+Ne,Ue);if(typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case v:return Ne.key===at?se(we,he,Ne,Ue):null;case g:return Ne.key===at?_e(we,he,Ne,Ue):null;case I:return at=Ne._init,Ne=at(Ne._payload),ke(we,he,Ne,Ue)}if(ue(Ne)||F(Ne))return at!==null?null:Le(we,he,Ne,Ue,null);if(typeof Ne.then=="function")return ke(we,he,v0(Ne),Ue);if(Ne.$$typeof===A)return ke(we,he,a0(we,Ne),Ue);g0(we,Ne)}return null}function Ce(we,he,Ne,Ue,at){if(typeof Ue=="string"&&Ue!==""||typeof Ue=="number"||typeof Ue=="bigint")return we=we.get(Ne)||null,B(he,we,""+Ue,at);if(typeof Ue=="object"&&Ue!==null){switch(Ue.$$typeof){case v:return we=we.get(Ue.key===null?Ne:Ue.key)||null,se(he,we,Ue,at);case g:return we=we.get(Ue.key===null?Ne:Ue.key)||null,_e(he,we,Ue,at);case I:var bt=Ue._init;return Ue=bt(Ue._payload),Ce(we,he,Ne,Ue,at)}if(ue(Ue)||F(Ue))return we=we.get(Ne)||null,Le(he,we,Ue,at,null);if(typeof Ue.then=="function")return Ce(we,he,Ne,v0(Ue),at);if(Ue.$$typeof===A)return Ce(we,he,Ne,a0(he,Ue),at);g0(he,Ue)}return null}function ut(we,he,Ne,Ue){for(var at=null,bt=null,lt=he,ct=he=0,Br=null;lt!==null&&ct<Ne.length;ct++){lt.index>ct?(Br=lt,lt=null):Br=lt.sibling;var Pt=ke(we,lt,Ne[ct],Ue);if(Pt===null){lt===null&&(lt=Br);break}s&&lt&&Pt.alternate===null&&o(we,lt),he=N(Pt,he,ct),bt===null?at=Pt:bt.sibling=Pt,bt=Pt,lt=Br}if(ct===Ne.length)return f(we,lt),Mt&&Il(we,ct),at;if(lt===null){for(;ct<Ne.length;ct++)lt=$e(we,Ne[ct],Ue),lt!==null&&(he=N(lt,he,ct),bt===null?at=lt:bt.sibling=lt,bt=lt);return Mt&&Il(we,ct),at}for(lt=x(lt);ct<Ne.length;ct++)Br=Ce(lt,we,ct,Ne[ct],Ue),Br!==null&&(s&&Br.alternate!==null&&lt.delete(Br.key===null?ct:Br.key),he=N(Br,he,ct),bt===null?at=Br:bt.sibling=Br,bt=Br);return s&&lt.forEach(function(Qs){return o(we,Qs)}),Mt&&Il(we,ct),at}function ot(we,he,Ne,Ue){if(Ne==null)throw Error(n(151));for(var at=null,bt=null,lt=he,ct=he=0,Br=null,Pt=Ne.next();lt!==null&&!Pt.done;ct++,Pt=Ne.next()){lt.index>ct?(Br=lt,lt=null):Br=lt.sibling;var Qs=ke(we,lt,Pt.value,Ue);if(Qs===null){lt===null&&(lt=Br);break}s&&lt&&Qs.alternate===null&&o(we,lt),he=N(Qs,he,ct),bt===null?at=Qs:bt.sibling=Qs,bt=Qs,lt=Br}if(Pt.done)return f(we,lt),Mt&&Il(we,ct),at;if(lt===null){for(;!Pt.done;ct++,Pt=Ne.next())Pt=$e(we,Pt.value,Ue),Pt!==null&&(he=N(Pt,he,ct),bt===null?at=Pt:bt.sibling=Pt,bt=Pt);return Mt&&Il(we,ct),at}for(lt=x(lt);!Pt.done;ct++,Pt=Ne.next())Pt=Ce(lt,we,ct,Pt.value,Ue),Pt!==null&&(s&&Pt.alternate!==null&&lt.delete(Pt.key===null?ct:Pt.key),he=N(Pt,he,ct),bt===null?at=Pt:bt.sibling=Pt,bt=Pt);return s&&lt.forEach(function(IF){return o(we,IF)}),Mt&&Il(we,ct),at}function Ht(we,he,Ne,Ue){if(typeof Ne=="object"&&Ne!==null&&Ne.type===w&&Ne.key===null&&(Ne=Ne.props.children),typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case v:e:{for(var at=Ne.key;he!==null;){if(he.key===at){if(at=Ne.type,at===w){if(he.tag===7){f(we,he.sibling),Ue=E(he,Ne.props.children),Ue.return=we,we=Ue;break e}}else if(he.elementType===at||typeof at=="object"&&at!==null&&at.$$typeof===I&&sj(at)===he.type){f(we,he.sibling),Ue=E(he,Ne.props),Mu(Ue,Ne),Ue.return=we,we=Ue;break e}f(we,he);break}else o(we,he);he=he.sibling}Ne.type===w?(Ue=Ml(Ne.props.children,we.mode,Ue,Ne.key),Ue.return=we,we=Ue):(Ue=e0(Ne.type,Ne.key,Ne.props,null,we.mode,Ue),Mu(Ue,Ne),Ue.return=we,we=Ue)}return R(we);case g:e:{for(at=Ne.key;he!==null;){if(he.key===at)if(he.tag===4&&he.stateNode.containerInfo===Ne.containerInfo&&he.stateNode.implementation===Ne.implementation){f(we,he.sibling),Ue=E(he,Ne.children||[]),Ue.return=we,we=Ue;break e}else{f(we,he);break}else o(we,he);he=he.sibling}Ue=vx(Ne,we.mode,Ue),Ue.return=we,we=Ue}return R(we);case I:return at=Ne._init,Ne=at(Ne._payload),Ht(we,he,Ne,Ue)}if(ue(Ne))return ut(we,he,Ne,Ue);if(F(Ne)){if(at=F(Ne),typeof at!="function")throw Error(n(150));return Ne=at.call(Ne),ot(we,he,Ne,Ue)}if(typeof Ne.then=="function")return Ht(we,he,v0(Ne),Ue);if(Ne.$$typeof===A)return Ht(we,he,a0(we,Ne),Ue);g0(we,Ne)}return typeof Ne=="string"&&Ne!==""||typeof Ne=="number"||typeof Ne=="bigint"?(Ne=""+Ne,he!==null&&he.tag===6?(f(we,he.sibling),Ue=E(he,Ne),Ue.return=we,we=Ue):(f(we,he),Ue=xx(Ne,we.mode,Ue),Ue.return=we,we=Ue),R(we)):f(we,he)}return function(we,he,Ne,Ue){try{Ru=0;var at=Ht(we,he,Ne,Ue);return Jo=null,at}catch(lt){if(lt===Nu||lt===s0)throw lt;var bt=Yn(29,lt,null,we.mode);return bt.lanes=Ue,bt.return=we,bt}finally{}}}var ec=lj(!0),oj=lj(!1),_a=Y(null),yi=null;function Is(s){var o=s.alternate;q(Or,Or.current&1),q(_a,s),yi===null&&(o===null||Yo.current!==null||o.memoizedState!==null)&&(yi=s)}function cj(s){if(s.tag===22){if(q(Or,Or.current),q(_a,s),yi===null){var o=s.alternate;o!==null&&o.memoizedState!==null&&(yi=s)}}else Ls()}function Ls(){q(Or,Or.current),q(_a,_a.current)}function Gi(s){P(_a),yi===s&&(yi=null),P(Or)}var Or=Y(0);function y0(s){for(var o=s;o!==null;){if(o.tag===13){var f=o.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||f.data==="$?"||Bv(f)))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}function Xx(s,o,f,x){o=s.memoizedState,f=f(x,o),f=f==null?o:m({},o,f),s.memoizedState=f,s.lanes===0&&(s.updateQueue.baseState=f)}var Zx={enqueueSetState:function(s,o,f){s=s._reactInternals;var x=Jn(),E=Rs(x);E.payload=o,f!=null&&(E.callback=f),o=Ms(s,E,x),o!==null&&(ea(o,s,x),_u(o,s,x))},enqueueReplaceState:function(s,o,f){s=s._reactInternals;var x=Jn(),E=Rs(x);E.tag=1,E.payload=o,f!=null&&(E.callback=f),o=Ms(s,E,x),o!==null&&(ea(o,s,x),_u(o,s,x))},enqueueForceUpdate:function(s,o){s=s._reactInternals;var f=Jn(),x=Rs(f);x.tag=2,o!=null&&(x.callback=o),o=Ms(s,x,f),o!==null&&(ea(o,s,f),_u(o,s,f))}};function uj(s,o,f,x,E,N,R){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(x,N,R):o.prototype&&o.prototype.isPureReactComponent?!vu(f,x)||!vu(E,N):!0}function fj(s,o,f,x){s=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(f,x),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(f,x),o.state!==s&&Zx.enqueueReplaceState(o,o.state,null)}function ql(s,o){var f=o;if("ref"in o){f={};for(var x in o)x!=="ref"&&(f[x]=o[x])}if(s=s.defaultProps){f===o&&(f=m({},f));for(var E in s)f[E]===void 0&&(f[E]=s[E])}return f}var b0=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function dj(s){b0(s)}function hj(s){console.error(s)}function mj(s){b0(s)}function w0(s,o){try{var f=s.onUncaughtError;f(o.value,{componentStack:o.stack})}catch(x){setTimeout(function(){throw x})}}function pj(s,o,f){try{var x=s.onCaughtError;x(f.value,{componentStack:f.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(E){setTimeout(function(){throw E})}}function Qx(s,o,f){return f=Rs(f),f.tag=3,f.payload={element:null},f.callback=function(){w0(s,o)},f}function xj(s){return s=Rs(s),s.tag=3,s}function vj(s,o,f,x){var E=f.type.getDerivedStateFromError;if(typeof E=="function"){var N=x.value;s.payload=function(){return E(N)},s.callback=function(){pj(o,f,x)}}var R=f.stateNode;R!==null&&typeof R.componentDidCatch=="function"&&(s.callback=function(){pj(o,f,x),typeof E!="function"&&(qs===null?qs=new Set([this]):qs.add(this));var B=x.stack;this.componentDidCatch(x.value,{componentStack:B!==null?B:""})})}function I8(s,o,f,x,E){if(f.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){if(o=f.alternate,o!==null&&Su(o,f,E,!0),f=_a.current,f!==null){switch(f.tag){case 13:return yi===null?Sv():f.alternate===null&&cr===0&&(cr=3),f.flags&=-257,f.flags|=65536,f.lanes=E,x===_x?f.flags|=16384:(o=f.updateQueue,o===null?f.updateQueue=new Set([x]):o.add(x),jv(s,x,E)),!1;case 22:return f.flags|=65536,x===_x?f.flags|=16384:(o=f.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([x])},f.updateQueue=o):(f=o.retryQueue,f===null?o.retryQueue=new Set([x]):f.add(x)),jv(s,x,E)),!1}throw Error(n(435,f.tag))}return jv(s,x,E),Sv(),!1}if(Mt)return o=_a.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=E,x!==bx&&(s=Error(n(422),{cause:x}),wu(Ea(s,f)))):(x!==bx&&(o=Error(n(423),{cause:x}),wu(Ea(o,f))),s=s.current.alternate,s.flags|=65536,E&=-E,s.lanes|=E,x=Ea(x,f),E=Qx(s.stateNode,x,E),Cx(s,E),cr!==4&&(cr=2)),!1;var N=Error(n(520),{cause:x});if(N=Ea(N,f),zu===null?zu=[N]:zu.push(N),cr!==4&&(cr=2),o===null)return!0;x=Ea(x,f),f=o;do{switch(f.tag){case 3:return f.flags|=65536,s=E&-E,f.lanes|=s,s=Qx(f.stateNode,x,s),Cx(f,s),!1;case 1:if(o=f.type,N=f.stateNode,(f.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||N!==null&&typeof N.componentDidCatch=="function"&&(qs===null||!qs.has(N))))return f.flags|=65536,E&=-E,f.lanes|=E,E=xj(E),vj(E,s,f,x),Cx(f,E),!1}f=f.return}while(f!==null);return!1}var gj=Error(n(461)),Ir=!1;function Wr(s,o,f,x){o.child=s===null?oj(o,null,f,x):ec(o,s.child,f,x)}function yj(s,o,f,x,E){f=f.render;var N=o.ref;if("ref"in x){var R={};for(var B in x)B!=="ref"&&(R[B]=x[B])}else R=x;return $l(o),x=Mx(s,o,f,R,N,E),B=Fx(),s!==null&&!Ir?(Ix(s,o,E),Wi(s,o,E)):(Mt&&B&&gx(o),o.flags|=1,Wr(s,o,x,E),o.child)}function bj(s,o,f,x,E){if(s===null){var N=f.type;return typeof N=="function"&&!px(N)&&N.defaultProps===void 0&&f.compare===null?(o.tag=15,o.type=N,wj(s,o,N,x,E)):(s=e0(f.type,null,x,o,o.mode,E),s.ref=o.ref,s.return=o,o.child=s)}if(N=s.child,!sv(s,E)){var R=N.memoizedProps;if(f=f.compare,f=f!==null?f:vu,f(R,x)&&s.ref===o.ref)return Wi(s,o,E)}return o.flags|=1,s=$i(N,x),s.ref=o.ref,s.return=o,o.child=s}function wj(s,o,f,x,E){if(s!==null){var N=s.memoizedProps;if(vu(N,x)&&s.ref===o.ref)if(Ir=!1,o.pendingProps=x=N,sv(s,E))(s.flags&131072)!==0&&(Ir=!0);else return o.lanes=s.lanes,Wi(s,o,E)}return Jx(s,o,f,x,E)}function Sj(s,o,f){var x=o.pendingProps,E=x.children,N=s!==null?s.memoizedState:null;if(x.mode==="hidden"){if((o.flags&128)!==0){if(x=N!==null?N.baseLanes|f:f,s!==null){for(E=o.child=s.child,N=0;E!==null;)N=N|E.lanes|E.childLanes,E=E.sibling;o.childLanes=N&~x}else o.childLanes=0,o.child=null;return Ej(s,o,x,f)}if((f&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},s!==null&&i0(o,N!==null?N.cachePool:null),N!==null?wE(o,N):Dx(),cj(o);else return o.lanes=o.childLanes=536870912,Ej(s,o,N!==null?N.baseLanes|f:f,f)}else N!==null?(i0(o,N.cachePool),wE(o,N),Ls(),o.memoizedState=null):(s!==null&&i0(o,null),Dx(),Ls());return Wr(s,o,E,f),o.child}function Ej(s,o,f,x){var E=Ax();return E=E===null?null:{parent:Cr._currentValue,pool:E},o.memoizedState={baseLanes:f,cachePool:E},s!==null&&i0(o,null),Dx(),cj(o),s!==null&&Su(s,o,x,!0),null}function S0(s,o){var f=o.ref;if(f===null)s!==null&&s.ref!==null&&(o.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(n(284));(s===null||s.ref!==f)&&(o.flags|=4194816)}}function Jx(s,o,f,x,E){return $l(o),f=Mx(s,o,f,x,void 0,E),x=Fx(),s!==null&&!Ir?(Ix(s,o,E),Wi(s,o,E)):(Mt&&x&&gx(o),o.flags|=1,Wr(s,o,f,E),o.child)}function jj(s,o,f,x,E,N){return $l(o),o.updateQueue=null,f=EE(o,x,f,E),SE(s),x=Fx(),s!==null&&!Ir?(Ix(s,o,N),Wi(s,o,N)):(Mt&&x&&gx(o),o.flags|=1,Wr(s,o,f,N),o.child)}function Nj(s,o,f,x,E){if($l(o),o.stateNode===null){var N=qo,R=f.contextType;typeof R=="object"&&R!==null&&(N=ln(R)),N=new f(x,N),o.memoizedState=N.state!==null&&N.state!==void 0?N.state:null,N.updater=Zx,o.stateNode=N,N._reactInternals=o,N=o.stateNode,N.props=x,N.state=o.memoizedState,N.refs={},Tx(o),R=f.contextType,N.context=typeof R=="object"&&R!==null?ln(R):qo,N.state=o.memoizedState,R=f.getDerivedStateFromProps,typeof R=="function"&&(Xx(o,f,R,x),N.state=o.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof N.getSnapshotBeforeUpdate=="function"||typeof N.UNSAFE_componentWillMount!="function"&&typeof N.componentWillMount!="function"||(R=N.state,typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount(),R!==N.state&&Zx.enqueueReplaceState(N,N.state,null),ku(o,x,N,E),Tu(),N.state=o.memoizedState),typeof N.componentDidMount=="function"&&(o.flags|=4194308),x=!0}else if(s===null){N=o.stateNode;var B=o.memoizedProps,se=ql(f,B);N.props=se;var _e=N.context,Le=f.contextType;R=qo,typeof Le=="object"&&Le!==null&&(R=ln(Le));var $e=f.getDerivedStateFromProps;Le=typeof $e=="function"||typeof N.getSnapshotBeforeUpdate=="function",B=o.pendingProps!==B,Le||typeof N.UNSAFE_componentWillReceiveProps!="function"&&typeof N.componentWillReceiveProps!="function"||(B||_e!==R)&&fj(o,N,x,R),Ps=!1;var ke=o.memoizedState;N.state=ke,ku(o,x,N,E),Tu(),_e=o.memoizedState,B||ke!==_e||Ps?(typeof $e=="function"&&(Xx(o,f,$e,x),_e=o.memoizedState),(se=Ps||uj(o,f,se,x,ke,_e,R))?(Le||typeof N.UNSAFE_componentWillMount!="function"&&typeof N.componentWillMount!="function"||(typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount()),typeof N.componentDidMount=="function"&&(o.flags|=4194308)):(typeof N.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=x,o.memoizedState=_e),N.props=x,N.state=_e,N.context=R,x=se):(typeof N.componentDidMount=="function"&&(o.flags|=4194308),x=!1)}else{N=o.stateNode,kx(s,o),R=o.memoizedProps,Le=ql(f,R),N.props=Le,$e=o.pendingProps,ke=N.context,_e=f.contextType,se=qo,typeof _e=="object"&&_e!==null&&(se=ln(_e)),B=f.getDerivedStateFromProps,(_e=typeof B=="function"||typeof N.getSnapshotBeforeUpdate=="function")||typeof N.UNSAFE_componentWillReceiveProps!="function"&&typeof N.componentWillReceiveProps!="function"||(R!==$e||ke!==se)&&fj(o,N,x,se),Ps=!1,ke=o.memoizedState,N.state=ke,ku(o,x,N,E),Tu();var Ce=o.memoizedState;R!==$e||ke!==Ce||Ps||s!==null&&s.dependencies!==null&&n0(s.dependencies)?(typeof B=="function"&&(Xx(o,f,B,x),Ce=o.memoizedState),(Le=Ps||uj(o,f,Le,x,ke,Ce,se)||s!==null&&s.dependencies!==null&&n0(s.dependencies))?(_e||typeof N.UNSAFE_componentWillUpdate!="function"&&typeof N.componentWillUpdate!="function"||(typeof N.componentWillUpdate=="function"&&N.componentWillUpdate(x,Ce,se),typeof N.UNSAFE_componentWillUpdate=="function"&&N.UNSAFE_componentWillUpdate(x,Ce,se)),typeof N.componentDidUpdate=="function"&&(o.flags|=4),typeof N.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof N.componentDidUpdate!="function"||R===s.memoizedProps&&ke===s.memoizedState||(o.flags|=4),typeof N.getSnapshotBeforeUpdate!="function"||R===s.memoizedProps&&ke===s.memoizedState||(o.flags|=1024),o.memoizedProps=x,o.memoizedState=Ce),N.props=x,N.state=Ce,N.context=se,x=Le):(typeof N.componentDidUpdate!="function"||R===s.memoizedProps&&ke===s.memoizedState||(o.flags|=4),typeof N.getSnapshotBeforeUpdate!="function"||R===s.memoizedProps&&ke===s.memoizedState||(o.flags|=1024),x=!1)}return N=x,S0(s,o),x=(o.flags&128)!==0,N||x?(N=o.stateNode,f=x&&typeof f.getDerivedStateFromError!="function"?null:N.render(),o.flags|=1,s!==null&&x?(o.child=ec(o,s.child,null,E),o.child=ec(o,null,f,E)):Wr(s,o,f,E),o.memoizedState=N.state,s=o.child):s=Wi(s,o,E),s}function Aj(s,o,f,x){return bu(),o.flags|=256,Wr(s,o,f,x),o.child}var ev={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function tv(s){return{baseLanes:s,cachePool:hE()}}function rv(s,o,f){return s=s!==null?s.childLanes&~f:0,o&&(s|=Ta),s}function _j(s,o,f){var x=o.pendingProps,E=!1,N=(o.flags&128)!==0,R;if((R=N)||(R=s!==null&&s.memoizedState===null?!1:(Or.current&2)!==0),R&&(E=!0,o.flags&=-129),R=(o.flags&32)!==0,o.flags&=-33,s===null){if(Mt){if(E?Is(o):Ls(),Mt){var B=or,se;if(se=B){e:{for(se=B,B=gi;se.nodeType!==8;){if(!B){B=null;break e}if(se=ei(se.nextSibling),se===null){B=null;break e}}B=se}B!==null?(o.memoizedState={dehydrated:B,treeContext:Fl!==null?{id:zi,overflow:Hi}:null,retryLane:536870912,hydrationErrors:null},se=Yn(18,null,null,0),se.stateNode=B,se.return=o,o.child=se,Nn=o,or=null,se=!0):se=!1}se||Bl(o)}if(B=o.memoizedState,B!==null&&(B=B.dehydrated,B!==null))return Bv(B)?o.lanes=32:o.lanes=536870912,null;Gi(o)}return B=x.children,x=x.fallback,E?(Ls(),E=o.mode,B=E0({mode:"hidden",children:B},E),x=Ml(x,E,f,null),B.return=o,x.return=o,B.sibling=x,o.child=B,E=o.child,E.memoizedState=tv(f),E.childLanes=rv(s,R,f),o.memoizedState=ev,x):(Is(o),nv(o,B))}if(se=s.memoizedState,se!==null&&(B=se.dehydrated,B!==null)){if(N)o.flags&256?(Is(o),o.flags&=-257,o=av(s,o,f)):o.memoizedState!==null?(Ls(),o.child=s.child,o.flags|=128,o=null):(Ls(),E=x.fallback,B=o.mode,x=E0({mode:"visible",children:x.children},B),E=Ml(E,B,f,null),E.flags|=2,x.return=o,E.return=o,x.sibling=E,o.child=x,ec(o,s.child,null,f),x=o.child,x.memoizedState=tv(f),x.childLanes=rv(s,R,f),o.memoizedState=ev,o=E);else if(Is(o),Bv(B)){if(R=B.nextSibling&&B.nextSibling.dataset,R)var _e=R.dgst;R=_e,x=Error(n(419)),x.stack="",x.digest=R,wu({value:x,source:null,stack:null}),o=av(s,o,f)}else if(Ir||Su(s,o,f,!1),R=(f&s.childLanes)!==0,Ir||R){if(R=Yt,R!==null&&(x=f&-f,x=(x&42)!==0?1:ks(x),x=(x&(R.suspendedLanes|f))!==0?0:x,x!==0&&x!==se.retryLane))throw se.retryLane=x,Ho(s,x),ea(R,s,x),gj;B.data==="$?"||Sv(),o=av(s,o,f)}else B.data==="$?"?(o.flags|=192,o.child=s.child,o=null):(s=se.treeContext,or=ei(B.nextSibling),Nn=o,Mt=!0,Ll=null,gi=!1,s!==null&&(Na[Aa++]=zi,Na[Aa++]=Hi,Na[Aa++]=Fl,zi=s.id,Hi=s.overflow,Fl=o),o=nv(o,x.children),o.flags|=4096);return o}return E?(Ls(),E=x.fallback,B=o.mode,se=s.child,_e=se.sibling,x=$i(se,{mode:"hidden",children:x.children}),x.subtreeFlags=se.subtreeFlags&65011712,_e!==null?E=$i(_e,E):(E=Ml(E,B,f,null),E.flags|=2),E.return=o,x.return=o,x.sibling=E,o.child=x,x=E,E=o.child,B=s.child.memoizedState,B===null?B=tv(f):(se=B.cachePool,se!==null?(_e=Cr._currentValue,se=se.parent!==_e?{parent:_e,pool:_e}:se):se=hE(),B={baseLanes:B.baseLanes|f,cachePool:se}),E.memoizedState=B,E.childLanes=rv(s,R,f),o.memoizedState=ev,x):(Is(o),f=s.child,s=f.sibling,f=$i(f,{mode:"visible",children:x.children}),f.return=o,f.sibling=null,s!==null&&(R=o.deletions,R===null?(o.deletions=[s],o.flags|=16):R.push(s)),o.child=f,o.memoizedState=null,f)}function nv(s,o){return o=E0({mode:"visible",children:o},s.mode),o.return=s,s.child=o}function E0(s,o){return s=Yn(22,s,null,o),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function av(s,o,f){return ec(o,s.child,null,f),s=nv(o,o.pendingProps.children),s.flags|=2,o.memoizedState=null,s}function Tj(s,o,f){s.lanes|=o;var x=s.alternate;x!==null&&(x.lanes|=o),Sx(s.return,o,f)}function iv(s,o,f,x,E){var N=s.memoizedState;N===null?s.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:x,tail:f,tailMode:E}:(N.isBackwards=o,N.rendering=null,N.renderingStartTime=0,N.last=x,N.tail=f,N.tailMode=E)}function kj(s,o,f){var x=o.pendingProps,E=x.revealOrder,N=x.tail;if(Wr(s,o,x.children,f),x=Or.current,(x&2)!==0)x=x&1|2,o.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=o.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Tj(s,f,o);else if(s.tag===19)Tj(s,f,o);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break e;for(;s.sibling===null;){if(s.return===null||s.return===o)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}x&=1}switch(q(Or,x),E){case"forwards":for(f=o.child,E=null;f!==null;)s=f.alternate,s!==null&&y0(s)===null&&(E=f),f=f.sibling;f=E,f===null?(E=o.child,o.child=null):(E=f.sibling,f.sibling=null),iv(o,!1,E,f,N);break;case"backwards":for(f=null,E=o.child,o.child=null;E!==null;){if(s=E.alternate,s!==null&&y0(s)===null){o.child=E;break}s=E.sibling,E.sibling=f,f=E,E=s}iv(o,!0,f,null,N);break;case"together":iv(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Wi(s,o,f){if(s!==null&&(o.dependencies=s.dependencies),Hs|=o.lanes,(f&o.childLanes)===0)if(s!==null){if(Su(s,o,f,!1),(f&o.childLanes)===0)return null}else return null;if(s!==null&&o.child!==s.child)throw Error(n(153));if(o.child!==null){for(s=o.child,f=$i(s,s.pendingProps),o.child=f,f.return=o;s.sibling!==null;)s=s.sibling,f=f.sibling=$i(s,s.pendingProps),f.return=o;f.sibling=null}return o.child}function sv(s,o){return(s.lanes&o)!==0?!0:(s=s.dependencies,!!(s!==null&&n0(s)))}function L8(s,o,f){switch(o.tag){case 3:Re(o,o.stateNode.containerInfo),Ds(o,Cr,s.memoizedState.cache),bu();break;case 27:case 5:be(o);break;case 4:Re(o,o.stateNode.containerInfo);break;case 10:Ds(o,o.type,o.memoizedProps.value);break;case 13:var x=o.memoizedState;if(x!==null)return x.dehydrated!==null?(Is(o),o.flags|=128,null):(f&o.child.childLanes)!==0?_j(s,o,f):(Is(o),s=Wi(s,o,f),s!==null?s.sibling:null);Is(o);break;case 19:var E=(s.flags&128)!==0;if(x=(f&o.childLanes)!==0,x||(Su(s,o,f,!1),x=(f&o.childLanes)!==0),E){if(x)return kj(s,o,f);o.flags|=128}if(E=o.memoizedState,E!==null&&(E.rendering=null,E.tail=null,E.lastEffect=null),q(Or,Or.current),x)break;return null;case 22:case 23:return o.lanes=0,Sj(s,o,f);case 24:Ds(o,Cr,s.memoizedState.cache)}return Wi(s,o,f)}function Cj(s,o,f){if(s!==null)if(s.memoizedProps!==o.pendingProps)Ir=!0;else{if(!sv(s,f)&&(o.flags&128)===0)return Ir=!1,L8(s,o,f);Ir=(s.flags&131072)!==0}else Ir=!1,Mt&&(o.flags&1048576)!==0&&sE(o,r0,o.index);switch(o.lanes=0,o.tag){case 16:e:{s=o.pendingProps;var x=o.elementType,E=x._init;if(x=E(x._payload),o.type=x,typeof x=="function")px(x)?(s=ql(x,s),o.tag=1,o=Nj(null,o,x,s,f)):(o.tag=0,o=Jx(null,o,x,s,f));else{if(x!=null){if(E=x.$$typeof,E===k){o.tag=11,o=yj(null,o,x,s,f);break e}else if(E===T){o.tag=14,o=bj(null,o,x,s,f);break e}}throw o=je(x)||x,Error(n(306,o,""))}}return o;case 0:return Jx(s,o,o.type,o.pendingProps,f);case 1:return x=o.type,E=ql(x,o.pendingProps),Nj(s,o,x,E,f);case 3:e:{if(Re(o,o.stateNode.containerInfo),s===null)throw Error(n(387));x=o.pendingProps;var N=o.memoizedState;E=N.element,kx(s,o),ku(o,x,null,f);var R=o.memoizedState;if(x=R.cache,Ds(o,Cr,x),x!==N.cache&&Ex(o,[Cr],f,!0),Tu(),x=R.element,N.isDehydrated)if(N={element:x,isDehydrated:!1,cache:R.cache},o.updateQueue.baseState=N,o.memoizedState=N,o.flags&256){o=Aj(s,o,x,f);break e}else if(x!==E){E=Ea(Error(n(424)),o),wu(E),o=Aj(s,o,x,f);break e}else{switch(s=o.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(or=ei(s.firstChild),Nn=o,Mt=!0,Ll=null,gi=!0,f=oj(o,null,x,f),o.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling}else{if(bu(),x===E){o=Wi(s,o,f);break e}Wr(s,o,x,f)}o=o.child}return o;case 26:return S0(s,o),s===null?(f=RN(o.type,null,o.pendingProps,null))?o.memoizedState=f:Mt||(f=o.type,s=o.pendingProps,x=I0(fe.current).createElement(f),x[vr]=o,x[gr]=s,Xr(x,f,s),le(x),o.stateNode=x):o.memoizedState=RN(o.type,s.memoizedProps,o.pendingProps,s.memoizedState),null;case 27:return be(o),s===null&&Mt&&(x=o.stateNode=ON(o.type,o.pendingProps,fe.current),Nn=o,gi=!0,E=or,Gs(o.type)?(Uv=E,or=ei(x.firstChild)):or=E),Wr(s,o,o.pendingProps.children,f),S0(s,o),s===null&&(o.flags|=4194304),o.child;case 5:return s===null&&Mt&&((E=x=or)&&(x=dF(x,o.type,o.pendingProps,gi),x!==null?(o.stateNode=x,Nn=o,or=ei(x.firstChild),gi=!1,E=!0):E=!1),E||Bl(o)),be(o),E=o.type,N=o.pendingProps,R=s!==null?s.memoizedProps:null,x=N.children,Fv(E,N)?x=null:R!==null&&Fv(E,R)&&(o.flags|=32),o.memoizedState!==null&&(E=Mx(s,o,C8,null,null,f),Zu._currentValue=E),S0(s,o),Wr(s,o,x,f),o.child;case 6:return s===null&&Mt&&((s=f=or)&&(f=hF(f,o.pendingProps,gi),f!==null?(o.stateNode=f,Nn=o,or=null,s=!0):s=!1),s||Bl(o)),null;case 13:return _j(s,o,f);case 4:return Re(o,o.stateNode.containerInfo),x=o.pendingProps,s===null?o.child=ec(o,null,x,f):Wr(s,o,x,f),o.child;case 11:return yj(s,o,o.type,o.pendingProps,f);case 7:return Wr(s,o,o.pendingProps,f),o.child;case 8:return Wr(s,o,o.pendingProps.children,f),o.child;case 12:return Wr(s,o,o.pendingProps.children,f),o.child;case 10:return x=o.pendingProps,Ds(o,o.type,x.value),Wr(s,o,x.children,f),o.child;case 9:return E=o.type._context,x=o.pendingProps.children,$l(o),E=ln(E),x=x(E),o.flags|=1,Wr(s,o,x,f),o.child;case 14:return bj(s,o,o.type,o.pendingProps,f);case 15:return wj(s,o,o.type,o.pendingProps,f);case 19:return kj(s,o,f);case 31:return x=o.pendingProps,f=o.mode,x={mode:x.mode,children:x.children},s===null?(f=E0(x,f),f.ref=o.ref,o.child=f,f.return=o,o=f):(f=$i(s.child,x),f.ref=o.ref,o.child=f,f.return=o,o=f),o;case 22:return Sj(s,o,f);case 24:return $l(o),x=ln(Cr),s===null?(E=Ax(),E===null&&(E=Yt,N=jx(),E.pooledCache=N,N.refCount++,N!==null&&(E.pooledCacheLanes|=f),E=N),o.memoizedState={parent:x,cache:E},Tx(o),Ds(o,Cr,E)):((s.lanes&f)!==0&&(kx(s,o),ku(o,null,null,f),Tu()),E=s.memoizedState,N=o.memoizedState,E.parent!==x?(E={parent:x,cache:x},o.memoizedState=E,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=E),Ds(o,Cr,x)):(x=N.cache,Ds(o,Cr,x),x!==E.cache&&Ex(o,[Cr],f,!0))),Wr(s,o,o.pendingProps.children,f),o.child;case 29:throw o.pendingProps}throw Error(n(156,o.tag))}function Yi(s){s.flags|=4}function Oj(s,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!BN(o)){if(o=_a.current,o!==null&&((kt&4194048)===kt?yi!==null:(kt&62914560)!==kt&&(kt&536870912)===0||o!==yi))throw Au=_x,mE;s.flags|=8192}}function j0(s,o){o!==null&&(s.flags|=4),s.flags&16384&&(o=s.tag!==22?_s():536870912,s.lanes|=o,ac|=o)}function Fu(s,o){if(!Mt)switch(s.tailMode){case"hidden":o=s.tail;for(var f=null;o!==null;)o.alternate!==null&&(f=o),o=o.sibling;f===null?s.tail=null:f.sibling=null;break;case"collapsed":f=s.tail;for(var x=null;f!==null;)f.alternate!==null&&(x=f),f=f.sibling;x===null?o||s.tail===null?s.tail=null:s.tail.sibling=null:x.sibling=null}}function sr(s){var o=s.alternate!==null&&s.alternate.child===s.child,f=0,x=0;if(o)for(var E=s.child;E!==null;)f|=E.lanes|E.childLanes,x|=E.subtreeFlags&65011712,x|=E.flags&65011712,E.return=s,E=E.sibling;else for(E=s.child;E!==null;)f|=E.lanes|E.childLanes,x|=E.subtreeFlags,x|=E.flags,E.return=s,E=E.sibling;return s.subtreeFlags|=x,s.childLanes=f,o}function B8(s,o,f){var x=o.pendingProps;switch(yx(o),o.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return sr(o),null;case 1:return sr(o),null;case 3:return f=o.stateNode,x=null,s!==null&&(x=s.memoizedState.cache),o.memoizedState.cache!==x&&(o.flags|=2048),Vi(Cr),re(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(s===null||s.child===null)&&(yu(o)?Yi(o):s===null||s.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,cE())),sr(o),null;case 26:return f=o.memoizedState,s===null?(Yi(o),f!==null?(sr(o),Oj(o,f)):(sr(o),o.flags&=-16777217)):f?f!==s.memoizedState?(Yi(o),sr(o),Oj(o,f)):(sr(o),o.flags&=-16777217):(s.memoizedProps!==x&&Yi(o),sr(o),o.flags&=-16777217),null;case 27:Ae(o),f=fe.current;var E=o.type;if(s!==null&&o.stateNode!=null)s.memoizedProps!==x&&Yi(o);else{if(!x){if(o.stateNode===null)throw Error(n(166));return sr(o),null}s=G.current,yu(o)?lE(o):(s=ON(E,x,f),o.stateNode=s,Yi(o))}return sr(o),null;case 5:if(Ae(o),f=o.type,s!==null&&o.stateNode!=null)s.memoizedProps!==x&&Yi(o);else{if(!x){if(o.stateNode===null)throw Error(n(166));return sr(o),null}if(s=G.current,yu(o))lE(o);else{switch(E=I0(fe.current),s){case 1:s=E.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:s=E.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":s=E.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":s=E.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":s=E.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof x.is=="string"?E.createElement("select",{is:x.is}):E.createElement("select"),x.multiple?s.multiple=!0:x.size&&(s.size=x.size);break;default:s=typeof x.is=="string"?E.createElement(f,{is:x.is}):E.createElement(f)}}s[vr]=o,s[gr]=x;e:for(E=o.child;E!==null;){if(E.tag===5||E.tag===6)s.appendChild(E.stateNode);else if(E.tag!==4&&E.tag!==27&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===o)break e;for(;E.sibling===null;){if(E.return===null||E.return===o)break e;E=E.return}E.sibling.return=E.return,E=E.sibling}o.stateNode=s;e:switch(Xr(s,f,x),f){case"button":case"input":case"select":case"textarea":s=!!x.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&Yi(o)}}return sr(o),o.flags&=-16777217,null;case 6:if(s&&o.stateNode!=null)s.memoizedProps!==x&&Yi(o);else{if(typeof x!="string"&&o.stateNode===null)throw Error(n(166));if(s=fe.current,yu(o)){if(s=o.stateNode,f=o.memoizedProps,x=null,E=Nn,E!==null)switch(E.tag){case 27:case 5:x=E.memoizedProps}s[vr]=o,s=!!(s.nodeValue===f||x!==null&&x.suppressHydrationWarning===!0||jN(s.nodeValue,f)),s||Bl(o)}else s=I0(s).createTextNode(x),s[vr]=o,o.stateNode=s}return sr(o),null;case 13:if(x=o.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(E=yu(o),x!==null&&x.dehydrated!==null){if(s===null){if(!E)throw Error(n(318));if(E=o.memoizedState,E=E!==null?E.dehydrated:null,!E)throw Error(n(317));E[vr]=o}else bu(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;sr(o),E=!1}else E=cE(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=E),E=!0;if(!E)return o.flags&256?(Gi(o),o):(Gi(o),null)}if(Gi(o),(o.flags&128)!==0)return o.lanes=f,o;if(f=x!==null,s=s!==null&&s.memoizedState!==null,f){x=o.child,E=null,x.alternate!==null&&x.alternate.memoizedState!==null&&x.alternate.memoizedState.cachePool!==null&&(E=x.alternate.memoizedState.cachePool.pool);var N=null;x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(N=x.memoizedState.cachePool.pool),N!==E&&(x.flags|=2048)}return f!==s&&f&&(o.child.flags|=8192),j0(o,o.updateQueue),sr(o),null;case 4:return re(),s===null&&Ov(o.stateNode.containerInfo),sr(o),null;case 10:return Vi(o.type),sr(o),null;case 19:if(P(Or),E=o.memoizedState,E===null)return sr(o),null;if(x=(o.flags&128)!==0,N=E.rendering,N===null)if(x)Fu(E,!1);else{if(cr!==0||s!==null&&(s.flags&128)!==0)for(s=o.child;s!==null;){if(N=y0(s),N!==null){for(o.flags|=128,Fu(E,!1),s=N.updateQueue,o.updateQueue=s,j0(o,s),o.subtreeFlags=0,s=f,f=o.child;f!==null;)iE(f,s),f=f.sibling;return q(Or,Or.current&1|2),o.child}s=s.sibling}E.tail!==null&&ce()>_0&&(o.flags|=128,x=!0,Fu(E,!1),o.lanes=4194304)}else{if(!x)if(s=y0(N),s!==null){if(o.flags|=128,x=!0,s=s.updateQueue,o.updateQueue=s,j0(o,s),Fu(E,!0),E.tail===null&&E.tailMode==="hidden"&&!N.alternate&&!Mt)return sr(o),null}else 2*ce()-E.renderingStartTime>_0&&f!==536870912&&(o.flags|=128,x=!0,Fu(E,!1),o.lanes=4194304);E.isBackwards?(N.sibling=o.child,o.child=N):(s=E.last,s!==null?s.sibling=N:o.child=N,E.last=N)}return E.tail!==null?(o=E.tail,E.rendering=o,E.tail=o.sibling,E.renderingStartTime=ce(),o.sibling=null,s=Or.current,q(Or,x?s&1|2:s&1),o):(sr(o),null);case 22:case 23:return Gi(o),Px(),x=o.memoizedState!==null,s!==null?s.memoizedState!==null!==x&&(o.flags|=8192):x&&(o.flags|=8192),x?(f&536870912)!==0&&(o.flags&128)===0&&(sr(o),o.subtreeFlags&6&&(o.flags|=8192)):sr(o),f=o.updateQueue,f!==null&&j0(o,f.retryQueue),f=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),x=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(x=o.memoizedState.cachePool.pool),x!==f&&(o.flags|=2048),s!==null&&P(zl),null;case 24:return f=null,s!==null&&(f=s.memoizedState.cache),o.memoizedState.cache!==f&&(o.flags|=2048),Vi(Cr),sr(o),null;case 25:return null;case 30:return null}throw Error(n(156,o.tag))}function U8(s,o){switch(yx(o),o.tag){case 1:return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 3:return Vi(Cr),re(),s=o.flags,(s&65536)!==0&&(s&128)===0?(o.flags=s&-65537|128,o):null;case 26:case 27:case 5:return Ae(o),null;case 13:if(Gi(o),s=o.memoizedState,s!==null&&s.dehydrated!==null){if(o.alternate===null)throw Error(n(340));bu()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 19:return P(Or),null;case 4:return re(),null;case 10:return Vi(o.type),null;case 22:case 23:return Gi(o),Px(),s!==null&&P(zl),s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 24:return Vi(Cr),null;case 25:return null;default:return null}}function Dj(s,o){switch(yx(o),o.tag){case 3:Vi(Cr),re();break;case 26:case 27:case 5:Ae(o);break;case 4:re();break;case 13:Gi(o);break;case 19:P(Or);break;case 10:Vi(o.type);break;case 22:case 23:Gi(o),Px(),s!==null&&P(zl);break;case 24:Vi(Cr)}}function Iu(s,o){try{var f=o.updateQueue,x=f!==null?f.lastEffect:null;if(x!==null){var E=x.next;f=E;do{if((f.tag&s)===s){x=void 0;var N=f.create,R=f.inst;x=N(),R.destroy=x}f=f.next}while(f!==E)}}catch(B){Kt(o,o.return,B)}}function Bs(s,o,f){try{var x=o.updateQueue,E=x!==null?x.lastEffect:null;if(E!==null){var N=E.next;x=N;do{if((x.tag&s)===s){var R=x.inst,B=R.destroy;if(B!==void 0){R.destroy=void 0,E=o;var se=f,_e=B;try{_e()}catch(Le){Kt(E,se,Le)}}}x=x.next}while(x!==N)}}catch(Le){Kt(o,o.return,Le)}}function Pj(s){var o=s.updateQueue;if(o!==null){var f=s.stateNode;try{bE(o,f)}catch(x){Kt(s,s.return,x)}}}function Rj(s,o,f){f.props=ql(s.type,s.memoizedProps),f.state=s.memoizedState;try{f.componentWillUnmount()}catch(x){Kt(s,o,x)}}function Lu(s,o){try{var f=s.ref;if(f!==null){switch(s.tag){case 26:case 27:case 5:var x=s.stateNode;break;case 30:x=s.stateNode;break;default:x=s.stateNode}typeof f=="function"?s.refCleanup=f(x):f.current=x}}catch(E){Kt(s,o,E)}}function bi(s,o){var f=s.ref,x=s.refCleanup;if(f!==null)if(typeof x=="function")try{x()}catch(E){Kt(s,o,E)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(E){Kt(s,o,E)}else f.current=null}function Mj(s){var o=s.type,f=s.memoizedProps,x=s.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":f.autoFocus&&x.focus();break e;case"img":f.src?x.src=f.src:f.srcSet&&(x.srcset=f.srcSet)}}catch(E){Kt(s,s.return,E)}}function lv(s,o,f){try{var x=s.stateNode;lF(x,s.type,f,o),x[gr]=o}catch(E){Kt(s,s.return,E)}}function Fj(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Gs(s.type)||s.tag===4}function ov(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Fj(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Gs(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function cv(s,o,f){var x=s.tag;if(x===5||x===6)s=s.stateNode,o?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(s,o):(o=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,o.appendChild(s),f=f._reactRootContainer,f!=null||o.onclick!==null||(o.onclick=F0));else if(x!==4&&(x===27&&Gs(s.type)&&(f=s.stateNode,o=null),s=s.child,s!==null))for(cv(s,o,f),s=s.sibling;s!==null;)cv(s,o,f),s=s.sibling}function N0(s,o,f){var x=s.tag;if(x===5||x===6)s=s.stateNode,o?f.insertBefore(s,o):f.appendChild(s);else if(x!==4&&(x===27&&Gs(s.type)&&(f=s.stateNode),s=s.child,s!==null))for(N0(s,o,f),s=s.sibling;s!==null;)N0(s,o,f),s=s.sibling}function Ij(s){var o=s.stateNode,f=s.memoizedProps;try{for(var x=s.type,E=o.attributes;E.length;)o.removeAttributeNode(E[0]);Xr(o,x,f),o[vr]=s,o[gr]=f}catch(N){Kt(s,s.return,N)}}var Xi=!1,mr=!1,uv=!1,Lj=typeof WeakSet=="function"?WeakSet:Set,Lr=null;function $8(s,o){if(s=s.containerInfo,Rv=H0,s=YS(s),ox(s)){if("selectionStart"in s)var f={start:s.selectionStart,end:s.selectionEnd};else e:{f=(f=s.ownerDocument)&&f.defaultView||window;var x=f.getSelection&&f.getSelection();if(x&&x.rangeCount!==0){f=x.anchorNode;var E=x.anchorOffset,N=x.focusNode;x=x.focusOffset;try{f.nodeType,N.nodeType}catch{f=null;break e}var R=0,B=-1,se=-1,_e=0,Le=0,$e=s,ke=null;t:for(;;){for(var Ce;$e!==f||E!==0&&$e.nodeType!==3||(B=R+E),$e!==N||x!==0&&$e.nodeType!==3||(se=R+x),$e.nodeType===3&&(R+=$e.nodeValue.length),(Ce=$e.firstChild)!==null;)ke=$e,$e=Ce;for(;;){if($e===s)break t;if(ke===f&&++_e===E&&(B=R),ke===N&&++Le===x&&(se=R),(Ce=$e.nextSibling)!==null)break;$e=ke,ke=$e.parentNode}$e=Ce}f=B===-1||se===-1?null:{start:B,end:se}}else f=null}f=f||{start:0,end:0}}else f=null;for(Mv={focusedElem:s,selectionRange:f},H0=!1,Lr=o;Lr!==null;)if(o=Lr,s=o.child,(o.subtreeFlags&1024)!==0&&s!==null)s.return=o,Lr=s;else for(;Lr!==null;){switch(o=Lr,N=o.alternate,s=o.flags,o.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&N!==null){s=void 0,f=o,E=N.memoizedProps,N=N.memoizedState,x=f.stateNode;try{var ut=ql(f.type,E,f.elementType===f.type);s=x.getSnapshotBeforeUpdate(ut,N),x.__reactInternalSnapshotBeforeUpdate=s}catch(ot){Kt(f,f.return,ot)}}break;case 3:if((s&1024)!==0){if(s=o.stateNode.containerInfo,f=s.nodeType,f===9)Lv(s);else if(f===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Lv(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(n(163))}if(s=o.sibling,s!==null){s.return=o.return,Lr=s;break}Lr=o.return}}function Bj(s,o,f){var x=f.flags;switch(f.tag){case 0:case 11:case 15:Us(s,f),x&4&&Iu(5,f);break;case 1:if(Us(s,f),x&4)if(s=f.stateNode,o===null)try{s.componentDidMount()}catch(R){Kt(f,f.return,R)}else{var E=ql(f.type,o.memoizedProps);o=o.memoizedState;try{s.componentDidUpdate(E,o,s.__reactInternalSnapshotBeforeUpdate)}catch(R){Kt(f,f.return,R)}}x&64&&Pj(f),x&512&&Lu(f,f.return);break;case 3:if(Us(s,f),x&64&&(s=f.updateQueue,s!==null)){if(o=null,f.child!==null)switch(f.child.tag){case 27:case 5:o=f.child.stateNode;break;case 1:o=f.child.stateNode}try{bE(s,o)}catch(R){Kt(f,f.return,R)}}break;case 27:o===null&&x&4&&Ij(f);case 26:case 5:Us(s,f),o===null&&x&4&&Mj(f),x&512&&Lu(f,f.return);break;case 12:Us(s,f);break;case 13:Us(s,f),x&4&&zj(s,f),x&64&&(s=f.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(f=X8.bind(null,f),mF(s,f))));break;case 22:if(x=f.memoizedState!==null||Xi,!x){o=o!==null&&o.memoizedState!==null||mr,E=Xi;var N=mr;Xi=x,(mr=o)&&!N?$s(s,f,(f.subtreeFlags&8772)!==0):Us(s,f),Xi=E,mr=N}break;case 30:break;default:Us(s,f)}}function Uj(s){var o=s.alternate;o!==null&&(s.alternate=null,Uj(o)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(o=s.stateNode,o!==null&&X(o)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var er=null,Fn=!1;function Zi(s,o,f){for(f=f.child;f!==null;)$j(s,o,f),f=f.sibling}function $j(s,o,f){if(Ge&&typeof Ge.onCommitFiberUnmount=="function")try{Ge.onCommitFiberUnmount(ge,f)}catch{}switch(f.tag){case 26:mr||bi(f,o),Zi(s,o,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:mr||bi(f,o);var x=er,E=Fn;Gs(f.type)&&(er=f.stateNode,Fn=!1),Zi(s,o,f),Gu(f.stateNode),er=x,Fn=E;break;case 5:mr||bi(f,o);case 6:if(x=er,E=Fn,er=null,Zi(s,o,f),er=x,Fn=E,er!==null)if(Fn)try{(er.nodeType===9?er.body:er.nodeName==="HTML"?er.ownerDocument.body:er).removeChild(f.stateNode)}catch(N){Kt(f,o,N)}else try{er.removeChild(f.stateNode)}catch(N){Kt(f,o,N)}break;case 18:er!==null&&(Fn?(s=er,kN(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,f.stateNode),tf(s)):kN(er,f.stateNode));break;case 4:x=er,E=Fn,er=f.stateNode.containerInfo,Fn=!0,Zi(s,o,f),er=x,Fn=E;break;case 0:case 11:case 14:case 15:mr||Bs(2,f,o),mr||Bs(4,f,o),Zi(s,o,f);break;case 1:mr||(bi(f,o),x=f.stateNode,typeof x.componentWillUnmount=="function"&&Rj(f,o,x)),Zi(s,o,f);break;case 21:Zi(s,o,f);break;case 22:mr=(x=mr)||f.memoizedState!==null,Zi(s,o,f),mr=x;break;default:Zi(s,o,f)}}function zj(s,o){if(o.memoizedState===null&&(s=o.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{tf(s)}catch(f){Kt(o,o.return,f)}}function z8(s){switch(s.tag){case 13:case 19:var o=s.stateNode;return o===null&&(o=s.stateNode=new Lj),o;case 22:return s=s.stateNode,o=s._retryCache,o===null&&(o=s._retryCache=new Lj),o;default:throw Error(n(435,s.tag))}}function fv(s,o){var f=z8(s);o.forEach(function(x){var E=Z8.bind(null,s,x);f.has(x)||(f.add(x),x.then(E,E))})}function Xn(s,o){var f=o.deletions;if(f!==null)for(var x=0;x<f.length;x++){var E=f[x],N=s,R=o,B=R;e:for(;B!==null;){switch(B.tag){case 27:if(Gs(B.type)){er=B.stateNode,Fn=!1;break e}break;case 5:er=B.stateNode,Fn=!1;break e;case 3:case 4:er=B.stateNode.containerInfo,Fn=!0;break e}B=B.return}if(er===null)throw Error(n(160));$j(N,R,E),er=null,Fn=!1,N=E.alternate,N!==null&&(N.return=null),E.return=null}if(o.subtreeFlags&13878)for(o=o.child;o!==null;)Hj(o,s),o=o.sibling}var Ja=null;function Hj(s,o){var f=s.alternate,x=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Xn(o,s),Zn(s),x&4&&(Bs(3,s,s.return),Iu(3,s),Bs(5,s,s.return));break;case 1:Xn(o,s),Zn(s),x&512&&(mr||f===null||bi(f,f.return)),x&64&&Xi&&(s=s.updateQueue,s!==null&&(x=s.callbacks,x!==null&&(f=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=f===null?x:f.concat(x))));break;case 26:var E=Ja;if(Xn(o,s),Zn(s),x&512&&(mr||f===null||bi(f,f.return)),x&4){var N=f!==null?f.memoizedState:null;if(x=s.memoizedState,f===null)if(x===null)if(s.stateNode===null){e:{x=s.type,f=s.memoizedProps,E=E.ownerDocument||E;t:switch(x){case"title":N=E.getElementsByTagName("title")[0],(!N||N[K]||N[vr]||N.namespaceURI==="http://www.w3.org/2000/svg"||N.hasAttribute("itemprop"))&&(N=E.createElement(x),E.head.insertBefore(N,E.querySelector("head > title"))),Xr(N,x,f),N[vr]=s,le(N),x=N;break e;case"link":var R=IN("link","href",E).get(x+(f.href||""));if(R){for(var B=0;B<R.length;B++)if(N=R[B],N.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&N.getAttribute("rel")===(f.rel==null?null:f.rel)&&N.getAttribute("title")===(f.title==null?null:f.title)&&N.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){R.splice(B,1);break t}}N=E.createElement(x),Xr(N,x,f),E.head.appendChild(N);break;case"meta":if(R=IN("meta","content",E).get(x+(f.content||""))){for(B=0;B<R.length;B++)if(N=R[B],N.getAttribute("content")===(f.content==null?null:""+f.content)&&N.getAttribute("name")===(f.name==null?null:f.name)&&N.getAttribute("property")===(f.property==null?null:f.property)&&N.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&N.getAttribute("charset")===(f.charSet==null?null:f.charSet)){R.splice(B,1);break t}}N=E.createElement(x),Xr(N,x,f),E.head.appendChild(N);break;default:throw Error(n(468,x))}N[vr]=s,le(N),x=N}s.stateNode=x}else LN(E,s.type,s.stateNode);else s.stateNode=FN(E,x,s.memoizedProps);else N!==x?(N===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):N.count--,x===null?LN(E,s.type,s.stateNode):FN(E,x,s.memoizedProps)):x===null&&s.stateNode!==null&&lv(s,s.memoizedProps,f.memoizedProps)}break;case 27:Xn(o,s),Zn(s),x&512&&(mr||f===null||bi(f,f.return)),f!==null&&x&4&&lv(s,s.memoizedProps,f.memoizedProps);break;case 5:if(Xn(o,s),Zn(s),x&512&&(mr||f===null||bi(f,f.return)),s.flags&32){E=s.stateNode;try{Fo(E,"")}catch(Ce){Kt(s,s.return,Ce)}}x&4&&s.stateNode!=null&&(E=s.memoizedProps,lv(s,E,f!==null?f.memoizedProps:E)),x&1024&&(uv=!0);break;case 6:if(Xn(o,s),Zn(s),x&4){if(s.stateNode===null)throw Error(n(162));x=s.memoizedProps,f=s.stateNode;try{f.nodeValue=x}catch(Ce){Kt(s,s.return,Ce)}}break;case 3:if(U0=null,E=Ja,Ja=L0(o.containerInfo),Xn(o,s),Ja=E,Zn(s),x&4&&f!==null&&f.memoizedState.isDehydrated)try{tf(o.containerInfo)}catch(Ce){Kt(s,s.return,Ce)}uv&&(uv=!1,qj(s));break;case 4:x=Ja,Ja=L0(s.stateNode.containerInfo),Xn(o,s),Zn(s),Ja=x;break;case 12:Xn(o,s),Zn(s);break;case 13:Xn(o,s),Zn(s),s.child.flags&8192&&s.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(vv=ce()),x&4&&(x=s.updateQueue,x!==null&&(s.updateQueue=null,fv(s,x)));break;case 22:E=s.memoizedState!==null;var se=f!==null&&f.memoizedState!==null,_e=Xi,Le=mr;if(Xi=_e||E,mr=Le||se,Xn(o,s),mr=Le,Xi=_e,Zn(s),x&8192)e:for(o=s.stateNode,o._visibility=E?o._visibility&-2:o._visibility|1,E&&(f===null||se||Xi||mr||Vl(s)),f=null,o=s;;){if(o.tag===5||o.tag===26){if(f===null){se=f=o;try{if(N=se.stateNode,E)R=N.style,typeof R.setProperty=="function"?R.setProperty("display","none","important"):R.display="none";else{B=se.stateNode;var $e=se.memoizedProps.style,ke=$e!=null&&$e.hasOwnProperty("display")?$e.display:null;B.style.display=ke==null||typeof ke=="boolean"?"":(""+ke).trim()}}catch(Ce){Kt(se,se.return,Ce)}}}else if(o.tag===6){if(f===null){se=o;try{se.stateNode.nodeValue=E?"":se.memoizedProps}catch(Ce){Kt(se,se.return,Ce)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===s)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break e;for(;o.sibling===null;){if(o.return===null||o.return===s)break e;f===o&&(f=null),o=o.return}f===o&&(f=null),o.sibling.return=o.return,o=o.sibling}x&4&&(x=s.updateQueue,x!==null&&(f=x.retryQueue,f!==null&&(x.retryQueue=null,fv(s,f))));break;case 19:Xn(o,s),Zn(s),x&4&&(x=s.updateQueue,x!==null&&(s.updateQueue=null,fv(s,x)));break;case 30:break;case 21:break;default:Xn(o,s),Zn(s)}}function Zn(s){var o=s.flags;if(o&2){try{for(var f,x=s.return;x!==null;){if(Fj(x)){f=x;break}x=x.return}if(f==null)throw Error(n(160));switch(f.tag){case 27:var E=f.stateNode,N=ov(s);N0(s,N,E);break;case 5:var R=f.stateNode;f.flags&32&&(Fo(R,""),f.flags&=-33);var B=ov(s);N0(s,B,R);break;case 3:case 4:var se=f.stateNode.containerInfo,_e=ov(s);cv(s,_e,se);break;default:throw Error(n(161))}}catch(Le){Kt(s,s.return,Le)}s.flags&=-3}o&4096&&(s.flags&=-4097)}function qj(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var o=s;qj(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),s=s.sibling}}function Us(s,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)Bj(s,o.alternate,o),o=o.sibling}function Vl(s){for(s=s.child;s!==null;){var o=s;switch(o.tag){case 0:case 11:case 14:case 15:Bs(4,o,o.return),Vl(o);break;case 1:bi(o,o.return);var f=o.stateNode;typeof f.componentWillUnmount=="function"&&Rj(o,o.return,f),Vl(o);break;case 27:Gu(o.stateNode);case 26:case 5:bi(o,o.return),Vl(o);break;case 22:o.memoizedState===null&&Vl(o);break;case 30:Vl(o);break;default:Vl(o)}s=s.sibling}}function $s(s,o,f){for(f=f&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var x=o.alternate,E=s,N=o,R=N.flags;switch(N.tag){case 0:case 11:case 15:$s(E,N,f),Iu(4,N);break;case 1:if($s(E,N,f),x=N,E=x.stateNode,typeof E.componentDidMount=="function")try{E.componentDidMount()}catch(_e){Kt(x,x.return,_e)}if(x=N,E=x.updateQueue,E!==null){var B=x.stateNode;try{var se=E.shared.hiddenCallbacks;if(se!==null)for(E.shared.hiddenCallbacks=null,E=0;E<se.length;E++)yE(se[E],B)}catch(_e){Kt(x,x.return,_e)}}f&&R&64&&Pj(N),Lu(N,N.return);break;case 27:Ij(N);case 26:case 5:$s(E,N,f),f&&x===null&&R&4&&Mj(N),Lu(N,N.return);break;case 12:$s(E,N,f);break;case 13:$s(E,N,f),f&&R&4&&zj(E,N);break;case 22:N.memoizedState===null&&$s(E,N,f),Lu(N,N.return);break;case 30:break;default:$s(E,N,f)}o=o.sibling}}function dv(s,o){var f=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),s=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(s=o.memoizedState.cachePool.pool),s!==f&&(s!=null&&s.refCount++,f!=null&&Eu(f))}function hv(s,o){s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&Eu(s))}function wi(s,o,f,x){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)Vj(s,o,f,x),o=o.sibling}function Vj(s,o,f,x){var E=o.flags;switch(o.tag){case 0:case 11:case 15:wi(s,o,f,x),E&2048&&Iu(9,o);break;case 1:wi(s,o,f,x);break;case 3:wi(s,o,f,x),E&2048&&(s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&Eu(s)));break;case 12:if(E&2048){wi(s,o,f,x),s=o.stateNode;try{var N=o.memoizedProps,R=N.id,B=N.onPostCommit;typeof B=="function"&&B(R,o.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(se){Kt(o,o.return,se)}}else wi(s,o,f,x);break;case 13:wi(s,o,f,x);break;case 23:break;case 22:N=o.stateNode,R=o.alternate,o.memoizedState!==null?N._visibility&2?wi(s,o,f,x):Bu(s,o):N._visibility&2?wi(s,o,f,x):(N._visibility|=2,tc(s,o,f,x,(o.subtreeFlags&10256)!==0)),E&2048&&dv(R,o);break;case 24:wi(s,o,f,x),E&2048&&hv(o.alternate,o);break;default:wi(s,o,f,x)}}function tc(s,o,f,x,E){for(E=E&&(o.subtreeFlags&10256)!==0,o=o.child;o!==null;){var N=s,R=o,B=f,se=x,_e=R.flags;switch(R.tag){case 0:case 11:case 15:tc(N,R,B,se,E),Iu(8,R);break;case 23:break;case 22:var Le=R.stateNode;R.memoizedState!==null?Le._visibility&2?tc(N,R,B,se,E):Bu(N,R):(Le._visibility|=2,tc(N,R,B,se,E)),E&&_e&2048&&dv(R.alternate,R);break;case 24:tc(N,R,B,se,E),E&&_e&2048&&hv(R.alternate,R);break;default:tc(N,R,B,se,E)}o=o.sibling}}function Bu(s,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var f=s,x=o,E=x.flags;switch(x.tag){case 22:Bu(f,x),E&2048&&dv(x.alternate,x);break;case 24:Bu(f,x),E&2048&&hv(x.alternate,x);break;default:Bu(f,x)}o=o.sibling}}var Uu=8192;function rc(s){if(s.subtreeFlags&Uu)for(s=s.child;s!==null;)Kj(s),s=s.sibling}function Kj(s){switch(s.tag){case 26:rc(s),s.flags&Uu&&s.memoizedState!==null&&_F(Ja,s.memoizedState,s.memoizedProps);break;case 5:rc(s);break;case 3:case 4:var o=Ja;Ja=L0(s.stateNode.containerInfo),rc(s),Ja=o;break;case 22:s.memoizedState===null&&(o=s.alternate,o!==null&&o.memoizedState!==null?(o=Uu,Uu=16777216,rc(s),Uu=o):rc(s));break;default:rc(s)}}function Gj(s){var o=s.alternate;if(o!==null&&(s=o.child,s!==null)){o.child=null;do o=s.sibling,s.sibling=null,s=o;while(s!==null)}}function $u(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var f=0;f<o.length;f++){var x=o[f];Lr=x,Yj(x,s)}Gj(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Wj(s),s=s.sibling}function Wj(s){switch(s.tag){case 0:case 11:case 15:$u(s),s.flags&2048&&Bs(9,s,s.return);break;case 3:$u(s);break;case 12:$u(s);break;case 22:var o=s.stateNode;s.memoizedState!==null&&o._visibility&2&&(s.return===null||s.return.tag!==13)?(o._visibility&=-3,A0(s)):$u(s);break;default:$u(s)}}function A0(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var f=0;f<o.length;f++){var x=o[f];Lr=x,Yj(x,s)}Gj(s)}for(s=s.child;s!==null;){switch(o=s,o.tag){case 0:case 11:case 15:Bs(8,o,o.return),A0(o);break;case 22:f=o.stateNode,f._visibility&2&&(f._visibility&=-3,A0(o));break;default:A0(o)}s=s.sibling}}function Yj(s,o){for(;Lr!==null;){var f=Lr;switch(f.tag){case 0:case 11:case 15:Bs(8,f,o);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var x=f.memoizedState.cachePool.pool;x!=null&&x.refCount++}break;case 24:Eu(f.memoizedState.cache)}if(x=f.child,x!==null)x.return=f,Lr=x;else e:for(f=s;Lr!==null;){x=Lr;var E=x.sibling,N=x.return;if(Uj(x),x===f){Lr=null;break e}if(E!==null){E.return=N,Lr=E;break e}Lr=N}}}var H8={getCacheForType:function(s){var o=ln(Cr),f=o.data.get(s);return f===void 0&&(f=s(),o.data.set(s,f)),f}},q8=typeof WeakMap=="function"?WeakMap:Map,It=0,Yt=null,St=null,kt=0,Lt=0,Qn=null,zs=!1,nc=!1,mv=!1,Qi=0,cr=0,Hs=0,Kl=0,pv=0,Ta=0,ac=0,zu=null,In=null,xv=!1,vv=0,_0=1/0,T0=null,qs=null,Yr=0,Vs=null,ic=null,sc=0,gv=0,yv=null,Xj=null,Hu=0,bv=null;function Jn(){if((It&2)!==0&&kt!==0)return kt&-kt;if(V.T!==null){var s=Go;return s!==0?s:_v()}return Cl()}function Zj(){Ta===0&&(Ta=(kt&536870912)===0||Mt?As():536870912);var s=_a.current;return s!==null&&(s.flags|=32),Ta}function ea(s,o,f){(s===Yt&&(Lt===2||Lt===9)||s.cancelPendingCommit!==null)&&(lc(s,0),Ks(s,kt,Ta,!1)),ba(s,f),((It&2)===0||s!==Yt)&&(s===Yt&&((It&2)===0&&(Kl|=f),cr===4&&Ks(s,kt,Ta,!1)),Si(s))}function Qj(s,o,f){if((It&6)!==0)throw Error(n(327));var x=!f&&(o&124)===0&&(o&s.expiredLanes)===0||xi(s,o),E=x?G8(s,o):Ev(s,o,!0),N=x;do{if(E===0){nc&&!x&&Ks(s,o,0,!1);break}else{if(f=s.current.alternate,N&&!V8(f)){E=Ev(s,o,!1),N=!1;continue}if(E===2){if(N=o,s.errorRecoveryDisabledLanes&N)var R=0;else R=s.pendingLanes&-536870913,R=R!==0?R:R&536870912?536870912:0;if(R!==0){o=R;e:{var B=s;E=zu;var se=B.current.memoizedState.isDehydrated;if(se&&(lc(B,R).flags|=256),R=Ev(B,R,!1),R!==2){if(mv&&!se){B.errorRecoveryDisabledLanes|=N,Kl|=N,E=4;break e}N=In,In=E,N!==null&&(In===null?In=N:In.push.apply(In,N))}E=R}if(N=!1,E!==2)continue}}if(E===1){lc(s,0),Ks(s,o,0,!0);break}e:{switch(x=s,N=E,N){case 0:case 1:throw Error(n(345));case 4:if((o&4194048)!==o)break;case 6:Ks(x,o,Ta,!zs);break e;case 2:In=null;break;case 3:case 5:break;default:throw Error(n(329))}if((o&62914560)===o&&(E=vv+300-ce(),10<E)){if(Ks(x,o,Ta,!zs),En(x,0,!0)!==0)break e;x.timeoutHandle=_N(Jj.bind(null,x,f,In,T0,xv,o,Ta,Kl,ac,zs,N,2,-0,0),E);break e}Jj(x,f,In,T0,xv,o,Ta,Kl,ac,zs,N,0,-0,0)}}break}while(!0);Si(s)}function Jj(s,o,f,x,E,N,R,B,se,_e,Le,$e,ke,Ce){if(s.timeoutHandle=-1,$e=o.subtreeFlags,($e&8192||($e&16785408)===16785408)&&(Xu={stylesheets:null,count:0,unsuspend:AF},Kj(o),$e=TF(),$e!==null)){s.cancelPendingCommit=$e(sN.bind(null,s,o,N,f,x,E,R,B,se,Le,1,ke,Ce)),Ks(s,N,R,!_e);return}sN(s,o,N,f,x,E,R,B,se)}function V8(s){for(var o=s;;){var f=o.tag;if((f===0||f===11||f===15)&&o.flags&16384&&(f=o.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var x=0;x<f.length;x++){var E=f[x],N=E.getSnapshot;E=E.value;try{if(!Wn(N(),E))return!1}catch{return!1}}if(f=o.child,o.subtreeFlags&16384&&f!==null)f.return=o,o=f;else{if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Ks(s,o,f,x){o&=~pv,o&=~Kl,s.suspendedLanes|=o,s.pingedLanes&=~o,x&&(s.warmLanes|=o),x=s.expirationTimes;for(var E=o;0<E;){var N=31-ne(E),R=1<<N;x[N]=-1,E&=~R}f!==0&&_l(s,f,o)}function k0(){return(It&6)===0?(qu(0),!1):!0}function wv(){if(St!==null){if(Lt===0)var s=St.return;else s=St,qi=Ul=null,Lx(s),Jo=null,Ru=0,s=St;for(;s!==null;)Dj(s.alternate,s),s=s.return;St=null}}function lc(s,o){var f=s.timeoutHandle;f!==-1&&(s.timeoutHandle=-1,cF(f)),f=s.cancelPendingCommit,f!==null&&(s.cancelPendingCommit=null,f()),wv(),Yt=s,St=f=$i(s.current,null),kt=o,Lt=0,Qn=null,zs=!1,nc=xi(s,o),mv=!1,ac=Ta=pv=Kl=Hs=cr=0,In=zu=null,xv=!1,(o&8)!==0&&(o|=o&32);var x=s.entangledLanes;if(x!==0)for(s=s.entanglements,x&=o;0<x;){var E=31-ne(x),N=1<<E;o|=s[E],x&=~N}return Qi=o,Zd(),f}function eN(s,o){yt=null,V.H=x0,o===Nu||o===s0?(o=vE(),Lt=3):o===mE?(o=vE(),Lt=4):Lt=o===gj?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Qn=o,St===null&&(cr=1,w0(s,Ea(o,s.current)))}function tN(){var s=V.H;return V.H=x0,s===null?x0:s}function rN(){var s=V.A;return V.A=H8,s}function Sv(){cr=4,zs||(kt&4194048)!==kt&&_a.current!==null||(nc=!0),(Hs&134217727)===0&&(Kl&134217727)===0||Yt===null||Ks(Yt,kt,Ta,!1)}function Ev(s,o,f){var x=It;It|=2;var E=tN(),N=rN();(Yt!==s||kt!==o)&&(T0=null,lc(s,o)),o=!1;var R=cr;e:do try{if(Lt!==0&&St!==null){var B=St,se=Qn;switch(Lt){case 8:wv(),R=6;break e;case 3:case 2:case 9:case 6:_a.current===null&&(o=!0);var _e=Lt;if(Lt=0,Qn=null,oc(s,B,se,_e),f&&nc){R=0;break e}break;default:_e=Lt,Lt=0,Qn=null,oc(s,B,se,_e)}}K8(),R=cr;break}catch(Le){eN(s,Le)}while(!0);return o&&s.shellSuspendCounter++,qi=Ul=null,It=x,V.H=E,V.A=N,St===null&&(Yt=null,kt=0,Zd()),R}function K8(){for(;St!==null;)nN(St)}function G8(s,o){var f=It;It|=2;var x=tN(),E=rN();Yt!==s||kt!==o?(T0=null,_0=ce()+500,lc(s,o)):nc=xi(s,o);e:do try{if(Lt!==0&&St!==null){o=St;var N=Qn;t:switch(Lt){case 1:Lt=0,Qn=null,oc(s,o,N,1);break;case 2:case 9:if(pE(N)){Lt=0,Qn=null,aN(o);break}o=function(){Lt!==2&&Lt!==9||Yt!==s||(Lt=7),Si(s)},N.then(o,o);break e;case 3:Lt=7;break e;case 4:Lt=5;break e;case 7:pE(N)?(Lt=0,Qn=null,aN(o)):(Lt=0,Qn=null,oc(s,o,N,7));break;case 5:var R=null;switch(St.tag){case 26:R=St.memoizedState;case 5:case 27:var B=St;if(!R||BN(R)){Lt=0,Qn=null;var se=B.sibling;if(se!==null)St=se;else{var _e=B.return;_e!==null?(St=_e,C0(_e)):St=null}break t}}Lt=0,Qn=null,oc(s,o,N,5);break;case 6:Lt=0,Qn=null,oc(s,o,N,6);break;case 8:wv(),cr=6;break e;default:throw Error(n(462))}}W8();break}catch(Le){eN(s,Le)}while(!0);return qi=Ul=null,V.H=x,V.A=E,It=f,St!==null?0:(Yt=null,kt=0,Zd(),cr)}function W8(){for(;St!==null&&!de();)nN(St)}function nN(s){var o=Cj(s.alternate,s,Qi);s.memoizedProps=s.pendingProps,o===null?C0(s):St=o}function aN(s){var o=s,f=o.alternate;switch(o.tag){case 15:case 0:o=jj(f,o,o.pendingProps,o.type,void 0,kt);break;case 11:o=jj(f,o,o.pendingProps,o.type.render,o.ref,kt);break;case 5:Lx(o);default:Dj(f,o),o=St=iE(o,Qi),o=Cj(f,o,Qi)}s.memoizedProps=s.pendingProps,o===null?C0(s):St=o}function oc(s,o,f,x){qi=Ul=null,Lx(o),Jo=null,Ru=0;var E=o.return;try{if(I8(s,E,o,f,kt)){cr=1,w0(s,Ea(f,s.current)),St=null;return}}catch(N){if(E!==null)throw St=E,N;cr=1,w0(s,Ea(f,s.current)),St=null;return}o.flags&32768?(Mt||x===1?s=!0:nc||(kt&536870912)!==0?s=!1:(zs=s=!0,(x===2||x===9||x===3||x===6)&&(x=_a.current,x!==null&&x.tag===13&&(x.flags|=16384))),iN(o,s)):C0(o)}function C0(s){var o=s;do{if((o.flags&32768)!==0){iN(o,zs);return}s=o.return;var f=B8(o.alternate,o,Qi);if(f!==null){St=f;return}if(o=o.sibling,o!==null){St=o;return}St=o=s}while(o!==null);cr===0&&(cr=5)}function iN(s,o){do{var f=U8(s.alternate,s);if(f!==null){f.flags&=32767,St=f;return}if(f=s.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!o&&(s=s.sibling,s!==null)){St=s;return}St=s=f}while(s!==null);cr=6,St=null}function sN(s,o,f,x,E,N,R,B,se){s.cancelPendingCommit=null;do O0();while(Yr!==0);if((It&6)!==0)throw Error(n(327));if(o!==null){if(o===s.current)throw Error(n(177));if(N=o.lanes|o.childLanes,N|=hx,Gn(s,f,N,R,B,se),s===Yt&&(St=Yt=null,kt=0),ic=o,Vs=s,sc=f,gv=N,yv=E,Xj=x,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Q8(qe,function(){return fN(),null})):(s.callbackNode=null,s.callbackPriority=0),x=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||x){x=V.T,V.T=null,E=H.p,H.p=2,R=It,It|=4;try{$8(s,o,f)}finally{It=R,H.p=E,V.T=x}}Yr=1,lN(),oN(),cN()}}function lN(){if(Yr===1){Yr=0;var s=Vs,o=ic,f=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||f){f=V.T,V.T=null;var x=H.p;H.p=2;var E=It;It|=4;try{Hj(o,s);var N=Mv,R=YS(s.containerInfo),B=N.focusedElem,se=N.selectionRange;if(R!==B&&B&&B.ownerDocument&&WS(B.ownerDocument.documentElement,B)){if(se!==null&&ox(B)){var _e=se.start,Le=se.end;if(Le===void 0&&(Le=_e),"selectionStart"in B)B.selectionStart=_e,B.selectionEnd=Math.min(Le,B.value.length);else{var $e=B.ownerDocument||document,ke=$e&&$e.defaultView||window;if(ke.getSelection){var Ce=ke.getSelection(),ut=B.textContent.length,ot=Math.min(se.start,ut),Ht=se.end===void 0?ot:Math.min(se.end,ut);!Ce.extend&&ot>Ht&&(R=Ht,Ht=ot,ot=R);var we=GS(B,ot),he=GS(B,Ht);if(we&&he&&(Ce.rangeCount!==1||Ce.anchorNode!==we.node||Ce.anchorOffset!==we.offset||Ce.focusNode!==he.node||Ce.focusOffset!==he.offset)){var Ne=$e.createRange();Ne.setStart(we.node,we.offset),Ce.removeAllRanges(),ot>Ht?(Ce.addRange(Ne),Ce.extend(he.node,he.offset)):(Ne.setEnd(he.node,he.offset),Ce.addRange(Ne))}}}}for($e=[],Ce=B;Ce=Ce.parentNode;)Ce.nodeType===1&&$e.push({element:Ce,left:Ce.scrollLeft,top:Ce.scrollTop});for(typeof B.focus=="function"&&B.focus(),B=0;B<$e.length;B++){var Ue=$e[B];Ue.element.scrollLeft=Ue.left,Ue.element.scrollTop=Ue.top}}H0=!!Rv,Mv=Rv=null}finally{It=E,H.p=x,V.T=f}}s.current=o,Yr=2}}function oN(){if(Yr===2){Yr=0;var s=Vs,o=ic,f=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||f){f=V.T,V.T=null;var x=H.p;H.p=2;var E=It;It|=4;try{Bj(s,o.alternate,o)}finally{It=E,H.p=x,V.T=f}}Yr=3}}function cN(){if(Yr===4||Yr===3){Yr=0,me();var s=Vs,o=ic,f=sc,x=Xj;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Yr=5:(Yr=0,ic=Vs=null,uN(s,s.pendingLanes));var E=s.pendingLanes;if(E===0&&(qs=null),kl(f),o=o.stateNode,Ge&&typeof Ge.onCommitFiberRoot=="function")try{Ge.onCommitFiberRoot(ge,o,void 0,(o.current.flags&128)===128)}catch{}if(x!==null){o=V.T,E=H.p,H.p=2,V.T=null;try{for(var N=s.onRecoverableError,R=0;R<x.length;R++){var B=x[R];N(B.value,{componentStack:B.stack})}}finally{V.T=o,H.p=E}}(sc&3)!==0&&O0(),Si(s),E=s.pendingLanes,(f&4194090)!==0&&(E&42)!==0?s===bv?Hu++:(Hu=0,bv=s):Hu=0,qu(0)}}function uN(s,o){(s.pooledCacheLanes&=o)===0&&(o=s.pooledCache,o!=null&&(s.pooledCache=null,Eu(o)))}function O0(s){return lN(),oN(),cN(),fN()}function fN(){if(Yr!==5)return!1;var s=Vs,o=gv;gv=0;var f=kl(sc),x=V.T,E=H.p;try{H.p=32>f?32:f,V.T=null,f=yv,yv=null;var N=Vs,R=sc;if(Yr=0,ic=Vs=null,sc=0,(It&6)!==0)throw Error(n(331));var B=It;if(It|=4,Wj(N.current),Vj(N,N.current,R,f),It=B,qu(0,!1),Ge&&typeof Ge.onPostCommitFiberRoot=="function")try{Ge.onPostCommitFiberRoot(ge,N)}catch{}return!0}finally{H.p=E,V.T=x,uN(s,o)}}function dN(s,o,f){o=Ea(f,o),o=Qx(s.stateNode,o,2),s=Ms(s,o,2),s!==null&&(ba(s,2),Si(s))}function Kt(s,o,f){if(s.tag===3)dN(s,s,f);else for(;o!==null;){if(o.tag===3){dN(o,s,f);break}else if(o.tag===1){var x=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(qs===null||!qs.has(x))){s=Ea(f,s),f=xj(2),x=Ms(o,f,2),x!==null&&(vj(f,x,o,s),ba(x,2),Si(x));break}}o=o.return}}function jv(s,o,f){var x=s.pingCache;if(x===null){x=s.pingCache=new q8;var E=new Set;x.set(o,E)}else E=x.get(o),E===void 0&&(E=new Set,x.set(o,E));E.has(f)||(mv=!0,E.add(f),s=Y8.bind(null,s,o,f),o.then(s,s))}function Y8(s,o,f){var x=s.pingCache;x!==null&&x.delete(o),s.pingedLanes|=s.suspendedLanes&f,s.warmLanes&=~f,Yt===s&&(kt&f)===f&&(cr===4||cr===3&&(kt&62914560)===kt&&300>ce()-vv?(It&2)===0&&lc(s,0):pv|=f,ac===kt&&(ac=0)),Si(s)}function hN(s,o){o===0&&(o=_s()),s=Ho(s,o),s!==null&&(ba(s,o),Si(s))}function X8(s){var o=s.memoizedState,f=0;o!==null&&(f=o.retryLane),hN(s,f)}function Z8(s,o){var f=0;switch(s.tag){case 13:var x=s.stateNode,E=s.memoizedState;E!==null&&(f=E.retryLane);break;case 19:x=s.stateNode;break;case 22:x=s.stateNode._retryCache;break;default:throw Error(n(314))}x!==null&&x.delete(o),hN(s,f)}function Q8(s,o){return Me(s,o)}var D0=null,cc=null,Nv=!1,P0=!1,Av=!1,Gl=0;function Si(s){s!==cc&&s.next===null&&(cc===null?D0=cc=s:cc=cc.next=s),P0=!0,Nv||(Nv=!0,eF())}function qu(s,o){if(!Av&&P0){Av=!0;do for(var f=!1,x=D0;x!==null;){if(s!==0){var E=x.pendingLanes;if(E===0)var N=0;else{var R=x.suspendedLanes,B=x.pingedLanes;N=(1<<31-ne(42|s)+1)-1,N&=E&~(R&~B),N=N&201326741?N&201326741|1:N?N|2:0}N!==0&&(f=!0,vN(x,N))}else N=kt,N=En(x,x===Yt?N:0,x.cancelPendingCommit!==null||x.timeoutHandle!==-1),(N&3)===0||xi(x,N)||(f=!0,vN(x,N));x=x.next}while(f);Av=!1}}function J8(){mN()}function mN(){P0=Nv=!1;var s=0;Gl!==0&&(oF()&&(s=Gl),Gl=0);for(var o=ce(),f=null,x=D0;x!==null;){var E=x.next,N=pN(x,o);N===0?(x.next=null,f===null?D0=E:f.next=E,E===null&&(cc=f)):(f=x,(s!==0||(N&3)!==0)&&(P0=!0)),x=E}qu(s)}function pN(s,o){for(var f=s.suspendedLanes,x=s.pingedLanes,E=s.expirationTimes,N=s.pendingLanes&-62914561;0<N;){var R=31-ne(N),B=1<<R,se=E[R];se===-1?((B&f)===0||(B&x)!==0)&&(E[R]=Ro(B,o)):se<=o&&(s.expiredLanes|=B),N&=~B}if(o=Yt,f=kt,f=En(s,s===o?f:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),x=s.callbackNode,f===0||s===o&&(Lt===2||Lt===9)||s.cancelPendingCommit!==null)return x!==null&&x!==null&&ae(x),s.callbackNode=null,s.callbackPriority=0;if((f&3)===0||xi(s,f)){if(o=f&-f,o===s.callbackPriority)return o;switch(x!==null&&ae(x),kl(f)){case 2:case 8:f=Ke;break;case 32:f=qe;break;case 268435456:f=Je;break;default:f=qe}return x=xN.bind(null,s),f=Me(f,x),s.callbackPriority=o,s.callbackNode=f,o}return x!==null&&x!==null&&ae(x),s.callbackPriority=2,s.callbackNode=null,2}function xN(s,o){if(Yr!==0&&Yr!==5)return s.callbackNode=null,s.callbackPriority=0,null;var f=s.callbackNode;if(O0()&&s.callbackNode!==f)return null;var x=kt;return x=En(s,s===Yt?x:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),x===0?null:(Qj(s,x,o),pN(s,ce()),s.callbackNode!=null&&s.callbackNode===f?xN.bind(null,s):null)}function vN(s,o){if(O0())return null;Qj(s,o,!0)}function eF(){uF(function(){(It&6)!==0?Me(Qe,J8):mN()})}function _v(){return Gl===0&&(Gl=As()),Gl}function gN(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:qd(""+s)}function yN(s,o){var f=o.ownerDocument.createElement("input");return f.name=o.name,f.value=o.value,s.id&&f.setAttribute("form",s.id),o.parentNode.insertBefore(f,o),s=new FormData(s),f.parentNode.removeChild(f),s}function tF(s,o,f,x,E){if(o==="submit"&&f&&f.stateNode===E){var N=gN((E[gr]||null).action),R=x.submitter;R&&(o=(o=R[gr]||null)?gN(o.formAction):R.getAttribute("formAction"),o!==null&&(N=o,R=null));var B=new Wd("action","action",null,x,E);s.push({event:B,listeners:[{instance:null,listener:function(){if(x.defaultPrevented){if(Gl!==0){var se=R?yN(E,R):new FormData(E);Gx(f,{pending:!0,data:se,method:E.method,action:N},null,se)}}else typeof N=="function"&&(B.preventDefault(),se=R?yN(E,R):new FormData(E),Gx(f,{pending:!0,data:se,method:E.method,action:N},N,se))},currentTarget:E}]})}}for(var Tv=0;Tv<dx.length;Tv++){var kv=dx[Tv],rF=kv.toLowerCase(),nF=kv[0].toUpperCase()+kv.slice(1);Qa(rF,"on"+nF)}Qa(QS,"onAnimationEnd"),Qa(JS,"onAnimationIteration"),Qa(eE,"onAnimationStart"),Qa("dblclick","onDoubleClick"),Qa("focusin","onFocus"),Qa("focusout","onBlur"),Qa(b8,"onTransitionRun"),Qa(w8,"onTransitionStart"),Qa(S8,"onTransitionCancel"),Qa(tE,"onTransitionEnd"),Ie("onMouseEnter",["mouseout","mouseover"]),Ie("onMouseLeave",["mouseout","mouseover"]),Ie("onPointerEnter",["pointerout","pointerover"]),Ie("onPointerLeave",["pointerout","pointerover"]),De("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),De("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),De("onBeforeInput",["compositionend","keypress","textInput","paste"]),De("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),De("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),De("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),aF=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Vu));function bN(s,o){o=(o&4)!==0;for(var f=0;f<s.length;f++){var x=s[f],E=x.event;x=x.listeners;e:{var N=void 0;if(o)for(var R=x.length-1;0<=R;R--){var B=x[R],se=B.instance,_e=B.currentTarget;if(B=B.listener,se!==N&&E.isPropagationStopped())break e;N=B,E.currentTarget=_e;try{N(E)}catch(Le){b0(Le)}E.currentTarget=null,N=se}else for(R=0;R<x.length;R++){if(B=x[R],se=B.instance,_e=B.currentTarget,B=B.listener,se!==N&&E.isPropagationStopped())break e;N=B,E.currentTarget=_e;try{N(E)}catch(Le){b0(Le)}E.currentTarget=null,N=se}}}}function Et(s,o){var f=o[Ol];f===void 0&&(f=o[Ol]=new Set);var x=s+"__bubble";f.has(x)||(wN(o,s,2,!1),f.add(x))}function Cv(s,o,f){var x=0;o&&(x|=4),wN(f,s,x,o)}var R0="_reactListening"+Math.random().toString(36).slice(2);function Ov(s){if(!s[R0]){s[R0]=!0,ye.forEach(function(f){f!=="selectionchange"&&(aF.has(f)||Cv(f,!1,s),Cv(f,!0,s))});var o=s.nodeType===9?s:s.ownerDocument;o===null||o[R0]||(o[R0]=!0,Cv("selectionchange",!1,o))}}function wN(s,o,f,x){switch(VN(o)){case 2:var E=OF;break;case 8:E=DF;break;default:E=Vv}f=E.bind(null,o,f,s),E=void 0,!Jp||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(E=!0),x?E!==void 0?s.addEventListener(o,f,{capture:!0,passive:E}):s.addEventListener(o,f,!0):E!==void 0?s.addEventListener(o,f,{passive:E}):s.addEventListener(o,f,!1)}function Dv(s,o,f,x,E){var N=x;if((o&1)===0&&(o&2)===0&&x!==null)e:for(;;){if(x===null)return;var R=x.tag;if(R===3||R===4){var B=x.stateNode.containerInfo;if(B===E)break;if(R===4)for(R=x.return;R!==null;){var se=R.tag;if((se===3||se===4)&&R.stateNode.containerInfo===E)return;R=R.return}for(;B!==null;){if(R=J(B),R===null)return;if(se=R.tag,se===5||se===6||se===26||se===27){x=N=R;continue e}B=B.parentNode}}x=x.return}TS(function(){var _e=N,Le=Zp(f),$e=[];e:{var ke=rE.get(s);if(ke!==void 0){var Ce=Wd,ut=s;switch(s){case"keypress":if(Kd(f)===0)break e;case"keydown":case"keyup":Ce=QM;break;case"focusin":ut="focus",Ce=nx;break;case"focusout":ut="blur",Ce=nx;break;case"beforeblur":case"afterblur":Ce=nx;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ce=OS;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ce=UM;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ce=t8;break;case QS:case JS:case eE:Ce=HM;break;case tE:Ce=n8;break;case"scroll":case"scrollend":Ce=LM;break;case"wheel":Ce=i8;break;case"copy":case"cut":case"paste":Ce=VM;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ce=PS;break;case"toggle":case"beforetoggle":Ce=l8}var ot=(o&4)!==0,Ht=!ot&&(s==="scroll"||s==="scrollend"),we=ot?ke!==null?ke+"Capture":null:ke;ot=[];for(var he=_e,Ne;he!==null;){var Ue=he;if(Ne=Ue.stateNode,Ue=Ue.tag,Ue!==5&&Ue!==26&&Ue!==27||Ne===null||we===null||(Ue=uu(he,we),Ue!=null&&ot.push(Ku(he,Ue,Ne))),Ht)break;he=he.return}0<ot.length&&(ke=new Ce(ke,ut,null,f,Le),$e.push({event:ke,listeners:ot}))}}if((o&7)===0){e:{if(ke=s==="mouseover"||s==="pointerover",Ce=s==="mouseout"||s==="pointerout",ke&&f!==Xp&&(ut=f.relatedTarget||f.fromElement)&&(J(ut)||ut[vi]))break e;if((Ce||ke)&&(ke=Le.window===Le?Le:(ke=Le.ownerDocument)?ke.defaultView||ke.parentWindow:window,Ce?(ut=f.relatedTarget||f.toElement,Ce=_e,ut=ut?J(ut):null,ut!==null&&(Ht=i(ut),ot=ut.tag,ut!==Ht||ot!==5&&ot!==27&&ot!==6)&&(ut=null)):(Ce=null,ut=_e),Ce!==ut)){if(ot=OS,Ue="onMouseLeave",we="onMouseEnter",he="mouse",(s==="pointerout"||s==="pointerover")&&(ot=PS,Ue="onPointerLeave",we="onPointerEnter",he="pointer"),Ht=Ce==null?ke:ie(Ce),Ne=ut==null?ke:ie(ut),ke=new ot(Ue,he+"leave",Ce,f,Le),ke.target=Ht,ke.relatedTarget=Ne,Ue=null,J(Le)===_e&&(ot=new ot(we,he+"enter",ut,f,Le),ot.target=Ne,ot.relatedTarget=Ht,Ue=ot),Ht=Ue,Ce&&ut)t:{for(ot=Ce,we=ut,he=0,Ne=ot;Ne;Ne=uc(Ne))he++;for(Ne=0,Ue=we;Ue;Ue=uc(Ue))Ne++;for(;0<he-Ne;)ot=uc(ot),he--;for(;0<Ne-he;)we=uc(we),Ne--;for(;he--;){if(ot===we||we!==null&&ot===we.alternate)break t;ot=uc(ot),we=uc(we)}ot=null}else ot=null;Ce!==null&&SN($e,ke,Ce,ot,!1),ut!==null&&Ht!==null&&SN($e,Ht,ut,ot,!0)}}e:{if(ke=_e?ie(_e):window,Ce=ke.nodeName&&ke.nodeName.toLowerCase(),Ce==="select"||Ce==="input"&&ke.type==="file")var at=$S;else if(BS(ke))if(zS)at=v8;else{at=p8;var bt=m8}else Ce=ke.nodeName,!Ce||Ce.toLowerCase()!=="input"||ke.type!=="checkbox"&&ke.type!=="radio"?_e&&Yp(_e.elementType)&&(at=$S):at=x8;if(at&&(at=at(s,_e))){US($e,at,f,Le);break e}bt&&bt(s,ke,_e),s==="focusout"&&_e&&ke.type==="number"&&_e.memoizedProps.value!=null&&Wp(ke,"number",ke.value)}switch(bt=_e?ie(_e):window,s){case"focusin":(BS(bt)||bt.contentEditable==="true")&&(Uo=bt,cx=_e,gu=null);break;case"focusout":gu=cx=Uo=null;break;case"mousedown":ux=!0;break;case"contextmenu":case"mouseup":case"dragend":ux=!1,XS($e,f,Le);break;case"selectionchange":if(y8)break;case"keydown":case"keyup":XS($e,f,Le)}var lt;if(ix)e:{switch(s){case"compositionstart":var ct="onCompositionStart";break e;case"compositionend":ct="onCompositionEnd";break e;case"compositionupdate":ct="onCompositionUpdate";break e}ct=void 0}else Bo?IS(s,f)&&(ct="onCompositionEnd"):s==="keydown"&&f.keyCode===229&&(ct="onCompositionStart");ct&&(RS&&f.locale!=="ko"&&(Bo||ct!=="onCompositionStart"?ct==="onCompositionEnd"&&Bo&&(lt=kS()):(Os=Le,ex="value"in Os?Os.value:Os.textContent,Bo=!0)),bt=M0(_e,ct),0<bt.length&&(ct=new DS(ct,s,null,f,Le),$e.push({event:ct,listeners:bt}),lt?ct.data=lt:(lt=LS(f),lt!==null&&(ct.data=lt)))),(lt=c8?u8(s,f):f8(s,f))&&(ct=M0(_e,"onBeforeInput"),0<ct.length&&(bt=new DS("onBeforeInput","beforeinput",null,f,Le),$e.push({event:bt,listeners:ct}),bt.data=lt)),tF($e,s,_e,f,Le)}bN($e,o)})}function Ku(s,o,f){return{instance:s,listener:o,currentTarget:f}}function M0(s,o){for(var f=o+"Capture",x=[];s!==null;){var E=s,N=E.stateNode;if(E=E.tag,E!==5&&E!==26&&E!==27||N===null||(E=uu(s,f),E!=null&&x.unshift(Ku(s,E,N)),E=uu(s,o),E!=null&&x.push(Ku(s,E,N))),s.tag===3)return x;s=s.return}return[]}function uc(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function SN(s,o,f,x,E){for(var N=o._reactName,R=[];f!==null&&f!==x;){var B=f,se=B.alternate,_e=B.stateNode;if(B=B.tag,se!==null&&se===x)break;B!==5&&B!==26&&B!==27||_e===null||(se=_e,E?(_e=uu(f,N),_e!=null&&R.unshift(Ku(f,_e,se))):E||(_e=uu(f,N),_e!=null&&R.push(Ku(f,_e,se)))),f=f.return}R.length!==0&&s.push({event:o,listeners:R})}var iF=/\r\n?/g,sF=/\u0000|\uFFFD/g;function EN(s){return(typeof s=="string"?s:""+s).replace(iF,`
`).replace(sF,"")}function jN(s,o){return o=EN(o),EN(s)===o}function F0(){}function zt(s,o,f,x,E,N){switch(f){case"children":typeof x=="string"?o==="body"||o==="textarea"&&x===""||Fo(s,x):(typeof x=="number"||typeof x=="bigint")&&o!=="body"&&Fo(s,""+x);break;case"className":dt(s,"class",x);break;case"tabIndex":dt(s,"tabindex",x);break;case"dir":case"role":case"viewBox":case"width":case"height":dt(s,f,x);break;case"style":AS(s,x,N);break;case"data":if(o!=="object"){dt(s,"data",x);break}case"src":case"href":if(x===""&&(o!=="a"||f!=="href")){s.removeAttribute(f);break}if(x==null||typeof x=="function"||typeof x=="symbol"||typeof x=="boolean"){s.removeAttribute(f);break}x=qd(""+x),s.setAttribute(f,x);break;case"action":case"formAction":if(typeof x=="function"){s.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof N=="function"&&(f==="formAction"?(o!=="input"&&zt(s,o,"name",E.name,E,null),zt(s,o,"formEncType",E.formEncType,E,null),zt(s,o,"formMethod",E.formMethod,E,null),zt(s,o,"formTarget",E.formTarget,E,null)):(zt(s,o,"encType",E.encType,E,null),zt(s,o,"method",E.method,E,null),zt(s,o,"target",E.target,E,null)));if(x==null||typeof x=="symbol"||typeof x=="boolean"){s.removeAttribute(f);break}x=qd(""+x),s.setAttribute(f,x);break;case"onClick":x!=null&&(s.onclick=F0);break;case"onScroll":x!=null&&Et("scroll",s);break;case"onScrollEnd":x!=null&&Et("scrollend",s);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(n(61));if(f=x.__html,f!=null){if(E.children!=null)throw Error(n(60));s.innerHTML=f}}break;case"multiple":s.multiple=x&&typeof x!="function"&&typeof x!="symbol";break;case"muted":s.muted=x&&typeof x!="function"&&typeof x!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(x==null||typeof x=="function"||typeof x=="boolean"||typeof x=="symbol"){s.removeAttribute("xlink:href");break}f=qd(""+x),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":x!=null&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(f,""+x):s.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":x&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(f,""):s.removeAttribute(f);break;case"capture":case"download":x===!0?s.setAttribute(f,""):x!==!1&&x!=null&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(f,x):s.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":x!=null&&typeof x!="function"&&typeof x!="symbol"&&!isNaN(x)&&1<=x?s.setAttribute(f,x):s.removeAttribute(f);break;case"rowSpan":case"start":x==null||typeof x=="function"||typeof x=="symbol"||isNaN(x)?s.removeAttribute(f):s.setAttribute(f,x);break;case"popover":Et("beforetoggle",s),Et("toggle",s),pt(s,"popover",x);break;case"xlinkActuate":jt(s,"http://www.w3.org/1999/xlink","xlink:actuate",x);break;case"xlinkArcrole":jt(s,"http://www.w3.org/1999/xlink","xlink:arcrole",x);break;case"xlinkRole":jt(s,"http://www.w3.org/1999/xlink","xlink:role",x);break;case"xlinkShow":jt(s,"http://www.w3.org/1999/xlink","xlink:show",x);break;case"xlinkTitle":jt(s,"http://www.w3.org/1999/xlink","xlink:title",x);break;case"xlinkType":jt(s,"http://www.w3.org/1999/xlink","xlink:type",x);break;case"xmlBase":jt(s,"http://www.w3.org/XML/1998/namespace","xml:base",x);break;case"xmlLang":jt(s,"http://www.w3.org/XML/1998/namespace","xml:lang",x);break;case"xmlSpace":jt(s,"http://www.w3.org/XML/1998/namespace","xml:space",x);break;case"is":pt(s,"is",x);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=FM.get(f)||f,pt(s,f,x))}}function Pv(s,o,f,x,E,N){switch(f){case"style":AS(s,x,N);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(n(61));if(f=x.__html,f!=null){if(E.children!=null)throw Error(n(60));s.innerHTML=f}}break;case"children":typeof x=="string"?Fo(s,x):(typeof x=="number"||typeof x=="bigint")&&Fo(s,""+x);break;case"onScroll":x!=null&&Et("scroll",s);break;case"onScrollEnd":x!=null&&Et("scrollend",s);break;case"onClick":x!=null&&(s.onclick=F0);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ee.hasOwnProperty(f))e:{if(f[0]==="o"&&f[1]==="n"&&(E=f.endsWith("Capture"),o=f.slice(2,E?f.length-7:void 0),N=s[gr]||null,N=N!=null?N[f]:null,typeof N=="function"&&s.removeEventListener(o,N,E),typeof x=="function")){typeof N!="function"&&N!==null&&(f in s?s[f]=null:s.hasAttribute(f)&&s.removeAttribute(f)),s.addEventListener(o,x,E);break e}f in s?s[f]=x:x===!0?s.setAttribute(f,""):pt(s,f,x)}}}function Xr(s,o,f){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Et("error",s),Et("load",s);var x=!1,E=!1,N;for(N in f)if(f.hasOwnProperty(N)){var R=f[N];if(R!=null)switch(N){case"src":x=!0;break;case"srcSet":E=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:zt(s,o,N,R,f,null)}}E&&zt(s,o,"srcSet",f.srcSet,f,null),x&&zt(s,o,"src",f.src,f,null);return;case"input":Et("invalid",s);var B=N=R=E=null,se=null,_e=null;for(x in f)if(f.hasOwnProperty(x)){var Le=f[x];if(Le!=null)switch(x){case"name":E=Le;break;case"type":R=Le;break;case"checked":se=Le;break;case"defaultChecked":_e=Le;break;case"value":N=Le;break;case"defaultValue":B=Le;break;case"children":case"dangerouslySetInnerHTML":if(Le!=null)throw Error(n(137,o));break;default:zt(s,o,x,Le,f,null)}}SS(s,N,B,se,_e,R,E,!1),zd(s);return;case"select":Et("invalid",s),x=R=N=null;for(E in f)if(f.hasOwnProperty(E)&&(B=f[E],B!=null))switch(E){case"value":N=B;break;case"defaultValue":R=B;break;case"multiple":x=B;default:zt(s,o,E,B,f,null)}o=N,f=R,s.multiple=!!x,o!=null?Mo(s,!!x,o,!1):f!=null&&Mo(s,!!x,f,!0);return;case"textarea":Et("invalid",s),N=E=x=null;for(R in f)if(f.hasOwnProperty(R)&&(B=f[R],B!=null))switch(R){case"value":x=B;break;case"defaultValue":E=B;break;case"children":N=B;break;case"dangerouslySetInnerHTML":if(B!=null)throw Error(n(91));break;default:zt(s,o,R,B,f,null)}jS(s,x,E,N),zd(s);return;case"option":for(se in f)if(f.hasOwnProperty(se)&&(x=f[se],x!=null))switch(se){case"selected":s.selected=x&&typeof x!="function"&&typeof x!="symbol";break;default:zt(s,o,se,x,f,null)}return;case"dialog":Et("beforetoggle",s),Et("toggle",s),Et("cancel",s),Et("close",s);break;case"iframe":case"object":Et("load",s);break;case"video":case"audio":for(x=0;x<Vu.length;x++)Et(Vu[x],s);break;case"image":Et("error",s),Et("load",s);break;case"details":Et("toggle",s);break;case"embed":case"source":case"link":Et("error",s),Et("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(_e in f)if(f.hasOwnProperty(_e)&&(x=f[_e],x!=null))switch(_e){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:zt(s,o,_e,x,f,null)}return;default:if(Yp(o)){for(Le in f)f.hasOwnProperty(Le)&&(x=f[Le],x!==void 0&&Pv(s,o,Le,x,f,void 0));return}}for(B in f)f.hasOwnProperty(B)&&(x=f[B],x!=null&&zt(s,o,B,x,f,null))}function lF(s,o,f,x){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var E=null,N=null,R=null,B=null,se=null,_e=null,Le=null;for(Ce in f){var $e=f[Ce];if(f.hasOwnProperty(Ce)&&$e!=null)switch(Ce){case"checked":break;case"value":break;case"defaultValue":se=$e;default:x.hasOwnProperty(Ce)||zt(s,o,Ce,null,x,$e)}}for(var ke in x){var Ce=x[ke];if($e=f[ke],x.hasOwnProperty(ke)&&(Ce!=null||$e!=null))switch(ke){case"type":N=Ce;break;case"name":E=Ce;break;case"checked":_e=Ce;break;case"defaultChecked":Le=Ce;break;case"value":R=Ce;break;case"defaultValue":B=Ce;break;case"children":case"dangerouslySetInnerHTML":if(Ce!=null)throw Error(n(137,o));break;default:Ce!==$e&&zt(s,o,ke,Ce,x,$e)}}Gp(s,R,B,se,_e,Le,N,E);return;case"select":Ce=R=B=ke=null;for(N in f)if(se=f[N],f.hasOwnProperty(N)&&se!=null)switch(N){case"value":break;case"multiple":Ce=se;default:x.hasOwnProperty(N)||zt(s,o,N,null,x,se)}for(E in x)if(N=x[E],se=f[E],x.hasOwnProperty(E)&&(N!=null||se!=null))switch(E){case"value":ke=N;break;case"defaultValue":B=N;break;case"multiple":R=N;default:N!==se&&zt(s,o,E,N,x,se)}o=B,f=R,x=Ce,ke!=null?Mo(s,!!f,ke,!1):!!x!=!!f&&(o!=null?Mo(s,!!f,o,!0):Mo(s,!!f,f?[]:"",!1));return;case"textarea":Ce=ke=null;for(B in f)if(E=f[B],f.hasOwnProperty(B)&&E!=null&&!x.hasOwnProperty(B))switch(B){case"value":break;case"children":break;default:zt(s,o,B,null,x,E)}for(R in x)if(E=x[R],N=f[R],x.hasOwnProperty(R)&&(E!=null||N!=null))switch(R){case"value":ke=E;break;case"defaultValue":Ce=E;break;case"children":break;case"dangerouslySetInnerHTML":if(E!=null)throw Error(n(91));break;default:E!==N&&zt(s,o,R,E,x,N)}ES(s,ke,Ce);return;case"option":for(var ut in f)if(ke=f[ut],f.hasOwnProperty(ut)&&ke!=null&&!x.hasOwnProperty(ut))switch(ut){case"selected":s.selected=!1;break;default:zt(s,o,ut,null,x,ke)}for(se in x)if(ke=x[se],Ce=f[se],x.hasOwnProperty(se)&&ke!==Ce&&(ke!=null||Ce!=null))switch(se){case"selected":s.selected=ke&&typeof ke!="function"&&typeof ke!="symbol";break;default:zt(s,o,se,ke,x,Ce)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ot in f)ke=f[ot],f.hasOwnProperty(ot)&&ke!=null&&!x.hasOwnProperty(ot)&&zt(s,o,ot,null,x,ke);for(_e in x)if(ke=x[_e],Ce=f[_e],x.hasOwnProperty(_e)&&ke!==Ce&&(ke!=null||Ce!=null))switch(_e){case"children":case"dangerouslySetInnerHTML":if(ke!=null)throw Error(n(137,o));break;default:zt(s,o,_e,ke,x,Ce)}return;default:if(Yp(o)){for(var Ht in f)ke=f[Ht],f.hasOwnProperty(Ht)&&ke!==void 0&&!x.hasOwnProperty(Ht)&&Pv(s,o,Ht,void 0,x,ke);for(Le in x)ke=x[Le],Ce=f[Le],!x.hasOwnProperty(Le)||ke===Ce||ke===void 0&&Ce===void 0||Pv(s,o,Le,ke,x,Ce);return}}for(var we in f)ke=f[we],f.hasOwnProperty(we)&&ke!=null&&!x.hasOwnProperty(we)&&zt(s,o,we,null,x,ke);for($e in x)ke=x[$e],Ce=f[$e],!x.hasOwnProperty($e)||ke===Ce||ke==null&&Ce==null||zt(s,o,$e,ke,x,Ce)}var Rv=null,Mv=null;function I0(s){return s.nodeType===9?s:s.ownerDocument}function NN(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function AN(s,o){if(s===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&o==="foreignObject"?0:s}function Fv(s,o){return s==="textarea"||s==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Iv=null;function oF(){var s=window.event;return s&&s.type==="popstate"?s===Iv?!1:(Iv=s,!0):(Iv=null,!1)}var _N=typeof setTimeout=="function"?setTimeout:void 0,cF=typeof clearTimeout=="function"?clearTimeout:void 0,TN=typeof Promise=="function"?Promise:void 0,uF=typeof queueMicrotask=="function"?queueMicrotask:typeof TN<"u"?function(s){return TN.resolve(null).then(s).catch(fF)}:_N;function fF(s){setTimeout(function(){throw s})}function Gs(s){return s==="head"}function kN(s,o){var f=o,x=0,E=0;do{var N=f.nextSibling;if(s.removeChild(f),N&&N.nodeType===8)if(f=N.data,f==="/$"){if(0<x&&8>x){f=x;var R=s.ownerDocument;if(f&1&&Gu(R.documentElement),f&2&&Gu(R.body),f&4)for(f=R.head,Gu(f),R=f.firstChild;R;){var B=R.nextSibling,se=R.nodeName;R[K]||se==="SCRIPT"||se==="STYLE"||se==="LINK"&&R.rel.toLowerCase()==="stylesheet"||f.removeChild(R),R=B}}if(E===0){s.removeChild(N),tf(o);return}E--}else f==="$"||f==="$?"||f==="$!"?E++:x=f.charCodeAt(0)-48;else x=0;f=N}while(f);tf(o)}function Lv(s){var o=s.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var f=o;switch(o=o.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":Lv(f),X(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}s.removeChild(f)}}function dF(s,o,f,x){for(;s.nodeType===1;){var E=f;if(s.nodeName.toLowerCase()!==o.toLowerCase()){if(!x&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(x){if(!s[K])switch(o){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(N=s.getAttribute("rel"),N==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(N!==E.rel||s.getAttribute("href")!==(E.href==null||E.href===""?null:E.href)||s.getAttribute("crossorigin")!==(E.crossOrigin==null?null:E.crossOrigin)||s.getAttribute("title")!==(E.title==null?null:E.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(N=s.getAttribute("src"),(N!==(E.src==null?null:E.src)||s.getAttribute("type")!==(E.type==null?null:E.type)||s.getAttribute("crossorigin")!==(E.crossOrigin==null?null:E.crossOrigin))&&N&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(o==="input"&&s.type==="hidden"){var N=E.name==null?null:""+E.name;if(E.type==="hidden"&&s.getAttribute("name")===N)return s}else return s;if(s=ei(s.nextSibling),s===null)break}return null}function hF(s,o,f){if(o==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!f||(s=ei(s.nextSibling),s===null))return null;return s}function Bv(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function mF(s,o){var f=s.ownerDocument;if(s.data!=="$?"||f.readyState==="complete")o();else{var x=function(){o(),f.removeEventListener("DOMContentLoaded",x)};f.addEventListener("DOMContentLoaded",x),s._reactRetry=x}}function ei(s){for(;s!=null;s=s.nextSibling){var o=s.nodeType;if(o===1||o===3)break;if(o===8){if(o=s.data,o==="$"||o==="$!"||o==="$?"||o==="F!"||o==="F")break;if(o==="/$")return null}}return s}var Uv=null;function CN(s){s=s.previousSibling;for(var o=0;s;){if(s.nodeType===8){var f=s.data;if(f==="$"||f==="$!"||f==="$?"){if(o===0)return s;o--}else f==="/$"&&o++}s=s.previousSibling}return null}function ON(s,o,f){switch(o=I0(f),s){case"html":if(s=o.documentElement,!s)throw Error(n(452));return s;case"head":if(s=o.head,!s)throw Error(n(453));return s;case"body":if(s=o.body,!s)throw Error(n(454));return s;default:throw Error(n(451))}}function Gu(s){for(var o=s.attributes;o.length;)s.removeAttributeNode(o[0]);X(s)}var ka=new Map,DN=new Set;function L0(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Ji=H.d;H.d={f:pF,r:xF,D:vF,C:gF,L:yF,m:bF,X:SF,S:wF,M:EF};function pF(){var s=Ji.f(),o=k0();return s||o}function xF(s){var o=te(s);o!==null&&o.tag===5&&o.type==="form"?QE(o):Ji.r(s)}var fc=typeof document>"u"?null:document;function PN(s,o,f){var x=fc;if(x&&typeof o=="string"&&o){var E=Sa(o);E='link[rel="'+s+'"][href="'+E+'"]',typeof f=="string"&&(E+='[crossorigin="'+f+'"]'),DN.has(E)||(DN.add(E),s={rel:s,crossOrigin:f,href:o},x.querySelector(E)===null&&(o=x.createElement("link"),Xr(o,"link",s),le(o),x.head.appendChild(o)))}}function vF(s){Ji.D(s),PN("dns-prefetch",s,null)}function gF(s,o){Ji.C(s,o),PN("preconnect",s,o)}function yF(s,o,f){Ji.L(s,o,f);var x=fc;if(x&&s&&o){var E='link[rel="preload"][as="'+Sa(o)+'"]';o==="image"&&f&&f.imageSrcSet?(E+='[imagesrcset="'+Sa(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(E+='[imagesizes="'+Sa(f.imageSizes)+'"]')):E+='[href="'+Sa(s)+'"]';var N=E;switch(o){case"style":N=dc(s);break;case"script":N=hc(s)}ka.has(N)||(s=m({rel:"preload",href:o==="image"&&f&&f.imageSrcSet?void 0:s,as:o},f),ka.set(N,s),x.querySelector(E)!==null||o==="style"&&x.querySelector(Wu(N))||o==="script"&&x.querySelector(Yu(N))||(o=x.createElement("link"),Xr(o,"link",s),le(o),x.head.appendChild(o)))}}function bF(s,o){Ji.m(s,o);var f=fc;if(f&&s){var x=o&&typeof o.as=="string"?o.as:"script",E='link[rel="modulepreload"][as="'+Sa(x)+'"][href="'+Sa(s)+'"]',N=E;switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":N=hc(s)}if(!ka.has(N)&&(s=m({rel:"modulepreload",href:s},o),ka.set(N,s),f.querySelector(E)===null)){switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(Yu(N)))return}x=f.createElement("link"),Xr(x,"link",s),le(x),f.head.appendChild(x)}}}function wF(s,o,f){Ji.S(s,o,f);var x=fc;if(x&&s){var E=pe(x).hoistableStyles,N=dc(s);o=o||"default";var R=E.get(N);if(!R){var B={loading:0,preload:null};if(R=x.querySelector(Wu(N)))B.loading=5;else{s=m({rel:"stylesheet",href:s,"data-precedence":o},f),(f=ka.get(N))&&$v(s,f);var se=R=x.createElement("link");le(se),Xr(se,"link",s),se._p=new Promise(function(_e,Le){se.onload=_e,se.onerror=Le}),se.addEventListener("load",function(){B.loading|=1}),se.addEventListener("error",function(){B.loading|=2}),B.loading|=4,B0(R,o,x)}R={type:"stylesheet",instance:R,count:1,state:B},E.set(N,R)}}}function SF(s,o){Ji.X(s,o);var f=fc;if(f&&s){var x=pe(f).hoistableScripts,E=hc(s),N=x.get(E);N||(N=f.querySelector(Yu(E)),N||(s=m({src:s,async:!0},o),(o=ka.get(E))&&zv(s,o),N=f.createElement("script"),le(N),Xr(N,"link",s),f.head.appendChild(N)),N={type:"script",instance:N,count:1,state:null},x.set(E,N))}}function EF(s,o){Ji.M(s,o);var f=fc;if(f&&s){var x=pe(f).hoistableScripts,E=hc(s),N=x.get(E);N||(N=f.querySelector(Yu(E)),N||(s=m({src:s,async:!0,type:"module"},o),(o=ka.get(E))&&zv(s,o),N=f.createElement("script"),le(N),Xr(N,"link",s),f.head.appendChild(N)),N={type:"script",instance:N,count:1,state:null},x.set(E,N))}}function RN(s,o,f,x){var E=(E=fe.current)?L0(E):null;if(!E)throw Error(n(446));switch(s){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(o=dc(f.href),f=pe(E).hoistableStyles,x=f.get(o),x||(x={type:"style",instance:null,count:0,state:null},f.set(o,x)),x):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){s=dc(f.href);var N=pe(E).hoistableStyles,R=N.get(s);if(R||(E=E.ownerDocument||E,R={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},N.set(s,R),(N=E.querySelector(Wu(s)))&&!N._p&&(R.instance=N,R.state.loading=5),ka.has(s)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},ka.set(s,f),N||jF(E,s,f,R.state))),o&&x===null)throw Error(n(528,""));return R}if(o&&x!==null)throw Error(n(529,""));return null;case"script":return o=f.async,f=f.src,typeof f=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=hc(f),f=pe(E).hoistableScripts,x=f.get(o),x||(x={type:"script",instance:null,count:0,state:null},f.set(o,x)),x):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,s))}}function dc(s){return'href="'+Sa(s)+'"'}function Wu(s){return'link[rel="stylesheet"]['+s+"]"}function MN(s){return m({},s,{"data-precedence":s.precedence,precedence:null})}function jF(s,o,f,x){s.querySelector('link[rel="preload"][as="style"]['+o+"]")?x.loading=1:(o=s.createElement("link"),x.preload=o,o.addEventListener("load",function(){return x.loading|=1}),o.addEventListener("error",function(){return x.loading|=2}),Xr(o,"link",f),le(o),s.head.appendChild(o))}function hc(s){return'[src="'+Sa(s)+'"]'}function Yu(s){return"script[async]"+s}function FN(s,o,f){if(o.count++,o.instance===null)switch(o.type){case"style":var x=s.querySelector('style[data-href~="'+Sa(f.href)+'"]');if(x)return o.instance=x,le(x),x;var E=m({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return x=(s.ownerDocument||s).createElement("style"),le(x),Xr(x,"style",E),B0(x,f.precedence,s),o.instance=x;case"stylesheet":E=dc(f.href);var N=s.querySelector(Wu(E));if(N)return o.state.loading|=4,o.instance=N,le(N),N;x=MN(f),(E=ka.get(E))&&$v(x,E),N=(s.ownerDocument||s).createElement("link"),le(N);var R=N;return R._p=new Promise(function(B,se){R.onload=B,R.onerror=se}),Xr(N,"link",x),o.state.loading|=4,B0(N,f.precedence,s),o.instance=N;case"script":return N=hc(f.src),(E=s.querySelector(Yu(N)))?(o.instance=E,le(E),E):(x=f,(E=ka.get(N))&&(x=m({},f),zv(x,E)),s=s.ownerDocument||s,E=s.createElement("script"),le(E),Xr(E,"link",x),s.head.appendChild(E),o.instance=E);case"void":return null;default:throw Error(n(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(x=o.instance,o.state.loading|=4,B0(x,f.precedence,s));return o.instance}function B0(s,o,f){for(var x=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),E=x.length?x[x.length-1]:null,N=E,R=0;R<x.length;R++){var B=x[R];if(B.dataset.precedence===o)N=B;else if(N!==E)break}N?N.parentNode.insertBefore(s,N.nextSibling):(o=f.nodeType===9?f.head:f,o.insertBefore(s,o.firstChild))}function $v(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.title==null&&(s.title=o.title)}function zv(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.integrity==null&&(s.integrity=o.integrity)}var U0=null;function IN(s,o,f){if(U0===null){var x=new Map,E=U0=new Map;E.set(f,x)}else E=U0,x=E.get(f),x||(x=new Map,E.set(f,x));if(x.has(s))return x;for(x.set(s,null),f=f.getElementsByTagName(s),E=0;E<f.length;E++){var N=f[E];if(!(N[K]||N[vr]||s==="link"&&N.getAttribute("rel")==="stylesheet")&&N.namespaceURI!=="http://www.w3.org/2000/svg"){var R=N.getAttribute(o)||"";R=s+R;var B=x.get(R);B?B.push(N):x.set(R,[N])}}return x}function LN(s,o,f){s=s.ownerDocument||s,s.head.insertBefore(f,o==="title"?s.querySelector("head > title"):null)}function NF(s,o,f){if(f===1||o.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return s=o.disabled,typeof o.precedence=="string"&&s==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function BN(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var Xu=null;function AF(){}function _F(s,o,f){if(Xu===null)throw Error(n(475));var x=Xu;if(o.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var E=dc(f.href),N=s.querySelector(Wu(E));if(N){s=N._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(x.count++,x=$0.bind(x),s.then(x,x)),o.state.loading|=4,o.instance=N,le(N);return}N=s.ownerDocument||s,f=MN(f),(E=ka.get(E))&&$v(f,E),N=N.createElement("link"),le(N);var R=N;R._p=new Promise(function(B,se){R.onload=B,R.onerror=se}),Xr(N,"link",f),o.instance=N}x.stylesheets===null&&(x.stylesheets=new Map),x.stylesheets.set(o,s),(s=o.state.preload)&&(o.state.loading&3)===0&&(x.count++,o=$0.bind(x),s.addEventListener("load",o),s.addEventListener("error",o))}}function TF(){if(Xu===null)throw Error(n(475));var s=Xu;return s.stylesheets&&s.count===0&&Hv(s,s.stylesheets),0<s.count?function(o){var f=setTimeout(function(){if(s.stylesheets&&Hv(s,s.stylesheets),s.unsuspend){var x=s.unsuspend;s.unsuspend=null,x()}},6e4);return s.unsuspend=o,function(){s.unsuspend=null,clearTimeout(f)}}:null}function $0(){if(this.count--,this.count===0){if(this.stylesheets)Hv(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var z0=null;function Hv(s,o){s.stylesheets=null,s.unsuspend!==null&&(s.count++,z0=new Map,o.forEach(kF,s),z0=null,$0.call(s))}function kF(s,o){if(!(o.state.loading&4)){var f=z0.get(s);if(f)var x=f.get(null);else{f=new Map,z0.set(s,f);for(var E=s.querySelectorAll("link[data-precedence],style[data-precedence]"),N=0;N<E.length;N++){var R=E[N];(R.nodeName==="LINK"||R.getAttribute("media")!=="not all")&&(f.set(R.dataset.precedence,R),x=R)}x&&f.set(null,x)}E=o.instance,R=E.getAttribute("data-precedence"),N=f.get(R)||x,N===x&&f.set(null,E),f.set(R,E),this.count++,x=$0.bind(this),E.addEventListener("load",x),E.addEventListener("error",x),N?N.parentNode.insertBefore(E,N.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(E,s.firstChild)),o.state.loading|=4}}var Zu={$$typeof:A,Provider:null,Consumer:null,_currentValue:Se,_currentValue2:Se,_threadCount:0};function CF(s,o,f,x,E,N,R,B){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ts(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ts(0),this.hiddenUpdates=Ts(null),this.identifierPrefix=x,this.onUncaughtError=E,this.onCaughtError=N,this.onRecoverableError=R,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=B,this.incompleteTransitions=new Map}function UN(s,o,f,x,E,N,R,B,se,_e,Le,$e){return s=new CF(s,o,f,R,B,se,_e,$e),o=1,N===!0&&(o|=24),N=Yn(3,null,null,o),s.current=N,N.stateNode=s,o=jx(),o.refCount++,s.pooledCache=o,o.refCount++,N.memoizedState={element:x,isDehydrated:f,cache:o},Tx(N),s}function $N(s){return s?(s=qo,s):qo}function zN(s,o,f,x,E,N){E=$N(E),x.context===null?x.context=E:x.pendingContext=E,x=Rs(o),x.payload={element:f},N=N===void 0?null:N,N!==null&&(x.callback=N),f=Ms(s,x,o),f!==null&&(ea(f,s,o),_u(f,s,o))}function HN(s,o){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var f=s.retryLane;s.retryLane=f!==0&&f<o?f:o}}function qv(s,o){HN(s,o),(s=s.alternate)&&HN(s,o)}function qN(s){if(s.tag===13){var o=Ho(s,67108864);o!==null&&ea(o,s,67108864),qv(s,67108864)}}var H0=!0;function OF(s,o,f,x){var E=V.T;V.T=null;var N=H.p;try{H.p=2,Vv(s,o,f,x)}finally{H.p=N,V.T=E}}function DF(s,o,f,x){var E=V.T;V.T=null;var N=H.p;try{H.p=8,Vv(s,o,f,x)}finally{H.p=N,V.T=E}}function Vv(s,o,f,x){if(H0){var E=Kv(x);if(E===null)Dv(s,o,x,q0,f),KN(s,x);else if(RF(E,s,o,f,x))x.stopPropagation();else if(KN(s,x),o&4&&-1<PF.indexOf(s)){for(;E!==null;){var N=te(E);if(N!==null)switch(N.tag){case 3:if(N=N.stateNode,N.current.memoizedState.isDehydrated){var R=nn(N.pendingLanes);if(R!==0){var B=N;for(B.pendingLanes|=2,B.entangledLanes|=2;R;){var se=1<<31-ne(R);B.entanglements[1]|=se,R&=~se}Si(N),(It&6)===0&&(_0=ce()+500,qu(0))}}break;case 13:B=Ho(N,2),B!==null&&ea(B,N,2),k0(),qv(N,2)}if(N=Kv(x),N===null&&Dv(s,o,x,q0,f),N===E)break;E=N}E!==null&&x.stopPropagation()}else Dv(s,o,x,null,f)}}function Kv(s){return s=Zp(s),Gv(s)}var q0=null;function Gv(s){if(q0=null,s=J(s),s!==null){var o=i(s);if(o===null)s=null;else{var f=o.tag;if(f===13){if(s=l(o),s!==null)return s;s=null}else if(f===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;s=null}else o!==s&&(s=null)}}return q0=s,null}function VN(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ze()){case Qe:return 2;case Ke:return 8;case qe:case it:return 32;case Je:return 268435456;default:return 32}default:return 32}}var Wv=!1,Ws=null,Ys=null,Xs=null,Qu=new Map,Ju=new Map,Zs=[],PF="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function KN(s,o){switch(s){case"focusin":case"focusout":Ws=null;break;case"dragenter":case"dragleave":Ys=null;break;case"mouseover":case"mouseout":Xs=null;break;case"pointerover":case"pointerout":Qu.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ju.delete(o.pointerId)}}function ef(s,o,f,x,E,N){return s===null||s.nativeEvent!==N?(s={blockedOn:o,domEventName:f,eventSystemFlags:x,nativeEvent:N,targetContainers:[E]},o!==null&&(o=te(o),o!==null&&qN(o)),s):(s.eventSystemFlags|=x,o=s.targetContainers,E!==null&&o.indexOf(E)===-1&&o.push(E),s)}function RF(s,o,f,x,E){switch(o){case"focusin":return Ws=ef(Ws,s,o,f,x,E),!0;case"dragenter":return Ys=ef(Ys,s,o,f,x,E),!0;case"mouseover":return Xs=ef(Xs,s,o,f,x,E),!0;case"pointerover":var N=E.pointerId;return Qu.set(N,ef(Qu.get(N)||null,s,o,f,x,E)),!0;case"gotpointercapture":return N=E.pointerId,Ju.set(N,ef(Ju.get(N)||null,s,o,f,x,E)),!0}return!1}function GN(s){var o=J(s.target);if(o!==null){var f=i(o);if(f!==null){if(o=f.tag,o===13){if(o=l(f),o!==null){s.blockedOn=o,Cs(s.priority,function(){if(f.tag===13){var x=Jn();x=ks(x);var E=Ho(f,x);E!==null&&ea(E,f,x),qv(f,x)}});return}}else if(o===3&&f.stateNode.current.memoizedState.isDehydrated){s.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}s.blockedOn=null}function V0(s){if(s.blockedOn!==null)return!1;for(var o=s.targetContainers;0<o.length;){var f=Kv(s.nativeEvent);if(f===null){f=s.nativeEvent;var x=new f.constructor(f.type,f);Xp=x,f.target.dispatchEvent(x),Xp=null}else return o=te(f),o!==null&&qN(o),s.blockedOn=f,!1;o.shift()}return!0}function WN(s,o,f){V0(s)&&f.delete(o)}function MF(){Wv=!1,Ws!==null&&V0(Ws)&&(Ws=null),Ys!==null&&V0(Ys)&&(Ys=null),Xs!==null&&V0(Xs)&&(Xs=null),Qu.forEach(WN),Ju.forEach(WN)}function K0(s,o){s.blockedOn===o&&(s.blockedOn=null,Wv||(Wv=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,MF)))}var G0=null;function YN(s){G0!==s&&(G0=s,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){G0===s&&(G0=null);for(var o=0;o<s.length;o+=3){var f=s[o],x=s[o+1],E=s[o+2];if(typeof x!="function"){if(Gv(x||f)===null)continue;break}var N=te(f);N!==null&&(s.splice(o,3),o-=3,Gx(N,{pending:!0,data:E,method:f.method,action:x},x,E))}}))}function tf(s){function o(se){return K0(se,s)}Ws!==null&&K0(Ws,s),Ys!==null&&K0(Ys,s),Xs!==null&&K0(Xs,s),Qu.forEach(o),Ju.forEach(o);for(var f=0;f<Zs.length;f++){var x=Zs[f];x.blockedOn===s&&(x.blockedOn=null)}for(;0<Zs.length&&(f=Zs[0],f.blockedOn===null);)GN(f),f.blockedOn===null&&Zs.shift();if(f=(s.ownerDocument||s).$$reactFormReplay,f!=null)for(x=0;x<f.length;x+=3){var E=f[x],N=f[x+1],R=E[gr]||null;if(typeof N=="function")R||YN(f);else if(R){var B=null;if(N&&N.hasAttribute("formAction")){if(E=N,R=N[gr]||null)B=R.formAction;else if(Gv(E)!==null)continue}else B=R.action;typeof B=="function"?f[x+1]=B:(f.splice(x,3),x-=3),YN(f)}}}function Yv(s){this._internalRoot=s}W0.prototype.render=Yv.prototype.render=function(s){var o=this._internalRoot;if(o===null)throw Error(n(409));var f=o.current,x=Jn();zN(f,x,s,o,null,null)},W0.prototype.unmount=Yv.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var o=s.containerInfo;zN(s.current,2,null,s,null,null),k0(),o[vi]=null}};function W0(s){this._internalRoot=s}W0.prototype.unstable_scheduleHydration=function(s){if(s){var o=Cl();s={blockedOn:null,target:s,priority:o};for(var f=0;f<Zs.length&&o!==0&&o<Zs[f].priority;f++);Zs.splice(f,0,s),f===0&&GN(s)}};var XN=t.version;if(XN!=="19.1.0")throw Error(n(527,XN,"19.1.0"));H.findDOMNode=function(s){var o=s._reactInternals;if(o===void 0)throw typeof s.render=="function"?Error(n(188)):(s=Object.keys(s).join(","),Error(n(268,s)));return s=h(o),s=s!==null?d(s):null,s=s===null?null:s.stateNode,s};var FF={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:V,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Y0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Y0.isDisabled&&Y0.supportsFiber)try{ge=Y0.inject(FF),Ge=Y0}catch{}}return nf.createRoot=function(s,o){if(!a(s))throw Error(n(299));var f=!1,x="",E=dj,N=hj,R=mj,B=null;return o!=null&&(o.unstable_strictMode===!0&&(f=!0),o.identifierPrefix!==void 0&&(x=o.identifierPrefix),o.onUncaughtError!==void 0&&(E=o.onUncaughtError),o.onCaughtError!==void 0&&(N=o.onCaughtError),o.onRecoverableError!==void 0&&(R=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(B=o.unstable_transitionCallbacks)),o=UN(s,1,!1,null,null,f,x,E,N,R,B,null),s[vi]=o.current,Ov(s),new Yv(o)},nf.hydrateRoot=function(s,o,f){if(!a(s))throw Error(n(299));var x=!1,E="",N=dj,R=hj,B=mj,se=null,_e=null;return f!=null&&(f.unstable_strictMode===!0&&(x=!0),f.identifierPrefix!==void 0&&(E=f.identifierPrefix),f.onUncaughtError!==void 0&&(N=f.onUncaughtError),f.onCaughtError!==void 0&&(R=f.onCaughtError),f.onRecoverableError!==void 0&&(B=f.onRecoverableError),f.unstable_transitionCallbacks!==void 0&&(se=f.unstable_transitionCallbacks),f.formState!==void 0&&(_e=f.formState)),o=UN(s,1,!0,o,f??null,x,E,N,R,B,se,_e),o.context=$N(null),f=o.current,x=Jn(),x=ks(x),E=Rs(x),E.callback=null,Ms(f,E,x),f=x,o.current.lanes=f,ba(o,f),Si(o),s[vi]=o.current,Ov(s),new W0(o)},nf.version="19.1.0",nf}var sA;function VF(){if(sA)return Qv.exports;sA=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Qv.exports=qF(),Qv.exports}var KF=VF();const GF=Ga(KF);/**
 * react-router v7.9.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var lA="popstate";function WF(e={}){function t(n,a){let{pathname:i,search:l,hash:u}=n.location;return cy("",{pathname:i,search:l,hash:u},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:Bf(a)}return XF(t,r,null,e)}function nr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function za(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function YF(){return Math.random().toString(36).substring(2,10)}function oA(e,t){return{usr:e.state,key:e.key,idx:t}}function cy(e,t,r=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?Kc(t):t,state:r,key:t&&t.key||n||YF()}}function Bf({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Kc(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function XF(e,t,r,n={}){let{window:a=document.defaultView,v5Compat:i=!1}=n,l=a.history,u="POP",h=null,d=m();d==null&&(d=0,l.replaceState({...l.state,idx:d},""));function m(){return(l.state||{idx:null}).idx}function p(){u="POP";let S=m(),j=S==null?null:S-d;d=S,h&&h({action:u,location:b.location,delta:j})}function v(S,j){u="PUSH";let _=cy(b.location,S,j);d=m()+1;let A=oA(_,d),k=b.createHref(_);try{l.pushState(A,"",k)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;a.location.assign(k)}i&&h&&h({action:u,location:b.location,delta:1})}function g(S,j){u="REPLACE";let _=cy(b.location,S,j);d=m();let A=oA(_,d),k=b.createHref(_);l.replaceState(A,"",k),i&&h&&h({action:u,location:b.location,delta:0})}function w(S){return ZF(S)}let b={get action(){return u},get location(){return e(a,l)},listen(S){if(h)throw new Error("A history only accepts one active listener");return a.addEventListener(lA,p),h=S,()=>{a.removeEventListener(lA,p),h=null}},createHref(S){return t(a,S)},createURL:w,encodeLocation(S){let j=w(S);return{pathname:j.pathname,search:j.search,hash:j.hash}},push:v,replace:g,go(S){return l.go(S)}};return b}function ZF(e,t=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),nr(r,"No window.location.(origin|href) available to create URL");let n=typeof e=="string"?e:Bf(e);return n=n.replace(/ $/,"%20"),!t&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function oC(e,t,r="/"){return QF(e,t,r,!1)}function QF(e,t,r,n){let a=typeof t=="string"?Kc(t):t,i=fs(a.pathname||"/",r);if(i==null)return null;let l=cC(e);JF(l);let u=null;for(let h=0;u==null&&h<l.length;++h){let d=uI(i);u=oI(l[h],d,n)}return u}function cC(e,t=[],r=[],n="",a=!1){let i=(l,u,h=a,d)=>{let m={relativePath:d===void 0?l.path||"":d,caseSensitive:l.caseSensitive===!0,childrenIndex:u,route:l};if(m.relativePath.startsWith("/")){if(!m.relativePath.startsWith(n)&&h)return;nr(m.relativePath.startsWith(n),`Absolute route path "${m.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),m.relativePath=m.relativePath.slice(n.length)}let p=is([n,m.relativePath]),v=r.concat(m);l.children&&l.children.length>0&&(nr(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),cC(l.children,t,v,p,h)),!(l.path==null&&!l.index)&&t.push({path:p,score:sI(p,l.index),routesMeta:v})};return e.forEach((l,u)=>{if(l.path===""||!l.path?.includes("?"))i(l,u);else for(let h of uC(l.path))i(l,u,!0,h)}),t}function uC(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let l=uC(n.join("/")),u=[];return u.push(...l.map(h=>h===""?i:[i,h].join("/"))),a&&u.push(...l),u.map(h=>e.startsWith("/")&&h===""?"/":h)}function JF(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:lI(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var eI=/^:[\w-]+$/,tI=3,rI=2,nI=1,aI=10,iI=-2,cA=e=>e==="*";function sI(e,t){let r=e.split("/"),n=r.length;return r.some(cA)&&(n+=iI),t&&(n+=rI),r.filter(a=>!cA(a)).reduce((a,i)=>a+(eI.test(i)?tI:i===""?nI:aI),n)}function lI(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function oI(e,t,r=!1){let{routesMeta:n}=e,a={},i="/",l=[];for(let u=0;u<n.length;++u){let h=n[u],d=u===n.length-1,m=i==="/"?t:t.slice(i.length)||"/",p=Fh({path:h.relativePath,caseSensitive:h.caseSensitive,end:d},m),v=h.route;if(!p&&d&&r&&!n[n.length-1].route.index&&(p=Fh({path:h.relativePath,caseSensitive:h.caseSensitive,end:!1},m)),!p)return null;Object.assign(a,p.params),l.push({params:a,pathname:is([i,p.pathname]),pathnameBase:mI(is([i,p.pathnameBase])),route:v}),p.pathnameBase!=="/"&&(i=is([i,p.pathnameBase]))}return l}function Fh(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=cI(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let i=a[0],l=i.replace(/(.)\/+$/,"$1"),u=a.slice(1);return{params:n.reduce((d,{paramName:m,isOptional:p},v)=>{if(m==="*"){let w=u[v]||"";l=i.slice(0,i.length-w.length).replace(/(.)\/+$/,"$1")}const g=u[v];return p&&!g?d[m]=void 0:d[m]=(g||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:l,pattern:e}}function cI(e,t=!1,r=!0){za(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,u,h)=>(n.push({paramName:u,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function uI(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return za(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function fs(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function fI(e,t="/"){let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?Kc(e):e;return{pathname:r?r.startsWith("/")?r:dI(r,t):t,search:pI(n),hash:xI(a)}}function dI(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function rg(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function hI(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Cb(e){let t=hI(e);return t.map((r,n)=>n===t.length-1?r.pathname:r.pathnameBase)}function Ob(e,t,r,n=!1){let a;typeof e=="string"?a=Kc(e):(a={...e},nr(!a.pathname||!a.pathname.includes("?"),rg("?","pathname","search",a)),nr(!a.pathname||!a.pathname.includes("#"),rg("#","pathname","hash",a)),nr(!a.search||!a.search.includes("#"),rg("#","search","hash",a)));let i=e===""||a.pathname==="",l=i?"/":a.pathname,u;if(l==null)u=r;else{let p=t.length-1;if(!n&&l.startsWith("..")){let v=l.split("/");for(;v[0]==="..";)v.shift(),p-=1;a.pathname=v.join("/")}u=p>=0?t[p]:"/"}let h=fI(a,u),d=l&&l!=="/"&&l.endsWith("/"),m=(i||l===".")&&r.endsWith("/");return!h.pathname.endsWith("/")&&(d||m)&&(h.pathname+="/"),h}var is=e=>e.join("/").replace(/\/\/+/g,"/"),mI=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),pI=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,xI=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function vI(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var fC=["POST","PUT","PATCH","DELETE"];new Set(fC);var gI=["GET",...fC];new Set(gI);var Gc=y.createContext(null);Gc.displayName="DataRouter";var Lm=y.createContext(null);Lm.displayName="DataRouterState";y.createContext(!1);var dC=y.createContext({isTransitioning:!1});dC.displayName="ViewTransition";var yI=y.createContext(new Map);yI.displayName="Fetchers";var bI=y.createContext(null);bI.displayName="Await";var di=y.createContext(null);di.displayName="Navigation";var cd=y.createContext(null);cd.displayName="Location";var Wa=y.createContext({outlet:null,matches:[],isDataRoute:!1});Wa.displayName="Route";var Db=y.createContext(null);Db.displayName="RouteError";function wI(e,{relative:t}={}){nr(Wc(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=y.useContext(di),{hash:a,pathname:i,search:l}=ud(e,{relative:t}),u=i;return r!=="/"&&(u=i==="/"?r:is([r,i])),n.createHref({pathname:u,search:l,hash:a})}function Wc(){return y.useContext(cd)!=null}function ga(){return nr(Wc(),"useLocation() may be used only in the context of a <Router> component."),y.useContext(cd).location}var hC="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function mC(e){y.useContext(di).static||y.useLayoutEffect(e)}function Fi(){let{isDataRoute:e}=y.useContext(Wa);return e?II():SI()}function SI(){nr(Wc(),"useNavigate() may be used only in the context of a <Router> component.");let e=y.useContext(Gc),{basename:t,navigator:r}=y.useContext(di),{matches:n}=y.useContext(Wa),{pathname:a}=ga(),i=JSON.stringify(Cb(n)),l=y.useRef(!1);return mC(()=>{l.current=!0}),y.useCallback((h,d={})=>{if(za(l.current,hC),!l.current)return;if(typeof h=="number"){r.go(h);return}let m=Ob(h,JSON.parse(i),a,d.relative==="path");e==null&&t!=="/"&&(m.pathname=m.pathname==="/"?t:is([t,m.pathname])),(d.replace?r.replace:r.push)(m,d.state,d)},[t,r,i,a,e])}var EI=y.createContext(null);function jI(e){let t=y.useContext(Wa).outlet;return t&&y.createElement(EI.Provider,{value:e},t)}function NI(){let{matches:e}=y.useContext(Wa),t=e[e.length-1];return t?t.params:{}}function ud(e,{relative:t}={}){let{matches:r}=y.useContext(Wa),{pathname:n}=ga(),a=JSON.stringify(Cb(r));return y.useMemo(()=>Ob(e,JSON.parse(a),n,t==="path"),[e,a,n,t])}function AI(e,t){return pC(e,t)}function pC(e,t,r,n,a){nr(Wc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=y.useContext(di),{matches:l}=y.useContext(Wa),u=l[l.length-1],h=u?u.params:{},d=u?u.pathname:"/",m=u?u.pathnameBase:"/",p=u&&u.route;{let _=p&&p.path||"";xC(d,!p||_.endsWith("*")||_.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${_}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${_}"> to <Route path="${_==="/"?"*":`${_}/*`}">.`)}let v=ga(),g;if(t){let _=typeof t=="string"?Kc(t):t;nr(m==="/"||_.pathname?.startsWith(m),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${m}" but pathname "${_.pathname}" was given in the \`location\` prop.`),g=_}else g=v;let w=g.pathname||"/",b=w;if(m!=="/"){let _=m.replace(/^\//,"").split("/");b="/"+w.replace(/^\//,"").split("/").slice(_.length).join("/")}let S=oC(e,{pathname:b});za(p||S!=null,`No routes matched location "${g.pathname}${g.search}${g.hash}" `),za(S==null||S[S.length-1].route.element!==void 0||S[S.length-1].route.Component!==void 0||S[S.length-1].route.lazy!==void 0,`Matched leaf route at location "${g.pathname}${g.search}${g.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let j=OI(S&&S.map(_=>Object.assign({},_,{params:Object.assign({},h,_.params),pathname:is([m,i.encodeLocation?i.encodeLocation(_.pathname).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?m:is([m,i.encodeLocation?i.encodeLocation(_.pathnameBase).pathname:_.pathnameBase])})),l,r,n,a);return t&&j?y.createElement(cd.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...g},navigationType:"POP"}},j):j}function _I(){let e=FI(),t=vI(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},i={padding:"2px 4px",backgroundColor:n},l=null;return console.error("Error handled by React Router default ErrorBoundary:",e),l=y.createElement(y.Fragment,null,y.createElement("p",null," Hey developer "),y.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",y.createElement("code",{style:i},"ErrorBoundary")," or"," ",y.createElement("code",{style:i},"errorElement")," prop on your route.")),y.createElement(y.Fragment,null,y.createElement("h2",null,"Unexpected Application Error!"),y.createElement("h3",{style:{fontStyle:"italic"}},t),r?y.createElement("pre",{style:a},r):null,l)}var TI=y.createElement(_I,null),kI=class extends y.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error("React Router caught the following error during render",e)}render(){return this.state.error!==void 0?y.createElement(Wa.Provider,{value:this.props.routeContext},y.createElement(Db.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function CI({routeContext:e,match:t,children:r}){let n=y.useContext(Gc);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),y.createElement(Wa.Provider,{value:e},r)}function OI(e,t=[],r=null,n=null,a=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,l=r?.errors;if(l!=null){let d=i.findIndex(m=>m.route.id&&l?.[m.route.id]!==void 0);nr(d>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),i=i.slice(0,Math.min(i.length,d+1))}let u=!1,h=-1;if(r)for(let d=0;d<i.length;d++){let m=i[d];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(h=d),m.route.id){let{loaderData:p,errors:v}=r,g=m.route.loader&&!p.hasOwnProperty(m.route.id)&&(!v||v[m.route.id]===void 0);if(m.route.lazy||g){u=!0,h>=0?i=i.slice(0,h+1):i=[i[0]];break}}}return i.reduceRight((d,m,p)=>{let v,g=!1,w=null,b=null;r&&(v=l&&m.route.id?l[m.route.id]:void 0,w=m.route.errorElement||TI,u&&(h<0&&p===0?(xC("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),g=!0,b=null):h===p&&(g=!0,b=m.route.hydrateFallbackElement||null)));let S=t.concat(i.slice(0,p+1)),j=()=>{let _;return v?_=w:g?_=b:m.route.Component?_=y.createElement(m.route.Component,null):m.route.element?_=m.route.element:_=d,y.createElement(CI,{match:m,routeContext:{outlet:d,matches:S,isDataRoute:r!=null},children:_})};return r&&(m.route.ErrorBoundary||m.route.errorElement||p===0)?y.createElement(kI,{location:r.location,revalidation:r.revalidation,component:w,error:v,children:j(),routeContext:{outlet:null,matches:S,isDataRoute:!0},unstable_onError:n}):j()},null)}function Pb(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function DI(e){let t=y.useContext(Gc);return nr(t,Pb(e)),t}function PI(e){let t=y.useContext(Lm);return nr(t,Pb(e)),t}function RI(e){let t=y.useContext(Wa);return nr(t,Pb(e)),t}function Rb(e){let t=RI(e),r=t.matches[t.matches.length-1];return nr(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function MI(){return Rb("useRouteId")}function FI(){let e=y.useContext(Db),t=PI("useRouteError"),r=Rb("useRouteError");return e!==void 0?e:t.errors?.[r]}function II(){let{router:e}=DI("useNavigate"),t=Rb("useNavigate"),r=y.useRef(!1);return mC(()=>{r.current=!0}),y.useCallback(async(a,i={})=>{za(r.current,hC),r.current&&(typeof a=="number"?e.navigate(a):await e.navigate(a,{fromRouteId:t,...i}))},[e,t])}var uA={};function xC(e,t,r){!t&&!uA[e]&&(uA[e]=!0,za(!1,r))}y.memo(LI);function LI({routes:e,future:t,state:r,unstable_onError:n}){return pC(e,void 0,r,n,t)}function La({to:e,replace:t,state:r,relative:n}){nr(Wc(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=y.useContext(di);za(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=y.useContext(Wa),{pathname:l}=ga(),u=Fi(),h=Ob(e,Cb(i),l,n==="path"),d=JSON.stringify(h);return y.useEffect(()=>{u(JSON.parse(d),{replace:t,state:r,relative:n})},[u,d,n,t,r]),null}function uy(e){return jI(e.context)}function Ur(e){nr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function BI({basename:e="/",children:t=null,location:r,navigationType:n="POP",navigator:a,static:i=!1}){nr(!Wc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=e.replace(/^\/*/,"/"),u=y.useMemo(()=>({basename:l,navigator:a,static:i,future:{}}),[l,a,i]);typeof r=="string"&&(r=Kc(r));let{pathname:h="/",search:d="",hash:m="",state:p=null,key:v="default"}=r,g=y.useMemo(()=>{let w=fs(h,l);return w==null?null:{location:{pathname:w,search:d,hash:m,state:p,key:v},navigationType:n}},[l,h,d,m,p,v,n]);return za(g!=null,`<Router basename="${l}"> is not able to match the URL "${h}${d}${m}" because it does not start with the basename, so the <Router> won't render anything.`),g==null?null:y.createElement(di.Provider,{value:u},y.createElement(cd.Provider,{children:t,value:g}))}function UI({children:e,location:t}){return AI(fy(e),t)}function fy(e,t=[]){let r=[];return y.Children.forEach(e,(n,a)=>{if(!y.isValidElement(n))return;let i=[...t,a];if(n.type===y.Fragment){r.push.apply(r,fy(n.props.children,i));return}nr(n.type===Ur,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),nr(!n.props.index||!n.props.children,"An index route cannot have child routes.");let l={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(l.children=fy(n.props.children,i)),r.push(l)}),r}var kh="get",Ch="application/x-www-form-urlencoded";function Bm(e){return e!=null&&typeof e.tagName=="string"}function $I(e){return Bm(e)&&e.tagName.toLowerCase()==="button"}function zI(e){return Bm(e)&&e.tagName.toLowerCase()==="form"}function HI(e){return Bm(e)&&e.tagName.toLowerCase()==="input"}function qI(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function VI(e,t){return e.button===0&&(!t||t==="_self")&&!qI(e)}function dy(e=""){return new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(a=>[r,a]):[[r,n]])},[]))}function KI(e,t){let r=dy(e);return t&&t.forEach((n,a)=>{r.has(a)||t.getAll(a).forEach(i=>{r.append(a,i)})}),r}var X0=null;function GI(){if(X0===null)try{new FormData(document.createElement("form"),0),X0=!1}catch{X0=!0}return X0}var WI=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function ng(e){return e!=null&&!WI.has(e)?(za(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Ch}"`),null):e}function YI(e,t){let r,n,a,i,l;if(zI(e)){let u=e.getAttribute("action");n=u?fs(u,t):null,r=e.getAttribute("method")||kh,a=ng(e.getAttribute("enctype"))||Ch,i=new FormData(e)}else if($I(e)||HI(e)&&(e.type==="submit"||e.type==="image")){let u=e.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let h=e.getAttribute("formaction")||u.getAttribute("action");if(n=h?fs(h,t):null,r=e.getAttribute("formmethod")||u.getAttribute("method")||kh,a=ng(e.getAttribute("formenctype"))||ng(u.getAttribute("enctype"))||Ch,i=new FormData(u,e),!GI()){let{name:d,type:m,value:p}=e;if(m==="image"){let v=d?`${d}.`:"";i.append(`${v}x`,"0"),i.append(`${v}y`,"0")}else d&&i.append(d,p)}}else{if(Bm(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=kh,n=null,a=Ch,l=e}return i&&a==="text/plain"&&(l=i,i=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:i,body:l}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Mb(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function XI(e,t,r){let n=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return n.pathname==="/"?n.pathname=`_root.${r}`:t&&fs(n.pathname,t)==="/"?n.pathname=`${t.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function ZI(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function QI(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function JI(e,t,r){let n=await Promise.all(e.map(async a=>{let i=t.routes[a.route.id];if(i){let l=await ZI(i,r);return l.links?l.links():[]}return[]}));return nL(n.flat(1).filter(QI).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function fA(e,t,r,n,a,i){let l=(h,d)=>r[d]?h.route.id!==r[d].route.id:!0,u=(h,d)=>r[d].pathname!==h.pathname||r[d].route.path?.endsWith("*")&&r[d].params["*"]!==h.params["*"];return i==="assets"?t.filter((h,d)=>l(h,d)||u(h,d)):i==="data"?t.filter((h,d)=>{let m=n.routes[h.route.id];if(!m||!m.hasLoader)return!1;if(l(h,d)||u(h,d))return!0;if(h.route.shouldRevalidate){let p=h.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:r[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:h.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function eL(e,t,{includeHydrateFallback:r}={}){return tL(e.map(n=>{let a=t.routes[n.route.id];if(!a)return[];let i=[a.module];return a.clientActionModule&&(i=i.concat(a.clientActionModule)),a.clientLoaderModule&&(i=i.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(i=i.concat(a.hydrateFallbackModule)),a.imports&&(i=i.concat(a.imports)),i}).flat(1))}function tL(e){return[...new Set(e)]}function rL(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}function nL(e,t){let r=new Set;return new Set(t),e.reduce((n,a)=>{let i=JSON.stringify(rL(a));return r.has(i)||(r.add(i),n.push({key:i,link:a})),n},[])}function vC(){let e=y.useContext(Gc);return Mb(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function aL(){let e=y.useContext(Lm);return Mb(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Fb=y.createContext(void 0);Fb.displayName="FrameworkContext";function gC(){let e=y.useContext(Fb);return Mb(e,"You must render this element inside a <HydratedRouter> element"),e}function iL(e,t){let r=y.useContext(Fb),[n,a]=y.useState(!1),[i,l]=y.useState(!1),{onFocus:u,onBlur:h,onMouseEnter:d,onMouseLeave:m,onTouchStart:p}=t,v=y.useRef(null);y.useEffect(()=>{if(e==="render"&&l(!0),e==="viewport"){let b=j=>{j.forEach(_=>{l(_.isIntersecting)})},S=new IntersectionObserver(b,{threshold:.5});return v.current&&S.observe(v.current),()=>{S.disconnect()}}},[e]),y.useEffect(()=>{if(n){let b=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(b)}}},[n]);let g=()=>{a(!0)},w=()=>{a(!1),l(!1)};return r?e!=="intent"?[i,v,{}]:[i,v,{onFocus:af(u,g),onBlur:af(h,w),onMouseEnter:af(d,g),onMouseLeave:af(m,w),onTouchStart:af(p,g)}]:[!1,v,{}]}function af(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function sL({page:e,...t}){let{router:r}=vC(),n=y.useMemo(()=>oC(r.routes,e,r.basename),[r.routes,e,r.basename]);return n?y.createElement(oL,{page:e,matches:n,...t}):null}function lL(e){let{manifest:t,routeModules:r}=gC(),[n,a]=y.useState([]);return y.useEffect(()=>{let i=!1;return JI(e,t,r).then(l=>{i||a(l)}),()=>{i=!0}},[e,t,r]),n}function oL({page:e,matches:t,...r}){let n=ga(),{manifest:a,routeModules:i}=gC(),{basename:l}=vC(),{loaderData:u,matches:h}=aL(),d=y.useMemo(()=>fA(e,t,h,a,n,"data"),[e,t,h,a,n]),m=y.useMemo(()=>fA(e,t,h,a,n,"assets"),[e,t,h,a,n]),p=y.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let w=new Set,b=!1;if(t.forEach(j=>{let _=a.routes[j.route.id];!_||!_.hasLoader||(!d.some(A=>A.route.id===j.route.id)&&j.route.id in u&&i[j.route.id]?.shouldRevalidate||_.hasClientLoader?b=!0:w.add(j.route.id))}),w.size===0)return[];let S=XI(e,l,"data");return b&&w.size>0&&S.searchParams.set("_routes",t.filter(j=>w.has(j.route.id)).map(j=>j.route.id).join(",")),[S.pathname+S.search]},[l,u,n,a,d,t,e,i]),v=y.useMemo(()=>eL(m,a),[m,a]),g=lL(m);return y.createElement(y.Fragment,null,p.map(w=>y.createElement("link",{key:w,rel:"prefetch",as:"fetch",href:w,...r})),v.map(w=>y.createElement("link",{key:w,rel:"modulepreload",href:w,...r})),g.map(({key:w,link:b})=>y.createElement("link",{key:w,nonce:r.nonce,...b})))}function cL(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var yC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{yC&&(window.__reactRouterVersion="7.9.1")}catch{}function uL({basename:e,children:t,window:r}){let n=y.useRef();n.current==null&&(n.current=WF({window:r,v5Compat:!0}));let a=n.current,[i,l]=y.useState({action:a.action,location:a.location}),u=y.useCallback(h=>{y.startTransition(()=>l(h))},[l]);return y.useLayoutEffect(()=>a.listen(u),[a,u]),y.createElement(BI,{basename:e,children:t,location:i.location,navigationType:i.action,navigator:a})}var bC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Um=y.forwardRef(function({onClick:t,discover:r="render",prefetch:n="none",relative:a,reloadDocument:i,replace:l,state:u,target:h,to:d,preventScrollReset:m,viewTransition:p,...v},g){let{basename:w}=y.useContext(di),b=typeof d=="string"&&bC.test(d),S,j=!1;if(typeof d=="string"&&b&&(S=d,yC))try{let M=new URL(window.location.href),W=d.startsWith("//")?new URL(M.protocol+d):new URL(d),U=fs(W.pathname,w);W.origin===M.origin&&U!=null?d=U+W.search+W.hash:j=!0}catch{za(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let _=wI(d,{relative:a}),[A,k,O]=iL(n,v),C=mL(d,{replace:l,state:u,target:h,preventScrollReset:m,relative:a,viewTransition:p});function T(M){t&&t(M),M.defaultPrevented||C(M)}let I=y.createElement("a",{...v,...O,href:S||_,onClick:j||i?t:T,ref:cL(g,k),target:h,"data-discover":!b&&r==="render"?"true":void 0});return A&&!b?y.createElement(y.Fragment,null,I,y.createElement(sL,{page:_})):I});Um.displayName="Link";var fL=y.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:n="",end:a=!1,style:i,to:l,viewTransition:u,children:h,...d},m){let p=ud(l,{relative:d.relative}),v=ga(),g=y.useContext(Lm),{navigator:w,basename:b}=y.useContext(di),S=g!=null&&yL(p)&&u===!0,j=w.encodeLocation?w.encodeLocation(p).pathname:p.pathname,_=v.pathname,A=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;r||(_=_.toLowerCase(),A=A?A.toLowerCase():null,j=j.toLowerCase()),A&&b&&(A=fs(A,b)||A);const k=j!=="/"&&j.endsWith("/")?j.length-1:j.length;let O=_===j||!a&&_.startsWith(j)&&_.charAt(k)==="/",C=A!=null&&(A===j||!a&&A.startsWith(j)&&A.charAt(j.length)==="/"),T={isActive:O,isPending:C,isTransitioning:S},I=O?t:void 0,M;typeof n=="function"?M=n(T):M=[n,O?"active":null,C?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let W=typeof i=="function"?i(T):i;return y.createElement(Um,{...d,"aria-current":I,className:M,ref:m,style:W,to:l,viewTransition:u},typeof h=="function"?h(T):h)});fL.displayName="NavLink";var dL=y.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:n,replace:a,state:i,method:l=kh,action:u,onSubmit:h,relative:d,preventScrollReset:m,viewTransition:p,...v},g)=>{let w=vL(),b=gL(u,{relative:d}),S=l.toLowerCase()==="get"?"get":"post",j=typeof u=="string"&&bC.test(u),_=A=>{if(h&&h(A),A.defaultPrevented)return;A.preventDefault();let k=A.nativeEvent.submitter,O=k?.getAttribute("formmethod")||l;w(k||A.currentTarget,{fetcherKey:t,method:O,navigate:r,replace:a,state:i,relative:d,preventScrollReset:m,viewTransition:p})};return y.createElement("form",{ref:g,method:S,action:b,onSubmit:n?h:_,...v,"data-discover":!j&&e==="render"?"true":void 0})});dL.displayName="Form";function hL(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function wC(e){let t=y.useContext(Gc);return nr(t,hL(e)),t}function mL(e,{target:t,replace:r,state:n,preventScrollReset:a,relative:i,viewTransition:l}={}){let u=Fi(),h=ga(),d=ud(e,{relative:i});return y.useCallback(m=>{if(VI(m,t)){m.preventDefault();let p=r!==void 0?r:Bf(h)===Bf(d);u(e,{replace:p,state:n,preventScrollReset:a,relative:i,viewTransition:l})}},[h,u,d,r,n,t,e,a,i,l])}function SC(e){za(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=y.useRef(dy(e)),r=y.useRef(!1),n=ga(),a=y.useMemo(()=>KI(n.search,r.current?null:t.current),[n.search]),i=Fi(),l=y.useCallback((u,h)=>{const d=dy(typeof u=="function"?u(new URLSearchParams(a)):u);r.current=!0,i("?"+d,h)},[i,a]);return[a,l]}var pL=0,xL=()=>`__${String(++pL)}__`;function vL(){let{router:e}=wC("useSubmit"),{basename:t}=y.useContext(di),r=MI();return y.useCallback(async(n,a={})=>{let{action:i,method:l,encType:u,formData:h,body:d}=YI(n,t);if(a.navigate===!1){let m=a.fetcherKey||xL();await e.fetch(m,r,a.action||i,{preventScrollReset:a.preventScrollReset,formData:h,body:d,formMethod:a.method||l,formEncType:a.encType||u,flushSync:a.flushSync})}else await e.navigate(a.action||i,{preventScrollReset:a.preventScrollReset,formData:h,body:d,formMethod:a.method||l,formEncType:a.encType||u,replace:a.replace,state:a.state,fromRouteId:r,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,t,r])}function gL(e,{relative:t}={}){let{basename:r}=y.useContext(di),n=y.useContext(Wa);nr(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),i={...ud(e||".",{relative:t})},l=ga();if(e==null){i.search=l.search;let u=new URLSearchParams(i.search),h=u.getAll("index");if(h.some(m=>m==="")){u.delete("index"),h.filter(p=>p).forEach(p=>u.append("index",p));let m=u.toString();i.search=m?`?${m}`:""}}return(!e||e===".")&&a.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(i.pathname=i.pathname==="/"?r:is([r,i.pathname])),Bf(i)}function yL(e,{relative:t}={}){let r=y.useContext(dC);nr(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=wC("useViewTransitionState"),a=ud(e,{relative:t});if(!r.isTransitioning)return!1;let i=fs(r.currentLocation.pathname,n)||r.currentLocation.pathname,l=fs(r.nextLocation.pathname,n)||r.nextLocation.pathname;return Fh(a.pathname,l)!=null||Fh(a.pathname,i)!=null}var Uf=lC();const Ib=Ga(Uf);function EC(e,t){return function(){return e.apply(t,arguments)}}const{toString:bL}=Object.prototype,{getPrototypeOf:Lb}=Object,{iterator:$m,toStringTag:jC}=Symbol,zm=(e=>t=>{const r=bL.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),hi=e=>(e=e.toLowerCase(),t=>zm(t)===e),Hm=e=>t=>typeof t===e,{isArray:Yc}=Array,$f=Hm("undefined");function wL(e){return e!==null&&!$f(e)&&e.constructor!==null&&!$f(e.constructor)&&qn(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const NC=hi("ArrayBuffer");function SL(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&NC(e.buffer),t}const EL=Hm("string"),qn=Hm("function"),AC=Hm("number"),qm=e=>e!==null&&typeof e=="object",jL=e=>e===!0||e===!1,Oh=e=>{if(zm(e)!=="object")return!1;const t=Lb(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(jC in e)&&!($m in e)},NL=hi("Date"),AL=hi("File"),_L=hi("Blob"),TL=hi("FileList"),kL=e=>qm(e)&&qn(e.pipe),CL=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||qn(e.append)&&((t=zm(e))==="formdata"||t==="object"&&qn(e.toString)&&e.toString()==="[object FormData]"))},OL=hi("URLSearchParams"),[DL,PL,RL,ML]=["ReadableStream","Request","Response","Headers"].map(hi),FL=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function fd(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,a;if(typeof e!="object"&&(e=[e]),Yc(e))for(n=0,a=e.length;n<a;n++)t.call(null,e[n],n,e);else{const i=r?Object.getOwnPropertyNames(e):Object.keys(e),l=i.length;let u;for(n=0;n<l;n++)u=i[n],t.call(null,e[u],u,e)}}function _C(e,t){t=t.toLowerCase();const r=Object.keys(e);let n=r.length,a;for(;n-- >0;)if(a=r[n],t===a.toLowerCase())return a;return null}const Jl=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,TC=e=>!$f(e)&&e!==Jl;function hy(){const{caseless:e}=TC(this)&&this||{},t={},r=(n,a)=>{const i=e&&_C(t,a)||a;Oh(t[i])&&Oh(n)?t[i]=hy(t[i],n):Oh(n)?t[i]=hy({},n):Yc(n)?t[i]=n.slice():t[i]=n};for(let n=0,a=arguments.length;n<a;n++)arguments[n]&&fd(arguments[n],r);return t}const IL=(e,t,r,{allOwnKeys:n}={})=>(fd(t,(a,i)=>{r&&qn(a)?e[i]=EC(a,r):e[i]=a},{allOwnKeys:n}),e),LL=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),BL=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},UL=(e,t,r,n)=>{let a,i,l;const u={};if(t=t||{},e==null)return t;do{for(a=Object.getOwnPropertyNames(e),i=a.length;i-- >0;)l=a[i],(!n||n(l,e,t))&&!u[l]&&(t[l]=e[l],u[l]=!0);e=r!==!1&&Lb(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},$L=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},zL=e=>{if(!e)return null;if(Yc(e))return e;let t=e.length;if(!AC(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},HL=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Lb(Uint8Array)),qL=(e,t)=>{const n=(e&&e[$m]).call(e);let a;for(;(a=n.next())&&!a.done;){const i=a.value;t.call(e,i[0],i[1])}},VL=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},KL=hi("HTMLFormElement"),GL=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,a){return n.toUpperCase()+a}),dA=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),WL=hi("RegExp"),kC=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};fd(r,(a,i)=>{let l;(l=t(a,i,e))!==!1&&(n[i]=l||a)}),Object.defineProperties(e,n)},YL=e=>{kC(e,(t,r)=>{if(qn(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(qn(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},XL=(e,t)=>{const r={},n=a=>{a.forEach(i=>{r[i]=!0})};return Yc(e)?n(e):n(String(e).split(t)),r},ZL=()=>{},QL=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function JL(e){return!!(e&&qn(e.append)&&e[jC]==="FormData"&&e[$m])}const e7=e=>{const t=new Array(10),r=(n,a)=>{if(qm(n)){if(t.indexOf(n)>=0)return;if(!("toJSON"in n)){t[a]=n;const i=Yc(n)?[]:{};return fd(n,(l,u)=>{const h=r(l,a+1);!$f(h)&&(i[u]=h)}),t[a]=void 0,i}}return n};return r(e,0)},t7=hi("AsyncFunction"),r7=e=>e&&(qm(e)||qn(e))&&qn(e.then)&&qn(e.catch),CC=((e,t)=>e?setImmediate:t?((r,n)=>(Jl.addEventListener("message",({source:a,data:i})=>{a===Jl&&i===r&&n.length&&n.shift()()},!1),a=>{n.push(a),Jl.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",qn(Jl.postMessage)),n7=typeof queueMicrotask<"u"?queueMicrotask.bind(Jl):typeof process<"u"&&process.nextTick||CC,a7=e=>e!=null&&qn(e[$m]),Pe={isArray:Yc,isArrayBuffer:NC,isBuffer:wL,isFormData:CL,isArrayBufferView:SL,isString:EL,isNumber:AC,isBoolean:jL,isObject:qm,isPlainObject:Oh,isReadableStream:DL,isRequest:PL,isResponse:RL,isHeaders:ML,isUndefined:$f,isDate:NL,isFile:AL,isBlob:_L,isRegExp:WL,isFunction:qn,isStream:kL,isURLSearchParams:OL,isTypedArray:HL,isFileList:TL,forEach:fd,merge:hy,extend:IL,trim:FL,stripBOM:LL,inherits:BL,toFlatObject:UL,kindOf:zm,kindOfTest:hi,endsWith:$L,toArray:zL,forEachEntry:qL,matchAll:VL,isHTMLForm:KL,hasOwnProperty:dA,hasOwnProp:dA,reduceDescriptors:kC,freezeMethods:YL,toObjectSet:XL,toCamelCase:GL,noop:ZL,toFiniteNumber:QL,findKey:_C,global:Jl,isContextDefined:TC,isSpecCompliantForm:JL,toJSONObject:e7,isAsyncFn:t7,isThenable:r7,setImmediate:CC,asap:n7,isIterable:a7};function ht(e,t,r,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}Pe.inherits(ht,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Pe.toJSONObject(this.config),code:this.code,status:this.status}}});const OC=ht.prototype,DC={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{DC[e]={value:e}});Object.defineProperties(ht,DC);Object.defineProperty(OC,"isAxiosError",{value:!0});ht.from=(e,t,r,n,a,i)=>{const l=Object.create(OC);return Pe.toFlatObject(e,l,function(h){return h!==Error.prototype},u=>u!=="isAxiosError"),ht.call(l,e.message,t,r,n,a),l.cause=e,l.name=e.name,i&&Object.assign(l,i),l};const i7=null;function my(e){return Pe.isPlainObject(e)||Pe.isArray(e)}function PC(e){return Pe.endsWith(e,"[]")?e.slice(0,-2):e}function hA(e,t,r){return e?e.concat(t).map(function(a,i){return a=PC(a),!r&&i?"["+a+"]":a}).join(r?".":""):t}function s7(e){return Pe.isArray(e)&&!e.some(my)}const l7=Pe.toFlatObject(Pe,{},null,function(t){return/^is[A-Z]/.test(t)});function Vm(e,t,r){if(!Pe.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=Pe.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(b,S){return!Pe.isUndefined(S[b])});const n=r.metaTokens,a=r.visitor||m,i=r.dots,l=r.indexes,h=(r.Blob||typeof Blob<"u"&&Blob)&&Pe.isSpecCompliantForm(t);if(!Pe.isFunction(a))throw new TypeError("visitor must be a function");function d(w){if(w===null)return"";if(Pe.isDate(w))return w.toISOString();if(Pe.isBoolean(w))return w.toString();if(!h&&Pe.isBlob(w))throw new ht("Blob is not supported. Use a Buffer instead.");return Pe.isArrayBuffer(w)||Pe.isTypedArray(w)?h&&typeof Blob=="function"?new Blob([w]):Buffer.from(w):w}function m(w,b,S){let j=w;if(w&&!S&&typeof w=="object"){if(Pe.endsWith(b,"{}"))b=n?b:b.slice(0,-2),w=JSON.stringify(w);else if(Pe.isArray(w)&&s7(w)||(Pe.isFileList(w)||Pe.endsWith(b,"[]"))&&(j=Pe.toArray(w)))return b=PC(b),j.forEach(function(A,k){!(Pe.isUndefined(A)||A===null)&&t.append(l===!0?hA([b],k,i):l===null?b:b+"[]",d(A))}),!1}return my(w)?!0:(t.append(hA(S,b,i),d(w)),!1)}const p=[],v=Object.assign(l7,{defaultVisitor:m,convertValue:d,isVisitable:my});function g(w,b){if(!Pe.isUndefined(w)){if(p.indexOf(w)!==-1)throw Error("Circular reference detected in "+b.join("."));p.push(w),Pe.forEach(w,function(j,_){(!(Pe.isUndefined(j)||j===null)&&a.call(t,j,Pe.isString(_)?_.trim():_,b,v))===!0&&g(j,b?b.concat(_):[_])}),p.pop()}}if(!Pe.isObject(e))throw new TypeError("data must be an object");return g(e),t}function mA(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function Bb(e,t){this._pairs=[],e&&Vm(e,this,t)}const RC=Bb.prototype;RC.append=function(t,r){this._pairs.push([t,r])};RC.toString=function(t){const r=t?function(n){return t.call(this,n,mA)}:mA;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function o7(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function MC(e,t,r){if(!t)return e;const n=r&&r.encode||o7;Pe.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let i;if(a?i=a(t,r):i=Pe.isURLSearchParams(t)?t.toString():new Bb(t,r).toString(n),i){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class pA{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Pe.forEach(this.handlers,function(n){n!==null&&t(n)})}}const FC={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},c7=typeof URLSearchParams<"u"?URLSearchParams:Bb,u7=typeof FormData<"u"?FormData:null,f7=typeof Blob<"u"?Blob:null,d7={isBrowser:!0,classes:{URLSearchParams:c7,FormData:u7,Blob:f7},protocols:["http","https","file","blob","url","data"]},Ub=typeof window<"u"&&typeof document<"u",py=typeof navigator=="object"&&navigator||void 0,h7=Ub&&(!py||["ReactNative","NativeScript","NS"].indexOf(py.product)<0),m7=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",p7=Ub&&window.location.href||"http://localhost",x7=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Ub,hasStandardBrowserEnv:h7,hasStandardBrowserWebWorkerEnv:m7,navigator:py,origin:p7},Symbol.toStringTag,{value:"Module"})),xn={...x7,...d7};function v7(e,t){return Vm(e,new xn.classes.URLSearchParams,Object.assign({visitor:function(r,n,a,i){return xn.isNode&&Pe.isBuffer(r)?(this.append(n,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},t))}function g7(e){return Pe.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function y7(e){const t={},r=Object.keys(e);let n;const a=r.length;let i;for(n=0;n<a;n++)i=r[n],t[i]=e[i];return t}function IC(e){function t(r,n,a,i){let l=r[i++];if(l==="__proto__")return!0;const u=Number.isFinite(+l),h=i>=r.length;return l=!l&&Pe.isArray(a)?a.length:l,h?(Pe.hasOwnProp(a,l)?a[l]=[a[l],n]:a[l]=n,!u):((!a[l]||!Pe.isObject(a[l]))&&(a[l]=[]),t(r,n,a[l],i)&&Pe.isArray(a[l])&&(a[l]=y7(a[l])),!u)}if(Pe.isFormData(e)&&Pe.isFunction(e.entries)){const r={};return Pe.forEachEntry(e,(n,a)=>{t(g7(n),a,r,0)}),r}return null}function b7(e,t,r){if(Pe.isString(e))try{return(t||JSON.parse)(e),Pe.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const dd={transitional:FC,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",a=n.indexOf("application/json")>-1,i=Pe.isObject(t);if(i&&Pe.isHTMLForm(t)&&(t=new FormData(t)),Pe.isFormData(t))return a?JSON.stringify(IC(t)):t;if(Pe.isArrayBuffer(t)||Pe.isBuffer(t)||Pe.isStream(t)||Pe.isFile(t)||Pe.isBlob(t)||Pe.isReadableStream(t))return t;if(Pe.isArrayBufferView(t))return t.buffer;if(Pe.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return v7(t,this.formSerializer).toString();if((u=Pe.isFileList(t))||n.indexOf("multipart/form-data")>-1){const h=this.env&&this.env.FormData;return Vm(u?{"files[]":t}:t,h&&new h,this.formSerializer)}}return i||a?(r.setContentType("application/json",!1),b7(t)):t}],transformResponse:[function(t){const r=this.transitional||dd.transitional,n=r&&r.forcedJSONParsing,a=this.responseType==="json";if(Pe.isResponse(t)||Pe.isReadableStream(t))return t;if(t&&Pe.isString(t)&&(n&&!this.responseType||a)){const l=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(t)}catch(u){if(l)throw u.name==="SyntaxError"?ht.from(u,ht.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:xn.classes.FormData,Blob:xn.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Pe.forEach(["delete","get","head","post","put","patch"],e=>{dd.headers[e]={}});const w7=Pe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),S7=e=>{const t={};let r,n,a;return e&&e.split(`
`).forEach(function(l){a=l.indexOf(":"),r=l.substring(0,a).trim().toLowerCase(),n=l.substring(a+1).trim(),!(!r||t[r]&&w7[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},xA=Symbol("internals");function sf(e){return e&&String(e).trim().toLowerCase()}function Dh(e){return e===!1||e==null?e:Pe.isArray(e)?e.map(Dh):String(e)}function E7(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const j7=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function ag(e,t,r,n,a){if(Pe.isFunction(n))return n.call(this,t,r);if(a&&(t=r),!!Pe.isString(t)){if(Pe.isString(n))return t.indexOf(n)!==-1;if(Pe.isRegExp(n))return n.test(t)}}function N7(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function A7(e,t){const r=Pe.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(a,i,l){return this[n].call(this,t,a,i,l)},configurable:!0})})}let Vn=class{constructor(t){t&&this.set(t)}set(t,r,n){const a=this;function i(u,h,d){const m=sf(h);if(!m)throw new Error("header name must be a non-empty string");const p=Pe.findKey(a,m);(!p||a[p]===void 0||d===!0||d===void 0&&a[p]!==!1)&&(a[p||h]=Dh(u))}const l=(u,h)=>Pe.forEach(u,(d,m)=>i(d,m,h));if(Pe.isPlainObject(t)||t instanceof this.constructor)l(t,r);else if(Pe.isString(t)&&(t=t.trim())&&!j7(t))l(S7(t),r);else if(Pe.isObject(t)&&Pe.isIterable(t)){let u={},h,d;for(const m of t){if(!Pe.isArray(m))throw TypeError("Object iterator must return a key-value pair");u[d=m[0]]=(h=u[d])?Pe.isArray(h)?[...h,m[1]]:[h,m[1]]:m[1]}l(u,r)}else t!=null&&i(r,t,n);return this}get(t,r){if(t=sf(t),t){const n=Pe.findKey(this,t);if(n){const a=this[n];if(!r)return a;if(r===!0)return E7(a);if(Pe.isFunction(r))return r.call(this,a,n);if(Pe.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=sf(t),t){const n=Pe.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||ag(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let a=!1;function i(l){if(l=sf(l),l){const u=Pe.findKey(n,l);u&&(!r||ag(n,n[u],u,r))&&(delete n[u],a=!0)}}return Pe.isArray(t)?t.forEach(i):i(t),a}clear(t){const r=Object.keys(this);let n=r.length,a=!1;for(;n--;){const i=r[n];(!t||ag(this,this[i],i,t,!0))&&(delete this[i],a=!0)}return a}normalize(t){const r=this,n={};return Pe.forEach(this,(a,i)=>{const l=Pe.findKey(n,i);if(l){r[l]=Dh(a),delete r[i];return}const u=t?N7(i):String(i).trim();u!==i&&delete r[i],r[u]=Dh(a),n[u]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return Pe.forEach(this,(n,a)=>{n!=null&&n!==!1&&(r[a]=t&&Pe.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(a=>n.set(a)),n}static accessor(t){const n=(this[xA]=this[xA]={accessors:{}}).accessors,a=this.prototype;function i(l){const u=sf(l);n[u]||(A7(a,l),n[u]=!0)}return Pe.isArray(t)?t.forEach(i):i(t),this}};Vn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Pe.reduceDescriptors(Vn.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});Pe.freezeMethods(Vn);function ig(e,t){const r=this||dd,n=t||r,a=Vn.from(n.headers);let i=n.data;return Pe.forEach(e,function(u){i=u.call(r,i,a.normalize(),t?t.status:void 0)}),a.normalize(),i}function LC(e){return!!(e&&e.__CANCEL__)}function Xc(e,t,r){ht.call(this,e??"canceled",ht.ERR_CANCELED,t,r),this.name="CanceledError"}Pe.inherits(Xc,ht,{__CANCEL__:!0});function BC(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new ht("Request failed with status code "+r.status,[ht.ERR_BAD_REQUEST,ht.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function _7(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function T7(e,t){e=e||10;const r=new Array(e),n=new Array(e);let a=0,i=0,l;return t=t!==void 0?t:1e3,function(h){const d=Date.now(),m=n[i];l||(l=d),r[a]=h,n[a]=d;let p=i,v=0;for(;p!==a;)v+=r[p++],p=p%e;if(a=(a+1)%e,a===i&&(i=(i+1)%e),d-l<t)return;const g=m&&d-m;return g?Math.round(v*1e3/g):void 0}}function k7(e,t){let r=0,n=1e3/t,a,i;const l=(d,m=Date.now())=>{r=m,a=null,i&&(clearTimeout(i),i=null),e.apply(null,d)};return[(...d)=>{const m=Date.now(),p=m-r;p>=n?l(d,m):(a=d,i||(i=setTimeout(()=>{i=null,l(a)},n-p)))},()=>a&&l(a)]}const Ih=(e,t,r=3)=>{let n=0;const a=T7(50,250);return k7(i=>{const l=i.loaded,u=i.lengthComputable?i.total:void 0,h=l-n,d=a(h),m=l<=u;n=l;const p={loaded:l,total:u,progress:u?l/u:void 0,bytes:h,rate:d||void 0,estimated:d&&u&&m?(u-l)/d:void 0,event:i,lengthComputable:u!=null,[t?"download":"upload"]:!0};e(p)},r)},vA=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},gA=e=>(...t)=>Pe.asap(()=>e(...t)),C7=xn.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,xn.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(xn.origin),xn.navigator&&/(msie|trident)/i.test(xn.navigator.userAgent)):()=>!0,O7=xn.hasStandardBrowserEnv?{write(e,t,r,n,a,i){const l=[e+"="+encodeURIComponent(t)];Pe.isNumber(r)&&l.push("expires="+new Date(r).toGMTString()),Pe.isString(n)&&l.push("path="+n),Pe.isString(a)&&l.push("domain="+a),i===!0&&l.push("secure"),document.cookie=l.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function D7(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function P7(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function UC(e,t,r){let n=!D7(t);return e&&(n||r==!1)?P7(e,t):t}const yA=e=>e instanceof Vn?{...e}:e;function mo(e,t){t=t||{};const r={};function n(d,m,p,v){return Pe.isPlainObject(d)&&Pe.isPlainObject(m)?Pe.merge.call({caseless:v},d,m):Pe.isPlainObject(m)?Pe.merge({},m):Pe.isArray(m)?m.slice():m}function a(d,m,p,v){if(Pe.isUndefined(m)){if(!Pe.isUndefined(d))return n(void 0,d,p,v)}else return n(d,m,p,v)}function i(d,m){if(!Pe.isUndefined(m))return n(void 0,m)}function l(d,m){if(Pe.isUndefined(m)){if(!Pe.isUndefined(d))return n(void 0,d)}else return n(void 0,m)}function u(d,m,p){if(p in t)return n(d,m);if(p in e)return n(void 0,d)}const h={url:i,method:i,data:i,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:u,headers:(d,m,p)=>a(yA(d),yA(m),p,!0)};return Pe.forEach(Object.keys(Object.assign({},e,t)),function(m){const p=h[m]||a,v=p(e[m],t[m],m);Pe.isUndefined(v)&&p!==u||(r[m]=v)}),r}const $C=e=>{const t=mo({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:i,headers:l,auth:u}=t;t.headers=l=Vn.from(l),t.url=MC(UC(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),u&&l.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):"")));let h;if(Pe.isFormData(r)){if(xn.hasStandardBrowserEnv||xn.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if((h=l.getContentType())!==!1){const[d,...m]=h?h.split(";").map(p=>p.trim()).filter(Boolean):[];l.setContentType([d||"multipart/form-data",...m].join("; "))}}if(xn.hasStandardBrowserEnv&&(n&&Pe.isFunction(n)&&(n=n(t)),n||n!==!1&&C7(t.url))){const d=a&&i&&O7.read(i);d&&l.set(a,d)}return t},R7=typeof XMLHttpRequest<"u",M7=R7&&function(e){return new Promise(function(r,n){const a=$C(e);let i=a.data;const l=Vn.from(a.headers).normalize();let{responseType:u,onUploadProgress:h,onDownloadProgress:d}=a,m,p,v,g,w;function b(){g&&g(),w&&w(),a.cancelToken&&a.cancelToken.unsubscribe(m),a.signal&&a.signal.removeEventListener("abort",m)}let S=new XMLHttpRequest;S.open(a.method.toUpperCase(),a.url,!0),S.timeout=a.timeout;function j(){if(!S)return;const A=Vn.from("getAllResponseHeaders"in S&&S.getAllResponseHeaders()),O={data:!u||u==="text"||u==="json"?S.responseText:S.response,status:S.status,statusText:S.statusText,headers:A,config:e,request:S};BC(function(T){r(T),b()},function(T){n(T),b()},O),S=null}"onloadend"in S?S.onloadend=j:S.onreadystatechange=function(){!S||S.readyState!==4||S.status===0&&!(S.responseURL&&S.responseURL.indexOf("file:")===0)||setTimeout(j)},S.onabort=function(){S&&(n(new ht("Request aborted",ht.ECONNABORTED,e,S)),S=null)},S.onerror=function(){n(new ht("Network Error",ht.ERR_NETWORK,e,S)),S=null},S.ontimeout=function(){let k=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const O=a.transitional||FC;a.timeoutErrorMessage&&(k=a.timeoutErrorMessage),n(new ht(k,O.clarifyTimeoutError?ht.ETIMEDOUT:ht.ECONNABORTED,e,S)),S=null},i===void 0&&l.setContentType(null),"setRequestHeader"in S&&Pe.forEach(l.toJSON(),function(k,O){S.setRequestHeader(O,k)}),Pe.isUndefined(a.withCredentials)||(S.withCredentials=!!a.withCredentials),u&&u!=="json"&&(S.responseType=a.responseType),d&&([v,w]=Ih(d,!0),S.addEventListener("progress",v)),h&&S.upload&&([p,g]=Ih(h),S.upload.addEventListener("progress",p),S.upload.addEventListener("loadend",g)),(a.cancelToken||a.signal)&&(m=A=>{S&&(n(!A||A.type?new Xc(null,e,S):A),S.abort(),S=null)},a.cancelToken&&a.cancelToken.subscribe(m),a.signal&&(a.signal.aborted?m():a.signal.addEventListener("abort",m)));const _=_7(a.url);if(_&&xn.protocols.indexOf(_)===-1){n(new ht("Unsupported protocol "+_+":",ht.ERR_BAD_REQUEST,e));return}S.send(i||null)})},F7=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,a;const i=function(d){if(!a){a=!0,u();const m=d instanceof Error?d:this.reason;n.abort(m instanceof ht?m:new Xc(m instanceof Error?m.message:m))}};let l=t&&setTimeout(()=>{l=null,i(new ht(`timeout ${t} of ms exceeded`,ht.ETIMEDOUT))},t);const u=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(d=>{d.unsubscribe?d.unsubscribe(i):d.removeEventListener("abort",i)}),e=null)};e.forEach(d=>d.addEventListener("abort",i));const{signal:h}=n;return h.unsubscribe=()=>Pe.asap(u),h}},I7=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,a;for(;n<r;)a=n+t,yield e.slice(n,a),n=a},L7=async function*(e,t){for await(const r of B7(e))yield*I7(r,t)},B7=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},bA=(e,t,r,n)=>{const a=L7(e,t);let i=0,l,u=h=>{l||(l=!0,n&&n(h))};return new ReadableStream({async pull(h){try{const{done:d,value:m}=await a.next();if(d){u(),h.close();return}let p=m.byteLength;if(r){let v=i+=p;r(v)}h.enqueue(new Uint8Array(m))}catch(d){throw u(d),d}},cancel(h){return u(h),a.return()}},{highWaterMark:2})},Km=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",zC=Km&&typeof ReadableStream=="function",U7=Km&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),HC=(e,...t)=>{try{return!!e(...t)}catch{return!1}},$7=zC&&HC(()=>{let e=!1;const t=new Request(xn.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),wA=64*1024,xy=zC&&HC(()=>Pe.isReadableStream(new Response("").body)),Lh={stream:xy&&(e=>e.body)};Km&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!Lh[t]&&(Lh[t]=Pe.isFunction(e[t])?r=>r[t]():(r,n)=>{throw new ht(`Response type '${t}' is not supported`,ht.ERR_NOT_SUPPORT,n)})})})(new Response);const z7=async e=>{if(e==null)return 0;if(Pe.isBlob(e))return e.size;if(Pe.isSpecCompliantForm(e))return(await new Request(xn.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(Pe.isArrayBufferView(e)||Pe.isArrayBuffer(e))return e.byteLength;if(Pe.isURLSearchParams(e)&&(e=e+""),Pe.isString(e))return(await U7(e)).byteLength},H7=async(e,t)=>{const r=Pe.toFiniteNumber(e.getContentLength());return r??z7(t)},q7=Km&&(async e=>{let{url:t,method:r,data:n,signal:a,cancelToken:i,timeout:l,onDownloadProgress:u,onUploadProgress:h,responseType:d,headers:m,withCredentials:p="same-origin",fetchOptions:v}=$C(e);d=d?(d+"").toLowerCase():"text";let g=F7([a,i&&i.toAbortSignal()],l),w;const b=g&&g.unsubscribe&&(()=>{g.unsubscribe()});let S;try{if(h&&$7&&r!=="get"&&r!=="head"&&(S=await H7(m,n))!==0){let O=new Request(t,{method:"POST",body:n,duplex:"half"}),C;if(Pe.isFormData(n)&&(C=O.headers.get("content-type"))&&m.setContentType(C),O.body){const[T,I]=vA(S,Ih(gA(h)));n=bA(O.body,wA,T,I)}}Pe.isString(p)||(p=p?"include":"omit");const j="credentials"in Request.prototype;w=new Request(t,{...v,signal:g,method:r.toUpperCase(),headers:m.normalize().toJSON(),body:n,duplex:"half",credentials:j?p:void 0});let _=await fetch(w,v);const A=xy&&(d==="stream"||d==="response");if(xy&&(u||A&&b)){const O={};["status","statusText","headers"].forEach(M=>{O[M]=_[M]});const C=Pe.toFiniteNumber(_.headers.get("content-length")),[T,I]=u&&vA(C,Ih(gA(u),!0))||[];_=new Response(bA(_.body,wA,T,()=>{I&&I(),b&&b()}),O)}d=d||"text";let k=await Lh[Pe.findKey(Lh,d)||"text"](_,e);return!A&&b&&b(),await new Promise((O,C)=>{BC(O,C,{data:k,headers:Vn.from(_.headers),status:_.status,statusText:_.statusText,config:e,request:w})})}catch(j){throw b&&b(),j&&j.name==="TypeError"&&/Load failed|fetch/i.test(j.message)?Object.assign(new ht("Network Error",ht.ERR_NETWORK,e,w),{cause:j.cause||j}):ht.from(j,j&&j.code,e,w)}}),vy={http:i7,xhr:M7,fetch:q7};Pe.forEach(vy,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const SA=e=>`- ${e}`,V7=e=>Pe.isFunction(e)||e===null||e===!1,qC={getAdapter:e=>{e=Pe.isArray(e)?e:[e];const{length:t}=e;let r,n;const a={};for(let i=0;i<t;i++){r=e[i];let l;if(n=r,!V7(r)&&(n=vy[(l=String(r)).toLowerCase()],n===void 0))throw new ht(`Unknown adapter '${l}'`);if(n)break;a[l||"#"+i]=n}if(!n){const i=Object.entries(a).map(([u,h])=>`adapter ${u} `+(h===!1?"is not supported by the environment":"is not available in the build"));let l=t?i.length>1?`since :
`+i.map(SA).join(`
`):" "+SA(i[0]):"as no adapter specified";throw new ht("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return n},adapters:vy};function sg(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Xc(null,e)}function EA(e){return sg(e),e.headers=Vn.from(e.headers),e.data=ig.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),qC.getAdapter(e.adapter||dd.adapter)(e).then(function(n){return sg(e),n.data=ig.call(e,e.transformResponse,n),n.headers=Vn.from(n.headers),n},function(n){return LC(n)||(sg(e),n&&n.response&&(n.response.data=ig.call(e,e.transformResponse,n.response),n.response.headers=Vn.from(n.response.headers))),Promise.reject(n)})}const VC="1.10.0",Gm={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Gm[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const jA={};Gm.transitional=function(t,r,n){function a(i,l){return"[Axios v"+VC+"] Transitional option '"+i+"'"+l+(n?". "+n:"")}return(i,l,u)=>{if(t===!1)throw new ht(a(l," has been removed"+(r?" in "+r:"")),ht.ERR_DEPRECATED);return r&&!jA[l]&&(jA[l]=!0,console.warn(a(l," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(i,l,u):!0}};Gm.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function K7(e,t,r){if(typeof e!="object")throw new ht("options must be an object",ht.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let a=n.length;for(;a-- >0;){const i=n[a],l=t[i];if(l){const u=e[i],h=u===void 0||l(u,i,e);if(h!==!0)throw new ht("option "+i+" must be "+h,ht.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new ht("Unknown option "+i,ht.ERR_BAD_OPTION)}}const Ph={assertOptions:K7,validators:Gm},Ei=Ph.validators;let so=class{constructor(t){this.defaults=t||{},this.interceptors={request:new pA,response:new pA}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const i=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?i&&!String(n.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+i):n.stack=i}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=mo(this.defaults,r);const{transitional:n,paramsSerializer:a,headers:i}=r;n!==void 0&&Ph.assertOptions(n,{silentJSONParsing:Ei.transitional(Ei.boolean),forcedJSONParsing:Ei.transitional(Ei.boolean),clarifyTimeoutError:Ei.transitional(Ei.boolean)},!1),a!=null&&(Pe.isFunction(a)?r.paramsSerializer={serialize:a}:Ph.assertOptions(a,{encode:Ei.function,serialize:Ei.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Ph.assertOptions(r,{baseUrl:Ei.spelling("baseURL"),withXsrfToken:Ei.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let l=i&&Pe.merge(i.common,i[r.method]);i&&Pe.forEach(["delete","get","head","post","put","patch","common"],w=>{delete i[w]}),r.headers=Vn.concat(l,i);const u=[];let h=!0;this.interceptors.request.forEach(function(b){typeof b.runWhen=="function"&&b.runWhen(r)===!1||(h=h&&b.synchronous,u.unshift(b.fulfilled,b.rejected))});const d=[];this.interceptors.response.forEach(function(b){d.push(b.fulfilled,b.rejected)});let m,p=0,v;if(!h){const w=[EA.bind(this),void 0];for(w.unshift.apply(w,u),w.push.apply(w,d),v=w.length,m=Promise.resolve(r);p<v;)m=m.then(w[p++],w[p++]);return m}v=u.length;let g=r;for(p=0;p<v;){const w=u[p++],b=u[p++];try{g=w(g)}catch(S){b.call(this,S);break}}try{m=EA.call(this,g)}catch(w){return Promise.reject(w)}for(p=0,v=d.length;p<v;)m=m.then(d[p++],d[p++]);return m}getUri(t){t=mo(this.defaults,t);const r=UC(t.baseURL,t.url,t.allowAbsoluteUrls);return MC(r,t.params,t.paramsSerializer)}};Pe.forEach(["delete","get","head","options"],function(t){so.prototype[t]=function(r,n){return this.request(mo(n||{},{method:t,url:r,data:(n||{}).data}))}});Pe.forEach(["post","put","patch"],function(t){function r(n){return function(i,l,u){return this.request(mo(u||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:i,data:l}))}}so.prototype[t]=r(),so.prototype[t+"Form"]=r(!0)});let G7=class KC{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const n=this;this.promise.then(a=>{if(!n._listeners)return;let i=n._listeners.length;for(;i-- >0;)n._listeners[i](a);n._listeners=null}),this.promise.then=a=>{let i;const l=new Promise(u=>{n.subscribe(u),i=u}).then(a);return l.cancel=function(){n.unsubscribe(i)},l},t(function(i,l,u){n.reason||(n.reason=new Xc(i,l,u),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new KC(function(a){t=a}),cancel:t}}};function W7(e){return function(r){return e.apply(null,r)}}function Y7(e){return Pe.isObject(e)&&e.isAxiosError===!0}const gy={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(gy).forEach(([e,t])=>{gy[t]=e});function GC(e){const t=new so(e),r=EC(so.prototype.request,t);return Pe.extend(r,so.prototype,t,{allOwnKeys:!0}),Pe.extend(r,t,null,{allOwnKeys:!0}),r.create=function(a){return GC(mo(e,a))},r}const dr=GC(dd);dr.Axios=so;dr.CanceledError=Xc;dr.CancelToken=G7;dr.isCancel=LC;dr.VERSION=VC;dr.toFormData=Vm;dr.AxiosError=ht;dr.Cancel=dr.CanceledError;dr.all=function(t){return Promise.all(t)};dr.spread=W7;dr.isAxiosError=Y7;dr.mergeConfig=mo;dr.AxiosHeaders=Vn;dr.formToJSON=e=>IC(Pe.isHTMLForm(e)?new FormData(e):e);dr.getAdapter=qC.getAdapter;dr.HttpStatusCode=gy;dr.default=dr;const{Axios:q0e,AxiosError:V0e,CanceledError:K0e,isCancel:G0e,CancelToken:W0e,VERSION:Y0e,all:X0e,Cancel:Z0e,isAxiosError:Q0e,spread:J0e,toFormData:ehe,AxiosHeaders:the,HttpStatusCode:rhe,formToJSON:nhe,getAdapter:ahe,mergeConfig:ihe}=dr,X7=window.location.origin,We=dr.create({baseURL:X7,withCredentials:!0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",headers:{"X-Requested-With":"XMLHttpRequest"}});function WC(){const e=document.cookie.match(/(?:^|;\s*)XSRF-TOKEN=([^;]+)/);return e?decodeURIComponent(e[1]):""}We.interceptors.request.use(e=>{const t=(e.method||"get").toUpperCase();if(!["GET","HEAD","OPTIONS","TRACE"].includes(t)){const r=WC();r&&(e.headers["X-XSRF-TOKEN"]=r,e.headers["X-CSRFToken"]=r,e.headers["X-CSRF-Token"]=r)}return e});async function Z7(e,t,r={}){const n=new FormData;Object.entries(r).forEach(([l,u])=>n.append(l,u)),n.append("file",t);const a=WC(),i={};return a&&(i["X-XSRF-TOKEN"]=a,i["X-CSRFToken"]=a,i["X-CSRF-Token"]=a),We.post(e,n,{headers:i})}const mi=y.createContext({user:void 0,setUser:()=>{},logout:async()=>{}});function Q7({children:e}){const[t,r]=y.useState(void 0);y.useEffect(()=>{let i=!1;return(async()=>{try{const{data:l}=await We.get("/auth/me");if(!i)if(l?.ok&&l?.user){const u=l.user;r({id:u.id,email:u.email,user_type:(u.user_type||"").toLowerCase(),name:u.name||[u.first_name,u.last_name].filter(Boolean).join(" ")||null,permission:u.permission||null})}else r(null)}catch{i||r(null)}})(),()=>{i=!0}},[]);const n=async()=>{try{await We.post("/auth/logout")}catch{}r(null)},a=y.useMemo(()=>({user:t,setUser:r,logout:n}),[t]);return c.jsx(mi.Provider,{value:a,children:e})}function J7(){const e=Fi(),{setUser:t}=y.useContext(mi),[r,n]=y.useState(""),[a,i]=y.useState(""),[l,u]=y.useState(""),[h,d]=y.useState(!1),m=async v=>{v.preventDefault(),u(""),d(!0);try{const w=(await We.post("/auth/login",{email:r,username:r,password:a}))?.data||{};if(!w.ok)throw new Error(w.error||"Invalid email/username or password");await p()}catch(g){console.error("Login error:",g),u(g.message||"Login failed")}finally{d(!1)}},p=async()=>{try{const g=(await We.get("/auth/me"))?.data||{};if(!g.user)throw console.error("Unexpected /auth/me payload:",g),new Error("Unable to load your profile after login.");const w=g.user,b={id:w.id,email:w.email,user_type:(w.user_type||"").toLowerCase(),full_name:w.name||[w.first_name,w.last_name].filter(Boolean).join(" ")||null,permission:w.permission||null};t(b);const S=b.user_type;if(S==="admin")e("/admin-dashboard");else if(S==="groupadmin"||S==="investor")e("/investor-dashboard");else throw new Error("Unauthorized user role.")}catch(v){throw console.error("getMe() failed after login:",v),new Error("Unable to load your profile after login.")}};return c.jsx("div",{className:"min-h-screen grid place-items-center bg-emerald-500/90 p-6",children:c.jsxs("form",{onSubmit:m,className:"w-full max-w-md rounded-2xl bg-white p-8 shadow-xl space-y-4",children:[c.jsx("h1",{className:"text-2xl font-semibold text-center",children:"Login"}),l&&c.jsx("div",{className:"rounded-lg bg-amber-50 border border-amber-200 text-amber-800 px-4 py-3 text-sm",children:l}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Email or Username"}),c.jsx("input",{className:"mt-1 w-full rounded-lg border border-gray-200 px-4 py-2.5 outline-none focus:ring-4 focus:ring-emerald-100",value:r,onChange:v=>n(v.value||v.target.value),autoComplete:"username",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Password"}),c.jsx("input",{type:"password",className:"mt-1 w-full rounded-lg border border-gray-200 px-4 py-2.5 outline-none focus:ring-4 focus:ring-emerald-100",value:a,onChange:v=>i(v.value||v.target.value),autoComplete:"current-password",required:!0})]}),c.jsx("button",{type:"submit",disabled:h,className:"w-full rounded-lg bg-emerald-600 text-white py-3 font-semibold hover:brightness-110 active:scale-[0.99] disabled:opacity-60 disabled:cursor-not-allowed",children:h?"Signing in":"LOGIN"}),c.jsx("div",{className:"pt-1 text-center",children:c.jsx(Um,{to:"/forgot-password",className:"inline-block text-sm text-emerald-700 hover:underline",children:"Forgot password?"})})]})})}/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eB=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),tB=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),NA=e=>{const t=tB(e);return t.charAt(0).toUpperCase()+t.slice(1)},YC=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim(),rB=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var nB={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aB=y.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:i,iconNode:l,...u},h)=>y.createElement("svg",{ref:h,...nB,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:YC("lucide",a),...!i&&!rB(u)&&{"aria-hidden":"true"},...u},[...l.map(([d,m])=>y.createElement(d,m)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ar=(e,t)=>{const r=y.forwardRef(({className:n,...a},i)=>y.createElement(aB,{ref:i,iconNode:t,className:YC(`lucide-${eB(NA(e))}`,`lucide-${e}`,n),...a}));return r.displayName=NA(e),r};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iB=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],XC=ar("archive",iB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sB=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],ZC=ar("arrow-left",sB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lB=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],oB=ar("bell",lB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cB=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],QC=ar("briefcase",cB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uB=[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]],$b=ar("chart-no-axes-column",uB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fB=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Z0=ar("check",fB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dB=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],hB=ar("circle-check",dB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mB=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],AA=ar("cloud-upload",mB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pB=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],xB=ar("file-spreadsheet",pB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vB=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],jf=ar("file-text",vB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gB=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],yB=ar("file",gB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bB=[["path",{d:"M20 7h-3a2 2 0 0 1-2-2V2",key:"x099mo"}],["path",{d:"M9 18a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h7l4 4v10a2 2 0 0 1-2 2Z",key:"18t6ie"}],["path",{d:"M3 7.6v12.8A1.6 1.6 0 0 0 4.6 22h9.8",key:"1nja0z"}]],wB=ar("files",bB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SB=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],_A=ar("house",SB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EB=[["path",{d:"M10 8h.01",key:"1r9ogq"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M14 8h.01",key:"1primd"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M18 8h.01",key:"emo2bl"}],["path",{d:"M6 8h.01",key:"x9i8wu"}],["path",{d:"M7 16h10",key:"wp8him"}],["path",{d:"M8 12h.01",key:"czm47f"}],["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}]],jB=ar("keyboard",EB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NB=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],JC=ar("loader-circle",NB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AB=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Wm=ar("log-out",AB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _B=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],lg=ar("mail",_B);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TB=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],kB=ar("pen",TB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CB=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],OB=ar("plus",CB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DB=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],PB=ar("shield",DB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RB=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],eO=ar("trash-2",RB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MB=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],tO=ar("user-plus",MB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FB=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Nf=ar("users",FB);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IB=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],wc=ar("x",IB),Q0="/api/settings",TA="/api/admin/users";function LB(e){return document.cookie.split("; ").find(t=>t.startsWith(e+"="))?.split("=")[1]||""}async function mc(e,t={}){const r=new Headers(t.headers||{});if(t.method&&t.method!=="GET"||t.forceXsrf){const a=LB("XSRF-TOKEN");a&&r.set("X-XSRF-TOKEN",a)}return await fetch(e,{...t,headers:r,credentials:"include"})}function BB(){const[e,t]=y.useState(!1),[r,n]=y.useState(null),[a,i]=y.useState(null),[l,u]=y.useState(""),[h,d]=y.useState([]),[m,p]=y.useState(!0),[v,g]=y.useState(1),[w,b]=y.useState(25),[S,j]=y.useState(0),[_,A]=y.useState(""),[k,O]=y.useState(""),[C,T]=y.useState(""),[I,M]=y.useState(""),[W,U]=y.useState(1),[F,oe]=y.useState(25),[je,ue]=y.useState(0),[V,H]=y.useState([]),[Se,Q]=y.useState(null),z=Math.max(1,Math.ceil(je/Math.max(1,F))),Y=async()=>{t(!0),u("");try{const be=await(await mc(`${Q0}/logo`,{method:"GET",forceXsrf:!1})).json();n(be.url||null)}catch(re){console.error(re),u("Failed to load current logo.")}finally{t(!1)}};y.useEffect(()=>{Y()},[]);const P=re=>i(re.target.files?.[0]||null),q=async re=>{if(re.preventDefault(),!a){u("Choose an image first.");return}t(!0),u("");try{const be=new FormData;be.append("file",a);const Ae=await mc(`${Q0}/logo`,{method:"POST",body:be});let D={};try{D=await Ae.json()}catch{}if(!Ae.ok)throw new Error(D.error||`Upload failed (${Ae.status})`);n(D.url),i(null),u("Logo updated.")}catch(be){console.error(be),u(be.message==="Forbidden"?"CSRF validation failed":be.message)}finally{t(!1)}},G=async()=>{if(window.confirm("Remove the current logo?")){t(!0),u("");try{const re=await mc(`${Q0}/logo`,{method:"DELETE"});let be={};try{be=await re.json()}catch{}if(!re.ok)throw new Error(be.error||`Remove failed (${re.status})`);n(null),u("Logo removed.")}catch(re){console.error(re),u(re.message==="Forbidden"?"CSRF validation failed":re.message)}finally{t(!1)}}},Z=async()=>{p(!0);try{const re=new URLSearchParams({page:v,limit:w});_&&re.set("role",_),k&&re.set("action",k);const be=await mc(`${Q0}/activity?${re.toString()}`,{method:"GET"}),Ae=await be.json();if(!be.ok)throw new Error(Ae.error||"Failed to load activity");d(Ae.items||[]),j(Ae.total||0)}catch(re){console.error(re),d([]),j(0)}finally{p(!1)}};y.useEffect(()=>{Z()},[v,w,_,k]);const fe=Math.max(1,Math.ceil(S/Math.max(1,w))),Oe=async(re=W)=>{try{const be=new URLSearchParams({page:re,per_page:F});C&&be.set("q",C),I&&be.set("role",I);const Ae=await mc(`${TA}?${be.toString()}`,{method:"GET"});if(Ae.status===401||Ae.status===403){console.warn("Account Controls: unauthorized. Are you logged in?"),H([]),ue(0);return}const D=await Ae.json();if(!Ae.ok||D.ok===!1)throw new Error(D.error||"Failed to load users");H(D.data||[]),ue(D.total||0),U(D.page||re)}catch(be){console.error(be),H([]),ue(0)}};y.useEffect(()=>{Oe(1)},[C,I,F]),y.useEffect(()=>{Oe(W)},[W]);const Re=async(re,be,Ae)=>{Q(re);try{const D=await mc(`${TA}/${re}/${be}`,{method:"POST",headers:Ae?{"Content-Type":"application/json"}:void 0,body:Ae?JSON.stringify(Ae):void 0});if(D.status===401||D.status===403)throw new Error("Not authorized. Please sign in again.");const Me=await D.json();if(!D.ok||Me.ok===!1)throw new Error(Me.error||"Action failed");await Oe(W),be==="send-reset"&&Me.url&&console.info("Password reset URL:",Me.url)}catch(D){alert(D.message)}finally{Q(null)}};return c.jsxs("div",{className:"max-w-5xl space-y-6",children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Settings"}),c.jsxs("div",{className:"bg-white border rounded-xl p-4 shadow-sm",children:[c.jsx("h3",{className:"text-base font-semibold mb-3",children:"Statement Branding"}),c.jsxs("div",{className:"flex items-start gap-6",children:[c.jsx("div",{className:"w-40 h-40 border rounded-md flex items-center justify-center bg-gray-50",children:r?c.jsx("img",{src:r,alt:"Current logo",className:"max-w-full max-h-full object-contain"}):c.jsx("span",{className:"text-gray-400 text-sm",children:"No Logo"})}),c.jsxs("form",{onSubmit:q,className:"flex-1 space-y-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Upload New Logo"}),c.jsx("input",{type:"file",accept:"image/png,image/jpeg,image/webp,image/svg+xml",onChange:P,className:"block w-full text-sm text-gray-700 file:mr-4 file:py-2 file:px-3 file:rounded-md file:border-0 file:bg-blue-600 file:text-white hover:file:bg-blue-700"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Recommended: transparent PNG, at least 200200 px."})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("button",{type:"submit",disabled:e,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:e?"Saving":"Save Logo"}),c.jsx("button",{type:"button",disabled:e||!r,onClick:G,className:"px-4 py-2 bg-gray-100 text-gray-800 rounded-md hover:bg-gray-200 disabled:opacity-50",children:"Remove"}),c.jsx("button",{type:"button",onClick:Y,className:"px-3 py-2 text-sm text-gray-600 hover:text-gray-900",children:"Refresh"})]}),l&&c.jsx("p",{className:"text-sm text-gray-700",children:l})]})]})]}),c.jsxs("div",{className:"bg-white border rounded-xl p-4 shadow-sm",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("h3",{className:"text-base font-semibold",children:"User Activity Log"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("select",{value:k,onChange:re=>{g(1),O(re.target.value)},className:"border rounded px-2 py-1 text-sm",children:[c.jsx("option",{value:"",children:"All actions"}),c.jsx("option",{value:"login",children:"Login"}),c.jsx("option",{value:"logout",children:"Logout"})]}),c.jsxs("select",{value:_,onChange:re=>{g(1),A(re.target.value)},className:"border rounded px-2 py-1 text-sm",children:[c.jsx("option",{value:"",children:"All roles"}),c.jsx("option",{value:"admin",children:"Admin"}),c.jsx("option",{value:"investor",children:"Investor"}),c.jsx("option",{value:"groupadmin",children:"Group admin"})]}),c.jsx("select",{value:w,onChange:re=>{g(1),b(parseInt(re.target.value,10))},className:"border rounded px-2 py-1 text-sm",children:[10,25,50,100].map(re=>c.jsxs("option",{value:re,children:[re,"/page"]},re))})]})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full text-sm border",children:[c.jsx("thead",{className:"bg-gray-100",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-3 py-2 border",children:"User"}),c.jsx("th",{className:"px-3 py-2 border",children:"Role"}),c.jsx("th",{className:"px-3 py-2 border",children:"Action"}),c.jsx("th",{className:"px-3 py-2 border",children:"Date & Time"}),c.jsx("th",{className:"px-3 py-2 border",children:"IP"})]})}),c.jsx("tbody",{children:m?c.jsx("tr",{children:c.jsx("td",{className:"px-3 py-4 border text-center",colSpan:5,children:"Loading"})}):h.length===0?c.jsx("tr",{children:c.jsx("td",{className:"px-3 py-4 border text-center",colSpan:5,children:"No activity yet"})}):h.map(re=>c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsx("td",{className:"px-3 py-2 border",children:re.name||re.user_id||"-"}),c.jsx("td",{className:"px-3 py-2 border",children:re.role||"-"}),c.jsx("td",{className:"px-3 py-2 border",children:c.jsx("span",{className:"px-2 py-1 rounded text-white "+(re.action==="login"?"bg-green-500":"bg-rose-500"),children:re.action})}),c.jsx("td",{className:"px-3 py-2 border",children:new Date(re.created_at).toLocaleString()}),c.jsx("td",{className:"px-3 py-2 border",children:re.ip||"-"})]},re.id))})]})}),c.jsxs("div",{className:"flex justify-between items-center mt-3",children:[c.jsxs("p",{className:"text-xs text-gray-500",children:["Showing ",h.length," of ",S," records"]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",disabled:v<=1,onClick:()=>g(re=>re-1),children:"Prev"}),c.jsxs("span",{className:"text-sm",children:["Page ",v," / ",fe]}),c.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",disabled:v>=fe,onClick:()=>g(re=>re+1),children:"Next"})]})]})]}),c.jsxs("div",{className:"bg-white border rounded-xl p-4 shadow-sm",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("h3",{className:"text-base font-semibold",children:"Account Controls"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{value:C,onChange:re=>T(re.target.value),placeholder:"Search name or email",className:"border rounded px-2 py-1 text-sm"}),c.jsxs("select",{value:I,onChange:re=>{M(re.target.value),U(1)},className:"border rounded px-2 py-1 text-sm",children:[c.jsx("option",{value:"",children:"All roles"}),c.jsx("option",{value:"admin",children:"Admin"}),c.jsx("option",{value:"investor",children:"Investor"})]}),c.jsx("select",{value:F,onChange:re=>{oe(parseInt(re.target.value,10)),U(1)},className:"border rounded px-2 py-1 text-sm",children:[10,25,50,100].map(re=>c.jsxs("option",{value:re,children:[re,"/page"]},re))})]})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full text-sm border",children:[c.jsx("thead",{className:"bg-gray-100",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-3 py-2 border",children:"User"}),c.jsx("th",{className:"px-3 py-2 border",children:"Email"}),c.jsx("th",{className:"px-3 py-2 border",children:"Role"}),c.jsx("th",{className:"px-3 py-2 border",children:"Status"}),c.jsx("th",{className:"px-3 py-2 border text-right",children:"Actions"})]})}),c.jsx("tbody",{children:V.length===0?c.jsx("tr",{children:c.jsx("td",{className:"px-3 py-4 border text-center",colSpan:5,children:"No users found"})}):V.map(re=>c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsx("td",{className:"px-3 py-2 border",children:re.name}),c.jsx("td",{className:"px-3 py-2 border",children:re.email}),c.jsx("td",{className:"px-3 py-2 border capitalize",children:re.role}),c.jsx("td",{className:"px-3 py-2 border",children:re.is_blocked?c.jsx("span",{className:"px-2 py-1 rounded bg-rose-100 text-rose-700",children:"Blocked"}):c.jsx("span",{className:"px-2 py-1 rounded bg-green-100 text-green-700",children:"Active"})}),c.jsxs("td",{className:"px-3 py-2 border text-right",children:[re.is_blocked?c.jsx("button",{className:"px-3 py-1 rounded bg-green-600 text-white disabled:opacity-50 mr-2",disabled:Se===re.id,onClick:()=>Re(re.id,"unblock"),children:"Unblock"}):c.jsx("button",{className:"px-3 py-1 rounded bg-rose-600 text-white disabled:opacity-50 mr-2",disabled:Se===re.id,onClick:()=>{const be=window.prompt("Reason for blocking (optional):")||"";Re(re.id,"block",{reason:be})},children:"Block"}),c.jsx("button",{className:"px-3 py-1 rounded bg-indigo-600 text-white disabled:opacity-50",disabled:Se===re.id,onClick:()=>Re(re.id,"send-reset"),children:"Send Reset"})]})]},re.id))})]})}),c.jsxs("div",{className:"flex justify-between items-center mt-3",children:[c.jsxs("p",{className:"text-xs text-gray-500",children:["Showing ",V.length," of ",je," users"]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",disabled:W<=1,onClick:()=>U(re=>re-1),children:"Prev"}),c.jsxs("span",{className:"text-sm",children:["Page ",W," / ",z]}),c.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",disabled:W>=z,onClick:()=>U(re=>re+1),children:"Next"})]})]})]})]})}function UB({onSuccess:e}){const[t,r]=y.useState({name:"",email:""}),[n,a]=y.useState({type:"",msg:""}),[i,l]=y.useState(!1),u=m=>r(p=>({...p,[m.target.name]:m.target.value})),h=()=>r({name:"",email:""}),d=async m=>{m.preventDefault(),a({type:"",msg:""});const p=t.name.trim(),v=t.email.trim().toLowerCase();if(!p||!v){a({type:"error",msg:"Name and email are required."});return}try{l(!0);const{data:g}=await We.post("/api/admin/invite-admin",{name:p,email:v});if(!g?.ok)throw new Error(g?.error||g?.msg||"Invite failed.");const w=g?.mail_error&&!g?.emailed?`Admin invitation created. Email not sent (${g.mail_error}). You can use this link: ${g.accept_url}`:g?.msg||"Admin invitation created successfully.";a({type:"success",msg:w}),h(),e?.()}catch(g){const w=g?.response?.data?.error||g?.response?.data?.msg||g?.message||"Failed to send invite.";a({type:"error",msg:w})}finally{l(!1)}};return c.jsx("div",{className:"min-h-[60vh] w-full grid place-items-center px-4 py-8",children:c.jsxs("div",{className:"relative w-full max-w-xl",children:[c.jsx("div",{className:"absolute -inset-1 rounded-3xl bg-gradient-to-r from-indigo-500 via-fuchsia-500 to-rose-500 blur opacity-25 animate-pulse"}),c.jsxs("div",{className:"relative rounded-3xl border border-white/10 bg-white/60 backdrop-blur-xl shadow-2xl",children:[c.jsxs("div",{className:"p-6 sm:p-8 border-b border-black/5 bg-gradient-to-br from-white/80 to-white/40 rounded-t-3xl",children:[c.jsx("h1",{className:"text-xl sm:text-2xl font-semibold tracking-tight",children:"Add Admin"}),c.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Invite a new admin user by email."})]}),c.jsxs("form",{onSubmit:d,className:"p-6 sm:p-8 space-y-5",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-800",children:"Name"}),c.jsx("input",{name:"name",value:t.name,onChange:u,required:!0,className:"w-full rounded-xl border border-gray-200 bg-white/90 px-4 py-2.5 outline-none focus:ring-4 focus:ring-indigo-100 focus:border-indigo-400 transition"})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-800",children:"Email"}),c.jsx("input",{type:"email",name:"email",value:t.email,onChange:u,required:!0,className:"w-full rounded-xl border border-gray-200 bg-white/90 px-4 py-2.5 outline-none focus:ring-4 focus:ring-indigo-100 focus:border-indigo-400 transition"})]}),n.msg&&c.jsx("div",{className:["rounded-xl px-4 py-3 text-sm border break-words",n.type==="success"?"bg-emerald-50 border-emerald-200 text-emerald-700":"bg-rose-50 border-rose-200 text-rose-700"].join(" "),children:n.msg}),c.jsx("div",{className:"pt-2",children:c.jsx("button",{type:"submit",disabled:i,className:"inline-flex items-center justify-center rounded-xl bg-gradient-to-r from-indigo-600 to-fuchsia-600 text-white font-medium px-5 py-3 shadow-lg shadow-indigo-600/20 hover:shadow-fuchsia-600/25 hover:brightness-110 active:scale-[0.99] disabled:opacity-60 disabled:cursor-not-allowed transition-all duration-150",children:i?"Sending":"Send Invitation"})})]})]})]})})}const og=10,$B="https://clarus.elpiscapital.com";function zB(){const[e,t]=y.useState([]),[r,n]=y.useState([]),[a,i]=y.useState(""),[l,u]=y.useState(""),[h,d]=y.useState(!0),[m,p]=y.useState(1),[v,g]=y.useState(!1);async function w(){try{d(!0),u("");const C=await fetch(`${$B}/admin/users`,{method:"GET",credentials:"include",headers:{Accept:"application/json"}});if(C.status===401)throw new Error("Not authorized. Please sign in again.");if(!C.ok){const I=await C.text().catch(()=>"");throw new Error(`Failed to fetch users: ${C.status}${I?`  ${I}`:""}`)}const T=await C.json();t(Array.isArray(T)?T:T?.users||[]),n(Array.isArray(T)?T:T?.users||[])}catch(C){u(C?.message||"Error fetching users"),t([]),n([])}finally{d(!1)}}y.useEffect(()=>{w()},[]),y.useEffect(()=>{const C=a.trim().toLowerCase(),T=e.filter(I=>(I.name||"").toLowerCase().includes(C)||(I.email||"").toLowerCase().includes(C));n(T),p(1)},[a,e]);const b=Math.max(1,Math.ceil(r.length/og)),S=(m-1)*og,j=r.slice(S,S+og),_=()=>p(C=>Math.max(1,C-1)),A=()=>p(C=>Math.min(b,C+1)),k=()=>g(!0),O=()=>{g(!1),w()};return h?c.jsx("p",{className:"text-center mt-6",children:"Loading users..."}):l?c.jsx("p",{className:"text-center text-red-600 mt-6",children:l}):c.jsxs("div",{className:"p-4",children:[c.jsxs("div",{className:"mb-6",children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-6",children:"All Users"}),c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[c.jsx("input",{type:"text",placeholder:" Search by name or email",value:a,onChange:C=>i(C.target.value),className:"w-full sm:w-80 px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 transition"}),c.jsx("button",{onClick:k,className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-semibold px-5 py-2 rounded-lg shadow-md transition w-full sm:w-auto",children:"+ Add New User"})]})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full bg-white border border-gray-200 rounded-lg shadow",children:[c.jsx("thead",{className:"bg-blue-600 text-white",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-2 text-left",children:"Name"}),c.jsx("th",{className:"px-4 py-2 text-left",children:"Email"}),c.jsx("th",{className:"px-4 py-2 text-left",children:"Bank"}),c.jsx("th",{className:"px-4 py-2 text-left",children:"Status"}),c.jsx("th",{className:"px-4 py-2 text-left",children:"Permission"})]})}),c.jsx("tbody",{children:j.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:"5",className:"text-center p-4",children:"No users found."})}):j.map(C=>c.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[c.jsx("td",{className:"px-4 py-2",children:C.name||""}),c.jsx("td",{className:"px-4 py-2",children:C.email||""}),c.jsx("td",{className:"px-4 py-2",children:C.bank||""}),c.jsx("td",{className:"px-4 py-2",children:C.status||""}),c.jsx("td",{className:"px-4 py-2",children:C.permission||""})]},C.id||`${C.email}-${C.name}`))})]})}),c.jsxs("div",{className:"text-sm text-gray-500 mt-4",children:["Showing ",j.length," of ",r.length," users"]}),b>1&&c.jsxs("div",{className:"mt-4 flex justify-center items-center gap-4",children:[c.jsx("button",{onClick:_,disabled:m===1,className:"px-4 py-2 border rounded-lg bg-gray-100 hover:bg-gray-200 disabled:opacity-50",children:" Prev"}),c.jsxs("span",{className:"text-gray-700 font-semibold",children:["Page ",m," of ",b]}),c.jsx("button",{onClick:A,disabled:m===b,className:"px-4 py-2 border rounded-lg bg-gray-100 hover:bg-gray-200 disabled:opacity-50",children:"Next "})]}),v&&c.jsx("div",{className:"fixed inset-0 bg-black/40 grid place-items-center z-50",children:c.jsx("div",{className:"relative w-full max-w-6xl bg-white rounded-lg shadow-lg max-h-[90vh] overflow-y-auto",children:c.jsx("button",{onClick:O,className:"absolute top-3 right-3 bg-white text-gray-600 px-3 py-1 rounded shadow hover:bg-gray-100",children:" Close"})})})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var rO=1252,HB=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],zb={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Hb=function(e){HB.indexOf(e)!=-1&&(rO=zb[0]=e)};function qB(){Hb(1252)}var oi=function(e){Hb(e)};function nO(){oi(1200),qB()}function kA(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function VB(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function aO(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var vf=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?VB(e.slice(2)):t==254&&r==255?aO(e.slice(2)):t==65279?e.slice(1):e},J0=function(t){return String.fromCharCode(t)},CA=function(t){return String.fromCharCode(t)},zf,cl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function OA(e){for(var t="",r=0,n=0,a=0,i=0,l=0,u=0,h=0,d=0;d<e.length;)r=e.charCodeAt(d++),i=r>>2,n=e.charCodeAt(d++),l=(r&3)<<4|n>>4,a=e.charCodeAt(d++),u=(n&15)<<2|a>>6,h=a&63,isNaN(n)?u=h=64:isNaN(a)&&(h=64),t+=cl.charAt(i)+cl.charAt(l)+cl.charAt(u)+cl.charAt(h);return t}function da(e){var t="",r=0,n=0,a=0,i=0,l=0,u=0,h=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)i=cl.indexOf(e.charAt(d++)),l=cl.indexOf(e.charAt(d++)),r=i<<2|l>>4,t+=String.fromCharCode(r),u=cl.indexOf(e.charAt(d++)),n=(l&15)<<4|u>>2,u!==64&&(t+=String.fromCharCode(n)),h=cl.indexOf(e.charAt(d++)),a=(u&3)<<6|h,h!==64&&(t+=String.fromCharCode(a));return t}var _t=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),So=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function pl(e){return _t?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function DA(e){return _t?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ii=function(t){return _t?So(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Eo(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function qb(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return qb(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var ll=_t?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:So(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function KB(e){for(var t=[],r=0,n=e.length+250,a=pl(e.length+255),i=0;i<e.length;++i){var l=e.charCodeAt(i);if(l<128)a[r++]=l;else if(l<2048)a[r++]=192|l>>6&31,a[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var u=e.charCodeAt(++i)&1023;a[r++]=240|l>>8&7,a[r++]=128|l>>2&63,a[r++]=128|u>>6&15|(l&3)<<4,a[r++]=128|u&63}else a[r++]=224|l>>12&15,a[r++]=128|l>>6&63,a[r++]=128|l&63;r>n&&(t.push(a.slice(0,r)),r=0,a=pl(65535),n=65530)}return t.push(a.slice(0,r)),ll(t)}var On=/\u0000/g,gf=/[\u0001-\u0006]/g;function Ac(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function ci(e,t){var r=""+e;return r.length>=t?r:ur("0",t-r.length)+r}function Vb(e,t){var r=""+e;return r.length>=t?r:ur(" ",t-r.length)+r}function Bh(e,t){var r=""+e;return r.length>=t?r:r+ur(" ",t-r.length)}function GB(e,t){var r=""+Math.round(e);return r.length>=t?r:ur("0",t-r.length)+r}function WB(e,t){var r=""+e;return r.length>=t?r:ur("0",t-r.length)+r}var PA=Math.pow(2,32);function pc(e,t){if(e>PA||e<-PA)return GB(e,t);var r=Math.round(e);return WB(r,t)}function Uh(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var RA=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],cg=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function YB(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var xt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},MA={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},XB={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function $h(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,l=1,u=0,h=1,d=0,m=0,p=Math.floor(a);d<t&&(p=Math.floor(a),u=p*l+i,m=p*d+h,!(a-p<5e-8));)a=1/(a-p),i=l,l=u,h=d,d=m;if(m>t&&(d>t?(m=h,u=i):(m=d,u=l)),!r)return[0,n*u,m];var v=Math.floor(n*u/m);return[v,n*u-v*m,m]}function eo(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,l=[],u={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),t&&t.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++a==86400&&(u.T=a=0,++n,++u.D)),n===60)l=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)l=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var h=new Date(1900,0,1);h.setDate(h.getDate()+n-1),l=[h.getFullYear(),h.getMonth()+1,h.getDate()],i=h.getDay(),n<60&&(i=(i+6)%7),r&&(i=r9(h,l))}return u.y=l[0],u.m=l[1],u.d=l[2],u.S=a%60,a=Math.floor(a/60),u.M=a%60,a=Math.floor(a/60),u.H=a,u.q=i,u}var iO=new Date(1899,11,31,0,0,0),ZB=iO.getTime(),QB=new Date(1900,2,1,0,0,0);function sO(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=QB&&(r+=24*60*60*1e3),(r-(ZB+(e.getTimezoneOffset()-iO.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Kb(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function JB(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function e9(e){var t=e<0?12:11,r=Kb(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function t9(e){var t=Kb(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Hf(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=e9(e):t===10?r=e.toFixed(10).substr(0,12):r=t9(e),Kb(JB(r.toUpperCase()))}function po(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Hf(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Ha(14,sO(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function r9(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function n9(e,t,r,n){var a="",i=0,l=0,u=r.y,h,d=0;switch(e){case 98:u=r.y+543;case 121:switch(t.length){case 1:case 2:h=u%100,d=2;break;default:h=u%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:h=r.m,d=t.length;break;case 3:return cg[r.m-1][1];case 5:return cg[r.m-1][0];default:return cg[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:h=r.d,d=t.length;break;case 3:return RA[r.q][0];default:return RA[r.q][1]}break;case 104:switch(t.length){case 1:case 2:h=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:h=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:h=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?ci(r.S,t.length):(n>=2?l=n===3?1e3:100:l=n===1?10:1,i=Math.round(l*(r.S+r.u)),i>=60*l&&(i=0),t==="s"?i===0?"0":""+i/l:(a=ci(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":h=r.D*24+r.H;break;case"[m]":case"[mm]":h=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":h=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:h=u,d=1;break}var m=d>0?ci(h,d):"";return m}function ul(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var lO=/%/g;function a9(e,t,r){var n=t.replace(lO,""),a=t.length-n.length;return ss(e,n,r*Math.pow(10,2*a))+ur("%",a)}function i9(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ss(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function oO(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+oO(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var l=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+i):r+="E+"+(l-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,d,m){return h+d+m.substr(0,(a+i)%a)+"."+m.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var cO=/# (\?+)( ?)\/( ?)(\d+)/;function s9(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),l=a-i*n,u=n;return r+(i===0?"":""+i)+" "+(l===0?ur(" ",e[1].length+1+e[4].length):Vb(l,e[1].length)+e[2]+"/"+e[3]+ci(u,e[4].length))}function l9(e,t,r){return r+(t===0?"":""+t)+ur(" ",e[1].length+2+e[4].length)}var uO=/^#*0*\.([0#]+)/,fO=/\).*[0#]/,dO=/\(###\) ###\\?-####/;function _n(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function FA(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function IA(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function o9(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function c9(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ma(e,t,r){if(e.charCodeAt(0)===40&&!t.match(fO)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ma("n",n,r):"("+Ma("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return i9(e,t,r);if(t.indexOf("%")!==-1)return a9(e,t,r);if(t.indexOf("E")!==-1)return oO(t,r);if(t.charCodeAt(0)===36)return"$"+Ma(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,l,u,h=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+pc(h,t.length);if(t.match(/^[#?]+$/))return a=pc(r,0),a==="0"&&(a=""),a.length>t.length?a:_n(t.substr(0,t.length-a.length))+a;if(i=t.match(cO))return s9(i,h,d);if(t.match(/^#+0+$/))return d+pc(h,t.length-t.indexOf("0"));if(i=t.match(uO))return a=FA(r,i[1].length).replace(/^([^\.]+)$/,"$1."+_n(i[1])).replace(/\.$/,"."+_n(i[1])).replace(/\.(\d*)$/,function(w,b){return"."+b+ur("0",_n(i[1]).length-b.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+FA(h,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+ul(pc(h,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ma(e,t,-r):ul(""+(Math.floor(r)+o9(r,i[1].length)))+"."+ci(IA(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Ma(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Ac(Ma(e,t.replace(/[\\-]/g,""),r)),l=0,Ac(Ac(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return l<a.length?a.charAt(l++):w==="0"?"0":""}));if(t.match(dO))return a=Ma(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var m="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),u=$h(h,Math.pow(10,l)-1,!1),a=""+d,m=ss("n",i[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),a+=m+i[2]+"/"+i[3],m=Bh(u[2],l),m.length<i[4].length&&(m=_n(i[4].substr(i[4].length-m.length))+m),a+=m,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),u=$h(h,Math.pow(10,l)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Vb(u[1],l)+i[2]+"/"+i[3]+Bh(u[2],l):ur(" ",2*l+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=pc(r,0),t.length<=a.length?a:_n(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var p=t.indexOf(".")-l,v=t.length-a.length-p;return _n(t.substr(0,p)+a+t.substr(t.length-v))}if(i=t.match(/^00,000\.([#0]*0)$/))return l=IA(r,i[1].length),r<0?"-"+Ma(e,t,-r):ul(c9(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?ci(0,3-w.length):"")+w})+"."+ci(l,i[1].length);switch(t){case"###,##0.00":return Ma(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var g=ul(pc(h,0));return g!=="0"?d+g:"";case"###,###.00":return Ma(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ma(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function u9(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ss(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function f9(e,t,r){var n=t.replace(lO,""),a=t.length-n.length;return ss(e,n,r*Math.pow(10,2*a))+ur("%",a)}function hO(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+hO(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var l=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+i):r+="E+"+(l-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,d,m){return h+d+m.substr(0,(a+i)%a)+"."+m.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ai(e,t,r){if(e.charCodeAt(0)===40&&!t.match(fO)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ai("n",n,r):"("+Ai("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return u9(e,t,r);if(t.indexOf("%")!==-1)return f9(e,t,r);if(t.indexOf("E")!==-1)return hO(t,r);if(t.charCodeAt(0)===36)return"$"+Ai(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,l,u,h=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+ci(h,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:_n(t.substr(0,t.length-a.length))+a;if(i=t.match(cO))return l9(i,h,d);if(t.match(/^#+0+$/))return d+ci(h,t.length-t.indexOf("0"));if(i=t.match(uO))return a=(""+r).replace(/^([^\.]+)$/,"$1."+_n(i[1])).replace(/\.$/,"."+_n(i[1])),a=a.replace(/\.(\d*)$/,function(w,b){return"."+b+ur("0",_n(i[1]).length-b.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+ul(""+h);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ai(e,t,-r):ul(""+r)+"."+ur("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Ai(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Ac(Ai(e,t.replace(/[\\-]/g,""),r)),l=0,Ac(Ac(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return l<a.length?a.charAt(l++):w==="0"?"0":""}));if(t.match(dO))return a=Ai(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var m="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),u=$h(h,Math.pow(10,l)-1,!1),a=""+d,m=ss("n",i[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),a+=m+i[2]+"/"+i[3],m=Bh(u[2],l),m.length<i[4].length&&(m=_n(i[4].substr(i[4].length-m.length))+m),a+=m,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),u=$h(h,Math.pow(10,l)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Vb(u[1],l)+i[2]+"/"+i[3]+Bh(u[2],l):ur(" ",2*l+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:_n(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var p=t.indexOf(".")-l,v=t.length-a.length-p;return _n(t.substr(0,p)+a+t.substr(t.length-v))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ai(e,t,-r):ul(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?ci(0,3-w.length):"")+w})+"."+ci(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var g=ul(""+h);return g!=="0"?d+g:"";default:if(t.match(/\.[0#?]*$/))return Ai(e,t.slice(0,t.lastIndexOf(".")),r)+_n(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ss(e,t,r){return(r|0)===r?Ai(e,t,r):Ma(e,t,r)}function d9(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var mO=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Zc(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Uh(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(mO))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function h9(e,t,r,n){for(var a=[],i="",l=0,u="",h="t",d,m,p,v="H";l<e.length;)switch(u=e.charAt(l)){case"G":if(!Uh(e,l))throw new Error("unrecognized character "+u+" in "+e);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(i="";(p=e.charCodeAt(++l))!==34&&l<e.length;)i+=String.fromCharCode(p);a[a.length]={t:"t",v:i},++l;break;case"\\":var g=e.charAt(++l),w=g==="("||g===")"?g:"t";a[a.length]={t:w,v:g},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:t},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(d==null&&(d=eo(t,r,e.charAt(l+1)==="2"),d==null))return"";a[a.length]={t:"X",v:e.substr(l,2)},h=u,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=eo(t,r),d==null))return"";for(i=u;++l<e.length&&e.charAt(l).toLowerCase()===u;)i+=u;u==="m"&&h.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=v),a[a.length]={t:u,v:i},h=u;break;case"A":case"a":case"":var b={t:u,v:u};if(d==null&&(d=eo(t,r)),e.substr(l,3).toUpperCase()==="A/P"?(d!=null&&(b.v=d.H>=12?"P":"A"),b.t="T",v="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(d!=null&&(b.v=d.H>=12?"PM":"AM"),b.t="T",l+=5,v="h"):e.substr(l,5).toUpperCase()==="/"?(d!=null&&(b.v=d.H>=12?"":""),b.t="T",l+=5,v="h"):(b.t="t",++l),d==null&&b.t==="T")return"";a[a.length]=b,h=u;break;case"[":for(i=u;e.charAt(l++)!=="]"&&l<e.length;)i+=e.charAt(l);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(mO)){if(d==null&&(d=eo(t,r),d==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},h=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Zc(e)||(a[a.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=u;++l<e.length&&(u=e.charAt(l))==="0";)i+=u;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=u;++l<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(l))>-1;)i+=u;a[a.length]={t:"n",v:i};break;case"?":for(i=u;e.charAt(++l)===u;)i+=u;a[a.length]={t:u,v:i},h=u;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:n===1?"t":u,v:u},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=u;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)i+=e.charAt(l);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:u,v:u},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+e);a[a.length]={t:"t",v:u},++l;break}var S=0,j=0,_;for(l=a.length-1,h="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=v,h="h",S<1&&(S=1);break;case"s":(_=a[l].v.match(/\.0+$/))&&(j=Math.max(j,_[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":h=a[l].t;break;case"m":h==="s"&&(a[l].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&a[l].v.match(/[Hh]/)&&(S=1),S<2&&a[l].v.match(/[Mm]/)&&(S=2),S<3&&a[l].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var A="",k;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=n9(a[l].t.charCodeAt(0),a[l].v,d,j),a[l].t="t";break;case"n":case"?":for(k=l+1;a[k]!=null&&((u=a[k].t)==="?"||u==="D"||(u===" "||u==="t")&&a[k+1]!=null&&(a[k+1].t==="?"||a[k+1].t==="t"&&a[k+1].v==="/")||a[l].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(a[k].v==="/"||a[k].v===" "&&a[k+1]!=null&&a[k+1].t=="?"));)a[l].v+=a[k].v,a[k]={v:"",t:";"},++k;A+=a[l].v,l=k-1;break;case"G":a[l].t="t",a[l].v=po(t,r);break}var O="",C,T;if(A.length>0){A.charCodeAt(0)==40?(C=t<0&&A.charCodeAt(0)===45?-t:t,T=ss("n",A,C)):(C=t<0&&n>1?-t:t,T=ss("n",A,C),C<0&&a[0]&&a[0].t=="t"&&(T=T.substr(1),a[0].v="-"+a[0].v)),k=T.length-1;var I=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){I=l;break}var M=a.length;if(I===a.length&&T.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(k>=a[l].v.length-1?(k-=a[l].v.length,a[l].v=T.substr(k+1,a[l].v.length)):k<0?a[l].v="":(a[l].v=T.substr(0,k+1),k=-1),a[l].t="t",M=l);k>=0&&M<a.length&&(a[M].v=T.substr(0,k+1)+a[M].v)}else if(I!==a.length&&T.indexOf("E")===-1){for(k=T.indexOf(".")-1,l=I;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(m=a[l].v.indexOf(".")>-1&&l===I?a[l].v.indexOf(".")-1:a[l].v.length-1,O=a[l].v.substr(m+1);m>=0;--m)k>=0&&(a[l].v.charAt(m)==="0"||a[l].v.charAt(m)==="#")&&(O=T.charAt(k--)+O);a[l].v=O,a[l].t="t",M=l}for(k>=0&&M<a.length&&(a[M].v=T.substr(0,k+1)+a[M].v),k=T.indexOf(".")+1,l=I;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==I)){for(m=a[l].v.indexOf(".")>-1&&l===I?a[l].v.indexOf(".")+1:0,O=a[l].v.substr(0,m);m<a[l].v.length;++m)k<T.length&&(O+=T.charAt(k++));a[l].v=O,a[l].t="t",M=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(C=n>1&&t<0&&l>0&&a[l-1].v==="-"?-t:t,a[l].v=ss(a[l].t,a[l].v,C),a[l].t="t");var W="";for(l=0;l!==a.length;++l)a[l]!=null&&(W+=a[l].v);return W}var LA=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function BA(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function m9(e,t){var r=d9(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(LA),u=r[1].match(LA);return BA(t,l)?[n,r[0]]:BA(t,u)?[n,r[1]]:[n,r[l!=null&&u!=null?2:1]]}return[n,i]}function Ha(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:xt)[e],n==null&&(n=r.table&&r.table[MA[e]]||xt[MA[e]]),n==null&&(n=XB[e]||"General");break}if(Uh(n,0))return po(t,r);t instanceof Date&&(t=sO(t,r.date1904));var a=m9(n,t);if(Uh(a[1]))return po(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return h9(a[1],t,r,a[0])}function lo(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(xt[r]==null){t<0&&(t=r);continue}if(xt[r]==e){t=r;break}}t<0&&(t=391)}return xt[t]=e,t}function pO(){xt=YB()}var p9={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},xO=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function x9(e){var t=typeof e=="number"?xt[e]:e;return t=t.replace(xO,"(\\d+)"),new RegExp("^"+t+"$")}function v9(e,t,r){var n=-1,a=-1,i=-1,l=-1,u=-1,h=-1;(t.match(xO)||[]).forEach(function(p,v){var g=parseInt(r[v+1],10);switch(p.toLowerCase().charAt(0)){case"y":n=g;break;case"d":i=g;break;case"h":l=g;break;case"s":h=g;break;case"m":l>=0?u=g:a=g;break}}),h>=0&&u==-1&&a>=0&&(u=a,a=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var m=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return l==-1&&u==-1&&h==-1?d:n==-1&&a==-1&&i==-1?m:d+"T"+m}var g9=function(){var e={};e.version="1.2.0";function t(){for(var T=0,I=new Array(256),M=0;M!=256;++M)T=M,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,I[M]=T;return typeof Int32Array<"u"?new Int32Array(I):I}var r=t();function n(T){var I=0,M=0,W=0,U=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(W=0;W!=256;++W)U[W]=T[W];for(W=0;W!=256;++W)for(M=T[W],I=256+W;I<4096;I+=256)M=U[I]=M>>>8^T[M&255];var F=[];for(W=1;W!=16;++W)F[W-1]=typeof Int32Array<"u"?U.subarray(W*256,W*256+256):U.slice(W*256,W*256+256);return F}var a=n(r),i=a[0],l=a[1],u=a[2],h=a[3],d=a[4],m=a[5],p=a[6],v=a[7],g=a[8],w=a[9],b=a[10],S=a[11],j=a[12],_=a[13],A=a[14];function k(T,I){for(var M=I^-1,W=0,U=T.length;W<U;)M=M>>>8^r[(M^T.charCodeAt(W++))&255];return~M}function O(T,I){for(var M=I^-1,W=T.length-15,U=0;U<W;)M=A[T[U++]^M&255]^_[T[U++]^M>>8&255]^j[T[U++]^M>>16&255]^S[T[U++]^M>>>24]^b[T[U++]]^w[T[U++]]^g[T[U++]]^v[T[U++]]^p[T[U++]]^m[T[U++]]^d[T[U++]]^h[T[U++]]^u[T[U++]]^l[T[U++]]^i[T[U++]]^r[T[U++]];for(W+=15;U<W;)M=M>>>8^r[(M^T[U++])&255];return~M}function C(T,I){for(var M=I^-1,W=0,U=T.length,F=0,oe=0;W<U;)F=T.charCodeAt(W++),F<128?M=M>>>8^r[(M^F)&255]:F<2048?(M=M>>>8^r[(M^(192|F>>6&31))&255],M=M>>>8^r[(M^(128|F&63))&255]):F>=55296&&F<57344?(F=(F&1023)+64,oe=T.charCodeAt(W++)&1023,M=M>>>8^r[(M^(240|F>>8&7))&255],M=M>>>8^r[(M^(128|F>>2&63))&255],M=M>>>8^r[(M^(128|oe>>6&15|(F&3)<<4))&255],M=M>>>8^r[(M^(128|oe&63))&255]):(M=M>>>8^r[(M^(224|F>>12&15))&255],M=M>>>8^r[(M^(128|F>>6&63))&255],M=M>>>8^r[(M^(128|F&63))&255]);return~M}return e.table=r,e.bstr=k,e.buf=O,e.str=C,e}(),Ct=function(){var t={};t.version="1.2.1";function r(L,ee){for(var K=L.split("/"),X=ee.split("/"),J=0,te=0,ie=Math.min(K.length,X.length);J<ie;++J){if(te=K[J].length-X[J].length)return te;if(K[J]!=X[J])return K[J]<X[J]?-1:1}return K.length-X.length}function n(L){if(L.charAt(L.length-1)=="/")return L.slice(0,-1).indexOf("/")===-1?L:n(L.slice(0,-1));var ee=L.lastIndexOf("/");return ee===-1?L:L.slice(0,ee+1)}function a(L){if(L.charAt(L.length-1)=="/")return a(L.slice(0,-1));var ee=L.lastIndexOf("/");return ee===-1?L:L.slice(ee+1)}function i(L,ee){typeof ee=="string"&&(ee=new Date(ee));var K=ee.getHours();K=K<<6|ee.getMinutes(),K=K<<5|ee.getSeconds()>>>1,L.write_shift(2,K);var X=ee.getFullYear()-1980;X=X<<4|ee.getMonth()+1,X=X<<5|ee.getDate(),L.write_shift(2,X)}function l(L){var ee=L.read_shift(2)&65535,K=L.read_shift(2)&65535,X=new Date,J=K&31;K>>>=5;var te=K&15;K>>>=4,X.setMilliseconds(0),X.setFullYear(K+1980),X.setMonth(te-1),X.setDate(J);var ie=ee&31;ee>>>=5;var pe=ee&63;return ee>>>=6,X.setHours(ee),X.setMinutes(pe),X.setSeconds(ie<<1),X}function u(L){Jr(L,0);for(var ee={},K=0;L.l<=L.length-4;){var X=L.read_shift(2),J=L.read_shift(2),te=L.l+J,ie={};switch(X){case 21589:K=L.read_shift(1),K&1&&(ie.mtime=L.read_shift(4)),J>5&&(K&2&&(ie.atime=L.read_shift(4)),K&4&&(ie.ctime=L.read_shift(4))),ie.mtime&&(ie.mt=new Date(ie.mtime*1e3));break}L.l=te,ee[X]=ie}return ee}var h;function d(){return h||(h={})}function m(L,ee){if(L[0]==80&&L[1]==75)return _s(L,ee);if((L[0]|32)==109&&(L[1]|32)==105)return Cs(L,ee);if(L.length<512)throw new Error("CFB file size "+L.length+" < 512");var K=3,X=512,J=0,te=0,ie=0,pe=0,le=0,ye=[],Ee=L.slice(0,512);Jr(Ee,0);var De=p(Ee);switch(K=De[0],K){case 3:X=512;break;case 4:X=4096;break;case 0:if(De[1]==0)return _s(L,ee);default:throw new Error("Major Version: Expected 3 or 4 saw "+K)}X!==512&&(Ee=L.slice(0,X),Jr(Ee,28));var Ie=L.slice(0,X);v(Ee,K);var Ve=Ee.read_shift(4,"i");if(K===3&&Ve!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ve);Ee.l+=4,ie=Ee.read_shift(4,"i"),Ee.l+=4,Ee.chk("00100000","Mini Stream Cutoff Size: "),pe=Ee.read_shift(4,"i"),J=Ee.read_shift(4,"i"),le=Ee.read_shift(4,"i"),te=Ee.read_shift(4,"i");for(var He=-1,Xe=0;Xe<109&&(He=Ee.read_shift(4,"i"),!(He<0));++Xe)ye[Xe]=He;var st=g(L,X);S(le,te,st,X,ye);var pt=_(st,ie,ye,X);pt[ie].name="!Directory",J>0&&pe!==oe&&(pt[pe].name="!MiniFAT"),pt[ye[0]].name="!FAT",pt.fat_addrs=ye,pt.ssz=X;var dt={},jt=[],kr=[],an=[];A(ie,pt,st,jt,J,dt,kr,pe),w(kr,an,jt),jt.shift();var jn={FileIndex:kr,FullPaths:an};return ee&&ee.raw&&(jn.raw={header:Ie,sectors:st}),jn}function p(L){if(L[L.l]==80&&L[L.l+1]==75)return[0,0];L.chk(je,"Header Signature: "),L.l+=16;var ee=L.read_shift(2,"u");return[L.read_shift(2,"u"),ee]}function v(L,ee){var K=9;switch(L.l+=2,K=L.read_shift(2)){case 9:if(ee!=3)throw new Error("Sector Shift: Expected 9 saw "+K);break;case 12:if(ee!=4)throw new Error("Sector Shift: Expected 12 saw "+K);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+K)}L.chk("0600","Mini Sector Shift: "),L.chk("000000000000","Reserved: ")}function g(L,ee){for(var K=Math.ceil(L.length/ee)-1,X=[],J=1;J<K;++J)X[J-1]=L.slice(J*ee,(J+1)*ee);return X[K-1]=L.slice(K*ee),X}function w(L,ee,K){for(var X=0,J=0,te=0,ie=0,pe=0,le=K.length,ye=[],Ee=[];X<le;++X)ye[X]=Ee[X]=X,ee[X]=K[X];for(;pe<Ee.length;++pe)X=Ee[pe],J=L[X].L,te=L[X].R,ie=L[X].C,ye[X]===X&&(J!==-1&&ye[J]!==J&&(ye[X]=ye[J]),te!==-1&&ye[te]!==te&&(ye[X]=ye[te])),ie!==-1&&(ye[ie]=X),J!==-1&&X!=ye[X]&&(ye[J]=ye[X],Ee.lastIndexOf(J)<pe&&Ee.push(J)),te!==-1&&X!=ye[X]&&(ye[te]=ye[X],Ee.lastIndexOf(te)<pe&&Ee.push(te));for(X=1;X<le;++X)ye[X]===X&&(te!==-1&&ye[te]!==te?ye[X]=ye[te]:J!==-1&&ye[J]!==J&&(ye[X]=ye[J]));for(X=1;X<le;++X)if(L[X].type!==0){if(pe=X,pe!=ye[pe])do pe=ye[pe],ee[X]=ee[pe]+"/"+ee[X];while(pe!==0&&ye[pe]!==-1&&pe!=ye[pe]);ye[X]=-1}for(ee[0]+="/",X=1;X<le;++X)L[X].type!==2&&(ee[X]+="/")}function b(L,ee,K){for(var X=L.start,J=L.size,te=[],ie=X;K&&J>0&&ie>=0;)te.push(ee.slice(ie*F,ie*F+F)),J-=F,ie=Zl(K,ie*4);return te.length===0?Pr(0):ll(te).slice(0,L.size)}function S(L,ee,K,X,J){var te=oe;if(L===oe){if(ee!==0)throw new Error("DIFAT chain shorter than expected")}else if(L!==-1){var ie=K[L],pe=(X>>>2)-1;if(!ie)return;for(var le=0;le<pe&&(te=Zl(ie,le*4))!==oe;++le)J.push(te);S(Zl(ie,X-4),ee-1,K,X,J)}}function j(L,ee,K,X,J){var te=[],ie=[];J||(J=[]);var pe=X-1,le=0,ye=0;for(le=ee;le>=0;){J[le]=!0,te[te.length]=le,ie.push(L[le]);var Ee=K[Math.floor(le*4/X)];if(ye=le*4&pe,X<4+ye)throw new Error("FAT boundary crossed: "+le+" 4 "+X);if(!L[Ee])break;le=Zl(L[Ee],ye)}return{nodes:te,data:YA([ie])}}function _(L,ee,K,X){var J=L.length,te=[],ie=[],pe=[],le=[],ye=X-1,Ee=0,De=0,Ie=0,Ve=0;for(Ee=0;Ee<J;++Ee)if(pe=[],Ie=Ee+ee,Ie>=J&&(Ie-=J),!ie[Ie]){le=[];var He=[];for(De=Ie;De>=0;){He[De]=!0,ie[De]=!0,pe[pe.length]=De,le.push(L[De]);var Xe=K[Math.floor(De*4/X)];if(Ve=De*4&ye,X<4+Ve)throw new Error("FAT boundary crossed: "+De+" 4 "+X);if(!L[Xe]||(De=Zl(L[Xe],Ve),He[De]))break}te[Ie]={nodes:pe,data:YA([le])}}return te}function A(L,ee,K,X,J,te,ie,pe){for(var le=0,ye=X.length?2:0,Ee=ee[L].data,De=0,Ie=0,Ve;De<Ee.length;De+=128){var He=Ee.slice(De,De+128);Jr(He,64),Ie=He.read_shift(2),Ve=Xb(He,0,Ie-ye),X.push(Ve);var Xe={name:Ve,type:He.read_shift(1),color:He.read_shift(1),L:He.read_shift(4,"i"),R:He.read_shift(4,"i"),C:He.read_shift(4,"i"),clsid:He.read_shift(16),state:He.read_shift(4,"i"),start:0,size:0},st=He.read_shift(2)+He.read_shift(2)+He.read_shift(2)+He.read_shift(2);st!==0&&(Xe.ct=k(He,He.l-8));var pt=He.read_shift(2)+He.read_shift(2)+He.read_shift(2)+He.read_shift(2);pt!==0&&(Xe.mt=k(He,He.l-8)),Xe.start=He.read_shift(4,"i"),Xe.size=He.read_shift(4,"i"),Xe.size<0&&Xe.start<0&&(Xe.size=Xe.type=0,Xe.start=oe,Xe.name=""),Xe.type===5?(le=Xe.start,J>0&&le!==oe&&(ee[le].name="!StreamData")):Xe.size>=4096?(Xe.storage="fat",ee[Xe.start]===void 0&&(ee[Xe.start]=j(K,Xe.start,ee.fat_addrs,ee.ssz)),ee[Xe.start].name=Xe.name,Xe.content=ee[Xe.start].data.slice(0,Xe.size)):(Xe.storage="minifat",Xe.size<0?Xe.size=0:le!==oe&&Xe.start!==oe&&ee[le]&&(Xe.content=b(Xe,ee[le].data,(ee[pe]||{}).data))),Xe.content&&Jr(Xe.content,0),te[Ve]=Xe,ie.push(Xe)}}function k(L,ee){return new Date((sa(L,ee+4)/1e7*Math.pow(2,32)+sa(L,ee)/1e7-11644473600)*1e3)}function O(L,ee){return d(),m(h.readFileSync(L),ee)}function C(L,ee){var K=ee&&ee.type;switch(K||_t&&Buffer.isBuffer(L)&&(K="buffer"),K||"base64"){case"file":return O(L,ee);case"base64":return m(ii(da(L)),ee);case"binary":return m(ii(L),ee)}return m(L,ee)}function T(L,ee){var K=ee||{},X=K.root||"Root Entry";if(L.FullPaths||(L.FullPaths=[]),L.FileIndex||(L.FileIndex=[]),L.FullPaths.length!==L.FileIndex.length)throw new Error("inconsistent CFB structure");L.FullPaths.length===0&&(L.FullPaths[0]=X+"/",L.FileIndex[0]={name:X,type:5}),K.CLSID&&(L.FileIndex[0].clsid=K.CLSID),I(L)}function I(L){var ee="Sh33tJ5";if(!Ct.find(L,"/"+ee)){var K=Pr(4);K[0]=55,K[1]=K[3]=50,K[2]=54,L.FileIndex.push({name:ee,type:2,content:K,size:4,L:69,R:69,C:69}),L.FullPaths.push(L.FullPaths[0]+ee),M(L)}}function M(L,ee){T(L);for(var K=!1,X=!1,J=L.FullPaths.length-1;J>=0;--J){var te=L.FileIndex[J];switch(te.type){case 0:X?K=!0:(L.FileIndex.pop(),L.FullPaths.pop());break;case 1:case 2:case 5:X=!0,isNaN(te.R*te.L*te.C)&&(K=!0),te.R>-1&&te.L>-1&&te.R==te.L&&(K=!0);break;default:K=!0;break}}if(!(!K&&!ee)){var ie=new Date(1987,1,19),pe=0,le=Object.create?Object.create(null):{},ye=[];for(J=0;J<L.FullPaths.length;++J)le[L.FullPaths[J]]=!0,L.FileIndex[J].type!==0&&ye.push([L.FullPaths[J],L.FileIndex[J]]);for(J=0;J<ye.length;++J){var Ee=n(ye[J][0]);X=le[Ee],X||(ye.push([Ee,{name:a(Ee).replace("/",""),type:1,clsid:V,ct:ie,mt:ie,content:null}]),le[Ee]=!0)}for(ye.sort(function(Ve,He){return r(Ve[0],He[0])}),L.FullPaths=[],L.FileIndex=[],J=0;J<ye.length;++J)L.FullPaths[J]=ye[J][0],L.FileIndex[J]=ye[J][1];for(J=0;J<ye.length;++J){var De=L.FileIndex[J],Ie=L.FullPaths[J];if(De.name=a(Ie).replace("/",""),De.L=De.R=De.C=-(De.color=1),De.size=De.content?De.content.length:0,De.start=0,De.clsid=De.clsid||V,J===0)De.C=ye.length>1?1:-1,De.size=0,De.type=5;else if(Ie.slice(-1)=="/"){for(pe=J+1;pe<ye.length&&n(L.FullPaths[pe])!=Ie;++pe);for(De.C=pe>=ye.length?-1:pe,pe=J+1;pe<ye.length&&n(L.FullPaths[pe])!=n(Ie);++pe);De.R=pe>=ye.length?-1:pe,De.type=1}else n(L.FullPaths[J+1]||"")==n(Ie)&&(De.R=J+1),De.type=2}}}function W(L,ee){var K=ee||{};if(K.fileType=="mad")return wa(L,K);switch(M(L),K.fileType){case"zip":return ba(L,K)}var X=function(Ve){for(var He=0,Xe=0,st=0;st<Ve.FileIndex.length;++st){var pt=Ve.FileIndex[st];if(pt.content){var dt=pt.content.length;dt>0&&(dt<4096?He+=dt+63>>6:Xe+=dt+511>>9)}}for(var jt=Ve.FullPaths.length+3>>2,kr=He+7>>3,an=He+127>>7,jn=kr+Xe+jt+an,Nt=jn+127>>7,Vt=Nt<=109?0:Math.ceil((Nt-109)/127);jn+Nt+Vt+127>>7>Nt;)Vt=++Nt<=109?0:Math.ceil((Nt-109)/127);var sn=[1,Vt,Nt,an,jt,Xe,He,0];return Ve.FileIndex[0].size=He<<6,sn[7]=(Ve.FileIndex[0].start=sn[0]+sn[1]+sn[2]+sn[3]+sn[4]+sn[5])+(sn[6]+7>>3),sn}(L),J=Pr(X[7]<<9),te=0,ie=0;{for(te=0;te<8;++te)J.write_shift(1,ue[te]);for(te=0;te<8;++te)J.write_shift(2,0);for(J.write_shift(2,62),J.write_shift(2,3),J.write_shift(2,65534),J.write_shift(2,9),J.write_shift(2,6),te=0;te<3;++te)J.write_shift(2,0);for(J.write_shift(4,0),J.write_shift(4,X[2]),J.write_shift(4,X[0]+X[1]+X[2]+X[3]-1),J.write_shift(4,0),J.write_shift(4,4096),J.write_shift(4,X[3]?X[0]+X[1]+X[2]-1:oe),J.write_shift(4,X[3]),J.write_shift(-4,X[1]?X[0]-1:oe),J.write_shift(4,X[1]),te=0;te<109;++te)J.write_shift(-4,te<X[2]?X[1]+te:-1)}if(X[1])for(ie=0;ie<X[1];++ie){for(;te<236+ie*127;++te)J.write_shift(-4,te<X[2]?X[1]+te:-1);J.write_shift(-4,ie===X[1]-1?oe:ie+1)}var pe=function(Ve){for(ie+=Ve;te<ie-1;++te)J.write_shift(-4,te+1);Ve&&(++te,J.write_shift(-4,oe))};for(ie=te=0,ie+=X[1];te<ie;++te)J.write_shift(-4,H.DIFSECT);for(ie+=X[2];te<ie;++te)J.write_shift(-4,H.FATSECT);pe(X[3]),pe(X[4]);for(var le=0,ye=0,Ee=L.FileIndex[0];le<L.FileIndex.length;++le)Ee=L.FileIndex[le],Ee.content&&(ye=Ee.content.length,!(ye<4096)&&(Ee.start=ie,pe(ye+511>>9)));for(pe(X[6]+7>>3);J.l&511;)J.write_shift(-4,H.ENDOFCHAIN);for(ie=te=0,le=0;le<L.FileIndex.length;++le)Ee=L.FileIndex[le],Ee.content&&(ye=Ee.content.length,!(!ye||ye>=4096)&&(Ee.start=ie,pe(ye+63>>6)));for(;J.l&511;)J.write_shift(-4,H.ENDOFCHAIN);for(te=0;te<X[4]<<2;++te){var De=L.FullPaths[te];if(!De||De.length===0){for(le=0;le<17;++le)J.write_shift(4,0);for(le=0;le<3;++le)J.write_shift(4,-1);for(le=0;le<12;++le)J.write_shift(4,0);continue}Ee=L.FileIndex[te],te===0&&(Ee.start=Ee.size?Ee.start-1:oe);var Ie=te===0&&K.root||Ee.name;if(ye=2*(Ie.length+1),J.write_shift(64,Ie,"utf16le"),J.write_shift(2,ye),J.write_shift(1,Ee.type),J.write_shift(1,Ee.color),J.write_shift(-4,Ee.L),J.write_shift(-4,Ee.R),J.write_shift(-4,Ee.C),Ee.clsid)J.write_shift(16,Ee.clsid,"hex");else for(le=0;le<4;++le)J.write_shift(4,0);J.write_shift(4,Ee.state||0),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(4,Ee.start),J.write_shift(4,Ee.size),J.write_shift(4,0)}for(te=1;te<L.FileIndex.length;++te)if(Ee=L.FileIndex[te],Ee.size>=4096)if(J.l=Ee.start+1<<9,_t&&Buffer.isBuffer(Ee.content))Ee.content.copy(J,J.l,0,Ee.size),J.l+=Ee.size+511&-512;else{for(le=0;le<Ee.size;++le)J.write_shift(1,Ee.content[le]);for(;le&511;++le)J.write_shift(1,0)}for(te=1;te<L.FileIndex.length;++te)if(Ee=L.FileIndex[te],Ee.size>0&&Ee.size<4096)if(_t&&Buffer.isBuffer(Ee.content))Ee.content.copy(J,J.l,0,Ee.size),J.l+=Ee.size+63&-64;else{for(le=0;le<Ee.size;++le)J.write_shift(1,Ee.content[le]);for(;le&63;++le)J.write_shift(1,0)}if(_t)J.l=J.length;else for(;J.l<J.length;)J.write_shift(1,0);return J}function U(L,ee){var K=L.FullPaths.map(function(le){return le.toUpperCase()}),X=K.map(function(le){var ye=le.split("/");return ye[ye.length-(le.slice(-1)=="/"?2:1)]}),J=!1;ee.charCodeAt(0)===47?(J=!0,ee=K[0].slice(0,-1)+ee):J=ee.indexOf("/")!==-1;var te=ee.toUpperCase(),ie=J===!0?K.indexOf(te):X.indexOf(te);if(ie!==-1)return L.FileIndex[ie];var pe=!te.match(gf);for(te=te.replace(On,""),pe&&(te=te.replace(gf,"!")),ie=0;ie<K.length;++ie)if((pe?K[ie].replace(gf,"!"):K[ie]).replace(On,"")==te||(pe?X[ie].replace(gf,"!"):X[ie]).replace(On,"")==te)return L.FileIndex[ie];return null}var F=64,oe=-2,je="d0cf11e0a1b11ae1",ue=[208,207,17,224,161,177,26,225],V="00000000000000000000000000000000",H={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:oe,FREESECT:-1,HEADER_SIGNATURE:je,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:V,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Se(L,ee,K){d();var X=W(L,K);h.writeFileSync(ee,X)}function Q(L){for(var ee=new Array(L.length),K=0;K<L.length;++K)ee[K]=String.fromCharCode(L[K]);return ee.join("")}function z(L,ee){var K=W(L,ee);switch(ee&&ee.type||"buffer"){case"file":return d(),h.writeFileSync(ee.filename,K),K;case"binary":return typeof K=="string"?K:Q(K);case"base64":return OA(typeof K=="string"?K:Q(K));case"buffer":if(_t)return Buffer.isBuffer(K)?K:So(K);case"array":return typeof K=="string"?ii(K):K}return K}var Y;function P(L){try{var ee=L.InflateRaw,K=new ee;if(K._processChunk(new Uint8Array([3,0]),K._finishFlushFlag),K.bytesRead)Y=L;else throw new Error("zlib does not expose bytesRead")}catch(X){console.error("cannot use native zlib: "+(X.message||X))}}function q(L,ee){if(!Y)return Ro(L,ee);var K=Y.InflateRaw,X=new K,J=X._processChunk(L.slice(L.l),X._finishFlushFlag);return L.l+=X.bytesRead,J}function G(L){return Y?Y.deflateRawSync(L):xe(L)}var Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],fe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Oe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Re(L){var ee=(L<<1|L<<11)&139536|(L<<5|L<<15)&558144;return(ee>>16|ee>>8|ee)&255}for(var re=typeof Uint8Array<"u",be=re?new Uint8Array(256):[],Ae=0;Ae<256;++Ae)be[Ae]=Re(Ae);function D(L,ee){var K=be[L&255];return ee<=8?K>>>8-ee:(K=K<<8|be[L>>8&255],ee<=16?K>>>16-ee:(K=K<<8|be[L>>16&255],K>>>24-ee))}function Me(L,ee){var K=ee&7,X=ee>>>3;return(L[X]|(K<=6?0:L[X+1]<<8))>>>K&3}function ae(L,ee){var K=ee&7,X=ee>>>3;return(L[X]|(K<=5?0:L[X+1]<<8))>>>K&7}function de(L,ee){var K=ee&7,X=ee>>>3;return(L[X]|(K<=4?0:L[X+1]<<8))>>>K&15}function me(L,ee){var K=ee&7,X=ee>>>3;return(L[X]|(K<=3?0:L[X+1]<<8))>>>K&31}function ce(L,ee){var K=ee&7,X=ee>>>3;return(L[X]|(K<=1?0:L[X+1]<<8))>>>K&127}function ze(L,ee,K){var X=ee&7,J=ee>>>3,te=(1<<K)-1,ie=L[J]>>>X;return K<8-X||(ie|=L[J+1]<<8-X,K<16-X)||(ie|=L[J+2]<<16-X,K<24-X)||(ie|=L[J+3]<<24-X),ie&te}function Qe(L,ee,K){var X=ee&7,J=ee>>>3;return X<=5?L[J]|=(K&7)<<X:(L[J]|=K<<X&255,L[J+1]=(K&7)>>8-X),ee+3}function Ke(L,ee,K){var X=ee&7,J=ee>>>3;return K=(K&1)<<X,L[J]|=K,ee+1}function qe(L,ee,K){var X=ee&7,J=ee>>>3;return K<<=X,L[J]|=K&255,K>>>=8,L[J+1]=K,ee+8}function it(L,ee,K){var X=ee&7,J=ee>>>3;return K<<=X,L[J]|=K&255,K>>>=8,L[J+1]=K&255,L[J+2]=K>>>8,ee+16}function Je(L,ee){var K=L.length,X=2*K>ee?2*K:ee+5,J=0;if(K>=ee)return L;if(_t){var te=DA(X);if(L.copy)L.copy(te);else for(;J<L.length;++J)te[J]=L[J];return te}else if(re){var ie=new Uint8Array(X);if(ie.set)ie.set(L);else for(;J<K;++J)ie[J]=L[J];return ie}return L.length=X,L}function Fe(L){for(var ee=new Array(L),K=0;K<L;++K)ee[K]=0;return ee}function Ye(L,ee,K){var X=1,J=0,te=0,ie=0,pe=0,le=L.length,ye=re?new Uint16Array(32):Fe(32);for(te=0;te<32;++te)ye[te]=0;for(te=le;te<K;++te)L[te]=0;le=L.length;var Ee=re?new Uint16Array(le):Fe(le);for(te=0;te<le;++te)ye[J=L[te]]++,X<J&&(X=J),Ee[te]=0;for(ye[0]=0,te=1;te<=X;++te)ye[te+16]=pe=pe+ye[te-1]<<1;for(te=0;te<le;++te)pe=L[te],pe!=0&&(Ee[te]=ye[pe+16]++);var De=0;for(te=0;te<le;++te)if(De=L[te],De!=0)for(pe=D(Ee[te],X)>>X-De,ie=(1<<X+4-De)-1;ie>=0;--ie)ee[pe|ie<<De]=De&15|te<<4;return X}var ge=re?new Uint16Array(512):Fe(512),Ge=re?new Uint16Array(32):Fe(32);if(!re){for(var ve=0;ve<512;++ve)ge[ve]=0;for(ve=0;ve<32;++ve)Ge[ve]=0}(function(){for(var L=[],ee=0;ee<32;ee++)L.push(5);Ye(L,Ge,32);var K=[];for(ee=0;ee<=143;ee++)K.push(8);for(;ee<=255;ee++)K.push(9);for(;ee<=279;ee++)K.push(7);for(;ee<=287;ee++)K.push(8);Ye(K,ge,288)})();var ne=function(){for(var ee=re?new Uint8Array(32768):[],K=0,X=0;K<Oe.length-1;++K)for(;X<Oe[K+1];++X)ee[X]=K;for(;X<32768;++X)ee[X]=29;var J=re?new Uint8Array(259):[];for(K=0,X=0;K<fe.length-1;++K)for(;X<fe[K+1];++X)J[X]=K;function te(pe,le){for(var ye=0;ye<pe.length;){var Ee=Math.min(65535,pe.length-ye),De=ye+Ee==pe.length;for(le.write_shift(1,+De),le.write_shift(2,Ee),le.write_shift(2,~Ee&65535);Ee-- >0;)le[le.l++]=pe[ye++]}return le.l}function ie(pe,le){for(var ye=0,Ee=0,De=re?new Uint16Array(32768):[];Ee<pe.length;){var Ie=Math.min(65535,pe.length-Ee);if(Ie<10){for(ye=Qe(le,ye,+(Ee+Ie==pe.length)),ye&7&&(ye+=8-(ye&7)),le.l=ye/8|0,le.write_shift(2,Ie),le.write_shift(2,~Ie&65535);Ie-- >0;)le[le.l++]=pe[Ee++];ye=le.l*8;continue}ye=Qe(le,ye,+(Ee+Ie==pe.length)+2);for(var Ve=0;Ie-- >0;){var He=pe[Ee];Ve=(Ve<<5^He)&32767;var Xe=-1,st=0;if((Xe=De[Ve])&&(Xe|=Ee&-32768,Xe>Ee&&(Xe-=32768),Xe<Ee))for(;pe[Xe+st]==pe[Ee+st]&&st<250;)++st;if(st>2){He=J[st],He<=22?ye=qe(le,ye,be[He+1]>>1)-1:(qe(le,ye,3),ye+=5,qe(le,ye,be[He-23]>>5),ye+=3);var pt=He<8?0:He-4>>2;pt>0&&(it(le,ye,st-fe[He]),ye+=pt),He=ee[Ee-Xe],ye=qe(le,ye,be[He]>>3),ye-=3;var dt=He<4?0:He-2>>1;dt>0&&(it(le,ye,Ee-Xe-Oe[He]),ye+=dt);for(var jt=0;jt<st;++jt)De[Ve]=Ee&32767,Ve=(Ve<<5^pe[Ee])&32767,++Ee;Ie-=st-1}else He<=143?He=He+48:ye=Ke(le,ye,1),ye=qe(le,ye,be[He]),De[Ve]=Ee&32767,++Ee}ye=qe(le,ye,0)-1}return le.l=(ye+7)/8|0,le.l}return function(le,ye){return le.length<8?te(le,ye):ie(le,ye)}}();function xe(L){var ee=Pr(50+Math.floor(L.length*1.1)),K=ne(L,ee);return ee.slice(0,K)}var Be=re?new Uint16Array(32768):Fe(32768),Ze=re?new Uint16Array(32768):Fe(32768),tt=re?new Uint16Array(128):Fe(128),At=1,nn=1;function En(L,ee){var K=me(L,ee)+257;ee+=5;var X=me(L,ee)+1;ee+=5;var J=de(L,ee)+4;ee+=4;for(var te=0,ie=re?new Uint8Array(19):Fe(19),pe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],le=1,ye=re?new Uint8Array(8):Fe(8),Ee=re?new Uint8Array(8):Fe(8),De=ie.length,Ie=0;Ie<J;++Ie)ie[Z[Ie]]=te=ae(L,ee),le<te&&(le=te),ye[te]++,ee+=3;var Ve=0;for(ye[0]=0,Ie=1;Ie<=le;++Ie)Ee[Ie]=Ve=Ve+ye[Ie-1]<<1;for(Ie=0;Ie<De;++Ie)(Ve=ie[Ie])!=0&&(pe[Ie]=Ee[Ve]++);var He=0;for(Ie=0;Ie<De;++Ie)if(He=ie[Ie],He!=0){Ve=be[pe[Ie]]>>8-He;for(var Xe=(1<<7-He)-1;Xe>=0;--Xe)tt[Ve|Xe<<He]=He&7|Ie<<3}var st=[];for(le=1;st.length<K+X;)switch(Ve=tt[ce(L,ee)],ee+=Ve&7,Ve>>>=3){case 16:for(te=3+Me(L,ee),ee+=2,Ve=st[st.length-1];te-- >0;)st.push(Ve);break;case 17:for(te=3+ae(L,ee),ee+=3;te-- >0;)st.push(0);break;case 18:for(te=11+ce(L,ee),ee+=7;te-- >0;)st.push(0);break;default:st.push(Ve),le<Ve&&(le=Ve);break}var pt=st.slice(0,K),dt=st.slice(K);for(Ie=K;Ie<286;++Ie)pt[Ie]=0;for(Ie=X;Ie<30;++Ie)dt[Ie]=0;return At=Ye(pt,Be,286),nn=Ye(dt,Ze,30),ee}function xi(L,ee){if(L[0]==3&&!(L[1]&3))return[pl(ee),2];for(var K=0,X=0,J=DA(ee||1<<18),te=0,ie=J.length>>>0,pe=0,le=0;(X&1)==0;){if(X=ae(L,K),K+=3,X>>>1)X>>1==1?(pe=9,le=5):(K=En(L,K),pe=At,le=nn);else{K&7&&(K+=8-(K&7));var ye=L[K>>>3]|L[(K>>>3)+1]<<8;if(K+=32,ye>0)for(!ee&&ie<te+ye&&(J=Je(J,te+ye),ie=J.length);ye-- >0;)J[te++]=L[K>>>3],K+=8;continue}for(;;){!ee&&ie<te+32767&&(J=Je(J,te+32767),ie=J.length);var Ee=ze(L,K,pe),De=X>>>1==1?ge[Ee]:Be[Ee];if(K+=De&15,De>>>=4,(De>>>8&255)===0)J[te++]=De;else{if(De==256)break;De-=257;var Ie=De<8?0:De-4>>2;Ie>5&&(Ie=0);var Ve=te+fe[De];Ie>0&&(Ve+=ze(L,K,Ie),K+=Ie),Ee=ze(L,K,le),De=X>>>1==1?Ge[Ee]:Ze[Ee],K+=De&15,De>>>=4;var He=De<4?0:De-2>>1,Xe=Oe[De];for(He>0&&(Xe+=ze(L,K,He),K+=He),!ee&&ie<Ve&&(J=Je(J,Ve+100),ie=J.length);te<Ve;)J[te]=J[te-Xe],++te}}}return ee?[J,K+7>>>3]:[J.slice(0,te),K+7>>>3]}function Ro(L,ee){var K=L.slice(L.l||0),X=xi(K,ee);return L.l+=X[1],X[0]}function As(L,ee){if(L)typeof console<"u"&&console.error(ee);else throw new Error(ee)}function _s(L,ee){var K=L;Jr(K,0);var X=[],J=[],te={FileIndex:X,FullPaths:J};T(te,{root:ee.root});for(var ie=K.length-4;(K[ie]!=80||K[ie+1]!=75||K[ie+2]!=5||K[ie+3]!=6)&&ie>=0;)--ie;K.l=ie+4,K.l+=4;var pe=K.read_shift(2);K.l+=6;var le=K.read_shift(4);for(K.l=le,ie=0;ie<pe;++ie){K.l+=20;var ye=K.read_shift(4),Ee=K.read_shift(4),De=K.read_shift(2),Ie=K.read_shift(2),Ve=K.read_shift(2);K.l+=8;var He=K.read_shift(4),Xe=u(K.slice(K.l+De,K.l+De+Ie));K.l+=De+Ie+Ve;var st=K.l;K.l=He+4,Ts(K,ye,Ee,te,Xe),K.l=st}return te}function Ts(L,ee,K,X,J){L.l+=2;var te=L.read_shift(2),ie=L.read_shift(2),pe=l(L);if(te&8257)throw new Error("Unsupported ZIP encryption");for(var le=L.read_shift(4),ye=L.read_shift(4),Ee=L.read_shift(4),De=L.read_shift(2),Ie=L.read_shift(2),Ve="",He=0;He<De;++He)Ve+=String.fromCharCode(L[L.l++]);if(Ie){var Xe=u(L.slice(L.l,L.l+Ie));(Xe[21589]||{}).mt&&(pe=Xe[21589].mt),((J||{})[21589]||{}).mt&&(pe=J[21589].mt)}L.l+=Ie;var st=L.slice(L.l,L.l+ye);switch(ie){case 8:st=q(L,Ee);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ie)}var pt=!1;te&8&&(le=L.read_shift(4),le==134695760&&(le=L.read_shift(4),pt=!0),ye=L.read_shift(4),Ee=L.read_shift(4)),ye!=ee&&As(pt,"Bad compressed size: "+ee+" != "+ye),Ee!=K&&As(pt,"Bad uncompressed size: "+K+" != "+Ee),gr(X,Ve,st,{unsafe:!0,mt:pe})}function ba(L,ee){var K=ee||{},X=[],J=[],te=Pr(1),ie=K.compression?8:0,pe=0,le=0,ye=0,Ee=0,De=0,Ie=L.FullPaths[0],Ve=Ie,He=L.FileIndex[0],Xe=[],st=0;for(le=1;le<L.FullPaths.length;++le)if(Ve=L.FullPaths[le].slice(Ie.length),He=L.FileIndex[le],!(!He.size||!He.content||Ve=="Sh33tJ5")){var pt=Ee,dt=Pr(Ve.length);for(ye=0;ye<Ve.length;++ye)dt.write_shift(1,Ve.charCodeAt(ye)&127);dt=dt.slice(0,dt.l),Xe[De]=g9.buf(He.content,0);var jt=He.content;ie==8&&(jt=G(jt)),te=Pr(30),te.write_shift(4,67324752),te.write_shift(2,20),te.write_shift(2,pe),te.write_shift(2,ie),He.mt?i(te,He.mt):te.write_shift(4,0),te.write_shift(-4,Xe[De]),te.write_shift(4,jt.length),te.write_shift(4,He.content.length),te.write_shift(2,dt.length),te.write_shift(2,0),Ee+=te.length,X.push(te),Ee+=dt.length,X.push(dt),Ee+=jt.length,X.push(jt),te=Pr(46),te.write_shift(4,33639248),te.write_shift(2,0),te.write_shift(2,20),te.write_shift(2,pe),te.write_shift(2,ie),te.write_shift(4,0),te.write_shift(-4,Xe[De]),te.write_shift(4,jt.length),te.write_shift(4,He.content.length),te.write_shift(2,dt.length),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(4,0),te.write_shift(4,pt),st+=te.l,J.push(te),st+=dt.length,J.push(dt),++De}return te=Pr(22),te.write_shift(4,101010256),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(2,De),te.write_shift(2,De),te.write_shift(4,st),te.write_shift(4,Ee),te.write_shift(2,0),ll([ll(X),ll(J),te])}var Gn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function _l(L,ee){if(L.ctype)return L.ctype;var K=L.name||"",X=K.match(/\.([^\.]+)$/);return X&&Gn[X[1]]||ee&&(X=(K=ee).match(/[\.\\]([^\.\\])+$/),X&&Gn[X[1]])?Gn[X[1]]:"application/octet-stream"}function Tl(L){for(var ee=OA(L),K=[],X=0;X<ee.length;X+=76)K.push(ee.slice(X,X+76));return K.join(`\r
`)+`\r
`}function ks(L){var ee=L.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ye){var Ee=ye.charCodeAt(0).toString(16).toUpperCase();return"="+(Ee.length==1?"0"+Ee:Ee)});ee=ee.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ee.charAt(0)==`
`&&(ee="=0D"+ee.slice(1)),ee=ee.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var K=[],X=ee.split(`\r
`),J=0;J<X.length;++J){var te=X[J];if(te.length==0){K.push("");continue}for(var ie=0;ie<te.length;){var pe=76,le=te.slice(ie,ie+pe);le.charAt(pe-1)=="="?pe--:le.charAt(pe-2)=="="?pe-=2:le.charAt(pe-3)=="="&&(pe-=3),le=te.slice(ie,ie+pe),ie+=pe,ie<te.length&&(le+="="),K.push(le)}}return K.join(`\r
`)}function kl(L){for(var ee=[],K=0;K<L.length;++K){for(var X=L[K];K<=L.length&&X.charAt(X.length-1)=="=";)X=X.slice(0,X.length-1)+L[++K];ee.push(X)}for(var J=0;J<ee.length;++J)ee[J]=ee[J].replace(/[=][0-9A-Fa-f]{2}/g,function(te){return String.fromCharCode(parseInt(te.slice(1),16))});return ii(ee.join(`\r
`))}function Cl(L,ee,K){for(var X="",J="",te="",ie,pe=0;pe<10;++pe){var le=ee[pe];if(!le||le.match(/^\s*$/))break;var ye=le.match(/^(.*?):\s*([^\s].*)$/);if(ye)switch(ye[1].toLowerCase()){case"content-location":X=ye[2].trim();break;case"content-type":te=ye[2].trim();break;case"content-transfer-encoding":J=ye[2].trim();break}}switch(++pe,J.toLowerCase()){case"base64":ie=ii(da(ee.slice(pe).join("")));break;case"quoted-printable":ie=kl(ee.slice(pe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+J)}var Ee=gr(L,X.slice(K.length),ie,{unsafe:!0});te&&(Ee.ctype=te)}function Cs(L,ee){if(Q(L.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var K=ee&&ee.root||"",X=(_t&&Buffer.isBuffer(L)?L.toString("binary"):Q(L)).split(`\r
`),J=0,te="";for(J=0;J<X.length;++J)if(te=X[J],!!/^Content-Location:/i.test(te)&&(te=te.slice(te.indexOf("file")),K||(K=te.slice(0,te.lastIndexOf("/")+1)),te.slice(0,K.length)!=K))for(;K.length>0&&(K=K.slice(0,K.length-1),K=K.slice(0,K.lastIndexOf("/")+1),te.slice(0,K.length)!=K););var ie=(X[1]||"").match(/boundary="(.*?)"/);if(!ie)throw new Error("MAD cannot find boundary");var pe="--"+(ie[1]||""),le=[],ye=[],Ee={FileIndex:le,FullPaths:ye};T(Ee);var De,Ie=0;for(J=0;J<X.length;++J){var Ve=X[J];Ve!==pe&&Ve!==pe+"--"||(Ie++&&Cl(Ee,X.slice(De,J),K),De=J)}return Ee}function wa(L,ee){var K=ee||{},X=K.boundary||"SheetJS";X="------="+X;for(var J=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+X.slice(2)+'"',"","",""],te=L.FullPaths[0],ie=te,pe=L.FileIndex[0],le=1;le<L.FullPaths.length;++le)if(ie=L.FullPaths[le].slice(te.length),pe=L.FileIndex[le],!(!pe.size||!pe.content||ie=="Sh33tJ5")){ie=ie.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(st){return"_x"+st.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(st){return"_u"+st.charCodeAt(0).toString(16)+"_"});for(var ye=pe.content,Ee=_t&&Buffer.isBuffer(ye)?ye.toString("binary"):Q(ye),De=0,Ie=Math.min(1024,Ee.length),Ve=0,He=0;He<=Ie;++He)(Ve=Ee.charCodeAt(He))>=32&&Ve<128&&++De;var Xe=De>=Ie*4/5;J.push(X),J.push("Content-Location: "+(K.root||"file:///C:/SheetJS/")+ie),J.push("Content-Transfer-Encoding: "+(Xe?"quoted-printable":"base64")),J.push("Content-Type: "+_l(pe,ie)),J.push(""),J.push(Xe?ks(Ee):Tl(Ee))}return J.push(X+`--\r
`),J.join(`\r
`)}function vr(L){var ee={};return T(ee,L),ee}function gr(L,ee,K,X){var J=X&&X.unsafe;J||T(L);var te=!J&&Ct.find(L,ee);if(!te){var ie=L.FullPaths[0];ee.slice(0,ie.length)==ie?ie=ee:(ie.slice(-1)!="/"&&(ie+="/"),ie=(ie+ee).replace("//","/")),te={name:a(ee),type:2},L.FileIndex.push(te),L.FullPaths.push(ie),J||Ct.utils.cfb_gc(L)}return te.content=K,te.size=K?K.length:0,X&&(X.CLSID&&(te.clsid=X.CLSID),X.mt&&(te.mt=X.mt),X.ct&&(te.ct=X.ct)),te}function vi(L,ee){T(L);var K=Ct.find(L,ee);if(K){for(var X=0;X<L.FileIndex.length;++X)if(L.FileIndex[X]==K)return L.FileIndex.splice(X,1),L.FullPaths.splice(X,1),!0}return!1}function Ol(L,ee,K){T(L);var X=Ct.find(L,ee);if(X){for(var J=0;J<L.FileIndex.length;++J)if(L.FileIndex[J]==X)return L.FileIndex[J].name=a(K),L.FullPaths[J]=K,!0}return!1}function cu(L){M(L,!0)}return t.find=U,t.read=C,t.parse=m,t.write=z,t.writeFile=Se,t.utils={cfb_new:vr,cfb_add:gr,cfb_del:vi,cfb_mov:Ol,cfb_gc:cu,ReadShift:Af,CheckField:LO,prep_blob:Jr,bconcat:ll,use_zlib:P,_deflateRaw:xe,_inflateRaw:Ro,consts:H},t}();function y9(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function xl(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Gb(e){for(var t=[],r=xl(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var zh=new Date(1899,11,30,0,0,0);function ha(e,t){var r=e.getTime(),n=zh.getTime()+(e.getTimezoneOffset()-zh.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var vO=new Date,b9=zh.getTime()+(vO.getTimezoneOffset()-zh.getTimezoneOffset())*6e4,UA=vO.getTimezoneOffset();function Ym(e){var t=new Date;return t.setTime(e*24*60*60*1e3+b9),t.getTimezoneOffset()!==UA&&t.setTime(t.getTime()+(t.getTimezoneOffset()-UA)*6e4),t}function w9(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[i],10)}return t}var $A=new Date("2017-02-19T19:06:09.000Z"),gO=isNaN($A.getFullYear())?new Date("2/19/17"):$A,S9=gO.getFullYear()==2017;function en(e,t){var r=new Date(e);if(S9)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(gO.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function xo(e,t){if(_t&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return bf(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return bf(aO(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return bf(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return bf(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function tn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=tn(e[r]));return t}function ur(e,t){for(var r="";r.length<t;)r+=e;return r}function ls(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var E9=["january","february","march","april","may","june","july","august","september","october","november","december"];function qf(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&E9.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var j9=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var i=r.split(n),l=[i[0]],u=1;u<i.length;++u)l.push(a),l.push(i[u]);return l}}();function yO(e){return e?e.content&&e.type?xo(e.content,!0):e.data?vf(e.data):e.asNodeBuffer&&_t?vf(e.asNodeBuffer().toString("binary")):e.asBinary?vf(e.asBinary()):e._data&&e._data.getContent?vf(xo(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function bO(e){if(!e)return null;if(e.data)return kA(e.data);if(e.asNodeBuffer&&_t)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?kA(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function N9(e){return e&&e.name.slice(-4)===".bin"?bO(e):yO(e)}function Ia(e,t){for(var r=e.FullPaths||xl(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var l=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==l||a==l)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function Wb(e,t){var r=Ia(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Er(e,t,r){if(!r)return N9(Wb(e,t));if(!t)return null;try{return Er(e,t)}catch{return null}}function oa(e,t,r){if(!r)return yO(Wb(e,t));if(!t)return null;try{return oa(e,t)}catch{return null}}function A9(e,t,r){return bO(Wb(e,t))}function zA(e){for(var t=e.FullPaths||xl(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function _9(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return _t?n=So(r):n=KB(r),Ct.utils.cfb_add(e,t,n)}Ct.utils.cfb_add(e,t,r)}else e.file(t,r)}function wO(e,t){switch(t.type){case"base64":return Ct.read(e,{type:"base64"});case"binary":return Ct.read(e,{type:"binary"});case"buffer":case"array":return Ct.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function yf(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var SO=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,T9=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,HA=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,k9=/<[^>]*>/g,wn=SO.match(HA)?HA:k9,C9=/<\w*:/,O9=/<(\/?)\w+:/;function ft(e,t,r){for(var n={},a=0,i=0;a!==e.length&&!((i=e.charCodeAt(a))===32||i===10||i===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var l=e.match(T9),u=0,h="",d=0,m="",p="",v=1;if(l)for(d=0;d!=l.length;++d){for(p=l[d],i=0;i!=p.length&&p.charCodeAt(i)!==61;++i);for(m=p.slice(0,i).trim();p.charCodeAt(i+1)==32;)++i;for(v=(a=p.charCodeAt(i+1))==34||a==39?1:0,h=p.slice(i+1+v,p.length-v),u=0;u!=m.length&&m.charCodeAt(u)!==58;++u);if(u===m.length)m.indexOf("_")>0&&(m=m.slice(0,m.indexOf("_"))),n[m]=h,n[m.toLowerCase()]=h;else{var g=(u===5&&m.slice(0,5)==="xmlns"?"xmlns":"")+m.slice(u+1);if(n[g]&&m.slice(u-3,u)=="ext")continue;n[g]=h,n[g.toLowerCase()]=h}}return n}function Ii(e){return e.replace(O9,"<$1")}var EO={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},D9=Gb(EO),Dt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(e,function(u,h){return EO[u]||String.fromCharCode(parseInt(h,u.indexOf("x")>-1?16:10))||u}).replace(t,function(u,h){return String.fromCharCode(parseInt(h,16))});var l=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,l)+r(a.slice(l+3))}}(),P9=/[&<>'"]/g,R9=/[\u0000-\u001f]/g;function jO(e){var t=e+"";return t.replace(P9,function(r){return D9[r]}).replace(/\n/g,"<br/>").replace(R9,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var qA=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function tr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ug(e){for(var t="",r=0,n=0,a=0,i=0,l=0,u=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){l=(n&31)<<6,l|=a&63,t+=String.fromCharCode(l);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}l=e.charCodeAt(r++),u=((n&7)<<18|(a&63)<<12|(i&63)<<6|l&63)-65536,t+=String.fromCharCode(55296+(u>>>10&1023)),t+=String.fromCharCode(56320+(u&1023))}return t}function VA(e){var t=pl(2*e.length),r,n,a=1,i=0,l=0,u;for(n=0;n<e.length;n+=a)a=1,(u=e.charCodeAt(n))<128?r=u:u<224?(r=(u&31)*64+(e.charCodeAt(n+1)&63),a=2):u<240?(r=(u&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(u&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(t[i++]=l&255,t[i++]=l>>>8,l=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function KA(e){return So(e,"binary").toString("utf8")}var eh="foo bar baz",Zt=_t&&(KA(eh)==ug(eh)&&KA||VA(eh)==ug(eh)&&VA)||ug,bf=_t?function(e){return So(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Vf=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),M9=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),F9=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),I9=/<\/?(?:vt:)?variant>/g,L9=/<(?:vt:)([^>]*)>([\s\S]*)</;function GA(e,t){var r=ft(e),n=e.match(F9(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(i){var l=i.replace(I9,"").match(L9);l&&a.push({v:Zt(l[2]),t:l[1]})}),a}function Yb(e){if(_t&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Zt(Eo(qb(e)));throw new Error("Bad input format: expected Buffer or string")}var Kf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,B9={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},U9=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function $9(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function z9(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,l=n?-t:t;isFinite(l)?l==0?a=i=0:(a=Math.floor(Math.log(l)/Math.LN2),i=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var u=0;u<=5;++u,i/=256)e[r+u]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var WA=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},YA=_t?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:So(t)})):WA(e)}:WA,XA=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(rs(e,a)));return n.join("").replace(On,"")},Xb=_t?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(On,""):XA(e,t,r)}:XA,ZA=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},NO=_t?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):ZA(e,t,r)}:ZA,QA=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(bc(e,a)));return n.join("")},hd=_t?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):QA(t,r,n)}:QA,AO=function(e,t){var r=sa(e,t);return r>0?hd(e,t+4,t+4+r-1):""},_O=AO,TO=function(e,t){var r=sa(e,t);return r>0?hd(e,t+4,t+4+r-1):""},kO=TO,CO=function(e,t){var r=2*sa(e,t);return r>0?hd(e,t+4,t+4+r-1):""},OO=CO,DO=function(t,r){var n=sa(t,r);return n>0?Xb(t,r+4,r+4+n):""},PO=DO,RO=function(e,t){var r=sa(e,t);return r>0?hd(e,t+4,t+4+r):""},MO=RO,FO=function(e,t){return $9(e,t)},Hh=FO,IO=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};_t&&(_O=function(t,r){if(!Buffer.isBuffer(t))return AO(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},kO=function(t,r){if(!Buffer.isBuffer(t))return TO(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},OO=function(t,r){if(!Buffer.isBuffer(t))return CO(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},PO=function(t,r){if(!Buffer.isBuffer(t))return DO(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},MO=function(t,r){if(!Buffer.isBuffer(t))return RO(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Hh=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):FO(t,r)},IO=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var bc=function(e,t){return e[t]},rs=function(e,t){return e[t+1]*256+e[t]},H9=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},sa=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Zl=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},q9=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Af(e,t){var r="",n,a,i=[],l,u,h,d;switch(t){case"dbcs":if(d=this.l,_t&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(h=0;h<e;++h)r+=String.fromCharCode(rs(this,d)),d+=2;e*=2;break;case"utf8":r=hd(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Xb(this,this.l,this.l+e);break;case"wstr":return Af.call(this,e,"dbcs");case"lpstr-ansi":r=_O(this,this.l),e=4+sa(this,this.l);break;case"lpstr-cp":r=kO(this,this.l),e=4+sa(this,this.l);break;case"lpwstr":r=OO(this,this.l),e=4+2*sa(this,this.l);break;case"lpp4":e=4+sa(this,this.l),r=PO(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+sa(this,this.l),r=MO(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(l=bc(this,this.l+e++))!==0;)i.push(J0(l));r=i.join("");break;case"_wstr":for(e=0,r="";(l=rs(this,this.l+e))!==0;)i.push(J0(l)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",d=this.l,h=0;h<e;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return l=bc(this,d),this.l=d+1,u=Af.call(this,e-h,l?"dbcs-cont":"sbcs-cont"),i.join("")+u;i.push(J0(rs(this,d))),d+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,h=0;h!=e;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return l=bc(this,d),this.l=d+1,u=Af.call(this,e-h,l?"dbcs-cont":"sbcs-cont"),i.join("")+u;i.push(J0(bc(this,d))),d+=1}r=i.join("");break;default:switch(e){case 1:return n=bc(this,this.l),this.l++,n;case 2:return n=(t==="i"?H9:rs)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?Zl:q9)(this,this.l),this.l+=4,n):(a=sa(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=Hh(this,this.l):a=Hh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=NO(this,this.l,e);break}}return this.l+=e,r}var V9=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},K9=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},G9=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function W9(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)G9(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var l=t.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,V9(this,t,this.l);break;case 8:if(n=8,r==="f"){z9(this,t,this.l);break}case 16:break;case-4:n=4,K9(this,t,this.l);break}return this.l+=n,this}function LO(e,t){var r=NO(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Jr(e,t){e.l=t,e.read_shift=Af,e.chk=LO,e.write_shift=W9}function bn(e,t){e.l+=t}function Pr(e){var t=pl(e);return Jr(t,0),t}function vs(e,t,r){if(e){var n,a,i;Jr(e,e.l||0);for(var l=e.length,u=0,h=0;e.l<l;){u=e.read_shift(1),u&128&&(u=(u&127)+((e.read_shift(1)&127)<<7));var d=Yh[u]||Yh[65535];for(n=e.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=e.read_shift(1))&127)<<7*a;h=e.l+i;var m=d.f&&d.f(e,i,r);if(e.l=h,t(m,d,u))return}}}function yy(){var e=[],t=_t?256:2048,r=function(d){var m=Pr(d);return Jr(m,0),m},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(d){return n&&d<n.length-n.l?n:(a(),n=r(Math.max(d+1,t)))},l=function(){return a(),ll(e)},u=function(d){a(),n=d,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:u,end:l,_bufs:e}}function _f(e,t,r){var n=tn(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function JA(e,t,r){var n=tn(e);return n.s=_f(n.s,t.s,r),n.e=_f(n.e,t.s,r),n}function Tf(e,t){if(e.cRel&&e.c<0)for(e=tn(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=tn(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=wt(e);return!e.cRel&&e.cRel!=null&&(r=Z9(r)),!e.rRel&&e.rRel!=null&&(r=Y9(r)),r}function fg(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+kn(e.s.c)+":"+(e.e.cRel?"":"$")+kn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+ua(e.s.r)+":"+(e.e.rRel?"":"$")+ua(e.e.r):Tf(e.s,t.biff)+":"+Tf(e.e,t.biff)}function BO(e){return parseInt(X9(e),10)-1}function ua(e){return""+(e+1)}function Y9(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function X9(e){return e.replace(/\$(\d+)$/,"$1")}function UO(e){for(var t=Q9(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function kn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Z9(e){return e.replace(/^([A-Z])/,"$$$1")}function Q9(e){return e.replace(/^\$([A-Z])/,"$1")}function ui(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function wt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Zb(e){var t=e.indexOf(":");return t==-1?{s:ui(e),e:ui(e)}:{s:ui(e.slice(0,t)),e:ui(e.slice(t+1))}}function Ut(e,t){return typeof t>"u"||typeof t=="number"?Ut(e.s,e.e):(typeof e!="string"&&(e=wt(e)),typeof t!="string"&&(t=wt(t)),e==t?e:e+":"+t)}function qr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function e_(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Ha(e.z,r?ha(t):t)}catch{}try{return e.w=Ha((e.XF||{}).numFmtId||(r?14:0),r?ha(t):t)}catch{return""+t}}function Oc(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?_o[e.v]||e.v:t==null?e_(e,e.v):e_(e,t))}function jo(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function J9(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),l=0,u=0;if(i&&n.origin!=null){if(typeof n.origin=="number")l=n.origin;else{var h=typeof n.origin=="string"?ui(n.origin):n.origin;l=h.r,u=h.c}i["!ref"]||(i["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var m=qr(i["!ref"]);d.s.c=m.s.c,d.s.r=m.s.r,d.e.c=Math.max(d.e.c,m.e.c),d.e.r=Math.max(d.e.r,m.e.r),l==-1&&(d.e.r=l=m.e.r+1)}for(var p=0;p!=t.length;++p)if(t[p]){if(!Array.isArray(t[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var v=0;v!=t[p].length;++v)if(!(typeof t[p][v]>"u")){var g={v:t[p][v]},w=l+p,b=u+v;if(d.s.r>w&&(d.s.r=w),d.s.c>b&&(d.s.c=b),d.e.r<w&&(d.e.r=w),d.e.c<b&&(d.e.c=b),t[p][v]&&typeof t[p][v]=="object"&&!Array.isArray(t[p][v])&&!(t[p][v]instanceof Date))g=t[p][v];else if(Array.isArray(g.v)&&(g.f=t[p][v][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(n.nullError)g.t="e",g.v=0;else if(n.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=n.dateNF||xt[14],n.cellDates?(g.t="d",g.w=Ha(g.z,ha(g.v))):(g.t="n",g.v=ha(g.v),g.w=Ha(g.z,g.v))):g.t="s";if(a)i[w]||(i[w]=[]),i[w][b]&&i[w][b].z&&(g.z=i[w][b].z),i[w][b]=g;else{var S=wt({c:b,r:w});i[S]&&i[S].z&&(g.z=i[S].z),i[S]=g}}}return d.s.c<1e7&&(i["!ref"]=Ut(d)),i}function md(e,t){return J9(null,e,t)}function eU(e){return e.read_shift(4,"i")}function yn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function tU(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Qb(e,t){var r=e.l,n=e.read_shift(1),a=yn(e),i=[],l={t:a,h:a};if((n&1)!==0){for(var u=e.read_shift(4),h=0;h!=u;++h)i.push(tU(e));l.r=i}else l.r=[{ich:0,ifnt:0}];return e.l=r+t,l}var rU=Qb;function Ya(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function No(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var nU=yn;function Jb(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var aU=yn,by=Jb;function e2(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?Hh([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Zl(t,0)>>2;return r?a/100:a}function $O(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Ao=$O;function vn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function iU(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),l=e.read_shift(1),u=e.read_shift(1),h=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var d=oo[a];d&&(t.rgb=Wf(d));break;case 2:t.rgb=Wf([l,u,h]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function sU(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function zO(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function lU(e){return zO(e,1)}function oU(e){return zO(e,2)}var t2=2,Ln=3,th=11,t_=12,qh=19,rh=64,cU=65,uU=71,fU=4108,dU=4126,$r=80,HO=81,hU=[$r,HO],mU={1:{n:"CodePage",t:t2},2:{n:"Category",t:$r},3:{n:"PresentationFormat",t:$r},4:{n:"ByteCount",t:Ln},5:{n:"LineCount",t:Ln},6:{n:"ParagraphCount",t:Ln},7:{n:"SlideCount",t:Ln},8:{n:"NoteCount",t:Ln},9:{n:"HiddenCount",t:Ln},10:{n:"MultimediaClipCount",t:Ln},11:{n:"ScaleCrop",t:th},12:{n:"HeadingPairs",t:fU},13:{n:"TitlesOfParts",t:dU},14:{n:"Manager",t:$r},15:{n:"Company",t:$r},16:{n:"LinksUpToDate",t:th},17:{n:"CharacterCount",t:Ln},19:{n:"SharedDoc",t:th},22:{n:"HyperlinksChanged",t:th},23:{n:"AppVersion",t:Ln,p:"version"},24:{n:"DigSig",t:cU},26:{n:"ContentType",t:$r},27:{n:"ContentStatus",t:$r},28:{n:"Language",t:$r},29:{n:"Version",t:$r},255:{},2147483648:{n:"Locale",t:qh},2147483651:{n:"Behavior",t:qh},1919054434:{}},pU={1:{n:"CodePage",t:t2},2:{n:"Title",t:$r},3:{n:"Subject",t:$r},4:{n:"Author",t:$r},5:{n:"Keywords",t:$r},6:{n:"Comments",t:$r},7:{n:"Template",t:$r},8:{n:"LastAuthor",t:$r},9:{n:"RevNumber",t:$r},10:{n:"EditTime",t:rh},11:{n:"LastPrinted",t:rh},12:{n:"CreatedDate",t:rh},13:{n:"ModifiedDate",t:rh},14:{n:"PageCount",t:Ln},15:{n:"WordCount",t:Ln},16:{n:"CharCount",t:Ln},17:{n:"Thumbnail",t:uU},18:{n:"Application",t:$r},19:{n:"DocSecurity",t:Ln},255:{},2147483648:{n:"Locale",t:qh},2147483651:{n:"Behavior",t:qh},1919054434:{}},r_={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},xU=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function vU(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var gU=vU([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),oo=tn(gU),_o={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},qO={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},n_={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function yU(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function bU(e){var t=yU();if(!e||!e.match)return t;var r={};if((e.match(wn)||[]).forEach(function(n){var a=ft(n);switch(a[0].replace(C9,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[n_[a.ContentType]]!==void 0&&t[n_[a.ContentType]].push(a.PartName);break}}),t.xmlns!==B9.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var Sc={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function wy(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function kf(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(wn)||[]).forEach(function(a){var i=ft(a);if(i[0]==="<Relationship"){var l={};l.Type=i.Type,l.Target=i.Target,l.Id=i.Id,i.TargetMode&&(l.TargetMode=i.TargetMode);var u=i.TargetMode==="External"?i.Target:yf(i.Target,t);r[u]=l,n[i.Id]=l}}),r["!id"]=n,r}var wU="application/vnd.oasis.opendocument.spreadsheet";function SU(e,t){for(var r=Yb(e),n,a;n=Kf.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=ft(n[0],!1),a.path=="/"&&a.type!==wU)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var Cf=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],EU=function(){for(var e=new Array(Cf.length),t=0;t<Cf.length;++t){var r=Cf[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function VO(e){var t={};e=Zt(e);for(var r=0;r<Cf.length;++r){var n=Cf[r],a=e.match(EU[r]);a!=null&&a.length>0&&(t[n[1]]=Dt(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=en(t[n[1]]))}return t}var jU=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function KO(e,t,r,n){var a=[];if(typeof e=="string")a=GA(e,n);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map(function(m){return{v:m}}));var l=typeof t=="string"?GA(t,n).map(function(m){return m.v}):t,u=0,h=0;if(l.length>0)for(var d=0;d!==a.length;d+=2){switch(h=+a[d+1].v,a[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=h,r.SheetNames=l.slice(u,u+h);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=h,r.DefinedNames=l.slice(u,u+h);break;case"Charts":case"Diagramme":r.Chartsheets=h,r.ChartNames=l.slice(u,u+h);break}u+=h}}function NU(e,t,r){var n={};return t||(t={}),e=Zt(e),jU.forEach(function(a){var i=(e.match(Vf(a[0]))||[])[1];switch(a[2]){case"string":i&&(t[a[1]]=Dt(i));break;case"bool":t[a[1]]=i==="true";break;case"raw":var l=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));l&&l.length>0&&(n[a[1]]=l[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&KO(n.HeadingPairs,n.TitlesOfParts,t,r),t}var AU=/<[^>]+>[^<]*/g;function _U(e,t){var r={},n="",a=e.match(AU);if(a)for(var i=0;i!=a.length;++i){var l=a[i],u=ft(l);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Dt(u.name);break;case"</property>":n=null;break;default:if(l.indexOf("<vt:")===0){var h=l.split(">"),d=h[0].slice(4),m=h[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[n]=Dt(m);break;case"bool":r[n]=tr(m);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(m,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(m);break;case"filetime":case"date":r[n]=en(m);break;case"cy":case"error":r[n]=Dt(m);break;default:if(d.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",l,d,h)}}else if(l.slice(0,2)!=="</"){if(t.WTF)throw new Error(l)}}}return r}var TU={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},dg;function kU(e,t,r){dg||(dg=Gb(TU)),t=dg[t]||t,e[t]=r}function r2(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function GO(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function WO(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function YO(e,t,r){return t===31?WO(e):GO(e,t,r)}function Sy(e,t,r){return YO(e,t,r===!1?0:4)}function CU(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return YO(e,t,0)}function OU(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(On,""),e.l-a&2&&(e.l+=2)}return r}function DU(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(On,"");return r}function PU(e){var t=e.l,r=Vh(e,HO);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Vh(e,Ln);return[r,n]}function RU(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(PU(e));return r}function a_(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var i=e.read_shift(4),l=e.read_shift(4);n[i]=e.read_shift(l,t===1200?"utf16le":"utf8").replace(On,"").replace(gf,"!"),t===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function XO(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function MU(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Vh(e,t,r){var n=e.read_shift(2),a,i=r||{};if(e.l+=2,t!==t_&&n!==t&&hU.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===t_?n:t){case 2:return a=e.read_shift(2,"i"),i.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return GO(e,n,4).replace(On,"");case 31:return WO(e);case 64:return r2(e);case 65:return XO(e);case 71:return MU(e);case 80:return Sy(e,n,!i.raw).replace(On,"");case 81:return CU(e,n).replace(On,"");case 4108:return RU(e);case 4126:case 4127:return n==4127?OU(e):DU(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function i_(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),i=[],l=0,u=0,h=-1,d={};for(l=0;l!=a;++l){var m=e.read_shift(4),p=e.read_shift(4);i[l]=[m,p+r]}i.sort(function(_,A){return _[1]-A[1]});var v={};for(l=0;l!=a;++l){if(e.l!==i[l][1]){var g=!0;if(l>0&&t)switch(t[i[l-1][0]].t){case 2:e.l+2===i[l][1]&&(e.l+=2,g=!1);break;case 80:e.l<=i[l][1]&&(e.l=i[l][1],g=!1);break;case 4108:e.l<=i[l][1]&&(e.l=i[l][1],g=!1);break}if((!t||l==0)&&e.l<=i[l][1]&&(g=!1,e.l=i[l][1]),g)throw new Error("Read Error: Expected address "+i[l][1]+" at "+e.l+" :"+l)}if(t){var w=t[i[l][0]];if(v[w.n]=Vh(e,w.t,{raw:!0}),w.p==="version"&&(v[w.n]=String(v[w.n]>>16)+"."+("0000"+String(v[w.n]&65535)).slice(-4)),w.n=="CodePage")switch(v[w.n]){case 0:v[w.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:oi(u=v[w.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+v[w.n])}}else if(i[l][0]===1){if(u=v.CodePage=Vh(e,t2),oi(u),h!==-1){var b=e.l;e.l=i[h][1],d=a_(e,u),e.l=b}}else if(i[l][0]===0){if(u===0){h=l,e.l=i[l+1][1];continue}d=a_(e,u)}else{var S=d[i[l][0]],j;switch(e[e.l]){case 65:e.l+=4,j=XO(e);break;case 30:e.l+=4,j=Sy(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,j=Sy(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,j=e.read_shift(4,"i");break;case 19:e.l+=4,j=e.read_shift(4);break;case 5:e.l+=4,j=e.read_shift(8,"f");break;case 11:e.l+=4,j=pr(e,4);break;case 64:e.l+=4,j=en(r2(e));break;default:throw new Error("unparsed value: "+e[e.l])}v[S]=j}}return e.l=r+n,v}function s_(e,t,r){var n=e.content;if(!n)return{};Jr(n,0);var a,i,l,u,h=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),m=n.read_shift(16);if(m!==Ct.utils.consts.HEADER_CLSID&&m!==r)throw new Error("Bad PropertySet CLSID "+m);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),u=n.read_shift(4),a===1&&u!==n.l)throw new Error("Length mismatch: "+u+" !== "+n.l);a===2&&(l=n.read_shift(16),h=n.read_shift(4));var p=i_(n,t),v={SystemIdentifier:d};for(var g in p)v[g]=p[g];if(v.FMTID=i,a===1)return v;if(h-n.l==2&&(n.l+=2),n.l!==h)throw new Error("Length mismatch 2: "+n.l+" !== "+h);var w;try{w=i_(n,null)}catch{}for(g in w)v[g]=w[g];return v.FMTID=[i,l],v}function Js(e,t){return e.read_shift(t),null}function FU(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function pr(e,t){return e.read_shift(t)===1}function jr(e){return e.read_shift(2,"u")}function ZO(e,t){return FU(e,t,jr)}function IU(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function pd(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var l=n?e.read_shift(n,a):"";return l}function LU(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,i=1+(r&1),l=0,u,h={};a&&(l=e.read_shift(2)),n&&(u=e.read_shift(4));var d=i==2?"dbcs-cont":"sbcs-cont",m=t===0?"":e.read_shift(t,d);return a&&(e.l+=4*l),n&&(e.l+=u),h.t=m,a||(h.raw="<t>"+h.t+"</t>",h.r=h.t),h}function vo(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function xd(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):vo(e,n,r)}function To(e,t,r){if(r.biff>5)return xd(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function BU(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function UU(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(On,"");return n&&(e.l+=24),a}function $U(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(i>>1,"utf16le").replace(On,"");return r+l}function zU(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return UU(e);case"0303000000000000c000000000000046":return $U(e);default:throw new Error("Unsupported Moniker "+r)}}function nh(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(On,""):"";return r}function HU(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var i,l,u,h,d="",m,p;a&16&&(i=nh(e,r-e.l)),a&128&&(l=nh(e,r-e.l)),(a&257)===257&&(u=nh(e,r-e.l)),(a&257)===1&&(h=zU(e,r-e.l)),a&8&&(d=nh(e,r-e.l)),a&32&&(m=e.read_shift(16)),a&64&&(p=r2(e)),e.l=r;var v=l||u||h||"";v&&d&&(v+="#"+d),v||(v="#"+d),a&2&&v.charAt(0)=="/"&&v.charAt(1)!="/"&&(v="file://"+v);var g={Target:v};return m&&(g.guid=m),p&&(g.time=p),i&&(g.Tooltip=i),g}function QO(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function JO(e,t){var r=QO(e);return r[3]=0,r}function Li(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function qU(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function VU(e,t,r){return t===0?"":To(e,t,r)}function KU(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),l=e.read_shift(n,"i");return[a,i,l]}function e5(e){var t=e.read_shift(2),r=e2(e);return[t,r]}function GU(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=pd(e,t,r),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,a}function Xm(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function t5(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var WU=t5;function r5(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function YU(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function XU(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function cn(e){e.l+=2,e.l+=e.read_shift(2)}var ZU={0:cn,4:cn,5:cn,6:cn,7:XU,8:cn,9:cn,10:cn,11:cn,12:cn,13:YU,14:cn,15:cn,16:cn,17:cn,18:cn,19:cn,20:cn,21:r5};function QU(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(ZU[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function ah(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function JU(e,t){return t===0||e.read_shift(2),1200}function e$(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=To(e,0,r);return e.read_shift(t+n-e.l),a}function t$(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function r$(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var l=pd(e,0,r);return l.length===0&&(l="Sheet1"),{pos:n,hs:a,dt:i,name:l}}function n$(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),i=[],l=0;l!=a&&e.l<r;++l)i.push(LU(e));return i.Count=n,i.Unique=a,i}function a$(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function i$(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function s$(e){var t=qU(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function l$(e){return e.read_shift(2),e.read_shift(4)}function l_(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function o$(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),u=e.read_shift(2),h=e.read_shift(2),d=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:i,CurTab:l,FirstTab:u,Selected:h,TabRatio:d}}function c$(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function u$(){}function f$(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=pd(e,0,r),n}function d$(e){var t=Li(e);return t.isst=e.read_shift(4),t}function h$(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=Li(e);r.biff==2&&e.l++;var i=xd(e,n-e.l,r);return a.val=i,a}function m$(e,t,r){var n=e.read_shift(2),a=To(e,0,r);return[n,a]}var p$=To;function o_(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,i=e.read_shift(a),l=e.read_shift(a),u=e.read_shift(2),h=e.read_shift(2);return e.l=n,{s:{r:i,c:u},e:{r:l,c:h}}}function x$(e){var t=e.read_shift(2),r=e.read_shift(2),n=e5(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function v$(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(e5(e));if(e.l!==r)throw new Error("MulRK read error");var l=e.read_shift(2);if(i.length!=l-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:l,rkrec:i}}function g$(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var l=e.read_shift(2);if(i.length!=l-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:l,ixfe:i}}function y$(e,t,r,n){var a={},i=e.read_shift(4),l=e.read_shift(4),u=e.read_shift(4),h=e.read_shift(2);return a.patternType=xU[u>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=l&15,a.dgRight=l>>4&15,a.dgTop=l>>8&15,a.dgBottom=l>>12&15,a.icvLeft=l>>16&127,a.icvRight=l>>23&127,a.grbitDiag=l>>30&3,a.icvTop=u&127,a.icvBottom=u>>7&127,a.icvDiag=u>>14&127,a.dgDiag=u>>21&15,a.icvFore=h&127,a.icvBack=h>>7&127,a.fsxButton=h>>14&1),a}function b$(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=y$(e,t,n.fStyle,r),n}function w$(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function c_(e,t,r){var n=Li(e);(r.biff==2||t==9)&&++e.l;var a=IU(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function S$(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Li(e),a=vn(e);return n.val=a,n}var u_=VU;function E$(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var l=vo(e,i),u=[];n>e.l;)u.push(xd(e));return[i,a,l,u]}function f_(e,t,r){var n=e.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=GU(e,t-2,r)),i.body=a||e.read_shift(t-2),typeof a=="string"&&(i.Name=a),i}var j$=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function d_(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(1),l=e.read_shift(1),u=e.read_shift(r&&r.biff==2?1:2),h=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),h=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var d=vo(e,l,r);a&32&&(d=j$[d.charCodeAt(0)]);var m=n-e.l;r&&r.biff==2&&--m;var p=n==e.l||u===0||!(m>0)?[]:iV(e,m,r,u);return{chKey:i,Name:d,itab:h,rgce:p}}function n5(e,t,r){if(r.biff<8)return N$(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(KU(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function N$(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=pd(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function A$(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),i=vo(e,n,r),l=vo(e,a,r);return[i,l]}function _$(e,t,r){var n=t5(e);e.l++;var a=e.read_shift(1);return t-=8,[sV(e,t,r),a,n]}function h_(e,t,r){var n=WU(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,nV(e,t,r)]}function T$(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function k$(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),u=To(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},u,l,i]}}function C$(e,t,r){return k$(e,t,r)}function O$(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Xm(e));return r}function D$(e,t,r){if(r&&r.biff<8)return R$(e,t,r);var n=r5(e),a=QU(e,t-22,n[1]);return{cmo:n,ft:a}}var P$={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function R$(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var l=[];return l.push((P$[n]||bn)(e,t,r)),{cmo:[a,n,i],ft:l}}function M$(e,t,r){var n=e.l,a="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:l=BU(e,6,r);var u=e.read_shift(2);e.read_shift(2),jr(e,2);var h=e.read_shift(2);e.l+=h;for(var d=1;d<e.lens.length-1;++d){if(e.l-n!=e.lens[d])throw new Error("TxO: bad continue record");var m=e[e.l],p=vo(e,e.lens[d+1]-e.lens[d]-1);if(a+=p,a.length>=(m?u:2*u))break}if(a.length!==u&&a.length!==u*2)throw new Error("cchText: "+u+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function F$(e,t){var r=Xm(e);e.l+=16;var n=HU(e,t-24);return[r,n]}function I$(e,t){e.read_shift(2);var r=Xm(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(On,""),[r,n]}function L$(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=r_[r]||r,r=e.read_shift(2),t[1]=r_[r]||r,t}function B$(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(JO(e));return r}function U$(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(JO(e));return r}function $$(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function a5(e,t,r){if(!r.cellStyles)return bn(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),l=e.read_shift(n),u=e.read_shift(n),h=e.read_shift(2);n==2&&(e.l+=2);var d={s:a,e:i,w:l,ixfe:u,flags:h};return(r.biff>=5||!r.biff)&&(d.level=h>>8&7),d}function z$(e,t){var r={};return t<32||(e.l+=16,r.header=vn(e),r.footer=vn(e),e.l+=2),r}function H$(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}var q$=Li,V$=ZO,K$=xd;function G$(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function W$(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Li(e);++e.l;var a=To(e,t-7,r);return n.t="str",n.val=a,n}function Y$(e){var t=Li(e);++e.l;var r=vn(e);return t.t="n",t.val=r,t}function X$(e){var t=Li(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function Z$(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function Q$(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function J$(e,t,r){var n=e.l+t,a=Li(e),i=e.read_shift(2),l=vo(e,i,r);return e.l=n,a.t="str",a.val=l,a}var ez=[2,3,48,49,131,139,140,245],m_=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Gb({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,h){var d=[],m=pl(1);switch(h.type){case"base64":m=ii(da(u));break;case"binary":m=ii(u);break;case"buffer":case"array":m=u;break}Jr(m,0);var p=m.read_shift(1),v=!!(p&136),g=!1,w=!1;switch(p){case 2:break;case 3:break;case 48:g=!0,v=!0;break;case 49:g=!0,v=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var b=0,S=521;p==2&&(b=m.read_shift(2)),m.l+=3,p!=2&&(b=m.read_shift(4)),b>1048576&&(b=1e6),p!=2&&(S=m.read_shift(2));var j=m.read_shift(2),_=h.codepage||1252;p!=2&&(m.l+=16,m.read_shift(1),m[m.l]!==0&&(_=e[m[m.l]]),m.l+=1,m.l+=2),w&&(m.l+=36);for(var A=[],k={},O=Math.min(m.length,p==2?521:S-10-(g?264:0)),C=w?32:11;m.l<O&&m[m.l]!=13;)switch(k={},k.name=zf.utils.decode(_,m.slice(m.l,m.l+C)).replace(/[\u0000\r\n].*$/g,""),m.l+=C,k.type=String.fromCharCode(m.read_shift(1)),p!=2&&!w&&(k.offset=m.read_shift(4)),k.len=m.read_shift(1),p==2&&(k.offset=m.read_shift(2)),k.dec=m.read_shift(1),k.name.length&&A.push(k),p!=2&&(m.l+=w?13:14),k.type){case"B":(!g||k.len!=8)&&h.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+k.type)}if(m[m.l]!==13&&(m.l=S-1),m.read_shift(1)!==13)throw new Error("DBF Terminator not found "+m.l+" "+m[m.l]);m.l=S;var T=0,I=0;for(d[0]=[],I=0;I!=A.length;++I)d[0][I]=A[I].name;for(;b-- >0;){if(m[m.l]===42){m.l+=j;continue}for(++m.l,d[++T]=[],I=0,I=0;I!=A.length;++I){var M=m.slice(m.l,m.l+A[I].len);m.l+=A[I].len,Jr(M,0);var W=zf.utils.decode(_,M);switch(A[I].type){case"C":W.trim().length&&(d[T][I]=W.replace(/\s+$/,""));break;case"D":W.length===8?d[T][I]=new Date(+W.slice(0,4),+W.slice(4,6)-1,+W.slice(6,8)):d[T][I]=W;break;case"F":d[T][I]=parseFloat(W.trim());break;case"+":case"I":d[T][I]=w?M.read_shift(-4,"i")^2147483648:M.read_shift(4,"i");break;case"L":switch(W.trim().toUpperCase()){case"Y":case"T":d[T][I]=!0;break;case"N":case"F":d[T][I]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+W+"|")}break;case"M":if(!v)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));d[T][I]="##MEMO##"+(w?parseInt(W.trim(),10):M.read_shift(4));break;case"N":W=W.replace(/\u0000/g,"").trim(),W&&W!="."&&(d[T][I]=+W||0);break;case"@":d[T][I]=new Date(M.read_shift(-8,"f")-621356832e5);break;case"T":d[T][I]=new Date((M.read_shift(4)-2440588)*864e5+M.read_shift(4));break;case"Y":d[T][I]=M.read_shift(4,"i")/1e4+M.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[T][I]=-M.read_shift(-8,"f");break;case"B":if(g&&A[I].len==8){d[T][I]=M.read_shift(8,"f");break}case"G":case"P":M.l+=A[I].len;break;case"0":if(A[I].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+A[I].type)}}}if(p!=2&&m.l<m.length&&m[m.l++]!=26)throw new Error("DBF EOF Marker missing "+(m.l-1)+" of "+m.length+" "+m[m.l-1].toString(16));return h&&h.sheetRows&&(d=d.slice(0,h.sheetRows)),h.DBF=A,d}function n(u,h){var d=h||{};d.dateNF||(d.dateNF="yyyymmdd");var m=md(r(u,d),d);return m["!cols"]=d.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete d.DBF,m}function a(u,h){try{return jo(n(u,h),h)}catch(d){if(h&&h.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function l(u,h){var d=h||{};if(+d.codepage>=0&&oi(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var m=yy(),p=NG(u,{header:1,raw:!0,cellDates:!0}),v=p[0],g=p.slice(1),w=u["!cols"]||[],b=0,S=0,j=0,_=1;for(b=0;b<v.length;++b){if(((w[b]||{}).DBF||{}).name){v[b]=w[b].DBF.name,++j;continue}if(v[b]!=null){if(++j,typeof v[b]=="number"&&(v[b]=v[b].toString(10)),typeof v[b]!="string")throw new Error("DBF Invalid column name "+v[b]+" |"+typeof v[b]+"|");if(v.indexOf(v[b])!==b){for(S=0;S<1024;++S)if(v.indexOf(v[b]+"_"+S)==-1){v[b]+="_"+S;break}}}}var A=qr(u["!ref"]),k=[],O=[],C=[];for(b=0;b<=A.e.c-A.s.c;++b){var T="",I="",M=0,W=[];for(S=0;S<g.length;++S)g[S][b]!=null&&W.push(g[S][b]);if(W.length==0||v[b]==null){k[b]="?";continue}for(S=0;S<W.length;++S){switch(typeof W[S]){case"number":I="B";break;case"string":I="C";break;case"boolean":I="L";break;case"object":I=W[S]instanceof Date?"D":"C";break;default:I="C"}M=Math.max(M,String(W[S]).length),T=T&&T!=I?"C":I}M>250&&(M=250),I=((w[b]||{}).DBF||{}).type,I=="C"&&w[b].DBF.len>M&&(M=w[b].DBF.len),T=="B"&&I=="N"&&(T="N",C[b]=w[b].DBF.dec,M=w[b].DBF.len),O[b]=T=="C"||I=="N"?M:i[T]||0,_+=O[b],k[b]=T}var U=m.next(32);for(U.write_shift(4,318902576),U.write_shift(4,g.length),U.write_shift(2,296+32*j),U.write_shift(2,_),b=0;b<4;++b)U.write_shift(4,0);for(U.write_shift(4,0|(+t[rO]||3)<<8),b=0,S=0;b<v.length;++b)if(v[b]!=null){var F=m.next(32),oe=(v[b].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);F.write_shift(1,oe,"sbcs"),F.write_shift(1,k[b]=="?"?"C":k[b],"sbcs"),F.write_shift(4,S),F.write_shift(1,O[b]||i[k[b]]||0),F.write_shift(1,C[b]||0),F.write_shift(1,2),F.write_shift(4,0),F.write_shift(1,0),F.write_shift(4,0),F.write_shift(4,0),S+=O[b]||i[k[b]]||0}var je=m.next(264);for(je.write_shift(4,13),b=0;b<65;++b)je.write_shift(4,0);for(b=0;b<g.length;++b){var ue=m.next(_);for(ue.write_shift(1,0),S=0;S<v.length;++S)if(v[S]!=null)switch(k[S]){case"L":ue.write_shift(1,g[b][S]==null?63:g[b][S]?84:70);break;case"B":ue.write_shift(8,g[b][S]||0,"f");break;case"N":var V="0";for(typeof g[b][S]=="number"&&(V=g[b][S].toFixed(C[S]||0)),j=0;j<O[S]-V.length;++j)ue.write_shift(1,32);ue.write_shift(1,V,"sbcs");break;case"D":g[b][S]?(ue.write_shift(4,("0000"+g[b][S].getFullYear()).slice(-4),"sbcs"),ue.write_shift(2,("00"+(g[b][S].getMonth()+1)).slice(-2),"sbcs"),ue.write_shift(2,("00"+g[b][S].getDate()).slice(-2),"sbcs")):ue.write_shift(8,"00000000","sbcs");break;case"C":var H=String(g[b][S]!=null?g[b][S]:"").slice(0,O[S]);for(ue.write_shift(1,H,"sbcs"),j=0;j<O[S]-H.length;++j)ue.write_shift(1,32);break}}return m.next(1).write_shift(1,26),m.end()}return{to_workbook:a,to_sheet:n,from_sheet:l}}(),tz=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+xl(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(v,g){var w=e[g];return typeof w=="number"?CA(w):w},n=function(v,g,w){var b=g.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return b==59?v:CA(b)};e["|"]=254;function a(v,g){switch(g.type){case"base64":return i(da(v),g);case"binary":return i(v,g);case"buffer":return i(_t&&Buffer.isBuffer(v)?v.toString("binary"):Eo(v),g);case"array":return i(xo(v),g)}throw new Error("Unrecognized type "+g.type)}function i(v,g){var w=v.split(/[\n\r]+/),b=-1,S=-1,j=0,_=0,A=[],k=[],O=null,C={},T=[],I=[],M=[],W=0,U;for(+g.codepage>=0&&oi(+g.codepage);j!==w.length;++j){W=0;var F=w[j].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),oe=F.replace(/;;/g,"\0").split(";").map(function(Z){return Z.replace(/\u0000/g,";")}),je=oe[0],ue;if(F.length>0)switch(je){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":oe[1].charAt(0)=="P"&&k.push(F.slice(3).replace(/;;/g,";"));break;case"C":var V=!1,H=!1,Se=!1,Q=!1,z=-1,Y=-1;for(_=1;_<oe.length;++_)switch(oe[_].charAt(0)){case"A":break;case"X":S=parseInt(oe[_].slice(1))-1,H=!0;break;case"Y":for(b=parseInt(oe[_].slice(1))-1,H||(S=0),U=A.length;U<=b;++U)A[U]=[];break;case"K":ue=oe[_].slice(1),ue.charAt(0)==='"'?ue=ue.slice(1,ue.length-1):ue==="TRUE"?ue=!0:ue==="FALSE"?ue=!1:isNaN(ls(ue))?isNaN(qf(ue).getDate())||(ue=en(ue)):(ue=ls(ue),O!==null&&Zc(O)&&(ue=Ym(ue))),V=!0;break;case"E":Q=!0;var P=_c(oe[_].slice(1),{r:b,c:S});A[b][S]=[A[b][S],P];break;case"S":Se=!0,A[b][S]=[A[b][S],"S5S"];break;case"G":break;case"R":z=parseInt(oe[_].slice(1))-1;break;case"C":Y=parseInt(oe[_].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+F)}if(V&&(A[b][S]&&A[b][S].length==2?A[b][S][0]=ue:A[b][S]=ue,O=null),Se){if(Q)throw new Error("SYLK shared formula cannot have own formula");var q=z>-1&&A[z][Y];if(!q||!q[1])throw new Error("SYLK shared formula cannot find base");A[b][S][1]=m5(q[1],{r:b-z,c:S-Y})}break;case"F":var G=0;for(_=1;_<oe.length;++_)switch(oe[_].charAt(0)){case"X":S=parseInt(oe[_].slice(1))-1,++G;break;case"Y":for(b=parseInt(oe[_].slice(1))-1,U=A.length;U<=b;++U)A[U]=[];break;case"M":W=parseInt(oe[_].slice(1))/20;break;case"F":break;case"G":break;case"P":O=k[parseInt(oe[_].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(M=oe[_].slice(1).split(" "),U=parseInt(M[0],10);U<=parseInt(M[1],10);++U)W=parseInt(M[2],10),I[U-1]=W===0?{hidden:!0}:{wch:W},Dc(I[U-1]);break;case"C":S=parseInt(oe[_].slice(1))-1,I[S]||(I[S]={});break;case"R":b=parseInt(oe[_].slice(1))-1,T[b]||(T[b]={}),W>0?(T[b].hpt=W,T[b].hpx=Yf(W)):W===0&&(T[b].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+F)}G<1&&(O=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+F)}}return T.length>0&&(C["!rows"]=T),I.length>0&&(C["!cols"]=I),g&&g.sheetRows&&(A=A.slice(0,g.sheetRows)),[A,C]}function l(v,g){var w=a(v,g),b=w[0],S=w[1],j=md(b,g);return xl(S).forEach(function(_){j[_]=S[_]}),j}function u(v,g){return jo(l(v,g),g)}function h(v,g,w,b){var S="C;Y"+(w+1)+";X"+(b+1)+";K";switch(v.t){case"n":S+=v.v||0,v.f&&!v.F&&(S+=";E"+$H(v.f,{r:w,c:b}));break;case"b":S+=v.v?"TRUE":"FALSE";break;case"e":S+=v.w||v.v;break;case"d":S+='"'+(v.w||v.v)+'"';break;case"s":S+='"'+v.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function d(v,g){g.forEach(function(w,b){var S="F;W"+(b+1)+" "+(b+1)+" ";w.hidden?S+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=Gh(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=Wh(w.wpx)),typeof w.wch=="number"&&(S+=Math.round(w.wch))),S.charAt(S.length-1)!=" "&&v.push(S)})}function m(v,g){g.forEach(function(w,b){var S="F;";w.hidden?S+="M0;":w.hpt?S+="M"+20*w.hpt+";":w.hpx&&(S+="M"+20*f5(w.hpx)+";"),S.length>2&&v.push(S+"R"+(b+1))})}function p(v,g){var w=["ID;PWXL;N;E"],b=[],S=qr(v["!ref"]),j,_=Array.isArray(v),A=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),v["!cols"]&&d(w,v["!cols"]),v["!rows"]&&m(w,v["!rows"]),w.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var k=S.s.r;k<=S.e.r;++k)for(var O=S.s.c;O<=S.e.c;++O){var C=wt({r:k,c:O});j=_?(v[k]||[])[O]:v[C],!(!j||j.v==null&&(!j.f||j.F))&&b.push(h(j,v,k,O))}return w.join(A)+A+b.join(A)+A+"E"+A}return{to_workbook:u,to_sheet:l,from_sheet:p}}(),rz=function(){function e(i,l){switch(l.type){case"base64":return t(da(i),l);case"binary":return t(i,l);case"buffer":return t(_t&&Buffer.isBuffer(i)?i.toString("binary"):Eo(i),l);case"array":return t(xo(i),l)}throw new Error("Unrecognized type "+l.type)}function t(i,l){for(var u=i.split(`
`),h=-1,d=-1,m=0,p=[];m!==u.length;++m){if(u[m].trim()==="BOT"){p[++h]=[],d=0;continue}if(!(h<0)){var v=u[m].trim().split(","),g=v[0],w=v[1];++m;for(var b=u[m]||"";(b.match(/["]/g)||[]).length&1&&m<u.length-1;)b+=`
`+u[++m];switch(b=b.trim(),+g){case-1:if(b==="BOT"){p[++h]=[],d=0;continue}else if(b!=="EOD")throw new Error("Unrecognized DIF special command "+b);break;case 0:b==="TRUE"?p[h][d]=!0:b==="FALSE"?p[h][d]=!1:isNaN(ls(w))?isNaN(qf(w).getDate())?p[h][d]=w:p[h][d]=en(w):p[h][d]=ls(w),++d;break;case 1:b=b.slice(1,b.length-1),b=b.replace(/""/g,'"'),b&&b.match(/^=".*"$/)&&(b=b.slice(2,-1)),p[h][d++]=b!==""?b:null;break}if(b==="EOD")break}}return l&&l.sheetRows&&(p=p.slice(0,l.sheetRows)),p}function r(i,l){return md(e(i,l),l)}function n(i,l){return jo(r(i,l),l)}var a=function(){var i=function(h,d,m,p,v){h.push(d),h.push(m+","+p),h.push('"'+v.replace(/"/g,'""')+'"')},l=function(h,d,m,p){h.push(d+","+m),h.push(d==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(h){var d=[],m=qr(h["!ref"]),p,v=Array.isArray(h);i(d,"TABLE",0,1,"sheetjs"),i(d,"VECTORS",0,m.e.r-m.s.r+1,""),i(d,"TUPLES",0,m.e.c-m.s.c+1,""),i(d,"DATA",0,0,"");for(var g=m.s.r;g<=m.e.r;++g){l(d,-1,0,"BOT");for(var w=m.s.c;w<=m.e.c;++w){var b=wt({r:g,c:w});if(p=v?(h[g]||[])[w]:h[b],!p){l(d,1,0,"");continue}switch(p.t){case"n":var S=p.w;!S&&p.v!=null&&(S=p.v),S==null?p.f&&!p.F?l(d,1,0,"="+p.f):l(d,1,0,""):l(d,0,S,"V");break;case"b":l(d,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":l(d,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=Ha(p.z||xt[14],ha(en(p.v)))),l(d,0,p.w,"V");break;default:l(d,1,0,"")}}}l(d,-1,0,"EOD");var j=`\r
`,_=d.join(j);return _}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),nz=function(){function e(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(p,v){for(var g=p.split(`
`),w=-1,b=-1,S=0,j=[];S!==g.length;++S){var _=g[S].trim().split(":");if(_[0]==="cell"){var A=ui(_[1]);if(j.length<=A.r)for(w=j.length;w<=A.r;++w)j[w]||(j[w]=[]);switch(w=A.r,b=A.c,_[2]){case"t":j[w][b]=e(_[3]);break;case"v":j[w][b]=+_[3];break;case"vtf":var k=_[_.length-1];case"vtc":switch(_[3]){case"nl":j[w][b]=!!+_[4];break;default:j[w][b]=+_[4];break}_[2]=="vtf"&&(j[w][b]=[j[w][b],k])}}}return v&&v.sheetRows&&(j=j.slice(0,v.sheetRows)),j}function n(p,v){return md(r(p,v),v)}function a(p,v){return jo(n(p,v),v)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function d(p){if(!p||!p["!ref"])return"";for(var v=[],g=[],w,b="",S=Zb(p["!ref"]),j=Array.isArray(p),_=S.s.r;_<=S.e.r;++_)for(var A=S.s.c;A<=S.e.c;++A)if(b=wt({r:_,c:A}),w=j?(p[_]||[])[A]:p[b],!(!w||w.v==null||w.t==="z")){switch(g=["cell",b,"t"],w.t){case"s":case"str":g.push(t(w.v));break;case"n":w.f?(g[2]="vtf",g[3]="n",g[4]=w.v,g[5]=t(w.f)):(g[2]="v",g[3]=w.v);break;case"b":g[2]="vt"+(w.f?"f":"c"),g[3]="nl",g[4]=w.v?"1":"0",g[5]=t(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var k=ha(en(w.v));g[2]="vtc",g[3]="nd",g[4]=""+k,g[5]=w.w||Ha(w.z||xt[14],k);break;case"e":continue}v.push(g.join(":"))}return v.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),v.push("valueformat:1:text-wiki"),v.join(`
`)}function m(p){return[i,l,u,l,d(p),h].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:m}}(),Gf=function(){function e(m,p,v,g,w){w.raw?p[v][g]=m:m===""||(m==="TRUE"?p[v][g]=!0:m==="FALSE"?p[v][g]=!1:isNaN(ls(m))?isNaN(qf(m).getDate())?p[v][g]=m:p[v][g]=en(m):p[v][g]=ls(m))}function t(m,p){var v=p||{},g=[];if(!m||m.length===0)return g;for(var w=m.split(/[\r\n]/),b=w.length-1;b>=0&&w[b].length===0;)--b;for(var S=10,j=0,_=0;_<=b;++_)j=w[_].indexOf(" "),j==-1?j=w[_].length:j++,S=Math.max(S,j);for(_=0;_<=b;++_){g[_]=[];var A=0;for(e(w[_].slice(0,S).trim(),g,_,A,v),A=1;A<=(w[_].length-S)/10+1;++A)e(w[_].slice(S+(A-1)*10,S+A*10).trim(),g,_,A,v)}return v.sheetRows&&(g=g.slice(0,v.sheetRows)),g}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(m){for(var p={},v=!1,g=0,w=0;g<m.length;++g)(w=m.charCodeAt(g))==34?v=!v:!v&&w in r&&(p[w]=(p[w]||0)+1);w=[];for(g in p)Object.prototype.hasOwnProperty.call(p,g)&&w.push([p[g],g]);if(!w.length){p=n;for(g in p)Object.prototype.hasOwnProperty.call(p,g)&&w.push([p[g],g])}return w.sort(function(b,S){return b[0]-S[0]||n[b[1]]-n[S[1]]}),r[w.pop()[1]]||44}function i(m,p){var v=p||{},g="",w=v.dense?[]:{},b={s:{c:0,r:0},e:{c:0,r:0}};m.slice(0,4)=="sep="?m.charCodeAt(5)==13&&m.charCodeAt(6)==10?(g=m.charAt(4),m=m.slice(7)):m.charCodeAt(5)==13||m.charCodeAt(5)==10?(g=m.charAt(4),m=m.slice(6)):g=a(m.slice(0,1024)):v&&v.FS?g=v.FS:g=a(m.slice(0,1024));var S=0,j=0,_=0,A=0,k=0,O=g.charCodeAt(0),C=!1,T=0,I=m.charCodeAt(0);m=m.replace(/\r\n/mg,`
`);var M=v.dateNF!=null?x9(v.dateNF):null;function W(){var U=m.slice(A,k),F={};if(U.charAt(0)=='"'&&U.charAt(U.length-1)=='"'&&(U=U.slice(1,-1).replace(/""/g,'"')),U.length===0)F.t="z";else if(v.raw)F.t="s",F.v=U;else if(U.trim().length===0)F.t="s",F.v=U;else if(U.charCodeAt(0)==61)U.charCodeAt(1)==34&&U.charCodeAt(U.length-1)==34?(F.t="s",F.v=U.slice(2,-1).replace(/""/g,'"')):HH(U)?(F.t="n",F.f=U.slice(1)):(F.t="s",F.v=U);else if(U=="TRUE")F.t="b",F.v=!0;else if(U=="FALSE")F.t="b",F.v=!1;else if(!isNaN(_=ls(U)))F.t="n",v.cellText!==!1&&(F.w=U),F.v=_;else if(!isNaN(qf(U).getDate())||M&&U.match(M)){F.z=v.dateNF||xt[14];var oe=0;M&&U.match(M)&&(U=v9(U,v.dateNF,U.match(M)||[]),oe=1),v.cellDates?(F.t="d",F.v=en(U,oe)):(F.t="n",F.v=ha(en(U,oe))),v.cellText!==!1&&(F.w=Ha(F.z,F.v instanceof Date?ha(F.v):F.v)),v.cellNF||delete F.z}else F.t="s",F.v=U;if(F.t=="z"||(v.dense?(w[S]||(w[S]=[]),w[S][j]=F):w[wt({c:j,r:S})]=F),A=k+1,I=m.charCodeAt(A),b.e.c<j&&(b.e.c=j),b.e.r<S&&(b.e.r=S),T==O)++j;else if(j=0,++S,v.sheetRows&&v.sheetRows<=S)return!0}e:for(;k<m.length;++k)switch(T=m.charCodeAt(k)){case 34:I===34&&(C=!C);break;case O:case 10:case 13:if(!C&&W())break e;break}return k-A>0&&W(),w["!ref"]=Ut(b),w}function l(m,p){return!(p&&p.PRN)||p.FS||m.slice(0,4)=="sep="||m.indexOf("	")>=0||m.indexOf(",")>=0||m.indexOf(";")>=0?i(m,p):md(t(m,p),p)}function u(m,p){var v="",g=p.type=="string"?[0,0,0,0]:u2(m,p);switch(p.type){case"base64":v=da(m);break;case"binary":v=m;break;case"buffer":p.codepage==65001?v=m.toString("utf8"):p.codepage&&typeof zf<"u"||(v=_t&&Buffer.isBuffer(m)?m.toString("binary"):Eo(m));break;case"array":v=xo(m);break;case"string":v=m;break;default:throw new Error("Unrecognized type "+p.type)}return g[0]==239&&g[1]==187&&g[2]==191?v=Zt(v.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?v=Zt(v):p.type=="binary"&&typeof zf<"u",v.slice(0,19)=="socialcalc:version:"?nz.to_sheet(p.type=="string"?v:Zt(v),p):l(v,p)}function h(m,p){return jo(u(m,p),p)}function d(m){for(var p=[],v=qr(m["!ref"]),g,w=Array.isArray(m),b=v.s.r;b<=v.e.r;++b){for(var S=[],j=v.s.c;j<=v.e.c;++j){var _=wt({r:b,c:j});if(g=w?(m[b]||[])[j]:m[_],!g||g.v==null){S.push("          ");continue}for(var A=(g.w||(Oc(g),g.w)||"").slice(0,10);A.length<10;)A+=" ";S.push(A+(j===0?" ":""))}p.push(S.join(""))}return p.join(`
`)}return{to_workbook:h,to_sheet:u,from_sheet:d}}();function az(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=tz.to_workbook(e,r);return r.WTF=n,a}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return Gf.to_workbook(e,t)}}var Of=function(){function e(P,q,G){if(P){Jr(P,P.l||0);for(var Z=G.Enum||z;P.l<P.length;){var fe=P.read_shift(2),Oe=Z[fe]||Z[65535],Re=P.read_shift(2),re=P.l+Re,be=Oe.f&&Oe.f(P,Re,G);if(P.l=re,q(be,Oe,fe))return}}}function t(P,q){switch(q.type){case"base64":return r(ii(da(P)),q);case"binary":return r(ii(P),q);case"buffer":case"array":return r(P,q)}throw"Unsupported type "+q.type}function r(P,q){if(!P)return P;var G=q||{},Z=G.dense?[]:{},fe="Sheet1",Oe="",Re=0,re={},be=[],Ae=[],D={s:{r:0,c:0},e:{r:0,c:0}},Me=G.sheetRows||0;if(P[2]==0&&(P[3]==8||P[3]==9)&&P.length>=16&&P[14]==5&&P[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(P[2]==2)G.Enum=z,e(P,function(ce,ze,Qe){switch(Qe){case 0:G.vers=ce,ce>=4096&&(G.qpro=!0);break;case 6:D=ce;break;case 204:ce&&(Oe=ce);break;case 222:Oe=ce;break;case 15:case 51:G.qpro||(ce[1].v=ce[1].v.slice(1));case 13:case 14:case 16:Qe==14&&(ce[2]&112)==112&&(ce[2]&15)>1&&(ce[2]&15)<15&&(ce[1].z=G.dateNF||xt[14],G.cellDates&&(ce[1].t="d",ce[1].v=Ym(ce[1].v))),G.qpro&&ce[3]>Re&&(Z["!ref"]=Ut(D),re[fe]=Z,be.push(fe),Z=G.dense?[]:{},D={s:{r:0,c:0},e:{r:0,c:0}},Re=ce[3],fe=Oe||"Sheet"+(Re+1),Oe="");var Ke=G.dense?(Z[ce[0].r]||[])[ce[0].c]:Z[wt(ce[0])];if(Ke){Ke.t=ce[1].t,Ke.v=ce[1].v,ce[1].z!=null&&(Ke.z=ce[1].z),ce[1].f!=null&&(Ke.f=ce[1].f);break}G.dense?(Z[ce[0].r]||(Z[ce[0].r]=[]),Z[ce[0].r][ce[0].c]=ce[1]):Z[wt(ce[0])]=ce[1];break}},G);else if(P[2]==26||P[2]==14)G.Enum=Y,P[2]==14&&(G.qpro=!0,P.l=0),e(P,function(ce,ze,Qe){switch(Qe){case 204:fe=ce;break;case 22:ce[1].v=ce[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ce[3]>Re&&(Z["!ref"]=Ut(D),re[fe]=Z,be.push(fe),Z=G.dense?[]:{},D={s:{r:0,c:0},e:{r:0,c:0}},Re=ce[3],fe="Sheet"+(Re+1)),Me>0&&ce[0].r>=Me)break;G.dense?(Z[ce[0].r]||(Z[ce[0].r]=[]),Z[ce[0].r][ce[0].c]=ce[1]):Z[wt(ce[0])]=ce[1],D.e.c<ce[0].c&&(D.e.c=ce[0].c),D.e.r<ce[0].r&&(D.e.r=ce[0].r);break;case 27:ce[14e3]&&(Ae[ce[14e3][0]]=ce[14e3][1]);break;case 1537:Ae[ce[0]]=ce[1],ce[0]==Re&&(fe=ce[1]);break}},G);else throw new Error("Unrecognized LOTUS BOF "+P[2]);if(Z["!ref"]=Ut(D),re[Oe||fe]=Z,be.push(Oe||fe),!Ae.length)return{SheetNames:be,Sheets:re};for(var ae={},de=[],me=0;me<Ae.length;++me)re[be[me]]?(de.push(Ae[me]||be[me]),ae[Ae[me]]=re[Ae[me]]||re[be[me]]):(de.push(Ae[me]),ae[Ae[me]]={"!ref":"A1"});return{SheetNames:de,Sheets:ae}}function n(P,q){var G=q||{};if(+G.codepage>=0&&oi(+G.codepage),G.type=="string")throw new Error("Cannot write WK1 to JS string");var Z=yy(),fe=qr(P["!ref"]),Oe=Array.isArray(P),Re=[];ri(Z,0,i(1030)),ri(Z,6,h(fe));for(var re=Math.min(fe.e.r,8191),be=fe.s.r;be<=re;++be)for(var Ae=ua(be),D=fe.s.c;D<=fe.e.c;++D){be===fe.s.r&&(Re[D]=kn(D));var Me=Re[D]+Ae,ae=Oe?(P[be]||[])[D]:P[Me];if(!(!ae||ae.t=="z"))if(ae.t=="n")(ae.v|0)==ae.v&&ae.v>=-32768&&ae.v<=32767?ri(Z,13,g(be,D,ae.v)):ri(Z,14,b(be,D,ae.v));else{var de=Oc(ae);ri(Z,15,p(be,D,de.slice(0,239)))}}return ri(Z,1),Z.end()}function a(P,q){var G=q||{};if(+G.codepage>=0&&oi(+G.codepage),G.type=="string")throw new Error("Cannot write WK3 to JS string");var Z=yy();ri(Z,0,l(P));for(var fe=0,Oe=0;fe<P.SheetNames.length;++fe)(P.Sheets[P.SheetNames[fe]]||{})["!ref"]&&ri(Z,27,Q(P.SheetNames[fe],Oe++));var Re=0;for(fe=0;fe<P.SheetNames.length;++fe){var re=P.Sheets[P.SheetNames[fe]];if(!(!re||!re["!ref"])){for(var be=qr(re["!ref"]),Ae=Array.isArray(re),D=[],Me=Math.min(be.e.r,8191),ae=be.s.r;ae<=Me;++ae)for(var de=ua(ae),me=be.s.c;me<=be.e.c;++me){ae===be.s.r&&(D[me]=kn(me));var ce=D[me]+de,ze=Ae?(re[ae]||[])[me]:re[ce];if(!(!ze||ze.t=="z"))if(ze.t=="n")ri(Z,23,W(ae,me,Re,ze.v));else{var Qe=Oc(ze);ri(Z,22,T(ae,me,Re,Qe.slice(0,239)))}}++Re}}return ri(Z,1),Z.end()}function i(P){var q=Pr(2);return q.write_shift(2,P),q}function l(P){var q=Pr(26);q.write_shift(2,4096),q.write_shift(2,4),q.write_shift(4,0);for(var G=0,Z=0,fe=0,Oe=0;Oe<P.SheetNames.length;++Oe){var Re=P.SheetNames[Oe],re=P.Sheets[Re];if(!(!re||!re["!ref"])){++fe;var be=Zb(re["!ref"]);G<be.e.r&&(G=be.e.r),Z<be.e.c&&(Z=be.e.c)}}return G>8191&&(G=8191),q.write_shift(2,G),q.write_shift(1,fe),q.write_shift(1,Z),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(1,1),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(4,0),q}function u(P,q,G){var Z={s:{c:0,r:0},e:{c:0,r:0}};return q==8&&G.qpro?(Z.s.c=P.read_shift(1),P.l++,Z.s.r=P.read_shift(2),Z.e.c=P.read_shift(1),P.l++,Z.e.r=P.read_shift(2),Z):(Z.s.c=P.read_shift(2),Z.s.r=P.read_shift(2),q==12&&G.qpro&&(P.l+=2),Z.e.c=P.read_shift(2),Z.e.r=P.read_shift(2),q==12&&G.qpro&&(P.l+=2),Z.s.c==65535&&(Z.s.c=Z.e.c=Z.s.r=Z.e.r=0),Z)}function h(P){var q=Pr(8);return q.write_shift(2,P.s.c),q.write_shift(2,P.s.r),q.write_shift(2,P.e.c),q.write_shift(2,P.e.r),q}function d(P,q,G){var Z=[{c:0,r:0},{t:"n",v:0},0,0];return G.qpro&&G.vers!=20768?(Z[0].c=P.read_shift(1),Z[3]=P.read_shift(1),Z[0].r=P.read_shift(2),P.l+=2):(Z[2]=P.read_shift(1),Z[0].c=P.read_shift(2),Z[0].r=P.read_shift(2)),Z}function m(P,q,G){var Z=P.l+q,fe=d(P,q,G);if(fe[1].t="s",G.vers==20768){P.l++;var Oe=P.read_shift(1);return fe[1].v=P.read_shift(Oe,"utf8"),fe}return G.qpro&&P.l++,fe[1].v=P.read_shift(Z-P.l,"cstr"),fe}function p(P,q,G){var Z=Pr(7+G.length);Z.write_shift(1,255),Z.write_shift(2,q),Z.write_shift(2,P),Z.write_shift(1,39);for(var fe=0;fe<Z.length;++fe){var Oe=G.charCodeAt(fe);Z.write_shift(1,Oe>=128?95:Oe)}return Z.write_shift(1,0),Z}function v(P,q,G){var Z=d(P,q,G);return Z[1].v=P.read_shift(2,"i"),Z}function g(P,q,G){var Z=Pr(7);return Z.write_shift(1,255),Z.write_shift(2,q),Z.write_shift(2,P),Z.write_shift(2,G,"i"),Z}function w(P,q,G){var Z=d(P,q,G);return Z[1].v=P.read_shift(8,"f"),Z}function b(P,q,G){var Z=Pr(13);return Z.write_shift(1,255),Z.write_shift(2,q),Z.write_shift(2,P),Z.write_shift(8,G,"f"),Z}function S(P,q,G){var Z=P.l+q,fe=d(P,q,G);if(fe[1].v=P.read_shift(8,"f"),G.qpro)P.l=Z;else{var Oe=P.read_shift(2);k(P.slice(P.l,P.l+Oe),fe),P.l+=Oe}return fe}function j(P,q,G){var Z=q&32768;return q&=-32769,q=(Z?P:0)+(q>=8192?q-16384:q),(Z?"":"$")+(G?kn(q):ua(q))}var _={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},A=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function k(P,q){Jr(P,0);for(var G=[],Z=0,fe="",Oe="",Re="",re="";P.l<P.length;){var be=P[P.l++];switch(be){case 0:G.push(P.read_shift(8,"f"));break;case 1:Oe=j(q[0].c,P.read_shift(2),!0),fe=j(q[0].r,P.read_shift(2),!1),G.push(Oe+fe);break;case 2:{var Ae=j(q[0].c,P.read_shift(2),!0),D=j(q[0].r,P.read_shift(2),!1);Oe=j(q[0].c,P.read_shift(2),!0),fe=j(q[0].r,P.read_shift(2),!1),G.push(Ae+D+":"+Oe+fe)}break;case 3:if(P.l<P.length){console.error("WK1 premature formula end");return}break;case 4:G.push("("+G.pop()+")");break;case 5:G.push(P.read_shift(2));break;case 6:{for(var Me="";be=P[P.l++];)Me+=String.fromCharCode(be);G.push('"'+Me.replace(/"/g,'""')+'"')}break;case 8:G.push("-"+G.pop());break;case 23:G.push("+"+G.pop());break;case 22:G.push("NOT("+G.pop()+")");break;case 20:case 21:re=G.pop(),Re=G.pop(),G.push(["AND","OR"][be-20]+"("+Re+","+re+")");break;default:if(be<32&&A[be])re=G.pop(),Re=G.pop(),G.push(Re+A[be]+re);else if(_[be]){if(Z=_[be][1],Z==69&&(Z=P[P.l++]),Z>G.length){console.error("WK1 bad formula parse 0x"+be.toString(16)+":|"+G.join("|")+"|");return}var ae=G.slice(-Z);G.length-=Z,G.push(_[be][0]+"("+ae.join(",")+")")}else return be<=7?console.error("WK1 invalid opcode "+be.toString(16)):be<=24?console.error("WK1 unsupported op "+be.toString(16)):be<=30?console.error("WK1 invalid opcode "+be.toString(16)):be<=115?console.error("WK1 unsupported function opcode "+be.toString(16)):console.error("WK1 unrecognized opcode "+be.toString(16))}}G.length==1?q[1].f=""+G[0]:console.error("WK1 bad formula parse |"+G.join("|")+"|")}function O(P){var q=[{c:0,r:0},{t:"n",v:0},0];return q[0].r=P.read_shift(2),q[3]=P[P.l++],q[0].c=P[P.l++],q}function C(P,q){var G=O(P);return G[1].t="s",G[1].v=P.read_shift(q-4,"cstr"),G}function T(P,q,G,Z){var fe=Pr(6+Z.length);fe.write_shift(2,P),fe.write_shift(1,G),fe.write_shift(1,q),fe.write_shift(1,39);for(var Oe=0;Oe<Z.length;++Oe){var Re=Z.charCodeAt(Oe);fe.write_shift(1,Re>=128?95:Re)}return fe.write_shift(1,0),fe}function I(P,q){var G=O(P);G[1].v=P.read_shift(2);var Z=G[1].v>>1;if(G[1].v&1)switch(Z&7){case 0:Z=(Z>>3)*5e3;break;case 1:Z=(Z>>3)*500;break;case 2:Z=(Z>>3)/20;break;case 3:Z=(Z>>3)/200;break;case 4:Z=(Z>>3)/2e3;break;case 5:Z=(Z>>3)/2e4;break;case 6:Z=(Z>>3)/16;break;case 7:Z=(Z>>3)/64;break}return G[1].v=Z,G}function M(P,q){var G=O(P),Z=P.read_shift(4),fe=P.read_shift(4),Oe=P.read_shift(2);if(Oe==65535)return Z===0&&fe===3221225472?(G[1].t="e",G[1].v=15):Z===0&&fe===3489660928?(G[1].t="e",G[1].v=42):G[1].v=0,G;var Re=Oe&32768;return Oe=(Oe&32767)-16446,G[1].v=(1-Re*2)*(fe*Math.pow(2,Oe+32)+Z*Math.pow(2,Oe)),G}function W(P,q,G,Z){var fe=Pr(14);if(fe.write_shift(2,P),fe.write_shift(1,G),fe.write_shift(1,q),Z==0)return fe.write_shift(4,0),fe.write_shift(4,0),fe.write_shift(2,65535),fe;var Oe=0,Re=0,re=0,be=0;return Z<0&&(Oe=1,Z=-Z),Re=Math.log2(Z)|0,Z/=Math.pow(2,Re-31),be=Z>>>0,(be&2147483648)==0&&(Z/=2,++Re,be=Z>>>0),Z-=be,be|=2147483648,be>>>=0,Z*=Math.pow(2,32),re=Z>>>0,fe.write_shift(4,re),fe.write_shift(4,be),Re+=16383+(Oe?32768:0),fe.write_shift(2,Re),fe}function U(P,q){var G=M(P);return P.l+=q-14,G}function F(P,q){var G=O(P),Z=P.read_shift(4);return G[1].v=Z>>6,G}function oe(P,q){var G=O(P),Z=P.read_shift(8,"f");return G[1].v=Z,G}function je(P,q){var G=oe(P);return P.l+=q-10,G}function ue(P,q){return P[P.l+q-1]==0?P.read_shift(q,"cstr"):""}function V(P,q){var G=P[P.l++];G>q-1&&(G=q-1);for(var Z="";Z.length<G;)Z+=String.fromCharCode(P[P.l++]);return Z}function H(P,q,G){if(!(!G.qpro||q<21)){var Z=P.read_shift(1);P.l+=17,P.l+=1,P.l+=2;var fe=P.read_shift(q-21,"cstr");return[Z,fe]}}function Se(P,q){for(var G={},Z=P.l+q;P.l<Z;){var fe=P.read_shift(2);if(fe==14e3){for(G[fe]=[0,""],G[fe][0]=P.read_shift(2);P[P.l];)G[fe][1]+=String.fromCharCode(P[P.l]),P.l++;P.l++}}return G}function Q(P,q){var G=Pr(5+P.length);G.write_shift(2,14e3),G.write_shift(2,q);for(var Z=0;Z<P.length;++Z){var fe=P.charCodeAt(Z);G[G.l++]=fe>127?95:fe}return G[G.l++]=0,G}var z={0:{n:"BOF",f:jr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:v},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:m},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ue},222:{n:"SHEETNAMELP",f:V},65535:{n:""}},Y={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:C},23:{n:"NUMBER17",f:M},24:{n:"NUMBER18",f:I},25:{n:"FORMULA19",f:U},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Se},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:F},38:{n:"??"},39:{n:"NUMBER27",f:oe},40:{n:"FORMULA28",f:je},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ue},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:H},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function iz(e){var t={},r=e.match(wn),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=ft(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=zb[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}var sz=function(){var e=Vf("t"),t=Vf("rPr");function r(i){var l=i.match(e);if(!l)return{t:"s",v:""};var u={t:"s",v:Dt(l[1])},h=i.match(t);return h&&(u.s=iz(h[1])),u}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(l){return l.replace(n,"").split(a).map(r).filter(function(u){return u.v})}}(),lz=function(){var t=/(\r\n|\n)/g;function r(a,i,l){var u=[];a.u&&u.push("text-decoration: underline;"),a.uval&&u.push("text-underline-style:"+a.uval+";"),a.sz&&u.push("font-size:"+a.sz+"pt;"),a.outline&&u.push("text-effect: outline;"),a.shadow&&u.push("text-shadow: auto;"),i.push('<span style="'+u.join("")+'">'),a.b&&(i.push("<b>"),l.push("</b>")),a.i&&(i.push("<i>"),l.push("</i>")),a.strike&&(i.push("<s>"),l.push("</s>"));var h=a.valign||"";return h=="superscript"||h=="super"?h="sup":h=="subscript"&&(h="sub"),h!=""&&(i.push("<"+h+">"),l.push("</"+h+">")),l.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&r(a.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),oz=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,cz=/<(?:\w+:)?r>/,uz=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function n2(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Dt(Zt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Zt(e),r&&(n.h=jO(n.t))):e.match(cz)&&(n.r=Zt(e),n.t=Dt(Zt((e.replace(uz,"").match(oz)||[]).join("").replace(wn,""))),r&&(n.h=lz(sz(n.r)))),n):{t:""}}var fz=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,dz=/<(?:\w+:)?(?:si|sstItem)>/g,hz=/<\/(?:\w+:)?(?:si|sstItem)>/;function mz(e,t){var r=[],n="";if(!e)return r;var a=e.match(fz);if(a){n=a[2].replace(dz,"").split(hz);for(var i=0;i!=n.length;++i){var l=n2(n[i].trim(),t);l!=null&&(r[r.length]=l)}a=ft(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}function pz(e){return[e.read_shift(4),e.read_shift(4)]}function xz(e,t){var r=[],n=!1;return vs(e,function(i,l,u){switch(u){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(l.T,!n||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function i5(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function os(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function vz(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=os(e,4),t.U=os(e,4),t.W=os(e,4),t}function gz(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function yz(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(gz(e));return t}function bz(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function wz(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=os(e,4),t.U=os(e,4),t.W=os(e,4),t}function Sz(e){var t=wz(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function s5(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function l5(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function Ez(e){var t=os(e);switch(t.Minor){case 2:return[t.Minor,jz(e)];case 3:return[t.Minor,Nz()];case 4:return[t.Minor,Az(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function jz(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=s5(e,r),a=l5(e,e.length-e.l);return{t:"Std",h:n,v:a}}function Nz(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Az(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(wn,function(i){var l=ft(i);switch(Ii(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(u){n[u]=l[u]});break;case"<dataIntegrity":n.encryptedHmacKey=l.encryptedHmacKey,n.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(l);break;default:throw l[0]}}),n}function _z(e,t){var r={},n=r.EncryptionVersionInfo=os(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=s5(e,a),t-=a,r.EncryptionVerifier=l5(e,t),r}function Tz(e){var t={},r=t.EncryptionVersionInfo=os(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function kz(e){var t=0,r,n=i5(e),a=n.length+1,i,l,u,h,d;for(r=pl(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)l=r[i],u=(t&16384)===0?0:1,h=t<<1&32767,d=u|h,t=d^l;return t^52811}var o5=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(l){return(l/2|l*128)&255},a=function(l,u){return n(l^u)},i=function(l){for(var u=t[l.length-1],h=104,d=l.length-1;d>=0;--d)for(var m=l[d],p=0;p!=7;++p)m&64&&(u^=r[h]),m*=2,--h;return u};return function(l){for(var u=i5(l),h=i(u),d=u.length,m=pl(16),p=0;p!=16;++p)m[p]=0;var v,g,w;for((d&1)===1&&(v=h>>8,m[d]=a(e[0],v),--d,v=h&255,g=u[u.length-1],m[d]=a(g,v));d>0;)--d,v=h>>8,m[d]=a(u[d],v),--d,v=h&255,m[d]=a(u[d],v);for(d=15,w=15-u.length;w>0;)v=h>>8,m[d]=a(e[w],v),--d,--w,v=h&255,m[d]=a(u[d],v),--d,--w;return m}}(),Cz=function(e,t,r,n,a){a||(a=t),n||(n=o5(e));var i,l;for(i=0;i!=t.length;++i)l=t[i],l^=n[r],l=(l>>5|l<<3)&255,a[i]=l,++r;return[a,r,n]},Oz=function(e){var t=0,r=o5(e);return function(n){var a=Cz("",n,t,r);return t=a[1],a[0]}};function Dz(e,t,r,n){var a={key:jr(e),verificationBytes:jr(e)};return r.password&&(a.verifier=kz(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=Oz(r.password)),a}function Pz(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Tz(e):n.Data=_z(e,t),n}function Rz(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?Pz(e,t-2,n):Dz(e,r.biff>=8?t:t-2,r,n),n}var Mz=function(){function e(a,i){switch(i.type){case"base64":return t(da(a),i);case"binary":return t(a,i);case"buffer":return t(_t&&Buffer.isBuffer(a)?a.toString("binary"):Eo(a),i);case"array":return t(xo(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var l=i||{},u=l.dense?[]:{},h=a.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(m,p){Array.isArray(u)&&(u[p]=[]);for(var v=/\\\w+\b/g,g=0,w,b=-1;w=v.exec(m);){switch(w[0]){case"\\cell":var S=m.slice(g,v.lastIndex-w[0].length);if(S[0]==" "&&(S=S.slice(1)),++b,S.length){var j={v:S,t:"s"};Array.isArray(u)?u[p][b]=j:u[wt({r:p,c:b})]=j}break}g=v.lastIndex}b>d.e.c&&(d.e.c=b)}),u["!ref"]=Ut(d),u}function r(a,i){return jo(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],l=qr(a["!ref"]),u,h=Array.isArray(a),d=l.s.r;d<=l.e.r;++d){i.push("\\trowd\\trautofit1");for(var m=l.s.c;m<=l.e.c;++m)i.push("\\cellx"+(m+1));for(i.push("\\pard\\intbl"),m=l.s.c;m<=l.e.c;++m){var p=wt({r:d,c:m});u=h?(a[d]||[])[m]:a[p],!(!u||u.v==null&&(!u.f||u.F))&&(i.push(" "+(u.w||(Oc(u),u.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function Fz(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Wf(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function Iz(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),i=Math.min(t,r,n),l=a-i;if(l===0)return[0,0,t];var u=0,h=0,d=a+i;switch(h=l/(d>1?2-d:d),a){case t:u=((r-n)/l+6)%6;break;case r:u=(n-t)/l+2;break;case n:u=(t-r)/l+4;break}return[u/6,h,d/2]}function Lz(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),i=n-a/2,l=[i,i,i],u=6*t,h;if(r!==0)switch(u|0){case 0:case 6:h=a*u,l[0]+=a,l[1]+=h;break;case 1:h=a*(2-u),l[0]+=h,l[1]+=a;break;case 2:h=a*(u-2),l[1]+=a,l[2]+=h;break;case 3:h=a*(4-u),l[1]+=h,l[2]+=a;break;case 4:h=a*(u-4),l[2]+=a,l[0]+=h;break;case 5:h=a*(6-u),l[2]+=h,l[0]+=a;break}for(var d=0;d!=3;++d)l[d]=Math.round(l[d]*255);return l}function Kh(e,t){if(t===0)return e;var r=Iz(Fz(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Wf(Lz(r))}var c5=6,Bz=15,Uz=1,Tn=c5;function Gh(e){return Math.floor((e+Math.round(128/Tn)/256)*Tn)}function Wh(e){return Math.floor((e-5)/Tn*100+.5)/100}function Ey(e){return Math.round((e*Tn+5)/Tn*256)/256}function hg(e){return Ey(Wh(Gh(e)))}function a2(e){var t=Math.abs(e-hg(e)),r=Tn;if(t>.005)for(Tn=Uz;Tn<Bz;++Tn)Math.abs(e-hg(e))<=t&&(t=Math.abs(e-hg(e)),r=Tn);Tn=r}function Dc(e){e.width?(e.wpx=Gh(e.width),e.wch=Wh(e.wpx),e.MDW=Tn):e.wpx?(e.wch=Wh(e.wpx),e.width=Ey(e.wch),e.MDW=Tn):typeof e.wch=="number"&&(e.width=Ey(e.wch),e.wpx=Gh(e.width),e.MDW=Tn),e.customWidth&&delete e.customWidth}var $z=96,u5=$z;function f5(e){return e*96/u5}function Yf(e){return e*u5/96}var zz={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Hz(e,t,r,n){t.Borders=[];var a={},i=!1;(e[0].match(wn)||[]).forEach(function(l){var u=ft(l);switch(Ii(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},u.diagonalUp&&(a.diagonalUp=tr(u.diagonalUp)),u.diagonalDown&&(a.diagonalDown=tr(u.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+u[0]+" in borders")}})}function qz(e,t,r,n){t.Fills=[];var a={},i=!1;(e[0].match(wn)||[]).forEach(function(l){var u=ft(l);switch(Ii(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":u.patternType&&(a.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),u.indexed&&(a.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(a.bgColor.theme=parseInt(u.theme,10)),u.tint&&(a.bgColor.tint=parseFloat(u.tint)),u.rgb&&(a.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),u.theme&&(a.fgColor.theme=parseInt(u.theme,10)),u.tint&&(a.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(a.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+u[0]+" in fills")}})}function Vz(e,t,r,n){t.Fonts=[];var a={},i=!1;(e[0].match(wn)||[]).forEach(function(l){var u=ft(l);switch(Ii(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":u.val&&(a.name=Zt(u.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=u.val?tr(u.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=u.val?tr(u.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(u.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=u.val?tr(u.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=u.val?tr(u.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=u.val?tr(u.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=u.val?tr(u.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=u.val?tr(u.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":u.val&&(a.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(a.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(a.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(a.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=zb[parseInt(u.val,10)];break;case"<color":if(a.color||(a.color={}),u.auto&&(a.color.auto=tr(u.auto)),u.rgb)a.color.rgb=u.rgb.slice(-6);else if(u.indexed){a.color.index=parseInt(u.indexed,10);var h=oo[a.color.index];a.color.index==81&&(h=oo[1]),h||(h=oo[1]),a.color.rgb=h[0].toString(16)+h[1].toString(16)+h[2].toString(16)}else u.theme&&(a.color.theme=parseInt(u.theme,10),u.tint&&(a.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=Kh(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+u[0]+" in fonts")}})}function Kz(e,t,r){t.NumberFmt=[];for(var n=xl(xt),a=0;a<n.length;++a)t.NumberFmt[n[a]]=xt[n[a]];var i=e[0].match(wn);if(i)for(a=0;a<i.length;++a){var l=ft(i[a]);switch(Ii(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=Dt(Zt(l.formatCode)),h=parseInt(l.numFmtId,10);if(t.NumberFmt[h]=u,h>0){if(h>392){for(h=392;h>60&&t.NumberFmt[h]!=null;--h);t.NumberFmt[h]=u}lo(u,h)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}var ih=["numFmtId","fillId","fontId","borderId","xfId"],sh=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Gz(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(wn)||[]).forEach(function(i){var l=ft(i),u=0;switch(Ii(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=l,delete n[0],u=0;u<ih.length;++u)n[ih[u]]&&(n[ih[u]]=parseInt(n[ih[u]],10));for(u=0;u<sh.length;++u)n[sh[u]]&&(n[sh[u]]=tr(n[sh[u]]));if(t.NumberFmt&&n.numFmtId>392){for(u=392;u>60;--u)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[u]){n.numFmtId=u;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var h={};l.vertical&&(h.vertical=l.vertical),l.horizontal&&(h.horizontal=l.horizontal),l.textRotation!=null&&(h.textRotation=l.textRotation),l.indent&&(h.indent=l.indent),l.wrapText&&(h.wrapText=tr(l.wrapText)),n.alignment=h;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}var Wz=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,h,d){var m={};if(!u)return m;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=u.match(t))&&Kz(p,m,d),(p=u.match(a))&&Vz(p,m,h,d),(p=u.match(n))&&qz(p,m,h,d),(p=u.match(i))&&Hz(p,m,h,d),(p=u.match(r))&&Gz(p,m,d),m}}();function Yz(e,t){var r=e.read_shift(2),n=yn(e);return[r,n]}function Xz(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=sU(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(n.underline=l);var u=e.read_shift(1);u>0&&(n.family=u);var h=e.read_shift(1);switch(h>0&&(n.charset=h),e.l++,n.color=iU(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=yn(e),n}var Zz=bn;function Qz(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}var Jz=bn;function eH(e,t,r){var n={};n.NumberFmt=[];for(var a in xt)n.NumberFmt[a]=xt[a];n.CellXf=[],n.Fonts=[];var i=[],l=!1;return vs(e,function(h,d,m){switch(m){case 44:n.NumberFmt[h[0]]=h[1],lo(h[1],h[0]);break;case 43:n.Fonts.push(h),h.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(h.color.rgb=Kh(t.themeElements.clrScheme[h.color.theme].rgb,h.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(h);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:i.push(m),l=!0;break;case 38:i.pop(),l=!1;break;default:if(d.T>0)i.push(m);else if(d.T<0)i.pop();else if(!l||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+m.toString(16))}}),n}var tH=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function rH(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(wn)||[]).forEach(function(a){var i=ft(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[tH.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function nH(){}function aH(){}var iH=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,sH=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,lH=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function oH(e,t,r){t.themeElements={};var n;[["clrScheme",iH,rH],["fontScheme",sH,nH],["fmtScheme",lH,aH]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var cH=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function d5(e,t){(!e||e.length===0)&&(e=uH());var r,n={};if(!(r=e.match(cH)))throw new Error("themeElements not found in theme");return oH(r[0],n,t),n.raw=e,n}function uH(e,t){var r=[SO];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function fH(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var l;try{l=wO(i,{type:"array"})}catch{return}var u=oa(l,"theme/theme/theme1.xml",!0);if(u)return d5(u,r)}}function dH(e){return e.read_shift(4)}function hH(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=mH(e,4);break;case 2:t.xclrValue=QO(e);break;case 3:t.xclrValue=dH(e);break;case 4:e.l+=4;break}return e.l+=8,t}function mH(e,t){return bn(e,t)}function pH(e,t){return bn(e,t)}function xH(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=hH(e);break;case 6:n[1]=pH(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function vH(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),i=[];a-- >0;)i.push(xH(e,r-e.l));return{ixfe:n,ext:i}}function gH(e,t){t.forEach(function(r){r[0]})}function yH(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:yn(e)}}function bH(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function wH(e){return e.l+=4,e.read_shift(4)!=0}function SH(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],l=!1,u=2;return vs(e,function(h,d,m){switch(m){case 335:n.Types.push({name:h.name});break;case 51:h.forEach(function(p){u==1?n.Cell.push({type:n.Types[p[0]-1].name,index:p[1]}):u==0&&n.Value.push({type:n.Types[p[0]-1].name,index:p[1]})});break;case 337:u=h?1:0;break;case 338:u=2;break;case 35:i.push(m),l=!0;break;case 36:i.pop(),l=!1;break;default:if(!d.T){if(!l||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}}),n}function EH(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,i=2,l;return e.replace(wn,function(u){var h=ft(u);switch(Ii(h[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:h.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==h.name&&(l=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[h.t-1].name,index:+h.v}):i==0&&n.Value.push({type:n.Types[h.t-1].name,index:+h.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+h.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+h[0]+" in metadata")}return u}),n}function jH(e){var t=[];if(!e)return t;var r=1;return(e.match(wn)||[]).forEach(function(n){var a=ft(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function NH(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=wt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function AH(e,t,r){var n=[];return vs(e,function(i,l,u){switch(u){case 63:n.push(i);break;default:if(!l.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function _H(e,t,r,n){if(!e)return e;var a=n||{},i=!1;vs(e,function(u,h,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!h.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},a)}function TH(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function p_(e,t,r,n){var a=Array.isArray(e),i;t.forEach(function(l){var u=ui(l.ref);if(a?(e[u.r]||(e[u.r]=[]),i=e[u.r][u.c]):i=e[l.ref],!i){i={t:"z"},a?e[u.r][u.c]=i:e[l.ref]=i;var h=qr(e["!ref"]||"BDWGO1000001:A1");h.s.r>u.r&&(h.s.r=u.r),h.e.r<u.r&&(h.e.r=u.r),h.s.c>u.c&&(h.s.c=u.c),h.e.c<u.c&&(h.e.c=u.c);var d=Ut(h);d!==e["!ref"]&&(e["!ref"]=d)}i.c||(i.c=[]);var m={a:l.author,t:l.t,r:l.r,T:r};l.h&&(m.h=l.h);for(var p=i.c.length-1;p>=0;--p){if(!r&&i.c[p].T)return;r&&!i.c[p].T&&i.c.splice(p,1)}if(r&&n){for(p=0;p<n.length;++p)if(m.a==n[p].id){m.a=n[p].name||m.a;break}}i.c.push(m)})}function kH(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?comment[^>]*>/);if(u){var h=ft(u[0]),d={author:h.authorId&&r[h.authorId]||"sheetjsghost",ref:h.ref,guid:h.guid},m=ui(h.ref);if(!(t.sheetRows&&t.sheetRows<=m.r)){var p=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),v=!!p&&!!p[1]&&n2(p[1])||{r:"",t:"",h:""};d.r=v.r,v.r=="<t></t>"&&(v.t=v.h=""),d.t=(v.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(d.h=v.h),n.push(d)}}}}),n}function CH(e,t){var r=[],n=!1,a={},i=0;return e.replace(wn,function(u,h){var d=ft(u);switch(Ii(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":i=h+u.length;break;case"</text>":a.t=e.slice(i,h).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return u}),r}function OH(e,t){var r=[],n=!1;return e.replace(wn,function(i){var l=ft(i);switch(Ii(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return i}),r}function DH(e){var t={};t.iauthor=e.read_shift(4);var r=Ao(e);return t.rfx=r.s,t.ref=wt(r.s),e.l+=16,t}var PH=yn;function RH(e,t){var r=[],n=[],a={},i=!1;return vs(e,function(u,h,d){switch(d){case 632:n.push(u);break;case 635:a=u;break;case 637:a.t=u.t,a.h=u.h,a.r=u.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!h.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}var MH="application/vnd.ms-office.vbaProject";function FH(e){var t=Ct.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ct.utils.cfb_add(t,a,e.FileIndex[n].content)}}),Ct.write(t)}function IH(){return{"!type":"dialog"}}function LH(){return{"!type":"dialog"}}function BH(){return{"!type":"macro"}}function UH(){return{"!type":"macro"}}var _c=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,l){var u=!1,h=!1;i.length==0?h=!0:i.charAt(0)=="["&&(h=!0,i=i.slice(1,-1)),l.length==0?u=!0:l.charAt(0)=="["&&(u=!0,l=l.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,m=l.length>0?parseInt(l,10)|0:0;return u?m+=t.c:--m,h?d+=t.r:--d,a+(u?"":"$")+kn(m)+(h?"":"$")+ua(d)}return function(a,i){return t=i,a.replace(e,r)}}(),h5=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,$H=function(){return function(t,r){return t.replace(h5,function(n,a,i,l,u,h){var d=UO(l)-(i?0:r.c),m=BO(h)-(u?0:r.r),p=m==0?"":u?m+1:"["+m+"]",v=d==0?"":i?d+1:"["+d+"]";return a+"R"+p+"C"+v})}}();function m5(e,t){return e.replace(h5,function(r,n,a,i,l,u){return n+(a=="$"?a+i:kn(UO(i)+t.c))+(l=="$"?l+u:ua(BO(u)+t.r))})}function zH(e,t,r){var n=Zb(t),a=n.s,i=ui(r),l={r:i.r-a.r,c:i.c-a.c};return m5(e,l)}function HH(e){return e.length!=1}function x_(e){return e.replace(/_xlfn\./g,"")}function wr(e){e.l+=1}function vl(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function p5(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return x5(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),l=vl(e),u=vl(e);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:i,c:u[0],cRel:u[1],rRel:u[2]}}}function x5(e){var t=vl(e),r=vl(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function qH(e,t,r){if(r.biff<8)return x5(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=vl(e),l=vl(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function v5(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return VH(e);var n=e.read_shift(r&&r.biff==12?4:2),a=vl(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function VH(e){var t=vl(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function KH(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function GH(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return WH(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),l=(i&16384)>>14,u=(i&32768)>>15;if(i&=16383,u==1)for(;a>524287;)a-=1048576;if(l==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:l,rRel:u}}function WH(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function YH(e,t,r){var n=(e[e.l++]&96)>>5,a=p5(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function XH(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var l=p5(e,i,r);return[n,a,l]}function ZH(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function QH(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function JH(e,t,r){var n=(e[e.l++]&96)>>5,a=qH(e,t-1,r);return[n,a]}function eq(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function v_(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function tq(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function rq(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function nq(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function aq(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function iq(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function g5(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function sq(e){return e.read_shift(2),g5(e)}function lq(e){return e.read_shift(2),g5(e)}function oq(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=v5(e,0,r);return[n,a]}function cq(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=GH(e,0,r);return[n,a]}function uq(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=v5(e,0,r);return[n,a,i]}function fq(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[dV[a],w5[a],n]}function dq(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:hq(e);return[a,(i[0]===0?w5:fV)[i[1]]]}function hq(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function mq(e,t,r){e.l+=r&&r.biff==2?3:4}function pq(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function xq(e){return e.l++,_o[e.read_shift(1)]}function vq(e){return e.l++,e.read_shift(2)}function gq(e){return e.l++,e.read_shift(1)!==0}function yq(e){return e.l++,vn(e)}function bq(e,t,r){return e.l++,pd(e,t-1,r)}function wq(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=pr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=_o[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=vn(e);break;case 2:r[1]=To(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Sq(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?Ao:Xm)(e));return a}function Eq(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,l=[];i!=n&&(l[i]=[]);++i)for(var u=0;u!=a;++u)l[i][u]=wq(e,r.biff);return l}function jq(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function Nq(e,t,r){if(r.biff==5)return Aq(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function Aq(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function _q(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function Tq(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function kq(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function Cq(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var Oq=bn,Dq=bn,Pq=bn;function vd(e,t,r){return e.l+=2,[KH(e)]}function i2(e){return e.l+=6,[]}var Rq=vd,Mq=i2,Fq=i2,Iq=vd;function y5(e){return e.l+=2,[jr(e),e.read_shift(2)&1]}var Lq=vd,Bq=y5,Uq=i2,$q=vd,zq=vd,Hq=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function qq(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),l=Hq[r>>2&31];return{ixti:t,coltype:r&3,rt:l,idx:n,c:a,C:i}}function Vq(e){return e.l+=2,[e.read_shift(4)]}function Kq(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function Gq(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Wq(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Yq(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Xq(e){return e.l+=4,[0,0]}var g_={1:{n:"PtgExp",f:pq},2:{n:"PtgTbl",f:Pq},3:{n:"PtgAdd",f:wr},4:{n:"PtgSub",f:wr},5:{n:"PtgMul",f:wr},6:{n:"PtgDiv",f:wr},7:{n:"PtgPower",f:wr},8:{n:"PtgConcat",f:wr},9:{n:"PtgLt",f:wr},10:{n:"PtgLe",f:wr},11:{n:"PtgEq",f:wr},12:{n:"PtgGe",f:wr},13:{n:"PtgGt",f:wr},14:{n:"PtgNe",f:wr},15:{n:"PtgIsect",f:wr},16:{n:"PtgUnion",f:wr},17:{n:"PtgRange",f:wr},18:{n:"PtgUplus",f:wr},19:{n:"PtgUminus",f:wr},20:{n:"PtgPercent",f:wr},21:{n:"PtgParen",f:wr},22:{n:"PtgMissArg",f:wr},23:{n:"PtgStr",f:bq},26:{n:"PtgSheet",f:Kq},27:{n:"PtgEndSheet",f:Gq},28:{n:"PtgErr",f:xq},29:{n:"PtgBool",f:gq},30:{n:"PtgInt",f:vq},31:{n:"PtgNum",f:yq},32:{n:"PtgArray",f:eq},33:{n:"PtgFunc",f:fq},34:{n:"PtgFuncVar",f:dq},35:{n:"PtgName",f:jq},36:{n:"PtgRef",f:oq},37:{n:"PtgArea",f:YH},38:{n:"PtgMemArea",f:_q},39:{n:"PtgMemErr",f:Oq},40:{n:"PtgMemNoMem",f:Dq},41:{n:"PtgMemFunc",f:Tq},42:{n:"PtgRefErr",f:kq},43:{n:"PtgAreaErr",f:ZH},44:{n:"PtgRefN",f:cq},45:{n:"PtgAreaN",f:JH},46:{n:"PtgMemAreaN",f:Wq},47:{n:"PtgMemNoMemN",f:Yq},57:{n:"PtgNameX",f:Nq},58:{n:"PtgRef3d",f:uq},59:{n:"PtgArea3d",f:XH},60:{n:"PtgRefErr3d",f:Cq},61:{n:"PtgAreaErr3d",f:QH},255:{}},Zq={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Qq={1:{n:"PtgElfLel",f:y5},2:{n:"PtgElfRw",f:$q},3:{n:"PtgElfCol",f:Rq},6:{n:"PtgElfRwV",f:zq},7:{n:"PtgElfColV",f:Iq},10:{n:"PtgElfRadical",f:Lq},11:{n:"PtgElfRadicalS",f:Uq},13:{n:"PtgElfColS",f:Mq},15:{n:"PtgElfColSV",f:Fq},16:{n:"PtgElfRadicalLel",f:Bq},25:{n:"PtgList",f:qq},29:{n:"PtgSxName",f:Vq},255:{}},Jq={0:{n:"PtgAttrNoop",f:Xq},1:{n:"PtgAttrSemi",f:iq},2:{n:"PtgAttrIf",f:nq},4:{n:"PtgAttrChoose",f:tq},8:{n:"PtgAttrGoto",f:rq},16:{n:"PtgAttrSum",f:mq},32:{n:"PtgAttrBaxcel",f:v_},33:{n:"PtgAttrBaxcel",f:v_},64:{n:"PtgAttrSpace",f:sq},65:{n:"PtgAttrSpaceSemi",f:lq},128:{n:"PtgAttrIfError",f:aq},255:{}};function gd(e,t,r,n){if(n.biff<8)return bn(e,t);for(var a=e.l+t,i=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=Eq(e,0,n),i.push(r[l][1]);break;case"PtgMemArea":r[l][2]=Sq(e,r[l][1],n),i.push(r[l][2]);break;case"PtgExp":n&&n.biff==12&&(r[l][1][1]=e.read_shift(4),i.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return t=a-e.l,t!==0&&i.push(bn(e,t)),i}function yd(e,t,r){for(var n=e.l+t,a,i,l=[];n!=e.l;)t=n-e.l,i=e[e.l],a=g_[i]||g_[Zq[i]],(i===24||i===25)&&(a=(i===24?Qq:Jq)[e[e.l+1]]),!a||!a.f?bn(e,t):l.push([a.n,a.f(e,t,r)]);return l}function eV(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var l=n[i];if(l)switch(l[0]){case 2:a.push('"'+l[1].replace(/"/g,'""')+'"');break;default:a.push(l[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var tV={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function rV(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function b5(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function y_(e,t,r){var n=b5(e,t,r);return n=="#REF"?n:rV(n,r)}function dn(e,t,r,n,a){var i=a&&a.biff||8,l={s:{c:0,r:0}},u=[],h,d,m,p=0,v=0,g,w="";if(!e[0]||!e[0][0])return"";for(var b=-1,S="",j=0,_=e[0].length;j<_;++j){var A=e[0][j];switch(A[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=u.pop(),d=u.pop(),b>=0){switch(e[0][b][1][0]){case 0:S=ur(" ",e[0][b][1][1]);break;case 1:S=ur("\r",e[0][b][1][1]);break;default:if(S="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][b][1][0])}d=d+S,b=-1}u.push(d+tV[A[0]]+h);break;case"PtgIsect":h=u.pop(),d=u.pop(),u.push(d+" "+h);break;case"PtgUnion":h=u.pop(),d=u.pop(),u.push(d+","+h);break;case"PtgRange":h=u.pop(),d=u.pop(),u.push(d+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":m=_f(A[1][1],l,a),u.push(Tf(m,i));break;case"PtgRefN":m=r?_f(A[1][1],r,a):A[1][1],u.push(Tf(m,i));break;case"PtgRef3d":p=A[1][1],m=_f(A[1][2],l,a),w=y_(n,p,a),u.push(w+"!"+Tf(m,i));break;case"PtgFunc":case"PtgFuncVar":var k=A[1][0],O=A[1][1];k||(k=0),k&=127;var C=k==0?[]:u.slice(-k);u.length-=k,O==="User"&&(O=C.shift()),u.push(O+"("+C.join(",")+")");break;case"PtgBool":u.push(A[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(A[1]);break;case"PtgNum":u.push(String(A[1]));break;case"PtgStr":u.push('"'+A[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(A[1]);break;case"PtgAreaN":g=JA(A[1][1],r?{s:r}:l,a),u.push(fg(g,a));break;case"PtgArea":g=JA(A[1][1],l,a),u.push(fg(g,a));break;case"PtgArea3d":p=A[1][1],g=A[1][2],w=y_(n,p,a),u.push(w+"!"+fg(g,a));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":v=A[1][2];var T=(n.names||[])[v-1]||(n[0]||[])[v],I=T?T.Name:"SH33TJSNAME"+String(v);I&&I.slice(0,6)=="_xlfn."&&!a.xlfn&&(I=I.slice(6)),u.push(I);break;case"PtgNameX":var M=A[1][1];v=A[1][2];var W;if(a.biff<=5)M<0&&(M=-M),n[M]&&(W=n[M][v]);else{var U="";if(((n[M]||[])[0]||[])[0]==14849||(((n[M]||[])[0]||[])[0]==1025?n[M][v]&&n[M][v].itab>0&&(U=n.SheetNames[n[M][v].itab-1]+"!"):U=n.SheetNames[v-1]+"!"),n[M]&&n[M][v])U+=n[M][v].Name;else if(n[0]&&n[0][v])U+=n[0][v].Name;else{var F=(b5(n,M,a)||"").split(";;");F[v-1]?U=F[v-1]:U+="SH33TJSERRX"}u.push(U);break}W||(W={Name:"SH33TJSERRY"}),u.push(W.Name);break;case"PtgParen":var oe="(",je=")";if(b>=0){switch(S="",e[0][b][1][0]){case 2:oe=ur(" ",e[0][b][1][1])+oe;break;case 3:oe=ur("\r",e[0][b][1][1])+oe;break;case 4:je=ur(" ",e[0][b][1][1])+je;break;case 5:je=ur("\r",e[0][b][1][1])+je;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][b][1][0])}b=-1}u.push(oe+u.pop()+je);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":m={c:A[1][1],r:A[1][0]};var ue={c:r.c,r:r.r};if(n.sharedf[wt(m)]){var V=n.sharedf[wt(m)];u.push(dn(V,l,ue,n,a))}else{var H=!1;for(h=0;h!=n.arrayf.length;++h)if(d=n.arrayf[h],!(m.c<d[0].s.c||m.c>d[0].e.c)&&!(m.r<d[0].s.r||m.r>d[0].e.r)){u.push(dn(d[1],l,ue,n,a)),H=!0;break}H||u.push(A[1])}break;case"PtgArray":u.push("{"+eV(A[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":b=j;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+A[1].idx+"[#"+A[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(A));default:throw new Error("Unrecognized Formula Token: "+String(A))}var Se=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&b>=0&&Se.indexOf(e[0][j][0])==-1){A=e[0][b];var Q=!0;switch(A[1][0]){case 4:Q=!1;case 0:S=ur(" ",A[1][1]);break;case 5:Q=!1;case 1:S=ur("\r",A[1][1]);break;default:if(S="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+A[1][0])}u.push((Q?S:"")+u.pop()+(Q?"":S)),b=-1}}if(u.length>1&&a.WTF)throw new Error("bad formula stack");return u[0]}function nV(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,l=e.read_shift(a);if(l==65535)return[[],bn(e,t-2)];var u=yd(e,l,r);return t!==l+a&&(i=gd(e,t-l-a,u,r)),e.l=n,[u,i]}function aV(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,l=e.read_shift(a);if(l==65535)return[[],bn(e,t-2)];var u=yd(e,l,r);return t!==l+a&&(i=gd(e,t-l-a,u,r)),e.l=n,[u,i]}function iV(e,t,r,n){var a=e.l+t,i=yd(e,n,r),l;return a!==e.l&&(l=gd(e,a-e.l,i,r)),[i,l]}function sV(e,t,r){var n=e.l+t,a,i=e.read_shift(2),l=yd(e,i,r);return i==65535?[[],bn(e,t-2)]:(t!==i+2&&(a=gd(e,n-i-2,l,r)),[l,a])}function lV(e){var t;if(rs(e,e.l+6)!==65535)return[vn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function mg(e,t,r){var n=e.l+t,a=Li(e);r.biff==2&&++e.l;var i=lV(e),l=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var u=aV(e,n-e.l,r);return{cell:a,val:i[0],formula:u,shared:l>>3&1,tt:i[1]}}function Zm(e,t,r){var n=e.read_shift(4),a=yd(e,n,r),i=e.read_shift(4),l=i>0?gd(e,i,a,r):null;return[a,l]}var oV=Zm,Qm=Zm,cV=Zm,uV=Zm,fV={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},w5={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},dV={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function b_(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function pg(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Df={},Tc={};function Pf(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function S5(e,t,r,n,a,i){try{n.cellNF&&(e.z=xt[t])}catch(u){if(n.WTF)throw u}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=en(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(xt[t]==null&&lo(p9[t]||"General",t),e.t==="e")e.w=e.w||_o[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Hf(e.v);else if(e.t==="d"){var l=ha(e.v);(l|0)===l?e.w=l.toString(10):e.w=Hf(l)}else{if(e.v===void 0)return"";e.w=po(e.v,Tc)}else e.t==="d"?e.w=Ha(t,ha(e.v),Tc):e.w=Ha(t,e.v,Tc)}catch(u){if(n.WTF)throw u}if(n.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Kh(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Kh(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(u){if(n.WTF&&i.Fills)throw u}}}function hV(e,t){var r=qr(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Ut(r))}var mV=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,pV=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,xV=/<(?:\w:)?hyperlink [^>]*>/mg,vV=/"(\w*:\w*)"/,gV=/<(?:\w:)?col\b[^>]*[\/]?>/g,yV=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,bV=/<(?:\w:)?pageMargins[^>]*\/>/g,E5=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,wV=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,SV=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function EV(e,t,r,n,a,i,l){if(!e)return e;n||(n={"!id":{}});var u=t.dense?[]:{},h={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",m="",p=e.match(pV);p?(d=e.slice(0,p.index),m=e.slice(p.index+p[0].length)):d=m=e;var v=d.match(E5);v?s2(v[0],u,a,r):(v=d.match(wV))&&jV(v[0],v[1]||"",u,a,r);var g=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(g>0){var w=d.slice(g,g+50).match(vV);w&&hV(u,w[1])}var b=d.match(SV);b&&b[1]&&CV(b[1],a);var S=[];if(t.cellStyles){var j=d.match(gV);j&&_V(S,j)}p&&OV(p[1],u,t,h,i,l);var _=m.match(yV);_&&(u["!autofilter"]=TV(_[0]));var A=[],k=m.match(mV);if(k)for(g=0;g!=k.length;++g)A[g]=qr(k[g].slice(k[g].indexOf('"')+1));var O=m.match(xV);O&&NV(u,O,n);var C=m.match(bV);if(C&&(u["!margins"]=AV(ft(C[0]))),!u["!ref"]&&h.e.c>=h.s.c&&h.e.r>=h.s.r&&(u["!ref"]=Ut(h)),t.sheetRows>0&&u["!ref"]){var T=qr(u["!ref"]);t.sheetRows<=+T.e.r&&(T.e.r=t.sheetRows-1,T.e.r>h.e.r&&(T.e.r=h.e.r),T.e.r<T.s.r&&(T.s.r=T.e.r),T.e.c>h.e.c&&(T.e.c=h.e.c),T.e.c<T.s.c&&(T.s.c=T.e.c),u["!fullref"]=u["!ref"],u["!ref"]=Ut(T))}return S.length>0&&(u["!cols"]=S),A.length>0&&(u["!merges"]=A),u}function s2(e,t,r,n){var a=ft(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Dt(Zt(a.codeName)))}function jV(e,t,r,n,a){s2(e.slice(0,e.indexOf(">")),r,n,a)}function NV(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var i=ft(Zt(t[a]),!0);if(!i.ref)return;var l=((r||{})["!id"]||[])[i.id];l?(i.Target=l.Target,i.location&&(i.Target+="#"+Dt(i.location))):(i.Target="#"+Dt(i.location),l={Target:i.Target,TargetMode:"Internal"}),i.Rel=l,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var u=qr(i.ref),h=u.s.r;h<=u.e.r;++h)for(var d=u.s.c;d<=u.e.c;++d){var m=wt({c:d,r:h});n?(e[h]||(e[h]=[]),e[h][d]||(e[h][d]={t:"z",v:void 0}),e[h][d].l=i):(e[m]||(e[m]={t:"z",v:void 0}),e[m].l=i)}}}function AV(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function _V(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=ft(t[n],!0);a.hidden&&(a.hidden=tr(a.hidden));var i=parseInt(a.min,10)-1,l=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,a2(a.width)),Dc(a);i<=l;)e[i++]=tn(a)}}function TV(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var kV=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function CV(e,t){t.Views||(t.Views=[{}]),(e.match(kV)||[]).forEach(function(r,n){var a=ft(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),tr(a.rightToLeft)&&(t.Views[n].RTL=!0)})}var OV=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=Vf("v"),l=Vf("f");return function(h,d,m,p,v,g){for(var w=0,b="",S=[],j=[],_=0,A=0,k=0,O="",C,T,I=0,M=0,W,U,F=0,oe=0,je=Array.isArray(g.CellXf),ue,V=[],H=[],Se=Array.isArray(d),Q=[],z={},Y=!1,P=!!m.sheetStubs,q=h.split(t),G=0,Z=q.length;G!=Z;++G){b=q[G].trim();var fe=b.length;if(fe!==0){var Oe=0;e:for(w=0;w<fe;++w)switch(b[w]){case">":if(b[w-1]!="/"){++w;break e}if(m&&m.cellStyles){if(T=ft(b.slice(Oe,w),!0),I=T.r!=null?parseInt(T.r,10):I+1,M=-1,m.sheetRows&&m.sheetRows<I)continue;z={},Y=!1,T.ht&&(Y=!0,z.hpt=parseFloat(T.ht),z.hpx=Yf(z.hpt)),T.hidden=="1"&&(Y=!0,z.hidden=!0),T.outlineLevel!=null&&(Y=!0,z.level=+T.outlineLevel),Y&&(Q[I-1]=z)}break;case"<":Oe=w;break}if(Oe>=w)break;if(T=ft(b.slice(Oe,w),!0),I=T.r!=null?parseInt(T.r,10):I+1,M=-1,!(m.sheetRows&&m.sheetRows<I)){p.s.r>I-1&&(p.s.r=I-1),p.e.r<I-1&&(p.e.r=I-1),m&&m.cellStyles&&(z={},Y=!1,T.ht&&(Y=!0,z.hpt=parseFloat(T.ht),z.hpx=Yf(z.hpt)),T.hidden=="1"&&(Y=!0,z.hidden=!0),T.outlineLevel!=null&&(Y=!0,z.level=+T.outlineLevel),Y&&(Q[I-1]=z)),S=b.slice(w).split(e);for(var Re=0;Re!=S.length&&S[Re].trim().charAt(0)=="<";++Re);for(S=S.slice(Re),w=0;w!=S.length;++w)if(b=S[w].trim(),b.length!==0){if(j=b.match(r),_=w,A=0,k=0,b="<c "+(b.slice(0,1)=="<"?">":"")+b,j!=null&&j.length===2){for(_=0,O=j[1],A=0;A!=O.length&&!((k=O.charCodeAt(A)-64)<1||k>26);++A)_=26*_+k;--_,M=_}else++M;for(A=0;A!=b.length&&b.charCodeAt(A)!==62;++A);if(++A,T=ft(b.slice(0,A),!0),T.r||(T.r=wt({r:I-1,c:M})),O=b.slice(A),C={t:""},(j=O.match(i))!=null&&j[1]!==""&&(C.v=Dt(j[1])),m.cellFormula){if((j=O.match(l))!=null&&j[1]!==""){if(C.f=Dt(Zt(j[1])).replace(/\r\n/g,`
`),m.xlfn||(C.f=x_(C.f)),j[0].indexOf('t="array"')>-1)C.F=(O.match(a)||[])[1],C.F.indexOf(":")>-1&&V.push([qr(C.F),C.F]);else if(j[0].indexOf('t="shared"')>-1){U=ft(j[0]);var re=Dt(Zt(j[1]));m.xlfn||(re=x_(re)),H[parseInt(U.si,10)]=[U,re,T.r]}}else(j=O.match(/<f[^>]*\/>/))&&(U=ft(j[0]),H[U.si]&&(C.f=zH(H[U.si][1],H[U.si][2],T.r)));var be=ui(T.r);for(A=0;A<V.length;++A)be.r>=V[A][0].s.r&&be.r<=V[A][0].e.r&&be.c>=V[A][0].s.c&&be.c<=V[A][0].e.c&&(C.F=V[A][1])}if(T.t==null&&C.v===void 0)if(C.f||C.F)C.v=0,C.t="n";else if(P)C.t="z";else continue;else C.t=T.t||"n";switch(p.s.c>M&&(p.s.c=M),p.e.c<M&&(p.e.c=M),C.t){case"n":if(C.v==""||C.v==null){if(!P)continue;C.t="z"}else C.v=parseFloat(C.v);break;case"s":if(typeof C.v>"u"){if(!P)continue;C.t="z"}else W=Df[parseInt(C.v,10)],C.v=W.t,C.r=W.r,m.cellHTML&&(C.h=W.h);break;case"str":C.t="s",C.v=C.v!=null?Zt(C.v):"",m.cellHTML&&(C.h=jO(C.v));break;case"inlineStr":j=O.match(n),C.t="s",j!=null&&(W=n2(j[1]))?(C.v=W.t,m.cellHTML&&(C.h=W.h)):C.v="";break;case"b":C.v=tr(C.v);break;case"d":m.cellDates?C.v=en(C.v,1):(C.v=ha(en(C.v,1)),C.t="n");break;case"e":(!m||m.cellText!==!1)&&(C.w=C.v),C.v=qO[C.v];break}if(F=oe=0,ue=null,je&&T.s!==void 0&&(ue=g.CellXf[T.s],ue!=null&&(ue.numFmtId!=null&&(F=ue.numFmtId),m.cellStyles&&ue.fillId!=null&&(oe=ue.fillId))),S5(C,F,oe,m,v,g),m.cellDates&&je&&C.t=="n"&&Zc(xt[F])&&(C.t="d",C.v=Ym(C.v)),T.cm&&m.xlmeta){var Ae=(m.xlmeta.Cell||[])[+T.cm-1];Ae&&Ae.type=="XLDAPR"&&(C.D=!0)}if(Se){var D=ui(T.r);d[D.r]||(d[D.r]=[]),d[D.r][D.c]=C}else d[T.r]=C}}}}Q.length>0&&(d["!rows"]=Q)}}();function DV(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}var PV=Ao;function RV(){}function MV(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=nU(e),r}function FV(e){var t=Ya(e);return[t]}function IV(e){var t=No(e);return[t]}function LV(e){var t=Ya(e),r=e.read_shift(1);return[t,r,"b"]}function BV(e){var t=No(e),r=e.read_shift(1);return[t,r,"b"]}function UV(e){var t=Ya(e),r=e.read_shift(1);return[t,r,"e"]}function $V(e){var t=No(e),r=e.read_shift(1);return[t,r,"e"]}function zV(e){var t=Ya(e),r=e.read_shift(4);return[t,r,"s"]}function HV(e){var t=No(e),r=e.read_shift(4);return[t,r,"s"]}function qV(e){var t=Ya(e),r=vn(e);return[t,r,"n"]}function j5(e){var t=No(e),r=vn(e);return[t,r,"n"]}function VV(e){var t=Ya(e),r=e2(e);return[t,r,"n"]}function KV(e){var t=No(e),r=e2(e);return[t,r,"n"]}function GV(e){var t=Ya(e),r=Qb(e);return[t,r,"is"]}function WV(e){var t=Ya(e),r=yn(e);return[t,r,"str"]}function YV(e){var t=No(e),r=yn(e);return[t,r,"str"]}function XV(e,t,r){var n=e.l+t,a=Ya(e);a.r=r["!row"];var i=e.read_shift(1),l=[a,i,"b"];if(r.cellFormula){e.l+=2;var u=Qm(e,n-e.l,r);l[3]=dn(u,null,a,r.supbooks,r)}else e.l=n;return l}function ZV(e,t,r){var n=e.l+t,a=Ya(e);a.r=r["!row"];var i=e.read_shift(1),l=[a,i,"e"];if(r.cellFormula){e.l+=2;var u=Qm(e,n-e.l,r);l[3]=dn(u,null,a,r.supbooks,r)}else e.l=n;return l}function QV(e,t,r){var n=e.l+t,a=Ya(e);a.r=r["!row"];var i=vn(e),l=[a,i,"n"];if(r.cellFormula){e.l+=2;var u=Qm(e,n-e.l,r);l[3]=dn(u,null,a,r.supbooks,r)}else e.l=n;return l}function JV(e,t,r){var n=e.l+t,a=Ya(e);a.r=r["!row"];var i=yn(e),l=[a,i,"str"];if(r.cellFormula){e.l+=2;var u=Qm(e,n-e.l,r);l[3]=dn(u,null,a,r.supbooks,r)}else e.l=n;return l}var eK=Ao;function tK(e,t){var r=e.l+t,n=Ao(e),a=Jb(e),i=yn(e),l=yn(e),u=yn(e);e.l=r;var h={rfx:n,relId:a,loc:i,display:u};return l&&(h.Tooltip=l),h}function rK(){}function nK(e,t,r){var n=e.l+t,a=$O(e),i=e.read_shift(1),l=[a];if(l[2]=i,r.cellFormula){var u=oV(e,n-e.l,r);l[1]=u}else e.l=n;return l}function aK(e,t,r){var n=e.l+t,a=Ao(e),i=[a];if(r.cellFormula){var l=uV(e,n-e.l,r);i[1]=l,e.l=n}else e.l=n;return i}var iK=["left","right","top","bottom","header","footer"];function sK(e){var t={};return iK.forEach(function(r){t[r]=vn(e)}),t}function lK(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function oK(){}function cK(){}function uK(e,t,r,n,a,i,l){if(!e)return e;var u=t||{};n||(n={"!id":{}});var h=u.dense?[]:{},d,m={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=!1,v=!1,g,w,b,S,j,_,A,k,O,C=[];u.biff=12,u["!row"]=0;var T=0,I=!1,M=[],W={},U=u.supbooks||a.supbooks||[[]];if(U.sharedf=W,U.arrayf=M,U.SheetNames=a.SheetNames||a.Sheets.map(function(Se){return Se.name}),!u.supbooks&&(u.supbooks=U,a.Names))for(var F=0;F<a.Names.length;++F)U[0][F+1]=a.Names[F];var oe=[],je=[],ue=!1;Yh[16]={n:"BrtShortReal",f:j5};var V;if(vs(e,function(Q,z,Y){if(!v)switch(Y){case 148:d=Q;break;case 0:g=Q,u.sheetRows&&u.sheetRows<=g.r&&(v=!0),k=ua(S=g.r),u["!row"]=g.r,(Q.hidden||Q.hpt||Q.level!=null)&&(Q.hpt&&(Q.hpx=Yf(Q.hpt)),je[Q.r]=Q);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(w={t:Q[2]},Q[2]){case"n":w.v=Q[1];break;case"s":A=Df[Q[1]],w.v=A.t,w.r=A.r;break;case"b":w.v=!!Q[1];break;case"e":w.v=Q[1],u.cellText!==!1&&(w.w=_o[w.v]);break;case"str":w.t="s",w.v=Q[1];break;case"is":w.t="s",w.v=Q[1].t;break}if((b=l.CellXf[Q[0].iStyleRef])&&S5(w,b.numFmtId,null,u,i,l),j=Q[0].c==-1?j+1:Q[0].c,u.dense?(h[S]||(h[S]=[]),h[S][j]=w):h[kn(j)+k]=w,u.cellFormula){for(I=!1,T=0;T<M.length;++T){var P=M[T];g.r>=P[0].s.r&&g.r<=P[0].e.r&&j>=P[0].s.c&&j<=P[0].e.c&&(w.F=Ut(P[0]),I=!0)}!I&&Q.length>3&&(w.f=Q[3])}if(m.s.r>g.r&&(m.s.r=g.r),m.s.c>j&&(m.s.c=j),m.e.r<g.r&&(m.e.r=g.r),m.e.c<j&&(m.e.c=j),u.cellDates&&b&&w.t=="n"&&Zc(xt[b.numFmtId])){var q=eo(w.v);q&&(w.t="d",w.v=new Date(q.y,q.m-1,q.d,q.H,q.M,q.S,q.u))}V&&(V.type=="XLDAPR"&&(w.D=!0),V=void 0);break;case 1:case 12:if(!u.sheetStubs||p)break;w={t:"z",v:void 0},j=Q[0].c==-1?j+1:Q[0].c,u.dense?(h[S]||(h[S]=[]),h[S][j]=w):h[kn(j)+k]=w,m.s.r>g.r&&(m.s.r=g.r),m.s.c>j&&(m.s.c=j),m.e.r<g.r&&(m.e.r=g.r),m.e.c<j&&(m.e.c=j),V&&(V.type=="XLDAPR"&&(w.D=!0),V=void 0);break;case 176:C.push(Q);break;case 49:V=((u.xlmeta||{}).Cell||[])[Q-1];break;case 494:var G=n["!id"][Q.relId];for(G?(Q.Target=G.Target,Q.loc&&(Q.Target+="#"+Q.loc),Q.Rel=G):Q.relId==""&&(Q.Target="#"+Q.loc),S=Q.rfx.s.r;S<=Q.rfx.e.r;++S)for(j=Q.rfx.s.c;j<=Q.rfx.e.c;++j)u.dense?(h[S]||(h[S]=[]),h[S][j]||(h[S][j]={t:"z",v:void 0}),h[S][j].l=Q):(_=wt({c:j,r:S}),h[_]||(h[_]={t:"z",v:void 0}),h[_].l=Q);break;case 426:if(!u.cellFormula)break;M.push(Q),O=u.dense?h[S][j]:h[kn(j)+k],O.f=dn(Q[1],m,{r:g.r,c:j},U,u),O.F=Ut(Q[0]);break;case 427:if(!u.cellFormula)break;W[wt(Q[0].s)]=Q[1],O=u.dense?h[S][j]:h[kn(j)+k],O.f=dn(Q[1],m,{r:g.r,c:j},U,u);break;case 60:if(!u.cellStyles)break;for(;Q.e>=Q.s;)oe[Q.e--]={width:Q.w/256,hidden:!!(Q.flags&1),level:Q.level},ue||(ue=!0,a2(Q.w/256)),Dc(oe[Q.e+1]);break;case 161:h["!autofilter"]={ref:Ut(Q)};break;case 476:h["!margins"]=Q;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),Q.name&&(a.Sheets[r].CodeName=Q.name),(Q.above||Q.left)&&(h["!outline"]={above:Q.above,left:Q.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),Q.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:p=!0;break;case 36:p=!1;break;case 37:p=!0;break;case 38:p=!1;break;default:if(!z.T){if(!p||u.WTF)throw new Error("Unexpected record 0x"+Y.toString(16))}}},u),delete u.supbooks,delete u["!row"],!h["!ref"]&&(m.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(h["!ref"]=Ut(d||m)),u.sheetRows&&h["!ref"]){var H=qr(h["!ref"]);u.sheetRows<=+H.e.r&&(H.e.r=u.sheetRows-1,H.e.r>m.e.r&&(H.e.r=m.e.r),H.e.r<H.s.r&&(H.s.r=H.e.r),H.e.c>m.e.c&&(H.e.c=m.e.c),H.e.c<H.s.c&&(H.s.c=H.e.c),h["!fullref"]=h["!ref"],h["!ref"]=Ut(H))}return C.length>0&&(h["!merges"]=C),oe.length>0&&(h["!cols"]=oe),je.length>0&&(h["!rows"]=je),h}function fK(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var l=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(t[+l[1]]=r?+l[2]:l[2])});var a=Dt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[t,a,n]}function dK(e,t,r,n,a,i){var l=i||{"!type":"chart"};if(!e)return i;var u=0,h=0,d="A",m={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var v=fK(p);m.s.r=m.s.c=0,m.e.c=u,d=kn(u),v[0].forEach(function(g,w){l[d+ua(w)]={t:"n",v:g,z:v[1]},h=w}),m.e.r<h&&(m.e.r=h),++u}),u>0&&(l["!ref"]=Ut(m)),l}function hK(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l,u=e.match(E5);return u&&s2(u[0],i,a,r),(l=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=l[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function mK(e,t){e.l+=10;var r=yn(e);return{name:r}}function pK(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l=!1;return vs(e,function(h,d,m){switch(m){case 550:i["!rel"]=h;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),h.name&&(a.Sheets[r].CodeName=h.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!l||t.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var N5=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],xK=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],vK=[],gK=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function w_(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var i=t[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=tr(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function S_(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=tr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function A5(e){S_(e.WBProps,N5),S_(e.CalcPr,gK),w_(e.WBView,xK),w_(e.Sheets,vK),Tc.date1904=tr(e.WBProps.date1904)}var yK="][*?/\\".split("");function bK(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return yK.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var wK=/<\w+:workbook/;function SK(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},l=0;if(e.replace(wn,function(h,d){var m=ft(h);switch(Ii(m[0])){case"<?xml":break;case"<workbook":h.match(wK)&&(a="xmlns"+h.match(/<(\w+):/)[1]),r.xmlns=m[a];break;case"</workbook>":break;case"<fileVersion":delete m[0],r.AppVersion=m;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":N5.forEach(function(p){if(m[p[0]]!=null)switch(p[2]){case"bool":r.WBProps[p[0]]=tr(m[p[0]]);break;case"int":r.WBProps[p[0]]=parseInt(m[p[0]],10);break;default:r.WBProps[p[0]]=m[p[0]]}}),m.codeName&&(r.WBProps.CodeName=Zt(m.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete m[0],r.WBView.push(m);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(m.state){case"hidden":m.Hidden=1;break;case"veryHidden":m.Hidden=2;break;default:m.Hidden=0}delete m.state,m.name=Dt(Zt(m.name)),delete m[0],r.Sheets.push(m);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=Zt(m.name),m.comment&&(i.Comment=m.comment),m.localSheetId&&(i.Sheet=+m.localSheetId),tr(m.hidden||"0")&&(i.Hidden=!0),l=d+h.length;break;case"</definedName>":i.Ref=Dt(Zt(e.slice(l,d))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete m[0],r.CalcPr=m;break;case"<calcPr/>":delete m[0],r.CalcPr=m;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+m[0]+" in workbook")}return h}),U9.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return A5(r),r}function EK(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=by(e),r.name=yn(e),r}function jK(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?yn(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function NK(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function AK(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=aU(e),l=cV(e,0,r),u=Jb(e);e.l=n;var h={Name:i,Ptg:l};return a<268435455&&(h.Sheet=a),u&&(h.Comment=u),h}function _K(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var i=[],l=[[]];return l.SheetNames=[],l.XTI=[],Yh[16]={n:"BrtFRTArchID$",f:NK},vs(e,function(h,d,m){switch(m){case 156:l.SheetNames.push(h.name),r.Sheets.push(h);break;case 153:r.WBProps=h;break;case 39:h.Sheet!=null&&(t.SID=h.Sheet),h.Ref=dn(h.Ptg,null,null,l,t),delete t.SID,delete h.Ptg,i.push(h);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([m,h]):l[0]=[m,h],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(h),l.XTI=l.XTI.concat(h);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(m),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(m),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!d.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}},t),A5(r),r.Names=i,r.supbooks=l,r}function TK(e,t,r){return t.slice(-4)===".bin"?_K(e,r):SK(e,r)}function kK(e,t,r,n,a,i,l,u){return t.slice(-4)===".bin"?uK(e,n,r,a,i,l,u):EV(e,n,r,a,i,l,u)}function CK(e,t,r,n,a,i,l,u){return t.slice(-4)===".bin"?pK(e,n,r,a,i):hK(e,n,r,a,i)}function OK(e,t,r,n,a,i,l,u){return t.slice(-4)===".bin"?BH():UH()}function DK(e,t,r,n,a,i,l,u){return t.slice(-4)===".bin"?IH():LH()}function PK(e,t,r,n){return t.slice(-4)===".bin"?eH(e,r,n):Wz(e,r,n)}function RK(e,t,r){return d5(e,r)}function MK(e,t,r){return t.slice(-4)===".bin"?xz(e,r):mz(e,r)}function FK(e,t,r){return t.slice(-4)===".bin"?RH(e,r):kH(e,r)}function IK(e,t,r){return t.slice(-4)===".bin"?AH(e):jH(e)}function LK(e,t,r,n){return r.slice(-4)===".bin"?_H(e,t,r,n):void 0}function BK(e,t,r){return t.slice(-4)===".bin"?SH(e,t,r):EH(e,t,r)}var _5=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,T5=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ti(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(_5),i,l,u,h;if(a)for(h=0;h!=a.length;++h)i=a[h].match(T5),(l=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?u="xmlns"+i[1].slice(6):u=i[1].slice(l+1),n[u]=i[2].slice(1,i[2].length-1));return n}function UK(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(_5),a,i,l,u;if(n)for(u=0;u!=n.length;++u)a=n[u].match(T5),(i=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(i+1),r[l]=a[2].slice(1,a[2].length-1));return r}var Rf;function $K(e,t){var r=Rf[e]||Dt(e);return r==="General"?po(t):Ha(r,t)}function zK(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=tr(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=en(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Dt(t)]=a}function HK(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||_o[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Hf(e.v):e.w=po(e.v):e.w=$K(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var n=Rf[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Zc(n)){var a=eo(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(r.WTF)throw i}}}function qK(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=zz[n.Pattern]||n.Pattern)}e[t.ID]=t}function VK(e,t,r,n,a,i,l,u,h,d){var m="General",p=n.StyleID,v={};d=d||{};var g=[],w=0;for(p===void 0&&u&&(p=u.StyleID),p===void 0&&l&&(p=l.StyleID);i[p]!==void 0&&(i[p].nf&&(m=i[p].nf),i[p].Interior&&g.push(i[p].Interior),!!i[p].Parent);)p=i[p].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=tr(e);break;case"String":n.t="s",n.r=qA(Dt(e)),n.v=e.indexOf("<")>-1?Dt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(en(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Dt(e):n.v<60&&(n.v=n.v-1),(!m||m=="General")&&(m="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=qO[e],d.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=qA(t||e));break}if(HK(n,m,d),d.cellFormula!==!1)if(n.Formula){var b=Dt(n.Formula);b.charCodeAt(0)==61&&(b=b.slice(1)),n.f=_c(b,a),delete n.Formula,n.ArrayRange=="RC"?n.F=_c("RC:RC",a):n.ArrayRange&&(n.F=_c(n.ArrayRange,a),h.push([qr(n.F),n.F]))}else for(w=0;w<h.length;++w)a.r>=h[w][0].s.r&&a.r<=h[w][0].e.r&&a.c>=h[w][0].s.c&&a.c<=h[w][0].e.c&&(n.F=h[w][1]);d.cellStyles&&(g.forEach(function(S){!v.patternType&&S.patternType&&(v.patternType=S.patternType)}),n.s=v),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function KK(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function xg(e,t){var r=t||{};pO();var n=vf(Yb(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Zt(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var l=tn(r);return l.type="string",Gf.to_workbook(n,l)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ze){a.indexOf("<"+ze)>=0&&(i=!0)}),i)return QK(n,r);Rf={"General Number":"General","General Date":xt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":xt[15],"Short Date":xt[14],"Long Time":xt[19],"Medium Time":xt[18],"Short Time":xt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:xt[2],Standard:xt[4],Percent:xt[10],Scientific:xt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,h=[],d,m={},p=[],v=r.dense?[]:{},g="",w={},b={},S=ti('<Data ss:Type="String">'),j=0,_=0,A=0,k={s:{r:2e6,c:2e6},e:{r:0,c:0}},O={},C={},T="",I=0,M=[],W={},U={},F=0,oe=[],je=[],ue={},V=[],H,Se=!1,Q=[],z=[],Y={},P=0,q=0,G={Sheets:[],WBProps:{date1904:!1}},Z={};Kf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var fe="";u=Kf.exec(n);)switch(u[3]=(fe=u[3]).toLowerCase()){case"data":if(fe=="data"){if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break}if(h[h.length-1][1])break;u[1]==="/"?VK(n.slice(j,u.index),T,S,h[h.length-1][0]=="comment"?ue:w,{c:_,r:A},O,V[_],b,Q,r):(T="",S=ti(u[0]),j=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(je.length>0&&(w.c=je),(!r.sheetRows||r.sheetRows>A)&&w.v!==void 0&&(r.dense?(v[A]||(v[A]=[]),v[A][_]=w):v[kn(_)+ua(A)]=w),w.HRef&&(w.l={Target:Dt(w.HRef)},w.HRefScreenTip&&(w.l.Tooltip=w.HRefScreenTip),delete w.HRef,delete w.HRefScreenTip),(w.MergeAcross||w.MergeDown)&&(P=_+(parseInt(w.MergeAcross,10)|0),q=A+(parseInt(w.MergeDown,10)|0),M.push({s:{c:_,r:A},e:{c:P,r:q}})),!r.sheetStubs)w.MergeAcross?_=P+1:++_;else if(w.MergeAcross||w.MergeDown){for(var Oe=_;Oe<=P;++Oe)for(var Re=A;Re<=q;++Re)(Oe>_||Re>A)&&(r.dense?(v[Re]||(v[Re]=[]),v[Re][Oe]={t:"z"}):v[kn(Oe)+ua(Re)]={t:"z"});_=P+1}else++_;else w=UK(u[0]),w.Index&&(_=+w.Index-1),_<k.s.c&&(k.s.c=_),_>k.e.c&&(k.e.c=_),u[0].slice(-2)==="/>"&&++_,je=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(A<k.s.r&&(k.s.r=A),A>k.e.r&&(k.e.r=A),u[0].slice(-2)==="/>"&&(b=ti(u[0]),b.Index&&(A=+b.Index-1)),_=0,++A):(b=ti(u[0]),b.Index&&(A=+b.Index-1),Y={},(b.AutoFitHeight=="0"||b.Height)&&(Y.hpx=parseInt(b.Height,10),Y.hpt=f5(Y.hpx),z[A]=Y),b.Hidden=="1"&&(Y.hidden=!0,z[A]=Y));break;case"worksheet":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));p.push(g),k.s.r<=k.e.r&&k.s.c<=k.e.c&&(v["!ref"]=Ut(k),r.sheetRows&&r.sheetRows<=k.e.r&&(v["!fullref"]=v["!ref"],k.e.r=r.sheetRows-1,v["!ref"]=Ut(k))),M.length&&(v["!merges"]=M),V.length>0&&(v["!cols"]=V),z.length>0&&(v["!rows"]=z),m[g]=v}else k={s:{r:2e6,c:2e6},e:{r:0,c:0}},A=_=0,h.push([u[3],!1]),d=ti(u[0]),g=Dt(d.Name),v=r.dense?[]:{},M=[],Q=[],z=[],Z={name:g,Hidden:0},G.Sheets.push(Z);break;case"table":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else{if(u[0].slice(-2)=="/>")break;h.push([u[3],!1]),V=[],Se=!1}break;case"style":u[1]==="/"?qK(O,C,r):C=ti(u[0]);break;case"numberformat":C.nf=Dt(ti(u[0]).Format||"General"),Rf[C.nf]&&(C.nf=Rf[C.nf]);for(var re=0;re!=392&&xt[re]!=C.nf;++re);if(re==392){for(re=57;re!=392;++re)if(xt[re]==null){lo(C.nf,re);break}}break;case"column":if(h[h.length-1][0]!=="table")break;if(H=ti(u[0]),H.Hidden&&(H.hidden=!0,delete H.Hidden),H.Width&&(H.wpx=parseInt(H.Width,10)),!Se&&H.wpx>10){Se=!0,Tn=c5;for(var be=0;be<V.length;++be)V[be]&&Dc(V[be])}Se&&Dc(H),V[H.Index-1||V.length]=H;for(var Ae=0;Ae<+H.Span;++Ae)V[V.length]=tn(H);break;case"namedrange":if(u[1]==="/")break;G.Names||(G.Names=[]);var D=ft(u[0]),Me={Name:D.Name,Ref:_c(D.RefersTo.slice(1),{r:0,c:0})};G.Sheets.length>0&&(Me.Sheet=G.Sheets.length-1),G.Names.push(Me);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?T+=n.slice(I,u.index):I=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;C.Interior=ti(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?kU(W,fe,n.slice(F,u.index)):F=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else h.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));KK(ue),je.push(ue)}else h.push([u[3],!1]),d=ti(u[0]),ue={a:d.Author};break;case"autofilter":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var ae=ti(u[0]);v["!autofilter"]={ref:_c(ae.Range).replace(/\$/g,"")},h.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"null":break;default:if(h.length==0&&u[3]=="document"||h.length==0&&u[3]=="uof")return __(n,r);var de=!0;switch(h[h.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:de=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:de=!1}break;case"excelworkbook":switch(u[3]){case"date1904":G.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:de=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:de=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(n.slice(F,u.index)){case"SheetHidden":Z.Hidden=1;break;case"SheetVeryHidden":Z.Hidden=2;break}else F=u.index+u[0].length;break;case"header":v["!margins"]||Pf(v["!margins"]={},"xlml"),isNaN(+ft(u[0]).Margin)||(v["!margins"].header=+ft(u[0]).Margin);break;case"footer":v["!margins"]||Pf(v["!margins"]={},"xlml"),isNaN(+ft(u[0]).Margin)||(v["!margins"].footer=+ft(u[0]).Margin);break;case"pagemargins":var me=ft(u[0]);v["!margins"]||Pf(v["!margins"]={},"xlml"),isNaN(+me.Top)||(v["!margins"].top=+me.Top),isNaN(+me.Left)||(v["!margins"].left=+me.Left),isNaN(+me.Right)||(v["!margins"].right=+me.Right),isNaN(+me.Bottom)||(v["!margins"].bottom=+me.Bottom);break;case"displayrighttoleft":G.Views||(G.Views=[]),G.Views[0]||(G.Views[0]={}),G.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:de=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:de=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:de=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:de=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:de=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:de=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:de=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:de=!1}break;case"smarttags":break;default:de=!1;break}if(de||u[3].match(/!\[CDATA/))break;if(!h[h.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+h.join("|");if(h[h.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?zK(U,fe,oe,n.slice(F,u.index)):(oe=u,F=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+h.join("|")}var ce={};return!r.bookSheets&&!r.bookProps&&(ce.Sheets=m),ce.SheetNames=p,ce.Workbook=G,ce.SSF=tn(xt),ce.Props=W,ce.Custprops=U,ce}function jy(e,t){switch(c2(t=t||{}),t.type||"base64"){case"base64":return xg(da(e),t);case"binary":case"buffer":case"file":return xg(e,t);case"array":return xg(Eo(e),t)}}function GK(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=lU(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=oU(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var WK=[60,1084,2066,2165,2175];function YK(e,t,r,n,a){var i=n,l=[],u=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&u.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(u)}l.push(u),r.l+=i;for(var h=rs(r,r.l),d=Ny[h],m=0;d!=null&&WK.indexOf(h)>-1;)i=rs(r,r.l+2),m=r.l+4,h==2066?m+=4:(h==2165||h==2175)&&(m+=12),u=r.slice(m,r.l+4+i),l.push(u),r.l+=4+i,d=Ny[h=rs(r,r.l)];var p=ll(l);Jr(p,0);var v=0;p.lens=[];for(var g=0;g<l.length;++g)p.lens.push(v),v+=l[g].length;if(p.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+p.length+" < "+n;return t.f(p,p.length,a)}function ji(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=xt[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||_o[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Hf(e.v):e.w=po(e.v):e.w=Ha(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&e.t=="n"&&Zc(xt[n]||String(n))){var a=eo(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function lh(e,t,r){return{v:e,ixfe:t,t:r}}function XK(e,t){var r={opts:{}},n={},a=t.dense?[]:{},i={},l={},u=null,h=[],d="",m={},p,v="",g,w,b,S,j={},_=[],A,k,O=[],C=[],T={Sheets:[],WBProps:{date1904:!1},Views:[{}]},I={},M=function(xe){return xe<8?oo[xe]:xe<64&&C[xe-8]||oo[xe]},W=function(xe,Be,Ze){var tt=Be.XF.data;if(!(!tt||!tt.patternType||!Ze||!Ze.cellStyles)){Be.s={},Be.s.patternType=tt.patternType;var At;(At=Wf(M(tt.icvFore)))&&(Be.s.fgColor={rgb:At}),(At=Wf(M(tt.icvBack)))&&(Be.s.bgColor={rgb:At})}},U=function(xe,Be,Ze){if(!(Y>1)&&!(Ze.sheetRows&&xe.r>=Ze.sheetRows)){if(Ze.cellStyles&&Be.XF&&Be.XF.data&&W(xe,Be,Ze),delete Be.ixfe,delete Be.XF,p=xe,v=wt(xe),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),xe.r<l.s.r&&(l.s.r=xe.r),xe.c<l.s.c&&(l.s.c=xe.c),xe.r+1>l.e.r&&(l.e.r=xe.r+1),xe.c+1>l.e.c&&(l.e.c=xe.c+1),Ze.cellFormula&&Be.f){for(var tt=0;tt<_.length;++tt)if(!(_[tt][0].s.c>xe.c||_[tt][0].s.r>xe.r)&&!(_[tt][0].e.c<xe.c||_[tt][0].e.r<xe.r)){Be.F=Ut(_[tt][0]),(_[tt][0].s.c!=xe.c||_[tt][0].s.r!=xe.r)&&delete Be.f,Be.f&&(Be.f=""+dn(_[tt][1],l,xe,Q,F));break}}Ze.dense?(a[xe.r]||(a[xe.r]=[]),a[xe.r][xe.c]=Be):a[v]=Be}},F={enc:!1,sbcch:0,snames:[],sharedf:j,arrayf:_,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(F.password=t.password);var oe,je=[],ue=[],V=[],H=[],Se=!1,Q=[];Q.SheetNames=F.snames,Q.sharedf=F.sharedf,Q.arrayf=F.arrayf,Q.names=[],Q.XTI=[];var z=0,Y=0,P=0,q=[],G=[],Z;F.codepage=1200,oi(1200);for(var fe=!1;e.l<e.length-1;){var Oe=e.l,Re=e.read_shift(2);if(Re===0&&z===10)break;var re=e.l===e.length?0:e.read_shift(2),be=Ny[Re];if(be&&be.f){if(t.bookSheets&&z===133&&Re!==133)break;if(z=Re,be.r===2||be.r==12){var Ae=e.read_shift(2);if(re-=2,!F.enc&&Ae!==Re&&((Ae&255)<<8|Ae>>8)!==Re)throw new Error("rt mismatch: "+Ae+"!="+Re);be.r==12&&(e.l+=10,re-=10)}var D={};if(Re===10?D=be.f(e,re,F):D=YK(Re,be,e,re,F),Y==0&&[9,521,1033,2057].indexOf(z)===-1)continue;switch(Re){case 34:r.opts.Date1904=T.WBProps.date1904=D;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(F.enc||(e.l=0),F.enc=D,!t.password)throw new Error("File is password-protected");if(D.valid==null)throw new Error("Encryption scheme unsupported");if(!D.valid)throw new Error("Password is incorrect");break;case 92:F.lastuser=D;break;case 66:var Me=Number(D);switch(Me){case 21010:Me=1200;break;case 32768:Me=1e4;break;case 32769:Me=1252;break}oi(F.codepage=Me),fe=!0;break;case 317:F.rrtabid=D;break;case 25:F.winlocked=D;break;case 439:r.opts.RefreshAll=D;break;case 12:r.opts.CalcCount=D;break;case 16:r.opts.CalcDelta=D;break;case 17:r.opts.CalcIter=D;break;case 13:r.opts.CalcMode=D;break;case 14:r.opts.CalcPrecision=D;break;case 95:r.opts.CalcSaveRecalc=D;break;case 15:F.CalcRefMode=D;break;case 2211:r.opts.FullCalc=D;break;case 129:D.fDialog&&(a["!type"]="dialog"),D.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),D.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:O.push(D);break;case 430:Q.push([D]),Q[Q.length-1].XTI=[];break;case 35:case 547:Q[Q.length-1].push(D);break;case 24:case 536:Z={Name:D.Name,Ref:dn(D.rgce,l,null,Q,F)},D.itab>0&&(Z.Sheet=D.itab-1),Q.names.push(Z),Q[0]||(Q[0]=[],Q[0].XTI=[]),Q[Q.length-1].push(D),D.Name=="_xlnm._FilterDatabase"&&D.itab>0&&D.rgce&&D.rgce[0]&&D.rgce[0][0]&&D.rgce[0][0][0]=="PtgArea3d"&&(G[D.itab-1]={ref:Ut(D.rgce[0][0][1][2])});break;case 22:F.ExternCount=D;break;case 23:Q.length==0&&(Q[0]=[],Q[0].XTI=[]),Q[Q.length-1].XTI=Q[Q.length-1].XTI.concat(D),Q.XTI=Q.XTI.concat(D);break;case 2196:if(F.biff<8)break;Z!=null&&(Z.Comment=D[1]);break;case 18:a["!protect"]=D;break;case 19:D!==0&&F.WTF&&console.error("Password verifier: "+D);break;case 133:i[D.pos]=D,F.snames.push(D.name);break;case 10:{if(--Y)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,a["!ref"]=Ut(l),t.sheetRows&&t.sheetRows<=l.e.r){var ae=l.e.r;l.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Ut(l),l.e.r=ae}l.e.r++,l.e.c++}je.length>0&&(a["!merges"]=je),ue.length>0&&(a["!objects"]=ue),V.length>0&&(a["!cols"]=V),H.length>0&&(a["!rows"]=H),T.Sheets.push(I)}d===""?m=a:n[d]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(F.biff===8&&(F.biff={9:2,521:3,1033:4}[Re]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[D.BIFFVer]||8),F.biffguess=D.BIFFVer==0,D.BIFFVer==0&&D.dt==4096&&(F.biff=5,fe=!0,oi(F.codepage=28591)),F.biff==8&&D.BIFFVer==0&&D.dt==16&&(F.biff=2),Y++)break;if(a=t.dense?[]:{},F.biff<8&&!fe&&(fe=!0,oi(F.codepage=t.codepage||1252)),F.biff<5||D.BIFFVer==0&&D.dt==4096){d===""&&(d="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var de={pos:e.l-re,name:d};i[de.pos]=de,F.snames.push(d)}else d=(i[Oe]||{name:""}).name;D.dt==32&&(a["!type"]="chart"),D.dt==64&&(a["!type"]="macro"),je=[],ue=[],F.arrayf=_=[],V=[],H=[],Se=!1,I={Hidden:(i[Oe]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[D.r]||[])[D.c]:a[wt({c:D.c,r:D.r})])&&++D.c,A={ixfe:D.ixfe,XF:O[D.ixfe]||{},v:D.val,t:"n"},P>0&&(A.z=q[A.ixfe>>8&63]),ji(A,t,r.opts.Date1904),U({c:D.c,r:D.r},A,t);break;case 5:case 517:A={ixfe:D.ixfe,XF:O[D.ixfe],v:D.val,t:D.t},P>0&&(A.z=q[A.ixfe>>8&63]),ji(A,t,r.opts.Date1904),U({c:D.c,r:D.r},A,t);break;case 638:A={ixfe:D.ixfe,XF:O[D.ixfe],v:D.rknum,t:"n"},P>0&&(A.z=q[A.ixfe>>8&63]),ji(A,t,r.opts.Date1904),U({c:D.c,r:D.r},A,t);break;case 189:for(var me=D.c;me<=D.C;++me){var ce=D.rkrec[me-D.c][0];A={ixfe:ce,XF:O[ce],v:D.rkrec[me-D.c][1],t:"n"},P>0&&(A.z=q[A.ixfe>>8&63]),ji(A,t,r.opts.Date1904),U({c:me,r:D.r},A,t)}break;case 6:case 518:case 1030:{if(D.val=="String"){u=D;break}if(A=lh(D.val,D.cell.ixfe,D.tt),A.XF=O[A.ixfe],t.cellFormula){var ze=D.formula;if(ze&&ze[0]&&ze[0][0]&&ze[0][0][0]=="PtgExp"){var Qe=ze[0][0][1][0],Ke=ze[0][0][1][1],qe=wt({r:Qe,c:Ke});j[qe]?A.f=""+dn(D.formula,l,D.cell,Q,F):A.F=((t.dense?(a[Qe]||[])[Ke]:a[qe])||{}).F}else A.f=""+dn(D.formula,l,D.cell,Q,F)}P>0&&(A.z=q[A.ixfe>>8&63]),ji(A,t,r.opts.Date1904),U(D.cell,A,t),u=D}break;case 7:case 519:if(u)u.val=D,A=lh(D,u.cell.ixfe,"s"),A.XF=O[A.ixfe],t.cellFormula&&(A.f=""+dn(u.formula,l,u.cell,Q,F)),P>0&&(A.z=q[A.ixfe>>8&63]),ji(A,t,r.opts.Date1904),U(u.cell,A,t),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{_.push(D);var it=wt(D[0].s);if(g=t.dense?(a[D[0].s.r]||[])[D[0].s.c]:a[it],t.cellFormula&&g){if(!u||!it||!g)break;g.f=""+dn(D[1],l,D[0],Q,F),g.F=Ut(D[0])}}break;case 1212:{if(!t.cellFormula)break;if(v){if(!u)break;j[wt(u.cell)]=D[0],g=t.dense?(a[u.cell.r]||[])[u.cell.c]:a[wt(u.cell)],(g||{}).f=""+dn(D[0],l,p,Q,F)}}break;case 253:A=lh(h[D.isst].t,D.ixfe,"s"),h[D.isst].h&&(A.h=h[D.isst].h),A.XF=O[A.ixfe],P>0&&(A.z=q[A.ixfe>>8&63]),ji(A,t,r.opts.Date1904),U({c:D.c,r:D.r},A,t);break;case 513:t.sheetStubs&&(A={ixfe:D.ixfe,XF:O[D.ixfe],t:"z"},P>0&&(A.z=q[A.ixfe>>8&63]),ji(A,t,r.opts.Date1904),U({c:D.c,r:D.r},A,t));break;case 190:if(t.sheetStubs)for(var Je=D.c;Je<=D.C;++Je){var Fe=D.ixfe[Je-D.c];A={ixfe:Fe,XF:O[Fe],t:"z"},P>0&&(A.z=q[A.ixfe>>8&63]),ji(A,t,r.opts.Date1904),U({c:Je,r:D.r},A,t)}break;case 214:case 516:case 4:A=lh(D.val,D.ixfe,"s"),A.XF=O[A.ixfe],P>0&&(A.z=q[A.ixfe>>8&63]),ji(A,t,r.opts.Date1904),U({c:D.c,r:D.r},A,t);break;case 0:case 512:Y===1&&(l=D);break;case 252:h=D;break;case 1054:if(F.biff==4){q[P++]=D[1];for(var Ye=0;Ye<P+163&&xt[Ye]!=D[1];++Ye);Ye>=163&&lo(D[1],P+163)}else lo(D[1],D[0]);break;case 30:{q[P++]=D;for(var ge=0;ge<P+163&&xt[ge]!=D;++ge);ge>=163&&lo(D,P+163)}break;case 229:je=je.concat(D);break;case 93:ue[D.cmo[0]]=F.lastobj=D;break;case 438:F.lastobj.TxO=D;break;case 127:F.lastobj.ImData=D;break;case 440:for(S=D[0].s.r;S<=D[0].e.r;++S)for(b=D[0].s.c;b<=D[0].e.c;++b)g=t.dense?(a[S]||[])[b]:a[wt({c:b,r:S})],g&&(g.l=D[1]);break;case 2048:for(S=D[0].s.r;S<=D[0].e.r;++S)for(b=D[0].s.c;b<=D[0].e.c;++b)g=t.dense?(a[S]||[])[b]:a[wt({c:b,r:S})],g&&g.l&&(g.l.Tooltip=D[1]);break;case 28:{if(F.biff<=5&&F.biff>=2)break;g=t.dense?(a[D[0].r]||[])[D[0].c]:a[wt(D[0])];var Ge=ue[D[2]];g||(t.dense?(a[D[0].r]||(a[D[0].r]=[]),g=a[D[0].r][D[0].c]={t:"z"}):g=a[wt(D[0])]={t:"z"},l.e.r=Math.max(l.e.r,D[0].r),l.s.r=Math.min(l.s.r,D[0].r),l.e.c=Math.max(l.e.c,D[0].c),l.s.c=Math.min(l.s.c,D[0].c)),g.c||(g.c=[]),w={a:D[1],t:Ge.TxO.t},g.c.push(w)}break;case 2173:gH(O[D.ixfe],D.ext);break;case 125:{if(!F.cellStyles)break;for(;D.e>=D.s;)V[D.e--]={width:D.w/256,level:D.level||0,hidden:!!(D.flags&1)},Se||(Se=!0,a2(D.w/256)),Dc(V[D.e+1])}break;case 520:{var ve={};D.level!=null&&(H[D.r]=ve,ve.level=D.level),D.hidden&&(H[D.r]=ve,ve.hidden=!0),D.hpt&&(H[D.r]=ve,ve.hpt=D.hpt,ve.hpx=Yf(D.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Pf(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Re]]=D;break;case 161:a["!margins"]||Pf(a["!margins"]={}),a["!margins"].header=D.header,a["!margins"].footer=D.footer;break;case 574:D.RTL&&(T.Views[0].RTL=!0);break;case 146:C=D;break;case 2198:oe=D;break;case 140:k=D;break;case 442:d?I.CodeName=D||I.name:T.WBProps.CodeName=D||"ThisWorkbook";break}}else be||console.error("Missing Info for XLS Record 0x"+Re.toString(16)),e.l+=re}return r.SheetNames=xl(i).sort(function(ne,xe){return Number(ne)-Number(xe)}).map(function(ne){return i[ne].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&m["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=m)):r.Preamble=m,r.Sheets&&G.forEach(function(ne,xe){r.Sheets[r.SheetNames[xe]]["!autofilter"]=ne}),r.Strings=h,r.SSF=tn(xt),F.enc&&(r.Encryption=F.enc),oe&&(r.Themes=oe),r.Metadata={},k!==void 0&&(r.Metadata.Country=k),Q.names.length>0&&(T.Names=Q.names),r.Workbook=T,r}var E_={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function ZK(e,t,r){var n=Ct.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=s_(n,mU,E_.DSI);for(var i in a)t[i]=a[i]}catch(d){if(r.WTF)throw d}var l=Ct.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var u=s_(l,pU,E_.SI);for(var h in u)t[h]==null&&(t[h]=u[h])}catch(d){if(r.WTF)throw d}t.HeadingPairs&&t.TitlesOfParts&&(KO(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function k5(e,t){t||(t={}),c2(t),nO(),t.codepage&&Hb(t.codepage);var r,n;if(e.FullPaths){if(Ct.find(e,"/encryption"))throw new Error("File is password-protected");r=Ct.find(e,"!CompObj"),n=Ct.find(e,"/Workbook")||Ct.find(e,"/Book")}else{switch(t.type){case"base64":e=ii(da(e));break;case"binary":e=ii(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Jr(e,0),n={content:e}}var a,i;if(r&&GK(r),t.bookProps&&!t.bookSheets)a={};else{var l=_t?"buffer":"array";if(n&&n.content)a=XK(n.content,t);else if((i=Ct.find(e,"PerfectOffice_MAIN"))&&i.content)a=Of.to_workbook(i.content,(t.type=l,t));else if((i=Ct.find(e,"NativeContent_MAIN"))&&i.content)a=Of.to_workbook(i.content,(t.type=l,t));else throw(i=Ct.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Ct.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=FH(e))}var u={};return e.FullPaths&&ZK(e,u,t),a.Props=a.Custprops=u,t.bookFiles&&(a.cfb=e),a}var Yh={0:{f:DV},1:{f:FV},2:{f:VV},3:{f:UV},4:{f:LV},5:{f:qV},6:{f:WV},7:{f:zV},8:{f:JV},9:{f:QV},10:{f:XV},11:{f:ZV},12:{f:IV},13:{f:KV},14:{f:$V},15:{f:BV},16:{f:j5},17:{f:YV},18:{f:HV},19:{f:Qb},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:AK},40:{},42:{},43:{f:Xz},44:{f:Yz},45:{f:Zz},46:{f:Jz},47:{f:Qz},48:{},49:{f:eU},50:{},51:{f:bH},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:a5},62:{f:GV},63:{f:NH},64:{f:oK},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:bn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:lK},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:MV},148:{f:PV,p:16},151:{f:rK},152:{},153:{f:jK},154:{},155:{},156:{f:EK},157:{},158:{},159:{T:1,f:pz},160:{T:-1},161:{T:1,f:Ao},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:eK},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:yH},336:{T:-1},337:{f:wH,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:by},357:{},358:{},359:{},360:{T:1},361:{},362:{f:n5},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:nK},427:{f:aK},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:sK},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:RV},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:tK},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:by},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:PH},633:{T:1},634:{T:-1},635:{T:1,f:DH},636:{T:-1},637:{f:rU},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:mK},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:cK},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Ny={6:{f:mg},10:{f:Js},12:{f:jr},13:{f:jr},14:{f:pr},15:{f:pr},16:{f:vn},17:{f:pr},18:{f:pr},19:{f:jr},20:{f:u_},21:{f:u_},23:{f:n5},24:{f:d_},25:{f:pr},26:{},27:{},28:{f:C$},29:{},34:{f:pr},35:{f:f_},38:{f:vn},39:{f:vn},40:{f:vn},41:{f:vn},42:{f:pr},43:{f:pr},47:{f:Rz},49:{f:f$},51:{f:jr},60:{},61:{f:o$},64:{f:pr},65:{f:u$},66:{f:jr},77:{},80:{},81:{},82:{},85:{f:jr},89:{},90:{},91:{},92:{f:e$},93:{f:D$},94:{},95:{f:pr},96:{},97:{},99:{f:pr},125:{f:a5},128:{f:w$},129:{f:t$},130:{f:jr},131:{f:pr},132:{f:pr},133:{f:r$},134:{},140:{f:L$},141:{f:jr},144:{},146:{f:U$},151:{},152:{},153:{},154:{},155:{},156:{f:jr},157:{},158:{},160:{f:V$},161:{f:z$},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:v$},190:{f:g$},193:{f:Js},197:{},198:{},199:{},200:{},201:{},202:{f:pr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:jr},220:{},221:{f:pr},222:{},224:{f:b$},225:{f:JU},226:{f:Js},227:{},229:{f:O$},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:n$},253:{f:d$},255:{f:a$},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:ZO},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:pr},353:{f:Js},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:E$},431:{f:pr},432:{},433:{},434:{},437:{},438:{f:M$},439:{f:pr},440:{f:F$},441:{},442:{f:xd},443:{},444:{f:jr},445:{},446:{},448:{f:Js},449:{f:l$,r:2},450:{f:Js},512:{f:o_},513:{f:q$},515:{f:S$},516:{f:h$},517:{f:c_},519:{f:K$},520:{f:i$},523:{},545:{f:h_},549:{f:l_},566:{},574:{f:c$},638:{f:x$},659:{},1048:{},1054:{f:m$},1084:{},1212:{f:_$},2048:{f:I$},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:ah},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Js},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:$$,r:12},2173:{f:vH,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:pr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:A$,r:12},2197:{},2198:{f:fH,r:12},2199:{},2200:{},2201:{},2202:{f:T$,r:12},2203:{f:Js},2204:{},2205:{},2206:{},2207:{},2211:{f:s$},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:jr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:H$},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:B$},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:o_},1:{},2:{f:X$},3:{f:Y$},4:{f:W$},5:{f:c_},7:{f:Z$},8:{},9:{f:ah},11:{},22:{f:jr},30:{f:p$},31:{},32:{},33:{f:h_},36:{},37:{f:l_},50:{f:Q$},62:{},52:{},67:{},68:{f:jr},69:{},86:{},126:{},127:{f:G$},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:J$},223:{},234:{},354:{},421:{},518:{f:mg},521:{f:ah},536:{f:d_},547:{f:f_},561:{},579:{},1030:{f:mg},1033:{f:ah},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ri(e,t,r,n){var a=t;if(!isNaN(a)){var i=(r||[]).length||0,l=e.next(4);l.write_shift(2,a),l.write_shift(2,i),i>0&&IO(r)&&e.push(r)}}function j_(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),l=a.index,u=i&&i.index||e.length,h=j9(e.slice(l,u),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,m=0,p=0,v=0,g={s:{r:1e7,c:1e7},e:{r:0,c:0}},w=[];for(l=0;l<h.length;++l){var b=h[l].trim(),S=b.slice(0,3).toLowerCase();if(S=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}m=0;continue}if(!(S!="<td"&&S!="<th")){var j=b.split(/<\/t[dh]>/i);for(u=0;u<j.length;++u){var _=j[u].trim();if(_.match(/<t[dh]/i)){for(var A=_,k=0;A.charAt(0)=="<"&&(k=A.indexOf(">"))>-1;)A=A.slice(k+1);for(var O=0;O<w.length;++O){var C=w[O];C.s.c==m&&C.s.r<d&&d<=C.e.r&&(m=C.e.c+1,O=-1)}var T=ft(_.slice(0,_.indexOf(">")));v=T.colspan?+T.colspan:1,((p=+T.rowspan)>1||v>1)&&w.push({s:{r:d,c:m},e:{r:d+(p||1)-1,c:m+v-1}});var I=T.t||T["data-t"]||"";if(!A.length){m+=v;continue}if(A=M9(A),g.s.r>d&&(g.s.r=d),g.e.r<d&&(g.e.r=d),g.s.c>m&&(g.s.c=m),g.e.c<m&&(g.e.c=m),!A.length){m+=v;continue}var M={t:"s",v:A};r.raw||!A.trim().length||I=="s"||(A==="TRUE"?M={t:"b",v:!0}:A==="FALSE"?M={t:"b",v:!1}:isNaN(ls(A))?isNaN(qf(A).getDate())||(M={t:"d",v:en(A)},r.cellDates||(M={t:"n",v:ha(M.v)}),M.z=r.dateNF||xt[14]):M={t:"n",v:ls(A)}),r.dense?(n[d]||(n[d]=[]),n[d][m]=M):n[wt({r:d,c:m})]=M,m+=v}}}}return n["!ref"]=Ut(g),w.length&&(n["!merges"]=w),n}function QK(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return jo(j_(r[0],t),t);var n=D5();return r.forEach(function(a,i){P5(n,j_(a,t),"Sheet"+(i+1))}),n}function JK(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Dt(t.replace(/<[^>]*>/g,""));return[r]}var N_={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function C5(e,t){var r=t||{},n=Yb(e),a=[],i,l,u={name:""},h="",d=0,m,p,v={},g=[],w=r.dense?[]:{},b,S,j={value:""},_="",A=0,k=[],O=-1,C=-1,T={s:{r:1e6,c:1e7},e:{r:0,c:0}},I=0,M={},W=[],U={},F=0,oe=0,je=[],ue=1,V=1,H=[],Se={Names:[]},Q={},z=["",""],Y=[],P={},q="",G=0,Z=!1,fe=!1,Oe=0;for(Kf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");b=Kf.exec(n);)switch(b[3]=b[3].replace(/_.*$/,"")){case"table":case"":b[1]==="/"?(T.e.c>=T.s.c&&T.e.r>=T.s.r?w["!ref"]=Ut(T):w["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=T.e.r&&(w["!fullref"]=w["!ref"],T.e.r=r.sheetRows-1,w["!ref"]=Ut(T)),W.length&&(w["!merges"]=W),je.length&&(w["!rows"]=je),m.name=m.||m.name,typeof JSON<"u"&&JSON.stringify(m),g.push(m.name),v[m.name]=w,fe=!1):b[0].charAt(b[0].length-2)!=="/"&&(m=ft(b[0],!1),O=C=-1,T.s.r=T.s.c=1e7,T.e.r=T.e.c=0,w=r.dense?[]:{},W=[],je=[],fe=!0);break;case"table-row-group":b[1]==="/"?--I:++I;break;case"table-row":case"":if(b[1]==="/"){O+=ue,ue=1;break}if(p=ft(b[0],!1),p.?O=p.-1:O==-1&&(O=0),ue=+p["number-rows-repeated"]||1,ue<10)for(Oe=0;Oe<ue;++Oe)I>0&&(je[O+Oe]={level:I});C=-1;break;case"covered-table-cell":b[1]!=="/"&&++C,r.sheetStubs&&(r.dense?(w[O]||(w[O]=[]),w[O][C]={t:"z"}):w[wt({r:O,c:C})]={t:"z"}),_="",k=[];break;case"table-cell":case"":if(b[0].charAt(b[0].length-2)==="/")++C,j=ft(b[0],!1),V=parseInt(j["number-columns-repeated"]||"1",10),S={t:"z",v:null},j.formula&&r.cellFormula!=!1&&(S.f=b_(Dt(j.formula))),(j.||j["value-type"])=="string"&&(S.t="s",S.v=Dt(j["string-value"]||""),r.dense?(w[O]||(w[O]=[]),w[O][C]=S):w[wt({r:O,c:C})]=S),C+=V-1;else if(b[1]!=="/"){++C,_="",A=0,k=[],V=1;var Re=ue?O+ue-1:O;if(C>T.e.c&&(T.e.c=C),C<T.s.c&&(T.s.c=C),O<T.s.r&&(T.s.r=O),Re>T.e.r&&(T.e.r=Re),j=ft(b[0],!1),Y=[],P={},S={t:j.||j["value-type"],v:null},r.cellFormula)if(j.formula&&(j.formula=Dt(j.formula)),j["number-matrix-columns-spanned"]&&j["number-matrix-rows-spanned"]&&(F=parseInt(j["number-matrix-rows-spanned"],10)||0,oe=parseInt(j["number-matrix-columns-spanned"],10)||0,U={s:{r:O,c:C},e:{r:O+F-1,c:C+oe-1}},S.F=Ut(U),H.push([U,S.F])),j.formula)S.f=b_(j.formula);else for(Oe=0;Oe<H.length;++Oe)O>=H[Oe][0].s.r&&O<=H[Oe][0].e.r&&C>=H[Oe][0].s.c&&C<=H[Oe][0].e.c&&(S.F=H[Oe][1]);switch((j["number-columns-spanned"]||j["number-rows-spanned"])&&(F=parseInt(j["number-rows-spanned"],10)||0,oe=parseInt(j["number-columns-spanned"],10)||0,U={s:{r:O,c:C},e:{r:O+F-1,c:C+oe-1}},W.push(U)),j["number-columns-repeated"]&&(V=parseInt(j["number-columns-repeated"],10)),S.t){case"boolean":S.t="b",S.v=tr(j["boolean-value"]);break;case"float":S.t="n",S.v=parseFloat(j.value);break;case"percentage":S.t="n",S.v=parseFloat(j.value);break;case"currency":S.t="n",S.v=parseFloat(j.value);break;case"date":S.t="d",S.v=en(j["date-value"]),r.cellDates||(S.t="n",S.v=ha(S.v)),S.z="m/d/yy";break;case"time":S.t="n",S.v=w9(j["time-value"])/86400,r.cellDates&&(S.t="d",S.v=Ym(S.v)),S.z="HH:MM:SS";break;case"number":S.t="n",S.v=parseFloat(j.);break;default:if(S.t==="string"||S.t==="text"||!S.t)S.t="s",j["string-value"]!=null&&(_=Dt(j["string-value"]),k=[]);else throw new Error("Unsupported value type "+S.t)}}else{if(Z=!1,S.t==="s"&&(S.v=_||"",k.length&&(S.R=k),Z=A==0),Q.Target&&(S.l=Q),Y.length>0&&(S.c=Y,Y=[]),_&&r.cellText!==!1&&(S.w=_),Z&&(S.t="z",delete S.v),(!Z||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=O))for(var re=0;re<ue;++re){if(V=parseInt(j["number-columns-repeated"]||"1",10),r.dense)for(w[O+re]||(w[O+re]=[]),w[O+re][C]=re==0?S:tn(S);--V>0;)w[O+re][C+V]=tn(S);else for(w[wt({r:O+re,c:C})]=S;--V>0;)w[wt({r:O+re,c:C+V})]=tn(S);T.e.c<=C&&(T.e.c=C)}V=parseInt(j["number-columns-repeated"]||"1",10),C+=V-1,V=0,S={},_="",k=[]}Q={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(b[1]==="/"){if((i=a.pop())[0]!==b[3])throw"Bad state: "+i}else b[0].charAt(b[0].length-2)!=="/"&&a.push([b[3],!0]);break;case"annotation":if(b[1]==="/"){if((i=a.pop())[0]!==b[3])throw"Bad state: "+i;P.t=_,k.length&&(P.R=k),P.a=q,Y.push(P)}else b[0].charAt(b[0].length-2)!=="/"&&a.push([b[3],!1]);q="",G=0,_="",A=0,k=[];break;case"creator":b[1]==="/"?q=n.slice(G,b.index):G=b.index+b[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(b[1]==="/"){if((i=a.pop())[0]!==b[3])throw"Bad state: "+i}else b[0].charAt(b[0].length-2)!=="/"&&a.push([b[3],!1]);_="",A=0,k=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(b[1]==="/"){if(M[u.name]=h,(i=a.pop())[0]!==b[3])throw"Bad state: "+i}else b[0].charAt(b[0].length-2)!=="/"&&(h="",u=ft(b[0],!1),a.push([b[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":l=ft(b[0],!1),h+=N_[b[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":l=ft(b[0],!1),h+=N_[b[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(b[0].slice(-2)==="/>")break;if(b[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":h+=n.slice(d,b.index);break}else d=b.index+b[0].length;break;case"named-range":l=ft(b[0],!1),z=pg(l["cell-range-address"]);var be={Name:l.name,Ref:z[0]+"!"+z[1]};fe&&(be.Sheet=g.length),Se.Names.push(be);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(b[1]==="/"&&(!j||!j["string-value"])){var Ae=JK(n.slice(A,b.index));_=(_.length>0?_+`
`:"")+Ae[0]}else ft(b[0],!1),A=b.index+b[0].length;break;case"s":break;case"database-range":if(b[1]==="/")break;try{z=pg(ft(b[0])["target-range-address"]),v[z[0]]["!autofilter"]={ref:z[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(b[1]!=="/"){if(Q=ft(b[0],!1),!Q.href)break;Q.Target=Dt(Q.href),delete Q.href,Q.Target.charAt(0)=="#"&&Q.Target.indexOf(".")>-1?(z=pg(Q.Target.slice(1)),Q.Target="#"+z[0]+"!"+z[1]):Q.Target.match(/^\.\.[\\\/]/)&&(Q.Target=Q.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(b[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(b)}}var D={Sheets:v,SheetNames:g,Workbook:Se};return r.bookSheets&&delete D.Sheets,D}function A_(e,t){t=t||{},Ia(e,"META-INF/manifest.xml")&&SU(Er(e,"META-INF/manifest.xml"),t);var r=oa(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=C5(Zt(r),t);return Ia(e,"meta.xml")&&(n.Props=VO(Er(e,"meta.xml"))),n}function __(e,t){return C5(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function l2(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Ay(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Zt(Eo(e))}function _y(e){var t=e.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function T_(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function eG(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Xf(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Rr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function gn(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=Xf(e,r),i=a&7;a=Math.floor(a/8);var l=0,u;if(a==0)break;switch(i){case 0:{for(var h=r[0];e[r[0]++]>=128;);u=e.slice(h,r[0])}break;case 5:l=4,u=e.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,u=e.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=Xf(e,r),u=e.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var d={data:u,type:i};t[a]==null?t[a]=[d]:t[a].push(d)}return t}function o2(e,t){return e?.map(function(r){return t(r.data)})||[]}function tG(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=Xf(e,n),i=gn(e.slice(n[0],n[0]+a));n[0]+=a;var l={id:Rr(i[1][0].data),messages:[]};i[2].forEach(function(u){var h=gn(u.data),d=Rr(h[3][0].data);l.messages.push({meta:h,data:e.slice(n[0],n[0]+d)}),n[0]+=d}),(t=i[3])!=null&&t[0]&&(l.merge=Rr(i[3][0].data)>>>0>0),r.push(l)}return r}function rG(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Xf(t,r),a=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var l=t[r[0]++]>>2;if(l<60)++l;else{var u=l-59;l=t[r[0]],u>1&&(l|=t[r[0]+1]<<8),u>2&&(l|=t[r[0]+2]<<16),u>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=u}a.push(t.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var h=0,d=0;if(i==1?(d=(t[r[0]]>>2&7)+4,h=(t[r[0]++]&224)<<3,h|=t[r[0]++]):(d=(t[r[0]++]>>2)+1,i==2?(h=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(h=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[_y(a)],h==0)throw new Error("Invalid offset 0");if(h>a[0].length)throw new Error("Invalid offset beyond length");if(d>=h)for(a.push(a[0].slice(-h)),d-=h;d>=a[a.length-1].length;)a.push(a[a.length-1]),d-=a[a.length-1].length;a.push(a[0].slice(-h,-h+d))}}var m=_y(a);if(m.length!=n)throw new Error("Unexpected length: ".concat(m.length," != ").concat(n));return m}function nG(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(rG(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return _y(t)}function aG(e,t,r,n){var a=l2(e),i=a.getUint32(4,!0),l=(n>1?12:8)+T_(i&(n>1?3470:398))*4,u=-1,h=-1,d=NaN,m=new Date(2001,0,1);i&512&&(u=a.getUint32(l,!0),l+=4),l+=T_(i&(n>1?12288:4096))*4,i&16&&(h=a.getUint32(l,!0),l+=4),i&32&&(d=a.getFloat64(l,!0),l+=8),i&64&&(m.setTime(m.getTime()+a.getFloat64(l,!0)*1e3),l+=8);var p;switch(e[2]){case 0:break;case 2:p={t:"n",v:d};break;case 3:p={t:"s",v:t[h]};break;case 5:p={t:"d",v:m};break;case 6:p={t:"b",v:d>0};break;case 7:p={t:"n",v:d/86400};break;case 8:p={t:"e",v:0};break;case 9:if(u>-1)p={t:"s",v:r[u]};else if(h>-1)p={t:"s",v:t[h]};else if(!isNaN(d))p={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return p}function iG(e,t,r){var n=l2(e),a=n.getUint32(8,!0),i=12,l=-1,u=-1,h=NaN,d=NaN,m=new Date(2001,0,1);a&1&&(h=eG(e,i),i+=16),a&2&&(d=n.getFloat64(i,!0),i+=8),a&4&&(m.setTime(m.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(u=n.getUint32(i,!0),i+=4),a&16&&(l=n.getUint32(i,!0),i+=4);var p;switch(e[1]){case 0:break;case 2:p={t:"n",v:h};break;case 3:p={t:"s",v:t[u]};break;case 5:p={t:"d",v:m};break;case 6:p={t:"b",v:d>0};break;case 7:p={t:"n",v:d/86400};break;case 8:p={t:"e",v:0};break;case 9:if(l>-1)p={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:p={t:"n",v:h};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return p}function sG(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return aG(e,t,r,e[0]);case 5:return iG(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function dl(e){var t=gn(e);return Xf(t[1][0].data)}function k_(e,t){var r=gn(t.data),n=Rr(r[1][0].data),a=r[3],i=[];return(a||[]).forEach(function(l){var u=gn(l.data),h=Rr(u[1][0].data)>>>0;switch(n){case 1:i[h]=Ay(u[3][0].data);break;case 8:{var d=e[dl(u[9][0].data)][0],m=gn(d.data),p=e[dl(m[1][0].data)][0],v=Rr(p.meta[1][0].data);if(v!=2001)throw new Error("2000 unexpected reference to ".concat(v));var g=gn(p.data);i[h]=g[3].map(function(w){return Ay(w.data)}).join("")}break}}),i}function lG(e,t){var r,n,a,i,l,u,h,d,m,p,v,g,w,b,S=gn(e),j=Rr(S[1][0].data)>>>0,_=Rr(S[2][0].data)>>>0,A=((n=(r=S[8])==null?void 0:r[0])==null?void 0:n.data)&&Rr(S[8][0].data)>0||!1,k,O;if((i=(a=S[7])==null?void 0:a[0])!=null&&i.data&&t!=0)k=(u=(l=S[7])==null?void 0:l[0])==null?void 0:u.data,O=(d=(h=S[6])==null?void 0:h[0])==null?void 0:d.data;else if((p=(m=S[4])==null?void 0:m[0])!=null&&p.data&&t!=1)k=(g=(v=S[4])==null?void 0:v[0])==null?void 0:g.data,O=(b=(w=S[3])==null?void 0:w[0])==null?void 0:b.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var C=A?4:1,T=l2(k),I=[],M=0;M<k.length/2;++M){var W=T.getUint16(M*2,!0);W<65535&&I.push([M,W])}if(I.length!=_)throw"Expected ".concat(_," cells, found ").concat(I.length);var U=[];for(M=0;M<I.length-1;++M)U[I[M][0]]=O.subarray(I[M][1]*C,I[M+1][1]*C);return I.length>=1&&(U[I[I.length-1][0]]=O.subarray(I[I.length-1][1]*C)),{R:j,cells:U}}function oG(e,t){var r,n=gn(t.data),a=(r=n?.[7])!=null&&r[0]?Rr(n[7][0].data)>>>0>0?1:0:-1,i=o2(n[5],function(l){return lG(l,a)});return{nrows:Rr(n[4][0].data)>>>0,data:i.reduce(function(l,u){return l[u.R]||(l[u.R]=[]),u.cells.forEach(function(h,d){if(l[u.R][d])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(d));l[u.R][d]=h}),l},[])}}function cG(e,t,r){var n,a=gn(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Rr(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(Rr(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Ut(i);var l=gn(a[4][0].data),u=k_(e,e[dl(l[4][0].data)][0]),h=(n=l[17])!=null&&n[0]?k_(e,e[dl(l[17][0].data)][0]):[],d=gn(l[3][0].data),m=0;d[1].forEach(function(p){var v=gn(p.data),g=e[dl(v[2][0].data)][0],w=Rr(g.meta[1][0].data);if(w!=6002)throw new Error("6001 unexpected reference to ".concat(w));var b=oG(e,g);b.data.forEach(function(S,j){S.forEach(function(_,A){var k=wt({r:m+j,c:A}),O=sG(_,u,h);O&&(r[k]=O)})}),m+=b.nrows})}function uG(e,t){var r=gn(t.data),n={"!ref":"A1"},a=e[dl(r[2][0].data)],i=Rr(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return cG(e,a[0],n),n}function fG(e,t){var r,n=gn(t.data),a={name:(r=n[1])!=null&&r[0]?Ay(n[1][0].data):"",sheets:[]},i=o2(n[2],dl);return i.forEach(function(l){e[l].forEach(function(u){var h=Rr(u.meta[1][0].data);h==6e3&&a.sheets.push(uG(e,u))})}),a}function dG(e,t){var r=D5(),n=gn(t.data),a=o2(n[1],dl);if(a.forEach(function(i){e[i].forEach(function(l){var u=Rr(l.meta[1][0].data);if(u==2){var h=fG(e,l);h.sheets.forEach(function(d,m){P5(r,d,m==0?h.name:h.name+"_"+m,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function vg(e){var t,r,n,a,i={},l=[];if(e.FullPaths.forEach(function(h){if(h.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(h){if(h.name.match(/\.iwa$/)){var d;try{d=nG(h.content)}catch(p){return console.log("?? "+h.content.length+" "+(p.message||p))}var m;try{m=tG(d)}catch(p){return console.log("## "+(p.message||p))}m.forEach(function(p){i[p.id]=p.messages,l.push(p.id)})}}),!l.length)throw new Error("File has no messages");var u=((a=(n=(r=(t=i?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Rr(i[1][0].meta[1][0].data)==1&&i[1][0];if(u||l.forEach(function(h){i[h].forEach(function(d){var m=Rr(d.meta[1][0].data)>>>0;if(m==1)if(!u)u=d;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return dG(i,u)}function hG(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function c2(e){hG([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function mG(e){return Sc.WS.indexOf(e)>-1?"sheet":e==Sc.CS?"chart":e==Sc.DS?"dialog":e==Sc.MS?"macro":e&&e.length?e:"sheet"}function pG(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,mG(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function xG(e,t,r,n,a,i,l,u,h,d,m,p){try{i[n]=kf(oa(e,r,!0),t);var v=Er(e,t),g;switch(u){case"sheet":g=kK(v,t,a,h,i[n],d,m,p);break;case"chart":if(g=CK(v,t,a,h,i[n],d,m,p),!g||!g["!drawel"])break;var w=yf(g["!drawel"].Target,t),b=wy(w),S=TH(oa(e,w,!0),kf(oa(e,b,!0),w)),j=yf(S,w),_=wy(j);g=dK(oa(e,j,!0),j,h,kf(oa(e,_,!0),j),d,g);break;case"macro":g=OK(v,t,a,h,i[n],d,m,p);break;case"dialog":g=DK(v,t,a,h,i[n],d,m,p);break;default:throw new Error("Unrecognized sheet type "+u)}l[n]=g;var A=[];i&&i[n]&&xl(i[n]).forEach(function(k){var O="";if(i[n][k].Type==Sc.CMNT){O=yf(i[n][k].Target,t);var C=FK(Er(e,O,!0),O,h);if(!C||!C.length)return;p_(g,C,!1)}i[n][k].Type==Sc.TCMNT&&(O=yf(i[n][k].Target,t),A=A.concat(CH(Er(e,O,!0),h)))}),A&&A.length&&p_(g,A,!0,h.people||[])}catch(k){if(h.WTF)throw k}}function Ca(e){return e.charAt(0)=="/"?e.slice(1):e}function vG(e,t){if(pO(),t=t||{},c2(t),Ia(e,"META-INF/manifest.xml")||Ia(e,"objectdata.xml"))return A_(e,t);if(Ia(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof vg<"u"){if(e.FileIndex)return vg(e);var r=Ct.utils.cfb_new();return zA(e).forEach(function(je){_9(r,je,A9(e,je))}),vg(r)}throw new Error("Unsupported NUMBERS file")}if(!Ia(e,"[Content_Types].xml"))throw Ia(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ia(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=zA(e),a=bU(oa(e,"[Content_Types].xml")),i=!1,l,u;if(a.workbooks.length===0&&(u="xl/workbook.xml",Er(e,u,!0)&&a.workbooks.push(u)),a.workbooks.length===0){if(u="xl/workbook.bin",!Er(e,u,!0))throw new Error("Could not find workbook");a.workbooks.push(u),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var h={},d={};if(!t.bookSheets&&!t.bookProps){if(Df=[],a.sst)try{Df=MK(Er(e,Ca(a.sst)),a.sst,t)}catch(je){if(t.WTF)throw je}t.cellStyles&&a.themes.length&&(h=RK(oa(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(d=PK(Er(e,Ca(a.style)),a.style,h,t))}a.links.map(function(je){try{var ue=kf(oa(e,wy(Ca(je))),je);return LK(Er(e,Ca(je)),ue,je,t)}catch{}});var m=TK(Er(e,Ca(a.workbooks[0])),a.workbooks[0],t),p={},v="";a.coreprops.length&&(v=Er(e,Ca(a.coreprops[0]),!0),v&&(p=VO(v)),a.extprops.length!==0&&(v=Er(e,Ca(a.extprops[0]),!0),v&&NU(v,p,t)));var g={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(v=oa(e,Ca(a.custprops[0]),!0),v&&(g=_U(v,t)));var w={};if((t.bookSheets||t.bookProps)&&(m.Sheets?l=m.Sheets.map(function(ue){return ue.name}):p.Worksheets&&p.SheetNames.length>0&&(l=p.SheetNames),t.bookProps&&(w.Props=p,w.Custprops=g),t.bookSheets&&typeof l<"u"&&(w.SheetNames=l),t.bookSheets?w.SheetNames:t.bookProps))return w;l={};var b={};t.bookDeps&&a.calcchain&&(b=IK(Er(e,Ca(a.calcchain)),a.calcchain));var S=0,j={},_,A;{var k=m.Sheets;p.Worksheets=k.length,p.SheetNames=[];for(var O=0;O!=k.length;++O)p.SheetNames[O]=k[O].name}var C=i?"bin":"xml",T=a.workbooks[0].lastIndexOf("/"),I=(a.workbooks[0].slice(0,T+1)+"_rels/"+a.workbooks[0].slice(T+1)+".rels").replace(/^\//,"");Ia(e,I)||(I="xl/_rels/workbook."+C+".rels");var M=kf(oa(e,I,!0),I.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=BK(Er(e,Ca(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=OH(Er(e,Ca(a.people[0])),t)),M&&(M=pG(M,m.Sheets));var W=Er(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(S=0;S!=p.Worksheets;++S){var U="sheet";if(M&&M[S]?(_="xl/"+M[S][1].replace(/[\/]?xl\//,""),Ia(e,_)||(_=M[S][1]),Ia(e,_)||(_=I.replace(/_rels\/.*$/,"")+M[S][1]),U=M[S][2]):(_="xl/worksheets/sheet"+(S+1-W)+"."+C,_=_.replace(/sheet0\./,"sheet.")),A=_.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(S!=t.sheets)continue e;break;case"string":if(p.SheetNames[S].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var F=!1,oe=0;oe!=t.sheets.length;++oe)typeof t.sheets[oe]=="number"&&t.sheets[oe]==S&&(F=1),typeof t.sheets[oe]=="string"&&t.sheets[oe].toLowerCase()==p.SheetNames[S].toLowerCase()&&(F=1);if(!F)continue e}}xG(e,_,A,p.SheetNames[S],S,j,l,U,t,m,h,d)}return w={Directory:a,Workbook:m,Props:p,Custprops:g,Deps:b,Sheets:l,SheetNames:p.SheetNames,Strings:Df,Styles:d,Themes:h,SSF:tn(xt)},t&&t.bookFiles&&(e.files?(w.keys=n,w.files=e.files):(w.keys=[],w.files={},e.FullPaths.forEach(function(je,ue){je=je.replace(/^Root Entry[\/]/,""),w.keys.push(je),w.files[je]=e.FileIndex[ue]}))),t&&t.bookVBA&&(a.vba.length>0?w.vbaraw=Er(e,Ca(a.vba[0]),!0):a.defaults&&a.defaults.bin===MH&&(w.vbaraw=Er(e,"xl/vbaProject.bin",!0))),w}function gG(e,t){var r=t||{},n="Workbook",a=Ct.find(e,n);try{if(n="/!DataSpaces/Version",a=Ct.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(vz(a.content),n="/!DataSpaces/DataSpaceMap",a=Ct.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=yz(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Ct.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=bz(a.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Ct.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);Sz(a.content)}catch{}if(n="/EncryptionInfo",a=Ct.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var u=Ez(a.content);if(n="/EncryptedPackage",a=Ct.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],a.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function u2(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=da(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function yG(e,t){return Ct.find(e,"EncryptedPackage")?gG(e,t):k5(e,t)}function bG(e,t){var r,n=e,a=t||{};return a.type||(a.type=_t&&Buffer.isBuffer(e)?"buffer":"base64"),r=wO(n,a),vG(r,a)}function O5(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return jy(e.slice(r),t);default:break e}return Gf.to_workbook(e,t)}function wG(e,t){var r="",n=u2(e,t);switch(t.type){case"base64":r=da(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=xo(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Zt(r)),t.type="binary",O5(r,t)}function SG(e,t){var r=e;return t.type=="base64"&&(r=da(r)),r=zf.utils.decode(1200,r.slice(2),"str"),t.type="binary",O5(r,t)}function EG(e){return e.match(/[^\x00-\x7F]/)?bf(e):e}function gg(e,t,r,n){return n?(r.type="string",Gf.to_workbook(e,r)):Gf.to_workbook(t,r)}function Ty(e,t){nO();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Ty(new Uint8Array(e),(r=tn(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Tc={},r.dateNF&&(Tc.dateNF=r.dateNF),r.type||(r.type=_t&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=_t?"buffer":"binary",n=y9(e),typeof Uint8Array<"u"&&!_t&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=EG(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),u=new Uint8Array(l);if(u.foo="bar",!u.foo)return r=tn(r),r.type="array",Ty(qb(n),r)}switch((a=u2(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return yG(Ct.read(n,r),r);break;case 9:if(a[1]<=8)return k5(n,r);break;case 60:return jy(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return az(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return rz.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?bG(n,r):gg(e,n,r,i);case 239:return a[3]===60?jy(n,r):gg(e,n,r,i);case 255:if(a[1]===254)return SG(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return Of.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Of.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return m_.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return Mz.to_workbook(n,r);break;case 10:case 13:case 32:return wG(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return ez.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?m_.to_workbook(n,r):gg(e,n,r,i)}function jG(e,t,r,n,a,i,l,u){var h=ua(r),d=u.defval,m=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),p=!0,v=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(v,"__rowNum__",{value:r,enumerable:!1})}catch{v.__rowNum__=r}else v.__rowNum__=r;if(!l||e[r])for(var g=t.s.c;g<=t.e.c;++g){var w=l?e[r][g]:e[n[g]+h];if(w===void 0||w.t===void 0){if(d===void 0)continue;i[g]!=null&&(v[i[g]]=d);continue}var b=w.v;switch(w.t){case"z":if(b==null)break;continue;case"e":b=b==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(i[g]!=null){if(b==null)if(w.t=="e"&&b===null)v[i[g]]=null;else if(d!==void 0)v[i[g]]=d;else if(m&&b===null)v[i[g]]=null;else continue;else v[i[g]]=m&&(w.t!=="n"||w.t==="n"&&u.rawNumbers!==!1)?b:Oc(w,b,u);b!=null&&(p=!1)}}return{row:v,isempty:p}}function NG(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],l=0,u="",h={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},m=d.range!=null?d.range:e["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof m){case"string":h=qr(m);break;case"number":h=qr(e["!ref"]),h.s.r=m;break;default:h=m}n>0&&(a=0);var p=ua(h.s.r),v=[],g=[],w=0,b=0,S=Array.isArray(e),j=h.s.r,_=0,A={};S&&!e[j]&&(e[j]=[]);var k=d.skipHidden&&e["!cols"]||[],O=d.skipHidden&&e["!rows"]||[];for(_=h.s.c;_<=h.e.c;++_)if(!(k[_]||{}).hidden)switch(v[_]=kn(_),r=S?e[j][_]:e[v[_]+p],n){case 1:i[_]=_-h.s.c;break;case 2:i[_]=v[_];break;case 3:i[_]=d.header[_-h.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=l=Oc(r,null,d),b=A[l]||0,!b)A[l]=1;else{do u=l+"_"+b++;while(A[u]);A[l]=b,A[u]=1}i[_]=u}for(j=h.s.r+a;j<=h.e.r;++j)if(!(O[j]||{}).hidden){var C=jG(e,h,j,v,n,i,S,d);(C.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(g[w++]=C.row)}return g.length=w,g}function D5(){return{SheetNames:[],Sheets:{}}}function P5(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var l=i&&i[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=l+a)!=-1;++a);}if(bK(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}const AG={},Ni=AG?.VITE_API_BASE||"",_G=[{id:"upload",label:"Upload"},{id:"sharepoint",label:"SharePoint"}],oh=[".xlsx",".xls",".xlsm"],ch=50,xc=(...e)=>e.filter(Boolean).join(" "),TG=e=>{try{return new Date(e).toLocaleString()}catch{return e}},C_=e=>(e/(1024*1024)).toFixed(2),yg=e=>{try{const r=(e||"").split("?")[0].split("/").pop()||"";return decodeURIComponent(r)||""}catch{return""}},vc=()=>{if(typeof document>"u")return null;const e=document.cookie.match(/(?:^|;\s*)XSRF-TOKEN=([^;]+)/);return e?decodeURIComponent(e[1]):null};function kG(){const[e,t]=y.useState("upload"),[r,n]=y.useState({connected:!1,account:"",expires_in:0}),[a,i]=y.useState(null),[l,u]=y.useState(!1),[h,d]=y.useState(0),[m,p]=y.useState(!1),[v,g]=y.useState(""),[w,b]=y.useState(""),[S,j]=y.useState([]),_=y.useRef(null),[A,k]=y.useState("Clarus Balance Sheet"),[O,C]=y.useState([]),[T,I]=y.useState(""),[M,W]=y.useState(""),[U,F]=y.useState(null),[oe,je]=y.useState(null),[ue,V]=y.useState(""),[H,Se]=y.useState([]),[Q,z]=y.useState("Clarus Balance Sheet"),[Y,P]=y.useState("Valuation"),[q,G]=y.useState(""),[Z,fe]=y.useState(!1),[Oe,Re]=y.useState(""),[re,be]=y.useState(!1);y.useEffect(()=>{Ae(),ce(),Ke()},[]),y.useEffect(()=>{if(!T&&!M&&H.length){const ge=H[0],Ge=yg(ge.url);I(ge.url),W(Ge)}},[H,T,M]);const Ae=async()=>{try{const Ge=await(await fetch(`${Ni}/auth/ms/status`,{credentials:"include"})).json();n(Ge)}catch{n({connected:!1})}},D=ge=>{if(!ge)return"Please select a file.";const Ge=(ge.name||"").toLowerCase();return oh.some(ne=>Ge.endsWith(ne))?ge.size>ch*1024*1024?`Max size ${ch} MB exceeded.`:"":`Unsupported type. Allowed: ${oh.join(", ")}`},Me=async ge=>{try{const Ge=await ge.arrayBuffer(),ne=Ty(Ge,{type:"array"}).SheetNames||[];C(ne);const xe=ne.find(Ze=>Ze.trim().toLowerCase().includes("clarus")),Be=ne.find(Ze=>Ze.trim().toLowerCase()==="master");xe?k(xe):Be?k(Be):ne.includes(A)||k(ne[0]||A)}catch(Ge){console.warn("Failed to parse sheet names:",Ge),C([])}},ae=ge=>{b(""),g("");const Ge=D(ge);if(Ge){b(Ge),i(null),C([]);return}i(ge),Me(ge)},de=ge=>{if(ge.preventDefault(),ge.stopPropagation(),u(!1),m)return;const Ge=ge.dataTransfer.files?.[0];Ge&&ae(Ge)},me=async()=>{if(!a)return b("Please select a file first.");p(!0),d(0),b(""),g("");try{const ge=new FormData;ge.append("file",a),A?.trim()&&ge.append("sheet",A.trim()),await new Promise((Ge,ve)=>{const ne=new XMLHttpRequest;ne.open("POST",`${Ni}/excel/upload_and_ingest`,!0),ne.withCredentials=!0;const xe=vc();xe&&ne.setRequestHeader("X-XSRF-TOKEN",xe),ne.upload.onprogress=Be=>{if(!Be.lengthComputable)return;const Ze=Math.round(Be.loaded/Be.total*100);d(Ze)},ne.onload=()=>{let Be={};try{Be=JSON.parse(ne.responseText||"{}")}catch{}if(ne.status>=200&&ne.status<300&&Be&&Be.ok)g(`Stored ${Array.isArray(Be.admin_periods_upserted)?Be.admin_periods_upserted.length:0} period(s) for ${Be.sheet}.`),d(100),ce(),Ge();else{const Ze=Be&&Be.error?Be.error:`Upload failed (HTTP ${ne.status})`;b(Ze),ve(new Error(Ze))}},ne.onerror=()=>{const Be="Network error while uploading.";b(Be),ve(new Error(Be))},ne.send(ge)}),i(null),C([]),_.current&&(_.current.value="")}catch{}finally{p(!1),setTimeout(()=>d(0),1e3)}},ce=async()=>{try{const Ge=await(await fetch(`${Ni}/excel/upload_history`,{credentials:"include"})).json();j(Array.isArray(Ge)?Ge:[])}catch{}},ze=()=>{const ge=new URL(window.location.href);T&&ge.searchParams.set("sp_connect_url",T);const Ge=`${Ni}/auth/ms/login?redirect=${encodeURIComponent(ge.toString())}`;window.location.assign(Ge)},Qe=async()=>{const ge=vc();try{await fetch(`${Ni}/auth/ms/logout`,{method:"POST",credentials:"include",headers:ge?{"X-XSRF-TOKEN":ge}:void 0})}finally{n({connected:!1})}},Ke=async()=>{try{const Ge=await(await fetch(`${Ni}/api/sharepoint/excel/connections?include_shared=1`,{credentials:"include"})).json();Ge.ok&&Se(Ge.connections||[])}catch{}},qe=async()=>{const ge=(T||"").trim();if(!ge)return V("Paste a SharePoint file URL first.");const Ge=vc(),ve={"Content-Type":"application/json",...Ge?{"X-XSRF-TOKEN":Ge}:{}},xe=await(await fetch(`${Ni}/api/sharepoint/excel/connect_by_url`,{method:"POST",headers:ve,credentials:"include",body:JSON.stringify({url:ge})})).json();if(!xe.ok)return V(xe.error||"Failed to connect");Se(xe.connections||[]);const Be=yg(ge);W(Be),I(ge)},it=async ge=>{const Ge=vc(),ve=Ge?{"X-XSRF-TOKEN":Ge}:void 0,xe=await(await fetch(`${Ni}/api/sharepoint/excel/connections/${ge}`,{method:"DELETE",credentials:"include",headers:ve})).json();xe.ok&&Se(xe.connections||[]),H.find(Be=>String(Be.id)===String(ge))?.url===T&&(I(""),W(""))},Je=()=>{const ge=(T||"").trim();return ge||(H.length?(H[0].url||"").trim():"")},Fe=async()=>{G(""),V("");const ge=Je(),Ge=(Q||"").trim();if(!ge)return V("Add or select a SharePoint workbook first (paste URL and Connect).");try{fe(!0);const ve=vc(),ne={"Content-Type":"application/json",...ve?{"X-XSRF-TOKEN":ve}:{}},xe=await fetch(`${Ni}/api/sharepoint/excel/sync_balance_by_url`,{method:"POST",headers:ne,credentials:"include",body:JSON.stringify({url:ge,sheet:Ge})}),Be=await xe.json();if(!xe.ok||!Be.ok){V(Be.error||"Balance sync failed"),G("");return}const Ze=(Array.isArray(Be.admin_periods_upserted)?Be.admin_periods_upserted.length:0)+(Array.isArray(Be.investor_periods_upserted)?Be.investor_periods_upserted.length:0);G(`Balance sync  Stored ${Ze} period batch(es) from '${Ge||"auto-detected sheet"}'.`)}catch(ve){V(String(ve))}finally{fe(!1)}},Ye=async()=>{Re(""),V("");const ge=Je(),Ge=(Y||"").trim();if(!ge)return V("Add or select a SharePoint workbook first (paste URL and Connect).");try{be(!0);const ve=vc(),ne={"Content-Type":"application/json",...ve?{"X-XSRF-TOKEN":ve}:{}},xe=await fetch(`${Ni}/api/sharepoint/excel/sync_investments_by_url`,{method:"POST",headers:ne,credentials:"include",body:JSON.stringify({url:ge,sheet:Ge})}),Be=await xe.json();if(!xe.ok||!Be.ok){V(Be.error||"Investment sync failed"),Re("");return}Re(`Investment values stored  rows=${Be.rows??"?"}, as_of=${Be.as_of??"n/a"}`);try{window.dispatchEvent(new CustomEvent("investment:updated",{detail:Be}))}catch{}}catch(ve){V(String(ve))}finally{be(!1)}};return c.jsxs("div",{className:"p-6 md:p-10 space-y-8",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Excel & Sheets Hub"}),c.jsx("button",{onClick:()=>{Ae(),ce(),Ke()},className:"px-3 py-2 text-sm rounded-lg border border-slate-300 hover:bg-slate-50",children:"Refresh"})]}),c.jsx("div",{className:"flex gap-2",children:_G.map(ge=>c.jsx("button",{onClick:()=>t(ge.id),className:xc("px-4 py-2 rounded-lg border text-sm",e===ge.id?"bg-indigo-600 border-indigo-600 text-white shadow":"bg-white border-slate-300 hover:bg-slate-50"),children:ge.label},ge.id))}),e==="upload"&&c.jsxs("div",{className:"relative overflow-hidden rounded-2xl border border-slate-200 shadow-sm",children:[c.jsx("div",{className:"absolute inset-x-0 -top-24 h-48 bg-gradient-to-r from-indigo-500 via-sky-500 to-emerald-500 opacity-10 pointer-events-none"}),c.jsxs("div",{className:"p-6 md:p-8 space-y-6 bg-white/80 backdrop-blur",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"w-10 h-10 rounded-xl bg-indigo-600 text-white grid place-items-center shadow",children:c.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",children:[c.jsx("path",{d:"M12 16V7m0 0l-3 3m3-3l3 3",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round"}),c.jsx("path",{d:"M7 17a5 5 0 010-10 6.5 6.5 0 0112.3 1.9A4.5 4.5 0 0120 17H7z",stroke:"currentColor",strokeWidth:"1.4"})]})}),c.jsxs("div",{children:[c.jsx("div",{className:"text-lg font-semibold text-slate-900",children:"Upload Excel"}),c.jsxs("div",{className:"text-sm text-slate-600",children:["Drag & drop or choose a file. We support Excel (.xlsx/.xls/.xlsm) up to ",ch," MB."]})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("label",{className:"text-sm text-slate-600",children:"Worksheet"}),O.length>0?c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("select",{className:"border border-slate-300 rounded-lg px-3 py-2 w-72",value:A,onChange:ge=>k(ge.target.value),children:O.map(ge=>c.jsx("option",{value:ge,children:ge},ge))}),c.jsx("div",{className:"hidden md:flex gap-1 flex-wrap max-w-[420px]",children:O.slice(0,6).map(ge=>c.jsx("button",{onClick:()=>k(ge),className:xc("px-2 py-1 rounded border text-xs",ge===A?"bg-indigo-600 text-white border-indigo-600":"bg-white border-slate-300 hover:bg-slate-50"),title:`Use sheet: ${ge}`,children:ge},ge))})]}):c.jsx("input",{className:"border border-slate-300 rounded-lg px-3 py-2 w-72",value:A,onChange:ge=>k(ge.target.value),placeholder:"Clarus Balance Sheet"})]}),c.jsx("div",{onDragOver:ge=>{ge.preventDefault(),ge.stopPropagation(),m||u(!0)},onDragLeave:()=>u(!1),onDrop:de,className:xc("rounded-xl border-2 border-dashed p-6 md:p-10 text-center transition",l?"border-indigo-500 bg-indigo-50":"border-slate-300 bg-slate-50"),children:c.jsxs("div",{className:"space-y-3",children:[c.jsx("div",{className:"text-slate-700",children:a?c.jsx("span",{className:"font-medium",children:a.name}):c.jsxs(c.Fragment,{children:[c.jsx("span",{className:"font-medium",children:"Drop your file here"}),c.jsx("span",{className:"text-slate-500",children:" or "})]})}),!a&&c.jsxs("button",{className:"inline-flex items-center gap-2 rounded-lg bg-indigo-600 text-white px-4 py-2 text-sm hover:bg-indigo-700 shadow",onClick:()=>_.current?.click(),disabled:m,children:[c.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:c.jsx("path",{d:"M12 5v14M5 12h14",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})}),"Choose file"]}),c.jsx("input",{ref:_,type:"file",accept:oh.join(","),className:"hidden",onChange:ge=>ae(ge.target.files?.[0]||null),disabled:m}),a&&c.jsxs("div",{className:"mx-auto max-w-lg bg-white border border-slate-200 rounded-lg p-3 text-left shadow-sm",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"text-sm",children:[c.jsx("div",{className:"font-medium text-slate-900 truncate",children:a.name}),c.jsxs("div",{className:"text-slate-500",children:[C_(a.size)," MB"]})]}),c.jsx("button",{className:"text-slate-600 hover:text-rose-600",onClick:()=>{i(null),b(""),g(""),_.current&&(_.current.value=""),C([])},disabled:m,title:"Remove",children:c.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:c.jsx("path",{d:"M6 6l12 12M18 6L6 18",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round"})})})]}),m&&c.jsxs("div",{className:"mt-3",children:[c.jsx("div",{className:"w-full h-2 bg-slate-200 rounded",children:c.jsx("div",{className:"h-2 rounded bg-gradient-to-r from-indigo-500 to-sky-500 transition-all",style:{width:`${h}%`}})}),c.jsxs("div",{className:"text-xs text-slate-600 mt-1",children:[h,"%"]})]})]})]})}),c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[c.jsxs("div",{className:"text-xs text-slate-500",children:["Allowed types:"," ",c.jsx("span",{className:"font-medium",children:oh.join(", ")}),"  Max size: ",c.jsxs("span",{className:"font-medium",children:[ch," MB"]})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:()=>_.current?.click(),className:"px-3 py-2 rounded-lg border border-slate-300 bg-white hover:bg-slate-50",disabled:m,children:"Choose another"}),c.jsx("button",{onClick:me,className:"px-4 py-2 rounded-lg bg-emerald-600 text-white hover:bg-emerald-700 shadow disabled:opacity-60",disabled:!a||m,children:m?"Uploading":"Upload"})]})]}),v&&c.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-emerald-50 border border-emerald-200 text-emerald-800 px-3 py-2 text-sm",children:[c.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:c.jsx("path",{d:"M5 13l4 4L19 7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})}),c.jsx("span",{children:v})]}),w&&c.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-rose-50 border border-rose-200 text-rose-700 px-3 py-2 text-sm",children:[c.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:c.jsx("path",{d:"M12 9v4m0 4h.01M4.93 19.07l14.14-14.14",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})}),c.jsx("span",{children:w})]}),c.jsxs("div",{className:"mt-4",children:[c.jsx("div",{className:"text-sm font-semibold text-slate-900 mb-2",children:"Recent uploads"}),S?.length?c.jsx("ul",{className:"divide-y divide-slate-200 rounded-lg border border-slate-200 overflow-hidden",children:S.map((ge,Ge)=>c.jsxs("li",{className:"flex items-center justify-between px-3 py-2 bg-white hover:bg-slate-50",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"truncate font-mono text-sm text-slate-800",children:ge.filename}),c.jsx("div",{className:"text-xs text-slate-500",children:TG(ge.uploaded_at)})]}),ge.size&&c.jsxs("div",{className:"text-xs text-slate-500",children:[C_(ge.size)," MB"]})]},Ge))}):c.jsx("div",{className:"text-sm text-slate-500",children:"No uploads yet."})]})]})]}),e==="sharepoint"&&c.jsxs("div",{className:"bg-white p-5 md:p-6 rounded-2xl border border-slate-200 shadow-sm space-y-5",children:[c.jsxs("div",{className:"flex items-center justify-between bg-slate-50 border border-slate-200 p-3 rounded-xl",children:[c.jsxs("div",{className:"text-sm",children:[c.jsx("span",{className:xc("text-xs px-2 py-1 rounded mr-3",r.connected?"bg-emerald-100 text-emerald-700":"bg-slate-200 text-slate-700"),children:r.connected?`Connected  ${r.account||""}`:"Not connected"}),r.connected&&!!r.expires_in&&c.jsxs("span",{className:"text-slate-500",children:["token expires in ~",Math.max(0,Math.floor(r.expires_in/60)),"m"]})]}),c.jsx("div",{className:"flex gap-2",children:r.connected?c.jsx("button",{onClick:Qe,className:"px-3 py-2 rounded-lg border border-slate-300 bg-white hover:bg-slate-50",children:"Sign out"}):c.jsx("button",{onClick:ze,className:"px-3 py-2 rounded-lg bg-indigo-600 text-white hover:bg-indigo-700",children:"Connect Microsoft"})})]}),M&&c.jsxs("div",{className:"flex items-center justify-between bg-slate-50 border border-slate-200 p-3 rounded-xl",children:[c.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[c.jsx("div",{className:"w-8 h-8 rounded-lg bg-indigo-600 text-white grid place-items-center shadow",children:c.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:[c.jsx("path",{d:"M7 3h7l4 4v14a1 1 0 01-1 1H7a1 1 0 01-1-1V3a1 1 0 011-1z",stroke:"currentColor",strokeWidth:"1.5"}),c.jsx("path",{d:"M14 3v5h5",stroke:"currentColor",strokeWidth:"1.5"})]})}),c.jsxs("div",{className:"truncate",children:[c.jsx("div",{className:"text-sm font-medium text-slate-900 truncate",children:M}),c.jsx("div",{className:"text-xs text-slate-500",children:"Selected SharePoint workbook"})]})]}),c.jsx("button",{onClick:()=>{I(""),W("")},className:"px-3 py-2 rounded-lg border border-slate-300 bg-white hover:bg-slate-50",children:"Clear"})]}),c.jsxs("div",{className:"border border-slate-200 rounded-xl p-4 space-y-3",children:[c.jsx("label",{className:"text-sm font-medium text-slate-800",children:"Add SharePoint workbook"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("input",{className:"border border-slate-300 p-2 rounded-lg w-full",placeholder:"https://tenant.sharepoint.com/:x:/r/sites/.../file.xlsx?...",value:T,onChange:ge=>I(ge.target.value)}),c.jsxs("button",{onClick:qe,className:"inline-flex items-center gap-2 px-3 py-2 rounded-lg bg-emerald-600 text-white hover:bg-emerald-700 shadow",children:[c.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:c.jsx("path",{d:"M10 13a5 5 0 007.07 0l1.41-1.41a5 5 0 10-7.07-7.07L10 5",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round"})}),"Connect"]})]}),c.jsx("div",{className:"text-xs text-slate-500",children:"You can save multiple files. The Balance/Investment Sync buttons will use the active workbook (the last connected one, or the first saved connection)."})]}),c.jsx("div",{className:"border border-slate-200 rounded-xl p-4",children:c.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"text-sm font-medium text-slate-800",children:"Balance worksheet (admin & investor)"}),c.jsx("input",{className:"border border-slate-300 p-2 rounded-lg w-full",placeholder:"Clarus Balance Sheet",value:Q,onChange:ge=>z(ge.target.value)})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"text-sm font-medium text-slate-800",children:"Investment worksheet (valuation)"}),c.jsx("input",{className:"border border-slate-300 p-2 rounded-lg w-full",placeholder:"Valuation",value:Y,onChange:ge=>P(ge.target.value)})]}),c.jsxs("div",{className:"flex gap-2 flex-wrap",children:[c.jsx("button",{disabled:Z,onClick:Fe,className:"px-3 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60",children:Z?"Syncing":"Balance Sync"}),c.jsx("button",{disabled:re,onClick:Ye,className:"px-3 py-2 rounded-lg bg-emerald-600 text-white hover:bg-emerald-700 disabled:opacity-60",children:re?"Syncing":"Investment Sync"})]}),q&&c.jsx("div",{className:"text-emerald-700 text-sm",children:q}),Oe&&c.jsx("div",{className:"text-emerald-700 text-sm",children:Oe}),ue&&c.jsx("div",{className:"text-rose-600 text-sm",children:ue})]}),c.jsxs("div",{className:"text-xs text-slate-600 space-y-1.5",children:[c.jsxs("p",{children:[c.jsx("span",{className:"font-semibold",children:"Balance Sync"})," reads the balance worksheet (for example"," ",c.jsx("span",{className:"font-mono",children:"Clarus Balance Sheet"}),") from the selected SharePoint workbook and stores:"]}),c.jsxs("ul",{className:"list-disc list-inside mt-1 space-y-0.5",children:[c.jsxs("li",{children:["Investor rows into"," ",c.jsx("span",{className:"font-mono",children:"investor_period_balances"}),"."]}),c.jsxs("li",{children:["Admin totals into"," ",c.jsx("span",{className:"font-mono",children:"admin_period_balances"}),"."]})]}),c.jsxs("p",{className:"mt-3",children:[c.jsx("span",{className:"font-semibold",children:"Investment Sync"})," reads the valuation worksheet and stores investment values (same ingestion logic as your Excel upload for the valuation sheet) into the appropriate investment tables."]})]})]})}),c.jsxs("div",{className:"border border-slate-200 rounded-xl p-4",children:[c.jsx("div",{className:"font-medium mb-3",children:"Your SharePoint connections"}),H?.length?c.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-4",children:H.map(ge=>{const Ge=yg(ge.url),ve=M&&Ge===M||ge.url===T;return c.jsxs("div",{className:xc("rounded-xl border p-4 bg-white shadow-sm",ve?"border-indigo-400 ring-2 ring-indigo-200":"border-slate-200"),children:[c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx("div",{className:"w-9 h-9 rounded-lg bg-indigo-600 text-white grid place-items-center shrink-0",children:c.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:c.jsx("path",{d:"M7 3h7l4 4v14H7V3z",stroke:"currentColor",strokeWidth:"1.5"})})}),c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"font-medium text-slate-900 truncate",children:Ge||"(file)"}),c.jsxs("div",{className:"text-xs text-slate-500 truncate",children:["drive:"," ",c.jsx("span",{className:"font-mono",children:ge.drive_id})]}),c.jsxs("div",{className:"text-xs text-slate-500 truncate",children:["item:"," ",c.jsx("span",{className:"font-mono",children:ge.item_id})]})]})]}),c.jsxs("div",{className:"mt-3 flex gap-2",children:[c.jsx("button",{onClick:()=>{I(ge.url),W(Ge)},className:xc("px-3 py-1.5 rounded-lg text-sm",ve?"bg-indigo-600 text-white":"bg-slate-900 text-white hover:bg-black"),title:"Select this workbook",children:ve?"Selected":"Use"}),c.jsx("button",{onClick:()=>it(ge.id),className:"px-3 py-1.5 rounded-lg text-sm border border-slate-300 bg-white hover:bg-slate-50 text-rose-600",title:"Remove connection",children:"Disconnect"})]})]},ge.id)})}):c.jsx("div",{className:"text-slate-500 text-sm",children:"No connections yet. Add one above."})]}),U&&c.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"border border-slate-200 rounded-xl p-3",children:[c.jsx("div",{className:"font-medium mb-2",children:"Worksheets"}),U.worksheets?.length?c.jsx("ul",{className:"text-sm space-y-1",children:U.worksheets.map(ge=>c.jsx("li",{children:ge.name},ge.id))}):c.jsx("div",{className:"text-slate-500 text-sm",children:"None"})]}),c.jsxs("div",{className:"border border-slate-200 rounded-xl p-3",children:[c.jsx("div",{className:"font-medium mb-2",children:"Tables"}),U.tables?.length?c.jsx("ul",{className:"text-sm space-y-1",children:U.tables.map(ge=>c.jsx("li",{children:ge.name},ge.id))}):c.jsx("div",{className:"text-slate-500 text-sm",children:"None"})]})]}),oe&&c.jsxs("div",{className:"overflow-auto border border-slate-200 rounded-xl",children:[c.jsxs("table",{className:"min-w-full text-sm",children:[c.jsx("thead",{className:"bg-slate-50",children:c.jsx("tr",{children:oe.columns.map(ge=>c.jsx("th",{className:"px-2 py-1 text-left border-b",children:ge},ge))})}),c.jsx("tbody",{children:oe.rows.map((ge,Ge)=>c.jsx("tr",{className:"odd:bg-white even:bg-slate-50",children:oe.columns.map(ve=>c.jsx("td",{className:"px-2 py-1 border-b",children:ge[ve]},ve))},Ge))})]}),oe.truncated&&c.jsxs("div",{className:"p-2 text-xs text-slate-500",children:["Showing first ",oe.rows.length," rows (truncated)."]})]})]})]})}const bg=({children:e,tone:t="slate"})=>c.jsx("span",{className:`inline-flex items-center px-2 py-0.5 text-xs font-medium rounded-full bg-${t}-100 text-${t}-800`,children:e}),wg=({label:e,value:t,sub:r})=>c.jsxs("div",{className:"flex-1 rounded-2xl bg-white shadow-sm border p-4",children:[c.jsx("div",{className:"text-sm text-gray-500",children:e}),c.jsx("div",{className:"text-2xl font-semibold text-gray-900 mt-1",children:t}),r?c.jsx("div",{className:"text-xs text-gray-400 mt-1",children:r}):null]}),O_=({label:e,value:t,onChange:r,min:n,max:a})=>c.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[c.jsx("span",{className:"text-slate-600",children:e}),c.jsx("input",{type:"month",value:t,min:n,max:a,onChange:i=>r(i.target.value),className:"border rounded px-2 py-1 text-sm"})]}),CG=()=>{const[e,t]=y.useState(""),[r,n]=y.useState(""),[a,i]=y.useState([]),[l,u]=y.useState(!1),[h,d]=y.useState(!1),[m,p]=y.useState(!1),[v,g]=y.useState(!1),[w,b]=y.useState(null),[S,j]=y.useState(null),[_,A]=y.useState([]),[k,O]=y.useState(!1),[C,T]=y.useState(""),I=y.useMemo(()=>new Date,[]),M=`${I.getFullYear()}-${String(I.getMonth()+1).padStart(2,"0")}`,W=y.useMemo(()=>{const Ae=new Date(I);return Ae.setMonth(Ae.getMonth()-12),`${Ae.getFullYear()}-${String(Ae.getMonth()+1).padStart(2,"0")}`},[I]),[U,F]=y.useState(W),[oe,je]=y.useState(M),[ue,V]=y.useState(!1),[H,Se]=y.useState(null),[Q,z]=y.useState(""),Y=_?.length||0,P=y.useMemo(()=>{try{return _.reduce((Ae,D)=>Ae+(Number(D.Balance)||0),0)}catch{return 0}},[_]);y.useEffect(()=>{q(),G()},[]);const q=async()=>{try{const Ae=await We.get("/api/qbo/customers");g(!0);const Me=Ae?.data?.QueryResponse?.Customer||[];A(Me),b(Ae?.data?.realmId||null),j(Ae?.data?.environment||null)}catch{g(!1),A([]),b(null),j(null)}},G=async()=>{try{u(!0);const Ae=await We.get("/api/admin/quickbooks-api");if(Ae.data?.api){const D={id:Date.now(),apiKey:Ae.data.api,description:"Fetched from DB",timestamp:new Date().toLocaleString()};i([D])}}catch{}finally{u(!1)}},Z=async()=>{if(!e.trim()){alert("Please enter the QuickBooks API");return}try{await We.post("/api/admin/quickbooks-api",{api:e,description:r});const Ae={id:Date.now(),apiKey:e,description:r,timestamp:new Date().toLocaleString()};i([Ae,...a]),t(""),n(""),alert("QuickBooks API saved successfully!")}catch(Ae){console.error("Failed to save:",Ae),alert("Save failed.")}},fe=async()=>{try{d(!0);const Ae=await We.get("/api/qbo/connect"),{url:D}=Ae.data||{};D?window.location.href=D:(alert("Failed to start QuickBooks connect."),d(!1))}catch{alert("Please sign in first, then try connecting."),d(!1)}},Oe=async()=>{if(!(!v||!window.confirm("Disconnect QuickBooks for this workspace?")))try{p(!0),await We.post("/api/qbo/disconnect",{realmId:w}),g(!1),b(null),j(null),A([]),T("")}catch(D){console.error(D),alert("Failed to disconnect. Please try again.")}finally{p(!1)}},Re=async()=>{O(!0),T("");try{const D=(await We.get("/api/qbo/customers")).data;if(D?.Fault)T(D.Fault?.Error?.[0]?.Message||"Failed to fetch customers"),A([]);else{const Me=D?.QueryResponse?.Customer||[];A(Me),b(D?.realmId||w),j(D?.environment||S)}}catch{T("Not connected or insufficient permissions."),A([])}finally{O(!1)}},re=async()=>{if(!v){alert("Connect QuickBooks first.");return}V(!0),z(""),Se(null);try{const Ae={from:U?`${U}-01`:void 0,to:oe?`${oe}-28`:void 0},D=await We.post("/api/qbo/full-sync",Ae);Se(D.data||{ok:!0})}catch(Ae){console.error(Ae);const D=Ae?.response?.data?.error||Ae?.response?.data?.message||Ae?.message||"Full sync failed.";z(String(D))}finally{V(!1)}},be=async()=>{if(!v){alert("Connect QuickBooks first.");return}if(!U||!oe){alert("Select a valid From/To month range.");return}if(U>oe){alert("From month cannot be after To month.");return}V(!0),z(""),Se(null);try{const Ae=await We.post("/api/qbo/periods/sync",{from:U,to:oe});Se(Ae.data||{ok:!0})}catch(Ae){console.error(Ae);const D=Ae?.response?.data?.error||Ae?.response?.data?.message||Ae?.message||"Sync failed.";z(String(D))}finally{V(!1)}};return c.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 p-6 space-y-8",children:[c.jsxs("div",{className:"max-w-6xl mx-auto",children:[c.jsxs("div",{className:"flex items-start justify-between mb-4",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl md:text-3xl font-semibold text-slate-900",children:"QuickBooks Online"}),c.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"Connect your QBO company and sync your data to the database."})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(bg,{tone:v?"emerald":"rose",children:v?"Connected":"Not connected"}),S?c.jsx(bg,{tone:"blue",children:S}):null,w?c.jsxs(bg,{tone:"violet",children:["Realm: ",w]}):null]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[c.jsx(wg,{label:"Customers",value:Y,sub:v?"from QBO":""}),c.jsx(wg,{label:"Total Balance",value:P.toFixed(2),sub:v?"across customers":""}),c.jsx(wg,{label:"Status",value:v?"Linked":"Awaiting link",sub:v?"ready to sync":"click connect"})]})]}),c.jsxs("div",{className:"max-w-6xl mx-auto grid grid-cols-1 lg:grid-cols-3 gap-6",children:[c.jsxs("div",{className:"lg:col-span-2 bg-white rounded-2xl shadow-sm border",children:[c.jsxs("div",{className:"px-6 py-4 border-b flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",className:"text-slate-700",children:c.jsx("path",{fill:"currentColor",d:"M7 6v6a5 5 0 1 0 10 0V6h2V4h-4v8a3 3 0 1 1-6 0V4H5v2h2z"})}),c.jsx("span",{className:"font-semibold text-slate-800",children:"QuickBooks connection"})]}),v?c.jsx("span",{className:"text-xs text-emerald-600",children:"Youre connected"}):null]}),c.jsxs("div",{className:"p-6",children:[c.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"We use Intuits secure OAuth flow. Click connect, approve access, and youll return here automatically."}),c.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[v?c.jsx("button",{onClick:Oe,disabled:m,className:"inline-flex items-center gap-2 rounded-2xl bg-rose-600 hover:bg-rose-700 text-white px-5 py-2.5 shadow transition",title:"Revoke the connection and remove stored tokens",children:m?c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"animate-spin",width:"16",height:"16",viewBox:"0 0 24 24",children:[c.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none",opacity:"0.25"}),c.jsx("path",{d:"M22 12a10 10 0 0 1-10 10",stroke:"currentColor",strokeWidth:"4",fill:"none"})]}),"Disconnecting"]}):c.jsxs(c.Fragment,{children:[c.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",children:c.jsx("path",{fill:"currentColor",d:"M18 7l-1.41-1.41L12 10.17 7.41 5.59 6 7l4.59 4.59L6 16.17 7.41 17.6 12 13l4.59 4.59L18 16.17l-4.59-4.58L18 7z"})}),"Disconnect"]})}):c.jsx("button",{onClick:fe,disabled:h,className:"inline-flex items-center gap-2 rounded-2xl bg-emerald-600 hover:bg-emerald-700 text-white px-5 py-2.5 shadow transition",children:h?c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"animate-spin",width:"16",height:"16",viewBox:"0 0 24 24",children:[c.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none",opacity:"0.25"}),c.jsx("path",{d:"M22 12a10 10 0 0 1-10 10",stroke:"currentColor",strokeWidth:"4",fill:"none"})]}),"Connecting"]}):c.jsxs(c.Fragment,{children:[c.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",children:c.jsx("path",{fill:"currentColor",d:"M10 3H5a2 2 0 0 0-2 2v5h2V5h5V3zm4 0h5a2 2 0 0 1 2 2v5h-2V5h-5V3zM3 14v5a2 2 0 0 0 2 2h5v-2H5v-5H3zm18 0v5a2 2 0 0 1-2 2h-5v-2h5v-5h2z"})}),"Connect to QuickBooks"]})}),c.jsxs("button",{onClick:Re,className:"inline-flex items-center gap-2 rounded-2xl border border-slate-200 hover:bg-slate-50 text-slate-800 px-4 py-2 transition",children:[c.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",children:c.jsx("path",{fill:"currentColor",d:"M12 6v6l4 2-.5 1L11 13V6h1z"})}),"Test fetch customers"]}),v?null:c.jsx("span",{className:"text-xs text-slate-500",children:"Tip: Youll be redirected to Intuit and then back here."})]})]})]}),c.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border",children:[c.jsx("div",{className:"px-6 py-4 border-b font-semibold text-slate-800",children:"(Optional) Admin API Notes"}),c.jsxs("div",{className:"p-6 space-y-3",children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"QuickBooks API"}),c.jsx("input",{type:"text",value:e,onChange:Ae=>t(Ae.target.value),placeholder:"Enter QuickBooks API",className:"w-full border border-slate-200 rounded-xl px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-emerald-200"}),c.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Description"}),c.jsx("input",{type:"text",value:r,onChange:Ae=>n(Ae.target.value),placeholder:"Add a note",className:"w-full border border-slate-200 rounded-xl px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-emerald-200"}),c.jsx("button",{onClick:Z,className:"w-full rounded-xl bg-slate-900 hover:bg-black text-white py-2 text-sm transition",children:"Save note"})]})]})]}),c.jsxs("div",{className:"max-w-6xl mx-auto bg-white rounded-2xl shadow-sm border p-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Sync data to DB"}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx(O_,{label:"From",value:U,onChange:F,max:oe||void 0}),c.jsx(O_,{label:"To",value:oe,onChange:je,min:U||void 0}),c.jsx("button",{className:"inline-flex items-center gap-2 rounded-xl bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 text-sm transition disabled:opacity-60",onClick:re,disabled:!v||ue,title:v?"Dump all QBO entities into qbo_entities":"Connect QuickBooks first",children:ue?c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"animate-spin",width:"16",height:"16",viewBox:"0 0 24 24",children:[c.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none",opacity:"0.25"}),c.jsx("path",{d:"M22 12a10 10 0 0 1-10 10",stroke:"currentColor",strokeWidth:"4",fill:"none"})]}),"Full syncing"]}):c.jsxs(c.Fragment,{children:[c.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",children:c.jsx("path",{fill:"currentColor",d:"M5 13h14v-2H5v2z"})}),"Full sync (all entities)"]})}),c.jsx("button",{className:"inline-flex items-center gap-2 rounded-xl border border-slate-300 hover:bg-slate-50 text-slate-800 px-4 py-2 text-sm transition disabled:opacity-60",onClick:be,disabled:!v||ue,title:"Optional: write one roll-up row per month to qbo_period_metrics",children:"Monthly rollup"})]})]}),Q&&c.jsx("p",{className:"text-rose-600 text-sm mb-2",children:Q}),H?c.jsx("div",{className:"rounded border bg-slate-50 p-3 text-xs overflow-x-auto",children:c.jsx("pre",{className:"whitespace-pre-wrap",children:JSON.stringify(H,null,2)})}):c.jsxs("p",{className:"text-sm text-slate-500",children:[c.jsx("strong",{children:"Full sync"})," will store all supported QuickBooks entities into"," ",c.jsx("code",{children:"qbo_entities"})," and record a summary in ",c.jsx("code",{children:"qbo_sync_logs"}),". Use the month pickers to hint a date window for transaction types (Invoices, Bills, Payments, etc.). The Monthly rollup button (optional) writes one row per month into"," ",c.jsx("code",{children:"qbo_period_metrics"}),"."]})]}),c.jsxs("div",{className:"max-w-6xl mx-auto bg-white rounded-2xl shadow-sm border p-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"History"}),l?c.jsx("span",{className:"text-xs text-slate-500",children:"Loading"}):null]}),a.length===0?c.jsx("p",{className:"text-sm text-slate-500",children:"No entries yet."}):c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full text-sm",children:[c.jsx("thead",{className:"bg-slate-50 text-slate-600",children:c.jsxs("tr",{children:[c.jsx("th",{className:"p-2 text-left",children:"#"}),c.jsx("th",{className:"p-2 text-left",children:"API"}),c.jsx("th",{className:"p-2 text-left",children:"Description"}),c.jsx("th",{className:"p-2 text-left",children:"Timestamp"})]})}),c.jsx("tbody",{children:a.map((Ae,D)=>c.jsxs("tr",{className:"border-t hover:bg-slate-50",children:[c.jsx("td",{className:"p-2",children:D+1}),c.jsx("td",{className:"p-2",children:Ae.apiKey}),c.jsx("td",{className:"p-2",children:Ae.description}),c.jsx("td",{className:"p-2",children:Ae.timestamp})]},Ae.id))})]})})]}),c.jsxs("div",{className:"max-w-6xl mx-auto bg-white rounded-2xl shadow-sm border p-6",children:[c.jsx("div",{className:"flex items-center justify-between mb-4",children:c.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"QuickBooks Customers"})}),k?c.jsx("p",{className:"text-slate-500 text-sm",children:"Loading customers"}):C?c.jsx("p",{className:"text-rose-600 text-sm",children:C}):_.length===0?c.jsx("p",{className:"text-slate-500 text-sm",children:"No customers found."}):c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full text-sm",children:[c.jsx("thead",{className:"bg-slate-50 text-slate-600",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-3 py-2 text-left",children:"Display Name"}),c.jsx("th",{className:"px-3 py-2 text-left",children:"Email"}),c.jsx("th",{className:"px-3 py-2 text-left",children:"Phone"}),c.jsx("th",{className:"px-3 py-2 text-left",children:"Balance"})]})}),c.jsx("tbody",{children:_.map((Ae,D)=>c.jsxs("tr",{className:"border-t hover:bg-slate-50",children:[c.jsx("td",{className:"px-3 py-2",children:Ae.DisplayName}),c.jsx("td",{className:"px-3 py-2",children:Ae.PrimaryEmailAddr?.Address||"-"}),c.jsx("td",{className:"px-3 py-2",children:Ae.PrimaryPhone?.FreeFormNumber||"-"}),c.jsx("td",{className:"px-3 py-2",children:Ae.Balance??"0.00"})]},D))})]})})]})]})},OG="https://clarus.elpiscapital.com";function DG(){const e=Fi(),[t,r]=y.useState({first_name:"",last_name:"",birthdate:"",citizenship:"",email:"",phone:"",ssn:"",address1:"",address2:"",country:"",city:"",state:"",zip:""}),[n,a]=y.useState(!1),[i,l]=y.useState(""),[u,h]=y.useState(""),d=y.useMemo(()=>{const g=(t.first_name||"").trim()[0]||"",w=(t.last_name||"").trim()[0]||"";return(g+w||"A").toUpperCase()},[t.first_name,t.last_name]),m=g=>r(w=>({...w,[g.target.name]:g.target.value})),p=["first_name","last_name","birthdate","citizenship","email","phone","ssn","address1","country","city","state","zip"],v=async g=>{g.preventDefault(),h(""),l("");for(const b of p)if(!String(t[b]||"").trim()){const S=b.replace("_"," ");h(`${S} is required`);return}const w=localStorage.getItem("accessToken")||sessionStorage.getItem("accessToken");if(!w){h("Your session has expired. Please log in again."),e("/login");return}a(!0);try{const b=await fetch(`${OG}/manual/manual_entry`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${w}`},body:JSON.stringify(t)});if(b.status===401||b.status===403){h("Your session has expired. Please log in again."),e("/login");return}const S=await b.json().catch(()=>({}));if(!b.ok)throw new Error(S?.msg||`Submit failed (${b.status})`);l("Manual entry saved successfully."),r({first_name:"",last_name:"",birthdate:"",citizenship:"",email:"",phone:"",ssn:"",address1:"",address2:"",country:"",city:"",state:"",zip:""}),setTimeout(()=>l(""),2500)}catch(b){h(b.message||"Unable to submit. Please try again.")}finally{a(!1)}};return c.jsx("div",{className:"max-w-5xl mx-auto p-6",children:c.jsxs("form",{onSubmit:v,className:"space-y-10",children:[c.jsxs("section",{className:"rounded-2xl border border-gray-200 bg-white shadow-sm",children:[c.jsx("div",{className:"flex items-start justify-between p-6 border-b",children:c.jsx("h2",{className:"text-xl font-semibold",children:"Personal Information"})}),c.jsx("div",{className:"p-6",children:c.jsxs("div",{className:"grid grid-cols-[96px_1fr] gap-6 items-start",children:[c.jsx("div",{className:"h-24 w-24 rounded-full bg-teal-500 text-white grid place-items-center text-3xl font-semibold",children:d}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsx(ta,{label:"First Name",name:"first_name",value:t.first_name,onChange:m,required:!0}),c.jsx(ta,{label:"Last Name",name:"last_name",value:t.last_name,onChange:m,required:!0}),c.jsx(ta,{label:"Birthdate",name:"birthdate",value:t.birthdate,onChange:m,placeholder:"MM/DD/YYYY",required:!0}),c.jsx(ta,{label:"Citizenship",name:"citizenship",value:t.citizenship,onChange:m,placeholder:"United States",required:!0}),c.jsx(ta,{label:"Email",name:"email",type:"email",value:t.email,onChange:m,required:!0}),c.jsx(ta,{label:"Phone",name:"phone",value:t.phone,onChange:m,required:!0}),c.jsx(ta,{label:"SSN / Tax ID",name:"ssn",value:t.ssn,onChange:m,required:!0}),c.jsx("div",{className:"text-xs text-gray-500 self-end",children:"SSN / Tax ID is an encrypted attribute"})]})]})})]}),c.jsxs("section",{className:"rounded-2xl border border-gray-200 bg-white shadow-sm",children:[c.jsx("div",{className:"p-6 border-b",children:c.jsx("h3",{className:"text-xl font-semibold",children:"Residential Address"})}),c.jsxs("div",{className:"p-6 grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsx("div",{className:"md:col-span-2",children:c.jsx(ta,{label:"Street Address 1",name:"address1",value:t.address1,onChange:m,required:!0})}),c.jsx("div",{className:"md:col-span-2",children:c.jsx(ta,{label:"Street Address 2 (Optional)",name:"address2",value:t.address2,onChange:m})}),c.jsx(ta,{label:"Country",name:"country",value:t.country,onChange:m,required:!0}),c.jsx(ta,{label:"City",name:"city",value:t.city,onChange:m,required:!0}),c.jsx(ta,{label:"State / Province",name:"state",value:t.state,onChange:m,required:!0}),c.jsx(ta,{label:"Zip / Postal Code",name:"zip",value:t.zip,onChange:m,required:!0})]})]}),u&&c.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 text-rose-700 px-4 py-3",children:u}),i&&c.jsx("div",{className:"rounded-xl border border-emerald-200 bg-emerald-50 text-emerald-700 px-4 py-3",children:i}),c.jsx("div",{children:c.jsx("button",{type:"submit",disabled:n,className:"inline-flex items-center justify-center rounded-xl bg-indigo-600 text-white font-medium px-6 py-3 shadow hover:brightness-110 active:scale-[0.99] disabled:opacity-60",children:n?"Saving":"Save Manual Entry"})})]})})}function ta({label:e,name:t,value:r,onChange:n,required:a,type:i="text",placeholder:l=""}){return c.jsxs("div",{className:"space-y-1",children:[c.jsxs("label",{className:"block text-sm font-semibold text-gray-700",children:[e,a&&c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{name:t,type:i,value:r,onChange:n,placeholder:l,required:a,className:"w-full rounded-lg border px-3 py-2.5 bg-gray-50 focus:bg-white focus:outline-none focus:ring-4 focus:ring-indigo-100 border-gray-300"})]})}function R5(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=R5(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function Tt(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=R5(e))&&(n&&(n+=" "),n+=t);return n}var Sg={},Eg={},D_;function PG(){return D_||(D_=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t}(Eg)),Eg}var jg={},P_;function M5(){return P_||(P_=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t}(jg)),jg}var Ng={},R_;function F5(){return R_||(R_=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}e.toKey=t}(Ng)),Ng}var Ag={},M_;function f2(){return M_||(M_=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){const n=[],a=r.length;if(a===0)return n;let i=0,l="",u="",h=!1;for(r.charCodeAt(0)===46&&(n.push(""),i++);i<a;){const d=r[i];u?d==="\\"&&i+1<a?(i++,l+=r[i]):d===u?u="":l+=d:h?d==='"'||d==="'"?u=d:d==="]"?(h=!1,n.push(l),l=""):l+=d:d==="["?(h=!0,l&&(n.push(l),l="")):d==="."?l&&(n.push(l),l=""):l+=d,i++}return l&&n.push(l),n}e.toPath=t}(Ag)),Ag}var F_;function d2(){return F_||(F_=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=PG(),r=M5(),n=F5(),a=f2();function i(u,h,d){if(u==null)return d;switch(typeof h){case"string":{if(t.isUnsafeProperty(h))return d;const m=u[h];return m===void 0?r.isDeepKey(h)?i(u,a.toPath(h),d):d:m}case"number":case"symbol":{typeof h=="number"&&(h=n.toKey(h));const m=u[h];return m===void 0?d:m}default:{if(Array.isArray(h))return l(u,h,d);if(Object.is(h?.valueOf(),-0)?h="-0":h=String(h),t.isUnsafeProperty(h))return d;const m=u[h];return m===void 0?d:m}}}function l(u,h,d){if(h.length===0)return d;let m=u;for(let p=0;p<h.length;p++){if(m==null||t.isUnsafeProperty(h[p]))return d;m=m[h[p]]}return m===void 0?d:m}e.get=i}(Sg)),Sg}var _g,I_;function RG(){return I_||(I_=1,_g=d2().get),_g}var MG=RG();const gl=Ga(MG);var Tg={exports:{}},qt={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var L_;function FG(){if(L_)return qt;L_=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),m=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),v=Symbol.for("react.view_transition"),g=Symbol.for("react.client.reference");function w(b){if(typeof b=="object"&&b!==null){var S=b.$$typeof;switch(S){case e:switch(b=b.type,b){case r:case a:case n:case h:case d:case v:return b;default:switch(b=b&&b.$$typeof,b){case l:case u:case p:case m:return b;case i:return b;default:return S}}case t:return S}}}return qt.ContextConsumer=i,qt.ContextProvider=l,qt.Element=e,qt.ForwardRef=u,qt.Fragment=r,qt.Lazy=p,qt.Memo=m,qt.Portal=t,qt.Profiler=a,qt.StrictMode=n,qt.Suspense=h,qt.SuspenseList=d,qt.isContextConsumer=function(b){return w(b)===i},qt.isContextProvider=function(b){return w(b)===l},qt.isElement=function(b){return typeof b=="object"&&b!==null&&b.$$typeof===e},qt.isForwardRef=function(b){return w(b)===u},qt.isFragment=function(b){return w(b)===r},qt.isLazy=function(b){return w(b)===p},qt.isMemo=function(b){return w(b)===m},qt.isPortal=function(b){return w(b)===t},qt.isProfiler=function(b){return w(b)===a},qt.isStrictMode=function(b){return w(b)===n},qt.isSuspense=function(b){return w(b)===h},qt.isSuspenseList=function(b){return w(b)===d},qt.isValidElementType=function(b){return typeof b=="string"||typeof b=="function"||b===r||b===a||b===n||b===h||b===d||typeof b=="object"&&b!==null&&(b.$$typeof===p||b.$$typeof===m||b.$$typeof===l||b.$$typeof===i||b.$$typeof===u||b.$$typeof===g||b.getModuleId!==void 0)},qt.typeOf=w,qt}var B_;function IG(){return B_||(B_=1,Tg.exports=FG()),Tg.exports}var LG=IG(),Ar=e=>e===0?0:e>0?1:-1,ma=e=>typeof e=="number"&&e!=+e,to=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,rt=e=>(typeof e=="number"||e instanceof Number)&&!ma(e),Ci=e=>rt(e)||typeof e=="string",BG=0,yl=e=>{var t=++BG;return"".concat(e||"").concat(t)},Dn=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!rt(t)&&typeof t!="string")return n;var i;if(to(t)){if(r==null)return n;var l=t.indexOf("%");i=r*parseFloat(t.slice(0,l))/100}else i=+t;return ma(i)&&(i=n),a&&r!=null&&i>r&&(i=r),i},I5=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[e[n]])r[e[n]]=!0;else return!0;return!1},Nr=(e,t)=>rt(e)&&rt(t)?r=>e+r*(t-e):()=>t;function L5(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):gl(n,t))===r)}var UG=e=>{if(!e||!e.length)return null;for(var t=e.length,r=0,n=0,a=0,i=0,l=1/0,u=-1/0,h=0,d=0,m=0;m<t;m++)h=e[m].cx||0,d=e[m].cy||0,r+=h,n+=d,a+=h*d,i+=h*h,l=Math.min(l,h),u=Math.max(u,h);var p=t*i!==r*r?(t*a-r*n)/(t*i-r*r):0;return{xmin:l,xmax:u,a:p,b:(n-p*r)/t}},Ot=e=>e===null||typeof e>"u",bd=e=>Ot(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),$G=["viewBox","children"],zG=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],U_=["points","pathLength"],kg={svg:$G,polygon:U_,polyline:U_},h2=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],m2=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(y.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(a=>{h2.includes(a)&&(n[a]=i=>r[a](r,i))}),n},HG=(e,t,r)=>n=>(e(t,r,n),null),bl=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(a=>{var i=e[a];h2.includes(a)&&typeof i=="function"&&(n||(n={}),n[a]=HG(i,t,r))}),n},$_=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",z_=null,Cg=null,B5=e=>{if(e===z_&&Array.isArray(Cg))return Cg;var t=[];return y.Children.forEach(e,r=>{Ot(r)||(LG.isFragment(r)?t=t.concat(B5(r.props.children)):t.push(r))}),Cg=t,z_=e,t};function ko(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(a=>$_(a)):n=[$_(t)],B5(e).forEach(a=>{var i=gl(a,"type.displayName")||gl(a,"type.name");n.indexOf(i)!==-1&&r.push(a)}),r}var U5=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,qG=(e,t,r,n)=>{var a,i=(a=n&&kg?.[n])!==null&&a!==void 0?a:[];return t.startsWith("data-")||typeof e!="function"&&(n&&i.includes(t)||zG.includes(t))||r&&h2.includes(t)},vt=(e,t,r)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(y.isValidElement(e)&&(n=e.props),typeof n!="object"&&typeof n!="function")return null;var a={};return Object.keys(n).forEach(i=>{var l;qG((l=n)===null||l===void 0?void 0:l[i],i,t,r)&&(a[i]=n[i])}),a},VG=["children","width","height","viewBox","className","style","title","desc"];function ky(){return ky=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ky.apply(null,arguments)}function KG(e,t){if(e==null)return{};var r,n,a=GG(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function GG(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var p2=y.forwardRef((e,t)=>{var{children:r,width:n,height:a,viewBox:i,className:l,style:u,title:h,desc:d}=e,m=KG(e,VG),p=i||{width:n,height:a,x:0,y:0},v=Tt("recharts-surface",l);return y.createElement("svg",ky({},vt(m,!0,"svg"),{className:v,width:n,height:a,style:u,viewBox:"".concat(p.x," ").concat(p.y," ").concat(p.width," ").concat(p.height),ref:t}),y.createElement("title",null,h),y.createElement("desc",null,d),r)}),WG=["children","className"];function Cy(){return Cy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Cy.apply(null,arguments)}function YG(e,t){if(e==null)return{};var r,n,a=XG(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function XG(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Wt=y.forwardRef((e,t)=>{var{children:r,className:n}=e,a=YG(e,WG),i=Tt("recharts-layer",n);return y.createElement("g",Cy({className:i},vt(a,!0),{ref:t}),r)}),$5=y.createContext(null),ZG=()=>y.useContext($5);function Xt(e){return function(){return e}}const z5=Math.cos,Xh=Math.sin,pi=Math.sqrt,Zh=Math.PI,Jm=2*Zh,Oy=Math.PI,Dy=2*Oy,Wl=1e-6,QG=Dy-Wl;function H5(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function JG(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return H5;const r=10**t;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class eW{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?H5:JG(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,l){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+l}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let l=this._x1,u=this._y1,h=n-t,d=a-r,m=l-t,p=u-r,v=m*m+p*p;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(v>Wl)if(!(Math.abs(p*h-d*m)>Wl)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let g=n-l,w=a-u,b=h*h+d*d,S=g*g+w*w,j=Math.sqrt(b),_=Math.sqrt(v),A=i*Math.tan((Oy-Math.acos((b+v-S)/(2*j*_)))/2),k=A/_,O=A/j;Math.abs(k-1)>Wl&&this._append`L${t+k*m},${r+k*p}`,this._append`A${i},${i},0,0,${+(p*g>m*w)},${this._x1=t+O*h},${this._y1=r+O*d}`}}arc(t,r,n,a,i,l){if(t=+t,r=+r,n=+n,l=!!l,n<0)throw new Error(`negative radius: ${n}`);let u=n*Math.cos(a),h=n*Math.sin(a),d=t+u,m=r+h,p=1^l,v=l?a-i:i-a;this._x1===null?this._append`M${d},${m}`:(Math.abs(this._x1-d)>Wl||Math.abs(this._y1-m)>Wl)&&this._append`L${d},${m}`,n&&(v<0&&(v=v%Dy+Dy),v>QG?this._append`A${n},${n},0,1,${p},${t-u},${r-h}A${n},${n},0,1,${p},${this._x1=d},${this._y1=m}`:v>Wl&&this._append`A${n},${n},0,${+(v>=Oy)},${p},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function x2(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new eW(t)}function v2(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function q5(e){this._context=e}q5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function ep(e){return new q5(e)}function V5(e){return e[0]}function K5(e){return e[1]}function G5(e,t){var r=Xt(!0),n=null,a=ep,i=null,l=x2(u);e=typeof e=="function"?e:e===void 0?V5:Xt(e),t=typeof t=="function"?t:t===void 0?K5:Xt(t);function u(h){var d,m=(h=v2(h)).length,p,v=!1,g;for(n==null&&(i=a(g=l())),d=0;d<=m;++d)!(d<m&&r(p=h[d],d,h))===v&&((v=!v)?i.lineStart():i.lineEnd()),v&&i.point(+e(p,d,h),+t(p,d,h));if(g)return i=null,g+""||null}return u.x=function(h){return arguments.length?(e=typeof h=="function"?h:Xt(+h),u):e},u.y=function(h){return arguments.length?(t=typeof h=="function"?h:Xt(+h),u):t},u.defined=function(h){return arguments.length?(r=typeof h=="function"?h:Xt(!!h),u):r},u.curve=function(h){return arguments.length?(a=h,n!=null&&(i=a(n)),u):a},u.context=function(h){return arguments.length?(h==null?n=i=null:i=a(n=h),u):n},u}function uh(e,t,r){var n=null,a=Xt(!0),i=null,l=ep,u=null,h=x2(d);e=typeof e=="function"?e:e===void 0?V5:Xt(+e),t=typeof t=="function"?t:Xt(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?K5:Xt(+r);function d(p){var v,g,w,b=(p=v2(p)).length,S,j=!1,_,A=new Array(b),k=new Array(b);for(i==null&&(u=l(_=h())),v=0;v<=b;++v){if(!(v<b&&a(S=p[v],v,p))===j)if(j=!j)g=v,u.areaStart(),u.lineStart();else{for(u.lineEnd(),u.lineStart(),w=v-1;w>=g;--w)u.point(A[w],k[w]);u.lineEnd(),u.areaEnd()}j&&(A[v]=+e(S,v,p),k[v]=+t(S,v,p),u.point(n?+n(S,v,p):A[v],r?+r(S,v,p):k[v]))}if(_)return u=null,_+""||null}function m(){return G5().defined(a).curve(l).context(i)}return d.x=function(p){return arguments.length?(e=typeof p=="function"?p:Xt(+p),n=null,d):e},d.x0=function(p){return arguments.length?(e=typeof p=="function"?p:Xt(+p),d):e},d.x1=function(p){return arguments.length?(n=p==null?null:typeof p=="function"?p:Xt(+p),d):n},d.y=function(p){return arguments.length?(t=typeof p=="function"?p:Xt(+p),r=null,d):t},d.y0=function(p){return arguments.length?(t=typeof p=="function"?p:Xt(+p),d):t},d.y1=function(p){return arguments.length?(r=p==null?null:typeof p=="function"?p:Xt(+p),d):r},d.lineX0=d.lineY0=function(){return m().x(e).y(t)},d.lineY1=function(){return m().x(e).y(r)},d.lineX1=function(){return m().x(n).y(t)},d.defined=function(p){return arguments.length?(a=typeof p=="function"?p:Xt(!!p),d):a},d.curve=function(p){return arguments.length?(l=p,i!=null&&(u=l(i)),d):l},d.context=function(p){return arguments.length?(p==null?i=u=null:u=l(i=p),d):i},d}class W5{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function tW(e){return new W5(e,!0)}function rW(e){return new W5(e,!1)}const g2={draw(e,t){const r=pi(t/Zh);e.moveTo(r,0),e.arc(0,0,r,0,Jm)}},nW={draw(e,t){const r=pi(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},Y5=pi(1/3),aW=Y5*2,iW={draw(e,t){const r=pi(t/aW),n=r*Y5;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},sW={draw(e,t){const r=pi(t),n=-r/2;e.rect(n,n,r,r)}},lW=.8908130915292852,X5=Xh(Zh/10)/Xh(7*Zh/10),oW=Xh(Jm/10)*X5,cW=-z5(Jm/10)*X5,uW={draw(e,t){const r=pi(t*lW),n=oW*r,a=cW*r;e.moveTo(0,-r),e.lineTo(n,a);for(let i=1;i<5;++i){const l=Jm*i/5,u=z5(l),h=Xh(l);e.lineTo(h*r,-u*r),e.lineTo(u*n-h*a,h*n+u*a)}e.closePath()}},Og=pi(3),fW={draw(e,t){const r=-pi(t/(Og*3));e.moveTo(0,r*2),e.lineTo(-Og*r,-r),e.lineTo(Og*r,-r),e.closePath()}},Oa=-.5,Da=pi(3)/2,Py=1/pi(12),dW=(Py/2+1)*3,hW={draw(e,t){const r=pi(t/dW),n=r/2,a=r*Py,i=n,l=r*Py+r,u=-i,h=l;e.moveTo(n,a),e.lineTo(i,l),e.lineTo(u,h),e.lineTo(Oa*n-Da*a,Da*n+Oa*a),e.lineTo(Oa*i-Da*l,Da*i+Oa*l),e.lineTo(Oa*u-Da*h,Da*u+Oa*h),e.lineTo(Oa*n+Da*a,Oa*a-Da*n),e.lineTo(Oa*i+Da*l,Oa*l-Da*i),e.lineTo(Oa*u+Da*h,Oa*h-Da*u),e.closePath()}};function mW(e,t){let r=null,n=x2(a);e=typeof e=="function"?e:Xt(e||g2),t=typeof t=="function"?t:Xt(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:Xt(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:Xt(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function Qh(){}function Jh(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function Z5(e){this._context=e}Z5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Jh(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Jh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function pW(e){return new Z5(e)}function Q5(e){this._context=e}Q5.prototype={areaStart:Qh,areaEnd:Qh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Jh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function xW(e){return new Q5(e)}function J5(e){this._context=e}J5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:Jh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function vW(e){return new J5(e)}function e6(e){this._context=e}e6.prototype={areaStart:Qh,areaEnd:Qh,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function gW(e){return new e6(e)}function H_(e){return e<0?-1:1}function q_(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),l=(r-e._y1)/(a||n<0&&-0),u=(i*a+l*n)/(n+a);return(H_(i)+H_(l))*Math.min(Math.abs(i),Math.abs(l),.5*Math.abs(u))||0}function V_(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Dg(e,t,r){var n=e._x0,a=e._y0,i=e._x1,l=e._y1,u=(i-n)/3;e._context.bezierCurveTo(n+u,a+u*t,i-u,l-u*r,i,l)}function em(e){this._context=e}em.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Dg(this,this._t0,V_(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Dg(this,V_(this,r=q_(this,e,t)),r);break;default:Dg(this,this._t0,r=q_(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function t6(e){this._context=new r6(e)}(t6.prototype=Object.create(em.prototype)).point=function(e,t){em.prototype.point.call(this,t,e)};function r6(e){this._context=e}r6.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function yW(e){return new em(e)}function bW(e){return new t6(e)}function n6(e){this._context=e}n6.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=K_(e),a=K_(t),i=0,l=1;l<r;++i,++l)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[l],t[l]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function K_(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),l=new Array(r);for(a[0]=0,i[0]=2,l[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,l[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,l[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,l[t]-=n*l[t-1];for(a[r-1]=l[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(l[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function wW(e){return new n6(e)}function tp(e,t){this._context=e,this._t=t}tp.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function SW(e){return new tp(e,.5)}function EW(e){return new tp(e,0)}function jW(e){return new tp(e,1)}function Pc(e,t){if((l=e.length)>1)for(var r=1,n,a,i=e[t[0]],l,u=i.length;r<l;++r)for(a=i,i=e[t[r]],n=0;n<u;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function Ry(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function NW(e,t){return e[t]}function AW(e){const t=[];return t.key=e,t}function _W(){var e=Xt([]),t=Ry,r=Pc,n=NW;function a(i){var l=Array.from(e.apply(this,arguments),AW),u,h=l.length,d=-1,m;for(const p of i)for(u=0,++d;u<h;++u)(l[u][d]=[0,+n(p,l[u].key,d,i)]).data=p;for(u=0,m=v2(t(l));u<h;++u)l[m[u]].index=u;return r(l,m),l}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:Xt(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:Xt(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?Ry:typeof i=="function"?i:Xt(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??Pc,a):r},a}function TW(e,t){if((n=e.length)>0){for(var r,n,a=0,i=e[0].length,l;a<i;++a){for(l=r=0;r<n;++r)l+=e[r][a][1]||0;if(l)for(r=0;r<n;++r)e[r][a][1]/=l}Pc(e,t)}}function kW(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var l=0,u=0;l<a;++l)u+=e[l][r][1]||0;n[r][1]+=n[r][0]=-u/2}Pc(e,t)}}function CW(e,t){if(!(!((l=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,i,l;n<i;++n){for(var u=0,h=0,d=0;u<l;++u){for(var m=e[t[u]],p=m[n][1]||0,v=m[n-1][1]||0,g=(p-v)/2,w=0;w<u;++w){var b=e[t[w]],S=b[n][1]||0,j=b[n-1][1]||0;g+=S-j}h+=p,d+=g*p}a[n-1][1]+=a[n-1][0]=r,h&&(r-=d/h)}a[n-1][1]+=a[n-1][0]=r,Pc(e,t)}}var OW=["type","size","sizeType"];function My(){return My=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},My.apply(null,arguments)}function G_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function W_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?G_(Object(r),!0).forEach(function(n){DW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function DW(e,t,r){return(t=PW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PW(e){var t=RW(e,"string");return typeof t=="symbol"?t:t+""}function RW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function MW(e,t){if(e==null)return{};var r,n,a=FW(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function FW(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var a6={symbolCircle:g2,symbolCross:nW,symbolDiamond:iW,symbolSquare:sW,symbolStar:uW,symbolTriangle:fW,symbolWye:hW},IW=Math.PI/180,LW=e=>{var t="symbol".concat(bd(e));return a6[t]||g2},BW=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*IW;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},UW=(e,t)=>{a6["symbol".concat(bd(e))]=t},rp=e=>{var{type:t="circle",size:r=64,sizeType:n="area"}=e,a=MW(e,OW),i=W_(W_({},a),{},{type:t,size:r,sizeType:n}),l=()=>{var p=LW(t),v=mW().type(p).size(BW(r,n,t));return v()},{className:u,cx:h,cy:d}=i,m=vt(i,!0);return h===+h&&d===+d&&r===+r?y.createElement("path",My({},m,{className:Tt("recharts-symbols",u),transform:"translate(".concat(h,", ").concat(d,")"),d:l()})):null};rp.registerSymbol=UW;function Fy(){return Fy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fy.apply(null,arguments)}function Y_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function $W(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Y_(Object(r),!0).forEach(function(n){y2(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Y_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function y2(e,t,r){return(t=zW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zW(e){var t=HW(e,"string");return typeof t=="symbol"?t:t+""}function HW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Pa=32;class b2 extends y.PureComponent{renderIcon(t,r){var{inactiveColor:n}=this.props,a=Pa/2,i=Pa/6,l=Pa/3,u=t.inactive?n:t.color,h=r??t.type;if(h==="none")return null;if(h==="plainline")return y.createElement("line",{strokeWidth:4,fill:"none",stroke:u,strokeDasharray:t.payload.strokeDasharray,x1:0,y1:a,x2:Pa,y2:a,className:"recharts-legend-icon"});if(h==="line")return y.createElement("path",{strokeWidth:4,fill:"none",stroke:u,d:"M0,".concat(a,"h").concat(l,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(2*l,",").concat(a,`
            H`).concat(Pa,"M").concat(2*l,",").concat(a,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(l,",").concat(a),className:"recharts-legend-icon"});if(h==="rect")return y.createElement("path",{stroke:"none",fill:u,d:"M0,".concat(Pa/8,"h").concat(Pa,"v").concat(Pa*3/4,"h").concat(-Pa,"z"),className:"recharts-legend-icon"});if(y.isValidElement(t.legendIcon)){var d=$W({},t);return delete d.legendIcon,y.cloneElement(t.legendIcon,d)}return y.createElement(rp,{fill:u,cx:a,cy:a,size:Pa,sizeType:"diameter",type:h})}renderItems(){var{payload:t,iconSize:r,layout:n,formatter:a,inactiveColor:i,iconType:l}=this.props,u={x:0,y:0,width:Pa,height:Pa},h={display:n==="horizontal"?"inline-block":"block",marginRight:10},d={display:"inline-block",verticalAlign:"middle",marginRight:4};return t.map((m,p)=>{var v=m.formatter||a,g=Tt({"recharts-legend-item":!0,["legend-item-".concat(p)]:!0,inactive:m.inactive});if(m.type==="none")return null;var w=m.inactive?i:m.color,b=v?v(m.value,m,p):m.value;return y.createElement("li",Fy({className:g,style:h,key:"legend-item-".concat(p)},bl(this.props,m,p)),y.createElement(p2,{width:r,height:r,viewBox:u,style:d,"aria-label":"".concat(b," legend icon")},this.renderIcon(m,l)),y.createElement("span",{className:"recharts-legend-item-text",style:{color:w}},b))})}render(){var{payload:t,layout:r,align:n}=this.props;if(!t||!t.length)return null;var a={padding:0,margin:0,textAlign:r==="horizontal"?n:"left"};return y.createElement("ul",{className:"recharts-default-legend",style:a},this.renderItems())}}y2(b2,"displayName","Legend");y2(b2,"defaultProps",{align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"});var Pg={},Rg={},X_;function qW(){return X_||(X_=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const a=new Map;for(let i=0;i<r.length;i++){const l=r[i],u=n(l);a.has(u)||a.set(u,l)}return Array.from(a.values())}e.uniqBy=t}(Rg)),Rg}var Mg={},Z_;function i6(){return Z_||(Z_=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t}(Mg)),Mg}var Fg={},Ig={},Lg={},Q_;function VW(){return Q_||(Q_=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t}(Lg)),Lg}var J_;function w2(){return J_||(J_=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=VW();function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r}(Ig)),Ig}var Bg={},eT;function KW(){return eT||(eT=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t}(Bg)),Bg}var tT;function GW(){return tT||(tT=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=w2(),r=KW();function n(a){return r.isObjectLike(a)&&t.isArrayLike(a)}e.isArrayLikeObject=n}(Fg)),Fg}var Ug={},$g={},rT;function WW(){return rT||(rT=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=d2();function r(n){return function(a){return t.get(a,n)}}e.property=r}($g)),$g}var zg={},Hg={},qg={},Vg={},nT;function s6(){return nT||(nT=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t}(Vg)),Vg}var Kg={},aT;function l6(){return aT||(aT=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t}(Kg)),Kg}var Gg={},iT;function S2(){return iT||(iT=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.eq=t}(Gg)),Gg}var sT;function YW(){return sT||(sT=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=E2(),r=s6(),n=l6(),a=S2();function i(p,v,g){return typeof g!="function"?t.isMatch(p,v):l(p,v,function w(b,S,j,_,A,k){const O=g(b,S,j,_,A,k);return O!==void 0?!!O:l(b,S,w,k)},new Map)}function l(p,v,g,w){if(v===p)return!0;switch(typeof v){case"object":return u(p,v,g,w);case"function":return Object.keys(v).length>0?l(p,{...v},g,w):a.eq(p,v);default:return r.isObject(p)?typeof v=="string"?v==="":!0:a.eq(p,v)}}function u(p,v,g,w){if(v==null)return!0;if(Array.isArray(v))return d(p,v,g,w);if(v instanceof Map)return h(p,v,g,w);if(v instanceof Set)return m(p,v,g,w);const b=Object.keys(v);if(p==null)return b.length===0;if(b.length===0)return!0;if(w&&w.has(v))return w.get(v)===p;w&&w.set(v,p);try{for(let S=0;S<b.length;S++){const j=b[S];if(!n.isPrimitive(p)&&!(j in p)||v[j]===void 0&&p[j]!==void 0||v[j]===null&&p[j]!==null||!g(p[j],v[j],j,p,v,w))return!1}return!0}finally{w&&w.delete(v)}}function h(p,v,g,w){if(v.size===0)return!0;if(!(p instanceof Map))return!1;for(const[b,S]of v.entries()){const j=p.get(b);if(g(j,S,b,p,v,w)===!1)return!1}return!0}function d(p,v,g,w){if(v.length===0)return!0;if(!Array.isArray(p))return!1;const b=new Set;for(let S=0;S<v.length;S++){const j=v[S];let _=!1;for(let A=0;A<p.length;A++){if(b.has(A))continue;const k=p[A];let O=!1;if(g(k,j,S,p,v,w)&&(O=!0),O){b.add(A),_=!0;break}}if(!_)return!1}return!0}function m(p,v,g,w){return v.size===0?!0:p instanceof Set?d([...p],[...v],g,w):!1}e.isMatchWith=i,e.isSetMatch=m}(qg)),qg}var lT;function E2(){return lT||(lT=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=YW();function r(n,a){return t.isMatchWith(n,a,()=>{})}e.isMatch=r}(Hg)),Hg}var Wg={},Yg={},Xg={},oT;function o6(){return oT||(oT=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t}(Xg)),Xg}var Zg={},cT;function j2(){return cT||(cT=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t}(Zg)),Zg}var Qg={},uT;function N2(){return uT||(uT=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",a="[object Boolean]",i="[object Arguments]",l="[object Symbol]",u="[object Date]",h="[object Map]",d="[object Set]",m="[object Array]",p="[object Function]",v="[object ArrayBuffer]",g="[object Object]",w="[object Error]",b="[object DataView]",S="[object Uint8Array]",j="[object Uint8ClampedArray]",_="[object Uint16Array]",A="[object Uint32Array]",k="[object BigUint64Array]",O="[object Int8Array]",C="[object Int16Array]",T="[object Int32Array]",I="[object BigInt64Array]",M="[object Float32Array]",W="[object Float64Array]";e.argumentsTag=i,e.arrayBufferTag=v,e.arrayTag=m,e.bigInt64ArrayTag=I,e.bigUint64ArrayTag=k,e.booleanTag=a,e.dataViewTag=b,e.dateTag=u,e.errorTag=w,e.float32ArrayTag=M,e.float64ArrayTag=W,e.functionTag=p,e.int16ArrayTag=C,e.int32ArrayTag=T,e.int8ArrayTag=O,e.mapTag=h,e.numberTag=n,e.objectTag=g,e.regexpTag=t,e.setTag=d,e.stringTag=r,e.symbolTag=l,e.uint16ArrayTag=_,e.uint32ArrayTag=A,e.uint8ArrayTag=S,e.uint8ClampedArrayTag=j}(Qg)),Qg}var Jg={},fT;function XW(){return fT||(fT=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t}(Jg)),Jg}var dT;function c6(){return dT||(dT=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=o6(),r=j2(),n=N2(),a=l6(),i=XW();function l(m,p){return u(m,void 0,m,new Map,p)}function u(m,p,v,g=new Map,w=void 0){const b=w?.(m,p,v,g);if(b!=null)return b;if(a.isPrimitive(m))return m;if(g.has(m))return g.get(m);if(Array.isArray(m)){const S=new Array(m.length);g.set(m,S);for(let j=0;j<m.length;j++)S[j]=u(m[j],j,v,g,w);return Object.hasOwn(m,"index")&&(S.index=m.index),Object.hasOwn(m,"input")&&(S.input=m.input),S}if(m instanceof Date)return new Date(m.getTime());if(m instanceof RegExp){const S=new RegExp(m.source,m.flags);return S.lastIndex=m.lastIndex,S}if(m instanceof Map){const S=new Map;g.set(m,S);for(const[j,_]of m)S.set(j,u(_,j,v,g,w));return S}if(m instanceof Set){const S=new Set;g.set(m,S);for(const j of m)S.add(u(j,void 0,v,g,w));return S}if(typeof Buffer<"u"&&Buffer.isBuffer(m))return m.subarray();if(i.isTypedArray(m)){const S=new(Object.getPrototypeOf(m)).constructor(m.length);g.set(m,S);for(let j=0;j<m.length;j++)S[j]=u(m[j],j,v,g,w);return S}if(m instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&m instanceof SharedArrayBuffer)return m.slice(0);if(m instanceof DataView){const S=new DataView(m.buffer.slice(0),m.byteOffset,m.byteLength);return g.set(m,S),h(S,m,v,g,w),S}if(typeof File<"u"&&m instanceof File){const S=new File([m],m.name,{type:m.type});return g.set(m,S),h(S,m,v,g,w),S}if(m instanceof Blob){const S=new Blob([m],{type:m.type});return g.set(m,S),h(S,m,v,g,w),S}if(m instanceof Error){const S=new m.constructor;return g.set(m,S),S.message=m.message,S.name=m.name,S.stack=m.stack,S.cause=m.cause,h(S,m,v,g,w),S}if(typeof m=="object"&&d(m)){const S=Object.create(Object.getPrototypeOf(m));return g.set(m,S),h(S,m,v,g,w),S}return m}function h(m,p,v=m,g,w){const b=[...Object.keys(p),...t.getSymbols(p)];for(let S=0;S<b.length;S++){const j=b[S],_=Object.getOwnPropertyDescriptor(m,j);(_==null||_.writable)&&(m[j]=u(p[j],j,v,g,w))}}function d(m){switch(r.getTag(m)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=l,e.cloneDeepWithImpl=u,e.copyProperties=h}(Yg)),Yg}var hT;function ZW(){return hT||(hT=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=c6();function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r}(Wg)),Wg}var mT;function QW(){return mT||(mT=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=E2(),r=ZW();function n(a){return a=r.cloneDeep(a),i=>t.isMatch(i,a)}e.matches=n}(zg)),zg}var e1={},t1={},r1={},pT;function JW(){return pT||(pT=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=c6(),r=N2();function n(a,i){return t.cloneDeepWith(a,(l,u,h,d)=>{const m=i?.(l,u,h,d);if(m!=null)return m;if(typeof a=="object")switch(Object.prototype.toString.call(a)){case r.numberTag:case r.stringTag:case r.booleanTag:{const p=new a.constructor(a?.valueOf());return t.copyProperties(p,a),p}case r.argumentsTag:{const p={};return t.copyProperties(p,a),p.length=a.length,p[Symbol.iterator]=a[Symbol.iterator],p}default:return}})}e.cloneDeepWith=n}(r1)),r1}var xT;function eY(){return xT||(xT=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=JW();function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r}(t1)),t1}var n1={},a1={},vT;function u6(){return vT||(vT=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,a=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<a;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r}(a1)),a1}var i1={},gT;function tY(){return gT||(gT=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=j2();function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r}(i1)),i1}var yT;function rY(){return yT||(yT=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=M5(),r=u6(),n=tY(),a=f2();function i(l,u){let h;if(Array.isArray(u)?h=u:typeof u=="string"&&t.isDeepKey(u)&&l?.[u]==null?h=a.toPath(u):h=[u],h.length===0)return!1;let d=l;for(let m=0;m<h.length;m++){const p=h[m];if((d==null||!Object.hasOwn(d,p))&&!((Array.isArray(d)||n.isArguments(d))&&r.isIndex(p)&&p<d.length))return!1;d=d[p]}return!0}e.has=i}(n1)),n1}var bT;function nY(){return bT||(bT=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=E2(),r=F5(),n=eY(),a=d2(),i=rY();function l(u,h){switch(typeof u){case"object":{Object.is(u?.valueOf(),-0)&&(u="-0");break}case"number":{u=r.toKey(u);break}}return h=n.cloneDeep(h),function(d){const m=a.get(d,u);return m===void 0?i.has(d,u):h===void 0?m===void 0:t.isMatch(m,h)}}e.matchesProperty=l}(e1)),e1}var wT;function aY(){return wT||(wT=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=i6(),r=WW(),n=QW(),a=nY();function i(l){if(l==null)return t.identity;switch(typeof l){case"function":return l;case"object":return Array.isArray(l)&&l.length===2?a.matchesProperty(l[0],l[1]):n.matches(l);case"string":case"symbol":case"number":return r.property(l)}}e.iteratee=i}(Ug)),Ug}var ST;function iY(){return ST||(ST=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=qW(),r=i6(),n=GW(),a=aY();function i(l,u=r.identity){return n.isArrayLikeObject(l)?t.uniqBy(Array.from(l),a.iteratee(u)):[]}e.uniqBy=i}(Pg)),Pg}var s1,ET;function sY(){return ET||(ET=1,s1=iY().uniqBy),s1}var lY=sY();const jT=Ga(lY);function f6(e,t,r){return t===!0?jT(e,r):typeof t=="function"?jT(e,t):e}var l1={exports:{}},o1={},c1={exports:{}},u1={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var NT;function oY(){if(NT)return u1;NT=1;var e=Vc();function t(p,v){return p===v&&(p!==0||1/p===1/v)||p!==p&&v!==v}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,a=e.useEffect,i=e.useLayoutEffect,l=e.useDebugValue;function u(p,v){var g=v(),w=n({inst:{value:g,getSnapshot:v}}),b=w[0].inst,S=w[1];return i(function(){b.value=g,b.getSnapshot=v,h(b)&&S({inst:b})},[p,g,v]),a(function(){return h(b)&&S({inst:b}),p(function(){h(b)&&S({inst:b})})},[p]),l(g),g}function h(p){var v=p.getSnapshot;p=p.value;try{var g=v();return!r(p,g)}catch{return!0}}function d(p,v){return v()}var m=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:u;return u1.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:m,u1}var AT;function cY(){return AT||(AT=1,c1.exports=oY()),c1.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _T;function uY(){if(_T)return o1;_T=1;var e=Vc(),t=cY();function r(d,m){return d===m&&(d!==0||1/d===1/m)||d!==d&&m!==m}var n=typeof Object.is=="function"?Object.is:r,a=t.useSyncExternalStore,i=e.useRef,l=e.useEffect,u=e.useMemo,h=e.useDebugValue;return o1.useSyncExternalStoreWithSelector=function(d,m,p,v,g){var w=i(null);if(w.current===null){var b={hasValue:!1,value:null};w.current=b}else b=w.current;w=u(function(){function j(C){if(!_){if(_=!0,A=C,C=v(C),g!==void 0&&b.hasValue){var T=b.value;if(g(T,C))return k=T}return k=C}if(T=k,n(A,C))return T;var I=v(C);return g!==void 0&&g(T,I)?(A=C,T):(A=C,k=I)}var _=!1,A,k,O=p===void 0?null:p;return[function(){return j(m())},O===null?void 0:function(){return j(O())}]},[m,p,v,g]);var S=a(d,w[0],w[1]);return l(function(){b.hasValue=!0,b.value=S},[S]),h(S),S},o1}var TT;function fY(){return TT||(TT=1,l1.exports=uY()),l1.exports}var dY=fY(),A2=y.createContext(null),hY=e=>e,Jt=()=>{var e=y.useContext(A2);return e?e.store.dispatch:hY},Rh=()=>{},mY=()=>Rh,pY=(e,t)=>e===t;function et(e){var t=y.useContext(A2);return dY.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:mY,t?t.store.getState:Rh,t?t.store.getState:Rh,t?e:Rh,pY)}function xY(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function vY(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function gY(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var kT=e=>Array.isArray(e)?e:[e];function yY(e){const t=Array.isArray(e[0])?e[0]:e;return gY(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function bY(e,t){const r=[],{length:n}=e;for(let a=0;a<n;a++)r.push(e[a].apply(null,t));return r}var wY=class{constructor(e){this.value=e}deref(){return this.value}},SY=typeof WeakRef<"u"?WeakRef:wY,EY=0,CT=1;function fh(){return{s:EY,v:void 0,o:null,p:null}}function d6(e,t={}){let r=fh();const{resultEqualityCheck:n}=t;let a,i=0;function l(){let u=r;const{length:h}=arguments;for(let p=0,v=h;p<v;p++){const g=arguments[p];if(typeof g=="function"||typeof g=="object"&&g!==null){let w=u.o;w===null&&(u.o=w=new WeakMap);const b=w.get(g);b===void 0?(u=fh(),w.set(g,u)):u=b}else{let w=u.p;w===null&&(u.p=w=new Map);const b=w.get(g);b===void 0?(u=fh(),w.set(g,u)):u=b}}const d=u;let m;if(u.s===CT)m=u.v;else if(m=e.apply(null,arguments),i++,n){const p=a?.deref?.()??a;p!=null&&n(p,m)&&(m=p,i!==0&&i--),a=typeof m=="object"&&m!==null||typeof m=="function"?new SY(m):m}return d.s=CT,d.v=m,m}return l.clearCache=()=>{r=fh(),l.resetResultsCount()},l.resultsCount=()=>i,l.resetResultsCount=()=>{i=0},l}function jY(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...a)=>{let i=0,l=0,u,h={},d=a.pop();typeof d=="object"&&(h=d,d=a.pop()),xY(d,`createSelector expects an output function after the inputs, but received: [${typeof d}]`);const m={...r,...h},{memoize:p,memoizeOptions:v=[],argsMemoize:g=d6,argsMemoizeOptions:w=[]}=m,b=kT(v),S=kT(w),j=yY(a),_=p(function(){return i++,d.apply(null,arguments)},...b),A=g(function(){l++;const O=bY(j,arguments);return u=_.apply(null,O),u},...S);return Object.assign(A,{resultFunc:d,memoizedResultFunc:_,dependencies:j,dependencyRecomputations:()=>l,resetDependencyRecomputations:()=>{l=0},lastResult:()=>u,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:p,argsMemoize:g})};return Object.assign(n,{withTypes:()=>n}),n}var Te=jY(d6),NY=Object.assign((e,t=Te)=>{vY(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(i=>e[i]);return t(n,(...i)=>i.reduce((l,u,h)=>(l[r[h]]=u,l),{}))},{withTypes:()=>NY}),f1={},d1={},h1={},OT;function AY(){return OT||(OT=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,a,i)=>{if(n!==a){const l=t(n),u=t(a);if(l===u&&l===0){if(n<a)return i==="desc"?1:-1;if(n>a)return i==="desc"?-1:1}return i==="desc"?u-l:l-u}return 0};e.compareValues=r}(h1)),h1}var m1={},p1={},DT;function h6(){return DT||(DT=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t}(p1)),p1}var PT;function _Y(){return PT||(PT=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=h6(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(i,l){return Array.isArray(i)?!1:typeof i=="number"||typeof i=="boolean"||i==null||t.isSymbol(i)?!0:typeof i=="string"&&(n.test(i)||!r.test(i))||l!=null&&Object.hasOwn(l,i)}e.isKey=a}(m1)),m1}var RT;function TY(){return RT||(RT=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=AY(),r=_Y(),n=f2();function a(i,l,u,h){if(i==null)return[];u=h?void 0:u,Array.isArray(i)||(i=Object.values(i)),Array.isArray(l)||(l=l==null?[null]:[l]),l.length===0&&(l=[null]),Array.isArray(u)||(u=u==null?[]:[u]),u=u.map(g=>String(g));const d=(g,w)=>{let b=g;for(let S=0;S<w.length&&b!=null;++S)b=b[w[S]];return b},m=(g,w)=>w==null||g==null?w:typeof g=="object"&&"key"in g?Object.hasOwn(w,g.key)?w[g.key]:d(w,g.path):typeof g=="function"?g(w):Array.isArray(g)?d(w,g):typeof w=="object"?w[g]:w,p=l.map(g=>(Array.isArray(g)&&g.length===1&&(g=g[0]),g==null||typeof g=="function"||Array.isArray(g)||r.isKey(g)?g:{key:g,path:n.toPath(g)}));return i.map(g=>({original:g,criteria:p.map(w=>m(w,g))})).slice().sort((g,w)=>{for(let b=0;b<p.length;b++){const S=t.compareValues(g.criteria[b],w.criteria[b],u[b]);if(S!==0)return S}return 0}).map(g=>g.original)}e.orderBy=a}(d1)),d1}var x1={},MT;function kY(){return MT||(MT=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const a=[],i=Math.floor(n),l=(u,h)=>{for(let d=0;d<u.length;d++){const m=u[d];Array.isArray(m)&&h<i?l(m,h+1):a.push(m)}};return l(r,0),a}e.flatten=t}(x1)),x1}var v1={},FT;function m6(){return FT||(FT=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=u6(),r=w2(),n=s6(),a=S2();function i(l,u,h){return n.isObject(h)&&(typeof u=="number"&&r.isArrayLike(h)&&t.isIndex(u)&&u<h.length||typeof u=="string"&&u in h)?a.eq(h[u],l):!1}e.isIterateeCall=i}(v1)),v1}var IT;function CY(){return IT||(IT=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=TY(),r=kY(),n=m6();function a(i,...l){const u=l.length;return u>1&&n.isIterateeCall(i,l[0],l[1])?l=[]:u>2&&n.isIterateeCall(l[0],l[1],l[2])&&(l=[l[0]]),t.orderBy(i,r.flatten(l),["asc"])}e.sortBy=a}(f1)),f1}var g1,LT;function OY(){return LT||(LT=1,g1=CY().sortBy),g1}var DY=OY();const np=Ga(DY);var p6=e=>e.legend.settings,PY=e=>e.legend.size,RY=e=>e.legend.payload,MY=Te([RY,p6],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?np(n,r):n});function FY(){return et(MY)}var dh=1;function x6(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=y.useState({height:0,left:0,top:0,width:0}),n=y.useCallback(a=>{if(a!=null){var i=a.getBoundingClientRect(),l={height:i.height,left:i.left,top:i.top,width:i.width};(Math.abs(l.height-t.height)>dh||Math.abs(l.left-t.left)>dh||Math.abs(l.top-t.top)>dh||Math.abs(l.width-t.width)>dh)&&r({height:l.height,left:l.left,top:l.top,width:l.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function Zr(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var IY=typeof Symbol=="function"&&Symbol.observable||"@@observable",BT=IY,y1=()=>Math.random().toString(36).substring(7).split("").join("."),LY={INIT:`@@redux/INIT${y1()}`,REPLACE:`@@redux/REPLACE${y1()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${y1()}`},tm=LY;function _2(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function v6(e,t,r){if(typeof e!="function")throw new Error(Zr(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Zr(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Zr(1));return r(v6)(e,t)}let n=e,a=t,i=new Map,l=i,u=0,h=!1;function d(){l===i&&(l=new Map,i.forEach((S,j)=>{l.set(j,S)}))}function m(){if(h)throw new Error(Zr(3));return a}function p(S){if(typeof S!="function")throw new Error(Zr(4));if(h)throw new Error(Zr(5));let j=!0;d();const _=u++;return l.set(_,S),function(){if(j){if(h)throw new Error(Zr(6));j=!1,d(),l.delete(_),i=null}}}function v(S){if(!_2(S))throw new Error(Zr(7));if(typeof S.type>"u")throw new Error(Zr(8));if(typeof S.type!="string")throw new Error(Zr(17));if(h)throw new Error(Zr(9));try{h=!0,a=n(a,S)}finally{h=!1}return(i=l).forEach(_=>{_()}),S}function g(S){if(typeof S!="function")throw new Error(Zr(10));n=S,v({type:tm.REPLACE})}function w(){const S=p;return{subscribe(j){if(typeof j!="object"||j===null)throw new Error(Zr(11));function _(){const k=j;k.next&&k.next(m())}return _(),{unsubscribe:S(_)}},[BT](){return this}}}return v({type:tm.INIT}),{dispatch:v,subscribe:p,getState:m,replaceReducer:g,[BT]:w}}function BY(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:tm.INIT})>"u")throw new Error(Zr(12));if(typeof r(void 0,{type:tm.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Zr(13))})}function g6(e){const t=Object.keys(e),r={};for(let i=0;i<t.length;i++){const l=t[i];typeof e[l]=="function"&&(r[l]=e[l])}const n=Object.keys(r);let a;try{BY(r)}catch(i){a=i}return function(l={},u){if(a)throw a;let h=!1;const d={};for(let m=0;m<n.length;m++){const p=n[m],v=r[p],g=l[p],w=v(g,u);if(typeof w>"u")throw u&&u.type,new Error(Zr(14));d[p]=w,h=h||w!==g}return h=h||n.length!==Object.keys(l).length,h?d:l}}function rm(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function UY(...e){return t=>(r,n)=>{const a=t(r,n);let i=()=>{throw new Error(Zr(15))};const l={getState:a.getState,dispatch:(h,...d)=>i(h,...d)},u=e.map(h=>h(l));return i=rm(...u)(a.dispatch),{...a,dispatch:i}}}function y6(e){return _2(e)&&"type"in e&&typeof e.type=="string"}var b6=Symbol.for("immer-nothing"),UT=Symbol.for("immer-draftable"),pa=Symbol.for("immer-state");function si(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Rc=Object.getPrototypeOf;function go(e){return!!e&&!!e[pa]}function ds(e){return e?w6(e)||Array.isArray(e)||!!e[UT]||!!e.constructor?.[UT]||ip(e)||sp(e):!1}var $Y=Object.prototype.constructor.toString();function w6(e){if(!e||typeof e!="object")return!1;const t=Rc(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===$Y}function nm(e,t){ap(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function ap(e){const t=e[pa];return t?t.type_:Array.isArray(e)?1:ip(e)?2:sp(e)?3:0}function Iy(e,t){return ap(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function S6(e,t,r){const n=ap(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function zY(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function ip(e){return e instanceof Map}function sp(e){return e instanceof Set}function Yl(e){return e.copy_||e.base_}function Ly(e,t){if(ip(e))return new Map(e);if(sp(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=w6(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[pa];let a=Reflect.ownKeys(n);for(let i=0;i<a.length;i++){const l=a[i],u=n[l];u.writable===!1&&(u.writable=!0,u.configurable=!0),(u.get||u.set)&&(n[l]={configurable:!0,writable:!0,enumerable:u.enumerable,value:e[l]})}return Object.create(Rc(e),n)}else{const n=Rc(e);if(n!==null&&r)return{...e};const a=Object.create(n);return Object.assign(a,e)}}function T2(e,t=!1){return lp(e)||go(e)||!ds(e)||(ap(e)>1&&(e.set=e.add=e.clear=e.delete=HY),Object.freeze(e),t&&Object.entries(e).forEach(([r,n])=>T2(n,!0))),e}function HY(){si(2)}function lp(e){return Object.isFrozen(e)}var qY={};function yo(e){const t=qY[e];return t||si(0,e),t}var Zf;function E6(){return Zf}function VY(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function $T(e,t){t&&(yo("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function By(e){Uy(e),e.drafts_.forEach(KY),e.drafts_=null}function Uy(e){e===Zf&&(Zf=e.parent_)}function zT(e){return Zf=VY(Zf,e)}function KY(e){const t=e[pa];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function HT(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[pa].modified_&&(By(t),si(4)),ds(e)&&(e=am(t,e),t.parent_||im(t,e)),t.patches_&&yo("Patches").generateReplacementPatches_(r[pa].base_,e,t.patches_,t.inversePatches_)):e=am(t,r,[]),By(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==b6?e:void 0}function am(e,t,r){if(lp(t))return t;const n=t[pa];if(!n)return nm(t,(a,i)=>qT(e,n,t,a,i,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return im(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const a=n.copy_;let i=a,l=!1;n.type_===3&&(i=new Set(a),a.clear(),l=!0),nm(i,(u,h)=>qT(e,n,a,u,h,r,l)),im(e,a,!1),r&&e.patches_&&yo("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function qT(e,t,r,n,a,i,l){if(go(a)){const u=i&&t&&t.type_!==3&&!Iy(t.assigned_,n)?i.concat(n):void 0,h=am(e,a,u);if(S6(r,n,h),go(h))e.canAutoFreeze_=!1;else return}else l&&r.add(a);if(ds(a)&&!lp(a)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;am(e,a),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&im(e,a)}}function im(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&T2(t,r)}function GY(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:E6(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,i=k2;r&&(a=[n],i=Qf);const{revoke:l,proxy:u}=Proxy.revocable(a,i);return n.draft_=u,n.revoke_=l,u}var k2={get(e,t){if(t===pa)return e;const r=Yl(e);if(!Iy(r,t))return WY(e,r,t);const n=r[t];return e.finalized_||!ds(n)?n:n===b1(e.base_,t)?(w1(e),e.copy_[t]=zy(n,e)):n},has(e,t){return t in Yl(e)},ownKeys(e){return Reflect.ownKeys(Yl(e))},set(e,t,r){const n=j6(Yl(e),t);if(n?.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const a=b1(Yl(e),t),i=a?.[pa];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(zY(r,a)&&(r!==void 0||Iy(e.base_,t)))return!0;w1(e),$y(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return b1(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,w1(e),$y(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Yl(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){si(11)},getPrototypeOf(e){return Rc(e.base_)},setPrototypeOf(){si(12)}},Qf={};nm(k2,(e,t)=>{Qf[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Qf.deleteProperty=function(e,t){return Qf.set.call(this,e,t,void 0)};Qf.set=function(e,t,r){return k2.set.call(this,e[0],t,r,e[0])};function b1(e,t){const r=e[pa];return(r?Yl(r):e)[t]}function WY(e,t,r){const n=j6(t,r);return n?"value"in n?n.value:n.get?.call(e.draft_):void 0}function j6(e,t){if(!(t in e))return;let r=Rc(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Rc(r)}}function $y(e){e.modified_||(e.modified_=!0,e.parent_&&$y(e.parent_))}function w1(e){e.copy_||(e.copy_=Ly(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var YY=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const i=r;r=t;const l=this;return function(h=i,...d){return l.produce(h,m=>r.call(this,m,...d))}}typeof r!="function"&&si(6),n!==void 0&&typeof n!="function"&&si(7);let a;if(ds(t)){const i=zT(this),l=zy(t,void 0);let u=!0;try{a=r(l),u=!1}finally{u?By(i):Uy(i)}return $T(i,n),HT(a,i)}else if(!t||typeof t!="object"){if(a=r(t),a===void 0&&(a=t),a===b6&&(a=void 0),this.autoFreeze_&&T2(a,!0),n){const i=[],l=[];yo("Patches").generateReplacementPatches_(t,a,i,l),n(i,l)}return a}else si(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(l,...u)=>this.produceWithPatches(l,h=>t(h,...u));let n,a;return[this.produce(t,r,(l,u)=>{n=l,a=u}),n,a]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){ds(e)||si(8),go(e)&&(e=cs(e));const t=zT(this),r=zy(e,void 0);return r[pa].isManual_=!0,Uy(t),r}finishDraft(e,t){const r=e&&e[pa];(!r||!r.isManual_)&&si(9);const{scope_:n}=r;return $T(n,t),HT(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const a=t[r];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}r>-1&&(t=t.slice(r+1));const n=yo("Patches").applyPatches_;return go(e)?n(e,t):this.produce(e,a=>n(a,t))}};function zy(e,t){const r=ip(e)?yo("MapSet").proxyMap_(e,t):sp(e)?yo("MapSet").proxySet_(e,t):GY(e,t);return(t?t.scope_:E6()).drafts_.push(r),r}function cs(e){return go(e)||si(10,e),N6(e)}function N6(e){if(!ds(e)||lp(e))return e;const t=e[pa];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=Ly(e,t.scope_.immer_.useStrictShallowCopy_)}else r=Ly(e,!0);return nm(r,(n,a)=>{S6(r,n,N6(a))}),t&&(t.finalized_=!1),r}var xa=new YY,A6=xa.produce;xa.produceWithPatches.bind(xa);xa.setAutoFreeze.bind(xa);xa.setUseStrictShallowCopy.bind(xa);xa.applyPatches.bind(xa);xa.createDraft.bind(xa);xa.finishDraft.bind(xa);function _6(e){return({dispatch:r,getState:n})=>a=>i=>typeof i=="function"?i(r,n,e):a(i)}var XY=_6(),ZY=_6,QY=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?rm:rm.apply(null,arguments)};function qa(e,t){function r(...n){if(t){let a=t(...n);if(!a)throw new Error(fa(0));return{type:e,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>y6(n)&&n.type===e,r}var T6=class wf extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,wf.prototype)}static get[Symbol.species](){return wf}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new wf(...t[0].concat(this)):new wf(...t.concat(this))}};function VT(e){return ds(e)?A6(e,()=>{}):e}function hh(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function JY(e){return typeof e=="boolean"}var eX=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:i=!0}=t??{};let l=new T6;return r&&(JY(r)?l.push(XY):l.push(ZY(r.extraArgument))),l},tX="RTK_autoBatch",KT=e=>t=>{setTimeout(t,e)},rX=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let a=!0,i=!1,l=!1;const u=new Set,h=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:KT(10):e.type==="callback"?e.queueNotification:KT(e.timeout),d=()=>{l=!1,i&&(i=!1,u.forEach(m=>m()))};return Object.assign({},n,{subscribe(m){const p=()=>a&&m(),v=n.subscribe(p);return u.add(m),()=>{v(),u.delete(m)}},dispatch(m){try{return a=!m?.meta?.[tX],i=!a,i&&(l||(l=!0,h(d))),n.dispatch(m)}finally{a=!0}}})},nX=e=>function(r){const{autoBatch:n=!0}=r??{};let a=new T6(e);return n&&a.push(rX(typeof n=="object"?n:void 0)),a};function aX(e){const t=eX(),{reducer:r=void 0,middleware:n,devTools:a=!0,preloadedState:i=void 0,enhancers:l=void 0}=e||{};let u;if(typeof r=="function")u=r;else if(_2(r))u=g6(r);else throw new Error(fa(1));let h;typeof n=="function"?h=n(t):h=t();let d=rm;a&&(d=QY({trace:!1,...typeof a=="object"&&a}));const m=UY(...h),p=nX(m);let v=typeof l=="function"?l(p):p();const g=d(...v);return v6(u,i,g)}function k6(e){const t={},r=[];let n;const a={addCase(i,l){const u=typeof i=="string"?i:i.type;if(!u)throw new Error(fa(28));if(u in t)throw new Error(fa(29));return t[u]=l,a},addMatcher(i,l){return r.push({matcher:i,reducer:l}),a},addDefaultCase(i){return n=i,a}};return e(a),[t,r,n]}function iX(e){return typeof e=="function"}function sX(e,t){let[r,n,a]=k6(t),i;if(iX(e))i=()=>VT(e());else{const u=VT(e);i=()=>u}function l(u=i(),h){let d=[r[h.type],...n.filter(({matcher:m})=>m(h)).map(({reducer:m})=>m)];return d.filter(m=>!!m).length===0&&(d=[a]),d.reduce((m,p)=>{if(p)if(go(m)){const g=p(m,h);return g===void 0?m:g}else{if(ds(m))return A6(m,v=>p(v,h));{const v=p(m,h);if(v===void 0){if(m===null)return m;throw Error("A case reducer on a non-draftable value must not return undefined")}return v}}return m},u)}return l.getInitialState=i,l}var lX="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",oX=(e=21)=>{let t="",r=e;for(;r--;)t+=lX[Math.random()*64|0];return t},cX=Symbol.for("rtk-slice-createasyncthunk");function uX(e,t){return`${e}/${t}`}function fX({creators:e}={}){const t=e?.asyncThunk?.[cX];return function(n){const{name:a,reducerPath:i=a}=n;if(!a)throw new Error(fa(11));const l=(typeof n.reducers=="function"?n.reducers(hX()):n.reducers)||{},u=Object.keys(l),h={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(A,k){const O=typeof A=="string"?A:A.type;if(!O)throw new Error(fa(12));if(O in h.sliceCaseReducersByType)throw new Error(fa(13));return h.sliceCaseReducersByType[O]=k,d},addMatcher(A,k){return h.sliceMatchers.push({matcher:A,reducer:k}),d},exposeAction(A,k){return h.actionCreators[A]=k,d},exposeCaseReducer(A,k){return h.sliceCaseReducersByName[A]=k,d}};u.forEach(A=>{const k=l[A],O={reducerName:A,type:uX(a,A),createNotation:typeof n.reducers=="function"};pX(k)?vX(O,k,d,t):mX(O,k,d)});function m(){const[A={},k=[],O=void 0]=typeof n.extraReducers=="function"?k6(n.extraReducers):[n.extraReducers],C={...A,...h.sliceCaseReducersByType};return sX(n.initialState,T=>{for(let I in C)T.addCase(I,C[I]);for(let I of h.sliceMatchers)T.addMatcher(I.matcher,I.reducer);for(let I of k)T.addMatcher(I.matcher,I.reducer);O&&T.addDefaultCase(O)})}const p=A=>A,v=new Map,g=new WeakMap;let w;function b(A,k){return w||(w=m()),w(A,k)}function S(){return w||(w=m()),w.getInitialState()}function j(A,k=!1){function O(T){let I=T[A];return typeof I>"u"&&k&&(I=hh(g,O,S)),I}function C(T=p){const I=hh(v,k,()=>new WeakMap);return hh(I,T,()=>{const M={};for(const[W,U]of Object.entries(n.selectors??{}))M[W]=dX(U,T,()=>hh(g,T,S),k);return M})}return{reducerPath:A,getSelectors:C,get selectors(){return C(O)},selectSlice:O}}const _={name:a,reducer:b,actions:h.actionCreators,caseReducers:h.sliceCaseReducersByName,getInitialState:S,...j(i),injectInto(A,{reducerPath:k,...O}={}){const C=k??i;return A.inject({reducerPath:C,reducer:b},O),{..._,...j(C,!0)}}};return _}}function dX(e,t,r,n){function a(i,...l){let u=t(i);return typeof u>"u"&&n&&(u=r()),e(u,...l)}return a.unwrapped=e,a}var Xa=fX();function hX(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function mX({type:e,reducerName:t,createNotation:r},n,a){let i,l;if("reducer"in n){if(r&&!xX(n))throw new Error(fa(17));i=n.reducer,l=n.prepare}else i=n;a.addCase(e,i).exposeCaseReducer(t,i).exposeAction(t,l?qa(e,l):qa(e))}function pX(e){return e._reducerDefinitionType==="asyncThunk"}function xX(e){return e._reducerDefinitionType==="reducerWithPrepare"}function vX({type:e,reducerName:t},r,n,a){if(!a)throw new Error(fa(18));const{payloadCreator:i,fulfilled:l,pending:u,rejected:h,settled:d,options:m}=r,p=a(e,i,m);n.exposeAction(t,p),l&&n.addCase(p.fulfilled,l),u&&n.addCase(p.pending,u),h&&n.addCase(p.rejected,h),d&&n.addMatcher(p.settled,d),n.exposeCaseReducer(t,{fulfilled:l||mh,pending:u||mh,rejected:h||mh,settled:d||mh})}function mh(){}var gX="task",C6="listener",O6="completed",C2="cancelled",yX=`task-${C2}`,bX=`task-${O6}`,Hy=`${C6}-${C2}`,wX=`${C6}-${O6}`,op=class{constructor(e){this.code=e,this.message=`${gX} ${C2} (reason: ${e})`}name="TaskAbortError";message},O2=(e,t)=>{if(typeof e!="function")throw new TypeError(fa(32))},sm=()=>{},D6=(e,t=sm)=>(e.catch(t),e),P6=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),co=(e,t)=>{const r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},uo=e=>{if(e.aborted){const{reason:t}=e;throw new op(t)}};function R6(e,t){let r=sm;return new Promise((n,a)=>{const i=()=>a(new op(e.reason));if(e.aborted){i();return}r=P6(e,i),t.finally(()=>r()).then(n,a)}).finally(()=>{r=sm})}var SX=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof op?"cancelled":"rejected",error:r}}finally{t?.()}},lm=e=>t=>D6(R6(e,t).then(r=>(uo(e),r))),M6=e=>{const t=lm(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:kc}=Object,GT={},cp="listenerMiddleware",EX=(e,t)=>{const r=n=>P6(e,()=>co(n,e.reason));return(n,a)=>{O2(n);const i=new AbortController;r(i);const l=SX(async()=>{uo(e),uo(i.signal);const u=await n({pause:lm(i.signal),delay:M6(i.signal),signal:i.signal});return uo(i.signal),u},()=>co(i,bX));return a?.autoJoin&&t.push(l.catch(sm)),{result:lm(e)(l),cancel(){co(i,yX)}}}},jX=(e,t)=>{const r=async(n,a)=>{uo(t);let i=()=>{};const u=[new Promise((h,d)=>{let m=e({predicate:n,effect:(p,v)=>{v.unsubscribe(),h([p,v.getState(),v.getOriginalState()])}});i=()=>{m(),d()}})];a!=null&&u.push(new Promise(h=>setTimeout(h,a,null)));try{const h=await R6(t,Promise.race(u));return uo(t),h}finally{i()}};return(n,a)=>D6(r(n,a))},F6=e=>{let{type:t,actionCreator:r,matcher:n,predicate:a,effect:i}=e;if(t)a=qa(t).match;else if(r)t=r.type,a=r.match;else if(n)a=n;else if(!a)throw new Error(fa(21));return O2(i),{predicate:a,type:t,effect:i}},I6=kc(e=>{const{type:t,predicate:r,effect:n}=F6(e);return{id:oX(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(fa(22))}}},{withTypes:()=>I6}),WT=(e,t)=>{const{type:r,effect:n,predicate:a}=F6(t);return Array.from(e.values()).find(i=>(typeof r=="string"?i.type===r:i.predicate===a)&&i.effect===n)},qy=e=>{e.pending.forEach(t=>{co(t,Hy)})},NX=e=>()=>{e.forEach(qy),e.clear()},YT=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},L6=kc(qa(`${cp}/add`),{withTypes:()=>L6}),AX=qa(`${cp}/removeAll`),B6=kc(qa(`${cp}/remove`),{withTypes:()=>B6}),_X=(...e)=>{console.error(`${cp}/error`,...e)},wd=(e={})=>{const t=new Map,{extra:r,onError:n=_X}=e;O2(n);const a=m=>(m.unsubscribe=()=>t.delete(m.id),t.set(m.id,m),p=>{m.unsubscribe(),p?.cancelActive&&qy(m)}),i=m=>{const p=WT(t,m)??I6(m);return a(p)};kc(i,{withTypes:()=>i});const l=m=>{const p=WT(t,m);return p&&(p.unsubscribe(),m.cancelActive&&qy(p)),!!p};kc(l,{withTypes:()=>l});const u=async(m,p,v,g)=>{const w=new AbortController,b=jX(i,w.signal),S=[];try{m.pending.add(w),await Promise.resolve(m.effect(p,kc({},v,{getOriginalState:g,condition:(j,_)=>b(j,_).then(Boolean),take:b,delay:M6(w.signal),pause:lm(w.signal),extra:r,signal:w.signal,fork:EX(w.signal,S),unsubscribe:m.unsubscribe,subscribe:()=>{t.set(m.id,m)},cancelActiveListeners:()=>{m.pending.forEach((j,_,A)=>{j!==w&&(co(j,Hy),A.delete(j))})},cancel:()=>{co(w,Hy),m.pending.delete(w)},throwIfCancelled:()=>{uo(w.signal)}})))}catch(j){j instanceof op||YT(n,j,{raisedBy:"effect"})}finally{await Promise.all(S),co(w,wX),m.pending.delete(w)}},h=NX(t);return{middleware:m=>p=>v=>{if(!y6(v))return p(v);if(L6.match(v))return i(v.payload);if(AX.match(v)){h();return}if(B6.match(v))return l(v.payload);let g=m.getState();const w=()=>{if(g===GT)throw new Error(fa(23));return g};let b;try{if(b=p(v),t.size>0){const S=m.getState(),j=Array.from(t.values());for(const _ of j){let A=!1;try{A=_.predicate(v,S,g)}catch(k){A=!1,YT(n,k,{raisedBy:"predicate"})}A&&u(_,v,m,w)}}}finally{g=GT}return b},startListening:i,stopListening:l,clearListeners:h}};function fa(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var TX={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},U6=Xa({name:"chartLayout",initialState:TX,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){e.margin.top=t.payload.top,e.margin.right=t.payload.right,e.margin.bottom=t.payload.bottom,e.margin.left=t.payload.left},setScale(e,t){e.scale=t.payload}}}),{setMargin:kX,setLayout:CX,setChartSize:OX,setScale:DX}=U6.actions,PX=U6.reducer;function XT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ZT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?XT(Object(r),!0).forEach(function(n){RX(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):XT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function RX(e,t,r){return(t=MX(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MX(e){var t=FX(e,"string");return typeof t=="symbol"?t:t+""}function FX(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var om=Math.PI/180,IX=e=>e*180/Math.PI,_r=(e,t,r,n)=>({x:e+Math.cos(-om*n)*r,y:t+Math.sin(-om*n)*r}),$6=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},LX=(e,t)=>{var{x:r,y:n}=e,{x:a,y:i}=t;return Math.sqrt((r-a)**2+(n-i)**2)},BX=(e,t)=>{var{x:r,y:n}=e,{cx:a,cy:i}=t,l=LX({x:r,y:n},{x:a,y:i});if(l<=0)return{radius:l,angle:0};var u=(r-a)/l,h=Math.acos(u);return n>i&&(h=2*Math.PI-h),{radius:l,angle:IX(h),angleInRadian:h}},UX=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),a=Math.floor(r/360),i=Math.min(n,a);return{startAngle:t-i*360,endAngle:r-i*360}},$X=(e,t)=>{var{startAngle:r,endAngle:n}=t,a=Math.floor(r/360),i=Math.floor(n/360),l=Math.min(a,i);return e+l*360},zX=(e,t)=>{var{x:r,y:n}=e,{radius:a,angle:i}=BX({x:r,y:n},t),{innerRadius:l,outerRadius:u}=t;if(a<l||a>u||a===0)return null;var{startAngle:h,endAngle:d}=UX(t),m=i,p;if(h<=d){for(;m>d;)m-=360;for(;m<h;)m+=360;p=m>=h&&m<=d}else{for(;m>h;)m-=360;for(;m<d;)m+=360;p=m>=d&&m<=h}return p?ZT(ZT({},t),{},{radius:a,angle:$X(m,t)}):null};function QT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ba(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QT(Object(r),!0).forEach(function(n){HX(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function HX(e,t,r){return(t=qX(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qX(e){var t=VX(e,"string");return typeof t=="symbol"?t:t+""}function VX(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ft(e,t,r){return Ot(e)||Ot(t)?r:Ci(t)?gl(e,t,r):typeof t=="function"?t(e):r}var KX=(e,t,r,n,a)=>{var i,l=-1,u=(i=t?.length)!==null&&i!==void 0?i:0;if(u<=1||e==null)return 0;if(n==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var h=0;h<u;h++){var d=h>0?r[h-1].coordinate:r[u-1].coordinate,m=r[h].coordinate,p=h>=u-1?r[0].coordinate:r[h+1].coordinate,v=void 0;if(Ar(m-d)!==Ar(p-m)){var g=[];if(Ar(p-m)===Ar(a[1]-a[0])){v=p;var w=m+a[1]-a[0];g[0]=Math.min(w,(w+d)/2),g[1]=Math.max(w,(w+d)/2)}else{v=d;var b=p+a[1]-a[0];g[0]=Math.min(m,(b+m)/2),g[1]=Math.max(m,(b+m)/2)}var S=[Math.min(m,(v+m)/2),Math.max(m,(v+m)/2)];if(e>S[0]&&e<=S[1]||e>=g[0]&&e<=g[1]){({index:l}=r[h]);break}}else{var j=Math.min(d,p),_=Math.max(d,p);if(e>(j+m)/2&&e<=(_+m)/2){({index:l}=r[h]);break}}}else if(t){for(var A=0;A<u;A++)if(A===0&&e<=(t[A].coordinate+t[A+1].coordinate)/2||A>0&&A<u-1&&e>(t[A].coordinate+t[A-1].coordinate)/2&&e<=(t[A].coordinate+t[A+1].coordinate)/2||A===u-1&&e>(t[A].coordinate+t[A-1].coordinate)/2){({index:l}=t[A]);break}}return l},GX=(e,t,r)=>{if(t&&r){var{width:n,height:a}=r,{align:i,verticalAlign:l,layout:u}=t;if((u==="vertical"||u==="horizontal"&&l==="middle")&&i!=="center"&&rt(e[i]))return Ba(Ba({},e),{},{[i]:e[i]+(n||0)});if((u==="horizontal"||u==="vertical"&&i==="center")&&l!=="middle"&&rt(e[l]))return Ba(Ba({},e),{},{[l]:e[l]+(a||0)})}return e},gs=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",z6=(e,t,r,n)=>{if(n)return e.map(u=>u.coordinate);var a,i,l=e.map(u=>(u.coordinate===t&&(a=!0),u.coordinate===r&&(i=!0),u.coordinate));return a||l.push(t),i||l.push(r),l},H6=(e,t,r)=>{if(!e)return null;var{duplicateDomain:n,type:a,range:i,scale:l,realScaleType:u,isCategorical:h,categoricalDomain:d,tickCount:m,ticks:p,niceTicks:v,axisType:g}=e;if(!l)return null;var w=u==="scaleBand"&&l.bandwidth?l.bandwidth()/2:2,b=a==="category"&&l.bandwidth?l.bandwidth()/w:0;if(b=g==="angleAxis"&&i&&i.length>=2?Ar(i[0]-i[1])*2*b:b,p||v){var S=(p||v||[]).map((j,_)=>{var A=n?n.indexOf(j):j;return{coordinate:l(A)+b,value:j,offset:b,index:_}});return S.filter(j=>!ma(j.coordinate))}return h&&d?d.map((j,_)=>({coordinate:l(j)+b,value:j,index:_,offset:b})):l.ticks&&m!=null?l.ticks(m).map((j,_)=>({coordinate:l(j)+b,value:j,offset:b,index:_})):l.domain().map((j,_)=>({coordinate:l(j)+b,value:n?n[j]:j,index:_,offset:b}))},JT=1e-4,WX=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,n=e.range(),a=Math.min(n[0],n[1])-JT,i=Math.max(n[0],n[1])+JT,l=e(t[0]),u=e(t[r-1]);(l<a||l>i||u<a||u>i)&&e.domain([t[0],t[r-1]])}},q6=(e,t)=>{if(!t||t.length!==2||!rt(t[0])||!rt(t[1]))return e;var r=Math.min(t[0],t[1]),n=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!rt(e[0])||e[0]<r)&&(a[0]=r),(!rt(e[1])||e[1]>n)&&(a[1]=n),a[0]>n&&(a[0]=n),a[1]<r&&(a[1]=r),a},YX=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var a=0,i=0,l=0;l<t;++l){var u=ma(e[l][r][1])?e[l][r][0]:e[l][r][1];u>=0?(e[l][r][0]=a,e[l][r][1]=a+u,a=e[l][r][1]):(e[l][r][0]=i,e[l][r][1]=i+u,i=e[l][r][1])}},XX=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var a=0,i=0;i<t;++i){var l=ma(e[i][r][1])?e[i][r][0]:e[i][r][1];l>=0?(e[i][r][0]=a,e[i][r][1]=a+l,a=e[i][r][1]):(e[i][r][0]=0,e[i][r][1]=0)}},ZX={sign:YX,expand:TW,none:Pc,silhouette:kW,wiggle:CW,positive:XX},QX=(e,t,r)=>{var n=ZX[r],a=_W().keys(t).value((i,l)=>+Ft(i,l,0)).order(Ry).offset(n);return a(e)};function V6(e){return e==null?void 0:String(e)}function cm(e){var{axis:t,ticks:r,bandSize:n,entry:a,index:i,dataKey:l}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Ot(a[t.dataKey])){var u=L5(r,"value",a[t.dataKey]);if(u)return u.coordinate+n/2}return r[i]?r[i].coordinate+n/2:null}var h=Ft(a,Ot(l)?t.dataKey:l);return Ot(h)?null:t.scale(h)}var um=e=>{var{axis:t,ticks:r,offset:n,bandSize:a,entry:i,index:l}=e;if(t.type==="category")return r[l]?r[l].coordinate+n:null;var u=Ft(i,t.dataKey,t.scale.domain()[l]);return Ot(u)?null:t.scale(u)-a/2+n},K6=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);return n<=0&&a>=0?0:a<0?a:n}return r[0]},JX=e=>{var t=e.flat(2).filter(rt);return[Math.min(...t),Math.max(...t)]},eZ=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],tZ=(e,t,r)=>{if(e!=null)return eZ(Object.keys(e).reduce((n,a)=>{var i=e[a],{stackedData:l}=i,u=l.reduce((h,d)=>{var m=JX(d.slice(t,r+1));return[Math.min(h[0],m[0]),Math.max(h[1],m[1])]},[1/0,-1/0]);return[Math.min(u[0],n[0]),Math.max(u[1],n[1])]},[1/0,-1/0]))},e4=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,t4=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,hs=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var a=np(t,m=>m.coordinate),i=1/0,l=1,u=a.length;l<u;l++){var h=a[l],d=a[l-1];i=Math.min((h.coordinate||0)-(d.coordinate||0),i)}return i===1/0?0:i}return r?void 0:0};function r4(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:a,name:i}=e;return Ba(Ba({},t),{},{dataKey:r,payload:n,value:a,name:i})}function ys(e,t){if(e)return String(e);if(typeof t=="string")return t}function rZ(e,t,r,n,a){if(r==="horizontal"||r==="vertical"){var i=e>=a.left&&e<=a.left+a.width&&t>=a.top&&t<=a.top+a.height;return i?{x:e,y:t}:null}return n?zX({x:e,y:t},n):null}var nZ=(e,t,r,n)=>{var a=t.find(d=>d&&d.index===r);if(a){if(e==="horizontal")return{x:a.coordinate,y:n.y};if(e==="vertical")return{x:n.x,y:a.coordinate};if(e==="centric"){var i=a.coordinate,{radius:l}=n;return Ba(Ba(Ba({},n),_r(n.cx,n.cy,l,i)),{},{angle:i,radius:l})}var u=a.coordinate,{angle:h}=n;return Ba(Ba(Ba({},n),_r(n.cx,n.cy,u,h)),{},{angle:h,radius:u})}return{x:0,y:0}},aZ=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius,bs=e=>e.layout.width,ws=e=>e.layout.height,iZ=e=>e.layout.scale,G6=e=>e.layout.margin,D2=Te(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),P2=Te(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),R2="data-recharts-item-index",M2="data-recharts-item-data-key",up=60;function n4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function el(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?n4(Object(r),!0).forEach(function(n){sZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sZ(e,t,r){return(t=lZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lZ(e){var t=oZ(e,"string");return typeof t=="symbol"?t:t+""}function oZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cZ=e=>e.brush.height,Mr=Te([bs,ws,G6,cZ,D2,P2,p6,PY],(e,t,r,n,a,i,l,u)=>{var h=i.reduce((w,b)=>{var{orientation:S}=b;if(!b.mirror&&!b.hide){var j=typeof b.width=="number"?b.width:up;return el(el({},w),{},{[S]:w[S]+j})}return w},{left:r.left||0,right:r.right||0}),d=a.reduce((w,b)=>{var{orientation:S}=b;return!b.mirror&&!b.hide?el(el({},w),{},{[S]:gl(w,"".concat(S))+b.height}):w},{top:r.top||0,bottom:r.bottom||0}),m=el(el({},d),h),p=m.bottom;m.bottom+=n,m=GX(m,l,u);var v=e-m.left-m.right,g=t-m.top-m.bottom;return el(el({brushBottom:p},m),{},{width:Math.max(v,0),height:Math.max(g,0)})}),uZ=Te(Mr,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),W6=Te(bs,ws,(e,t)=>({x:0,y:0,width:e,height:t})),fZ=y.createContext(null),Sn=()=>y.useContext(fZ)!=null,fp=e=>e.brush,dp=Te([fp,Mr,G6],(e,t,r)=>({height:e.height,x:rt(e.x)?e.x:t.left,y:rt(e.y)?e.y:t.top+t.height+t.brushBottom-(r?.bottom||0),width:rt(e.width)?e.width:t.width})),F2=()=>{var e,t=Sn(),r=et(uZ),n=et(dp),a=(e=et(fp))===null||e===void 0?void 0:e.padding;return!t||!n||!a?r:{width:n.width-a.left-a.right,height:n.height-a.top-a.bottom,x:a.left,y:a.top}},dZ={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},Y6=()=>{var e;return(e=et(Mr))!==null&&e!==void 0?e:dZ},I2=()=>et(bs),L2=()=>et(ws),hZ={top:0,right:0,bottom:0,left:0},mZ=()=>{var e;return(e=et(t=>t.layout.margin))!==null&&e!==void 0?e:hZ},gt=e=>e.layout.layoutType,hp=()=>et(gt),pZ={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},X6=Xa({name:"legend",initialState:pZ,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload(e,t){e.payload.push(t.payload)},removeLegendPayload(e,t){var r=cs(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)}}}),{setLegendSize:a4,setLegendSettings:xZ,addLegendPayload:Z6,removeLegendPayload:Q6}=X6.actions,vZ=X6.reducer,gZ=["contextPayload"];function Vy(){return Vy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Vy.apply(null,arguments)}function i4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Mc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?i4(Object(r),!0).forEach(function(n){B2(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function B2(e,t,r){return(t=yZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yZ(e){var t=bZ(e,"string");return typeof t=="symbol"?t:t+""}function bZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wZ(e,t){if(e==null)return{};var r,n,a=SZ(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function SZ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function EZ(e){return e.value}function jZ(e){var{contextPayload:t}=e,r=wZ(e,gZ),n=f6(t,e.payloadUniqBy,EZ),a=Mc(Mc({},r),{},{payload:n});return y.isValidElement(e.content)?y.cloneElement(e.content,a):typeof e.content=="function"?y.createElement(e.content,a):y.createElement(b2,a)}function NZ(e,t,r,n,a,i){var{layout:l,align:u,verticalAlign:h}=t,d,m;return(!e||(e.left===void 0||e.left===null)&&(e.right===void 0||e.right===null))&&(u==="center"&&l==="vertical"?d={left:((n||0)-i.width)/2}:d=u==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!e||(e.top===void 0||e.top===null)&&(e.bottom===void 0||e.bottom===null))&&(h==="middle"?m={top:((a||0)-i.height)/2}:m=h==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),Mc(Mc({},d),m)}function AZ(e){var t=Jt();return y.useEffect(()=>{t(xZ(e))},[t,e]),null}function _Z(e){var t=Jt();return y.useEffect(()=>(t(a4(e)),()=>{t(a4({width:0,height:0}))}),[t,e]),null}function TZ(e){var t=FY(),r=ZG(),n=mZ(),{width:a,height:i,wrapperStyle:l,portal:u}=e,[h,d]=x6([t]),m=I2(),p=L2(),v=m-(n.left||0)-(n.right||0),g=Qc.getWidthOrHeight(e.layout,i,a,v),w=u?l:Mc(Mc({position:"absolute",width:g?.width||a||"auto",height:g?.height||i||"auto"},NZ(l,e,n,m,p,h)),l),b=u??r;if(b==null)return null;var S=y.createElement("div",{className:"recharts-legend-wrapper",style:w,ref:d},y.createElement(AZ,{layout:e.layout,align:e.align,verticalAlign:e.verticalAlign,itemSorter:e.itemSorter}),y.createElement(_Z,{width:h.width,height:h.height}),y.createElement(jZ,Vy({},e,g,{margin:n,chartWidth:m,chartHeight:p,contextPayload:t})));return Uf.createPortal(S,b)}class Qc extends y.PureComponent{static getWidthOrHeight(t,r,n,a){return t==="vertical"&&rt(r)?{height:r}:t==="horizontal"?{width:n||a}:null}render(){return y.createElement(TZ,this.props)}}B2(Qc,"displayName","Legend");B2(Qc,"defaultProps",{align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"});function Ky(){return Ky=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ky.apply(null,arguments)}function s4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function S1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?s4(Object(r),!0).forEach(function(n){kZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kZ(e,t,r){return(t=CZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CZ(e){var t=OZ(e,"string");return typeof t=="symbol"?t:t+""}function OZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function DZ(e){return Array.isArray(e)&&Ci(e[0])&&Ci(e[1])?e.join(" ~ "):e}var PZ=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:n={},labelStyle:a={},payload:i,formatter:l,itemSorter:u,wrapperClassName:h,labelClassName:d,label:m,labelFormatter:p,accessibilityLayer:v=!1}=e,g=()=>{if(i&&i.length){var O={padding:0,margin:0},C=(u?np(i,u):i).map((T,I)=>{if(T.type==="none")return null;var M=T.formatter||l||DZ,{value:W,name:U}=T,F=W,oe=U;if(M){var je=M(W,U,T,I,i);if(Array.isArray(je))[F,oe]=je;else if(je!=null)F=je;else return null}var ue=S1({display:"block",paddingTop:4,paddingBottom:4,color:T.color||"#000"},n);return y.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(I),style:ue},Ci(oe)?y.createElement("span",{className:"recharts-tooltip-item-name"},oe):null,Ci(oe)?y.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,y.createElement("span",{className:"recharts-tooltip-item-value"},F),y.createElement("span",{className:"recharts-tooltip-item-unit"},T.unit||""))});return y.createElement("ul",{className:"recharts-tooltip-item-list",style:O},C)}return null},w=S1({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),b=S1({margin:0},a),S=!Ot(m),j=S?m:"",_=Tt("recharts-default-tooltip",h),A=Tt("recharts-tooltip-label",d);S&&p&&i!==void 0&&i!==null&&(j=p(m,i));var k=v?{role:"status","aria-live":"assertive"}:{};return y.createElement("div",Ky({className:_,style:w},k),y.createElement("p",{className:A,style:b},y.isValidElement(j)?j:"".concat(j)),g())},lf="recharts-tooltip-wrapper",RZ={visibility:"hidden"};function MZ(e){var{coordinate:t,translateX:r,translateY:n}=e;return Tt(lf,{["".concat(lf,"-right")]:rt(r)&&t&&rt(t.x)&&r>=t.x,["".concat(lf,"-left")]:rt(r)&&t&&rt(t.x)&&r<t.x,["".concat(lf,"-bottom")]:rt(n)&&t&&rt(t.y)&&n>=t.y,["".concat(lf,"-top")]:rt(n)&&t&&rt(t.y)&&n<t.y})}function l4(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offsetTopLeft:a,position:i,reverseDirection:l,tooltipDimension:u,viewBox:h,viewBoxDimension:d}=e;if(i&&rt(i[n]))return i[n];var m=r[n]-u-(a>0?a:0),p=r[n]+a;if(t[n])return l[n]?m:p;var v=h[n];if(v==null)return 0;if(l[n]){var g=m,w=v;return g<w?Math.max(p,v):Math.max(m,v)}if(d==null)return 0;var b=p+u,S=v+d;return b>S?Math.max(m,v):Math.max(p,v)}function FZ(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function IZ(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:n,position:a,reverseDirection:i,tooltipBox:l,useTranslate3d:u,viewBox:h}=e,d,m,p;return l.height>0&&l.width>0&&r?(m=l4({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:l.width,viewBox:h,viewBoxDimension:h.width}),p=l4({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:l.height,viewBox:h,viewBoxDimension:h.height}),d=FZ({translateX:m,translateY:p,useTranslate3d:u})):d=RZ,{cssProperties:d,cssClasses:MZ({translateX:m,translateY:p,coordinate:r})}}function o4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ph(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?o4(Object(r),!0).forEach(function(n){Gy(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Gy(e,t,r){return(t=LZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LZ(e){var t=BZ(e,"string");return typeof t=="symbol"?t:t+""}function BZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class UZ extends y.PureComponent{constructor(){super(...arguments),Gy(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),Gy(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,a,i;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(a=(i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:a,children:i,coordinate:l,hasPayload:u,isAnimationActive:h,offset:d,position:m,reverseDirection:p,useTranslate3d:v,viewBox:g,wrapperStyle:w,lastBoundingBox:b,innerRef:S,hasPortalFromProps:j}=this.props,{cssClasses:_,cssProperties:A}=IZ({allowEscapeViewBox:r,coordinate:l,offsetTopLeft:d,position:m,reverseDirection:p,tooltipBox:{height:b.height,width:b.width},useTranslate3d:v,viewBox:g}),k=j?{}:ph(ph({transition:h&&t?"transform ".concat(n,"ms ").concat(a):void 0},A),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&u?"visible":"hidden",position:"absolute",top:0,left:0}),O=ph(ph({},k),{},{visibility:!this.state.dismissed&&t&&u?"visible":"hidden"},w);return y.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:_,style:O,ref:S},i)}}var $Z=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),Ss={isSsr:$Z()},J6=()=>et(e=>e.rootProps.accessibilityLayer);function va(e){return Number.isFinite(e)}function Fc(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function Wy(){return Wy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Wy.apply(null,arguments)}function c4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function u4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?c4(Object(r),!0).forEach(function(n){zZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zZ(e,t,r){return(t=HZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HZ(e){var t=qZ(e,"string");return typeof t=="symbol"?t:t+""}function qZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var f4={curveBasisClosed:xW,curveBasisOpen:vW,curveBasis:pW,curveBumpX:tW,curveBumpY:rW,curveLinearClosed:gW,curveLinear:ep,curveMonotoneX:yW,curveMonotoneY:bW,curveNatural:wW,curveStep:SW,curveStepAfter:jW,curveStepBefore:EW},xh=e=>va(e.x)&&va(e.y),of=e=>e.x,cf=e=>e.y,VZ=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(bd(e));return(r==="curveMonotone"||r==="curveBump")&&t?f4["".concat(r).concat(t==="vertical"?"Y":"X")]:f4[r]||ep},KZ=e=>{var{type:t="linear",points:r=[],baseLine:n,layout:a,connectNulls:i=!1}=e,l=VZ(t,a),u=i?r.filter(xh):r,h;if(Array.isArray(n)){var d=i?n.filter(p=>xh(p)):n,m=u.map((p,v)=>u4(u4({},p),{},{base:d[v]}));return a==="vertical"?h=uh().y(cf).x1(of).x0(p=>p.base.x):h=uh().x(of).y1(cf).y0(p=>p.base.y),h.defined(xh).curve(l),h(m)}return a==="vertical"&&rt(n)?h=uh().y(cf).x1(of).x0(n):rt(n)?h=uh().x(of).y1(cf).y0(n):h=G5().x(of).y(cf),h.defined(xh).curve(l),h(u)},mp=e=>{var{className:t,points:r,path:n,pathRef:a}=e;if((!r||!r.length)&&!n)return null;var i=r&&r.length?KZ(e):n;return y.createElement("path",Wy({},vt(e,!1),m2(e),{className:Tt("recharts-curve",t),d:i===null?void 0:i,ref:a}))},GZ=["x","y","top","left","width","height","className"];function Yy(){return Yy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Yy.apply(null,arguments)}function d4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function WZ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?d4(Object(r),!0).forEach(function(n){YZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function YZ(e,t,r){return(t=XZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XZ(e){var t=ZZ(e,"string");return typeof t=="symbol"?t:t+""}function ZZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function QZ(e,t){if(e==null)return{};var r,n,a=JZ(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function JZ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var eQ=(e,t,r,n,a,i)=>"M".concat(e,",").concat(a,"v").concat(n,"M").concat(i,",").concat(t,"h").concat(r),tQ=e=>{var{x:t=0,y:r=0,top:n=0,left:a=0,width:i=0,height:l=0,className:u}=e,h=QZ(e,GZ),d=WZ({x:t,y:r,top:n,left:a,width:i,height:l},h);return!rt(t)||!rt(r)||!rt(i)||!rt(l)||!rt(n)||!rt(a)?null:y.createElement("path",Yy({},vt(d,!0),{className:Tt("recharts-cross",u),d:eQ(t,r,i,l,n,a)}))};function rQ(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function h4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function nQ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?h4(Object(r),!0).forEach(function(n){aQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function aQ(e,t,r){return(t=iQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iQ(e){var t=sQ(e,"string");return typeof t=="symbol"?t:t+""}function sQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Kn(e,t){var r=nQ({},e),n=t,a=Object.keys(t),i=a.reduce((l,u)=>(l[u]===void 0&&n[u]!==void 0&&(l[u]=n[u]),l),r);return i}var E1={},j1={},N1={},m4;function lQ(){return m4||(m4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(!r||typeof r!="object")return!1;const n=Object.getPrototypeOf(r);return n===null||n===Object.prototype||Object.getPrototypeOf(n)===null?Object.prototype.toString.call(r)==="[object Object]":!1}e.isPlainObject=t}(N1)),N1}var p4;function oQ(){return p4||(p4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=lQ(),r=o6(),n=j2(),a=N2(),i=S2();function l(d,m,p){return u(d,m,void 0,void 0,void 0,void 0,p)}function u(d,m,p,v,g,w,b){const S=b(d,m,p,v,g,w);if(S!==void 0)return S;if(typeof d==typeof m)switch(typeof d){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return d===m;case"number":return d===m||Object.is(d,m);case"function":return d===m;case"object":return h(d,m,w,b)}return h(d,m,w,b)}function h(d,m,p,v){if(Object.is(d,m))return!0;let g=n.getTag(d),w=n.getTag(m);if(g===a.argumentsTag&&(g=a.objectTag),w===a.argumentsTag&&(w=a.objectTag),g!==w)return!1;switch(g){case a.stringTag:return d.toString()===m.toString();case a.numberTag:{const j=d.valueOf(),_=m.valueOf();return i.eq(j,_)}case a.booleanTag:case a.dateTag:case a.symbolTag:return Object.is(d.valueOf(),m.valueOf());case a.regexpTag:return d.source===m.source&&d.flags===m.flags;case a.functionTag:return d===m}p=p??new Map;const b=p.get(d),S=p.get(m);if(b!=null&&S!=null)return b===m;p.set(d,m),p.set(m,d);try{switch(g){case a.mapTag:{if(d.size!==m.size)return!1;for(const[j,_]of d.entries())if(!m.has(j)||!u(_,m.get(j),j,d,m,p,v))return!1;return!0}case a.setTag:{if(d.size!==m.size)return!1;const j=Array.from(d.values()),_=Array.from(m.values());for(let A=0;A<j.length;A++){const k=j[A],O=_.findIndex(C=>u(k,C,void 0,d,m,p,v));if(O===-1)return!1;_.splice(O,1)}return!0}case a.arrayTag:case a.uint8ArrayTag:case a.uint8ClampedArrayTag:case a.uint16ArrayTag:case a.uint32ArrayTag:case a.bigUint64ArrayTag:case a.int8ArrayTag:case a.int16ArrayTag:case a.int32ArrayTag:case a.bigInt64ArrayTag:case a.float32ArrayTag:case a.float64ArrayTag:{if(typeof Buffer<"u"&&Buffer.isBuffer(d)!==Buffer.isBuffer(m)||d.length!==m.length)return!1;for(let j=0;j<d.length;j++)if(!u(d[j],m[j],j,d,m,p,v))return!1;return!0}case a.arrayBufferTag:return d.byteLength!==m.byteLength?!1:h(new Uint8Array(d),new Uint8Array(m),p,v);case a.dataViewTag:return d.byteLength!==m.byteLength||d.byteOffset!==m.byteOffset?!1:h(new Uint8Array(d),new Uint8Array(m),p,v);case a.errorTag:return d.name===m.name&&d.message===m.message;case a.objectTag:{if(!(h(d.constructor,m.constructor,p,v)||t.isPlainObject(d)&&t.isPlainObject(m)))return!1;const _=[...Object.keys(d),...r.getSymbols(d)],A=[...Object.keys(m),...r.getSymbols(m)];if(_.length!==A.length)return!1;for(let k=0;k<_.length;k++){const O=_[k],C=d[O];if(!Object.hasOwn(m,O))return!1;const T=m[O];if(!u(C,T,O,d,m,p,v))return!1}return!0}default:return!1}}finally{p.delete(d),p.delete(m)}}e.isEqualWith=l}(j1)),j1}var A1={},x4;function cQ(){return x4||(x4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(){}e.noop=t}(A1)),A1}var v4;function uQ(){return v4||(v4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=oQ(),r=cQ();function n(a,i){return t.isEqualWith(a,i,r.noop)}e.isEqual=n}(E1)),E1}var _1,g4;function fQ(){return g4||(g4=1,_1=uQ().isEqual),_1}var dQ=fQ();const hQ=Ga(dQ);function mQ(e){var t={},r=()=>null,n=!1,a=null,i=l=>{if(!n){if(Array.isArray(l)){if(!l.length)return;var u=l,[h,...d]=u;if(typeof h=="number"){a=e.setTimeout(i.bind(null,d),h);return}i(h),a=e.setTimeout(i.bind(null,d));return}typeof l=="object"&&(t=l,r(t)),typeof l=="function"&&l()}};return{stop:()=>{n=!0},start:l=>{n=!1,a&&(a(),a=null),i(l)},subscribe:l=>(r=l,()=>{r=()=>null}),getTimeoutController:()=>e}}var fm=1e-4,eD=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],tD=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),y4=(e,t)=>r=>{var n=eD(e,t);return tD(n,r)},pQ=(e,t)=>r=>{var n=eD(e,t),a=[...n.map((i,l)=>i*l).slice(1),0];return tD(a,r)},b4=function(){for(var t,r,n,a,i=arguments.length,l=new Array(i),u=0;u<i;u++)l[u]=arguments[u];if(l.length===1)switch(l[0]){case"linear":[t,n,r,a]=[0,0,1,1];break;case"ease":[t,n,r,a]=[.25,.1,.25,1];break;case"ease-in":[t,n,r,a]=[.42,0,1,1];break;case"ease-out":[t,n,r,a]=[.42,0,.58,1];break;case"ease-in-out":[t,n,r,a]=[0,0,.58,1];break;default:{var h=l[0].split("(");h[0]==="cubic-bezier"&&h[1].split(")")[0].split(",").length===4&&([t,n,r,a]=h[1].split(")")[0].split(",").map(w=>parseFloat(w)))}}else l.length===4&&([t,n,r,a]=l);var d=y4(t,r),m=y4(n,a),p=pQ(t,r),v=w=>w>1?1:w<0?0:w,g=w=>{for(var b=w>1?1:w,S=b,j=0;j<8;++j){var _=d(S)-b,A=p(S);if(Math.abs(_-b)<fm||A<fm)return m(S);S=v(S-_/A)}return m(S)};return g.isStepper=!1,g},xQ=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:a=17}=t,i=(l,u,h)=>{var d=-(l-u)*r,m=h*n,p=h+(d-m)*a/1e3,v=h*a/1e3+l;return Math.abs(v-u)<fm&&Math.abs(p)<fm?[u,0]:[v,p]};return i.isStepper=!0,i.dt=a,i},vQ=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return b4(e);case"spring":return xQ();default:if(e.split("(")[0]==="cubic-bezier")return b4(e)}return typeof e=="function"?e:null};function w4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function S4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?w4(Object(r),!0).forEach(function(n){gQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gQ(e,t,r){return(t=yQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yQ(e){var t=bQ(e,"string");return typeof t=="symbol"?t:t+""}function bQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wQ=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),SQ=(e,t,r)=>e.map(n=>"".concat(wQ(n)," ").concat(t,"ms ").concat(r)).join(","),EQ=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(a=>n.includes(a))),Jf=(e,t)=>Object.keys(t).reduce((r,n)=>S4(S4({},r),{},{[n]:e(n,t[n])}),{});function E4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Qr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?E4(Object(r),!0).forEach(function(n){jQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jQ(e,t,r){return(t=NQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NQ(e){var t=AQ(e,"string");return typeof t=="symbol"?t:t+""}function AQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dm=(e,t,r)=>e+(t-e)*r,Xy=e=>{var{from:t,to:r}=e;return t!==r},rD=(e,t,r)=>{var n=Jf((a,i)=>{if(Xy(i)){var[l,u]=e(i.from,i.to,i.velocity);return Qr(Qr({},i),{},{from:l,velocity:u})}return i},t);return r<1?Jf((a,i)=>Xy(i)?Qr(Qr({},i),{},{velocity:dm(i.velocity,n[a].velocity,r),from:dm(i.from,n[a].from,r)}):i,t):rD(e,n,r-1)};function _Q(e,t,r,n,a,i){var l,u=n.reduce((v,g)=>Qr(Qr({},v),{},{[g]:{from:e[g],velocity:0,to:t[g]}}),{}),h=()=>Jf((v,g)=>g.from,u),d=()=>!Object.values(u).filter(Xy).length,m=null,p=v=>{l||(l=v);var g=v-l,w=g/r.dt;u=rD(r,u,w),a(Qr(Qr(Qr({},e),t),h())),l=v,d()||(m=i.setTimeout(p))};return()=>(m=i.setTimeout(p),()=>{m()})}function TQ(e,t,r,n,a,i,l){var u=null,h=a.reduce((p,v)=>Qr(Qr({},p),{},{[v]:[e[v],t[v]]}),{}),d,m=p=>{d||(d=p);var v=(p-d)/n,g=Jf((b,S)=>dm(...S,r(v)),h);if(i(Qr(Qr(Qr({},e),t),g)),v<1)u=l.setTimeout(m);else{var w=Jf((b,S)=>dm(...S,r(1)),h);i(Qr(Qr(Qr({},e),t),w))}};return()=>(u=l.setTimeout(m),()=>{u()})}const kQ=(e,t,r,n,a,i)=>{var l=EQ(e,t);return r.isStepper===!0?_Q(e,t,r,l,a,i):TQ(e,t,r,n,l,a,i)};class CQ{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),a=null,i=l=>{l-n>=r?t(l):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(i))};return a=requestAnimationFrame(i),()=>{cancelAnimationFrame(a)}}}var OQ=["children","begin","duration","attributeName","easing","isActive","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart","animationManager"];function Zy(){return Zy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Zy.apply(null,arguments)}function DQ(e,t){if(e==null)return{};var r,n,a=PQ(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function PQ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function j4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function tl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?j4(Object(r),!0).forEach(function(n){ro(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ro(e,t,r){return(t=RQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RQ(e){var t=MQ(e,"string");return typeof t=="symbol"?t:t+""}function MQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function FQ(){return mQ(new CQ)}class U2 extends y.PureComponent{constructor(t,r){super(t,r),ro(this,"mounted",!1),ro(this,"manager",null),ro(this,"stopJSAnimation",null),ro(this,"unSubscribe",null);var{isActive:n,attributeName:a,from:i,to:l,children:u,duration:h,animationManager:d}=this.props;if(this.manager=d,this.handleStyleChange=this.handleStyleChange.bind(this),this.changeStyle=this.changeStyle.bind(this),!n||h<=0){this.state={style:{}},typeof u=="function"&&(this.state={style:l});return}if(i){if(typeof u=="function"){this.state={style:i};return}this.state={style:a?{[a]:i}:i}}else this.state={style:{}}}componentDidMount(){var{isActive:t,canBegin:r}=this.props;this.mounted=!0,!(!t||!r)&&this.runAnimation(this.props)}componentDidUpdate(t){var{isActive:r,canBegin:n,attributeName:a,shouldReAnimate:i,to:l,from:u}=this.props,{style:h}=this.state;if(n){if(!r){var d={style:a?{[a]:l}:l};this.state&&h&&(a&&h[a]!==l||!a&&h!==l)&&this.setState(d);return}if(!(hQ(t.to,l)&&t.canBegin&&t.isActive)){var m=!t.canBegin||!t.isActive;this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var p=m||i?u:t.to;if(this.state&&h){var v={style:a?{[a]:p}:p};(a&&h[a]!==p||!a&&h!==p)&&this.setState(v)}this.runAnimation(tl(tl({},this.props),{},{from:p,begin:0}))}}}componentWillUnmount(){this.mounted=!1;var{onAnimationEnd:t}=this.props;this.unSubscribe&&this.unSubscribe(),this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation(),t&&t()}handleStyleChange(t){this.changeStyle(t)}changeStyle(t){this.mounted&&this.setState({style:t})}runJSAnimation(t){var{from:r,to:n,duration:a,easing:i,begin:l,onAnimationEnd:u,onAnimationStart:h}=t,d=kQ(r,n,vQ(i),a,this.changeStyle,this.manager.getTimeoutController()),m=()=>{this.stopJSAnimation=d()};this.manager.start([h,l,m,a,u])}runAnimation(t){var{begin:r,duration:n,attributeName:a,to:i,easing:l,onAnimationStart:u,onAnimationEnd:h,children:d}=t;if(this.unSubscribe=this.manager.subscribe(this.handleStyleChange),typeof l=="function"||typeof d=="function"||l==="spring"){this.runJSAnimation(t);return}var m=a?{[a]:i}:i,p=SQ(Object.keys(m),n,l);this.manager.start([u,r,tl(tl({},m),{},{transition:p}),n,h])}render(){var t=this.props,{children:r,begin:n,duration:a,attributeName:i,easing:l,isActive:u,from:h,to:d,canBegin:m,onAnimationEnd:p,shouldReAnimate:v,onAnimationReStart:g,animationManager:w}=t,b=DQ(t,OQ),S=y.Children.count(r),j=this.state.style;if(typeof r=="function")return r(j);if(!u||S===0||a<=0)return r;var _=A=>{var{style:k={},className:O}=A.props,C=y.cloneElement(A,tl(tl({},b),{},{style:tl(tl({},k),j),className:O}));return C};return S===1?_(y.Children.only(r)):y.createElement("div",null,y.Children.map(r,A=>_(A)))}}ro(U2,"displayName","Animate");ro(U2,"defaultProps",{begin:0,duration:1e3,attributeName:"",easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}});var IQ=y.createContext(null);function Oi(e){var t,r,n=y.useContext(IQ);return y.createElement(U2,Zy({},e,{animationManager:(t=(r=e.animationManager)!==null&&r!==void 0?r:n)!==null&&t!==void 0?t:FQ()}))}function hm(){return hm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},hm.apply(null,arguments)}var N4=(e,t,r,n,a)=>{var i=Math.min(Math.abs(r)/2,Math.abs(n)/2),l=n>=0?1:-1,u=r>=0?1:-1,h=n>=0&&r>=0||n<0&&r<0?1:0,d;if(i>0&&a instanceof Array){for(var m=[0,0,0,0],p=0,v=4;p<v;p++)m[p]=a[p]>i?i:a[p];d="M".concat(e,",").concat(t+l*m[0]),m[0]>0&&(d+="A ".concat(m[0],",").concat(m[0],",0,0,").concat(h,",").concat(e+u*m[0],",").concat(t)),d+="L ".concat(e+r-u*m[1],",").concat(t),m[1]>0&&(d+="A ".concat(m[1],",").concat(m[1],",0,0,").concat(h,`,
        `).concat(e+r,",").concat(t+l*m[1])),d+="L ".concat(e+r,",").concat(t+n-l*m[2]),m[2]>0&&(d+="A ".concat(m[2],",").concat(m[2],",0,0,").concat(h,`,
        `).concat(e+r-u*m[2],",").concat(t+n)),d+="L ".concat(e+u*m[3],",").concat(t+n),m[3]>0&&(d+="A ".concat(m[3],",").concat(m[3],",0,0,").concat(h,`,
        `).concat(e,",").concat(t+n-l*m[3])),d+="Z"}else if(i>0&&a===+a&&a>0){var g=Math.min(i,a);d="M ".concat(e,",").concat(t+l*g,`
            A `).concat(g,",").concat(g,",0,0,").concat(h,",").concat(e+u*g,",").concat(t,`
            L `).concat(e+r-u*g,",").concat(t,`
            A `).concat(g,",").concat(g,",0,0,").concat(h,",").concat(e+r,",").concat(t+l*g,`
            L `).concat(e+r,",").concat(t+n-l*g,`
            A `).concat(g,",").concat(g,",0,0,").concat(h,",").concat(e+r-u*g,",").concat(t+n,`
            L `).concat(e+u*g,",").concat(t+n,`
            A `).concat(g,",").concat(g,",0,0,").concat(h,",").concat(e,",").concat(t+n-l*g," Z")}else d="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(n," h ").concat(-r," Z");return d},LQ={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},nD=e=>{var t=Kn(e,LQ),r=y.useRef(null),[n,a]=y.useState(-1);y.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var j=r.current.getTotalLength();j&&a(j)}catch{}},[]);var{x:i,y:l,width:u,height:h,radius:d,className:m}=t,{animationEasing:p,animationDuration:v,animationBegin:g,isAnimationActive:w,isUpdateAnimationActive:b}=t;if(i!==+i||l!==+l||u!==+u||h!==+h||u===0||h===0)return null;var S=Tt("recharts-rectangle",m);return b?y.createElement(Oi,{canBegin:n>0,from:{width:u,height:h,x:i,y:l},to:{width:u,height:h,x:i,y:l},duration:v,animationEasing:p,isActive:b},j=>{var{width:_,height:A,x:k,y:O}=j;return y.createElement(Oi,{canBegin:n>0,from:"0px ".concat(n===-1?1:n,"px"),to:"".concat(n,"px 0px"),attributeName:"strokeDasharray",begin:g,duration:v,isActive:w,easing:p},y.createElement("path",hm({},vt(t,!0),{className:S,d:N4(k,O,_,A,d),ref:r})))}):y.createElement("path",hm({},vt(t,!0),{className:S,d:N4(i,l,u,h,d)}))};function aD(e){var{cx:t,cy:r,radius:n,startAngle:a,endAngle:i}=e,l=_r(t,r,n,a),u=_r(t,r,n,i);return{points:[l,u],cx:t,cy:r,radius:n,startAngle:a,endAngle:i}}function Qy(){return Qy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Qy.apply(null,arguments)}var BQ=(e,t)=>{var r=Ar(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},vh=e=>{var{cx:t,cy:r,radius:n,angle:a,sign:i,isExternal:l,cornerRadius:u,cornerIsExternal:h}=e,d=u*(l?1:-1)+n,m=Math.asin(u/d)/om,p=h?a:a+i*m,v=_r(t,r,d,p),g=_r(t,r,n,p),w=h?a-i*m:a,b=_r(t,r,d*Math.cos(m*om),w);return{center:v,circleTangency:g,lineTangency:b,theta:m}},iD=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:i,endAngle:l}=e,u=BQ(i,l),h=i+u,d=_r(t,r,a,i),m=_r(t,r,a,h),p="M ".concat(d.x,",").concat(d.y,`
    A `).concat(a,",").concat(a,`,0,
    `).concat(+(Math.abs(u)>180),",").concat(+(i>h),`,
    `).concat(m.x,",").concat(m.y,`
  `);if(n>0){var v=_r(t,r,n,i),g=_r(t,r,n,h);p+="L ".concat(g.x,",").concat(g.y,`
            A `).concat(n,",").concat(n,`,0,
            `).concat(+(Math.abs(u)>180),",").concat(+(i<=h),`,
            `).concat(v.x,",").concat(v.y," Z")}else p+="L ".concat(t,",").concat(r," Z");return p},UQ=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,cornerRadius:i,forceCornerRadius:l,cornerIsExternal:u,startAngle:h,endAngle:d}=e,m=Ar(d-h),{circleTangency:p,lineTangency:v,theta:g}=vh({cx:t,cy:r,radius:a,angle:h,sign:m,cornerRadius:i,cornerIsExternal:u}),{circleTangency:w,lineTangency:b,theta:S}=vh({cx:t,cy:r,radius:a,angle:d,sign:-m,cornerRadius:i,cornerIsExternal:u}),j=u?Math.abs(h-d):Math.abs(h-d)-g-S;if(j<0)return l?"M ".concat(v.x,",").concat(v.y,`
        a`).concat(i,",").concat(i,",0,0,1,").concat(i*2,`,0
        a`).concat(i,",").concat(i,",0,0,1,").concat(-i*2,`,0
      `):iD({cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:h,endAngle:d});var _="M ".concat(v.x,",").concat(v.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(m<0),",").concat(p.x,",").concat(p.y,`
    A`).concat(a,",").concat(a,",0,").concat(+(j>180),",").concat(+(m<0),",").concat(w.x,",").concat(w.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(m<0),",").concat(b.x,",").concat(b.y,`
  `);if(n>0){var{circleTangency:A,lineTangency:k,theta:O}=vh({cx:t,cy:r,radius:n,angle:h,sign:m,isExternal:!0,cornerRadius:i,cornerIsExternal:u}),{circleTangency:C,lineTangency:T,theta:I}=vh({cx:t,cy:r,radius:n,angle:d,sign:-m,isExternal:!0,cornerRadius:i,cornerIsExternal:u}),M=u?Math.abs(h-d):Math.abs(h-d)-O-I;if(M<0&&i===0)return"".concat(_,"L").concat(t,",").concat(r,"Z");_+="L".concat(T.x,",").concat(T.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(m<0),",").concat(C.x,",").concat(C.y,`
      A`).concat(n,",").concat(n,",0,").concat(+(M>180),",").concat(+(m>0),",").concat(A.x,",").concat(A.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(m<0),",").concat(k.x,",").concat(k.y,"Z")}else _+="L".concat(t,",").concat(r,"Z");return _},$Q={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},Sd=e=>{var t=Kn(e,$Q),{cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:l,forceCornerRadius:u,cornerIsExternal:h,startAngle:d,endAngle:m,className:p}=t;if(i<a||d===m)return null;var v=Tt("recharts-sector",p),g=i-a,w=Dn(l,g,0,!0),b;return w>0&&Math.abs(d-m)<360?b=UQ({cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:Math.min(w,g/2),forceCornerRadius:u,cornerIsExternal:h,startAngle:d,endAngle:m}):b=iD({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:d,endAngle:m}),y.createElement("path",Qy({},vt(t,!0),{className:v,d:b}))};function zQ(e,t,r){var n,a,i,l;if(e==="horizontal")n=t.x,i=n,a=r.top,l=r.top+r.height;else if(e==="vertical")a=t.y,l=a,n=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:u,cy:h,innerRadius:d,outerRadius:m,angle:p}=t,v=_r(u,h,d,p),g=_r(u,h,m,p);n=v.x,a=v.y,i=g.x,l=g.y}else return aD(t);return[{x:n,y:a},{x:i,y:l}]}var T1={},k1={},C1={},A4;function HQ(){return A4||(A4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=h6();function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r}(C1)),C1}var _4;function qQ(){return _4||(_4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=HQ();function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r}(k1)),k1}var T4;function VQ(){return T4||(T4=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=m6(),r=qQ();function n(a,i,l){l&&typeof l!="number"&&t.isIterateeCall(a,i,l)&&(i=l=void 0),a=r.toFinite(a),i===void 0?(i=a,a=0):i=r.toFinite(i),l=l===void 0?a<i?1:-1:r.toFinite(l);const u=Math.max(Math.ceil((i-a)/(l||1)),0),h=new Array(u);for(let d=0;d<u;d++)h[d]=a,a+=l;return h}e.range=n}(T1)),T1}var O1,k4;function KQ(){return k4||(k4=1,O1=VQ().range),O1}var GQ=KQ();const sD=Ga(GQ);function hl(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function WQ(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function $2(e){let t,r,n;e.length!==2?(t=hl,r=(u,h)=>hl(e(u),h),n=(u,h)=>e(u)-h):(t=e===hl||e===WQ?e:YQ,r=e,n=e);function a(u,h,d=0,m=u.length){if(d<m){if(t(h,h)!==0)return m;do{const p=d+m>>>1;r(u[p],h)<0?d=p+1:m=p}while(d<m)}return d}function i(u,h,d=0,m=u.length){if(d<m){if(t(h,h)!==0)return m;do{const p=d+m>>>1;r(u[p],h)<=0?d=p+1:m=p}while(d<m)}return d}function l(u,h,d=0,m=u.length){const p=a(u,h,d,m-1);return p>d&&n(u[p-1],h)>-n(u[p],h)?p-1:p}return{left:a,center:l,right:i}}function YQ(){return 0}function lD(e){return e===null?NaN:+e}function*XQ(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const ZQ=$2(hl),Ed=ZQ.right;$2(lD).center;class C4 extends Map{constructor(t,r=eJ){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(O4(this,t))}has(t){return super.has(O4(this,t))}set(t,r){return super.set(QQ(this,t),r)}delete(t){return super.delete(JQ(this,t))}}function O4({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function QQ({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function JQ({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function eJ(e){return e!==null&&typeof e=="object"?e.valueOf():e}function tJ(e=hl){if(e===hl)return oD;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function oD(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const rJ=Math.sqrt(50),nJ=Math.sqrt(10),aJ=Math.sqrt(2);function mm(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),l=i>=rJ?10:i>=nJ?5:i>=aJ?2:1;let u,h,d;return a<0?(d=Math.pow(10,-a)/l,u=Math.round(e*d),h=Math.round(t*d),u/d<e&&++u,h/d>t&&--h,d=-d):(d=Math.pow(10,a)*l,u=Math.round(e/d),h=Math.round(t/d),u*d<e&&++u,h*d>t&&--h),h<u&&.5<=r&&r<2?mm(e,t,r*2):[u,h,d]}function Jy(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,i,l]=n?mm(t,e,r):mm(e,t,r);if(!(i>=a))return[];const u=i-a+1,h=new Array(u);if(n)if(l<0)for(let d=0;d<u;++d)h[d]=(i-d)/-l;else for(let d=0;d<u;++d)h[d]=(i-d)*l;else if(l<0)for(let d=0;d<u;++d)h[d]=(a+d)/-l;else for(let d=0;d<u;++d)h[d]=(a+d)*l;return h}function eb(e,t,r){return t=+t,e=+e,r=+r,mm(e,t,r)[2]}function tb(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?eb(t,e,r):eb(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function D4(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function P4(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function cD(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?oD:tJ(a);n>r;){if(n-r>600){const h=n-r+1,d=t-r+1,m=Math.log(h),p=.5*Math.exp(2*m/3),v=.5*Math.sqrt(m*p*(h-p)/h)*(d-h/2<0?-1:1),g=Math.max(r,Math.floor(t-d*p/h+v)),w=Math.min(n,Math.floor(t+(h-d)*p/h+v));cD(e,t,g,w,a)}const i=e[t];let l=r,u=n;for(uf(e,r,t),a(e[n],i)>0&&uf(e,r,n);l<u;){for(uf(e,l,u),++l,--u;a(e[l],i)<0;)++l;for(;a(e[u],i)>0;)--u}a(e[r],i)===0?uf(e,r,u):(++u,uf(e,u,n)),u<=t&&(r=u+1),t<=u&&(n=u-1)}return e}function uf(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function iJ(e,t,r){if(e=Float64Array.from(XQ(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return P4(e);if(t>=1)return D4(e);var n,a=(n-1)*t,i=Math.floor(a),l=D4(cD(e,i).subarray(0,i+1)),u=P4(e.subarray(i+1));return l+(u-l)*(a-i)}}function sJ(e,t,r=lD){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),l=+r(e[i],i,e),u=+r(e[i+1],i+1,e);return l+(u-l)*(a-i)}}function lJ(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++n<a;)i[n]=e+n*r;return i}function Za(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Es(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const rb=Symbol("implicit");function z2(){var e=new C4,t=[],r=[],n=rb;function a(i){let l=e.get(i);if(l===void 0){if(n!==rb)return n;e.set(i,l=t.push(i)-1)}return r[l%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new C4;for(const l of i)e.has(l)||e.set(l,t.push(l)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return z2(t,r).unknown(n)},Za.apply(a,arguments),a}function H2(){var e=z2().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,i,l,u=!1,h=0,d=0,m=.5;delete e.unknown;function p(){var v=t().length,g=a<n,w=g?a:n,b=g?n:a;i=(b-w)/Math.max(1,v-h+d*2),u&&(i=Math.floor(i)),w+=(b-w-i*(v-h))*m,l=i*(1-h),u&&(w=Math.round(w),l=Math.round(l));var S=lJ(v).map(function(j){return w+i*j});return r(g?S.reverse():S)}return e.domain=function(v){return arguments.length?(t(v),p()):t()},e.range=function(v){return arguments.length?([n,a]=v,n=+n,a=+a,p()):[n,a]},e.rangeRound=function(v){return[n,a]=v,n=+n,a=+a,u=!0,p()},e.bandwidth=function(){return l},e.step=function(){return i},e.round=function(v){return arguments.length?(u=!!v,p()):u},e.padding=function(v){return arguments.length?(h=Math.min(1,d=+v),p()):h},e.paddingInner=function(v){return arguments.length?(h=Math.min(1,v),p()):h},e.paddingOuter=function(v){return arguments.length?(d=+v,p()):d},e.align=function(v){return arguments.length?(m=Math.max(0,Math.min(1,v)),p()):m},e.copy=function(){return H2(t(),[n,a]).round(u).paddingInner(h).paddingOuter(d).align(m)},Za.apply(p(),arguments)}function uD(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return uD(t())},e}function oJ(){return uD(H2.apply(null,arguments).paddingInner(1))}function q2(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function fD(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function jd(){}var ed=.7,pm=1/ed,Cc="\\s*([+-]?\\d+)\\s*",td="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ti="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",cJ=/^#([0-9a-f]{3,8})$/,uJ=new RegExp(`^rgb\\(${Cc},${Cc},${Cc}\\)$`),fJ=new RegExp(`^rgb\\(${Ti},${Ti},${Ti}\\)$`),dJ=new RegExp(`^rgba\\(${Cc},${Cc},${Cc},${td}\\)$`),hJ=new RegExp(`^rgba\\(${Ti},${Ti},${Ti},${td}\\)$`),mJ=new RegExp(`^hsl\\(${td},${Ti},${Ti}\\)$`),pJ=new RegExp(`^hsla\\(${td},${Ti},${Ti},${td}\\)$`),R4={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};q2(jd,rd,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:M4,formatHex:M4,formatHex8:xJ,formatHsl:vJ,formatRgb:F4,toString:F4});function M4(){return this.rgb().formatHex()}function xJ(){return this.rgb().formatHex8()}function vJ(){return dD(this).formatHsl()}function F4(){return this.rgb().formatRgb()}function rd(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=cJ.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?I4(t):r===3?new Un(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?gh(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?gh(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=uJ.exec(e))?new Un(t[1],t[2],t[3],1):(t=fJ.exec(e))?new Un(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=dJ.exec(e))?gh(t[1],t[2],t[3],t[4]):(t=hJ.exec(e))?gh(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=mJ.exec(e))?U4(t[1],t[2]/100,t[3]/100,1):(t=pJ.exec(e))?U4(t[1],t[2]/100,t[3]/100,t[4]):R4.hasOwnProperty(e)?I4(R4[e]):e==="transparent"?new Un(NaN,NaN,NaN,0):null}function I4(e){return new Un(e>>16&255,e>>8&255,e&255,1)}function gh(e,t,r,n){return n<=0&&(e=t=r=NaN),new Un(e,t,r,n)}function gJ(e){return e instanceof jd||(e=rd(e)),e?(e=e.rgb(),new Un(e.r,e.g,e.b,e.opacity)):new Un}function nb(e,t,r,n){return arguments.length===1?gJ(e):new Un(e,t,r,n??1)}function Un(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}q2(Un,nb,fD(jd,{brighter(e){return e=e==null?pm:Math.pow(pm,e),new Un(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?ed:Math.pow(ed,e),new Un(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Un(fo(this.r),fo(this.g),fo(this.b),xm(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:L4,formatHex:L4,formatHex8:yJ,formatRgb:B4,toString:B4}));function L4(){return`#${no(this.r)}${no(this.g)}${no(this.b)}`}function yJ(){return`#${no(this.r)}${no(this.g)}${no(this.b)}${no((isNaN(this.opacity)?1:this.opacity)*255)}`}function B4(){const e=xm(this.opacity);return`${e===1?"rgb(":"rgba("}${fo(this.r)}, ${fo(this.g)}, ${fo(this.b)}${e===1?")":`, ${e})`}`}function xm(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function fo(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function no(e){return e=fo(e),(e<16?"0":"")+e.toString(16)}function U4(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new li(e,t,r,n)}function dD(e){if(e instanceof li)return new li(e.h,e.s,e.l,e.opacity);if(e instanceof jd||(e=rd(e)),!e)return new li;if(e instanceof li)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),l=NaN,u=i-a,h=(i+a)/2;return u?(t===i?l=(r-n)/u+(r<n)*6:r===i?l=(n-t)/u+2:l=(t-r)/u+4,u/=h<.5?i+a:2-i-a,l*=60):u=h>0&&h<1?0:l,new li(l,u,h,e.opacity)}function bJ(e,t,r,n){return arguments.length===1?dD(e):new li(e,t,r,n??1)}function li(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}q2(li,bJ,fD(jd,{brighter(e){return e=e==null?pm:Math.pow(pm,e),new li(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?ed:Math.pow(ed,e),new li(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new Un(D1(e>=240?e-240:e+120,a,n),D1(e,a,n),D1(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new li($4(this.h),yh(this.s),yh(this.l),xm(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=xm(this.opacity);return`${e===1?"hsl(":"hsla("}${$4(this.h)}, ${yh(this.s)*100}%, ${yh(this.l)*100}%${e===1?")":`, ${e})`}`}}));function $4(e){return e=(e||0)%360,e<0?e+360:e}function yh(e){return Math.max(0,Math.min(1,e||0))}function D1(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const V2=e=>()=>e;function wJ(e,t){return function(r){return e+r*t}}function SJ(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function EJ(e){return(e=+e)==1?hD:function(t,r){return r-t?SJ(t,r,e):V2(isNaN(t)?r:t)}}function hD(e,t){var r=t-e;return r?wJ(e,r):V2(isNaN(e)?t:e)}const z4=function e(t){var r=EJ(t);function n(a,i){var l=r((a=nb(a)).r,(i=nb(i)).r),u=r(a.g,i.g),h=r(a.b,i.b),d=hD(a.opacity,i.opacity);return function(m){return a.r=l(m),a.g=u(m),a.b=h(m),a.opacity=d(m),a+""}}return n.gamma=e,n}(1);function jJ(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function NJ(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function AJ(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),l;for(l=0;l<n;++l)a[l]=Jc(e[l],t[l]);for(;l<r;++l)i[l]=t[l];return function(u){for(l=0;l<n;++l)i[l]=a[l](u);return i}}function _J(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function vm(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function TJ(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=Jc(e[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var ab=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,P1=new RegExp(ab.source,"g");function kJ(e){return function(){return e}}function CJ(e){return function(t){return e(t)+""}}function OJ(e,t){var r=ab.lastIndex=P1.lastIndex=0,n,a,i,l=-1,u=[],h=[];for(e=e+"",t=t+"";(n=ab.exec(e))&&(a=P1.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),u[l]?u[l]+=i:u[++l]=i),(n=n[0])===(a=a[0])?u[l]?u[l]+=a:u[++l]=a:(u[++l]=null,h.push({i:l,x:vm(n,a)})),r=P1.lastIndex;return r<t.length&&(i=t.slice(r),u[l]?u[l]+=i:u[++l]=i),u.length<2?h[0]?CJ(h[0].x):kJ(t):(t=h.length,function(d){for(var m=0,p;m<t;++m)u[(p=h[m]).i]=p.x(d);return u.join("")})}function Jc(e,t){var r=typeof t,n;return t==null||r==="boolean"?V2(t):(r==="number"?vm:r==="string"?(n=rd(t))?(t=n,z4):OJ:t instanceof rd?z4:t instanceof Date?_J:NJ(t)?jJ:Array.isArray(t)?AJ:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?TJ:vm)(e,t)}function K2(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function DJ(e,t){t===void 0&&(t=e,e=Jc);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(l){var u=Math.max(0,Math.min(n-1,Math.floor(l*=n)));return i[u](l-u)}}function PJ(e){return function(){return e}}function gm(e){return+e}var H4=[0,1];function Cn(e){return e}function ib(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:PJ(isNaN(t)?NaN:.5)}function RJ(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function MJ(e,t,r){var n=e[0],a=e[1],i=t[0],l=t[1];return a<n?(n=ib(a,n),i=r(l,i)):(n=ib(n,a),i=r(i,l)),function(u){return i(n(u))}}function FJ(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),i=new Array(n),l=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++l<n;)a[l]=ib(e[l],e[l+1]),i[l]=r(t[l],t[l+1]);return function(u){var h=Ed(e,u,1,n)-1;return i[h](a[h](u))}}function Nd(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function pp(){var e=H4,t=H4,r=Jc,n,a,i,l=Cn,u,h,d;function m(){var v=Math.min(e.length,t.length);return l!==Cn&&(l=RJ(e[0],e[v-1])),u=v>2?FJ:MJ,h=d=null,p}function p(v){return v==null||isNaN(v=+v)?i:(h||(h=u(e.map(n),t,r)))(n(l(v)))}return p.invert=function(v){return l(a((d||(d=u(t,e.map(n),vm)))(v)))},p.domain=function(v){return arguments.length?(e=Array.from(v,gm),m()):e.slice()},p.range=function(v){return arguments.length?(t=Array.from(v),m()):t.slice()},p.rangeRound=function(v){return t=Array.from(v),r=K2,m()},p.clamp=function(v){return arguments.length?(l=v?!0:Cn,m()):l!==Cn},p.interpolate=function(v){return arguments.length?(r=v,m()):r},p.unknown=function(v){return arguments.length?(i=v,p):i},function(v,g){return n=v,a=g,m()}}function G2(){return pp()(Cn,Cn)}function IJ(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function ym(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Ic(e){return e=ym(Math.abs(e)),e?e[1]:NaN}function LJ(e,t){return function(r,n){for(var a=r.length,i=[],l=0,u=e[0],h=0;a>0&&u>0&&(h+u+1>n&&(u=Math.max(1,n-h)),i.push(r.substring(a-=u,a+u)),!((h+=u+1)>n));)u=e[l=(l+1)%e.length];return i.reverse().join(t)}}function BJ(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var UJ=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function nd(e){if(!(t=UJ.exec(e)))throw new Error("invalid format: "+e);var t;return new W2({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}nd.prototype=W2.prototype;function W2(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}W2.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function $J(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var mD;function zJ(e,t){var r=ym(e,t);if(!r)return e+"";var n=r[0],a=r[1],i=a-(mD=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,l=n.length;return i===l?n:i>l?n+new Array(i-l+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+ym(e,Math.max(0,t+i-1))[0]}function q4(e,t){var r=ym(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const V4={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:IJ,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>q4(e*100,t),r:q4,s:zJ,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function K4(e){return e}var G4=Array.prototype.map,W4=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function HJ(e){var t=e.grouping===void 0||e.thousands===void 0?K4:LJ(G4.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?K4:BJ(G4.call(e.numerals,String)),l=e.percent===void 0?"%":e.percent+"",u=e.minus===void 0?"":e.minus+"",h=e.nan===void 0?"NaN":e.nan+"";function d(p){p=nd(p);var v=p.fill,g=p.align,w=p.sign,b=p.symbol,S=p.zero,j=p.width,_=p.comma,A=p.precision,k=p.trim,O=p.type;O==="n"?(_=!0,O="g"):V4[O]||(A===void 0&&(A=12),k=!0,O="g"),(S||v==="0"&&g==="=")&&(S=!0,v="0",g="=");var C=b==="$"?r:b==="#"&&/[boxX]/.test(O)?"0"+O.toLowerCase():"",T=b==="$"?n:/[%p]/.test(O)?l:"",I=V4[O],M=/[defgprs%]/.test(O);A=A===void 0?6:/[gprs]/.test(O)?Math.max(1,Math.min(21,A)):Math.max(0,Math.min(20,A));function W(U){var F=C,oe=T,je,ue,V;if(O==="c")oe=I(U)+oe,U="";else{U=+U;var H=U<0||1/U<0;if(U=isNaN(U)?h:I(Math.abs(U),A),k&&(U=$J(U)),H&&+U==0&&w!=="+"&&(H=!1),F=(H?w==="("?w:u:w==="-"||w==="("?"":w)+F,oe=(O==="s"?W4[8+mD/3]:"")+oe+(H&&w==="("?")":""),M){for(je=-1,ue=U.length;++je<ue;)if(V=U.charCodeAt(je),48>V||V>57){oe=(V===46?a+U.slice(je+1):U.slice(je))+oe,U=U.slice(0,je);break}}}_&&!S&&(U=t(U,1/0));var Se=F.length+U.length+oe.length,Q=Se<j?new Array(j-Se+1).join(v):"";switch(_&&S&&(U=t(Q+U,Q.length?j-oe.length:1/0),Q=""),g){case"<":U=F+U+oe+Q;break;case"=":U=F+Q+U+oe;break;case"^":U=Q.slice(0,Se=Q.length>>1)+F+U+oe+Q.slice(Se);break;default:U=Q+F+U+oe;break}return i(U)}return W.toString=function(){return p+""},W}function m(p,v){var g=d((p=nd(p),p.type="f",p)),w=Math.max(-8,Math.min(8,Math.floor(Ic(v)/3)))*3,b=Math.pow(10,-w),S=W4[8+w/3];return function(j){return g(b*j)+S}}return{format:d,formatPrefix:m}}var bh,Y2,pD;qJ({thousands:",",grouping:[3],currency:["$",""]});function qJ(e){return bh=HJ(e),Y2=bh.format,pD=bh.formatPrefix,bh}function VJ(e){return Math.max(0,-Ic(Math.abs(e)))}function KJ(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Ic(t)/3)))*3-Ic(Math.abs(e)))}function GJ(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Ic(t)-Ic(e))+1}function xD(e,t,r,n){var a=tb(e,t,r),i;switch(n=nd(n??",f"),n.type){case"s":{var l=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(i=KJ(a,l))&&(n.precision=i),pD(n,l)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=GJ(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=VJ(a))&&(n.precision=i-(n.type==="%")*2);break}}return Y2(n)}function wl(e){var t=e.domain;return e.ticks=function(r){var n=t();return Jy(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return xD(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,l=n[a],u=n[i],h,d,m=10;for(u<l&&(d=l,l=u,u=d,d=a,a=i,i=d);m-- >0;){if(d=eb(l,u,r),d===h)return n[a]=l,n[i]=u,t(n);if(d>0)l=Math.floor(l/d)*d,u=Math.ceil(u/d)*d;else if(d<0)l=Math.ceil(l*d)/d,u=Math.floor(u*d)/d;else break;h=d}return e},e}function vD(){var e=G2();return e.copy=function(){return Nd(e,vD())},Za.apply(e,arguments),wl(e)}function gD(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,gm),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return gD(e).unknown(t)},e=arguments.length?Array.from(e,gm):[0,1],wl(r)}function yD(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],i=e[n],l;return i<a&&(l=r,r=n,n=l,l=a,a=i,i=l),e[r]=t.floor(a),e[n]=t.ceil(i),e}function Y4(e){return Math.log(e)}function X4(e){return Math.exp(e)}function WJ(e){return-Math.log(-e)}function YJ(e){return-Math.exp(-e)}function XJ(e){return isFinite(e)?+("1e"+e):e<0?0:e}function ZJ(e){return e===10?XJ:e===Math.E?Math.exp:t=>Math.pow(e,t)}function QJ(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function Z4(e){return(t,r)=>-e(-t,r)}function X2(e){const t=e(Y4,X4),r=t.domain;let n=10,a,i;function l(){return a=QJ(n),i=ZJ(n),r()[0]<0?(a=Z4(a),i=Z4(i),e(WJ,YJ)):e(Y4,X4),t}return t.base=function(u){return arguments.length?(n=+u,l()):n},t.domain=function(u){return arguments.length?(r(u),l()):r()},t.ticks=u=>{const h=r();let d=h[0],m=h[h.length-1];const p=m<d;p&&([d,m]=[m,d]);let v=a(d),g=a(m),w,b;const S=u==null?10:+u;let j=[];if(!(n%1)&&g-v<S){if(v=Math.floor(v),g=Math.ceil(g),d>0){for(;v<=g;++v)for(w=1;w<n;++w)if(b=v<0?w/i(-v):w*i(v),!(b<d)){if(b>m)break;j.push(b)}}else for(;v<=g;++v)for(w=n-1;w>=1;--w)if(b=v>0?w/i(-v):w*i(v),!(b<d)){if(b>m)break;j.push(b)}j.length*2<S&&(j=Jy(d,m,S))}else j=Jy(v,g,Math.min(g-v,S)).map(i);return p?j.reverse():j},t.tickFormat=(u,h)=>{if(u==null&&(u=10),h==null&&(h=n===10?"s":","),typeof h!="function"&&(!(n%1)&&(h=nd(h)).precision==null&&(h.trim=!0),h=Y2(h)),u===1/0)return h;const d=Math.max(1,n*u/t.ticks().length);return m=>{let p=m/i(Math.round(a(m)));return p*n<n-.5&&(p*=n),p<=d?h(m):""}},t.nice=()=>r(yD(r(),{floor:u=>i(Math.floor(a(u))),ceil:u=>i(Math.ceil(a(u)))})),t}function bD(){const e=X2(pp()).domain([1,10]);return e.copy=()=>Nd(e,bD()).base(e.base()),Za.apply(e,arguments),e}function Q4(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function J4(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Z2(e){var t=1,r=e(Q4(t),J4(t));return r.constant=function(n){return arguments.length?e(Q4(t=+n),J4(t)):t},wl(r)}function wD(){var e=Z2(pp());return e.copy=function(){return Nd(e,wD()).constant(e.constant())},Za.apply(e,arguments)}function ek(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function JJ(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function eee(e){return e<0?-e*e:e*e}function Q2(e){var t=e(Cn,Cn),r=1;function n(){return r===1?e(Cn,Cn):r===.5?e(JJ,eee):e(ek(r),ek(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},wl(t)}function J2(){var e=Q2(pp());return e.copy=function(){return Nd(e,J2()).exponent(e.exponent())},Za.apply(e,arguments),e}function tee(){return J2.apply(null,arguments).exponent(.5)}function tk(e){return Math.sign(e)*e*e}function ree(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function SD(){var e=G2(),t=[0,1],r=!1,n;function a(i){var l=ree(e(i));return isNaN(l)?n:r?Math.round(l):l}return a.invert=function(i){return e.invert(tk(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,gm)).map(tk)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return SD(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Za.apply(a,arguments),wl(a)}function ED(){var e=[],t=[],r=[],n;function a(){var l=0,u=Math.max(1,t.length);for(r=new Array(u-1);++l<u;)r[l-1]=sJ(e,l/u);return i}function i(l){return l==null||isNaN(l=+l)?n:t[Ed(r,l)]}return i.invertExtent=function(l){var u=t.indexOf(l);return u<0?[NaN,NaN]:[u>0?r[u-1]:e[0],u<r.length?r[u]:e[e.length-1]]},i.domain=function(l){if(!arguments.length)return e.slice();e=[];for(let u of l)u!=null&&!isNaN(u=+u)&&e.push(u);return e.sort(hl),a()},i.range=function(l){return arguments.length?(t=Array.from(l),a()):t.slice()},i.unknown=function(l){return arguments.length?(n=l,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return ED().domain(e).range(t).unknown(n)},Za.apply(i,arguments)}function jD(){var e=0,t=1,r=1,n=[.5],a=[0,1],i;function l(h){return h!=null&&h<=h?a[Ed(n,h,0,r)]:i}function u(){var h=-1;for(n=new Array(r);++h<r;)n[h]=((h+1)*t-(h-r)*e)/(r+1);return l}return l.domain=function(h){return arguments.length?([e,t]=h,e=+e,t=+t,u()):[e,t]},l.range=function(h){return arguments.length?(r=(a=Array.from(h)).length-1,u()):a.slice()},l.invertExtent=function(h){var d=a.indexOf(h);return d<0?[NaN,NaN]:d<1?[e,n[0]]:d>=r?[n[r-1],t]:[n[d-1],n[d]]},l.unknown=function(h){return arguments.length&&(i=h),l},l.thresholds=function(){return n.slice()},l.copy=function(){return jD().domain([e,t]).range(a).unknown(i)},Za.apply(wl(l),arguments)}function ND(){var e=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[Ed(e,i,0,n)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var l=t.indexOf(i);return[e[l-1],e[l]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return ND().domain(e).range(t).unknown(r)},Za.apply(a,arguments)}const R1=new Date,M1=new Date;function Fr(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const l=a(i),u=a.ceil(i);return i-l<u-i?l:u},a.offset=(i,l)=>(t(i=new Date(+i),l==null?1:Math.floor(l)),i),a.range=(i,l,u)=>{const h=[];if(i=a.ceil(i),u=u==null?1:Math.floor(u),!(i<l)||!(u>0))return h;let d;do h.push(d=new Date(+i)),t(i,u),e(i);while(d<i&&i<l);return h},a.filter=i=>Fr(l=>{if(l>=l)for(;e(l),!i(l);)l.setTime(l-1)},(l,u)=>{if(l>=l)if(u<0)for(;++u<=0;)for(;t(l,-1),!i(l););else for(;--u>=0;)for(;t(l,1),!i(l););}),r&&(a.count=(i,l)=>(R1.setTime(+i),M1.setTime(+l),e(R1),e(M1),Math.floor(r(R1,M1))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?l=>n(l)%i===0:l=>a.count(0,l)%i===0):a)),a}const bm=Fr(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);bm.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Fr(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):bm);bm.range;const ns=1e3,Ua=ns*60,as=Ua*60,ms=as*24,ew=ms*7,rk=ms*30,F1=ms*365,ao=Fr(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*ns)},(e,t)=>(t-e)/ns,e=>e.getUTCSeconds());ao.range;const tw=Fr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*ns)},(e,t)=>{e.setTime(+e+t*Ua)},(e,t)=>(t-e)/Ua,e=>e.getMinutes());tw.range;const rw=Fr(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Ua)},(e,t)=>(t-e)/Ua,e=>e.getUTCMinutes());rw.range;const nw=Fr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*ns-e.getMinutes()*Ua)},(e,t)=>{e.setTime(+e+t*as)},(e,t)=>(t-e)/as,e=>e.getHours());nw.range;const aw=Fr(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*as)},(e,t)=>(t-e)/as,e=>e.getUTCHours());aw.range;const Ad=Fr(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ua)/ms,e=>e.getDate()-1);Ad.range;const xp=Fr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ms,e=>e.getUTCDate()-1);xp.range;const AD=Fr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ms,e=>Math.floor(e/ms));AD.range;function Co(e){return Fr(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Ua)/ew)}const vp=Co(0),wm=Co(1),nee=Co(2),aee=Co(3),Lc=Co(4),iee=Co(5),see=Co(6);vp.range;wm.range;nee.range;aee.range;Lc.range;iee.range;see.range;function Oo(e){return Fr(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/ew)}const gp=Oo(0),Sm=Oo(1),lee=Oo(2),oee=Oo(3),Bc=Oo(4),cee=Oo(5),uee=Oo(6);gp.range;Sm.range;lee.range;oee.range;Bc.range;cee.range;uee.range;const iw=Fr(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());iw.range;const sw=Fr(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());sw.range;const ps=Fr(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());ps.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Fr(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});ps.range;const xs=Fr(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());xs.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Fr(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});xs.range;function _D(e,t,r,n,a,i){const l=[[ao,1,ns],[ao,5,5*ns],[ao,15,15*ns],[ao,30,30*ns],[i,1,Ua],[i,5,5*Ua],[i,15,15*Ua],[i,30,30*Ua],[a,1,as],[a,3,3*as],[a,6,6*as],[a,12,12*as],[n,1,ms],[n,2,2*ms],[r,1,ew],[t,1,rk],[t,3,3*rk],[e,1,F1]];function u(d,m,p){const v=m<d;v&&([d,m]=[m,d]);const g=p&&typeof p.range=="function"?p:h(d,m,p),w=g?g.range(d,+m+1):[];return v?w.reverse():w}function h(d,m,p){const v=Math.abs(m-d)/p,g=$2(([,,S])=>S).right(l,v);if(g===l.length)return e.every(tb(d/F1,m/F1,p));if(g===0)return bm.every(Math.max(tb(d,m,p),1));const[w,b]=l[v/l[g-1][2]<l[g][2]/v?g-1:g];return w.every(b)}return[u,h]}const[fee,dee]=_D(xs,sw,gp,AD,aw,rw),[hee,mee]=_D(ps,iw,vp,Ad,nw,tw);function I1(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function L1(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function ff(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function pee(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,l=e.shortDays,u=e.months,h=e.shortMonths,d=df(a),m=hf(a),p=df(i),v=hf(i),g=df(l),w=hf(l),b=df(u),S=hf(u),j=df(h),_=hf(h),A={a:H,A:Se,b:Q,B:z,c:null,d:ok,e:ok,f:Lee,g:Wee,G:Xee,H:Mee,I:Fee,j:Iee,L:TD,m:Bee,M:Uee,p:Y,q:P,Q:fk,s:dk,S:$ee,u:zee,U:Hee,V:qee,w:Vee,W:Kee,x:null,X:null,y:Gee,Y:Yee,Z:Zee,"%":uk},k={a:q,A:G,b:Z,B:fe,c:null,d:ck,e:ck,f:tte,g:fte,G:hte,H:Qee,I:Jee,j:ete,L:CD,m:rte,M:nte,p:Oe,q:Re,Q:fk,s:dk,S:ate,u:ite,U:ste,V:lte,w:ote,W:cte,x:null,X:null,y:ute,Y:dte,Z:mte,"%":uk},O={a:W,A:U,b:F,B:oe,c:je,d:sk,e:sk,f:Oee,g:ik,G:ak,H:lk,I:lk,j:_ee,L:Cee,m:Aee,M:Tee,p:M,q:Nee,Q:Pee,s:Ree,S:kee,u:bee,U:wee,V:See,w:yee,W:Eee,x:ue,X:V,y:ik,Y:ak,Z:jee,"%":Dee};A.x=C(r,A),A.X=C(n,A),A.c=C(t,A),k.x=C(r,k),k.X=C(n,k),k.c=C(t,k);function C(re,be){return function(Ae){var D=[],Me=-1,ae=0,de=re.length,me,ce,ze;for(Ae instanceof Date||(Ae=new Date(+Ae));++Me<de;)re.charCodeAt(Me)===37&&(D.push(re.slice(ae,Me)),(ce=nk[me=re.charAt(++Me)])!=null?me=re.charAt(++Me):ce=me==="e"?" ":"0",(ze=be[me])&&(me=ze(Ae,ce)),D.push(me),ae=Me+1);return D.push(re.slice(ae,Me)),D.join("")}}function T(re,be){return function(Ae){var D=ff(1900,void 0,1),Me=I(D,re,Ae+="",0),ae,de;if(Me!=Ae.length)return null;if("Q"in D)return new Date(D.Q);if("s"in D)return new Date(D.s*1e3+("L"in D?D.L:0));if(be&&!("Z"in D)&&(D.Z=0),"p"in D&&(D.H=D.H%12+D.p*12),D.m===void 0&&(D.m="q"in D?D.q:0),"V"in D){if(D.V<1||D.V>53)return null;"w"in D||(D.w=1),"Z"in D?(ae=L1(ff(D.y,0,1)),de=ae.getUTCDay(),ae=de>4||de===0?Sm.ceil(ae):Sm(ae),ae=xp.offset(ae,(D.V-1)*7),D.y=ae.getUTCFullYear(),D.m=ae.getUTCMonth(),D.d=ae.getUTCDate()+(D.w+6)%7):(ae=I1(ff(D.y,0,1)),de=ae.getDay(),ae=de>4||de===0?wm.ceil(ae):wm(ae),ae=Ad.offset(ae,(D.V-1)*7),D.y=ae.getFullYear(),D.m=ae.getMonth(),D.d=ae.getDate()+(D.w+6)%7)}else("W"in D||"U"in D)&&("w"in D||(D.w="u"in D?D.u%7:"W"in D?1:0),de="Z"in D?L1(ff(D.y,0,1)).getUTCDay():I1(ff(D.y,0,1)).getDay(),D.m=0,D.d="W"in D?(D.w+6)%7+D.W*7-(de+5)%7:D.w+D.U*7-(de+6)%7);return"Z"in D?(D.H+=D.Z/100|0,D.M+=D.Z%100,L1(D)):I1(D)}}function I(re,be,Ae,D){for(var Me=0,ae=be.length,de=Ae.length,me,ce;Me<ae;){if(D>=de)return-1;if(me=be.charCodeAt(Me++),me===37){if(me=be.charAt(Me++),ce=O[me in nk?be.charAt(Me++):me],!ce||(D=ce(re,Ae,D))<0)return-1}else if(me!=Ae.charCodeAt(D++))return-1}return D}function M(re,be,Ae){var D=d.exec(be.slice(Ae));return D?(re.p=m.get(D[0].toLowerCase()),Ae+D[0].length):-1}function W(re,be,Ae){var D=g.exec(be.slice(Ae));return D?(re.w=w.get(D[0].toLowerCase()),Ae+D[0].length):-1}function U(re,be,Ae){var D=p.exec(be.slice(Ae));return D?(re.w=v.get(D[0].toLowerCase()),Ae+D[0].length):-1}function F(re,be,Ae){var D=j.exec(be.slice(Ae));return D?(re.m=_.get(D[0].toLowerCase()),Ae+D[0].length):-1}function oe(re,be,Ae){var D=b.exec(be.slice(Ae));return D?(re.m=S.get(D[0].toLowerCase()),Ae+D[0].length):-1}function je(re,be,Ae){return I(re,t,be,Ae)}function ue(re,be,Ae){return I(re,r,be,Ae)}function V(re,be,Ae){return I(re,n,be,Ae)}function H(re){return l[re.getDay()]}function Se(re){return i[re.getDay()]}function Q(re){return h[re.getMonth()]}function z(re){return u[re.getMonth()]}function Y(re){return a[+(re.getHours()>=12)]}function P(re){return 1+~~(re.getMonth()/3)}function q(re){return l[re.getUTCDay()]}function G(re){return i[re.getUTCDay()]}function Z(re){return h[re.getUTCMonth()]}function fe(re){return u[re.getUTCMonth()]}function Oe(re){return a[+(re.getUTCHours()>=12)]}function Re(re){return 1+~~(re.getUTCMonth()/3)}return{format:function(re){var be=C(re+="",A);return be.toString=function(){return re},be},parse:function(re){var be=T(re+="",!1);return be.toString=function(){return re},be},utcFormat:function(re){var be=C(re+="",k);return be.toString=function(){return re},be},utcParse:function(re){var be=T(re+="",!0);return be.toString=function(){return re},be}}}var nk={"-":"",_:" ",0:"0"},Vr=/^\s*\d+/,xee=/^%/,vee=/[\\^$*+?|[\]().{}]/g;function Rt(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function gee(e){return e.replace(vee,"\\$&")}function df(e){return new RegExp("^(?:"+e.map(gee).join("|")+")","i")}function hf(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function yee(e,t,r){var n=Vr.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function bee(e,t,r){var n=Vr.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function wee(e,t,r){var n=Vr.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function See(e,t,r){var n=Vr.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function Eee(e,t,r){var n=Vr.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function ak(e,t,r){var n=Vr.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function ik(e,t,r){var n=Vr.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function jee(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function Nee(e,t,r){var n=Vr.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function Aee(e,t,r){var n=Vr.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function sk(e,t,r){var n=Vr.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function _ee(e,t,r){var n=Vr.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function lk(e,t,r){var n=Vr.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function Tee(e,t,r){var n=Vr.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function kee(e,t,r){var n=Vr.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function Cee(e,t,r){var n=Vr.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function Oee(e,t,r){var n=Vr.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function Dee(e,t,r){var n=xee.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function Pee(e,t,r){var n=Vr.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function Ree(e,t,r){var n=Vr.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function ok(e,t){return Rt(e.getDate(),t,2)}function Mee(e,t){return Rt(e.getHours(),t,2)}function Fee(e,t){return Rt(e.getHours()%12||12,t,2)}function Iee(e,t){return Rt(1+Ad.count(ps(e),e),t,3)}function TD(e,t){return Rt(e.getMilliseconds(),t,3)}function Lee(e,t){return TD(e,t)+"000"}function Bee(e,t){return Rt(e.getMonth()+1,t,2)}function Uee(e,t){return Rt(e.getMinutes(),t,2)}function $ee(e,t){return Rt(e.getSeconds(),t,2)}function zee(e){var t=e.getDay();return t===0?7:t}function Hee(e,t){return Rt(vp.count(ps(e)-1,e),t,2)}function kD(e){var t=e.getDay();return t>=4||t===0?Lc(e):Lc.ceil(e)}function qee(e,t){return e=kD(e),Rt(Lc.count(ps(e),e)+(ps(e).getDay()===4),t,2)}function Vee(e){return e.getDay()}function Kee(e,t){return Rt(wm.count(ps(e)-1,e),t,2)}function Gee(e,t){return Rt(e.getFullYear()%100,t,2)}function Wee(e,t){return e=kD(e),Rt(e.getFullYear()%100,t,2)}function Yee(e,t){return Rt(e.getFullYear()%1e4,t,4)}function Xee(e,t){var r=e.getDay();return e=r>=4||r===0?Lc(e):Lc.ceil(e),Rt(e.getFullYear()%1e4,t,4)}function Zee(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Rt(t/60|0,"0",2)+Rt(t%60,"0",2)}function ck(e,t){return Rt(e.getUTCDate(),t,2)}function Qee(e,t){return Rt(e.getUTCHours(),t,2)}function Jee(e,t){return Rt(e.getUTCHours()%12||12,t,2)}function ete(e,t){return Rt(1+xp.count(xs(e),e),t,3)}function CD(e,t){return Rt(e.getUTCMilliseconds(),t,3)}function tte(e,t){return CD(e,t)+"000"}function rte(e,t){return Rt(e.getUTCMonth()+1,t,2)}function nte(e,t){return Rt(e.getUTCMinutes(),t,2)}function ate(e,t){return Rt(e.getUTCSeconds(),t,2)}function ite(e){var t=e.getUTCDay();return t===0?7:t}function ste(e,t){return Rt(gp.count(xs(e)-1,e),t,2)}function OD(e){var t=e.getUTCDay();return t>=4||t===0?Bc(e):Bc.ceil(e)}function lte(e,t){return e=OD(e),Rt(Bc.count(xs(e),e)+(xs(e).getUTCDay()===4),t,2)}function ote(e){return e.getUTCDay()}function cte(e,t){return Rt(Sm.count(xs(e)-1,e),t,2)}function ute(e,t){return Rt(e.getUTCFullYear()%100,t,2)}function fte(e,t){return e=OD(e),Rt(e.getUTCFullYear()%100,t,2)}function dte(e,t){return Rt(e.getUTCFullYear()%1e4,t,4)}function hte(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Bc(e):Bc.ceil(e),Rt(e.getUTCFullYear()%1e4,t,4)}function mte(){return"+0000"}function uk(){return"%"}function fk(e){return+e}function dk(e){return Math.floor(+e/1e3)}var gc,DD,PD;pte({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function pte(e){return gc=pee(e),DD=gc.format,gc.parse,PD=gc.utcFormat,gc.utcParse,gc}function xte(e){return new Date(e)}function vte(e){return e instanceof Date?+e:+new Date(+e)}function lw(e,t,r,n,a,i,l,u,h,d){var m=G2(),p=m.invert,v=m.domain,g=d(".%L"),w=d(":%S"),b=d("%I:%M"),S=d("%I %p"),j=d("%a %d"),_=d("%b %d"),A=d("%B"),k=d("%Y");function O(C){return(h(C)<C?g:u(C)<C?w:l(C)<C?b:i(C)<C?S:n(C)<C?a(C)<C?j:_:r(C)<C?A:k)(C)}return m.invert=function(C){return new Date(p(C))},m.domain=function(C){return arguments.length?v(Array.from(C,vte)):v().map(xte)},m.ticks=function(C){var T=v();return e(T[0],T[T.length-1],C??10)},m.tickFormat=function(C,T){return T==null?O:d(T)},m.nice=function(C){var T=v();return(!C||typeof C.range!="function")&&(C=t(T[0],T[T.length-1],C??10)),C?v(yD(T,C)):m},m.copy=function(){return Nd(m,lw(e,t,r,n,a,i,l,u,h,d))},m}function gte(){return Za.apply(lw(hee,mee,ps,iw,vp,Ad,nw,tw,ao,DD).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function yte(){return Za.apply(lw(fee,dee,xs,sw,gp,xp,aw,rw,ao,PD).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function yp(){var e=0,t=1,r,n,a,i,l=Cn,u=!1,h;function d(p){return p==null||isNaN(p=+p)?h:l(a===0?.5:(p=(i(p)-r)*a,u?Math.max(0,Math.min(1,p)):p))}d.domain=function(p){return arguments.length?([e,t]=p,r=i(e=+e),n=i(t=+t),a=r===n?0:1/(n-r),d):[e,t]},d.clamp=function(p){return arguments.length?(u=!!p,d):u},d.interpolator=function(p){return arguments.length?(l=p,d):l};function m(p){return function(v){var g,w;return arguments.length?([g,w]=v,l=p(g,w),d):[l(0),l(1)]}}return d.range=m(Jc),d.rangeRound=m(K2),d.unknown=function(p){return arguments.length?(h=p,d):h},function(p){return i=p,r=p(e),n=p(t),a=r===n?0:1/(n-r),d}}function Sl(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function RD(){var e=wl(yp()(Cn));return e.copy=function(){return Sl(e,RD())},Es.apply(e,arguments)}function MD(){var e=X2(yp()).domain([1,10]);return e.copy=function(){return Sl(e,MD()).base(e.base())},Es.apply(e,arguments)}function FD(){var e=Z2(yp());return e.copy=function(){return Sl(e,FD()).constant(e.constant())},Es.apply(e,arguments)}function ow(){var e=Q2(yp());return e.copy=function(){return Sl(e,ow()).exponent(e.exponent())},Es.apply(e,arguments)}function bte(){return ow.apply(null,arguments).exponent(.5)}function ID(){var e=[],t=Cn;function r(n){if(n!=null&&!isNaN(n=+n))return t((Ed(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(hl),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>iJ(e,i/n))},r.copy=function(){return ID(t).domain(e)},Es.apply(r,arguments)}function bp(){var e=0,t=.5,r=1,n=1,a,i,l,u,h,d=Cn,m,p=!1,v;function g(b){return isNaN(b=+b)?v:(b=.5+((b=+m(b))-i)*(n*b<n*i?u:h),d(p?Math.max(0,Math.min(1,b)):b))}g.domain=function(b){return arguments.length?([e,t,r]=b,a=m(e=+e),i=m(t=+t),l=m(r=+r),u=a===i?0:.5/(i-a),h=i===l?0:.5/(l-i),n=i<a?-1:1,g):[e,t,r]},g.clamp=function(b){return arguments.length?(p=!!b,g):p},g.interpolator=function(b){return arguments.length?(d=b,g):d};function w(b){return function(S){var j,_,A;return arguments.length?([j,_,A]=S,d=DJ(b,[j,_,A]),g):[d(0),d(.5),d(1)]}}return g.range=w(Jc),g.rangeRound=w(K2),g.unknown=function(b){return arguments.length?(v=b,g):v},function(b){return m=b,a=b(e),i=b(t),l=b(r),u=a===i?0:.5/(i-a),h=i===l?0:.5/(l-i),n=i<a?-1:1,g}}function LD(){var e=wl(bp()(Cn));return e.copy=function(){return Sl(e,LD())},Es.apply(e,arguments)}function BD(){var e=X2(bp()).domain([.1,1,10]);return e.copy=function(){return Sl(e,BD()).base(e.base())},Es.apply(e,arguments)}function UD(){var e=Z2(bp());return e.copy=function(){return Sl(e,UD()).constant(e.constant())},Es.apply(e,arguments)}function cw(){var e=Q2(bp());return e.copy=function(){return Sl(e,cw()).exponent(e.exponent())},Es.apply(e,arguments)}function wte(){return cw.apply(null,arguments).exponent(.5)}const Sf=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:H2,scaleDiverging:LD,scaleDivergingLog:BD,scaleDivergingPow:cw,scaleDivergingSqrt:wte,scaleDivergingSymlog:UD,scaleIdentity:gD,scaleImplicit:rb,scaleLinear:vD,scaleLog:bD,scaleOrdinal:z2,scalePoint:oJ,scalePow:J2,scaleQuantile:ED,scaleQuantize:jD,scaleRadial:SD,scaleSequential:RD,scaleSequentialLog:MD,scaleSequentialPow:ow,scaleSequentialQuantile:ID,scaleSequentialSqrt:bte,scaleSequentialSymlog:FD,scaleSqrt:tee,scaleSymlog:wD,scaleThreshold:ND,scaleTime:gte,scaleUtc:yte,tickFormat:xD},Symbol.toStringTag,{value:"Module"}));var El=e=>e.chartData,wp=Te([El],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),Sp=(e,t,r,n)=>n?wp(e):El(e);function Uc(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(va(t)&&va(r))return!0}return!1}function hk(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function Ste(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,a,i;if(va(r))a=r;else if(typeof r=="function")return;if(va(n))i=n;else if(typeof n=="function")return;var l=[a,i];if(Uc(l))return l}}function Ete(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(Uc(n))return hk(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[a,i]=e,l,u;if(a==="auto")t!=null&&(l=Math.min(...t));else if(rt(a))l=a;else if(typeof a=="function")try{t!=null&&(l=a(t?.[0]))}catch{}else if(typeof a=="string"&&e4.test(a)){var h=e4.exec(a);if(h==null||t==null)l=void 0;else{var d=+h[1];l=t[0]-d}}else l=t?.[0];if(i==="auto")t!=null&&(u=Math.max(...t));else if(rt(i))u=i;else if(typeof i=="function")try{t!=null&&(u=i(t?.[1]))}catch{}else if(typeof i=="string"&&t4.test(i)){var m=t4.exec(i);if(m==null||t==null)u=void 0;else{var p=+m[1];u=t[1]+p}}else u=t?.[1];var v=[l,u];if(Uc(v))return t==null?v:hk(v,t,r)}}}var eu=1e9,jte={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},fw,rr=!0,Va="[DecimalError] ",ho=Va+"Invalid argument: ",uw=Va+"Exponent out of range: ",tu=Math.floor,Xl=Math.pow,Nte=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,ca,zr=1e7,Qt=7,$D=9007199254740991,Em=tu($D/Qt),nt={};nt.absoluteValue=nt.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};nt.comparedTo=nt.cmp=function(e){var t,r,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};nt.decimalPlaces=nt.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*Qt;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};nt.dividedBy=nt.div=function(e){return us(this,new this.constructor(e))};nt.dividedToIntegerBy=nt.idiv=function(e){var t=this,r=t.constructor;return Gt(us(t,new r(e),0,1),r.precision)};nt.equals=nt.eq=function(e){return!this.cmp(e)};nt.exponent=function(){return Tr(this)};nt.greaterThan=nt.gt=function(e){return this.cmp(e)>0};nt.greaterThanOrEqualTo=nt.gte=function(e){return this.cmp(e)>=0};nt.isInteger=nt.isint=function(){return this.e>this.d.length-2};nt.isNegative=nt.isneg=function(){return this.s<0};nt.isPositive=nt.ispos=function(){return this.s>0};nt.isZero=function(){return this.s===0};nt.lessThan=nt.lt=function(e){return this.cmp(e)<0};nt.lessThanOrEqualTo=nt.lte=function(e){return this.cmp(e)<1};nt.logarithm=nt.log=function(e){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(ca))throw Error(Va+"NaN");if(r.s<1)throw Error(Va+(r.s?"NaN":"-Infinity"));return r.eq(ca)?new n(0):(rr=!1,t=us(ad(r,i),ad(e,i),i),rr=!0,Gt(t,a))};nt.minus=nt.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?qD(t,e):zD(t,(e.s=-e.s,e))};nt.modulo=nt.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(Va+"NaN");return r.s?(rr=!1,t=us(r,e,0,1).times(e),rr=!0,r.minus(t)):Gt(new n(r),a)};nt.naturalExponential=nt.exp=function(){return HD(this)};nt.naturalLogarithm=nt.ln=function(){return ad(this)};nt.negated=nt.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};nt.plus=nt.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?zD(t,e):qD(t,(e.s=-e.s,e))};nt.precision=nt.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(ho+e);if(t=Tr(a)+1,n=a.d.length-1,r=n*Qt+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};nt.squareRoot=nt.sqrt=function(){var e,t,r,n,a,i,l,u=this,h=u.constructor;if(u.s<1){if(!u.s)return new h(0);throw Error(Va+"NaN")}for(e=Tr(u),rr=!1,a=Math.sqrt(+u),a==0||a==1/0?(t=_i(u.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=tu((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new h(t)):n=new h(a.toString()),r=h.precision,a=l=r+3;;)if(i=n,n=i.plus(us(u,i,l+2)).times(.5),_i(i.d).slice(0,l)===(t=_i(n.d)).slice(0,l)){if(t=t.slice(l-3,l+1),a==l&&t=="4999"){if(Gt(i,r+1,0),i.times(i).eq(u)){n=i;break}}else if(t!="9999")break;l+=4}return rr=!0,Gt(n,r)};nt.times=nt.mul=function(e){var t,r,n,a,i,l,u,h,d,m=this,p=m.constructor,v=m.d,g=(e=new p(e)).d;if(!m.s||!e.s)return new p(0);for(e.s*=m.s,r=m.e+e.e,h=v.length,d=g.length,h<d&&(i=v,v=g,g=i,l=h,h=d,d=l),i=[],l=h+d,n=l;n--;)i.push(0);for(n=d;--n>=0;){for(t=0,a=h+n;a>n;)u=i[a]+g[n]*v[a-n-1]+t,i[a--]=u%zr|0,t=u/zr|0;i[a]=(i[a]+t)%zr|0}for(;!i[--l];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,rr?Gt(e,p.precision):e};nt.toDecimalPlaces=nt.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Di(e,0,eu),t===void 0?t=n.rounding:Di(t,0,8),Gt(r,e+Tr(r)+1,t))};nt.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=bo(n,!0):(Di(e,0,eu),t===void 0?t=a.rounding:Di(t,0,8),n=Gt(new a(n),e+1,t),r=bo(n,!0,e+1)),r};nt.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?bo(a):(Di(e,0,eu),t===void 0?t=i.rounding:Di(t,0,8),n=Gt(new i(a),e+Tr(a)+1,t),r=bo(n.abs(),!1,e+Tr(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};nt.toInteger=nt.toint=function(){var e=this,t=e.constructor;return Gt(new t(e),Tr(e)+1,t.rounding)};nt.toNumber=function(){return+this};nt.toPower=nt.pow=function(e){var t,r,n,a,i,l,u=this,h=u.constructor,d=12,m=+(e=new h(e));if(!e.s)return new h(ca);if(u=new h(u),!u.s){if(e.s<1)throw Error(Va+"Infinity");return u}if(u.eq(ca))return u;if(n=h.precision,e.eq(ca))return Gt(u,n);if(t=e.e,r=e.d.length-1,l=t>=r,i=u.s,l){if((r=m<0?-m:m)<=$D){for(a=new h(ca),t=Math.ceil(n/Qt+4),rr=!1;r%2&&(a=a.times(u),pk(a.d,t)),r=tu(r/2),r!==0;)u=u.times(u),pk(u.d,t);return rr=!0,e.s<0?new h(ca).div(a):Gt(a,n)}}else if(i<0)throw Error(Va+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,u.s=1,rr=!1,a=e.times(ad(u,n+d)),rr=!0,a=HD(a),a.s=i,a};nt.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?(r=Tr(a),n=bo(a,r<=i.toExpNeg||r>=i.toExpPos)):(Di(e,1,eu),t===void 0?t=i.rounding:Di(t,0,8),a=Gt(new i(a),e,t),r=Tr(a),n=bo(a,e<=r||r<=i.toExpNeg,e)),n};nt.toSignificantDigits=nt.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Di(e,1,eu),t===void 0?t=n.rounding:Di(t,0,8)),Gt(new n(r),e,t)};nt.toString=nt.valueOf=nt.val=nt.toJSON=nt[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Tr(e),r=e.constructor;return bo(e,t<=r.toExpNeg||t>=r.toExpPos)};function zD(e,t){var r,n,a,i,l,u,h,d,m=e.constructor,p=m.precision;if(!e.s||!t.s)return t.s||(t=new m(e)),rr?Gt(t,p):t;if(h=e.d,d=t.d,l=e.e,a=t.e,h=h.slice(),i=l-a,i){for(i<0?(n=h,i=-i,u=d.length):(n=d,a=l,u=h.length),l=Math.ceil(p/Qt),u=l>u?l+1:u+1,i>u&&(i=u,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(u=h.length,i=d.length,u-i<0&&(i=u,n=d,d=h,h=n),r=0;i;)r=(h[--i]=h[i]+d[i]+r)/zr|0,h[i]%=zr;for(r&&(h.unshift(r),++a),u=h.length;h[--u]==0;)h.pop();return t.d=h,t.e=a,rr?Gt(t,p):t}function Di(e,t,r){if(e!==~~e||e<t||e>r)throw Error(ho+e)}function _i(e){var t,r,n,a=e.length-1,i="",l=e[0];if(a>0){for(i+=l,t=1;t<a;t++)n=e[t]+"",r=Qt-n.length,r&&(i+=sl(r)),i+=n;l=e[t],n=l+"",r=Qt-n.length,r&&(i+=sl(r))}else if(l===0)return"0";for(;l%10===0;)l/=10;return i+l}var us=function(){function e(n,a){var i,l=0,u=n.length;for(n=n.slice();u--;)i=n[u]*a+l,n[u]=i%zr|0,l=i/zr|0;return l&&n.unshift(l),n}function t(n,a,i,l){var u,h;if(i!=l)h=i>l?1:-1;else for(u=h=0;u<i;u++)if(n[u]!=a[u]){h=n[u]>a[u]?1:-1;break}return h}function r(n,a,i){for(var l=0;i--;)n[i]-=l,l=n[i]<a[i]?1:0,n[i]=l*zr+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,l){var u,h,d,m,p,v,g,w,b,S,j,_,A,k,O,C,T,I,M=n.constructor,W=n.s==a.s?1:-1,U=n.d,F=a.d;if(!n.s)return new M(n);if(!a.s)throw Error(Va+"Division by zero");for(h=n.e-a.e,T=F.length,O=U.length,g=new M(W),w=g.d=[],d=0;F[d]==(U[d]||0);)++d;if(F[d]>(U[d]||0)&&--h,i==null?_=i=M.precision:l?_=i+(Tr(n)-Tr(a))+1:_=i,_<0)return new M(0);if(_=_/Qt+2|0,d=0,T==1)for(m=0,F=F[0],_++;(d<O||m)&&_--;d++)A=m*zr+(U[d]||0),w[d]=A/F|0,m=A%F|0;else{for(m=zr/(F[0]+1)|0,m>1&&(F=e(F,m),U=e(U,m),T=F.length,O=U.length),k=T,b=U.slice(0,T),S=b.length;S<T;)b[S++]=0;I=F.slice(),I.unshift(0),C=F[0],F[1]>=zr/2&&++C;do m=0,u=t(F,b,T,S),u<0?(j=b[0],T!=S&&(j=j*zr+(b[1]||0)),m=j/C|0,m>1?(m>=zr&&(m=zr-1),p=e(F,m),v=p.length,S=b.length,u=t(p,b,v,S),u==1&&(m--,r(p,T<v?I:F,v))):(m==0&&(u=m=1),p=F.slice()),v=p.length,v<S&&p.unshift(0),r(b,p,S),u==-1&&(S=b.length,u=t(F,b,T,S),u<1&&(m++,r(b,T<S?I:F,S))),S=b.length):u===0&&(m++,b=[0]),w[d++]=m,u&&b[0]?b[S++]=U[k]||0:(b=[U[k]],S=1);while((k++<O||b[0]!==void 0)&&_--)}return w[0]||w.shift(),g.e=h,Gt(g,l?i+Tr(g)+1:i)}}();function HD(e,t){var r,n,a,i,l,u,h=0,d=0,m=e.constructor,p=m.precision;if(Tr(e)>16)throw Error(uw+Tr(e));if(!e.s)return new m(ca);for(rr=!1,u=p,l=new m(.03125);e.abs().gte(.1);)e=e.times(l),d+=5;for(n=Math.log(Xl(2,d))/Math.LN10*2+5|0,u+=n,r=a=i=new m(ca),m.precision=u;;){if(a=Gt(a.times(e),u),r=r.times(++h),l=i.plus(us(a,r,u)),_i(l.d).slice(0,u)===_i(i.d).slice(0,u)){for(;d--;)i=Gt(i.times(i),u);return m.precision=p,t==null?(rr=!0,Gt(i,p)):i}i=l}}function Tr(e){for(var t=e.e*Qt,r=e.d[0];r>=10;r/=10)t++;return t}function B1(e,t,r){if(t>e.LN10.sd())throw rr=!0,r&&(e.precision=r),Error(Va+"LN10 precision limit exceeded");return Gt(new e(e.LN10),t)}function sl(e){for(var t="";e--;)t+="0";return t}function ad(e,t){var r,n,a,i,l,u,h,d,m,p=1,v=10,g=e,w=g.d,b=g.constructor,S=b.precision;if(g.s<1)throw Error(Va+(g.s?"NaN":"-Infinity"));if(g.eq(ca))return new b(0);if(t==null?(rr=!1,d=S):d=t,g.eq(10))return t==null&&(rr=!0),B1(b,d);if(d+=v,b.precision=d,r=_i(w),n=r.charAt(0),i=Tr(g),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)g=g.times(e),r=_i(g.d),n=r.charAt(0),p++;i=Tr(g),n>1?(g=new b("0."+r),i++):g=new b(n+"."+r.slice(1))}else return h=B1(b,d+2,S).times(i+""),g=ad(new b(n+"."+r.slice(1)),d-v).plus(h),b.precision=S,t==null?(rr=!0,Gt(g,S)):g;for(u=l=g=us(g.minus(ca),g.plus(ca),d),m=Gt(g.times(g),d),a=3;;){if(l=Gt(l.times(m),d),h=u.plus(us(l,new b(a),d)),_i(h.d).slice(0,d)===_i(u.d).slice(0,d))return u=u.times(2),i!==0&&(u=u.plus(B1(b,d+2,S).times(i+""))),u=us(u,new b(p),d),b.precision=S,t==null?(rr=!0,Gt(u,S)):u;u=h,a+=2}}function mk(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=tu(r/Qt),e.d=[],n=(r+1)%Qt,r<0&&(n+=Qt),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=Qt;n<a;)e.d.push(+t.slice(n,n+=Qt));t=t.slice(n),n=Qt-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),rr&&(e.e>Em||e.e<-Em))throw Error(uw+r)}else e.s=0,e.e=0,e.d=[0];return e}function Gt(e,t,r){var n,a,i,l,u,h,d,m,p=e.d;for(l=1,i=p[0];i>=10;i/=10)l++;if(n=t-l,n<0)n+=Qt,a=t,d=p[m=0];else{if(m=Math.ceil((n+1)/Qt),i=p.length,m>=i)return e;for(d=i=p[m],l=1;i>=10;i/=10)l++;n%=Qt,a=n-Qt+l}if(r!==void 0&&(i=Xl(10,l-a-1),u=d/i%10|0,h=t<0||p[m+1]!==void 0||d%i,h=r<4?(u||h)&&(r==0||r==(e.s<0?3:2)):u>5||u==5&&(r==4||h||r==6&&(n>0?a>0?d/Xl(10,l-a):0:p[m-1])%10&1||r==(e.s<0?8:7))),t<1||!p[0])return h?(i=Tr(e),p.length=1,t=t-i-1,p[0]=Xl(10,(Qt-t%Qt)%Qt),e.e=tu(-t/Qt)||0):(p.length=1,p[0]=e.e=e.s=0),e;if(n==0?(p.length=m,i=1,m--):(p.length=m+1,i=Xl(10,Qt-n),p[m]=a>0?(d/Xl(10,l-a)%Xl(10,a)|0)*i:0),h)for(;;)if(m==0){(p[0]+=i)==zr&&(p[0]=1,++e.e);break}else{if(p[m]+=i,p[m]!=zr)break;p[m--]=0,i=1}for(n=p.length;p[--n]===0;)p.pop();if(rr&&(e.e>Em||e.e<-Em))throw Error(uw+Tr(e));return e}function qD(e,t){var r,n,a,i,l,u,h,d,m,p,v=e.constructor,g=v.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new v(e),rr?Gt(t,g):t;if(h=e.d,p=t.d,n=t.e,d=e.e,h=h.slice(),l=d-n,l){for(m=l<0,m?(r=h,l=-l,u=p.length):(r=p,n=d,u=h.length),a=Math.max(Math.ceil(g/Qt),u)+2,l>a&&(l=a,r.length=1),r.reverse(),a=l;a--;)r.push(0);r.reverse()}else{for(a=h.length,u=p.length,m=a<u,m&&(u=a),a=0;a<u;a++)if(h[a]!=p[a]){m=h[a]<p[a];break}l=0}for(m&&(r=h,h=p,p=r,t.s=-t.s),u=h.length,a=p.length-u;a>0;--a)h[u++]=0;for(a=p.length;a>l;){if(h[--a]<p[a]){for(i=a;i&&h[--i]===0;)h[i]=zr-1;--h[i],h[a]+=zr}h[a]-=p[a]}for(;h[--u]===0;)h.pop();for(;h[0]===0;h.shift())--n;return h[0]?(t.d=h,t.e=n,rr?Gt(t,g):t):new v(0)}function bo(e,t,r){var n,a=Tr(e),i=_i(e.d),l=i.length;return t?(r&&(n=r-l)>0?i=i.charAt(0)+"."+i.slice(1)+sl(n):l>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+sl(-a-1)+i,r&&(n=r-l)>0&&(i+=sl(n))):a>=l?(i+=sl(a+1-l),r&&(n=r-a-1)>0&&(i=i+"."+sl(n))):((n=a+1)<l&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-l)>0&&(a+1===l&&(i+="."),i+=sl(n))),e.s<0?"-"+i:i}function pk(e,t){if(e.length>t)return e.length=t,!0}function VD(e){var t,r,n;function a(i){var l=this;if(!(l instanceof a))return new a(i);if(l.constructor=a,i instanceof a){l.s=i.s,l.e=i.e,l.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(ho+i);if(i>0)l.s=1;else if(i<0)i=-i,l.s=-1;else{l.s=0,l.e=0,l.d=[0];return}if(i===~~i&&i<1e7){l.e=0,l.d=[i];return}return mk(l,i.toString())}else if(typeof i!="string")throw Error(ho+i);if(i.charCodeAt(0)===45?(i=i.slice(1),l.s=-1):l.s=1,Nte.test(i))mk(l,i);else throw Error(ho+i)}if(a.prototype=nt,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=VD,a.config=a.set=Ate,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function Ate(e){if(!e||typeof e!="object")throw Error(Va+"Object expected");var t,r,n,a=["precision",1,eu,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(tu(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(ho+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(ho+r+": "+n);return this}var fw=VD(jte);ca=new fw(1);const Bt=fw;var _te=e=>e,KD={},GD=e=>e===KD,xk=e=>function t(){return arguments.length===0||arguments.length===1&&GD(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},WD=(e,t)=>e===1?t:xk(function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var i=n.filter(l=>l!==KD).length;return i>=e?t(...n):WD(e-i,xk(function(){for(var l=arguments.length,u=new Array(l),h=0;h<l;h++)u[h]=arguments[h];var d=n.map(m=>GD(m)?u.shift():m);return t(...d,...u)}))}),Ep=e=>WD(e.length,e),sb=(e,t)=>{for(var r=[],n=e;n<t;++n)r[n-e]=n;return r},Tte=Ep((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),kte=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return _te;var a=r.reverse(),i=a[0],l=a.slice(1);return function(){return l.reduce((u,h)=>h(u),i(...arguments))}},lb=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),YD=e=>{var t=null,r=null;return function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return t&&a.every((l,u)=>{var h;return l===((h=t)===null||h===void 0?void 0:h[u])})||(t=a,r=e(...a)),r}};function XD(e){var t;return e===0?t=1:t=Math.floor(new Bt(e).abs().log(10).toNumber())+1,t}function ZD(e,t,r){for(var n=new Bt(e),a=0,i=[];n.lt(t)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}Ep((e,t,r)=>{var n=+e,a=+t;return n+r*(a-n)});Ep((e,t,r)=>{var n=t-+e;return n=n||1/0,(r-e)/n});Ep((e,t,r)=>{var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});var QD=e=>{var[t,r]=e,[n,a]=[t,r];return t>r&&([n,a]=[r,t]),[n,a]},JD=(e,t,r)=>{if(e.lte(0))return new Bt(0);var n=XD(e.toNumber()),a=new Bt(10).pow(n),i=e.div(a),l=n!==1?.05:.1,u=new Bt(Math.ceil(i.div(l).toNumber())).add(r).mul(l),h=u.mul(a);return t?new Bt(h.toNumber()):new Bt(Math.ceil(h.toNumber()))},Cte=(e,t,r)=>{var n=new Bt(1),a=new Bt(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(n=new Bt(10).pow(XD(e)-1),a=new Bt(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new Bt(Math.floor(e)))}else e===0?a=new Bt(Math.floor((t-1)/2)):r||(a=new Bt(Math.floor(e)));var l=Math.floor((t-1)/2),u=kte(Tte(h=>a.add(new Bt(h-l).mul(n)).toNumber()),sb);return u(0,t)},eP=function(t,r,n,a){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new Bt(0),tickMin:new Bt(0),tickMax:new Bt(0)};var l=JD(new Bt(r).sub(t).div(n-1),a,i),u;t<=0&&r>=0?u=new Bt(0):(u=new Bt(t).add(r).div(2),u=u.sub(new Bt(u).mod(l)));var h=Math.ceil(u.sub(t).div(l).toNumber()),d=Math.ceil(new Bt(r).sub(u).div(l).toNumber()),m=h+d+1;return m>n?eP(t,r,n,a,i+1):(m<n&&(d=r>0?d+(n-m):d,h=r>0?h:h+(n-m)),{step:l,tickMin:u.sub(new Bt(h).mul(l)),tickMax:u.add(new Bt(d).mul(l))})};function Ote(e){var[t,r]=e,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(n,2),[l,u]=QD([t,r]);if(l===-1/0||u===1/0){var h=u===1/0?[l,...sb(0,n-1).map(()=>1/0)]:[...sb(0,n-1).map(()=>-1/0),u];return t>r?lb(h):h}if(l===u)return Cte(l,n,a);var{step:d,tickMin:m,tickMax:p}=eP(l,u,i,a,0),v=ZD(m,p.add(new Bt(.1).mul(d)),d);return t>r?lb(v):v}function Dte(e,t){var[r,n]=e,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[i,l]=QD([r,n]);if(i===-1/0||l===1/0)return[r,n];if(i===l)return[i];var u=Math.max(t,2),h=JD(new Bt(l).sub(i).div(u-1),a,0),d=[...ZD(new Bt(i),new Bt(l),h),l];return a===!1&&(d=d.map(m=>Math.round(m))),r>n?lb(d):d}var Pte=YD(Ote),Rte=YD(Dte),jp=e=>e.rootProps.maxBarSize,tP=e=>e.rootProps.barGap,dw=e=>e.rootProps.barCategoryGap,rP=e=>e.rootProps.barSize,ru=e=>e.rootProps.stackOffset,hw=e=>e.options.chartName,mw=e=>e.rootProps.syncId,nP=e=>e.rootProps.syncMethod,pw=e=>e.options.eventEmitter,es={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},ia={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},Np=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},Mte={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:es.angleAxisId,includeHidden:!1,name:void 0,reversed:es.reversed,scale:es.scale,tick:es.tick,tickCount:void 0,ticks:void 0,type:es.type,unit:void 0},Fte={allowDataOverflow:ia.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:ia.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:ia.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:ia.scale,tick:ia.tick,tickCount:ia.tickCount,ticks:void 0,type:ia.type,unit:void 0},Ite={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:es.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:es.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:es.scale,tick:es.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},Lte={allowDataOverflow:ia.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:ia.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:ia.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:ia.scale,tick:ia.tick,tickCount:ia.tickCount,ticks:void 0,type:"category",unit:void 0},_d=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?Ite:Mte,Td=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?Lte:Fte,Ap=e=>e.polarOptions,xw=Te([bs,ws,Mr],$6),aP=Te([Ap,xw],(e,t)=>{if(e!=null)return Dn(e.innerRadius,t,0)}),iP=Te([Ap,xw],(e,t)=>{if(e!=null)return Dn(e.outerRadius,t,t*.8)}),Bte=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},sP=Te([Ap],Bte),Ute=Te([_d,sP],Np),lP=Te([xw,aP,iP],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]}),$te=Te([Td,lP],Np),oP=Te([gt,Ap,aP,iP,bs,ws],(e,t,r,n,a,i)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:l,cy:u,startAngle:h,endAngle:d}=t;return{cx:Dn(l,a,a/2),cy:Dn(u,i,i/2),innerRadius:r,outerRadius:n,startAngle:h,endAngle:d,clockWise:!1}}}),ir=(e,t)=>t,kd=(e,t,r)=>r;function vk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function jm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vk(Object(r),!0).forEach(function(n){zte(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zte(e,t,r){return(t=Hte(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hte(e){var t=qte(e,"string");return typeof t=="symbol"?t:t+""}function qte(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ob=[0,"auto"],na={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},js=(e,t)=>{var r=e.cartesianAxis.xAxis[t];return r??na},aa={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:ob,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:up},jl=(e,t)=>{var r=e.cartesianAxis.yAxis[t];return r??aa},fl={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},vw=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??fl},xr=(e,t,r)=>{switch(t){case"xAxis":return js(e,r);case"yAxis":return jl(e,r);case"zAxis":return vw(e,r);case"angleAxis":return _d(e,r);case"radiusAxis":return Td(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},Vte=(e,t,r)=>{switch(t){case"xAxis":return js(e,r);case"yAxis":return jl(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},nu=(e,t,r)=>{switch(t){case"xAxis":return js(e,r);case"yAxis":return jl(e,r);case"angleAxis":return _d(e,r);case"radiusAxis":return Td(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},cP=e=>e.graphicalItems.countOfBars>0;function gw(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var Cd=e=>e.graphicalItems.cartesianItems,Kte=Te([ir,kd],gw),yw=(e,t,r)=>e.filter(r).filter(n=>t?.includeHidden===!0?!0:!n.hide),Od=Te([Cd,xr,Kte],yw),uP=e=>e.filter(t=>t.stackId===void 0),Gte=Te([Od],uP),bw=e=>e.map(t=>t.data).filter(Boolean).flat(1),Wte=Te([Od],bw),ww=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:a}=t;return e.length>0?e:r.slice(n,a+1)},_p=Te([Wte,Sp],ww),Sw=(e,t,r)=>t?.dataKey!=null?e.map(n=>({value:Ft(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(a=>({value:Ft(a,n)}))):e.map(n=>({value:n})),Tp=Te([_p,xr,Od],Sw);function fP(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function Do(e){return e.filter(t=>Ci(t)||t instanceof Date).map(Number).filter(t=>ma(t)===!1)}function Yte(e,t,r){return!r||typeof t!="number"||ma(t)?[]:r.length?Do(r.flatMap(n=>{var a=Ft(e,n.dataKey),i,l;if(Array.isArray(a)?[i,l]=a:i=l=a,!(!va(i)||!va(l)))return[t-i,t+l]})):[]}var Ew=(e,t,r)=>{var n={},a=t.reduce((i,l)=>(l.stackId==null||(i[l.stackId]==null&&(i[l.stackId]=[]),i[l.stackId].push(l)),i),n);return Object.fromEntries(Object.entries(a).map(i=>{var[l,u]=i,h=u.map(d=>d.dataKey);return[l,{stackedData:QX(e,h,r),graphicalItems:u}]}))},cb=Te([_p,Od,ru],Ew),dP=(e,t,r)=>{var{dataStartIndex:n,dataEndIndex:a}=t;if(r!=="zAxis"){var i=tZ(e,n,a);if(!(i!=null&&i[0]===0&&i[1]===0))return i}},Xte=Te([cb,El,ir],dP),hP=(e,t,r,n)=>r.length>0?e.flatMap(a=>r.flatMap(i=>{var l,u,h=(l=i.errorBars)===null||l===void 0?void 0:l.filter(m=>fP(n,m)),d=Ft(a,(u=t.dataKey)!==null&&u!==void 0?u:i.dataKey);return{value:d,errorDomain:Yte(a,d,h)}})).filter(Boolean):t?.dataKey!=null?e.map(a=>({value:Ft(a,t.dataKey),errorDomain:[]})):e.map(a=>({value:a,errorDomain:[]})),Zte=Te(_p,xr,Gte,ir,hP);function Qte(e){var{value:t}=e;if(Ci(t)||t instanceof Date)return t}var Jte=e=>{var t=e.flatMap(n=>[n.value,n.errorDomain]).flat(1),r=Do(t);if(r.length!==0)return[Math.min(...r),Math.max(...r)]},ere=(e,t,r)=>{var n=e.map(Qte).filter(a=>a!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&I5(n))?sD(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},jw=e=>{var t;if(e==null||!("domain"in e))return ob;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var r=Do(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e?.domain)!==null&&t!==void 0?t:ob},Nw=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r.filter(Boolean);if(a.length!==0){var i=a.flat(),l=Math.min(...i),u=Math.max(...i);return[l,u]}},mP=e=>e.referenceElements.dots,au=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),tre=Te([mP,ir,kd],au),pP=e=>e.referenceElements.areas,rre=Te([pP,ir,kd],au),xP=e=>e.referenceElements.lines,nre=Te([xP,ir,kd],au),vP=(e,t)=>{var r=Do(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},are=Te(tre,ir,vP),gP=(e,t)=>{var r=Do(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},ire=Te([rre,ir],gP),yP=(e,t)=>{var r=Do(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},sre=Te(nre,ir,yP),lre=Te(are,sre,ire,(e,t,r)=>Nw(e,r,t)),bP=Te([xr],jw),Aw=(e,t,r,n,a)=>{var i=Ste(t,e.allowDataOverflow);return i??Ete(t,Nw(r,a,Jte(n)),e.allowDataOverflow)},ore=Te([xr,bP,Xte,Zte,lre],Aw),cre=[0,1],_w=(e,t,r,n,a,i,l)=>{if(!(e==null||r==null||r.length===0)){var{dataKey:u,type:h}=e,d=gs(t,i);return d&&u==null?sD(0,r.length):h==="category"?ere(n,e,d):a==="expand"?cre:l}},Tw=Te([xr,gt,_p,Tp,ru,ir,ore],_w),wP=(e,t,r,n,a)=>{if(e!=null){var{scale:i,type:l}=e;if(i==="auto")return t==="radial"&&a==="radiusAxis"?"band":t==="radial"&&a==="angleAxis"?"linear":l==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":l==="category"?"band":"linear";if(typeof i=="string"){var u="scale".concat(bd(i));return u in Sf?u:"point"}}},Nl=Te([xr,gt,cP,hw,ir],wP);function ure(e){if(e!=null){if(e in Sf)return Sf[e]();var t="scale".concat(bd(e));if(t in Sf)return Sf[t]()}}function kp(e,t,r,n){if(!(r==null||n==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(n);var a=ure(t);if(a!=null){var i=a.domain(r).range(n);return WX(i),i}}}var kw=(e,t,r)=>{var n=jw(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&Uc(e))return Pte(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&Uc(e))return Rte(e,t.tickCount,t.allowDecimals)}},Cw=Te([Tw,nu,Nl],kw),Ow=(e,t,r,n)=>{if(n!=="angleAxis"&&e?.type==="number"&&Uc(t)&&Array.isArray(r)&&r.length>0){var a=t[0],i=r[0],l=t[1],u=r[r.length-1];return[Math.min(a,i),Math.max(l,u)]}return t},fre=Te([xr,Tw,Cw,ir],Ow),dre=Te(Tp,xr,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(Do(e.map(u=>u.value))).sort((u,h)=>u-h);if(n.length<2)return 1/0;var a=n[n.length-1]-n[0];if(a===0)return 1/0;for(var i=0;i<n.length-1;i++){var l=n[i+1]-n[i];r=Math.min(r,l)}return r/a}}),SP=Te(dre,gt,dw,Mr,(e,t,r,n)=>n,(e,t,r,n,a)=>{if(!va(e))return 0;var i=t==="vertical"?n.height:n.width;if(a==="gap")return e*i/2;if(a==="no-gap"){var l=Dn(r,e*i),u=e*i/2;return u-l-(u-l)/i*l}return 0}),hre=(e,t)=>{var r=js(e,t);return r==null||typeof r.padding!="string"?0:SP(e,"xAxis",t,r.padding)},mre=(e,t)=>{var r=jl(e,t);return r==null||typeof r.padding!="string"?0:SP(e,"yAxis",t,r.padding)},pre=Te(js,hre,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:a}=e;return typeof a=="string"?{left:t,right:t}:{left:((r=a.left)!==null&&r!==void 0?r:0)+t,right:((n=a.right)!==null&&n!==void 0?n:0)+t}}),xre=Te(jl,mre,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:a}=e;return typeof a=="string"?{top:t,bottom:t}:{top:((r=a.top)!==null&&r!==void 0?r:0)+t,bottom:((n=a.bottom)!==null&&n!==void 0?n:0)+t}}),vre=Te([Mr,pre,dp,fp,(e,t,r)=>r],(e,t,r,n,a)=>{var{padding:i}=n;return a?[i.left,r.width-i.right]:[e.left+t.left,e.left+e.width-t.right]}),gre=Te([Mr,gt,xre,dp,fp,(e,t,r)=>r],(e,t,r,n,a,i)=>{var{padding:l}=a;return i?[n.height-l.bottom,l.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),Dd=(e,t,r,n)=>{var a;switch(t){case"xAxis":return vre(e,r,n);case"yAxis":return gre(e,r,n);case"zAxis":return(a=vw(e,r))===null||a===void 0?void 0:a.range;case"angleAxis":return sP(e);case"radiusAxis":return lP(e,r);default:return}},EP=Te([xr,Dd],Np),iu=Te([xr,Nl,fre,EP],kp);Te(Od,ir,(e,t)=>e.flatMap(r=>{var n;return(n=r.errorBars)!==null&&n!==void 0?n:[]}).filter(r=>fP(t,r)));function jP(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var Cp=(e,t)=>t,Op=(e,t,r)=>r,yre=Te(D2,Cp,Op,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(jP)),bre=Te(P2,Cp,Op,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(jP)),NP=(e,t)=>({width:e.width,height:t.height}),wre=(e,t)=>{var r=typeof t.width=="number"?t.width:up;return{width:r,height:e.height}},AP=Te(Mr,js,NP),Sre=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},Ere=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},jre=Te(ws,Mr,yre,Cp,Op,(e,t,r,n,a)=>{var i={},l;return r.forEach(u=>{var h=NP(t,u);l==null&&(l=Sre(t,n,e));var d=n==="top"&&!a||n==="bottom"&&a;i[u.id]=l-Number(d)*h.height,l+=(d?-1:1)*h.height}),i}),Nre=Te(bs,Mr,bre,Cp,Op,(e,t,r,n,a)=>{var i={},l;return r.forEach(u=>{var h=wre(t,u);l==null&&(l=Ere(t,n,e));var d=n==="left"&&!a||n==="right"&&a;i[u.id]=l-Number(d)*h.width,l+=(d?-1:1)*h.width}),i}),Are=(e,t)=>{var r=Mr(e),n=js(e,t);if(n!=null){var a=jre(e,n.orientation,n.mirror),i=a[t];return i==null?{x:r.left,y:0}:{x:r.left,y:i}}},_re=(e,t)=>{var r=Mr(e),n=jl(e,t);if(n!=null){var a=Nre(e,n.orientation,n.mirror),i=a[t];return i==null?{x:0,y:r.top}:{x:i,y:r.top}}},_P=Te(Mr,jl,(e,t)=>{var r=typeof t.width=="number"?t.width:up;return{width:r,height:e.height}}),gk=(e,t,r)=>{switch(t){case"xAxis":return AP(e,r).width;case"yAxis":return _P(e,r).height;default:return}},TP=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:a,type:i,dataKey:l}=r,u=gs(e,n),h=t.map(d=>d.value);if(l&&u&&i==="category"&&a&&I5(h))return h}},Pd=Te([gt,Tp,xr,ir],TP),Dw=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:a,scale:i}=r,l=gs(e,n);if(l&&(a==="number"||i!=="auto"))return t.map(u=>u.value)}},Pw=Te([gt,Tp,nu,ir],Dw),yk=Te([gt,Vte,Nl,iu,Pd,Pw,Dd,Cw,ir],(e,t,r,n,a,i,l,u,h)=>{if(t==null)return null;var d=gs(e,h);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:h,categoricalDomain:i,duplicateDomain:a,isCategorical:d,niceTicks:u,range:l,realScaleType:r,scale:n}}),kP=(e,t,r,n,a,i,l,u,h)=>{if(!(t==null||n==null)){var d=gs(e,h),{type:m,ticks:p,tickCount:v}=t,g=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,w=m==="category"&&n.bandwidth?n.bandwidth()/g:0;w=h==="angleAxis"&&i!=null&&i.length>=2?Ar(i[0]-i[1])*2*w:w;var b=p||a;if(b){var S=b.map((j,_)=>{var A=l?l.indexOf(j):j;return{index:_,coordinate:n(A)+w,value:j,offset:w}});return S.filter(j=>!ma(j.coordinate))}return d&&u?u.map((j,_)=>({coordinate:n(j)+w,value:j,index:_,offset:w})):n.ticks?n.ticks(v).map(j=>({coordinate:n(j)+w,value:j,offset:w})):n.domain().map((j,_)=>({coordinate:n(j)+w,value:l?l[j]:j,index:_,offset:w}))}},CP=Te([gt,nu,Nl,iu,Cw,Dd,Pd,Pw,ir],kP),OP=(e,t,r,n,a,i,l)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var u=gs(e,l),{tickCount:h}=t,d=0;return d=l==="angleAxis"&&n?.length>=2?Ar(n[0]-n[1])*2*d:d,u&&i?i.map((m,p)=>({coordinate:r(m)+d,value:m,index:p,offset:d})):r.ticks?r.ticks(h).map(m=>({coordinate:r(m)+d,value:m,offset:d})):r.domain().map((m,p)=>({coordinate:r(m)+d,value:a?a[m]:m,index:p,offset:d}))}},Pi=Te([gt,nu,iu,Dd,Pd,Pw,ir],OP),Ka=Te(xr,iu,(e,t)=>{if(!(e==null||t==null))return jm(jm({},e),{},{scale:t})}),Tre=Te([xr,Nl,Tw,EP],kp),kre=Te((e,t,r)=>vw(e,r),Tre,(e,t)=>{if(!(e==null||t==null))return jm(jm({},e),{},{scale:t})}),Cre=Te([gt,D2,P2],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),DP=e=>e.options.defaultTooltipEventType,PP=e=>e.options.validateTooltipEventTypes;function RP(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function Rw(e,t){var r=DP(e),n=PP(e);return RP(t,r,n)}function Ore(e){return et(t=>Rw(t,e))}var MP=(e,t)=>{var r,n=Number(t);if(!(ma(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},Dre=e=>e.tooltip.settings,ol={active:!1,index:null,dataKey:void 0,coordinate:void 0},Pre={itemInteraction:{click:ol,hover:ol},axisInteraction:{click:ol,hover:ol},keyboardInteraction:ol,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},FP=Xa({name:"tooltip",initialState:Pre,reducers:{addTooltipEntrySettings(e,t){e.tooltipItemPayloads.push(t.payload)},removeTooltipEntrySettings(e,t){var r=cs(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:Rre,removeTooltipEntrySettings:Mre,setTooltipSettingsState:Fre,setActiveMouseOverItemIndex:IP,mouseLeaveItem:Ire,mouseLeaveChart:LP,setActiveClickItemIndex:Lre,setMouseOverAxisIndex:BP,setMouseClickAxisIndex:Bre,setSyncInteraction:ub,setKeyboardInteraction:fb}=FP.actions,Ure=FP.reducer;function bk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function wh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bk(Object(r),!0).forEach(function(n){$re(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $re(e,t,r){return(t=zre(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zre(e){var t=Hre(e,"string");return typeof t=="symbol"?t:t+""}function Hre(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qre(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function Vre(e){return e.index!=null}var UP=(e,t,r,n)=>{if(t==null)return ol;var a=qre(e,t,r);if(a==null)return ol;if(a.active)return a;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var i=e.settings.active===!0;if(Vre(a)){if(i)return wh(wh({},a),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n};return wh(wh({},ol),{},{coordinate:a.coordinate})},Mw=(e,t)=>{var r=e?.index;if(r==null)return null;var n=Number(r);if(!va(n))return r;var a=0,i=1/0;return t.length>0&&(i=t.length-1),String(Math.max(a,Math.min(n,i)))},$P=(e,t,r,n,a,i,l,u)=>{if(!(i==null||u==null)){var h=l[0],d=h==null?void 0:u(h.positions,i);if(d!=null)return d;var m=a?.[Number(i)];if(m)switch(r){case"horizontal":return{x:m.coordinate,y:(n.top+t)/2};default:return{x:(n.left+e)/2,y:m.coordinate}}}},zP=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var a;return r==="hover"?a=e.itemInteraction.hover.dataKey:a=e.itemInteraction.click.dataKey,a==null&&n!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(i=>{var l;return((l=i.settings)===null||l===void 0?void 0:l.dataKey)===a})},Rd=e=>e.options.tooltipPayloadSearcher,su=e=>e.tooltip;function wk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Sk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wk(Object(r),!0).forEach(function(n){Kre(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Kre(e,t,r){return(t=Gre(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gre(e){var t=Wre(e,"string");return typeof t=="symbol"?t:t+""}function Wre(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yre(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function Xre(e,t){return e??t}var HP=(e,t,r,n,a,i,l)=>{if(!(t==null||i==null)){var{chartData:u,computedData:h,dataStartIndex:d,dataEndIndex:m}=r,p=[];return e.reduce((v,g)=>{var w,{dataDefinedOnItem:b,settings:S}=g,j=Xre(b,u),_=Yre(j,d,m),A=(w=S?.dataKey)!==null&&w!==void 0?w:n?.dataKey,k=S?.nameKey,O;if(n!=null&&n.dataKey&&Array.isArray(_)&&!Array.isArray(_[0])&&l==="axis"?O=L5(_,n.dataKey,a):O=i(_,t,h,k),Array.isArray(O))O.forEach(T=>{var I=Sk(Sk({},S),{},{name:T.name,unit:T.unit,color:void 0,fill:void 0});v.push(r4({tooltipEntrySettings:I,dataKey:T.dataKey,payload:T.payload,value:Ft(T.payload,T.dataKey),name:T.name}))});else{var C;v.push(r4({tooltipEntrySettings:S,dataKey:A,payload:O,value:Ft(O,A),name:(C=Ft(O,k))!==null&&C!==void 0?C:S?.name}))}return v},p)}},Kr=e=>{var t=gt(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},lu=e=>e.tooltip.settings.axisId,rn=e=>{var t=Kr(e),r=lu(e);return nu(e,t,r)},Fw=Te([rn,gt,cP,hw,Kr],wP),Zre=Te([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),Qre=Te([Kr,lu],gw),Dp=Te([Zre,rn,Qre],yw),Jre=Te([Dp],bw),Po=Te([Jre,El],ww),Iw=Te([Po,rn,Dp],Sw),ene=Te([rn],jw),tne=Te([Po,Dp,ru],Ew),rne=Te([tne,El,Kr],dP),nne=Te([Dp],uP),ane=Te([Po,rn,nne,Kr],hP),ine=Te([mP,Kr,lu],au),sne=Te([ine,Kr],vP),lne=Te([pP,Kr,lu],au),one=Te([lne,Kr],gP),cne=Te([xP,Kr,lu],au),une=Te([cne,Kr],yP),fne=Te([sne,une,one],Nw),dne=Te([rn,ene,rne,ane,fne],Aw),qP=Te([rn,gt,Po,Iw,ru,Kr,dne],_w),hne=Te([qP,rn,Fw],kw),mne=Te([rn,qP,hne,Kr],Ow),VP=e=>{var t=Kr(e),r=lu(e),n=!1;return Dd(e,t,r,n)},KP=Te([rn,VP],Np),GP=Te([rn,Fw,mne,KP],kp),pne=Te([gt,Iw,rn,Kr],TP),xne=Te([gt,Iw,rn,Kr],Dw),vne=(e,t,r,n,a,i,l,u)=>{if(t){var{type:h}=t,d=gs(e,u);if(n){var m=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,p=h==="category"&&n.bandwidth?n.bandwidth()/m:0;return p=u==="angleAxis"&&a!=null&&a?.length>=2?Ar(a[0]-a[1])*2*p:p,d&&l?l.map((v,g)=>({coordinate:n(v)+p,value:v,index:g,offset:p})):n.domain().map((v,g)=>({coordinate:n(v)+p,value:i?i[v]:v,index:g,offset:p}))}}},Ns=Te([gt,rn,Fw,GP,VP,pne,xne,Kr],vne),Lw=Te([DP,PP,Dre],(e,t,r)=>RP(r.shared,e,t)),WP=e=>e.tooltip.settings.trigger,Bw=e=>e.tooltip.settings.defaultIndex,Pp=Te([su,Lw,WP,Bw],UP),Ri=Te([Pp,Po],Mw),YP=Te([Ns,Ri],MP),XP=Te([Pp],e=>{if(e)return e.dataKey}),ZP=Te([su,Lw,WP,Bw],zP),gne=Te([bs,ws,gt,Mr,Ns,Bw,ZP,Rd],$P),yne=Te([Pp,gne],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),bne=Te([Pp],e=>e.active),wne=Te([ZP,Ri,El,rn,YP,Rd,Lw],HP),Sne=Te([wne],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function Ek(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function jk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ek(Object(r),!0).forEach(function(n){Ene(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ek(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ene(e,t,r){return(t=jne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jne(e){var t=Nne(e,"string");return typeof t=="symbol"?t:t+""}function Nne(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ane=()=>et(rn),_ne=()=>{var e=Ane(),t=et(Ns),r=et(GP);return hs(jk(jk({},e),{},{scale:r}),t)},Tne=()=>et(hw),Uw=(e,t)=>t,QP=(e,t,r)=>r,$w=(e,t,r,n)=>n,kne=Te(Ns,e=>np(e,t=>t.coordinate)),zw=Te([su,Uw,QP,$w],UP),JP=Te([zw,Po],Mw),Cne=(e,t,r)=>{if(t!=null){var n=su(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},eR=Te([su,Uw,QP,$w],zP),Nm=Te([bs,ws,gt,Mr,Ns,$w,eR,Rd],$P),One=Te([zw,Nm],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),tR=Te(Ns,JP,MP),Dne=Te([eR,JP,El,rn,tR,Rd,Uw],HP),Pne=Te([zw],e=>({isActive:e.active,activeIndex:e.index})),Rne=(e,t,r,n,a,i,l,u)=>{if(!(!e||!t||!n||!a||!i)){var h=rZ(e.chartX,e.chartY,t,r,u);if(h){var d=aZ(h,t),m=KX(d,l,i,n,a),p=nZ(t,i,m,h);return{activeIndex:String(m),activeCoordinate:p}}}};function db(){return db=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},db.apply(null,arguments)}function Nk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Sh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Nk(Object(r),!0).forEach(function(n){Mne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Nk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Mne(e,t,r){return(t=Fne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fne(e){var t=Ine(e,"string");return typeof t=="symbol"?t:t+""}function Ine(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Lne(e){var{coordinate:t,payload:r,index:n,offset:a,tooltipAxisBandSize:i,layout:l,cursor:u,tooltipEventType:h,chartName:d}=e,m=t,p=r,v=n;if(!u||!m||d!=="ScatterChart"&&h!=="axis")return null;var g,w;if(d==="ScatterChart")g=m,w=tQ;else if(d==="BarChart")g=rQ(l,m,a,i),w=nD;else if(l==="radial"){var{cx:b,cy:S,radius:j,startAngle:_,endAngle:A}=aD(m);g={cx:b,cy:S,startAngle:_,endAngle:A,innerRadius:j,outerRadius:j},w=Sd}else g={points:zQ(l,m,a)},w=mp;var k=typeof u=="object"&&"className"in u?u.className:void 0,O=Sh(Sh(Sh(Sh({stroke:"#ccc",pointerEvents:"none"},a),g),vt(u,!1)),{},{payload:p,payloadIndex:v,className:Tt("recharts-tooltip-cursor",k)});return y.isValidElement(u)?y.cloneElement(u,O):y.createElement(w,O)}function Bne(e){var t=_ne(),r=Y6(),n=hp(),a=Tne();return y.createElement(Lne,db({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:r,layout:n,tooltipAxisBandSize:t,chartName:a}))}var rR=y.createContext(null),Une=()=>y.useContext(rR),U1={exports:{}},Ak;function $ne(){return Ak||(Ak=1,function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(h,d,m){this.fn=h,this.context=d,this.once=m||!1}function i(h,d,m,p,v){if(typeof m!="function")throw new TypeError("The listener must be a function");var g=new a(m,p||h,v),w=r?r+d:d;return h._events[w]?h._events[w].fn?h._events[w]=[h._events[w],g]:h._events[w].push(g):(h._events[w]=g,h._eventsCount++),h}function l(h,d){--h._eventsCount===0?h._events=new n:delete h._events[d]}function u(){this._events=new n,this._eventsCount=0}u.prototype.eventNames=function(){var d=[],m,p;if(this._eventsCount===0)return d;for(p in m=this._events)t.call(m,p)&&d.push(r?p.slice(1):p);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(m)):d},u.prototype.listeners=function(d){var m=r?r+d:d,p=this._events[m];if(!p)return[];if(p.fn)return[p.fn];for(var v=0,g=p.length,w=new Array(g);v<g;v++)w[v]=p[v].fn;return w},u.prototype.listenerCount=function(d){var m=r?r+d:d,p=this._events[m];return p?p.fn?1:p.length:0},u.prototype.emit=function(d,m,p,v,g,w){var b=r?r+d:d;if(!this._events[b])return!1;var S=this._events[b],j=arguments.length,_,A;if(S.fn){switch(S.once&&this.removeListener(d,S.fn,void 0,!0),j){case 1:return S.fn.call(S.context),!0;case 2:return S.fn.call(S.context,m),!0;case 3:return S.fn.call(S.context,m,p),!0;case 4:return S.fn.call(S.context,m,p,v),!0;case 5:return S.fn.call(S.context,m,p,v,g),!0;case 6:return S.fn.call(S.context,m,p,v,g,w),!0}for(A=1,_=new Array(j-1);A<j;A++)_[A-1]=arguments[A];S.fn.apply(S.context,_)}else{var k=S.length,O;for(A=0;A<k;A++)switch(S[A].once&&this.removeListener(d,S[A].fn,void 0,!0),j){case 1:S[A].fn.call(S[A].context);break;case 2:S[A].fn.call(S[A].context,m);break;case 3:S[A].fn.call(S[A].context,m,p);break;case 4:S[A].fn.call(S[A].context,m,p,v);break;default:if(!_)for(O=1,_=new Array(j-1);O<j;O++)_[O-1]=arguments[O];S[A].fn.apply(S[A].context,_)}}return!0},u.prototype.on=function(d,m,p){return i(this,d,m,p,!1)},u.prototype.once=function(d,m,p){return i(this,d,m,p,!0)},u.prototype.removeListener=function(d,m,p,v){var g=r?r+d:d;if(!this._events[g])return this;if(!m)return l(this,g),this;var w=this._events[g];if(w.fn)w.fn===m&&(!v||w.once)&&(!p||w.context===p)&&l(this,g);else{for(var b=0,S=[],j=w.length;b<j;b++)(w[b].fn!==m||v&&!w[b].once||p&&w[b].context!==p)&&S.push(w[b]);S.length?this._events[g]=S.length===1?S[0]:S:l(this,g)}return this},u.prototype.removeAllListeners=function(d){var m;return d?(m=r?r+d:d,this._events[m]&&l(this,m)):(this._events=new n,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=r,u.EventEmitter=u,e.exports=u}(U1)),U1.exports}var zne=$ne();const Hne=Ga(zne);var id=new Hne,hb="recharts.syncEvent.tooltip",_k="recharts.syncEvent.brush";function Md(e,t){if(t){var r=Number.parseInt(t,10);if(!ma(r))return e?.[r]}}var qne={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},nR=Xa({name:"options",initialState:qne,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),Vne=nR.reducer,{createEventEmitter:Kne}=nR.actions;function Gne(e){return e.tooltip.syncInteraction}var Wne={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},aR=Xa({name:"chartData",initialState:Wne,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:Tk,setDataStartEndIndexes:Yne,setComputedData:she}=aR.actions,Xne=aR.reducer,iR=()=>{};function Zne(){var e=et(mw),t=et(pw),r=Jt(),n=et(nP),a=et(Ns),i=hp(),l=F2(),u=et(h=>h.rootProps.className);y.useEffect(()=>{if(e==null)return iR;var h=(d,m,p)=>{if(t!==p&&e===d){if(n==="index"){r(m);return}if(a!=null){var v;if(typeof n=="function"){var g={activeTooltipIndex:m.payload.index==null?void 0:Number(m.payload.index),isTooltipActive:m.payload.active,activeIndex:m.payload.index==null?void 0:Number(m.payload.index),activeLabel:m.payload.label,activeDataKey:m.payload.dataKey,activeCoordinate:m.payload.coordinate},w=n(a,g);v=a[w]}else n==="value"&&(v=a.find(C=>String(C.value)===m.payload.label));var{coordinate:b}=m.payload;if(v==null||m.payload.active===!1||b==null||l==null){r(ub({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:S,y:j}=b,_=Math.min(S,l.x+l.width),A=Math.min(j,l.y+l.height),k={x:i==="horizontal"?v.coordinate:_,y:i==="horizontal"?A:v.coordinate},O=ub({active:m.payload.active,coordinate:k,dataKey:m.payload.dataKey,index:String(v.index),label:m.payload.label});r(O)}}};return id.on(hb,h),()=>{id.off(hb,h)}},[u,r,t,e,n,a,i,l])}function Qne(){var e=et(mw),t=et(pw),r=Jt();y.useEffect(()=>{if(e==null)return iR;var n=(a,i,l)=>{t!==l&&e===a&&r(Yne(i))};return id.on(_k,n),()=>{id.off(_k,n)}},[r,t,e])}function Jne(){var e=Jt();y.useEffect(()=>{e(Kne())},[e]),Zne(),Qne()}function eae(e,t,r,n,a,i){var l=et(v=>Cne(v,e,t)),u=et(pw),h=et(mw),d=et(nP),m=et(Gne),p=m?.active;y.useEffect(()=>{if(!p&&h!=null&&u!=null){var v=ub({active:i,coordinate:r,dataKey:l,index:a,label:typeof n=="number"?String(n):n});id.emit(hb,h,v,u)}},[p,r,l,a,n,u,h,d,i])}function kk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ck(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kk(Object(r),!0).forEach(function(n){tae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function tae(e,t,r){return(t=rae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rae(e){var t=nae(e,"string");return typeof t=="symbol"?t:t+""}function nae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function aae(e){return e.dataKey}function iae(e,t){return y.isValidElement(e)?y.cloneElement(e,t):typeof e=="function"?y.createElement(e,t):y.createElement(PZ,t)}var Ok=[],sae={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!Ss.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function $n(e){var t=Kn(e,sae),{active:r,allowEscapeViewBox:n,animationDuration:a,animationEasing:i,content:l,filterNull:u,isAnimationActive:h,offset:d,payloadUniqBy:m,position:p,reverseDirection:v,useTranslate3d:g,wrapperStyle:w,cursor:b,shared:S,trigger:j,defaultIndex:_,portal:A,axisId:k}=t,O=Jt(),C=typeof _=="number"?String(_):_;y.useEffect(()=>{O(Fre({shared:S,trigger:j,axisId:k,active:r,defaultIndex:C}))},[O,S,j,k,r,C]);var T=F2(),I=J6(),M=Ore(S),{activeIndex:W,isActive:U}=et(Z=>Pne(Z,M,j,C)),F=et(Z=>Dne(Z,M,j,C)),oe=et(Z=>tR(Z,M,j,C)),je=et(Z=>One(Z,M,j,C)),ue=F,V=Une(),H=r??U,[Se,Q]=x6([ue,H]),z=M==="axis"?oe:void 0;eae(M,j,je,z,W,H);var Y=A??V;if(Y==null)return null;var P=ue??Ok;H||(P=Ok),u&&P.length&&(P=f6(ue.filter(Z=>Z.value!=null&&(Z.hide!==!0||t.includeHidden)),m,aae));var q=P.length>0,G=y.createElement(UZ,{allowEscapeViewBox:n,animationDuration:a,animationEasing:i,isAnimationActive:h,active:H,coordinate:je,hasPayload:q,offset:d,position:p,reverseDirection:v,useTranslate3d:g,viewBox:T,wrapperStyle:w,lastBoundingBox:Se,innerRef:Q,hasPortalFromProps:!!A},iae(l,Ck(Ck({},t),{},{payload:P,label:z,active:H,coordinate:je,accessibilityLayer:I})));return y.createElement(y.Fragment,null,Uf.createPortal(G,Y),H&&y.createElement(Bne,{cursor:b,tooltipEventType:M,coordinate:je,payload:ue,index:W}))}var $1={},z1={},Dk;function lae(){return Dk||(Dk=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=0,a={}){typeof a!="object"&&(a={});let i=null,l=null,u=null,h=0,d=null,m;const{leading:p=!1,trailing:v=!0,maxWait:g}=a,w="maxWait"in a,b=w?Math.max(Number(g)||0,n):0,S=T=>(i!==null&&(m=r.apply(l,i)),i=l=null,h=T,m),j=T=>(h=T,d=setTimeout(O,n),p&&i!==null?S(T):m),_=T=>(d=null,v&&i!==null?S(T):m),A=T=>{if(u===null)return!0;const I=T-u,M=I>=n||I<0,W=w&&T-h>=b;return M||W},k=T=>{const I=u===null?0:T-u,M=n-I,W=b-(T-h);return w?Math.min(M,W):M},O=()=>{const T=Date.now();if(A(T))return _(T);d=setTimeout(O,k(T))},C=function(...T){const I=Date.now(),M=A(I);if(i=T,l=this,u=I,M){if(d===null)return j(I);if(w)return clearTimeout(d),d=setTimeout(O,n),S(I)}return d===null&&(d=setTimeout(O,n)),m};return C.cancel=()=>{d!==null&&clearTimeout(d),h=0,u=i=l=d=null},C.flush=()=>d===null?m:_(Date.now()),C}e.debounce=t}(z1)),z1}var Pk;function oae(){return Pk||(Pk=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=lae();function r(n,a=0,i={}){const{leading:l=!0,trailing:u=!0}=i;return t.debounce(n,a,{leading:l,maxWait:a,trailing:u})}e.throttle=r}($1)),$1}var H1,Rk;function cae(){return Rk||(Rk=1,H1=oae().throttle),H1}var uae=cae();const fae=Ga(uae);var Mf=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i]};function Mk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function q1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Mk(Object(r),!0).forEach(function(n){dae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Mk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dae(e,t,r){return(t=hae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hae(e){var t=mae(e,"string");return typeof t=="symbol"?t:t+""}function mae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zn=y.forwardRef((e,t)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:a="100%",height:i="100%",minWidth:l=0,minHeight:u,maxHeight:h,children:d,debounce:m=0,id:p,className:v,onResize:g,style:w={}}=e,b=y.useRef(null),S=y.useRef();S.current=g,y.useImperativeHandle(t,()=>b.current);var[j,_]=y.useState({containerWidth:n.width,containerHeight:n.height}),A=y.useCallback((O,C)=>{_(T=>{var I=Math.round(O),M=Math.round(C);return T.containerWidth===I&&T.containerHeight===M?T:{containerWidth:I,containerHeight:M}})},[]);y.useEffect(()=>{var O=M=>{var W,{width:U,height:F}=M[0].contentRect;A(U,F),(W=S.current)===null||W===void 0||W.call(S,U,F)};m>0&&(O=fae(O,m,{trailing:!0,leading:!1}));var C=new ResizeObserver(O),{width:T,height:I}=b.current.getBoundingClientRect();return A(T,I),C.observe(b.current),()=>{C.disconnect()}},[A,m]);var k=y.useMemo(()=>{var{containerWidth:O,containerHeight:C}=j;if(O<0||C<0)return null;Mf(to(a)||to(i),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,a,i),Mf(!r||r>0,"The aspect(%s) must be greater than zero.",r);var T=to(a)?O:a,I=to(i)?C:i;return r&&r>0&&(T?I=T/r:I&&(T=I*r),h&&I>h&&(I=h)),Mf(T>0||I>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,T,I,a,i,l,u,r),y.Children.map(d,M=>y.cloneElement(M,{width:T,height:I,style:q1({width:T,height:I},M.props.style)}))},[r,d,i,h,u,l,j,a]);return y.createElement("div",{id:p?"".concat(p):void 0,className:Tt("recharts-responsive-container",v),style:q1(q1({},w),{},{width:a,height:i,minWidth:l,minHeight:u,maxHeight:h}),ref:b},y.createElement("div",{style:{width:0,height:0,overflow:"visible"}},k))}),Bi=e=>null;Bi.displayName="Cell";function Fk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function mb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Fk(Object(r),!0).forEach(function(n){pae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pae(e,t,r){return(t=xae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xae(e){var t=vae(e,"string");return typeof t=="symbol"?t:t+""}function vae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yc={widthCache:{},cacheCount:0},gae=2e3,yae={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},Ik="recharts_measurement_span";function bae(e){var t=mb({},e);return Object.keys(t).forEach(r=>{t[r]||delete t[r]}),t}var Ff=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Ss.isSsr)return{width:0,height:0};var n=bae(r),a=JSON.stringify({text:t,copyStyle:n});if(yc.widthCache[a])return yc.widthCache[a];try{var i=document.getElementById(Ik);i||(i=document.createElement("span"),i.setAttribute("id",Ik),i.setAttribute("aria-hidden","true"),document.body.appendChild(i));var l=mb(mb({},yae),n);Object.assign(i.style,l),i.textContent="".concat(t);var u=i.getBoundingClientRect(),h={width:u.width,height:u.height};return yc.widthCache[a]=h,++yc.cacheCount>gae&&(yc.cacheCount=0,yc.widthCache={}),h}catch{return{width:0,height:0}}},Lk=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Bk=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,wae=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,Sae=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,sR={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},Eae=Object.keys(sR),Ec="NaN";function jae(e,t){return e*sR[t]}class Bn{static parse(t){var r,[,n,a]=(r=Sae.exec(t))!==null&&r!==void 0?r:[];return new Bn(parseFloat(n),a??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,ma(t)&&(this.unit=""),r!==""&&!wae.test(r)&&(this.num=NaN,this.unit=""),Eae.includes(r)&&(this.num=jae(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new Bn(NaN,""):new Bn(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new Bn(NaN,""):new Bn(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new Bn(NaN,""):new Bn(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new Bn(NaN,""):new Bn(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return ma(this.num)}}function lR(e){if(e.includes(Ec))return Ec;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,a,i]=(r=Lk.exec(t))!==null&&r!==void 0?r:[],l=Bn.parse(n??""),u=Bn.parse(i??""),h=a==="*"?l.multiply(u):l.divide(u);if(h.isNaN())return Ec;t=t.replace(Lk,h.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var d,[,m,p,v]=(d=Bk.exec(t))!==null&&d!==void 0?d:[],g=Bn.parse(m??""),w=Bn.parse(v??""),b=p==="+"?g.add(w):g.subtract(w);if(b.isNaN())return Ec;t=t.replace(Bk,b.toString())}return t}var Uk=/\(([^()]*)\)/;function Nae(e){for(var t=e,r;(r=Uk.exec(t))!=null;){var[,n]=r;t=t.replace(Uk,lR(n))}return t}function Aae(e){var t=e.replace(/\s+/g,"");return t=Nae(t),t=lR(t),t}function _ae(e){try{return Aae(e)}catch{return Ec}}function V1(e){var t=_ae(e.slice(5,-1));return t===Ec?"":t}var Tae=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],kae=["dx","dy","angle","className","breakAll"];function pb(){return pb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},pb.apply(null,arguments)}function $k(e,t){if(e==null)return{};var r,n,a=Cae(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Cae(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var oR=/[ \f\n\r\t\v\u2028\u2029]+/,cR=e=>{var{children:t,breakAll:r,style:n}=e;try{var a=[];Ot(t)||(r?a=t.toString().split(""):a=t.toString().split(oR));var i=a.map(u=>({word:u,width:Ff(u,n).width})),l=r?0:Ff("",n).width;return{wordsWithComputedWidth:i,spaceWidth:l}}catch{return null}},Oae=(e,t,r,n,a)=>{var{maxLines:i,children:l,style:u,breakAll:h}=e,d=rt(i),m=l,p=function(){var U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return U.reduce((F,oe)=>{var{word:je,width:ue}=oe,V=F[F.length-1];if(V&&(n==null||a||V.width+ue+r<Number(n)))V.words.push(je),V.width+=ue+r;else{var H={words:[je],width:ue};F.push(H)}return F},[])},v=p(t),g=W=>W.reduce((U,F)=>U.width>F.width?U:F);if(!d||a)return v;var w=v.length>i||g(v).width>Number(n);if(!w)return v;for(var b="",S=W=>{var U=m.slice(0,W),F=cR({breakAll:h,style:u,children:U+b}).wordsWithComputedWidth,oe=p(F),je=oe.length>i||g(oe).width>Number(n);return[je,oe]},j=0,_=m.length-1,A=0,k;j<=_&&A<=m.length-1;){var O=Math.floor((j+_)/2),C=O-1,[T,I]=S(C),[M]=S(O);if(!T&&!M&&(j=O+1),T&&M&&(_=O-1),!T&&M){k=I;break}A++}return k||v},zk=e=>{var t=Ot(e)?[]:e.toString().split(oR);return[{words:t}]},Dae=e=>{var{width:t,scaleToFit:r,children:n,style:a,breakAll:i,maxLines:l}=e;if((t||r)&&!Ss.isSsr){var u,h,d=cR({breakAll:i,children:n,style:a});if(d){var{wordsWithComputedWidth:m,spaceWidth:p}=d;u=m,h=p}else return zk(n);return Oae({breakAll:i,children:n,maxLines:l,style:a},u,h,t,r)}return zk(n)},Hk="#808080",Rp=y.forwardRef((e,t)=>{var{x:r=0,y:n=0,lineHeight:a="1em",capHeight:i="0.71em",scaleToFit:l=!1,textAnchor:u="start",verticalAnchor:h="end",fill:d=Hk}=e,m=$k(e,Tae),p=y.useMemo(()=>Dae({breakAll:m.breakAll,children:m.children,maxLines:m.maxLines,scaleToFit:l,style:m.style,width:m.width}),[m.breakAll,m.children,m.maxLines,l,m.style,m.width]),{dx:v,dy:g,angle:w,className:b,breakAll:S}=m,j=$k(m,kae);if(!Ci(r)||!Ci(n))return null;var _=r+(rt(v)?v:0),A=n+(rt(g)?g:0),k;switch(h){case"start":k=V1("calc(".concat(i,")"));break;case"middle":k=V1("calc(".concat((p.length-1)/2," * -").concat(a," + (").concat(i," / 2))"));break;default:k=V1("calc(".concat(p.length-1," * -").concat(a,")"));break}var O=[];if(l){var C=p[0].width,{width:T}=m;O.push("scale(".concat(rt(T)?T/C:1,")"))}return w&&O.push("rotate(".concat(w,", ").concat(_,", ").concat(A,")")),O.length&&(j.transform=O.join(" ")),y.createElement("text",pb({},vt(j,!0),{ref:t,x:_,y:A,className:Tt("recharts-text",b),textAnchor:u,fill:d.includes("url")?Hk:d}),p.map((I,M)=>{var W=I.words.join(S?"":" ");return y.createElement("tspan",{x:_,dy:M===0?k:a,key:"".concat(W,"-").concat(M)},W)}))});Rp.displayName="Text";var Pae=["offset"],Rae=["labelRef"];function qk(e,t){if(e==null)return{};var r,n,a=Mae(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Mae(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Vk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Sr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Vk(Object(r),!0).forEach(function(n){Fae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Vk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Fae(e,t,r){return(t=Iae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Iae(e){var t=Lae(e,"string");return typeof t=="symbol"?t:t+""}function Lae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ts(){return ts=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ts.apply(null,arguments)}var Bae=e=>{var{value:t,formatter:r}=e,n=Ot(e.children)?t:e.children;return typeof r=="function"?r(n):n},Hw=e=>e!=null&&typeof e=="function",Uae=(e,t)=>{var r=Ar(t-e),n=Math.min(Math.abs(t-e),360);return r*n},$ae=(e,t,r)=>{var{position:n,viewBox:a,offset:i,className:l}=e,{cx:u,cy:h,innerRadius:d,outerRadius:m,startAngle:p,endAngle:v,clockWise:g}=a,w=(d+m)/2,b=Uae(p,v),S=b>=0?1:-1,j,_;n==="insideStart"?(j=p+S*i,_=g):n==="insideEnd"?(j=v-S*i,_=!g):n==="end"&&(j=v+S*i,_=g),_=b<=0?_:!_;var A=_r(u,h,w,j),k=_r(u,h,w,j+(_?1:-1)*359),O="M".concat(A.x,",").concat(A.y,`
    A`).concat(w,",").concat(w,",0,1,").concat(_?0:1,`,
    `).concat(k.x,",").concat(k.y),C=Ot(e.id)?yl("recharts-radial-line-"):e.id;return y.createElement("text",ts({},r,{dominantBaseline:"central",className:Tt("recharts-radial-bar-label",l)}),y.createElement("defs",null,y.createElement("path",{id:C,d:O})),y.createElement("textPath",{xlinkHref:"#".concat(C)},t))},zae=e=>{var{viewBox:t,offset:r,position:n}=e,{cx:a,cy:i,innerRadius:l,outerRadius:u,startAngle:h,endAngle:d}=t,m=(h+d)/2;if(n==="outside"){var{x:p,y:v}=_r(a,i,u+r,m);return{x:p,y:v,textAnchor:p>=a?"start":"end",verticalAnchor:"middle"}}if(n==="center")return{x:a,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(n==="centerTop")return{x:a,y:i,textAnchor:"middle",verticalAnchor:"start"};if(n==="centerBottom")return{x:a,y:i,textAnchor:"middle",verticalAnchor:"end"};var g=(l+u)/2,{x:w,y:b}=_r(a,i,g,m);return{x:w,y:b,textAnchor:"middle",verticalAnchor:"middle"}},Hae=(e,t)=>{var{parentViewBox:r,offset:n,position:a}=e,{x:i,y:l,width:u,height:h}=t,d=h>=0?1:-1,m=d*n,p=d>0?"end":"start",v=d>0?"start":"end",g=u>=0?1:-1,w=g*n,b=g>0?"end":"start",S=g>0?"start":"end";if(a==="top"){var j={x:i+u/2,y:l-d*n,textAnchor:"middle",verticalAnchor:p};return Sr(Sr({},j),r?{height:Math.max(l-r.y,0),width:u}:{})}if(a==="bottom"){var _={x:i+u/2,y:l+h+m,textAnchor:"middle",verticalAnchor:v};return Sr(Sr({},_),r?{height:Math.max(r.y+r.height-(l+h),0),width:u}:{})}if(a==="left"){var A={x:i-w,y:l+h/2,textAnchor:b,verticalAnchor:"middle"};return Sr(Sr({},A),r?{width:Math.max(A.x-r.x,0),height:h}:{})}if(a==="right"){var k={x:i+u+w,y:l+h/2,textAnchor:S,verticalAnchor:"middle"};return Sr(Sr({},k),r?{width:Math.max(r.x+r.width-k.x,0),height:h}:{})}var O=r?{width:u,height:h}:{};return a==="insideLeft"?Sr({x:i+w,y:l+h/2,textAnchor:S,verticalAnchor:"middle"},O):a==="insideRight"?Sr({x:i+u-w,y:l+h/2,textAnchor:b,verticalAnchor:"middle"},O):a==="insideTop"?Sr({x:i+u/2,y:l+m,textAnchor:"middle",verticalAnchor:v},O):a==="insideBottom"?Sr({x:i+u/2,y:l+h-m,textAnchor:"middle",verticalAnchor:p},O):a==="insideTopLeft"?Sr({x:i+w,y:l+m,textAnchor:S,verticalAnchor:v},O):a==="insideTopRight"?Sr({x:i+u-w,y:l+m,textAnchor:b,verticalAnchor:v},O):a==="insideBottomLeft"?Sr({x:i+w,y:l+h-m,textAnchor:S,verticalAnchor:p},O):a==="insideBottomRight"?Sr({x:i+u-w,y:l+h-m,textAnchor:b,verticalAnchor:p},O):a&&typeof a=="object"&&(rt(a.x)||to(a.x))&&(rt(a.y)||to(a.y))?Sr({x:i+Dn(a.x,u),y:l+Dn(a.y,h),textAnchor:"end",verticalAnchor:"end"},O):Sr({x:i+u/2,y:l+h/2,textAnchor:"middle",verticalAnchor:"middle"},O)},qae=e=>"cx"in e&&rt(e.cx);function la(e){var{offset:t=5}=e,r=qk(e,Pae),n=Sr({offset:t},r),{viewBox:a,position:i,value:l,children:u,content:h,className:d="",textBreakAll:m,labelRef:p}=n,v=F2(),g=a||v;if(!g||Ot(l)&&Ot(u)&&!y.isValidElement(h)&&typeof h!="function")return null;if(y.isValidElement(h)){var{labelRef:w}=n,b=qk(n,Rae);return y.cloneElement(h,b)}var S;if(typeof h=="function"){if(S=y.createElement(h,n),y.isValidElement(S))return S}else S=Bae(n);var j=qae(g),_=vt(n,!0);if(j&&(i==="insideStart"||i==="insideEnd"||i==="end"))return $ae(n,S,_);var A=j?zae(n):Hae(n,g);return y.createElement(Rp,ts({ref:p,className:Tt("recharts-label",d)},_,A,{breakAll:m}),S)}la.displayName="Label";var uR=e=>{var{cx:t,cy:r,angle:n,startAngle:a,endAngle:i,r:l,radius:u,innerRadius:h,outerRadius:d,x:m,y:p,top:v,left:g,width:w,height:b,clockWise:S,labelViewBox:j}=e;if(j)return j;if(rt(w)&&rt(b)){if(rt(m)&&rt(p))return{x:m,y:p,width:w,height:b};if(rt(v)&&rt(g))return{x:v,y:g,width:w,height:b}}if(rt(m)&&rt(p))return{x:m,y:p,width:0,height:0};if(rt(t)&&rt(r))return{cx:t,cy:r,startAngle:a||n||0,endAngle:i||n||0,innerRadius:h||0,outerRadius:d||u||l||0,clockWise:S};if(e.viewBox)return e.viewBox},Vae=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?y.createElement(la,ts({key:"label-implicit"},n)):Ci(e)?y.createElement(la,ts({key:"label-implicit",value:e},n)):y.isValidElement(e)?e.type===la?y.cloneElement(e,Sr({key:"label-implicit"},n)):y.createElement(la,ts({key:"label-implicit",content:e},n)):Hw(e)?y.createElement(la,ts({key:"label-implicit",content:e},n)):e&&typeof e=="object"?y.createElement(la,ts({},e,{key:"label-implicit"},n)):null},Kae=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var{children:a,labelRef:i}=t,l=uR(t),u=ko(a,la).map((d,m)=>y.cloneElement(d,{viewBox:r||l,key:"label-".concat(m)}));if(!n)return u;var h=Vae(t.label,r||l,i);return[h,...u]};la.parseViewBox=uR;la.renderCallByParent=Kae;var K1={},G1={},Kk;function Gae(){return Kk||(Kk=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t}(G1)),G1}var W1={},Gk;function Wae(){return Gk||(Gk=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t}(W1)),W1}var Wk;function Yae(){return Wk||(Wk=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Gae(),r=Wae(),n=w2();function a(i){if(n.isArrayLike(i))return t.last(r.toArray(i))}e.last=a}(K1)),K1}var Y1,Yk;function Xae(){return Yk||(Yk=1,Y1=Yae().last),Y1}var Zae=Xae();const Qae=Ga(Zae);var Jae=["valueAccessor"],eie=["data","dataKey","clockWise","id","textBreakAll"];function Am(){return Am=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Am.apply(null,arguments)}function Xk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Zk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Xk(Object(r),!0).forEach(function(n){tie(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function tie(e,t,r){return(t=rie(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rie(e){var t=nie(e,"string");return typeof t=="symbol"?t:t+""}function nie(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qk(e,t){if(e==null)return{};var r,n,a=aie(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function aie(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var iie=e=>Array.isArray(e.value)?Qae(e.value):e.value;function ki(e){var{valueAccessor:t=iie}=e,r=Qk(e,Jae),{data:n,dataKey:a,clockWise:i,id:l,textBreakAll:u}=r,h=Qk(r,eie);return!n||!n.length?null:y.createElement(Wt,{className:"recharts-label-list"},n.map((d,m)=>{var p=Ot(a)?t(d,m):Ft(d&&d.payload,a),v=Ot(l)?{}:{id:"".concat(l,"-").concat(m)};return y.createElement(la,Am({},vt(d,!0),h,v,{parentViewBox:d.parentViewBox,value:p,textBreakAll:u,viewBox:la.parseViewBox(Ot(i)?d:Zk(Zk({},d),{},{clockWise:i})),key:"label-".concat(m),index:m}))}))}ki.displayName="LabelList";function sie(e,t){return e?e===!0?y.createElement(ki,{key:"labelList-implicit",data:t}):y.isValidElement(e)||Hw(e)?y.createElement(ki,{key:"labelList-implicit",data:t,content:e}):typeof e=="object"?y.createElement(ki,Am({data:t},e,{key:"labelList-implicit"})):null:null}function lie(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var{children:n}=e,a=ko(n,ki).map((l,u)=>y.cloneElement(l,{data:t,key:"labelList-".concat(u)}));if(!r)return a;var i=sie(e.label,t);return[i,...a]}ki.renderCallByParent=lie;function xb(){return xb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xb.apply(null,arguments)}var fR=e=>{var{cx:t,cy:r,r:n,className:a}=e,i=Tt("recharts-dot",a);return t===+t&&r===+r&&n===+n?y.createElement("circle",xb({},vt(e,!1),m2(e),{className:i,cx:t,cy:r,r:n})):null},Mp=e=>e.graphicalItems.polarItems,oie=Te([ir,kd],gw),Fp=Te([Mp,xr,oie],yw),cie=Te([Fp],bw),Ip=Te([cie,wp],ww),dR=Te([Ip,xr,Fp],Sw),uie=Te([Ip,xr,Fp],(e,t,r)=>r.length>0?e.flatMap(n=>r.flatMap(a=>{var i,l=Ft(n,(i=t.dataKey)!==null&&i!==void 0?i:a.dataKey);return{value:l,errorDomain:[]}})).filter(Boolean):t?.dataKey!=null?e.map(n=>({value:Ft(n,t.dataKey),errorDomain:[]})):e.map(n=>({value:n,errorDomain:[]}))),Jk=()=>{},fie=Te([xr,bP,Jk,uie,Jk],Aw),hR=Te([xr,gt,Ip,dR,ru,ir,fie],_w),mR=Te([hR,xr,Nl],kw),die=Te([xr,hR,mR,ir],Ow),qw=(e,t,r)=>{switch(t){case"angleAxis":return _d(e,r);case"radiusAxis":return Td(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},Vw=(e,t,r)=>{switch(t){case"angleAxis":return Ute(e,r);case"radiusAxis":return $te(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},Lp=Te([qw,Nl,die,Vw],kp),pR=Te([gt,dR,nu,ir],Dw),hie=Te([gt,qw,Nl,Lp,mR,Vw,Pd,pR,ir],kP),mie=Te([gt,qw,Lp,Vw,Pd,pR,ir],OP),pie={radiusAxis:{},angleAxis:{}},xR=Xa({name:"polarAxis",initialState:pie,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:lhe,removeRadiusAxis:ohe,addAngleAxis:che,removeAngleAxis:uhe}=xR.actions,xie=xR.reducer;function e3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function t3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?e3(Object(r),!0).forEach(function(n){vie(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):e3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vie(e,t,r){return(t=gie(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gie(e){var t=yie(e,"string");return typeof t=="symbol"?t:t+""}function yie(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Kw=(e,t)=>t,bie=[],Gw=(e,t,r)=>r?.length===0?bie:r,vR=Te([wp,Kw,Gw],(e,t,r)=>{var{chartData:n}=e,a;if(t?.data!=null&&t.data.length>0?a=t.data:a=n,(!a||!a.length)&&r!=null&&(a=r.map(i=>t3(t3({},t.presentationProps),i.props))),a!=null)return a}),wie=Te([vR,Kw,Gw],(e,t,r)=>{if(e!=null)return e.map((n,a)=>{var i,l=Ft(n,t.nameKey,t.name),u;return r!=null&&(i=r[a])!==null&&i!==void 0&&(i=i.props)!==null&&i!==void 0&&i.fill?u=r[a].props.fill:typeof n=="object"&&n!=null&&"fill"in n?u=n.fill:u=t.fill,{value:ys(l,t.dataKey),color:u,payload:n,type:t.legendType}})}),Sie=Te([Mp,Kw],(e,t)=>{if(e.some(r=>r.type==="pie"&&t.dataKey===r.dataKey&&t.data===r.data))return t}),Eie=Te([vR,Sie,Gw,Mr],(e,t,r,n)=>{if(!(t==null||e==null))return dse({offset:n,pieSettings:t,displayedData:e,cells:r})}),jie={countOfBars:0,cartesianItems:[],polarItems:[]},gR=Xa({name:"graphicalItems",initialState:jie,reducers:{addBar(e){e.countOfBars+=1},removeBar(e){e.countOfBars-=1},addCartesianGraphicalItem(e,t){e.cartesianItems.push(t.payload)},replaceCartesianGraphicalItem(e,t){var{prev:r,next:n}=t.payload,a=cs(e).cartesianItems.indexOf(r);a>-1&&(e.cartesianItems[a]=n)},removeCartesianGraphicalItem(e,t){var r=cs(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},addPolarGraphicalItem(e,t){e.polarItems.push(t.payload)},removePolarGraphicalItem(e,t){var r=cs(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)}}}),{addBar:Nie,removeBar:Aie,addCartesianGraphicalItem:_ie,replaceCartesianGraphicalItem:Tie,removeCartesianGraphicalItem:kie,addPolarGraphicalItem:Cie,removePolarGraphicalItem:Oie}=gR.actions,Die=gR.reducer;function r3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function n3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?r3(Object(r),!0).forEach(function(n){Pie(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):r3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Pie(e,t,r){return(t=Rie(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Rie(e){var t=Mie(e,"string");return typeof t=="symbol"?t:t+""}function Mie(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Fie(e){var t=Jt(),r=y.useRef(null);return y.useEffect(()=>{var n=n3(n3({},e),{},{stackId:V6(e.stackId)});r.current===null?t(_ie(n)):r.current!==n&&t(Tie({prev:r.current,next:n})),r.current=n},[t,e]),y.useEffect(()=>()=>{r.current&&(t(kie(r.current)),r.current=null)},[t]),null}function yR(e){var t=Jt();return y.useEffect(()=>(t(Cie(e)),()=>{t(Oie(e))}),[t,e]),null}var X1={},a3;function Iie(){return a3||(a3=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const a=r[Symbol.toStringTag];return a==null||!Object.getOwnPropertyDescriptor(r,Symbol.toStringTag)?.writable?!1:r.toString()===`[object ${a}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}e.isPlainObject=t}(X1)),X1}var Z1,i3;function Lie(){return i3||(i3=1,Z1=Iie().isPlainObject),Z1}var Bie=Lie();const Uie=Ga(Bie);function _m(){return _m=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_m.apply(null,arguments)}var s3=(e,t,r,n,a)=>{var i=r-n,l;return l="M ".concat(e,",").concat(t),l+="L ".concat(e+r,",").concat(t),l+="L ".concat(e+r-i/2,",").concat(t+a),l+="L ".concat(e+r-i/2-n,",").concat(t+a),l+="L ".concat(e,",").concat(t," Z"),l},$ie={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},zie=e=>{var t=Kn(e,$ie),r=y.useRef(),[n,a]=y.useState(-1);y.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var S=r.current.getTotalLength();S&&a(S)}catch{}},[]);var{x:i,y:l,upperWidth:u,lowerWidth:h,height:d,className:m}=t,{animationEasing:p,animationDuration:v,animationBegin:g,isUpdateAnimationActive:w}=t;if(i!==+i||l!==+l||u!==+u||h!==+h||d!==+d||u===0&&h===0||d===0)return null;var b=Tt("recharts-trapezoid",m);return w?y.createElement(Oi,{canBegin:n>0,from:{upperWidth:0,lowerWidth:0,height:d,x:i,y:l},to:{upperWidth:u,lowerWidth:h,height:d,x:i,y:l},duration:v,animationEasing:p,isActive:w},S=>{var{upperWidth:j,lowerWidth:_,height:A,x:k,y:O}=S;return y.createElement(Oi,{canBegin:n>0,from:"0px ".concat(n===-1?1:n,"px"),to:"".concat(n,"px 0px"),attributeName:"strokeDasharray",begin:g,duration:v,easing:p},y.createElement("path",_m({},vt(t,!0),{className:b,d:s3(k,O,j,_,A),ref:r})))}):y.createElement("g",null,y.createElement("path",_m({},vt(t,!0),{className:b,d:s3(i,l,u,h,d)})))},Hie=["option","shapeType","propTransformer","activeClassName","isActive"];function qie(e,t){if(e==null)return{};var r,n,a=Vie(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Vie(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function l3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Tm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?l3(Object(r),!0).forEach(function(n){Kie(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Kie(e,t,r){return(t=Gie(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gie(e){var t=Wie(e,"string");return typeof t=="symbol"?t:t+""}function Wie(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yie(e,t){return Tm(Tm({},t),e)}function Xie(e,t){return e==="symbols"}function o3(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return y.createElement(nD,r);case"trapezoid":return y.createElement(zie,r);case"sector":return y.createElement(Sd,r);case"symbols":if(Xie(t))return y.createElement(rp,r);break;default:return null}}function Zie(e){return y.isValidElement(e)?e.props:e}function sd(e){var{option:t,shapeType:r,propTransformer:n=Yie,activeClassName:a="recharts-active-shape",isActive:i}=e,l=qie(e,Hie),u;if(y.isValidElement(t))u=y.cloneElement(t,Tm(Tm({},l),Zie(t)));else if(typeof t=="function")u=t(l);else if(Uie(t)&&typeof t!="boolean"){var h=n(t,l);u=y.createElement(o3,{shapeType:r,elementProps:h})}else{var d=l;u=y.createElement(o3,{shapeType:r,elementProps:d})}return i?y.createElement(Wt,{className:a},u):u}var Fd=(e,t)=>{var r=Jt();return(n,a)=>i=>{e?.(n,a,i),r(IP({activeIndex:String(a),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}},Id=e=>{var t=Jt();return(r,n)=>a=>{e?.(r,n,a),t(Ire())}},Ld=(e,t)=>{var r=Jt();return(n,a)=>i=>{e?.(n,a,i),r(Lre({activeIndex:String(a),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}};function Bd(e){var{fn:t,args:r}=e,n=Jt(),a=Sn();return y.useEffect(()=>{if(!a){var i=t(r);return n(Rre(i)),()=>{n(Mre(i))}}},[t,r,n,a]),null}var bR=()=>{};function Ww(e){var{legendPayload:t}=e,r=Jt(),n=Sn();return y.useEffect(()=>n?bR:(r(Z6(t)),()=>{r(Q6(t))}),[r,n,t]),null}function wR(e){var{legendPayload:t}=e,r=Jt(),n=et(gt);return y.useEffect(()=>n!=="centric"&&n!=="radial"?bR:(r(Z6(t)),()=>{r(Q6(t))}),[r,n,t]),null}function Ud(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=y.useRef(yl(t)),n=y.useRef(e);return n.current!==e&&(r.current=yl(t),n.current=e),r.current}var Qie=["onMouseEnter","onClick","onMouseLeave"];function Jie(e,t){if(e==null)return{};var r,n,a=ese(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function ese(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function c3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function fr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?c3(Object(r),!0).forEach(function(n){Bp(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Bp(e,t,r){return(t=tse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tse(e){var t=rse(e,"string");return typeof t=="symbol"?t:t+""}function rse(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wo(){return wo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},wo.apply(null,arguments)}function nse(e){var t=y.useMemo(()=>vt(e,!1),[e]),r=y.useMemo(()=>ko(e.children,Bi),[e.children]),n=y.useMemo(()=>({name:e.name,nameKey:e.nameKey,tooltipType:e.tooltipType,data:e.data,dataKey:e.dataKey,cx:e.cx,cy:e.cy,startAngle:e.startAngle,endAngle:e.endAngle,minAngle:e.minAngle,paddingAngle:e.paddingAngle,innerRadius:e.innerRadius,outerRadius:e.outerRadius,cornerRadius:e.cornerRadius,legendType:e.legendType,fill:e.fill,presentationProps:t}),[e.cornerRadius,e.cx,e.cy,e.data,e.dataKey,e.endAngle,e.innerRadius,e.minAngle,e.name,e.nameKey,e.outerRadius,e.paddingAngle,e.startAngle,e.tooltipType,e.legendType,e.fill,t]),a=et(i=>wie(i,n,r));return y.createElement(wR,{legendPayload:a})}function ase(e){var{dataKey:t,nameKey:r,sectors:n,stroke:a,strokeWidth:i,fill:l,name:u,hide:h,tooltipType:d}=e;return{dataDefinedOnItem:n?.map(m=>m.tooltipPayload),positions:n?.map(m=>m.tooltipPosition),settings:{stroke:a,strokeWidth:i,fill:l,dataKey:t,nameKey:r,name:ys(u,t),hide:h,type:d,color:l,unit:""}}}var ise=(e,t)=>e>t?"start":e<t?"end":"middle",sse=(e,t,r)=>typeof t=="function"?t(e):Dn(t,r,r*.8),lse=(e,t,r)=>{var{top:n,left:a,width:i,height:l}=t,u=$6(i,l),h=a+Dn(e.cx,i,i/2),d=n+Dn(e.cy,l,l/2),m=Dn(e.innerRadius,u,0),p=sse(r,e.outerRadius,u),v=e.maxRadius||Math.sqrt(i*i+l*l)/2;return{cx:h,cy:d,innerRadius:m,outerRadius:p,maxRadius:v}},ose=(e,t)=>{var r=Ar(t-e),n=Math.min(Math.abs(t-e),360);return r*n},cse=(e,t)=>{if(y.isValidElement(e))return y.cloneElement(e,t);if(typeof e=="function")return e(t);var r=Tt("recharts-pie-label-line",typeof e!="boolean"?e.className:"");return y.createElement(mp,wo({},t,{type:"linear",className:r}))},use=(e,t,r)=>{if(y.isValidElement(e))return y.cloneElement(e,t);var n=r;if(typeof e=="function"&&(n=e(t),y.isValidElement(n)))return n;var a=Tt("recharts-pie-label-text",typeof e!="boolean"&&typeof e!="function"?e.className:"");return y.createElement(Rp,wo({},t,{alignmentBaseline:"middle",className:a}),n)};function fse(e){var{sectors:t,props:r,showLabels:n}=e,{label:a,labelLine:i,dataKey:l}=r;if(!n||!a||!t)return null;var u=vt(r,!1),h=vt(a,!1),d=vt(i,!1),m=typeof a=="object"&&"offsetRadius"in a&&a.offsetRadius||20,p=t.map((v,g)=>{var w=(v.startAngle+v.endAngle)/2,b=_r(v.cx,v.cy,v.outerRadius+m,w),S=fr(fr(fr(fr({},u),v),{},{stroke:"none"},h),{},{index:g,textAnchor:ise(b.x,v.cx)},b),j=fr(fr(fr(fr({},u),v),{},{fill:"none",stroke:v.fill},d),{},{index:g,points:[_r(v.cx,v.cy,v.outerRadius,w),b],key:"line"});return y.createElement(Wt,{key:"label-".concat(v.startAngle,"-").concat(v.endAngle,"-").concat(v.midAngle,"-").concat(g)},i&&cse(i,j),use(a,S,Ft(v,l)))});return y.createElement(Wt,{className:"recharts-pie-labels"},p)}function SR(e){var{sectors:t,activeShape:r,inactiveShape:n,allOtherPieProps:a,showLabels:i}=e,l=et(Ri),{onMouseEnter:u,onClick:h,onMouseLeave:d}=a,m=Jie(a,Qie),p=Fd(u,a.dataKey),v=Id(d),g=Ld(h,a.dataKey);return t==null?null:y.createElement(y.Fragment,null,t.map((w,b)=>{if(w?.startAngle===0&&w?.endAngle===0&&t.length!==1)return null;var S=r&&String(b)===l,j=l?n:null,_=S?r:j,A=fr(fr({},w),{},{stroke:w.stroke,tabIndex:-1,[R2]:b,[M2]:a.dataKey});return y.createElement(Wt,wo({tabIndex:-1,className:"recharts-pie-sector"},bl(m,w,b),{onMouseEnter:p(w,b),onMouseLeave:v(w,b),onClick:g(w,b),key:"sector-".concat(w?.startAngle,"-").concat(w?.endAngle,"-").concat(w.midAngle,"-").concat(b)}),y.createElement(sd,wo({option:_,isActive:S,shapeType:"sector"},A)))}),y.createElement(fse,{sectors:t,props:a,showLabels:i}))}function dse(e){var t,{pieSettings:r,displayedData:n,cells:a,offset:i}=e,{cornerRadius:l,startAngle:u,endAngle:h,dataKey:d,nameKey:m,tooltipType:p}=r,v=Math.abs(r.minAngle),g=ose(u,h),w=Math.abs(g),b=n.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,S=n.filter(C=>Ft(C,d,0)!==0).length,j=(w>=360?S:S-1)*b,_=w-S*v-j,A=n.reduce((C,T)=>{var I=Ft(T,d,0);return C+(rt(I)?I:0)},0),k;if(A>0){var O;k=n.map((C,T)=>{var I=Ft(C,d,0),M=Ft(C,m,T),W=lse(r,i,C),U=(rt(I)?I:0)/A,F,oe=fr(fr({},C),a&&a[T]&&a[T].props);T?F=O.endAngle+Ar(g)*b*(I!==0?1:0):F=u;var je=F+Ar(g)*((I!==0?v:0)+U*_),ue=(F+je)/2,V=(W.innerRadius+W.outerRadius)/2,H=[{name:M,value:I,payload:oe,dataKey:d,type:p}],Se=_r(W.cx,W.cy,V,ue);return O=fr(fr(fr(fr({},r.presentationProps),{},{percent:U,cornerRadius:l,name:M,tooltipPayload:H,midAngle:ue,middleRadius:V,tooltipPosition:Se},oe),W),{},{value:Ft(C,d),startAngle:F,endAngle:je,payload:oe,paddingAngle:Ar(g)*b}),O})}return k}function hse(e){var{props:t,previousSectorsRef:r}=e,{sectors:n,isAnimationActive:a,animationBegin:i,animationDuration:l,animationEasing:u,activeShape:h,inactiveShape:d,onAnimationStart:m,onAnimationEnd:p}=t,v=Ud(t,"recharts-pie-"),g=r.current,[w,b]=y.useState(!0),S=y.useCallback(()=>{typeof p=="function"&&p(),b(!1)},[p]),j=y.useCallback(()=>{typeof m=="function"&&m(),b(!0)},[m]);return y.createElement(Oi,{begin:i,duration:l,isActive:a,easing:u,from:{t:0},to:{t:1},onAnimationStart:j,onAnimationEnd:S,key:v},_=>{var{t:A}=_,k=[],O=n&&n[0],C=O.startAngle;return n.forEach((T,I)=>{var M=g&&g[I],W=I>0?gl(T,"paddingAngle",0):0;if(M){var U=Nr(M.endAngle-M.startAngle,T.endAngle-T.startAngle),F=fr(fr({},T),{},{startAngle:C+W,endAngle:C+U(A)+W});k.push(F),C=F.endAngle}else{var{endAngle:oe,startAngle:je}=T,ue=Nr(0,oe-je),V=ue(A),H=fr(fr({},T),{},{startAngle:C+W,endAngle:C+V+W});k.push(H),C=H.endAngle}}),r.current=k,y.createElement(Wt,null,y.createElement(SR,{sectors:k,activeShape:h,inactiveShape:d,allOtherPieProps:t,showLabels:!w}))})}function mse(e){var{sectors:t,isAnimationActive:r,activeShape:n,inactiveShape:a}=e,i=y.useRef(null),l=i.current;return r&&t&&t.length&&(!l||l!==t)?y.createElement(hse,{props:e,previousSectorsRef:i}):y.createElement(SR,{sectors:t,activeShape:n,inactiveShape:a,allOtherPieProps:e,showLabels:!0})}function pse(e){var{hide:t,className:r,rootTabIndex:n}=e,a=Tt("recharts-pie",r);return t?null:y.createElement(Wt,{tabIndex:n,className:a},y.createElement(mse,e))}var ER={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!Ss.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff"};function xse(e){var t=Kn(e,ER),r=y.useMemo(()=>ko(e.children,Bi),[e.children]),n=vt(t,!1),a=y.useMemo(()=>({name:t.name,nameKey:t.nameKey,tooltipType:t.tooltipType,data:t.data,dataKey:t.dataKey,cx:t.cx,cy:t.cy,startAngle:t.startAngle,endAngle:t.endAngle,minAngle:t.minAngle,paddingAngle:t.paddingAngle,innerRadius:t.innerRadius,outerRadius:t.outerRadius,cornerRadius:t.cornerRadius,legendType:t.legendType,fill:t.fill,presentationProps:n}),[t.cornerRadius,t.cx,t.cy,t.data,t.dataKey,t.endAngle,t.innerRadius,t.minAngle,t.name,t.nameKey,t.outerRadius,t.paddingAngle,t.startAngle,t.tooltipType,t.legendType,t.fill,n]),i=et(l=>Eie(l,a,r));return y.createElement(y.Fragment,null,y.createElement(Bd,{fn:ase,args:fr(fr({},t),{},{sectors:i})}),y.createElement(pse,wo({},t,{sectors:i})))}class ou extends y.PureComponent{constructor(){super(...arguments),Bp(this,"id",yl("recharts-pie-"))}render(){return y.createElement(y.Fragment,null,y.createElement(yR,{data:this.props.data,dataKey:this.props.dataKey,hide:this.props.hide,angleAxisId:0,radiusAxisId:0,stackId:void 0,barSize:void 0,type:"pie"}),y.createElement(nse,this.props),y.createElement(xse,this.props),this.props.children)}}Bp(ou,"displayName","Pie");Bp(ou,"defaultProps",ER);var vse=Te([Mr],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),gse=Te([vse,bs,ws],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),yse=e=>{var t=Sn();return et(r=>Ka(r,"xAxis",e,t))},bse=e=>{var t=Sn();return et(r=>Ka(r,"yAxis",e,t))},Yw=()=>et(gse),wse=()=>et(Sne);function u3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function f3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?u3(Object(r),!0).forEach(function(n){Sse(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Sse(e,t,r){return(t=Ese(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ese(e){var t=jse(e,"string");return typeof t=="symbol"?t:t+""}function jse(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Nse=e=>{var{point:t,childIndex:r,mainColor:n,activeDot:a,dataKey:i}=e;if(a===!1||t.x==null||t.y==null)return null;var l=f3(f3({index:r,dataKey:i,cx:t.x,cy:t.y,r:4,fill:n??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},vt(a,!1)),m2(a)),u;return y.isValidElement(a)?u=y.cloneElement(a,l):typeof a=="function"?u=a(l):u=y.createElement(fR,l),y.createElement(Wt,{className:"recharts-active-dot"},u)};function Ase(e){var{points:t,mainColor:r,activeDot:n,itemDataKey:a}=e,i=et(Ri),l=wse();if(t==null||l==null)return null;var u=t.find(h=>l.includes(h.payload));return Ot(u)?null:Nse({point:u,childIndex:Number(i),mainColor:r,dataKey:a,activeDot:n})}var _se=e=>y.createElement(yR,e);function vb(){return vb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vb.apply(null,arguments)}function d3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Q1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?d3(Object(r),!0).forEach(function(n){Tse(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Tse(e,t,r){return(t=kse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kse(e){var t=Cse(e,"string");return typeof t=="symbol"?t:t+""}function Cse(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jR(e){return typeof e=="string"?parseInt(e,10):e}function Ose(e,t){var r="".concat(t.cx||e.cx),n=Number(r),a="".concat(t.cy||e.cy),i=Number(a);return Q1(Q1(Q1({},t),e),{},{cx:n,cy:i})}function NR(e){return y.createElement(sd,vb({shapeType:"sector",propTransformer:Ose},e))}var AR=()=>{var e=Jt();return y.useEffect(()=>(e(Nie()),()=>{e(Aie())})),null},Dse=["children"];function Pse(e,t){if(e==null)return{};var r,n,a=Rse(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Rse(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var h3=()=>{},_R=y.createContext({addErrorBar:h3,removeErrorBar:h3}),Mse={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},TR=y.createContext(Mse);function Xw(e){var{children:t}=e,r=Pse(e,Dse);return y.createElement(TR.Provider,{value:r},t)}var Fse=()=>y.useContext(TR),Zw=e=>{var{children:t,xAxisId:r,yAxisId:n,zAxisId:a,dataKey:i,data:l,stackId:u,hide:h,type:d,barSize:m}=e,[p,v]=y.useState([]),g=y.useCallback(S=>{v(j=>[...j,S])},[v]),w=y.useCallback(S=>{v(j=>j.filter(_=>_!==S))},[v]),b=Sn();return y.createElement(_R.Provider,{value:{addErrorBar:g,removeErrorBar:w}},y.createElement(Fie,{type:d,data:l,xAxisId:r,yAxisId:n,zAxisId:a,dataKey:i,errorBars:p,stackId:u,hide:h,barSize:m,isPanorama:b}),t)};function Ise(e){var{addErrorBar:t,removeErrorBar:r}=y.useContext(_R);return y.useEffect(()=>(t(e),()=>{r(e)}),[t,r,e]),null}var Lse=["direction","width","dataKey","isAnimationActive","animationBegin","animationDuration","animationEasing"];function kR(e,t,r){return(t=Bse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bse(e){var t=Use(e,"string");return typeof t=="symbol"?t:t+""}function Use(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ld(){return ld=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ld.apply(null,arguments)}function $se(e,t){if(e==null)return{};var r,n,a=zse(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function zse(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Hse(e){var{direction:t,width:r,dataKey:n,isAnimationActive:a,animationBegin:i,animationDuration:l,animationEasing:u}=e,h=$se(e,Lse),d=vt(h,!1),{data:m,dataPointFormatter:p,xAxisId:v,yAxisId:g,errorBarOffset:w}=Fse(),b=yse(v),S=bse(g);if(b?.scale==null||S?.scale==null||m==null||t==="x"&&b.type!=="number")return null;var j=m.map(_=>{var{x:A,y:k,value:O,errorVal:C}=p(_,n,t);if(!C)return null;var T=[],I,M;if(Array.isArray(C)?[I,M]=C:I=M=C,t==="x"){var{scale:W}=b,U=k+w,F=U+r,oe=U-r,je=W(O-I),ue=W(O+M);T.push({x1:ue,y1:F,x2:ue,y2:oe}),T.push({x1:je,y1:U,x2:ue,y2:U}),T.push({x1:je,y1:F,x2:je,y2:oe})}else if(t==="y"){var{scale:V}=S,H=A+w,Se=H-r,Q=H+r,z=V(O-I),Y=V(O+M);T.push({x1:Se,y1:Y,x2:Q,y2:Y}),T.push({x1:H,y1:z,x2:H,y2:Y}),T.push({x1:Se,y1:z,x2:Q,y2:z})}var P="".concat(A+w,"px ").concat(k+w,"px");return y.createElement(Wt,ld({className:"recharts-errorBar",key:"bar-".concat(T.map(q=>"".concat(q.x1,"-").concat(q.x2,"-").concat(q.y1,"-").concat(q.y2)))},d),T.map(q=>{var G=a?{transformOrigin:"".concat(q.x1-5,"px")}:void 0;return y.createElement(Oi,{from:{transform:"scaleY(0)",transformOrigin:P},to:{transform:"scaleY(1)",transformOrigin:P},begin:i,easing:u,isActive:a,duration:l,key:"line-".concat(q.x1,"-").concat(q.x2,"-").concat(q.y1,"-").concat(q.y2),style:{transformOrigin:P}},y.createElement("line",ld({},q,{style:G})))}))});return y.createElement(Wt,{className:"recharts-errorBars"},j)}var CR=y.createContext(void 0);function qse(e){var t=y.useContext(CR);return e??t??"x"}function OR(e){var{direction:t,children:r}=e;return y.createElement(CR.Provider,{value:t},r)}var DR={stroke:"black",strokeWidth:1.5,width:5,offset:0,isAnimationActive:!0,animationBegin:0,animationDuration:400,animationEasing:"ease-in-out"};function Vse(e){var t=qse(e.direction),{width:r,isAnimationActive:n,animationBegin:a,animationDuration:i,animationEasing:l}=Kn(e,DR);return y.createElement(y.Fragment,null,y.createElement(Ise,{dataKey:e.dataKey,direction:t}),y.createElement(Hse,ld({},e,{direction:t,width:r,isAnimationActive:n,animationBegin:a,animationDuration:i,animationEasing:l})))}class PR extends y.Component{render(){return y.createElement(Vse,this.props)}}kR(PR,"defaultProps",DR);kR(PR,"displayName","ErrorBar");var Kse="Invariant failed";function Gse(e,t){throw new Error(Kse)}var Wse=["x","y"];function gb(){return gb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gb.apply(null,arguments)}function m3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function mf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?m3(Object(r),!0).forEach(function(n){Yse(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Yse(e,t,r){return(t=Xse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Xse(e){var t=Zse(e,"string");return typeof t=="symbol"?t:t+""}function Zse(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qse(e,t){if(e==null)return{};var r,n,a=Jse(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Jse(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function ele(e,t){var{x:r,y:n}=e,a=Qse(e,Wse),i="".concat(r),l=parseInt(i,10),u="".concat(n),h=parseInt(u,10),d="".concat(t.height||a.height),m=parseInt(d,10),p="".concat(t.width||a.width),v=parseInt(p,10);return mf(mf(mf(mf(mf({},t),a),l?{x:l}:{}),h?{y:h}:{}),{},{height:m,width:v,name:t.name,radius:t.radius})}function RR(e){return y.createElement(sd,gb({shapeType:"rectangle",propTransformer:ele,activeClassName:"recharts-active-bar"},e))}var tle=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,a)=>{if(rt(t))return t;var i=rt(n)||Ot(n);return i?t(n,a):(i||Gse(),r)}};function Up(e,t){var r,n,a=et(d=>js(d,e)),i=et(d=>jl(d,t)),l=(r=a?.allowDataOverflow)!==null&&r!==void 0?r:na.allowDataOverflow,u=(n=i?.allowDataOverflow)!==null&&n!==void 0?n:aa.allowDataOverflow,h=l||u;return{needClip:h,needClipX:l,needClipY:u}}function Qw(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,a=Yw(),{needClipX:i,needClipY:l,needClip:u}=Up(t,r);if(!u)return null;var{x:h,y:d,width:m,height:p}=a;return y.createElement("clipPath",{id:"clipPath-".concat(n)},y.createElement("rect",{x:i?h:h-m/2,y:l?d:d-p/2,width:i?m:m*2,height:l?p:p*2}))}var rle=["onMouseEnter","onMouseLeave","onClick"],nle=["value","background","tooltipPosition"],ale=["onMouseEnter","onClick","onMouseLeave"];function od(){return od=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},od.apply(null,arguments)}function p3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function hn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?p3(Object(r),!0).forEach(function(n){$p(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $p(e,t,r){return(t=ile(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ile(e){var t=sle(e,"string");return typeof t=="symbol"?t:t+""}function sle(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yb(e,t){if(e==null)return{};var r,n,a=lle(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function lle(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var ole=e=>{var{dataKey:t,name:r,fill:n,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:n,value:ys(r,t),payload:e}]};function cle(e){var{dataKey:t,stroke:r,strokeWidth:n,fill:a,name:i,hide:l,unit:u}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:n,fill:a,dataKey:t,nameKey:void 0,name:ys(i,t),hide:l,type:e.tooltipType,color:e.fill,unit:u}}}function ule(e){var t=et(Ri),{data:r,dataKey:n,background:a,allOtherBarProps:i}=e,{onMouseEnter:l,onMouseLeave:u,onClick:h}=i,d=yb(i,rle),m=Fd(l,n),p=Id(u),v=Ld(h,n);if(!a||r==null)return null;var g=vt(a,!1);return y.createElement(y.Fragment,null,r.map((w,b)=>{var{value:S,background:j,tooltipPosition:_}=w,A=yb(w,nle);if(!j)return null;var k=m(w,b),O=p(w,b),C=v(w,b),T=hn(hn(hn(hn(hn({option:a,isActive:String(b)===t},A),{},{fill:"#eee"},j),g),bl(d,w,b)),{},{onMouseEnter:k,onMouseLeave:O,onClick:C,dataKey:n,index:b,className:"recharts-bar-background-rectangle"});return y.createElement(RR,od({key:"background-bar-".concat(b)},T))}))}function MR(e){var{data:t,props:r,showLabels:n}=e,a=vt(r,!1),{shape:i,dataKey:l,activeBar:u}=r,h=et(Ri),d=et(XP),{onMouseEnter:m,onClick:p,onMouseLeave:v}=r,g=yb(r,ale),w=Fd(m,l),b=Id(v),S=Ld(p,l);return t?y.createElement(y.Fragment,null,t.map((j,_)=>{var A=u&&String(_)===h&&(d==null||l===d),k=A?u:i,O=hn(hn(hn({},a),j),{},{isActive:A,option:k,index:_,dataKey:l});return y.createElement(Wt,od({className:"recharts-bar-rectangle"},bl(g,j,_),{onMouseEnter:w(j,_),onMouseLeave:b(j,_),onClick:S(j,_),key:"rectangle-".concat(j?.x,"-").concat(j?.y,"-").concat(j?.value,"-").concat(_)}),y.createElement(RR,O))}),n&&ki.renderCallByParent(r,t)):null}function fle(e){var{props:t,previousRectanglesRef:r}=e,{data:n,layout:a,isAnimationActive:i,animationBegin:l,animationDuration:u,animationEasing:h,onAnimationEnd:d,onAnimationStart:m}=t,p=r.current,v=Ud(t,"recharts-bar-"),[g,w]=y.useState(!1),b=y.useCallback(()=>{typeof d=="function"&&d(),w(!1)},[d]),S=y.useCallback(()=>{typeof m=="function"&&m(),w(!0)},[m]);return y.createElement(Oi,{begin:l,duration:u,isActive:i,easing:h,from:{t:0},to:{t:1},onAnimationEnd:b,onAnimationStart:S,key:v},j=>{var{t:_}=j,A=_===1?n:n.map((k,O)=>{var C=p&&p[O];if(C){var T=Nr(C.x,k.x),I=Nr(C.y,k.y),M=Nr(C.width,k.width),W=Nr(C.height,k.height);return hn(hn({},k),{},{x:T(_),y:I(_),width:M(_),height:W(_)})}if(a==="horizontal"){var U=Nr(0,k.height),F=U(_);return hn(hn({},k),{},{y:k.y+k.height-F,height:F})}var oe=Nr(0,k.width),je=oe(_);return hn(hn({},k),{},{width:je})});return _>0&&(r.current=A),y.createElement(Wt,null,y.createElement(MR,{props:t,data:A,showLabels:!g}))})}function dle(e){var{data:t,isAnimationActive:r}=e,n=y.useRef(null);return r&&t&&t.length&&(n.current==null||n.current!==t)?y.createElement(fle,{previousRectanglesRef:n,props:e}):y.createElement(MR,{props:e,data:t,showLabels:!0})}var FR=0,hle=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:Ft(e,t)}};class mle extends y.PureComponent{constructor(){super(...arguments),$p(this,"id",yl("recharts-bar-"))}render(){var{hide:t,data:r,dataKey:n,className:a,xAxisId:i,yAxisId:l,needClip:u,background:h,id:d,layout:m}=this.props;if(t)return null;var p=Tt("recharts-bar",a),v=Ot(d)?this.id:d;return y.createElement(Wt,{className:p},u&&y.createElement("defs",null,y.createElement(Qw,{clipPathId:v,xAxisId:i,yAxisId:l})),y.createElement(Wt,{className:"recharts-bar-rectangles",clipPath:u?"url(#clipPath-".concat(v,")"):null},y.createElement(ule,{data:r,dataKey:n,background:h,allOtherBarProps:this.props}),y.createElement(dle,this.props)),y.createElement(OR,{direction:m==="horizontal"?"y":"x"},this.props.children))}}var IR={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!Ss.isSsr,legendType:"rect",minPointSize:FR,xAxisId:0,yAxisId:0};function ple(e){var{xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:l,animationBegin:u,animationDuration:h,animationEasing:d,isAnimationActive:m}=Kn(e,IR),{needClip:p}=Up(t,r),v=hp(),g=Sn(),w=y.useMemo(()=>({barSize:e.barSize,data:void 0,dataKey:e.dataKey,maxBarSize:e.maxBarSize,minPointSize:i,stackId:V6(e.stackId)}),[e.barSize,e.dataKey,e.maxBarSize,i,e.stackId]),b=ko(e.children,Bi),S=et(A=>Ule(A,t,r,g,w,b));if(v!=="vertical"&&v!=="horizontal")return null;var j,_=S?.[0];return _==null||_.height==null||_.width==null?j=0:j=v==="vertical"?_.height/2:_.width/2,y.createElement(Xw,{xAxisId:t,yAxisId:r,data:S,dataPointFormatter:hle,errorBarOffset:j},y.createElement(mle,od({},e,{layout:v,needClip:p,data:S,xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:l,animationBegin:u,animationDuration:h,animationEasing:d,isAnimationActive:m})))}function xle(e){var{layout:t,barSettings:{dataKey:r,minPointSize:n},pos:a,bandSize:i,xAxis:l,yAxis:u,xAxisTicks:h,yAxisTicks:d,stackedData:m,displayedData:p,offset:v,cells:g}=e,w=t==="horizontal"?u:l,b=m?w.scale.domain():null,S=K6({numericAxis:w});return p.map((j,_)=>{var A,k,O,C,T,I;m?A=q6(m[_],b):(A=Ft(j,r),Array.isArray(A)||(A=[S,A]));var M=tle(n,FR)(A[1],_);if(t==="horizontal"){var W,[U,F]=[u.scale(A[0]),u.scale(A[1])];k=um({axis:l,ticks:h,bandSize:i,offset:a.offset,entry:j,index:_}),O=(W=F??U)!==null&&W!==void 0?W:void 0,C=a.size;var oe=U-F;if(T=ma(oe)?0:oe,I={x:k,y:v.top,width:C,height:v.height},Math.abs(M)>0&&Math.abs(T)<Math.abs(M)){var je=Ar(T||M)*(Math.abs(M)-Math.abs(T));O-=je,T+=je}}else{var[ue,V]=[l.scale(A[0]),l.scale(A[1])];if(k=ue,O=um({axis:u,ticks:d,bandSize:i,offset:a.offset,entry:j,index:_}),C=V-ue,T=a.size,I={x:v.left,y:O,width:v.width,height:T},Math.abs(M)>0&&Math.abs(C)<Math.abs(M)){var H=Ar(C||M)*(Math.abs(M)-Math.abs(C));C+=H}}var Se=hn(hn({},j),{},{x:k,y:O,width:C,height:T,value:m?A:A[1],payload:j,background:I,tooltipPosition:{x:k+C/2,y:O+T/2}},g&&g[_]&&g[_].props);return Se})}class Mi extends y.PureComponent{render(){return y.createElement(Zw,{type:"bar",data:null,xAxisId:this.props.xAxisId,yAxisId:this.props.yAxisId,zAxisId:0,dataKey:this.props.dataKey,stackId:this.props.stackId,hide:this.props.hide,barSize:this.props.barSize},y.createElement(AR,null),y.createElement(Ww,{legendPayload:ole(this.props)}),y.createElement(Bd,{fn:cle,args:this.props}),y.createElement(ple,this.props))}}$p(Mi,"displayName","Bar");$p(Mi,"defaultProps",IR);function x3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Eh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?x3(Object(r),!0).forEach(function(n){vle(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vle(e,t,r){return(t=gle(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gle(e){var t=yle(e,"string");return typeof t=="symbol"?t:t+""}function yle(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ble=(e,t)=>t,wle=(e,t,r)=>r,Sle=(e,t,r,n)=>n,Jw=(e,t,r,n,a)=>a,Ele=(e,t,r,n,a)=>a.maxBarSize,jle=(e,t,r,n,a,i)=>i,v3=(e,t,r)=>{var n=r??e;if(!Ot(n))return Dn(n,t,0)},Nle=Te([gt,Cd,ble,wle,Sle],(e,t,r,n,a)=>t.filter(i=>e==="horizontal"?i.xAxisId===r:i.yAxisId===n).filter(i=>i.isPanorama===a).filter(i=>i.hide===!1).filter(i=>i.type==="bar")),Ale=(e,t,r,n)=>{var a=gt(e);return a==="horizontal"?cb(e,"yAxis",r,n):cb(e,"xAxis",t,n)},_le=(e,t,r)=>{var n=gt(e);return n==="horizontal"?gk(e,"xAxis",t):gk(e,"yAxis",r)};function Tle(e){return e.stackId!=null&&e.dataKey!=null}var LR=(e,t,r)=>{var n={},a=e.filter(Tle),i=e.filter(d=>d.stackId==null),l=a.reduce((d,m)=>(d[m.stackId]||(d[m.stackId]=[]),d[m.stackId].push(m),d),n),u=Object.entries(l).map(d=>{var[m,p]=d,v=p.map(w=>w.dataKey),g=v3(t,r,p[0].barSize);return{stackId:m,dataKeys:v,barSize:g}}),h=i.map(d=>{var m=[d.dataKey].filter(v=>v!=null),p=v3(t,r,d.barSize);return{stackId:void 0,dataKeys:m,barSize:p}});return[...u,...h]},kle=Te([Nle,rP,_le],LR),Cle=(e,t,r,n,a)=>{var i,l,u=gt(e),h=jp(e),{maxBarSize:d}=a,m=Ot(d)?h:d,p,v;return u==="horizontal"?(p=Ka(e,"xAxis",t,n),v=Pi(e,"xAxis",t,n)):(p=Ka(e,"yAxis",r,n),v=Pi(e,"yAxis",r,n)),(i=(l=hs(p,v,!0))!==null&&l!==void 0?l:m)!==null&&i!==void 0?i:0},BR=(e,t,r,n)=>{var a=gt(e),i,l;return a==="horizontal"?(i=Ka(e,"xAxis",t,n),l=Pi(e,"xAxis",t,n)):(i=Ka(e,"yAxis",r,n),l=Pi(e,"yAxis",r,n)),hs(i,l)};function Ole(e,t,r,n,a){var i=n.length;if(!(i<1)){var l=Dn(e,r,0,!0),u,h=[];if(va(n[0].barSize)){var d=!1,m=r/i,p=n.reduce((j,_)=>j+(_.barSize||0),0);p+=(i-1)*l,p>=r&&(p-=(i-1)*l,l=0),p>=r&&m>0&&(d=!0,m*=.9,p=i*m);var v=(r-p)/2>>0,g={offset:v-l,size:0};u=n.reduce((j,_)=>{var A,k={stackId:_.stackId,dataKeys:_.dataKeys,position:{offset:g.offset+g.size+l,size:d?m:(A=_.barSize)!==null&&A!==void 0?A:0}},O=[...j,k];return g=O[O.length-1].position,O},h)}else{var w=Dn(t,r,0,!0);r-2*w-(i-1)*l<=0&&(l=0);var b=(r-2*w-(i-1)*l)/i;b>1&&(b>>=0);var S=va(a)?Math.min(b,a):b;u=n.reduce((j,_,A)=>[...j,{stackId:_.stackId,dataKeys:_.dataKeys,position:{offset:w+(b+l)*A+(b-S)/2,size:S}}],h)}return u}}var UR=(e,t,r,n,a,i,l)=>{var u=Ot(l)?t:l,h=Ole(r,n,a!==i?a:i,e,u);return a!==i&&h!=null&&(h=h.map(d=>Eh(Eh({},d),{},{position:Eh(Eh({},d.position),{},{offset:d.position.offset-a/2})}))),h},Dle=Te([kle,jp,tP,dw,Cle,BR,Ele],UR),Ple=(e,t,r,n)=>Ka(e,"xAxis",t,n),Rle=(e,t,r,n)=>Ka(e,"yAxis",r,n),Mle=(e,t,r,n)=>Pi(e,"xAxis",t,n),Fle=(e,t,r,n)=>Pi(e,"yAxis",r,n),Ile=Te([Dle,Jw],(e,t)=>{if(e!=null){var r=e.find(n=>n.stackId===t.stackId&&n.dataKeys.includes(t.dataKey));if(r!=null)return r.position}}),$R=(e,t)=>{if(!(!e||t?.dataKey==null)){var{stackId:r}=t;if(r!=null){var n=e[r];if(n){var{stackedData:a}=n;if(a){var i=a.find(l=>l.key===t.dataKey);return i}}}}},Lle=Te([Cd,Jw],(e,t)=>{if(e.some(r=>r.type==="bar"&&t.dataKey===r.dataKey&&t.stackId===r.stackId&&t.stackId===r.stackId))return t}),Ble=Te([Ale,Jw],$R),Ule=Te([Mr,Ple,Rle,Mle,Fle,Ile,gt,Sp,BR,Ble,Lle,jle],(e,t,r,n,a,i,l,u,h,d,m,p)=>{var{chartData:v,dataStartIndex:g,dataEndIndex:w}=u;if(!(m==null||i==null||l!=="horizontal"&&l!=="vertical"||t==null||r==null||n==null||a==null||h==null)){var{data:b}=m,S;if(b!=null&&b.length>0?S=b:S=v?.slice(g,w+1),S!=null)return xle({layout:l,barSettings:m,pos:i,bandSize:h,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:a,stackedData:d,displayedData:S,offset:e,cells:p})}});function g3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function km(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?g3(Object(r),!0).forEach(function(n){$le(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $le(e,t,r){return(t=zle(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zle(e){var t=Hle(e,"string");return typeof t=="symbol"?t:t+""}function Hle(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qle=(e,t)=>Td(e,t),Vle=(e,t)=>Lp(e,"radiusAxis",t),zp=Te([qle,Vle],(e,t)=>{if(!(e==null||t==null))return km(km({},e),{},{scale:t})}),eS=(e,t,r,n)=>mie(e,"radiusAxis",t,n),Kle=(e,t,r)=>_d(e,r),Gle=(e,t,r)=>Lp(e,"angleAxis",r),Hp=Te([Kle,Gle],(e,t)=>{if(!(e==null||t==null))return km(km({},e),{},{scale:t})}),tS=(e,t,r,n)=>hie(e,"angleAxis",r,n),Wle=(e,t,r,n)=>n,rS=Te([Mp,Wle],(e,t)=>{if(e.some(r=>r.type==="radialBar"&&t.dataKey===r.dataKey&&t.stackId===r.stackId))return t}),zR=Te([gt,zp,eS,Hp,tS],(e,t,r,n,a)=>gs(e,"radiusAxis")?hs(t,r,!1):hs(n,a,!1)),Yle=Te([Hp,zp,gt],(e,t,r)=>{var n=r==="radial"?e:t;if(!(n==null||n.scale==null))return K6({numericAxis:n})}),Xle=(e,t,r,n,a)=>a,Zle=(e,t,r,n,a)=>r,Qle=(e,t,r,n,a)=>t,HR=(e,t,r,n,a)=>n.maxBarSize,Jle=Te([gt,Mp,Zle,Qle],(e,t,r,n)=>t.filter(a=>e==="centric"?a.angleAxisId===r:a.radiusAxisId===n).filter(a=>a.hide===!1).filter(a=>a.type==="radialBar")),eoe=()=>{},toe=Te([Jle,rP,eoe],LR),roe=Te([gt,jp,Hp,tS,zp,eS,HR],(e,t,r,n,a,i,l)=>{var u,h,d=Ot(l)?t:l;if(e==="centric"){var m,p;return(m=(p=hs(r,n,!0))!==null&&p!==void 0?p:d)!==null&&m!==void 0?m:0}return(u=(h=hs(a,i,!0))!==null&&h!==void 0?h:d)!==null&&u!==void 0?u:0}),noe=Te([toe,jp,tP,dw,roe,zR,HR],UR),aoe=Te([noe,rS],(e,t)=>{if(!(e==null||t==null)){var r=e.find(n=>n.stackId===t.stackId&&t.dataKey!=null&&n.dataKeys.includes(t.dataKey));if(r!=null)return r.position}}),y3=Te([Ip,Fp,ru],Ew),ioe=(e,t,r)=>{var n=gt(e);return n==="centric"?y3(e,"radiusAxis",t):y3(e,"angleAxis",r)},soe=Te([ioe,rS],$R),loe=Te([Hp,tS,zp,eS,El,rS,zR,gt,Yle,oP,Xle,aoe,soe],(e,t,r,n,a,i,l,u,h,d,m,p,v)=>{var{chartData:g,dataStartIndex:w,dataEndIndex:b}=a;if(i==null||r==null||e==null||g==null||l==null||p==null||u!=="centric"&&u!=="radial"||n==null)return[];var{dataKey:S,minPointSize:j}=i,{cx:_,cy:A,startAngle:k,endAngle:O}=d,C=g.slice(w,b+1),T=u==="centric"?r:e,I=v?T.scale.domain():null;return woe({angleAxis:e,angleAxisTicks:t,bandSize:l,baseValue:h,cells:m,cx:_,cy:A,dataKey:S,dataStartIndex:w,displayedData:C,endAngle:O,layout:u,minPointSize:j,pos:p,radiusAxis:r,radiusAxisTicks:n,stackedData:v,stackedDomain:I,startAngle:k})}),ooe=Te([wp,(e,t)=>t],(e,t)=>{var{chartData:r,dataStartIndex:n,dataEndIndex:a}=e;if(r==null)return[];var i=r.slice(n,a+1);return i.length===0?[]:i.map(l=>({type:t,value:l.name,color:l.fill,payload:l}))}),coe=["shape","activeShape","cornerRadius"],uoe=["onMouseEnter","onClick","onMouseLeave"],foe=["value","background"];function bb(){return bb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},bb.apply(null,arguments)}function b3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Hr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?b3(Object(r),!0).forEach(function(n){nS(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nS(e,t,r){return(t=doe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function doe(e){var t=hoe(e,"string");return typeof t=="symbol"?t:t+""}function hoe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wb(e,t){if(e==null)return{};var r,n,a=moe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function moe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Sb=[];function qR(e){var{sectors:t,allOtherRadialBarProps:r,showLabels:n}=e,{shape:a,activeShape:i,cornerRadius:l}=r,u=wb(r,coe),h=vt(u,!1),d=et(Ri),{onMouseEnter:m,onClick:p,onMouseLeave:v}=r,g=wb(r,uoe),w=Fd(m,r.dataKey),b=Id(v),S=Ld(p,r.dataKey);return t==null?null:y.createElement(y.Fragment,null,t.map((j,_)=>{var A=i&&d===String(_),k=w(j,_),O=b(j,_),C=S(j,_),T=Hr(Hr(Hr(Hr({},h),{},{cornerRadius:jR(l)},j),bl(g,j,_)),{},{onMouseEnter:k,onMouseLeave:O,onClick:C,key:"sector-".concat(_),className:"recharts-radial-bar-sector ".concat(j.className),forceCornerRadius:u.forceCornerRadius,cornerIsExternal:u.cornerIsExternal,isActive:A,option:A?i:a});return y.createElement(NR,T)}),n&&ki.renderCallByParent(r,t))}function poe(e){var{props:t,previousSectorsRef:r}=e,{data:n,isAnimationActive:a,animationBegin:i,animationDuration:l,animationEasing:u,onAnimationEnd:h,onAnimationStart:d}=t,m=Ud(t,"recharts-radialbar-"),p=r.current,[v,g]=y.useState(!0),w=y.useCallback(()=>{typeof h=="function"&&h(),g(!1)},[h]),b=y.useCallback(()=>{typeof d=="function"&&d(),g(!0)},[d]);return y.createElement(Oi,{begin:i,duration:l,isActive:a,easing:u,from:{t:0},to:{t:1},onAnimationStart:b,onAnimationEnd:w,key:m},S=>{var{t:j}=S,_=j===1?n:(n??Sb).map((A,k)=>{var O=p&&p[k];if(O){var C=Nr(O.startAngle,A.startAngle),T=Nr(O.endAngle,A.endAngle);return Hr(Hr({},A),{},{startAngle:C(j),endAngle:T(j)})}var{endAngle:I,startAngle:M}=A,W=Nr(M,I);return Hr(Hr({},A),{},{endAngle:W(j)})});return j>0&&(r.current=_??null),y.createElement(Wt,null,y.createElement(qR,{sectors:_??Sb,allOtherRadialBarProps:t,showLabels:!v}))})}function xoe(e){var{data:t=[],isAnimationActive:r}=e,n=y.useRef(null),a=n.current;return r&&t&&t.length&&(!a||a!==t)?y.createElement(poe,{props:e,previousSectorsRef:n}):y.createElement(qR,{sectors:t,allOtherRadialBarProps:e,showLabels:!0})}function voe(e){var t=et(r=>ooe(r,e.legendType));return y.createElement(wR,{legendPayload:t??[]})}function goe(e){var{dataKey:t,data:r,stroke:n,strokeWidth:a,name:i,hide:l,fill:u,tooltipType:h}=e;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:n,strokeWidth:a,fill:u,nameKey:void 0,dataKey:t,name:ys(i,t),hide:l,type:h,color:u,unit:""}}}class yoe extends y.PureComponent{renderBackground(t){if(t==null)return null;var{cornerRadius:r}=this.props,n=vt(this.props.background,!1);return t.map((a,i)=>{var{value:l,background:u}=a,h=wb(a,foe);if(!u)return null;var d=Hr(Hr(Hr(Hr(Hr({cornerRadius:jR(r)},h),{},{fill:"#eee"},u),n),bl(this.props,a,i)),{},{index:i,key:"sector-".concat(i),className:Tt("recharts-radial-bar-background-sector",n?.className),option:u,isActive:!1});return y.createElement(NR,d)})}render(){var{hide:t,data:r,className:n,background:a}=this.props;if(t)return null;var i=Tt("recharts-area",n);return y.createElement(Wt,{className:i},a&&y.createElement(Wt,{className:"recharts-radial-bar-background"},this.renderBackground(r)),y.createElement(Wt,{className:"recharts-radial-bar-sectors"},y.createElement(xoe,this.props)))}}function boe(e){var t,r=ko(e.children,Bi),n={dataKey:e.dataKey,minPointSize:e.minPointSize,stackId:e.stackId,maxBarSize:e.maxBarSize,barSize:e.barSize},a=(t=et(i=>loe(i,e.radiusAxisId,e.angleAxisId,n,r)))!==null&&t!==void 0?t:Sb;return y.createElement(y.Fragment,null,y.createElement(Bd,{fn:goe,args:Hr(Hr({},e),{},{data:a})}),y.createElement(yoe,bb({},e,{data:a})))}var Mh={angleAxisId:0,radiusAxisId:0,minPointSize:0,hide:!1,legendType:"rect",data:[],isAnimationActive:!Ss.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease",forceCornerRadius:!1,cornerIsExternal:!1};function woe(e){var{displayedData:t,stackedData:r,dataStartIndex:n,stackedDomain:a,dataKey:i,baseValue:l,layout:u,radiusAxis:h,radiusAxisTicks:d,bandSize:m,pos:p,angleAxis:v,minPointSize:g,cx:w,cy:b,angleAxisTicks:S,cells:j,startAngle:_,endAngle:A}=e;return(t??[]).map((k,O)=>{var C,T,I,M,W,U;if(r?C=q6(r[n+O],a):(C=Ft(k,i),Array.isArray(C)||(C=[l,C])),u==="radial"){T=um({axis:h,ticks:d,bandSize:m,offset:p.offset,entry:k,index:O}),W=v.scale(C[1]),M=v.scale(C[0]),I=(T??0)+p.size;var F=W-M;if(Math.abs(g)>0&&Math.abs(F)<Math.abs(g)){var oe=Ar(F||g)*(Math.abs(g)-Math.abs(F));W+=oe}U={background:{cx:w,cy:b,innerRadius:T,outerRadius:I,startAngle:_,endAngle:A}}}else{T=h.scale(C[0]),I=h.scale(C[1]),M=um({axis:v,ticks:S,bandSize:m,offset:p.offset,entry:k,index:O}),W=(M??0)+p.size;var je=I-T;if(Math.abs(g)>0&&Math.abs(je)<Math.abs(g)){var ue=Ar(je||g)*(Math.abs(g)-Math.abs(je));I+=ue}}return Hr(Hr(Hr({},k),U),{},{payload:k,value:r?C:C[1],cx:w,cy:b,innerRadius:T,outerRadius:I,startAngle:M,endAngle:W},j&&j[O]&&j[O].props)})}class aS extends y.PureComponent{render(){var t,r,n;return y.createElement(y.Fragment,null,y.createElement(AR,null),y.createElement(_se,{data:void 0,dataKey:this.props.dataKey,hide:(t=this.props.hide)!==null&&t!==void 0?t:Mh.hide,angleAxisId:(r=this.props.angleAxisId)!==null&&r!==void 0?r:Mh.angleAxisId,radiusAxisId:(n=this.props.radiusAxisId)!==null&&n!==void 0?n:Mh.radiusAxisId,stackId:this.props.stackId,barSize:this.props.barSize,type:"radialBar"}),y.createElement(voe,this.props),y.createElement(boe,this.props))}}nS(aS,"displayName","RadialBar");nS(aS,"defaultProps",Mh);var VR=e=>{var{chartData:t}=e,r=Jt(),n=Sn();return y.useEffect(()=>n?()=>{}:(r(Tk(t)),()=>{r(Tk(void 0))}),[t,r,n]),null},w3={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},KR=Xa({name:"brush",initialState:w3,reducers:{setBrushSettings(e,t){return t.payload==null?w3:t.payload}}}),{setBrushSettings:fhe}=KR.actions,Soe=KR.reducer;function Eoe(e,t,r){return(t=joe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function joe(e){var t=Noe(e,"string");return typeof t=="symbol"?t:t+""}function Noe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class iS{static create(t){return new iS(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(n)switch(n){case"start":return this.scale(t);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+a}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(t)+i}default:return this.scale(t)}if(r){var l=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+l}return this.scale(t)}}isInRange(t){var r=this.range(),n=r[0],a=r[r.length-1];return n<=a?t>=n&&t<=a:t>=a&&t<=n}}Eoe(iS,"EPS",1e-4);function Aoe(e){return(e%180+180)%180}var _oe=function(t){var{width:r,height:n}=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=Aoe(a),l=i*Math.PI/180,u=Math.atan(n/r),h=l>u&&l<Math.PI-u?n/Math.sin(l):r/Math.cos(l);return Math.abs(h)},Toe={dots:[],areas:[],lines:[]},GR=Xa({name:"referenceElements",initialState:Toe,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=cs(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=cs(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=cs(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:dhe,removeDot:hhe,addArea:mhe,removeArea:phe,addLine:xhe,removeLine:vhe}=GR.actions,koe=GR.reducer,Coe=y.createContext(void 0),Ooe=e=>{var{children:t}=e,[r]=y.useState("".concat(yl("recharts"),"-clip")),n=Yw();if(n==null)return null;var{x:a,y:i,width:l,height:u}=n;return y.createElement(Coe.Provider,{value:r},y.createElement("defs",null,y.createElement("clipPath",{id:r},y.createElement("rect",{x:a,y:i,height:u,width:l}))),t)};function J1(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function WR(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],a=0;a<e.length;a+=t)n.push(e[a]);return n}function Doe(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return _oe(n,r)}function Poe(e,t,r){var n=r==="width",{x:a,y:i,width:l,height:u}=e;return t===1?{start:n?a:i,end:n?a+l:i+u}:{start:n?a+l:i+u,end:n?a:i}}function Cm(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var i=r();return e*(t-e*i/2-n)>=0&&e*(t+e*i/2-a)<=0}function Roe(e,t){return WR(e,t+1)}function Moe(e,t,r,n,a){for(var i=(n||[]).slice(),{start:l,end:u}=t,h=0,d=1,m=l,p=function(){var w=n?.[h];if(w===void 0)return{v:WR(n,d)};var b=h,S,j=()=>(S===void 0&&(S=r(w,b)),S),_=w.coordinate,A=h===0||Cm(e,_,j,m,u);A||(h=0,m=l,d+=1),A&&(m=_+e*(j()/2+a),h+=d)},v;d<=i.length;)if(v=p(),v)return v.v;return[]}function S3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function fn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?S3(Object(r),!0).forEach(function(n){Foe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Foe(e,t,r){return(t=Ioe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ioe(e){var t=Loe(e,"string");return typeof t=="symbol"?t:t+""}function Loe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Boe(e,t,r,n,a){for(var i=(n||[]).slice(),l=i.length,{start:u}=t,{end:h}=t,d=function(v){var g=i[v],w,b=()=>(w===void 0&&(w=r(g,v)),w);if(v===l-1){var S=e*(g.coordinate+e*b()/2-h);i[v]=g=fn(fn({},g),{},{tickCoord:S>0?g.coordinate-S*e:g.coordinate})}else i[v]=g=fn(fn({},g),{},{tickCoord:g.coordinate});var j=Cm(e,g.tickCoord,b,u,h);j&&(h=g.tickCoord-e*(b()/2+a),i[v]=fn(fn({},g),{},{isShow:!0}))},m=l-1;m>=0;m--)d(m);return i}function Uoe(e,t,r,n,a,i){var l=(n||[]).slice(),u=l.length,{start:h,end:d}=t;if(i){var m=n[u-1],p=r(m,u-1),v=e*(m.coordinate+e*p/2-d);l[u-1]=m=fn(fn({},m),{},{tickCoord:v>0?m.coordinate-v*e:m.coordinate});var g=Cm(e,m.tickCoord,()=>p,h,d);g&&(d=m.tickCoord-e*(p/2+a),l[u-1]=fn(fn({},m),{},{isShow:!0}))}for(var w=i?u-1:u,b=function(_){var A=l[_],k,O=()=>(k===void 0&&(k=r(A,_)),k);if(_===0){var C=e*(A.coordinate-e*O()/2-h);l[_]=A=fn(fn({},A),{},{tickCoord:C<0?A.coordinate-C*e:A.coordinate})}else l[_]=A=fn(fn({},A),{},{tickCoord:A.coordinate});var T=Cm(e,A.tickCoord,O,h,d);T&&(h=A.tickCoord+e*(O()/2+a),l[_]=fn(fn({},A),{},{isShow:!0}))},S=0;S<w;S++)b(S);return l}function sS(e,t,r){var{tick:n,ticks:a,viewBox:i,minTickGap:l,orientation:u,interval:h,tickFormatter:d,unit:m,angle:p}=e;if(!a||!a.length||!n)return[];if(rt(h)||Ss.isSsr){var v;return(v=Roe(a,rt(h)?h:0))!==null&&v!==void 0?v:[]}var g=[],w=u==="top"||u==="bottom"?"width":"height",b=m&&w==="width"?Ff(m,{fontSize:t,letterSpacing:r}):{width:0,height:0},S=(A,k)=>{var O=typeof d=="function"?d(A.value,k):A.value;return w==="width"?Doe(Ff(O,{fontSize:t,letterSpacing:r}),b,p):Ff(O,{fontSize:t,letterSpacing:r})[w]},j=a.length>=2?Ar(a[1].coordinate-a[0].coordinate):1,_=Poe(i,j,w);return h==="equidistantPreserveStart"?Moe(j,_,S,a,l):(h==="preserveStart"||h==="preserveStartEnd"?g=Uoe(j,_,S,a,l,h==="preserveStartEnd"):g=Boe(j,_,S,a,l),g.filter(A=>A.isShow))}var $oe=["viewBox"],zoe=["viewBox"];function jc(){return jc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jc.apply(null,arguments)}function E3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Dr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?E3(Object(r),!0).forEach(function(n){lS(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function j3(e,t){if(e==null)return{};var r,n,a=Hoe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Hoe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function lS(e,t,r){return(t=qoe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qoe(e){var t=Voe(e,"string");return typeof t=="symbol"?t:t+""}function Voe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class Al extends y.Component{constructor(t){super(t),this.tickRefs=y.createRef(),this.tickRefs.current=[],this.state={fontSize:"",letterSpacing:""}}shouldComponentUpdate(t,r){var{viewBox:n}=t,a=j3(t,$oe),i=this.props,{viewBox:l}=i,u=j3(i,zoe);return!J1(n,l)||!J1(a,u)||!J1(r,this.state)}getTickLineCoord(t){var{x:r,y:n,width:a,height:i,orientation:l,tickSize:u,mirror:h,tickMargin:d}=this.props,m,p,v,g,w,b,S=h?-1:1,j=t.tickSize||u,_=rt(t.tickCoord)?t.tickCoord:t.coordinate;switch(l){case"top":m=p=t.coordinate,g=n+ +!h*i,v=g-S*j,b=v-S*d,w=_;break;case"left":v=g=t.coordinate,p=r+ +!h*a,m=p-S*j,w=m-S*d,b=_;break;case"right":v=g=t.coordinate,p=r+ +h*a,m=p+S*j,w=m+S*d,b=_;break;default:m=p=t.coordinate,g=n+ +h*i,v=g+S*j,b=v+S*d,w=_;break}return{line:{x1:m,y1:v,x2:p,y2:g},tick:{x:w,y:b}}}getTickTextAnchor(){var{orientation:t,mirror:r}=this.props,n;switch(t){case"left":n=r?"start":"end";break;case"right":n=r?"end":"start";break;default:n="middle";break}return n}getTickVerticalAnchor(){var{orientation:t,mirror:r}=this.props;switch(t){case"left":case"right":return"middle";case"top":return r?"start":"end";default:return r?"end":"start"}}renderAxisLine(){var{x:t,y:r,width:n,height:a,orientation:i,mirror:l,axisLine:u}=this.props,h=Dr(Dr(Dr({},vt(this.props,!1)),vt(u,!1)),{},{fill:"none"});if(i==="top"||i==="bottom"){var d=+(i==="top"&&!l||i==="bottom"&&l);h=Dr(Dr({},h),{},{x1:t,y1:r+d*a,x2:t+n,y2:r+d*a})}else{var m=+(i==="left"&&!l||i==="right"&&l);h=Dr(Dr({},h),{},{x1:t+m*n,y1:r,x2:t+m*n,y2:r+a})}return y.createElement("line",jc({},h,{className:Tt("recharts-cartesian-axis-line",gl(u,"className"))}))}static renderTickItem(t,r,n){var a,i=Tt(r.className,"recharts-cartesian-axis-tick-value");if(y.isValidElement(t))a=y.cloneElement(t,Dr(Dr({},r),{},{className:i}));else if(typeof t=="function")a=t(Dr(Dr({},r),{},{className:i}));else{var l="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(l=Tt(l,t.className)),a=y.createElement(Rp,jc({},r,{className:l}),n)}return a}renderTicks(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],{tickLine:a,stroke:i,tick:l,tickFormatter:u,unit:h}=this.props,d=sS(Dr(Dr({},this.props),{},{ticks:n}),t,r),m=this.getTickTextAnchor(),p=this.getTickVerticalAnchor(),v=vt(this.props,!1),g=vt(l,!1),w=Dr(Dr({},v),{},{fill:"none"},vt(a,!1)),b=d.map((S,j)=>{var{line:_,tick:A}=this.getTickLineCoord(S),k=Dr(Dr(Dr(Dr({textAnchor:m,verticalAnchor:p},v),{},{stroke:"none",fill:i},g),A),{},{index:j,payload:S,visibleTicksCount:d.length,tickFormatter:u});return y.createElement(Wt,jc({className:"recharts-cartesian-axis-tick",key:"tick-".concat(S.value,"-").concat(S.coordinate,"-").concat(S.tickCoord)},bl(this.props,S,j)),a&&y.createElement("line",jc({},w,_,{className:Tt("recharts-cartesian-axis-tick-line",gl(a,"className"))})),l&&Al.renderTickItem(l,k,"".concat(typeof u=="function"?u(S.value,j):S.value).concat(h||"")))});return b.length>0?y.createElement("g",{className:"recharts-cartesian-axis-ticks"},b):null}render(){var{axisLine:t,width:r,height:n,className:a,hide:i}=this.props;if(i)return null;var{ticks:l}=this.props;return r!=null&&r<=0||n!=null&&n<=0?null:y.createElement(Wt,{className:Tt("recharts-cartesian-axis",a),ref:u=>{if(u){var h=u.getElementsByClassName("recharts-cartesian-axis-tick-value");this.tickRefs.current=Array.from(h);var d=h[0];if(d){var m=window.getComputedStyle(d).fontSize,p=window.getComputedStyle(d).letterSpacing;(m!==this.state.fontSize||p!==this.state.letterSpacing)&&this.setState({fontSize:window.getComputedStyle(d).fontSize,letterSpacing:window.getComputedStyle(d).letterSpacing})}}}},t&&this.renderAxisLine(),this.renderTicks(this.state.fontSize,this.state.letterSpacing,l),la.renderCallByParent(this.props))}}lS(Al,"displayName","CartesianAxis");lS(Al,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var Koe=["x1","y1","x2","y2","key"],Goe=["offset"],Woe=["xAxisId","yAxisId"],Yoe=["xAxisId","yAxisId"];function N3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function mn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?N3(Object(r),!0).forEach(function(n){Xoe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Xoe(e,t,r){return(t=Zoe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Zoe(e){var t=Qoe(e,"string");return typeof t=="symbol"?t:t+""}function Qoe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function io(){return io=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},io.apply(null,arguments)}function Om(e,t){if(e==null)return{};var r,n,a=Joe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Joe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var ece=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:n,y:a,width:i,height:l,ry:u}=e;return y.createElement("rect",{x:n,y:a,ry:u,width:i,height:l,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function YR(e,t){var r;if(y.isValidElement(e))r=y.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var{x1:n,y1:a,x2:i,y2:l,key:u}=t,h=Om(t,Koe),d=vt(h,!1),{offset:m}=d,p=Om(d,Goe);r=y.createElement("line",io({},p,{x1:n,y1:a,x2:i,y2:l,fill:"none",key:u}))}return r}function tce(e){var{x:t,width:r,horizontal:n=!0,horizontalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:i,yAxisId:l}=e,u=Om(e,Woe),h=a.map((d,m)=>{var p=mn(mn({},u),{},{x1:t,y1:d,x2:t+r,y2:d,key:"line-".concat(m),index:m});return YR(n,p)});return y.createElement("g",{className:"recharts-cartesian-grid-horizontal"},h)}function rce(e){var{y:t,height:r,vertical:n=!0,verticalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:i,yAxisId:l}=e,u=Om(e,Yoe),h=a.map((d,m)=>{var p=mn(mn({},u),{},{x1:d,y1:t,x2:d,y2:t+r,key:"line-".concat(m),index:m});return YR(n,p)});return y.createElement("g",{className:"recharts-cartesian-grid-vertical"},h)}function nce(e){var{horizontalFill:t,fillOpacity:r,x:n,y:a,width:i,height:l,horizontalPoints:u,horizontal:h=!0}=e;if(!h||!t||!t.length)return null;var d=u.map(p=>Math.round(p+a-a)).sort((p,v)=>p-v);a!==d[0]&&d.unshift(0);var m=d.map((p,v)=>{var g=!d[v+1],w=g?a+l-p:d[v+1]-p;if(w<=0)return null;var b=v%t.length;return y.createElement("rect",{key:"react-".concat(v),y:p,x:n,height:w,width:i,stroke:"none",fill:t[b],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return y.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},m)}function ace(e){var{vertical:t=!0,verticalFill:r,fillOpacity:n,x:a,y:i,width:l,height:u,verticalPoints:h}=e;if(!t||!r||!r.length)return null;var d=h.map(p=>Math.round(p+a-a)).sort((p,v)=>p-v);a!==d[0]&&d.unshift(0);var m=d.map((p,v)=>{var g=!d[v+1],w=g?a+l-p:d[v+1]-p;if(w<=0)return null;var b=v%r.length;return y.createElement("rect",{key:"react-".concat(v),x:p,y:i,width:w,height:u,stroke:"none",fill:r[b],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return y.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},m)}var ice=(e,t)=>{var{xAxis:r,width:n,height:a,offset:i}=e;return z6(sS(mn(mn(mn({},Al.defaultProps),r),{},{ticks:H6(r),viewBox:{x:0,y:0,width:n,height:a}})),i.left,i.left+i.width,t)},sce=(e,t)=>{var{yAxis:r,width:n,height:a,offset:i}=e;return z6(sS(mn(mn(mn({},Al.defaultProps),r),{},{ticks:H6(r),viewBox:{x:0,y:0,width:n,height:a}})),i.top,i.top+i.height,t)},lce={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function ml(e){var t=I2(),r=L2(),n=Y6(),a=mn(mn({},Kn(e,lce)),{},{x:rt(e.x)?e.x:n.left,y:rt(e.y)?e.y:n.top,width:rt(e.width)?e.width:n.width,height:rt(e.height)?e.height:n.height}),{xAxisId:i,yAxisId:l,x:u,y:h,width:d,height:m,syncWithTicks:p,horizontalValues:v,verticalValues:g}=a,w=Sn(),b=et(M=>yk(M,"xAxis",i,w)),S=et(M=>yk(M,"yAxis",l,w));if(!rt(d)||d<=0||!rt(m)||m<=0||!rt(u)||u!==+u||!rt(h)||h!==+h)return null;var j=a.verticalCoordinatesGenerator||ice,_=a.horizontalCoordinatesGenerator||sce,{horizontalPoints:A,verticalPoints:k}=a;if((!A||!A.length)&&typeof _=="function"){var O=v&&v.length,C=_({yAxis:S?mn(mn({},S),{},{ticks:O?v:S.ticks}):void 0,width:t,height:r,offset:n},O?!0:p);Mf(Array.isArray(C),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof C,"]")),Array.isArray(C)&&(A=C)}if((!k||!k.length)&&typeof j=="function"){var T=g&&g.length,I=j({xAxis:b?mn(mn({},b),{},{ticks:T?g:b.ticks}):void 0,width:t,height:r,offset:n},T?!0:p);Mf(Array.isArray(I),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof I,"]")),Array.isArray(I)&&(k=I)}return y.createElement("g",{className:"recharts-cartesian-grid"},y.createElement(ece,{fill:a.fill,fillOpacity:a.fillOpacity,x:a.x,y:a.y,width:a.width,height:a.height,ry:a.ry}),y.createElement(nce,io({},a,{horizontalPoints:A})),y.createElement(ace,io({},a,{verticalPoints:k})),y.createElement(tce,io({},a,{offset:n,horizontalPoints:A,xAxis:b,yAxis:S})),y.createElement(rce,io({},a,{offset:n,verticalPoints:k,xAxis:b,yAxis:S})))}ml.displayName="CartesianGrid";var XR=(e,t,r,n)=>Ka(e,"xAxis",t,n),ZR=(e,t,r,n)=>Pi(e,"xAxis",t,n),QR=(e,t,r,n)=>Ka(e,"yAxis",r,n),JR=(e,t,r,n)=>Pi(e,"yAxis",r,n),oce=Te([gt,XR,QR,ZR,JR],(e,t,r,n,a)=>gs(e,"xAxis")?hs(t,n,!1):hs(r,a,!1)),cce=(e,t,r,n,a)=>a,uce=Te([Cd,cce],(e,t)=>{if(e.some(r=>r.type==="line"&&t.dataKey===r.dataKey&&t.data===r.data))return t}),fce=Te([gt,XR,QR,ZR,JR,uce,oce,Sp],(e,t,r,n,a,i,l,u)=>{var{chartData:h,dataStartIndex:d,dataEndIndex:m}=u;if(!(i==null||t==null||r==null||n==null||a==null||n.length===0||a.length===0||l==null)){var{dataKey:p,data:v}=i,g;if(v!=null&&v.length>0?g=v:g=h?.slice(d,m+1),g!=null)return Cce({layout:e,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:a,dataKey:p,bandSize:l,displayedData:g})}}),dce=["type","layout","connectNulls","needClip"],hce=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId"];function eM(e,t){if(e==null)return{};var r,n,a=mce(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function mce(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function A3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ai(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?A3(Object(r),!0).forEach(function(n){qp(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qp(e,t,r){return(t=pce(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pce(e){var t=xce(e,"string");return typeof t=="symbol"?t:t+""}function xce(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $c(){return $c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$c.apply(null,arguments)}var vce=e=>{var{dataKey:t,name:r,stroke:n,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:n,value:ys(r,t),payload:e}]};function gce(e){var{dataKey:t,data:r,stroke:n,strokeWidth:a,fill:i,name:l,hide:u,unit:h}=e;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:n,strokeWidth:a,fill:i,dataKey:t,nameKey:void 0,name:ys(l,t),hide:u,type:e.tooltipType,color:e.stroke,unit:h}}}var tM=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function yce(e,t){for(var r=e.length%2!==0?[...e,0]:e,n=[],a=0;a<t;++a)n=[...n,...r];return n}var bce=(e,t,r)=>{var n=r.reduce((p,v)=>p+v);if(!n)return tM(t,e);for(var a=Math.floor(e/n),i=e%n,l=t-e,u=[],h=0,d=0;h<r.length;d+=r[h],++h)if(d+r[h]>i){u=[...r.slice(0,h),i-d];break}var m=u.length%2===0?[0,l]:[l];return[...yce(r,a),...u,...m].map(p=>"".concat(p,"px")).join(", ")};function wce(e,t){var r;if(y.isValidElement(e))r=y.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var n=Tt("recharts-line-dot",typeof e!="boolean"?e.className:"");r=y.createElement(fR,$c({},t,{className:n}))}return r}function Sce(e,t){return e==null?!1:t?!0:e.length===1}function Ece(e){var{clipPathId:t,points:r,props:n}=e,{dot:a,dataKey:i,needClip:l}=n;if(!Sce(r,a))return null;var u=U5(a),h=vt(n,!1),d=vt(a,!0),m=r.map((v,g)=>{var w=ai(ai(ai({key:"dot-".concat(g),r:3},h),d),{},{index:g,cx:v.x,cy:v.y,dataKey:i,value:v.value,payload:v.payload,points:r});return wce(a,w)}),p={clipPath:l?"url(#clipPath-".concat(u?"":"dots-").concat(t,")"):null};return y.createElement(Wt,$c({className:"recharts-line-dots",key:"dots"},p),m)}function Eb(e){var{clipPathId:t,pathRef:r,points:n,strokeDasharray:a,props:i,showLabels:l}=e,{type:u,layout:h,connectNulls:d,needClip:m}=i,p=eM(i,dce),v=ai(ai({},vt(p,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:m?"url(#clipPath-".concat(t,")"):null,points:n,type:u,layout:h,connectNulls:d,strokeDasharray:a??i.strokeDasharray});return y.createElement(y.Fragment,null,n?.length>1&&y.createElement(mp,$c({},v,{pathRef:r})),y.createElement(Ece,{points:n,clipPathId:t,props:i}),l&&ki.renderCallByParent(i,n))}function jce(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function Nce(e){var{clipPathId:t,props:r,pathRef:n,previousPointsRef:a,longestAnimatedLengthRef:i}=e,{points:l,strokeDasharray:u,isAnimationActive:h,animationBegin:d,animationDuration:m,animationEasing:p,animateNewValues:v,width:g,height:w,onAnimationEnd:b,onAnimationStart:S}=r,j=a.current,_=Ud(r,"recharts-line-"),[A,k]=y.useState(!1),O=y.useCallback(()=>{typeof b=="function"&&b(),k(!1)},[b]),C=y.useCallback(()=>{typeof S=="function"&&S(),k(!0)},[S]),T=jce(n.current),I=i.current;return y.createElement(Oi,{begin:d,duration:m,isActive:h,easing:p,from:{t:0},to:{t:1},onAnimationEnd:O,onAnimationStart:C,key:_},M=>{var{t:W}=M,U=Nr(I,T+I),F=Math.min(U(W),T),oe;if(u){var je="".concat(u).split(/[,\s]+/gim).map(H=>parseFloat(H));oe=bce(F,T,je)}else oe=tM(T,F);if(j){var ue=j.length/l.length,V=W===1?l:l.map((H,Se)=>{var Q=Math.floor(Se*ue);if(j[Q]){var z=j[Q],Y=Nr(z.x,H.x),P=Nr(z.y,H.y);return ai(ai({},H),{},{x:Y(W),y:P(W)})}if(v){var q=Nr(g*2,H.x),G=Nr(w/2,H.y);return ai(ai({},H),{},{x:q(W),y:G(W)})}return ai(ai({},H),{},{x:H.x,y:H.y})});return a.current=V,y.createElement(Eb,{props:r,points:V,clipPathId:t,pathRef:n,showLabels:!A,strokeDasharray:oe})}return W>0&&T>0&&(a.current=l,i.current=F),y.createElement(Eb,{props:r,points:l,clipPathId:t,pathRef:n,showLabels:!A,strokeDasharray:oe})})}function Ace(e){var{clipPathId:t,props:r}=e,{points:n,isAnimationActive:a}=r,i=y.useRef(null),l=y.useRef(0),u=y.useRef(null),h=i.current;return a&&n&&n.length&&h!==n?y.createElement(Nce,{props:r,clipPathId:t,previousPointsRef:i,longestAnimatedLengthRef:l,pathRef:u}):y.createElement(Eb,{props:r,points:n,clipPathId:t,pathRef:u,showLabels:!0})}var _ce=(e,t)=>({x:e.x,y:e.y,value:e.value,errorVal:Ft(e.payload,t)});class Tce extends y.Component{constructor(){super(...arguments),qp(this,"id",yl("recharts-line-"))}render(){var t,{hide:r,dot:n,points:a,className:i,xAxisId:l,yAxisId:u,top:h,left:d,width:m,height:p,id:v,needClip:g,layout:w}=this.props;if(r)return null;var b=Tt("recharts-line",i),S=Ot(v)?this.id:v,{r:j=3,strokeWidth:_=2}=(t=vt(n,!1))!==null&&t!==void 0?t:{r:3,strokeWidth:2},A=U5(n),k=j*2+_;return y.createElement(y.Fragment,null,y.createElement(Wt,{className:b},g&&y.createElement("defs",null,y.createElement(Qw,{clipPathId:S,xAxisId:l,yAxisId:u}),!A&&y.createElement("clipPath",{id:"clipPath-dots-".concat(S)},y.createElement("rect",{x:d-k/2,y:h-k/2,width:m+k,height:p+k}))),y.createElement(Ace,{props:this.props,clipPathId:S}),y.createElement(OR,{direction:w==="horizontal"?"y":"x"},y.createElement(Xw,{xAxisId:l,yAxisId:u,data:a,dataPointFormatter:_ce,errorBarOffset:0},this.props.children))),y.createElement(Ase,{activeDot:this.props.activeDot,points:a,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var rM={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!Ss.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0};function kce(e){var t=Kn(e,rM),{activeDot:r,animateNewValues:n,animationBegin:a,animationDuration:i,animationEasing:l,connectNulls:u,dot:h,hide:d,isAnimationActive:m,label:p,legendType:v,xAxisId:g,yAxisId:w}=t,b=eM(t,hce),{needClip:S}=Up(g,w),{height:j,width:_,x:A,y:k}=Yw(),O=hp(),C=Sn(),T=y.useMemo(()=>({dataKey:e.dataKey,data:e.data}),[e.dataKey,e.data]),I=et(M=>fce(M,g,w,C,T));return O!=="horizontal"&&O!=="vertical"?null:y.createElement(Tce,$c({},b,{connectNulls:u,dot:h,activeDot:r,animateNewValues:n,animationBegin:a,animationDuration:i,animationEasing:l,isAnimationActive:m,hide:d,label:p,legendType:v,xAxisId:g,yAxisId:w,points:I,layout:O,height:j,width:_,left:A,top:k,needClip:S}))}function Cce(e){var{layout:t,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:i,dataKey:l,bandSize:u,displayedData:h}=e;return h.map((d,m)=>{var p=Ft(d,l);return t==="horizontal"?{x:cm({axis:r,ticks:a,bandSize:u,entry:d,index:m}),y:Ot(p)?null:n.scale(p),value:p,payload:d}:{x:Ot(p)?null:r.scale(p),y:cm({axis:n,ticks:i,bandSize:u,entry:d,index:m}),value:p,payload:d}})}class zc extends y.PureComponent{render(){return y.createElement(Zw,{type:"line",data:this.props.data,xAxisId:this.props.xAxisId,yAxisId:this.props.yAxisId,zAxisId:0,dataKey:this.props.dataKey,stackId:void 0,hide:this.props.hide,barSize:void 0},y.createElement(Ww,{legendPayload:vce(this.props)}),y.createElement(Bd,{fn:gce,args:this.props}),y.createElement(kce,this.props))}}qp(zc,"displayName","Line");qp(zc,"defaultProps",rM);function _3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function T3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_3(Object(r),!0).forEach(function(n){Oce(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Oce(e,t,r){return(t=Dce(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Dce(e){var t=Pce(e,"string");return typeof t=="symbol"?t:t+""}function Pce(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Rce={xAxis:{},yAxis:{},zAxis:{}},nM=Xa({name:"cartesianAxis",initialState:Rce,reducers:{addXAxis(e,t){e.xAxis[t.payload.id]=t.payload},removeXAxis(e,t){delete e.xAxis[t.payload.id]},addYAxis(e,t){e.yAxis[t.payload.id]=t.payload},removeYAxis(e,t){delete e.yAxis[t.payload.id]},addZAxis(e,t){e.zAxis[t.payload.id]=t.payload},removeZAxis(e,t){delete e.zAxis[t.payload.id]},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload;e.yAxis[r]&&(e.yAxis[r]=T3(T3({},e.yAxis[r]),{},{width:n}))}}}),{addXAxis:Mce,removeXAxis:Fce,addYAxis:Ice,removeYAxis:Lce,addZAxis:Bce,removeZAxis:Uce,updateYAxisWidth:$ce}=nM.actions,zce=nM.reducer;function aM(e,t,r){return(t=Hce(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hce(e){var t=qce(e,"string");return typeof t=="symbol"?t:t+""}function qce(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vce(e){var t=Jt();return y.useEffect(()=>(t(Bce(e)),()=>{t(Uce(e))}),[e,t]),null}class Vp extends y.Component{render(){return y.createElement(Vce,{domain:this.props.domain,id:this.props.zAxisId,dataKey:this.props.dataKey,name:this.props.name,unit:this.props.unit,range:this.props.range,scale:this.props.scale,type:this.props.type,allowDuplicatedCategory:fl.allowDuplicatedCategory,allowDataOverflow:fl.allowDataOverflow,reversed:fl.reversed,includeHidden:fl.includeHidden})}}aM(Vp,"displayName","ZAxis");aM(Vp,"defaultProps",{zAxisId:0,range:fl.range,scale:fl.scale,type:fl.type});var Kce=["option","isActive"];function If(){return If=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},If.apply(null,arguments)}function Gce(e,t){if(e==null)return{};var r,n,a=Wce(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Wce(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Yce(e){var{option:t,isActive:r}=e,n=Gce(e,Kce);return typeof t=="string"?y.createElement(sd,If({option:y.createElement(rp,If({type:t},n)),isActive:r,shapeType:"symbols"},n)):y.createElement(sd,If({option:t,isActive:r,shapeType:"symbols"},n))}var Xce=(e,t,r,n,a,i,l)=>Ka(e,"xAxis",t,l),Zce=(e,t,r,n,a,i,l)=>Pi(e,"xAxis",t,l),Qce=(e,t,r,n,a,i,l)=>Ka(e,"yAxis",r,l),Jce=(e,t,r,n,a,i,l)=>Pi(e,"yAxis",r,l),eue=(e,t,r,n)=>kre(e,"zAxis",n,!1),tue=(e,t,r,n,a)=>a,rue=(e,t,r,n,a,i)=>i,nue=(e,t,r,n,a,i,l)=>Sp(e,t,r,l),aue=Te([Cd,tue],(e,t)=>{if(e.some(r=>r.type==="scatter"&&t.dataKey===r.dataKey&&t.data===r.data))return t}),iue=Te([nue,Xce,Zce,Qce,Jce,eue,aue,rue],(e,t,r,n,a,i,l,u)=>{var{chartData:h,dataStartIndex:d,dataEndIndex:m}=e;if(l!=null){var p;if(l?.data!=null&&l.data.length>0?p=l.data:p=h?.slice(d,m+1),!(p==null||t==null||n==null||r==null||a==null||r?.length===0||a?.length===0))return xue({displayedData:p,xAxis:t,yAxis:n,zAxis:i,scatterSettings:l,xAxisTicks:r,yAxisTicks:a,cells:u})}}),sue=["onMouseEnter","onClick","onMouseLeave"],lue=["animationBegin","animationDuration","animationEasing","hide","isAnimationActive","legendType","lineJointType","lineType","shape","xAxisId","yAxisId","zAxisId"];function iM(e,t){if(e==null)return{};var r,n,a=oue(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function oue(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Hc(){return Hc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Hc.apply(null,arguments)}function k3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Hn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?k3(Object(r),!0).forEach(function(n){oS(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function oS(e,t,r){return(t=cue(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cue(e){var t=uue(e,"string");return typeof t=="symbol"?t:t+""}function uue(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fue=e=>{var{dataKey:t,name:r,fill:n,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:n,value:ys(r,t),payload:e}]};function due(e){var{points:t,props:r}=e,{line:n,lineType:a,lineJointType:i}=r;if(!n)return null;var l=vt(r,!1),u=vt(n,!1),h,d;if(a==="joint")h=t.map(S=>({x:S.cx,y:S.cy}));else if(a==="fitting"){var{xmin:m,xmax:p,a:v,b:g}=UG(t),w=S=>v*S+g;h=[{x:m,y:w(m)},{x:p,y:w(p)}]}var b=Hn(Hn(Hn({},l),{},{fill:"none",stroke:l&&l.fill},u),{},{points:h});return y.isValidElement(n)?d=y.cloneElement(n,b):typeof n=="function"?d=n(b):d=y.createElement(mp,Hc({},b,{type:i})),y.createElement(Wt,{className:"recharts-scatter-line",key:"recharts-scatter-line"},d)}function sM(e){var{points:t,showLabels:r,allOtherScatterProps:n}=e,{shape:a,activeShape:i,dataKey:l}=n,u=vt(n,!1),h=et(Ri),{onMouseEnter:d,onClick:m,onMouseLeave:p}=n,v=iM(n,sue),g=Fd(d,n.dataKey),w=Id(p),b=Ld(m,n.dataKey);return t==null?null:y.createElement(y.Fragment,null,y.createElement(due,{points:t,props:n}),t.map((S,j)=>{var _=i&&h===String(j),A=_?i:a,k=Hn(Hn(Hn({key:"symbol-".concat(j)},u),S),{},{[R2]:j,[M2]:String(l)});return y.createElement(Wt,Hc({className:"recharts-scatter-symbol"},bl(v,S,j),{onMouseEnter:g(S,j),onMouseLeave:w(S,j),onClick:b(S,j),key:"symbol-".concat(S?.cx,"-").concat(S?.cy,"-").concat(S?.size,"-").concat(j)}),y.createElement(Yce,Hc({option:A,isActive:_},k)))}),r&&ki.renderCallByParent(n,t))}function hue(e){var{previousPointsRef:t,props:r}=e,{points:n,isAnimationActive:a,animationBegin:i,animationDuration:l,animationEasing:u}=r,h=t.current,d=Ud(r,"recharts-scatter-"),[m,p]=y.useState(!1),v=y.useCallback(()=>{p(!1)},[]),g=y.useCallback(()=>{p(!0)},[]);return y.createElement(Oi,{begin:i,duration:l,isActive:a,easing:u,from:{t:0},to:{t:1},onAnimationEnd:v,onAnimationStart:g,key:d},w=>{var{t:b}=w,S=b===1?n:n.map((j,_)=>{var A=h&&h[_];if(A){var k=Nr(A.cx,j.cx),O=Nr(A.cy,j.cy),C=Nr(A.size,j.size);return Hn(Hn({},j),{},{cx:k(b),cy:O(b),size:C(b)})}var T=Nr(0,j.size);return Hn(Hn({},j),{},{size:T(b)})});return b>0&&(t.current=S),y.createElement(Wt,null,y.createElement(sM,{points:S,allOtherScatterProps:r,showLabels:!m}))})}function mue(e){var{points:t,isAnimationActive:r}=e,n=y.useRef(null),a=n.current;return r&&t&&t.length&&(!a||a!==t)?y.createElement(hue,{props:e,previousPointsRef:n}):y.createElement(sM,{points:t,allOtherScatterProps:e,showLabels:!0})}function pue(e){var{dataKey:t,points:r,stroke:n,strokeWidth:a,fill:i,name:l,hide:u,tooltipType:h}=e;return{dataDefinedOnItem:r?.map(d=>d.tooltipPayload),positions:r?.map(d=>d.tooltipPosition),settings:{stroke:n,strokeWidth:a,fill:i,nameKey:void 0,dataKey:t,name:ys(l,t),hide:u,type:h,color:i,unit:""}}}function xue(e){var{displayedData:t,xAxis:r,yAxis:n,zAxis:a,scatterSettings:i,xAxisTicks:l,yAxisTicks:u,cells:h}=e,d=Ot(r.dataKey)?i.dataKey:r.dataKey,m=Ot(n.dataKey)?i.dataKey:n.dataKey,p=a&&a.dataKey,v=a?a.range:Vp.defaultProps.range,g=v&&v[0],w=r.scale.bandwidth?r.scale.bandwidth():0,b=n.scale.bandwidth?n.scale.bandwidth():0;return t.map((S,j)=>{var _=Ft(S,d),A=Ft(S,m),k=!Ot(p)&&Ft(S,p)||"-",O=[{name:Ot(r.dataKey)?i.name:r.name||r.dataKey,unit:r.unit||"",value:_,payload:S,dataKey:d,type:i.tooltipType},{name:Ot(n.dataKey)?i.name:n.name||n.dataKey,unit:n.unit||"",value:A,payload:S,dataKey:m,type:i.tooltipType}];k!=="-"&&O.push({name:a.name||a.dataKey,unit:a.unit||"",value:k,payload:S,dataKey:p,type:i.tooltipType});var C=cm({axis:r,ticks:l,bandSize:w,entry:S,index:j,dataKey:d}),T=cm({axis:n,ticks:u,bandSize:b,entry:S,index:j,dataKey:m}),I=k!=="-"?a.scale(k):g,M=Math.sqrt(Math.max(I,0)/Math.PI);return Hn(Hn({},S),{},{cx:C,cy:T,x:C-M,y:T-M,width:2*M,height:2*M,size:I,node:{x:_,y:A,z:k},tooltipPayload:O,tooltipPosition:{x:C,y:T},payload:S},h&&h[j]&&h[j].props)})}var vue=(e,t,r)=>({x:e.cx,y:e.cy,value:r==="x"?+e.node.x:+e.node.y,errorVal:Ft(e,t)});function gue(e){var t=y.useRef(yl("recharts-scatter-")),{hide:r,points:n,className:a,needClip:i,xAxisId:l,yAxisId:u,id:h,children:d}=e;if(r)return null;var m=Tt("recharts-scatter",a),p=Ot(h)?t.current:h;return y.createElement(Wt,{className:m,clipPath:i?"url(#clipPath-".concat(p,")"):null},i&&y.createElement("defs",null,y.createElement(Qw,{clipPathId:p,xAxisId:l,yAxisId:u})),y.createElement(Xw,{xAxisId:l,yAxisId:u,data:n,dataPointFormatter:vue,errorBarOffset:0},d),y.createElement(Wt,{key:"recharts-scatter-symbols"},y.createElement(mue,e)))}var lM={xAxisId:0,yAxisId:0,zAxisId:0,legendType:"circle",lineType:"joint",lineJointType:"linear",data:[],shape:"circle",hide:!1,isAnimationActive:!Ss.isSsr,animationBegin:0,animationDuration:400,animationEasing:"linear"};function yue(e){var t=Kn(e,lM),{animationBegin:r,animationDuration:n,animationEasing:a,hide:i,isAnimationActive:l,legendType:u,lineJointType:h,lineType:d,shape:m,xAxisId:p,yAxisId:v,zAxisId:g}=t,w=iM(t,lue),{needClip:b}=Up(p,v),S=y.useMemo(()=>ko(e.children,Bi),[e.children]),j=y.useMemo(()=>({name:e.name,tooltipType:e.tooltipType,data:e.data,dataKey:e.dataKey}),[e.data,e.dataKey,e.name,e.tooltipType]),_=Sn(),A=et(k=>iue(k,p,v,g,j,S,_));return b==null?null:y.createElement(y.Fragment,null,y.createElement(Bd,{fn:pue,args:Hn(Hn({},e),{},{points:A})}),y.createElement(gue,Hc({},w,{xAxisId:p,yAxisId:v,zAxisId:g,lineType:d,lineJointType:h,legendType:u,shape:m,hide:i,isAnimationActive:l,animationBegin:r,animationDuration:n,animationEasing:a,points:A,needClip:b})))}class cS extends y.Component{render(){return y.createElement(Zw,{type:"scatter",data:this.props.data,xAxisId:this.props.xAxisId,yAxisId:this.props.yAxisId,zAxisId:this.props.zAxisId,dataKey:this.props.dataKey,stackId:void 0,hide:this.props.hide,barSize:void 0},y.createElement(Ww,{legendPayload:fue(this.props)}),y.createElement(yue,this.props))}}oS(cS,"displayName","Scatter");oS(cS,"defaultProps",lM);var bue=["children"],wue=["dangerouslySetInnerHTML","ticks"];function oM(e,t,r){return(t=Sue(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Sue(e){var t=Eue(e,"string");return typeof t=="symbol"?t:t+""}function Eue(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jb(){return jb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jb.apply(null,arguments)}function cM(e,t){if(e==null)return{};var r,n,a=jue(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function jue(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Nue(e){var t=Jt(),r=y.useMemo(()=>{var{children:i}=e,l=cM(e,bue);return l},[e]),n=et(i=>js(i,r.id)),a=r===n;return y.useEffect(()=>(t(Mce(r)),()=>{t(Fce(r))}),[r,t]),a?e.children:null}var Aue=e=>{var{xAxisId:t,className:r}=e,n=et(W6),a=Sn(),i="xAxis",l=et(g=>iu(g,i,t,a)),u=et(g=>CP(g,i,t,a)),h=et(g=>AP(g,t)),d=et(g=>Are(g,t));if(h==null||d==null)return null;var{dangerouslySetInnerHTML:m,ticks:p}=e,v=cM(e,wue);return y.createElement(Al,jb({},v,{scale:l,x:d.x,y:d.y,width:h.width,height:h.height,className:Tt("recharts-".concat(i," ").concat(i),r),viewBox:n,ticks:u}))},_ue=e=>{var t,r,n,a,i;return y.createElement(Nue,{interval:(t=e.interval)!==null&&t!==void 0?t:"preserveEnd",id:e.xAxisId,scale:e.scale,type:e.type,padding:e.padding,allowDataOverflow:e.allowDataOverflow,domain:e.domain,dataKey:e.dataKey,allowDuplicatedCategory:e.allowDuplicatedCategory,allowDecimals:e.allowDecimals,tickCount:e.tickCount,includeHidden:(r=e.includeHidden)!==null&&r!==void 0?r:!1,reversed:e.reversed,ticks:e.ticks,height:e.height,orientation:e.orientation,mirror:e.mirror,hide:e.hide,unit:e.unit,name:e.name,angle:(n=e.angle)!==null&&n!==void 0?n:0,minTickGap:(a=e.minTickGap)!==null&&a!==void 0?a:5,tick:(i=e.tick)!==null&&i!==void 0?i:!0,tickFormatter:e.tickFormatter},y.createElement(Aue,e))};class fi extends y.Component{render(){return y.createElement(_ue,this.props)}}oM(fi,"displayName","XAxis");oM(fi,"defaultProps",{allowDataOverflow:na.allowDataOverflow,allowDecimals:na.allowDecimals,allowDuplicatedCategory:na.allowDuplicatedCategory,height:na.height,hide:!1,mirror:na.mirror,orientation:na.orientation,padding:na.padding,reversed:na.reversed,scale:na.scale,tickCount:na.tickCount,type:na.type,xAxisId:0});var Tue=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:a=0,tickMargin:i=0}=e,l=0;if(t){t.forEach(m=>{if(m){var p=m.getBoundingClientRect();p.width>l&&(l=p.width)}});var u=r?r.getBoundingClientRect().width:0,h=a+i,d=l+h+u+(r?n:0);return Math.round(d)}return 0},kue=["dangerouslySetInnerHTML","ticks"];function uM(e,t,r){return(t=Cue(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cue(e){var t=Oue(e,"string");return typeof t=="symbol"?t:t+""}function Oue(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Nb(){return Nb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Nb.apply(null,arguments)}function Due(e,t){if(e==null)return{};var r,n,a=Pue(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Pue(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Rue(e){var t=Jt();return y.useEffect(()=>(t(Ice(e)),()=>{t(Lce(e))}),[e,t]),null}var Mue=e=>{var t,{yAxisId:r,className:n,width:a,label:i}=e,l=y.useRef(null),u=y.useRef(null),h=et(W6),d=Sn(),m=Jt(),p="yAxis",v=et(A=>iu(A,p,r,d)),g=et(A=>_P(A,r)),w=et(A=>_re(A,r)),b=et(A=>CP(A,p,r,d));if(y.useLayoutEffect(()=>{var A;if(!(a!=="auto"||!g||Hw(i)||y.isValidElement(i))){var k=l.current,O=k==null||(A=k.tickRefs)===null||A===void 0?void 0:A.current,{tickSize:C,tickMargin:T}=k.props,I=Tue({ticks:O,label:u.current,labelGapWithTick:5,tickSize:C,tickMargin:T});Math.round(g.width)!==Math.round(I)&&m($ce({id:r,width:I}))}},[l,l==null||(t=l.current)===null||t===void 0||(t=t.tickRefs)===null||t===void 0?void 0:t.current,g?.width,g,m,i,r,a]),g==null||w==null)return null;var{dangerouslySetInnerHTML:S,ticks:j}=e,_=Due(e,kue);return y.createElement(Al,Nb({},_,{ref:l,labelRef:u,scale:v,x:w.x,y:w.y,width:g.width,height:g.height,className:Tt("recharts-".concat(p," ").concat(p),n),viewBox:h,ticks:b}))},Fue=e=>{var t,r,n,a,i;return y.createElement(y.Fragment,null,y.createElement(Rue,{interval:(t=e.interval)!==null&&t!==void 0?t:"preserveEnd",id:e.yAxisId,scale:e.scale,type:e.type,domain:e.domain,allowDataOverflow:e.allowDataOverflow,dataKey:e.dataKey,allowDuplicatedCategory:e.allowDuplicatedCategory,allowDecimals:e.allowDecimals,tickCount:e.tickCount,padding:e.padding,includeHidden:(r=e.includeHidden)!==null&&r!==void 0?r:!1,reversed:e.reversed,ticks:e.ticks,width:e.width,orientation:e.orientation,mirror:e.mirror,hide:e.hide,unit:e.unit,name:e.name,angle:(n=e.angle)!==null&&n!==void 0?n:0,minTickGap:(a=e.minTickGap)!==null&&a!==void 0?a:5,tick:(i=e.tick)!==null&&i!==void 0?i:!0,tickFormatter:e.tickFormatter}),y.createElement(Mue,e))},Iue={allowDataOverflow:aa.allowDataOverflow,allowDecimals:aa.allowDecimals,allowDuplicatedCategory:aa.allowDuplicatedCategory,hide:!1,mirror:aa.mirror,orientation:aa.orientation,padding:aa.padding,reversed:aa.reversed,scale:aa.scale,tickCount:aa.tickCount,type:aa.type,width:aa.width,yAxisId:0};class $a extends y.Component{render(){return y.createElement(Fue,this.props)}}uM($a,"displayName","YAxis");uM($a,"defaultProps",Iue);var ey={exports:{}},ty={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var C3;function Lue(){if(C3)return ty;C3=1;var e=Vc();function t(h,d){return h===d&&(h!==0||1/h===1/d)||h!==h&&d!==d}var r=typeof Object.is=="function"?Object.is:t,n=e.useSyncExternalStore,a=e.useRef,i=e.useEffect,l=e.useMemo,u=e.useDebugValue;return ty.useSyncExternalStoreWithSelector=function(h,d,m,p,v){var g=a(null);if(g.current===null){var w={hasValue:!1,value:null};g.current=w}else w=g.current;g=l(function(){function S(O){if(!j){if(j=!0,_=O,O=p(O),v!==void 0&&w.hasValue){var C=w.value;if(v(C,O))return A=C}return A=O}if(C=A,r(_,O))return C;var T=p(O);return v!==void 0&&v(C,T)?(_=O,C):(_=O,A=T)}var j=!1,_,A,k=m===void 0?null:m;return[function(){return S(d())},k===null?void 0:function(){return S(k())}]},[d,m,p,v]);var b=n(h,g[0],g[1]);return i(function(){w.hasValue=!0,w.value=b},[b]),u(b),b},ty}var O3;function Bue(){return O3||(O3=1,ey.exports=Lue()),ey.exports}Bue();function Uue(e){e()}function $ue(){let e=null,t=null;return{clear(){e=null,t=null},notify(){Uue(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const a=t={callback:r,next:null,prev:t};return a.prev?a.prev.next=a:e=a,function(){!n||e===null||(n=!1,a.next?a.next.prev=a.prev:t=a.prev,a.prev?a.prev.next=a.next:e=a.next)}}}}var D3={notify(){},get:()=>[]};function zue(e,t){let r,n=D3,a=0,i=!1;function l(b){m();const S=n.subscribe(b);let j=!1;return()=>{j||(j=!0,S(),p())}}function u(){n.notify()}function h(){w.onStateChange&&w.onStateChange()}function d(){return i}function m(){a++,r||(r=e.subscribe(h),n=$ue())}function p(){a--,r&&a===0&&(r(),r=void 0,n.clear(),n=D3)}function v(){i||(i=!0,m())}function g(){i&&(i=!1,p())}const w={addNestedSub:l,notifyNestedSubs:u,handleChangeWrapper:h,isSubscribed:d,trySubscribe:v,tryUnsubscribe:g,getListeners:()=>n};return w}var Hue=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",que=Hue(),Vue=()=>typeof navigator<"u"&&navigator.product==="ReactNative",Kue=Vue(),Gue=()=>que||Kue?y.useLayoutEffect:y.useEffect,Wue=Gue(),Yue=Symbol.for("react-redux-context"),Xue=typeof globalThis<"u"?globalThis:{};function Zue(){if(!y.createContext)return{};const e=Xue[Yue]??=new Map;let t=e.get(y.createContext);return t||(t=y.createContext(null),e.set(y.createContext,t)),t}var Que=Zue();function Jue(e){const{children:t,context:r,serverState:n,store:a}=e,i=y.useMemo(()=>{const h=zue(a);return{store:a,subscription:h,getServerState:n?()=>n:void 0}},[a,n]),l=y.useMemo(()=>a.getState(),[a]);Wue(()=>{const{subscription:h}=i;return h.onStateChange=h.notifyNestedSubs,h.trySubscribe(),l!==a.getState()&&h.notifyNestedSubs(),()=>{h.tryUnsubscribe(),h.onStateChange=void 0}},[i,l]);const u=r||Que;return y.createElement(u.Provider,{value:i},t)}var efe=Jue,tfe=(e,t)=>t,uS=Te([tfe,gt,oP,Kr,KP,Ns,kne,Mr],Rne),fS=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},fM=qa("mouseClick"),dM=wd();dM.startListening({actionCreator:fM,effect:(e,t)=>{var r=e.payload,n=uS(t.getState(),fS(r));n?.activeIndex!=null&&t.dispatch(Bre({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var Ab=qa("mouseMove"),hM=wd();hM.startListening({actionCreator:Ab,effect:(e,t)=>{var r=e.payload,n=t.getState(),a=Rw(n,n.tooltip.settings.shared),i=uS(n,fS(r));a==="axis"&&(i?.activeIndex!=null?t.dispatch(BP({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate})):t.dispatch(LP()))}});function rfe(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":t}var P3={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},mM=Xa({name:"rootProps",initialState:P3,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:P3.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),nfe=mM.reducer,{updateOptions:afe}=mM.actions,pM=Xa({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:ife}=pM.actions,sfe=pM.reducer,xM=qa("keyDown"),vM=qa("focus"),dS=wd();dS.startListening({actionCreator:xM,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip,i=e.payload;if(!(i!=="ArrowRight"&&i!=="ArrowLeft"&&i!=="Enter")){var l=Number(Mw(a,Po(r))),u=Ns(r);if(i==="Enter"){var h=Nm(r,"axis","hover",String(a.index));t.dispatch(fb({active:!a.active,activeIndex:a.index,activeDataKey:a.dataKey,activeCoordinate:h}));return}var d=Cre(r),m=d==="left-to-right"?1:-1,p=i==="ArrowRight"?1:-1,v=l+p*m;if(!(u==null||v>=u.length||v<0)){var g=Nm(r,"axis","hover",String(v));t.dispatch(fb({active:!0,activeIndex:v.toString(),activeDataKey:void 0,activeCoordinate:g}))}}}}});dS.startListening({actionCreator:vM,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip;if(!a.active&&a.index==null){var i="0",l=Nm(r,"axis","hover",String(i));t.dispatch(fb({activeDataKey:void 0,active:!0,activeIndex:i,activeCoordinate:l}))}}}});var Fa=qa("externalEvent"),gM=wd();gM.startListening({actionCreator:Fa,effect:(e,t)=>{if(e.payload.handler!=null){var r=t.getState(),n={activeCoordinate:yne(r),activeDataKey:XP(r),activeIndex:Ri(r),activeLabel:YP(r),activeTooltipIndex:Ri(r),isTooltipActive:bne(r)};e.payload.handler(n,e.payload.reactEvent)}}});var lfe=Te([su],e=>e.tooltipItemPayloads),ofe=Te([lfe,Rd,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,n)=>{var a=e.find(u=>u.settings.dataKey===n);if(a!=null){var{positions:i}=a;if(i!=null){var l=t(i,r);return l}}}),yM=qa("touchMove"),bM=wd();bM.startListening({actionCreator:yM,effect:(e,t)=>{var r=e.payload,n=t.getState(),a=Rw(n,n.tooltip.settings.shared);if(a==="axis"){var i=uS(n,fS({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));i?.activeIndex!=null&&t.dispatch(BP({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate}))}else if(a==="item"){var l,u=r.touches[0],h=document.elementFromPoint(u.clientX,u.clientY);if(!h||!h.getAttribute)return;var d=h.getAttribute(R2),m=(l=h.getAttribute(M2))!==null&&l!==void 0?l:void 0,p=ofe(t.getState(),d,m);t.dispatch(IP({activeDataKey:m,activeIndex:d,activeCoordinate:p}))}}});var cfe=g6({brush:Soe,cartesianAxis:zce,chartData:Xne,graphicalItems:Die,layout:PX,legend:vZ,options:Vne,polarAxis:xie,polarOptions:sfe,referenceElements:koe,rootProps:nfe,tooltip:Ure}),ufe=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return aX({reducer:cfe,preloadedState:t,middleware:n=>n({serializableCheck:!1}).concat([dM.middleware,hM.middleware,dS.middleware,gM.middleware,bM.middleware]),devTools:{serialize:{replacer:rfe},name:"recharts-".concat(r)}})};function wM(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,a=Sn(),i=y.useRef(null);if(a)return r;i.current==null&&(i.current=ufe(t,n));var l=A2;return y.createElement(efe,{context:l,store:i.current},r)}function SM(e){var{layout:t,width:r,height:n,margin:a}=e,i=Jt(),l=Sn();return y.useEffect(()=>{l||(i(CX(t)),i(OX({width:r,height:n})),i(kX(a)))},[i,l,t,r,n,a]),null}function EM(e){var t=Jt();return y.useEffect(()=>{t(afe(e))},[t,e]),null}var ffe=["children"];function dfe(e,t){if(e==null)return{};var r,n,a=hfe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function hfe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Dm(){return Dm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Dm.apply(null,arguments)}var mfe={width:"100%",height:"100%"},pfe=y.forwardRef((e,t)=>{var r=I2(),n=L2(),a=J6();if(!Fc(r)||!Fc(n))return null;var{children:i,otherAttributes:l,title:u,desc:h}=e,d,m;return typeof l.tabIndex=="number"?d=l.tabIndex:d=a?0:void 0,typeof l.role=="string"?m=l.role:m=a?"application":void 0,y.createElement(p2,Dm({},l,{title:u,desc:h,role:m,tabIndex:d,width:r,height:n,style:mfe,ref:t}),i)}),xfe=e=>{var{children:t}=e,r=et(dp);if(!r)return null;var{width:n,height:a,y:i,x:l}=r;return y.createElement(p2,{width:n,height:a,x:l,y:i},t)},R3=y.forwardRef((e,t)=>{var{children:r}=e,n=dfe(e,ffe),a=Sn();return a?y.createElement(xfe,null,r):y.createElement(pfe,Dm({ref:t},n),r)});function vfe(){var e=Jt(),[t,r]=y.useState(null),n=et(iZ);return y.useEffect(()=>{if(t!=null){var a=t.getBoundingClientRect(),i=a.width/t.offsetWidth;va(i)&&i!==n&&e(DX(i))}},[t,e,n]),r}function M3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function gfe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?M3(Object(r),!0).forEach(function(n){yfe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function yfe(e,t,r){return(t=bfe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bfe(e){var t=wfe(e,"string");return typeof t=="symbol"?t:t+""}function wfe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Sfe=y.forwardRef((e,t)=>{var{children:r,className:n,height:a,onClick:i,onContextMenu:l,onDoubleClick:u,onMouseDown:h,onMouseEnter:d,onMouseLeave:m,onMouseMove:p,onMouseUp:v,onTouchEnd:g,onTouchMove:w,onTouchStart:b,style:S,width:j}=e,_=Jt(),[A,k]=y.useState(null),[O,C]=y.useState(null);Jne();var T=vfe(),I=y.useCallback(P=>{T(P),typeof t=="function"&&t(P),k(P),C(P)},[T,t,k,C]),M=y.useCallback(P=>{_(fM(P)),_(Fa({handler:i,reactEvent:P}))},[_,i]),W=y.useCallback(P=>{_(Ab(P)),_(Fa({handler:d,reactEvent:P}))},[_,d]),U=y.useCallback(P=>{_(LP()),_(Fa({handler:m,reactEvent:P}))},[_,m]),F=y.useCallback(P=>{_(Ab(P)),_(Fa({handler:p,reactEvent:P}))},[_,p]),oe=y.useCallback(()=>{_(vM())},[_]),je=y.useCallback(P=>{_(xM(P.key))},[_]),ue=y.useCallback(P=>{_(Fa({handler:l,reactEvent:P}))},[_,l]),V=y.useCallback(P=>{_(Fa({handler:u,reactEvent:P}))},[_,u]),H=y.useCallback(P=>{_(Fa({handler:h,reactEvent:P}))},[_,h]),Se=y.useCallback(P=>{_(Fa({handler:v,reactEvent:P}))},[_,v]),Q=y.useCallback(P=>{_(Fa({handler:b,reactEvent:P}))},[_,b]),z=y.useCallback(P=>{_(yM(P)),_(Fa({handler:w,reactEvent:P}))},[_,w]),Y=y.useCallback(P=>{_(Fa({handler:g,reactEvent:P}))},[_,g]);return y.createElement(rR.Provider,{value:A},y.createElement($5.Provider,{value:O},y.createElement("div",{className:Tt("recharts-wrapper",n),style:gfe({position:"relative",cursor:"default",width:j,height:a},S),onClick:M,onContextMenu:ue,onDoubleClick:V,onFocus:oe,onKeyDown:je,onMouseDown:H,onMouseEnter:W,onMouseLeave:U,onMouseMove:F,onMouseUp:Se,onTouchEnd:Y,onTouchMove:z,onTouchStart:Q,ref:I},r)))}),Efe=["children","className","width","height","style","compact","title","desc"];function jfe(e,t){if(e==null)return{};var r,n,a=Nfe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Nfe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var jM=y.forwardRef((e,t)=>{var{children:r,className:n,width:a,height:i,style:l,compact:u,title:h,desc:d}=e,m=jfe(e,Efe),p=vt(m,!1);return u?y.createElement(R3,{otherAttributes:p,title:h,desc:d},r):y.createElement(Sfe,{className:n,style:l,width:a,height:i,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},y.createElement(R3,{otherAttributes:p,title:h,desc:d,ref:t},y.createElement(Ooe,null,r)))}),Afe=["width","height"];function _b(){return _b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_b.apply(null,arguments)}function _fe(e,t){if(e==null)return{};var r,n,a=Tfe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Tfe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var kfe={top:5,right:5,bottom:5,left:5},Cfe={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:kfe,reverseStackOrder:!1,syncMethod:"index"},hS=y.forwardRef(function(t,r){var n,a=Kn(t.categoricalChartProps,Cfe),{width:i,height:l}=a,u=_fe(a,Afe);if(!Fc(i)||!Fc(l))return null;var{chartName:h,defaultTooltipEventType:d,validateTooltipEventTypes:m,tooltipPayloadSearcher:p,categoricalChartProps:v}=t,g={chartName:h,defaultTooltipEventType:d,validateTooltipEventTypes:m,tooltipPayloadSearcher:p,eventEmitter:void 0};return y.createElement(wM,{preloadedState:{options:g},reduxStoreName:(n=v.id)!==null&&n!==void 0?n:h},y.createElement(VR,{chartData:v.data}),y.createElement(SM,{width:i,height:l,layout:a.layout,margin:a.margin}),y.createElement(EM,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),y.createElement(jM,_b({},u,{width:i,height:l,ref:r})))}),Ofe=["axis"],NM=y.forwardRef((e,t)=>y.createElement(hS,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Ofe,tooltipPayloadSearcher:Md,categoricalChartProps:e,ref:t})),Dfe=["axis","item"],qc=y.forwardRef((e,t)=>y.createElement(hS,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Dfe,tooltipPayloadSearcher:Md,categoricalChartProps:e,ref:t}));function Pfe(e){var t=Jt();return y.useEffect(()=>{t(ife(e))},[t,e]),null}var Rfe=["width","height","layout"];function Tb(){return Tb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Tb.apply(null,arguments)}function Mfe(e,t){if(e==null)return{};var r,n,a=Ffe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Ffe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Ife={top:5,right:5,bottom:5,left:5},Lfe={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:Ife,reverseStackOrder:!1,syncMethod:"index",layout:"radial"},AM=y.forwardRef(function(t,r){var n,a=Kn(t.categoricalChartProps,Lfe),{width:i,height:l,layout:u}=a,h=Mfe(a,Rfe);if(!Fc(i)||!Fc(l))return null;var{chartName:d,defaultTooltipEventType:m,validateTooltipEventTypes:p,tooltipPayloadSearcher:v}=t,g={chartName:d,defaultTooltipEventType:m,validateTooltipEventTypes:p,tooltipPayloadSearcher:v,eventEmitter:void 0};return y.createElement(wM,{preloadedState:{options:g},reduxStoreName:(n=a.id)!==null&&n!==void 0?n:d},y.createElement(VR,{chartData:a.data}),y.createElement(SM,{width:i,height:l,layout:u,margin:a.margin}),y.createElement(EM,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),y.createElement(Pfe,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),y.createElement(jM,Tb({width:i,height:l},h,{ref:r})))}),Bfe=["item"],Ufe={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},Kp=y.forwardRef((e,t)=>{var r=Kn(e,Ufe);return y.createElement(AM,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:Bfe,tooltipPayloadSearcher:Md,categoricalChartProps:r,ref:t})}),$fe=["item"],zfe=y.forwardRef((e,t)=>y.createElement(hS,{chartName:"ScatterChart",defaultTooltipEventType:"item",validateTooltipEventTypes:$fe,tooltipPayloadSearcher:Md,categoricalChartProps:e,ref:t})),Hfe=["axis","item"],qfe={layout:"radial",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},Vfe=y.forwardRef((e,t)=>{var r=Kn(e,qfe);return y.createElement(AM,{chartName:"RadialBarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Hfe,tooltipPayloadSearcher:Md,categoricalChartProps:r,ref:t})});const Kfe={},Ef=Kfe?.VITE_API_BASE||"https://clarus.elpiscapital.com/api",ni=e=>{if(e==null)return null;const t=typeof e=="number"?e:Number(String(e).replace(/[, ]/g,""));return Number.isFinite(t)?t:null},F3=e=>ni(e)?.toLocaleString(void 0,{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2})??"",Gfe=e=>ni(e)?.toLocaleString(void 0,{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0})??"",Wfe=e=>`$${Number(e||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`,Yfe=e=>`${Number(e||0).toLocaleString(void 0,{maximumFractionDigits:2})}%`,I3=e=>{const t=ni(e);return t==null?"":`${t>=0?"+ ":"- "}${Math.abs(t).toFixed(2)}%`},jh=e=>String(e).slice(0,7),Xfe=(e,t)=>{const r=new Date(e),n=new Date(t);return(n.getFullYear()-r.getFullYear())*12+(n.getMonth()-r.getMonth())},Lf=["#6366F1","#10B981","#60A5FA","#F59E0B","#EF4444","#8B5CF6","#14B8A6","#22C55E","#3B82F6","#EAB308","#F97316","#EC4899","#06B6D4","#84CC16"];function Zfe({cx:e,cy:t,innerRadius:r,outerRadius:n,startAngle:a,endAngle:i,fill:l}){return c.jsx(Sd,{cx:e,cy:t,innerRadius:r,outerRadius:n+8,startAngle:a,endAngle:i,fill:l,stroke:"#fff",strokeWidth:1.5})}function Qfe({active:e,payload:t}){if(!e||!t||!t.length)return null;const r=t[0],n=r?.payload?.percent!=null?r.payload.percent:r?.percent!=null?r.percent*100:null,a=r?.payload?.name??r?.name??"";return c.jsxs("div",{className:"rounded-md bg-white/95 shadow px-3 py-2 border border-gray-200",style:{pointerEvents:"none"},children:[c.jsx("div",{className:"text-sm font-semibold text-gray-800",children:n==null?"":Yfe(n)}),c.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[c.jsx("span",{className:"font-medium",children:a}),"  ",Wfe(r?.value)]})]})}function L3({data:e,title:t,total:r}){const n={inner:80,outer:112},[a,i]=y.useState(-1),l=a>=0&&e[a]?e[a].name:t,u=a>=0&&e[a]?e[a].value:r,h=y.useCallback((m,p)=>i(p),[]),d=y.useCallback(()=>i(-1),[]);return c.jsxs("div",{className:"relative h-64",children:[c.jsx(zn,{width:"100%",height:"100%",children:c.jsxs(Kp,{children:[c.jsx(ou,{data:e,dataKey:"value",nameKey:"name",innerRadius:n.inner,outerRadius:n.outer,paddingAngle:1.2,isAnimationActive:!0,stroke:"#fff",strokeWidth:1.5,activeIndex:a,activeShape:Zfe,onMouseEnter:h,onMouseLeave:d,children:e.map((m,p)=>c.jsx(Bi,{fill:m.color||Lf[p%Lf.length]},p))}),c.jsx($n,{content:c.jsx(Qfe,{})})]})}),c.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:c.jsxs("div",{className:"text-center leading-tight",children:[c.jsx("div",{className:"text-gray-500 text-sm",children:l}),c.jsx("div",{className:"text-xl font-extrabold text-gray-900",children:Gfe(u)})]})})]})}function Jfe(){const[e,t]=y.useState("all"),[r,n]=y.useState([]),[a,i]=y.useState(0),[l,u]=y.useState(!1),[h,d]=y.useState("");return y.useEffect(()=>{(async()=>{u(!0),d("");try{const p=await(await fetch(`${Ef}/users?type=${encodeURIComponent(e)}`,{headers:{Accept:"application/json"},cache:"no-store"})).json();n(p.items||[]),i(p.count||0)}catch(m){d(m.message||"Failed to load users")}finally{u(!1)}})()},[e]),c.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white mt-8",children:[c.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200",children:[c.jsxs("div",{className:"text-sm font-semibold text-gray-700",children:["Users (",a,")"]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-sm text-gray-600",children:"Filter"}),c.jsxs("select",{className:"border rounded px-2 py-1 text-sm",value:e,onChange:m=>t(m.target.value),children:[c.jsx("option",{value:"all",children:"All"}),c.jsx("option",{value:"investor",children:"Investor"}),c.jsx("option",{value:"admin",children:"Admin"}),c.jsx("option",{value:"group-admin",children:"Group Admin"})]})]})]}),h&&c.jsx("div",{className:"px-4 py-3 text-sm text-red-600",children:h}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-600",children:"Name"}),c.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-600",children:"Email"}),c.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-600",children:"Type"}),c.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-600",children:"Organization"}),c.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-600",children:"Status"}),c.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-600",children:"Permission"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-100",children:r.length?r.map(m=>c.jsxs("tr",{children:[c.jsx("td",{className:"px-4 py-2",children:m.name}),c.jsx("td",{className:"px-4 py-2",children:m.email}),c.jsx("td",{className:"px-4 py-2",children:m.user_type}),c.jsx("td",{className:"px-4 py-2",children:m.organization||""}),c.jsx("td",{className:"px-4 py-2",children:m.status}),c.jsx("td",{className:"px-4 py-2",children:m.permission})]},m.id)):c.jsx("tr",{children:c.jsx("td",{className:"px-4 py-4 text-gray-500",colSpan:6,children:h||"No users found."})})})]})})]})}function B3(){const[e,t]=y.useState("portfolio"),[r,n]=y.useState(null),[a,i]=y.useState(null),[l,u]=y.useState(null),[h,d]=y.useState(null),[m,p]=y.useState(null),[v,g]=y.useState(""),[w,b]=y.useState({source:"db",basis:"range",period_end:""}),[S,j]=y.useState([]),[_,A]=y.useState([]),[k,O]=y.useState(""),[C,T]=y.useState(""),[I,M]=y.useState({total:0,items:[],as_of:null}),[W,U]=y.useState({total:0,items:[],as_of:null}),F=y.useCallback((H,Se,Q)=>{const z=Array.isArray(Q)?Q:S;if(!z.length||!H||!Se)return{init:null,cur:null};const Y=fe=>z.find(Oe=>jh(Oe.as_of_date)===fe),P=Y(H),q=Y(Se);let G=null,Z=ni(q?.ending_balance);if(H===Se){if(G=ni(P?.beginning_balance),G==null){const[fe,Oe]=H.split("-").map(Number),Re=Oe===1?`${fe-1}-12`:`${fe}-${String(Oe-1).padStart(2,"0")}`,re=Y(Re);G=ni(re?.ending_balance)??Z??0}}else G=ni(P?.ending_balance);return{init:G,cur:Z}},[S]),oe=(H,Se,Q,z)=>{if(!H||!Se||!Q||!z)return null;const P=Math.max(1,Xfe(`${H}-01`,`${Se}-01`))/12;return(Math.pow(z/Q,1/P)-1)*100},je=(H,Se,Q)=>{if(!H||!Se)return;const z=Array.isArray(Q)?Q:S;if(!z.length)return;const Y=Array.from(new Set(z.map(Oe=>jh(Oe.as_of_date))));if(Y.indexOf(H)>Y.indexOf(Se)){g("Invalid month range");return}g("");const{init:P,cur:q}=F(H,Se,z),G=P?q/P:null,Z=P?(q-P)/P*100:null,fe=oe(H,Se,P,q);n(P),i(q),d(G),u(Z),p(fe),b({source:"db",basis:"range",period_end:Se})};y.useEffect(()=>{(async()=>{g("");try{const Se=await(await fetch(`${Ef}/metrics/admin-periods`,{headers:{Accept:"application/json"},cache:"no-store"})).json();if(!Array.isArray(Se)||!Se.length)throw new Error("No data");Se.sort((P,q)=>new Date(P.as_of_date)-new Date(q.as_of_date)),j(Se);const Q=Array.from(new Set(Se.map(P=>jh(P.as_of_date))));A(Q);const z=Q[0],Y=Q[Q.length-1];O(z),T(Y),je(z,Y,Se)}catch(H){g(H.message||"Failed to load data")}})()},[]),y.useEffect(()=>{let H;return(async()=>{try{H=new EventSource(`${Ef}/metrics/stream`),H.addEventListener("refresh",async()=>{try{const Q=await(await fetch(`${Ef}/metrics/admin-periods`,{headers:{Accept:"application/json"},cache:"no-store"})).json();if(!Array.isArray(Q)||!Q.length)return;Q.sort((q,G)=>new Date(q.as_of_date)-new Date(G.as_of_date)),j(Q);const z=Array.from(new Set(Q.map(q=>jh(q.as_of_date))));A(z);const Y=z.includes(k)?k:z[0],P=z.includes(C)?C:z[z.length-1];O(Y),T(P),je(Y,P,Q)}catch{}})}catch{}})(),()=>H?.close()},[k,C]);const ue=async H=>{try{const Se=await fetch(`${Ef}/metrics/allocation?period_end=${encodeURIComponent(H)}`,{headers:{Accept:"application/json"},cache:"no-store"}),Q=await Se.json();if(!Se.ok)return{total:0,as_of:null,items:[]};const z=(Q.items||[]).map((Y,P)=>({name:Y.name,value:Number(Y.value||0),percent:Number(Y.percent||0),color:Y.color||Lf[P%Lf.length]})).filter(Y=>Y.value>0);return{total:Number(Q.total||0),as_of:Q.as_of,items:z}}catch{return{total:0,as_of:null,items:[]}}},V=(H,Se)=>{const Q=ni(Se)??ni(H.total)??0,z=H.items&&H.items.length?H.items:Q>0?[{name:"All",value:Q,percent:100,color:Lf[0]}]:[];return{...H,total:Q,items:z}};return y.useEffect(()=>{(async()=>{if(!k||!C||!S.length)return;const[H,Se]=await Promise.all([ue(k),ue(C)]),{init:Q,cur:z}=F(k,C,S);M(V(H,Q)),U(V(Se,z))})()},[k,C,S,F]),c.jsxs("div",{className:"p-6 bg-white rounded-2xl shadow",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h2",{className:"text-sm font-semibold text-gray-700",children:"Overview"}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"text-sm text-gray-600",children:"From"}),c.jsx("select",{className:"border rounded px-2 py-1 text-sm",value:k,onChange:H=>O(H.target.value),children:_.map(H=>c.jsx("option",{value:H,children:H},H))}),c.jsx("div",{className:"text-sm text-gray-600",children:"to"}),c.jsx("select",{className:"border rounded px-2 py-1 text-sm",value:C,onChange:H=>T(H.target.value),children:_.map(H=>c.jsx("option",{value:H,children:H},H))}),c.jsx("button",{className:"px-3 py-1 rounded text-sm bg-sky-600 text-white hover:bg-sky-700",onClick:()=>je(k,C),title:"Apply month range",children:"Apply"}),c.jsx("button",{className:"text-sky-600 text-sm hover:underline",onClick:()=>{if(!_.length)return;const H=_[0],Se=_[_.length-1];O(H),T(Se),je(H,Se)},title:"Reset to full span",children:"Reset"})]})]}),v&&c.jsxs("div",{className:"mb-4 text-sm text-red-600",children:["Error: ",v]}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"rounded-xl border border-gray-200 bg-slate-50 p-6",children:c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 items-center gap-4",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-xs text-gray-500",children:"Initial value"}),c.jsx("div",{className:"text-2xl font-semibold text-sky-700",children:F3(r)})]}),c.jsx("div",{className:"text-center text-2xl text-gray-400",children:""}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-xs text-gray-500",children:"Current value"}),c.jsx("div",{className:"text-2xl font-semibold text-sky-700",children:F3(a)})]})]})}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"rounded-xl border border-gray-200 p-4",children:[c.jsx("div",{className:"text-xs text-gray-500",children:"ROI"}),c.jsx("div",{className:"mt-2 text-lg font-semibold text-gray-800",children:I3(l)})]}),c.jsxs("div",{className:"rounded-xl border border-gray-200 p-4",children:[c.jsx("div",{className:"text-xs text-gray-500",children:"MOIC"}),c.jsx("div",{className:"mt-2 text-lg font-semibold text-gray-800",children:ni(h)==null?"":`${ni(h).toFixed(2)}x`})]}),c.jsxs("div",{className:"rounded-xl border border-gray-200 p-4",children:[c.jsx("div",{className:"text-xs text-gray-500",children:"IRR (annualized)"}),c.jsx("div",{className:"mt-2 text-lg font-semibold text-gray-800",children:m==null?"":I3(m)})]})]})]}),c.jsxs("div",{className:"rounded-xl border border-gray-200 p-4",children:[c.jsxs("div",{className:"flex gap-6 text-sm mb-3 border-b border-gray-200",children:[c.jsx("button",{onClick:()=>t("portfolio"),className:`pb-2 -mb-px ${e==="portfolio"?"text-sky-700 border-b-2 border-sky-600 font-medium":"text-gray-500 hover:text-gray-700"}`,children:"Portfolio Allocation"}),c.jsx("button",{onClick:()=>t("industry"),className:`pb-2 -mb-px ${e==="industry"?"text-sky-700 border-b-2 border-sky-600 font-medium":"text-gray-500 hover:text-gray-700"}`,children:"Industry Allocation"}),c.jsx("button",{onClick:()=>t("top"),className:`pb-2 -mb-px ${e==="top"?"text-sky-700 border-b-2 border-sky-600 font-medium":"text-gray-500 hover:text-gray-700"}`,children:"Top Performers"})]}),c.jsx("div",{className:"text-center text-sm text-gray-600 mb-2",children:"All"}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 items-center",children:[c.jsxs("div",{children:[c.jsx(L3,{data:I.items,title:"Initial Value",total:I.total}),k&&c.jsxs("div",{className:"text-center text-[11px] text-gray-500 -mt-1",children:["as of ",k]})]}),c.jsx("div",{className:"hidden sm:flex items-center justify-center text-2xl text-gray-400",children:""}),c.jsxs("div",{children:[c.jsx(L3,{data:W.items,title:"Current Value",total:W.total}),C&&c.jsxs("div",{className:"text-center text-[11px] text-gray-500 -mt-1",children:["as of ",C]})]})]})]})]}),c.jsx(Jfe,{})]})}const ede=()=>c.jsx("style",{children:`
    .inner-x-scroll{overflow-x:auto;overflow-y:hidden;max-width:100%}
    .inner-x-scroll::-webkit-scrollbar{height:10px}
    .inner-x-scroll::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:8px}
    .inner-x-scroll::-webkit-scrollbar-track{background:#f1f5f9}
    .btn{display:inline-flex;align-items:center;gap:.5rem;padding:.5rem .9rem;border-radius:.6rem;border:1px solid #cbd5e1;background:#fff}
    .btn:hover{background:#f8fafc}
    .btn-primary{border-color:#0284c7;background:#0ea5e9;color:white}
    .btn-primary:hover{background:#0284c7}
    .btn-muted{border-color:#e2e8f0;background:#f8fafc;color:#334155}
    .select{padding:.5rem .6rem;border:1px solid #cbd5e1;border-radius:.6rem;background:#fff}
    .label{font-size:.85rem;color:#475569}

    /* Help tooltip */
    .qwrap{position:relative;display:inline-flex;align-items:center}
    .qmark{display:inline-flex;align-items:center;justify-content:center;width:18px;height:18px;border-radius:9999px;border:1px solid #cbd5e1;color:#64748b;background:#fff;font-weight:700;font-size:.75rem;line-height:1}
    .qtip{position:absolute; bottom:150%; left:0; background:#ffffff; color:#111827; border:1px solid #e5e7eb; border-radius:12px; padding:.6rem .8rem; font-size:.8rem; line-height:1.2; white-space:normal; min-width:160px; max-width:280px; box-shadow:0 10px 24px rgba(2,6,23,.15); opacity:0; pointer-events:none; transform:translateY(0); transition:opacity .16s ease, transform .16s ease; z-index:40}
    .qtip:before{content:""; position:absolute; top:100%; left:13px; border-width:11px 10px 0 10px; border-style:solid; border-color:rgba(2,6,23,.08) transparent transparent transparent}
    .qtip:after{content:""; position:absolute; top:calc(100% - 1px); left:14px; border-width:10px 9px 0 9px; border-style:solid; border-color:#ffffff transparent transparent transparent}
    .qwrap:hover .qtip{opacity:1; transform:translateY(-6px); pointer-events:auto}
  `}),Pm=e=>`$${Number(e||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`,tde=e=>e==null||Number.isNaN(Number(e))?"":`${Number(e).toFixed(2)}%`,ry=e=>{const t=Number(e||0);return Number.isFinite(t)?`${t>0?"+":t<0?"-":""} ${Math.abs(t).toFixed(2)}%`:""},rde=e=>{const t=Number(e||0);return`${t>0?"+":"-"} ${Math.abs(t).toFixed(2)}x`},Nh=(e,{allowMuted:t}={})=>t&&(e==null||Number.isNaN(Number(e)))?"muted":Number(e)>0?"positive":Number(e)<0?"negative":"muted",Rm=["#6366F1","#10B981","#60A5FA","#F59E0B","#EF4444","#8B5CF6","#14B8A6","#22C55E","#3B82F6","#EAB308","#F97316","#EC4899","#06B6D4","#84CC16"],lr=e=>typeof e=="string"&&/^\d{4}-(0[1-9]|1[0-2])$/.test(e),Ra=e=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}`,Ql=e=>{const[t,r]=e.split("-").map(Number);return new Date(t,r-1,1).toLocaleString(void 0,{month:"short",year:"numeric"})},U3=e=>{if(!lr(e))return null;const[t,r]=e.split("-").map(Number);return new Date(t,r-1,1)},nde=e=>document.cookie.split("; ").find(t=>t.startsWith(e+"="))?.split("=")[1]??"",ny=(e={})=>({credentials:"include",headers:{"X-XSRF-TOKEN":nde("XSRF-TOKEN"),...e.headers||{}},...e});function ade({text:e}){return c.jsxs("span",{className:"qwrap ml-1",children:[c.jsx("span",{className:"qmark","aria-label":"Help",children:"?"}),c.jsx("span",{className:"qtip",children:e})]})}function ide({title:e,totalLabel:t,totalValue:r,data:n}){const a=Array.isArray(n)?n:[],[i,l]=y.useState(-1),u=a.some(v=>Number(v?.value)>0),h=u?a:[{name:"Total",value:Math.max(1,Number(r)||1),percent:100,color:"#E2E8F0"}],d=i>=0&&h[i]?h[i].value:r,m=({active:v,payload:g})=>{if(!v||!g||!g.length)return null;const w=g[0]?.payload||{};return c.jsxs("div",{className:"bg-white shadow rounded-lg px-3 py-2 border border-slate-200 text-sm",children:[c.jsx("div",{className:"font-semibold text-slate-800",children:w.name||""}),c.jsx("div",{className:"text-emerald-600",children:tde(w.percent)}),c.jsx("div",{className:"text-slate-700",children:Pm(w.value)})]})},p=({cx:v,cy:g,innerRadius:w,outerRadius:b,startAngle:S,endAngle:j,fill:_})=>c.jsx(Sd,{cx:v,cy:g,innerRadius:w,outerRadius:b+8,startAngle:S,endAngle:j,fill:_});return c.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[e?c.jsx("div",{className:"text-center mb-3 text-sm text-slate-500",children:e}):null,c.jsx("div",{className:"h-72",children:c.jsx(zn,{width:"100%",height:"100%",children:c.jsxs(Kp,{children:[c.jsx($n,{content:c.jsx(m,{})}),c.jsx(ou,{data:h,dataKey:"value",nameKey:"name",innerRadius:70,outerRadius:105,paddingAngle:u?2:0,isAnimationActive:!1,activeIndex:i,activeShape:p,onMouseEnter:(v,g)=>l(g),onMouseMove:(v,g)=>l(g),onMouseLeave:()=>l(-1),children:h.map((v,g)=>c.jsx(Bi,{fill:v.color||Rm[g%Rm.length]},g))}),c.jsx("foreignObject",{pointerEvents:"none",x:"0",y:"0",width:"100%",height:"100%",children:c.jsx("div",{className:"w-full h-full grid place-items-center pointer-events-none",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-xs text-slate-500",children:t}),c.jsx("div",{className:"font-bold text-lg",children:Pm(d)})]})})})]})})})]})}function Ah({label:e,value:t,footnote:r,accent:n="default",help:a}){const i=n==="positive"?"text-emerald-600":n==="negative"?"text-rose-600":n==="muted"?"text-slate-700":"text-slate-800";return c.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[c.jsxs("div",{className:"text-sm text-slate-500 flex items-center",children:[c.jsx("span",{children:e}),a?c.jsx(ade,{text:a}):null]}),c.jsx("div",{className:`mt-2 text-2xl font-semibold ${i}`,children:t}),r&&c.jsx("div",{className:"mt-1 text-xs text-slate-500",children:r})]})}function $3({months:e,pendingFrom:t,pendingTo:r,setPendingFrom:n,setPendingTo:a,onApply:i,onReset:l}){const u=y.useMemo(()=>{if(!lr(t)||!lr(r))return!1;const d=e.findIndex(p=>p===t),m=e.findIndex(p=>p===r);return d!==-1&&m!==-1&&d<=m},[e,t,r]),h=y.useMemo(()=>{if(!lr(t))return e;const d=e.findIndex(m=>m===t);return d===-1?e:e.slice(d)},[e,t]);return c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"label",children:"From"}),c.jsx("select",{className:"select",value:t,onChange:d=>n(d.target.value),children:e.map(d=>c.jsx("option",{value:d,children:Ql(d)},d))})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"label",children:"to"}),c.jsx("select",{className:"select",value:r,onChange:d=>a(d.target.value),children:h.map(d=>c.jsx("option",{value:d,children:Ql(d)},d))})]}),c.jsx("button",{className:"btn btn-primary",disabled:!u,onClick:i,children:"Apply"}),c.jsx("button",{className:"btn btn-muted",onClick:l,children:"Reset"})]})}function sde({active:e,payload:t,label:r,benchmark:n}){if(!e||!t||!t.length)return null;const a=t.find(d=>d.dataKey==="elopRoi"),i=t.find(d=>d.dataKey==="benchRoi"),l=a?Number(a.value||0).toFixed(2):"0.00",u=i?Number(i.value||0).toFixed(2):"0.00",h=!!(a&&a.payload&&a.payload.elopMissing);return c.jsxs("div",{className:"bg-white shadow rounded-lg px-3 py-2 border border-slate-200 text-sm",children:[c.jsx("div",{className:"font-medium text-slate-800 mb-1",children:r}),c.jsxs("div",{className:"text-slate-700",children:[c.jsxs("div",{children:[c.jsx("span",{className:"font-semibold",children:"ELOP ROI"}),": ",l,"%",h?"  missing data":""]}),c.jsxs("div",{children:[c.jsxs("span",{className:"font-semibold",children:[n," ROI"]}),":"," ",u,"%"]})]})]})}function mS(){const{user:e}=y.useContext(mi),r=(e?.user_type||"").toString().replace(/\s+/g,"").toLowerCase()==="groupadmin",n=["Portfolio Allocation"],[a,i]=y.useState(n[0]),[l,u]=y.useState(""),[h,d]=y.useState([]),[m,p]=y.useState(!1),[v,g]=y.useState(""),[w,b]=y.useState(0),[S,j]=y.useState(0),[_,A]=y.useState(0),[k,O]=y.useState(0),[C,T]=y.useState(null),[I,M]=y.useState(""),[W,U]=y.useState(null),[F,oe]=y.useState(""),[je,ue]=y.useState("");y.useEffect(()=>{fetch("/api/market/refresh",ny({method:"POST"})).catch(()=>{})},[]),y.useEffect(()=>{if(!r)return;let ie=!1;return(async()=>{try{p(!0),g("");const pe=await fetch("/api/group-admin/my-group",ny()),le=await pe.json();if(!pe.ok)throw new Error(le?.message||le?.error||`HTTP ${pe.status}`);if(!ie){const ye=le||{},Ee=Array.isArray(ye.members)?ye.members:Array.isArray(ye.investors)?ye.investors:[];d(Ee)}}catch(pe){console.error("Failed to load group members",pe),ie||(g(pe.message||"Failed to load group members"),d([]))}finally{ie||p(!1)}})(),()=>{ie=!0}},[r]);const V="bCAS (Q4 Adj)",[H,Se]=y.useState([]),[Q,z]=y.useState(!0);y.useEffect(()=>{let ie=!0;return(async()=>{try{z(!0);const le=await(await fetch(`/api/metrics/periods?sheet=${encodeURIComponent(V)}`)).json(),Ee=(Array.isArray(le?.periods)?le.periods:Array.isArray(le)?le:[]).map(Ie=>{const Ve=typeof Ie=="string"?Ie:Ie?.as_of_date||Ie?.date||Ie?.as_of||"",He=new Date(Ve);return Number.isNaN(He.getTime())?null:Ra(He)}).filter(Boolean),De=Array.from(new Set(Ee)).sort((Ie,Ve)=>Ie.localeCompare(Ve));ie&&Se(De)}catch{ie&&Se([])}finally{ie&&z(!1)}})(),()=>{ie=!1}},[V]);const[Y,P]=y.useState(""),[q,G]=y.useState(""),[Z,fe]=y.useState(""),[Oe,Re]=y.useState("");y.useEffect(()=>{if(!H.length)return;const ie=H[0],pe=H[H.length-1];P(ie),G(pe),fe(ie),Re(pe)},[H]);const re=y.useCallback(()=>{if(!lr(Y)||!lr(q))return;const ie=H.findIndex(le=>le===Y),pe=H.findIndex(le=>le===q);ie===-1||pe===-1||ie>pe||(fe(Y),Re(q))},[Y,q,H]),be=y.useCallback(()=>{if(!H.length)return;const ie=H[0],pe=H[H.length-1];P(ie),G(pe),fe(ie),Re(pe)},[H]),Ae=()=>{const ie={};try{const pe=localStorage.getItem("accessToken");if(pe&&pe.split(".").length===3){const le=JSON.parse(atob(pe.split(".")[1])),ye=le.email||le.upn||le.preferred_username,Ee=le.name;ye&&(ie["X-User-Email"]=ye),Ee&&(ie["X-User-Name"]=Ee)}}catch{}return ie},D=y.useMemo(()=>{try{const pe=(new URL(window.location.href).searchParams.get("investor")||"").trim();let le="";try{le=localStorage.getItem("investorHint")||""}catch{le=""}if(pe)try{localStorage.setItem("investorHint",pe)}catch{}return r?pe:pe||le}catch{if(r)return"";try{return localStorage.getItem("investorHint")||""}catch{return""}}},[r]);y.useEffect(()=>{if(!lr(Z)||!lr(Oe)||r&&m)return;const ie=new URLSearchParams({sheet:V});ie.set("from",`${Z}-01`),ie.set("to",`${Oe}-01`);const pe=Ae(),le=async ye=>{const Ee=new URLSearchParams(ie);ye&&Ee.set("investor",ye);const De=await fetch(`/api/metrics/investor-overview?${Ee.toString()}`,{credentials:"include",headers:pe}),Ie=await De.json();if(!De.ok)throw new Error(Ie?.error||`HTTP ${De.status}`);return Ie};(async()=>{try{if(oe(""),r&&h.length>0&&!D){const Ie=h.map(Nt=>{const Vt=Nt.name||Nt.investor_name||Nt.full_name||Nt.investor||Nt.email;return typeof Vt=="string"?Vt.trim():""}).filter(Nt=>Nt.length);if(!Ie.length){const Nt=await le(null);if(u(Nt.investor||""),b(Number(Nt.initial_value||0)),j(Number(Nt.current_value||0)),O(Number(Nt.moic||0)),A(Number(Nt.roi_pct||0)),T(Nt.irr_pct!==void 0?Number(Nt.irr_pct):null),M(Nt.current_date||Nt.latest_date||""),U(Nt.time_span||null),Nt.join_date){const Vt=new Date(Nt.join_date);Number.isNaN(Vt.getTime())||ue(Ra(Vt))}return}let Ve=0,He=0,Xe=null,st=null,pt=null,dt=0,jt=0;for(const Nt of Ie)try{const Vt=await le(Nt),sn=Number(Vt.initial_value||0),$d=Number(Vt.current_value||0);Ve+=sn,He+=$d;const Gr=Vt.time_span||{};if(Gr.start_date){const Pn=new Date(Gr.start_date);Number.isNaN(Pn.getTime())||(!Xe||Pn<Xe)&&(Xe=Pn)}if(Gr.end_date){const Pn=new Date(Gr.end_date);Number.isNaN(Pn.getTime())||(!st||Pn>st)&&(st=Pn)}if(Vt.join_date){const Pn=new Date(Vt.join_date);Number.isNaN(Pn.getTime())||(!pt||Pn<pt)&&(pt=Pn)}Vt.irr_pct!==void 0&&Vt.irr_pct!==null&&!Number.isNaN(Number(Vt.irr_pct))&&sn>0&&(dt+=Number(Vt.irr_pct)*sn,jt+=sn)}catch(Vt){console.warn("Skipping investor in group aggregate due to error:",Nt,Vt)}const kr=Ve>0?(He-Ve)/Ve*100:0,an=Ve>0?He/Ve:0;u(Ie.length===1?Ie[0]:`${Ie[0]} + ${Ie.length-1} more`),b(Ve),j(He),O(an),A(kr),T(jt>0?dt/jt:null);const jn=st||(H.length?U3(H[H.length-1]):null);if(M(jn?jn.toISOString().slice(0,10):""),Xe&&st){const Vt=(st-Xe)/(1e3*60*60*24*365.25);U({start_date:Xe.toISOString().slice(0,10),end_date:st.toISOString().slice(0,10),years:Vt})}else U(null);pt&&ue(Ra(pt));return}const ye=new URLSearchParams(ie);D&&ye.set("investor",D);const Ee=await fetch(`/api/metrics/investor-overview?${ye.toString()}`,{credentials:"include",headers:pe}),De=await Ee.json();if(!Ee.ok)throw new Error(De?.error||`HTTP ${Ee.status}`);if(u(De.investor||""),b(Number(De.initial_value||0)),j(Number(De.current_value||0)),O(Number(De.moic||0)),A(Number(De.roi_pct||0)),T(De.irr_pct!==void 0?Number(De.irr_pct):null),M(De.current_date||De.latest_date||""),U(De.time_span||null),De.join_date){const Ie=new Date(De.join_date);if(!Number.isNaN(Ie.getTime()))ue(Ra(Ie));else if(De.time_span?.start_date){const Ve=new Date(De.time_span.start_date);Number.isNaN(Ve.getTime())?H.length&&ue(H[0]):ue(Ra(Ve))}else H.length&&ue(H[0])}else if(De.time_span?.start_date){const Ie=new Date(De.time_span.start_date);Number.isNaN(Ie.getTime())?H.length&&ue(H[0]):ue(Ra(Ie))}else H.length&&ue(H[0])}catch(ye){console.error("Investor overview fetch error:",ye),oe(ye.message||"Investor data not found."),u(""),b(0),j(0),O(0),A(0),T(null),M(""),U(null),ue("")}})()},[Z,Oe,D,H,r,h,m]);const[Me,ae]=y.useState({as_of:null,total:0,items:[]}),de=y.useMemo(()=>I?`${String(new Date(I).getFullYear())}-${String(new Date(I).getMonth()+1).padStart(2,"0")}`:lr(Oe)?Oe:"",[I,Oe]);y.useEffect(()=>{let ie=!1;return(async()=>{if(!de){ae({as_of:null,total:0,items:[]});return}try{const pe=await fetch(`/api/metrics/allocation?period_end=${encodeURIComponent(de)}`),le=await pe.json();if(!pe.ok)throw new Error(le?.error||`HTTP ${pe.status}`);ie||ae(le)}catch(pe){console.warn("allocation fetch failed:",pe),ie||ae({as_of:null,total:0,items:[]})}})(),()=>{ie=!0}},[de]);const me=y.useMemo(()=>!S||!Me?.items?.length?[]:Me.items.filter(ie=>(ie.percent||0)>0).map((ie,pe)=>({name:ie.name,value:Number((S*(ie.percent/100)).toFixed(2)),percent:Number(ie.percent),color:ie.color||Rm[pe%Rm.length]})).filter(ie=>ie.value>0),[Me,S]),ce=["S&P 500","Dow","Nasdaq","Russell","VIX","Gold"],ze={"S&P 500":"^GSPC",Dow:"^DJI",Nasdaq:"^IXIC",Russell:"^RUT",VIX:"^VIX",Gold:"GC=F"},[Qe,Ke]=y.useState(ce[0]),[qe,it]=y.useState(()=>`${new Date().getFullYear()}-01`),[Je,Fe]=y.useState(()=>Ra(new Date)),[Ye,ge]=y.useState(qe),[Ge,ve]=y.useState(Je);y.useEffect(()=>{lr(Z)&&(it(Z),ge(Z)),lr(Oe)&&(Fe(Oe),ve(Oe))},[Z,Oe]);const ne=ie=>U3(ie);y.useEffect(()=>{if(!lr(qe)||!lr(Je))return;let ie=ne(qe),pe=ne(Je);if(!ie||!pe)return;ie>pe&&([ie,pe]=[pe,ie]);const le=new Date,ye=new Date(le.getFullYear(),le.getMonth(),1);pe>ye&&(pe=ye);const Ee=Ra(ie),De=Ra(pe);Ee!==qe&&it(Ee),De!==Je&&Fe(De),ge(Ee),ve(De)},[qe,Je]);const xe=y.useMemo(()=>{if(H.length)return H;if(lr(qe)&&lr(Je)){const ie=[],pe=new Date(ne(qe)),le=ne(Je);for(;pe<=le;)ie.push(Ra(pe)),pe.setMonth(pe.getMonth()+1);return ie}return[]},[H,qe,Je]),[Be,Ze]=y.useState(null),tt=y.useMemo(()=>{if(!Be)return(xe||[]).map(le=>({key:le,label:Ql(le)}));const ie=xe.findIndex(le=>le===Be);return(ie===-1?xe:xe.slice(0,ie+1)).map(le=>({key:le,label:Ql(le)}))},[xe,Be]),[At,nn]=y.useState({}),[En,xi]=y.useState({}),[Ro,As]=y.useState(!1),[_s,Ts]=y.useState(""),ba=y.useRef(0);y.useEffect(()=>{if(!lr(qe)||!lr(Je)||!xe.length)return;const ie=`${qe}-01`,[pe,le]=Je.split("-").map(Number);if(!pe||!le)return;const Ee=new Date(pe,le,0).toISOString().slice(0,10),De=++ba.current;As(!0),Ts(""),(async()=>{try{const Ie=await fetch(`/api/portfolio/roi_monthly?sheet=${encodeURIComponent(V)}&start=${ie}&end=${Ee}`);let Ve;try{Ve=await Ie.json()}catch{Ve=null}if(ba.current!==De)return;if(!Ie.ok||!Ve||Ve.error||Ve.ok===!1)throw new Error(Ve?.error||`Request failed (${Ie.status})`);const He=Array.isArray(Ve.rows)?Ve.rows:[],Xe={},st={};let pt=null;for(const dt of He){if(!dt.date)continue;const jt=new Date(dt.date);if(Number.isNaN(jt.getTime()))continue;const kr=Ra(jt);if(!kr)continue;pt=kr;const an=typeof dt.roi_pct=="number"?dt.roi_pct:Number(dt.roi_pct||0);Xe[kr]=Number.isFinite(an)?an:0,dt.missing&&(st[kr]=!0)}Ze(pt),nn(Xe),xi(st)}catch(Ie){if(ba.current!==De)return;Ts(Ie?.message||String(Ie)),nn({}),xi({})}finally{ba.current===De&&As(!1)}})()},[qe,Je,xe,V]);const[Gn,_l]=y.useState({}),[Tl,ks]=y.useState(""),[kl,Cl]=y.useState(!1),Cs=y.useRef(0);y.useEffect(()=>{if(!lr(qe)||!lr(Je)||!xe.length)return;const ie=ze[Qe]||"^GSPC",pe=`${qe}-01`,[le,ye]=Je.split("-").map(Number);if(!le||!ye)return;const De=new Date(le,ye,0).toISOString().slice(0,10),Ie=++Cs.current;Cl(!0),ks(""),(async()=>{try{await fetch(`/api/market/store_history?symbol=${encodeURIComponent(ie)}&start=${pe}&end=${De}&interval=1mo`,ny({method:"POST"}));const Ve=await fetch(`/api/market/roi_monthly?symbols=${encodeURIComponent(ie)}&start=${pe}&end=${De}`);let He;try{He=await Ve.json()}catch{He=null}if(Cs.current!==Ie)return;if(!Ve.ok||!He||He.error)throw new Error(He?.error||`Benchmark request failed (${Ve.status})`);const Xe=He.by_symbol||{},st=Array.isArray(Xe[ie])?Xe[ie]:[],pt={};for(const dt of st){if(!dt.date)continue;const jt=new Date(dt.date);if(Number.isNaN(jt.getTime()))continue;const kr=Ra(jt);if(!kr)continue;const an=typeof dt.roi_pct=="number"?dt.roi_pct:Number(dt.roi_pct||0);pt[kr]=Number.isFinite(an)?an:0}_l(pt)}catch(Ve){if(Cs.current!==Ie)return;ks(Ve?.message||String(Ve)),_l({})}finally{Cs.current===Ie&&Cl(!1)}})()},[Qe,qe,Je,xe]);const wa=y.useMemo(()=>tt.map((ie,pe)=>{const le=ie.key,ye=At&&Object.prototype.hasOwnProperty.call(At,le)?At[le]:null,Ee=Gn&&Object.prototype.hasOwnProperty.call(Gn,le)?Gn[le]:null,De=typeof ye=="number"?ye:ye!=null?Number(ye)||0:null,Ie=typeof Ee=="number"?Ee:Ee!=null?Number(Ee)||0:null;return{name:ie.label,elopRoi:De,benchRoi:Ie,elopMissing:!!(En&&Object.prototype.hasOwnProperty.call(En,le)&&En[le]),idx:pe}}),[tt,At,Gn,En]),vr=y.useCallback(()=>{!lr(Ye)||!lr(Ge)||(it(Ye),Fe(Ge))},[Ye,Ge]),gr=y.useCallback(()=>{const ie=lr(Z)?Z:qe,pe=lr(Oe)?Oe:Je;ge(ie),ve(pe),it(ie),Fe(pe)},[Z,Oe,qe,Je]),vi=ry(_),Ol=Nh(_),cu=rde(k),L=Nh(k),ee=C==null?"muted":Nh(C,{allowMuted:!0}),K=C==null?"":ry(C),X=y.useMemo(()=>{const ie=Object.values(Gn||{}).filter(le=>typeof le=="number"&&Number.isFinite(le));return ie.length?ie.reduce((le,ye)=>le+ye,0)/ie.length:null},[Gn]),J=ry(X),te=Nh(X,{allowMuted:!0});return c.jsxs("div",{className:"space-y-8",children:[c.jsxs("div",{className:"bg-sky-100 border border-sky-200 rounded-xl p-4 flex flex-col gap-3",children:[c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[c.jsx("div",{className:"text-slate-700 text-sm",children:l?c.jsxs(c.Fragment,{children:["Viewing as"," ",c.jsx("span",{className:"font-semibold",children:l}),r&&!D&&c.jsx("span",{className:"ml-2 inline-flex items-center rounded-full border border-amber-300 bg-amber-100 px-2 py-0.5 text-[11px] font-semibold uppercase tracking-wide text-amber-800",children:"Group Admin"})]}):c.jsx(c.Fragment,{children:"Your portfolio overview"})}),je&&c.jsxs("div",{className:"text-slate-600 text-sm",children:["Since"," ",c.jsx("span",{className:"font-semibold",children:Ql(je)})]})]}),c.jsxs("div",{className:"flex items-center justify-between gap-3",children:[c.jsx("div",{className:"text-sm font-medium text-slate-700",children:"Investor data range"}),Q?c.jsx("div",{className:"text-sm text-slate-500",children:"Loading periods"}):H.length?c.jsx($3,{months:H,pendingFrom:Y,pendingTo:q,setPendingFrom:P,setPendingTo:G,onApply:re,onReset:be}):c.jsx("div",{className:"text-sm text-rose-600",children:"No periods available"})]}),F&&c.jsx("div",{className:"mt-2 text-xs text-rose-600",children:F}),v&&r&&c.jsxs("div",{className:"mt-1 text-xs text-rose-600",children:["Group data: ",v]})]}),c.jsx("div",{className:"space-y-4",children:c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"bg-white rounded-xl shadow p-6",children:c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 items-center gap-4",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-slate-500 text-sm",children:"Initial value"}),c.jsx("div",{className:"text-3xl font-bold text-slate-800 mt-1",children:Pm(w)})]}),c.jsx("div",{className:"hidden sm:flex items-center justify-center",children:c.jsxs("svg",{width:"48",height:"24",viewBox:"0 0 48 24",fill:"none",children:[c.jsx("path",{d:"M4 12h36",stroke:"#94a3b8",strokeWidth:"2"}),c.jsx("path",{d:"M32 6l8 6-8 6",fill:"none",stroke:"#94a3b8",strokeWidth:"2"})]})}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-slate-500 text-sm",children:"Current value"}),c.jsx("div",{className:"text-3xl font-bold text-slate-800 mt-1",children:Pm(S)})]})]})}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsx(Ah,{label:"ROI",help:"Return on Investment: (Current  Initial)  Initial within the selected range.",value:vi,accent:Ol}),c.jsx(Ah,{label:"MOIC",help:"Multiple on Invested Capital: Current Value  Initial Value.",value:cu,accent:L})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsx(Ah,{label:"IRR",help:"Annualized internal rate of return over the selected time span.",value:K,accent:ee,footnote:W?.years?`Time span: ${Number(W.years).toFixed(2)} yrs (${new Date(W.start_date).toLocaleDateString()}  ${new Date(W.end_date).toLocaleDateString()})`:void 0}),c.jsx(Ah,{label:`ROI Growth (${Qe})`,help:`Average monthly ROI of ${Qe} from ${Ql(qe)} to ${Ql(Je)}.`,value:J,accent:te})]})]}),c.jsxs("div",{className:"bg-white rounded-xl shadow overflow-hidden",children:[c.jsx("div",{className:"flex items-center gap-6 px-6 pt-4 border-b",children:c.jsx("button",{onClick:()=>i("Portfolio Allocation"),className:"py-3 border-b-2 -mb-px transition border-sky-600 text-sky-700",children:"Portfolio Allocation"})}),c.jsx("div",{className:"p-6 grid grid-cols-1 gap-6",children:c.jsx(ide,{title:"",totalLabel:"Current Value",totalValue:Math.round(S),data:me})})]})]})}),c.jsxs("div",{className:"bg-white rounded-xl shadow",children:[c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-3 px-6 py-4 border-b",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-sm text-slate-600",children:"Compare monthly ROI with"}),c.jsx("select",{className:"px-3 py-2 rounded-lg border border-slate-300 bg-white",value:Qe,onChange:ie=>Ke(ie.target.value),children:["S&P 500","Dow","Nasdaq","Russell","VIX","Gold"].map(ie=>c.jsx("option",{value:ie,children:ie},ie))})]}),c.jsx($3,{months:xe,pendingFrom:Ye,pendingTo:Ge,setPendingFrom:ge,setPendingTo:ve,onApply:vr,onReset:gr})]}),c.jsxs("div",{className:"px-6 pt-4",children:[c.jsxs("div",{className:"text-center font-semibold text-slate-800 text-lg",children:["Monthly ROI  ELOP vs ",Qe]}),c.jsxs("div",{className:"text-center text-slate-500 text-xs mb-2",children:[tt[0]?.label??""," "," ",tt[tt.length-1]?.label??""]}),(Ro||kl)&&c.jsx("div",{className:"text-center text-xs text-slate-500 mb-2",children:"Loading"}),_s&&c.jsx("div",{className:"text-center text-xs text-rose-600 mb-2",children:_s}),Tl&&c.jsx("div",{className:"text-center text-xs text-rose-600 mb-2",children:Tl})]}),c.jsxs("div",{className:"p-6",children:[c.jsx("div",{className:"h-[440px]",children:c.jsx(zn,{width:"100%",height:"100%",children:c.jsxs(qc,{data:wa,margin:{top:24,right:20,left:8,bottom:56},barCategoryGap:16,children:[c.jsxs("defs",{children:[c.jsxs("linearGradient",{id:"elopSolid",x1:"0",y1:"0",x2:"0",y2:"1",children:[c.jsx("stop",{offset:"0%",stopColor:"#5B8DEF"}),c.jsx("stop",{offset:"100%",stopColor:"#93C5FD"})]}),c.jsxs("linearGradient",{id:"benchSolid",x1:"0",y1:"0",x2:"0",y2:"1",children:[c.jsx("stop",{offset:"0%",stopColor:"#FF9056"}),c.jsx("stop",{offset:"100%",stopColor:"#FFC2A6"})]})]}),c.jsx(ml,{strokeDasharray:"3 3",vertical:!1}),c.jsx(fi,{dataKey:"name",tick:{fill:"#475569",fontSize:11},angle:-45,textAnchor:"end",height:70}),c.jsx($a,{tickFormatter:ie=>`${Number(ie).toFixed(0)}%`,tick:{fill:"#475569",fontSize:12},domain:["auto","auto"]}),c.jsx($n,{content:c.jsx(sde,{benchmark:Qe})}),c.jsx(Mi,{dataKey:"elopRoi",name:"ELOP ROI",radius:[6,6,0,0],fill:"url(#elopSolid)"}),c.jsx(Mi,{dataKey:"benchRoi",name:`${Qe} ROI`,radius:[6,6,0,0],fill:"url(#benchSolid)"})]})})}),c.jsxs("div",{className:"flex justify-center gap-6 mt-4",children:[c.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-700",children:[c.jsx("span",{className:"inline-block w-4 h-3 rounded",style:{background:"linear-gradient(#5B8DEF,#93C5FD)"}})," ","ELOP ROI"]}),c.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-700",children:[c.jsx("span",{className:"inline-block w-4 h-3 rounded",style:{background:"linear-gradient(#FF9056,#FFC2A6)"}})," ",Qe," ROI"]})]})]})]}),c.jsx(ede,{})]})}const Nc=e=>Number(e||0).toLocaleString(void 0,{style:"currency",currency:"USD",maximumFractionDigits:2}),_M=e=>e==null||Number.isNaN(Number(e))?"":`${Number(e).toFixed(2)}%`,Mm=["#6366F1","#10B981","#60A5FA","#F59E0B","#EF4444","#8B5CF6","#14B8A6","#22C55E","#3B82F6","#EAB308","#F97316","#EC4899","#06B6D4","#84CC16"],_h=e=>typeof e=="string"&&/^\d{4}-(0[1-9]|1[0-2])$/.test(e),lde=e=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}`,ode=e=>{if(!e)return"";const[t,r]=e.split("-").map(Number);return new Date(t,r,0).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"2-digit"})},cde=e=>{if(!e)return null;const[t,r]=e.split("-").map(Number);return new Date(t,r,0)},z3=()=>{if(typeof window>"u")return"";try{const t=(new URLSearchParams(window.location.search).get("investor")||"").trim();return t||(window.localStorage.getItem("investorHint")||"").trim()}catch{return""}};function ude({title:e,totalLabel:t,totalValue:r,data:n}){const a=Array.isArray(n)?n:[],[i,l]=y.useState(-1),u=i>=0&&a[i]?a[i].value:r,h=({active:m,payload:p})=>{if(!m||!p||!p.length)return null;const v=p[0]?.payload||{};return c.jsxs("div",{className:"bg-white shadow rounded-lg px-3 py-2 border border-slate-200 text-sm",children:[c.jsx("div",{className:"font-semibold text-slate-800",children:v.name||""}),c.jsx("div",{className:"text-emerald-600",children:_M(v.percent)}),c.jsx("div",{className:"text-slate-700",children:Nc(v.value)})]})},d=m=>{const{cx:p,cy:v,innerRadius:g,outerRadius:w,startAngle:b,endAngle:S,fill:j}=m;return c.jsx(Sd,{cx:p,cy:v,innerRadius:g,outerRadius:w+8,startAngle:b,endAngle:S,fill:j})};return c.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[e?c.jsx("div",{className:"text-center mb-3 text-sm text-slate-500",children:e}):null,c.jsx("div",{className:"h-72",children:c.jsx(zn,{width:"100%",height:"100%",children:c.jsxs(Kp,{children:[c.jsx($n,{content:c.jsx(h,{})}),c.jsx(ou,{data:a,dataKey:"value",nameKey:"name",innerRadius:70,outerRadius:105,paddingAngle:2,isAnimationActive:!1,activeIndex:i,activeShape:d,onMouseEnter:(m,p)=>l(p),onMouseMove:(m,p)=>l(p),onMouseLeave:()=>l(-1),children:a.map((m,p)=>c.jsx(Bi,{fill:m.color||Mm[p%Mm.length]},p))}),c.jsx("foreignObject",{pointerEvents:"none",x:"0",y:"0",width:"100%",height:"100%",children:c.jsx("div",{className:"w-full h-full grid place-items-center pointer-events-none",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-xs text-slate-500",children:t}),c.jsx("div",{className:"font-bold text-lg",children:Nc(u)})]})})})]})})})]})}const H3="bCAS (Q4 Adj)";function pS(){const{user:e}=y.useContext(mi),r=(e?.user_type||"").toString().replace(/\s+/g,"").toLowerCase()==="groupadmin",[n,a]=y.useState("All"),[i,l]=y.useState("All"),[u,h]=y.useState("All"),[d,m]=y.useState("All"),[p,v]=y.useState(""),g=()=>{const de={};try{const ce=localStorage.getItem("accessToken");if(ce&&ce.split(".").length===3){const ze=JSON.parse(atob(ce.split(".")[1])),Qe=ze.email||ze.upn||ze.preferred_username,Ke=ze.name;Qe&&(de["X-User-Email"]=Qe),Ke&&(de["X-User-Name"]=Ke)}}catch{}const me=We?.defaults?.headers?.common?.["X-View-As-Investor"];return me&&(de["X-View-As-Investor"]=String(me)),de},[w,b]=y.useState([]),[S,j]=y.useState(!0);y.useEffect(()=>{let de=!0;return(async()=>{try{j(!0);const ce=await(await fetch(`/api/metrics/periods?sheet=${encodeURIComponent(H3)}`,{credentials:"include",headers:g()})).json(),Qe=(Array.isArray(ce?.periods)?ce.periods:Array.isArray(ce)?ce:[]).map(qe=>{const it=typeof qe=="string"?qe:qe?.as_of_date||qe?.date||qe?.as_of||"",Je=new Date(it);return Number.isNaN(Je.getTime())?null:lde(Je)}).filter(Boolean),Ke=Array.from(new Set(Qe)).sort((qe,it)=>qe.localeCompare(it));de&&b(Ke)}catch{de&&b([])}finally{de&&j(!1)}})(),()=>{de=!1}},[]);const[_,A]=y.useState(""),[k,O]=y.useState(""),[C,T]=y.useState(""),[I,M]=y.useState("");y.useEffect(()=>{if(!w.length)return;const de=w[0],me=w[w.length-1];A(de),O(me),T(de),M(me)},[w]);const W=y.useCallback(()=>{if(!_h(_)||!_h(k))return;const de=w.findIndex(ce=>ce===_),me=w.findIndex(ce=>ce===k);de===-1||me===-1||de>me||(T(_),M(k))},[_,k,w]),U=y.useCallback(()=>{if(!w.length)return;const de=w[0],me=w[w.length-1];A(de),O(me),T(de),M(me)},[w]),[F,oe]=y.useState([]),[je,ue]=y.useState(!1);y.useEffect(()=>{if(!r){oe([]),ue(!1);return}let de=!0;return(async()=>{ue(!0);try{const{data:me}=await We.get("/api/group-admin/my-group",{headers:{Accept:"application/json"}});if(!de)return;const ce=me||{},ze=Array.isArray(ce.members)?ce.members:Array.isArray(ce.investors)?ce.investors:[];oe(ze)}catch{de&&oe([])}finally{de&&ue(!1)}})(),()=>{de=!1}},[r]);const[V,H]=y.useState(0),[Se,Q]=y.useState(0),[z,Y]=y.useState(0),[P,q]=y.useState(0),[G,Z]=y.useState("");y.useEffect(()=>{if(!_h(C)||!_h(I)||r&&je)return;const de=new URLSearchParams({sheet:H3});de.set("from",`${C}-01`),de.set("to",`${I}-01`);const me=g(),ce=async ze=>{const Qe=new URLSearchParams(de);ze&&Qe.set("investor",ze);const Ke=await fetch(`/api/metrics/investor-overview?${Qe.toString()}`,{credentials:"include",headers:me}),qe=await Ke.json();if(!Ke.ok)throw new Error(qe?.error||`HTTP ${Ke.status}`);return qe};(async()=>{try{const ze=z3();if(r&&F.length>0&&!ze){const it=F.map(ne=>{const xe=ne.name||ne.investor_name||ne.full_name||ne.investor||ne.email;return typeof xe=="string"?xe.trim():""}).filter(ne=>ne.length);if(!it.length){const ne=await ce(null);H(Number(ne.initial_value||0)),Q(Number(ne.current_value||0)),q(Number(ne.moic||0)),Y(Number(ne.roi_pct||0)),Z(ne.current_date||ne.latest_date||"");return}let Je=0,Fe=0,Ye=null;for(const ne of it)try{const xe=await ce(ne),Be=Number(xe.initial_value||0),Ze=Number(xe.current_value||0);Je+=Be,Fe+=Ze;const tt=xe.time_span||{};if(tt.end_date){const At=new Date(tt.end_date);Number.isNaN(At.getTime())||(!Ye||At>Ye)&&(Ye=At)}}catch(xe){console.warn("Skipping investor in portfolio aggregate due to error:",ne,xe)}const ge=Je>0?(Fe-Je)/Je*100:0,Ge=Je>0?Fe/Je:0;H(Je),Q(Fe),q(Ge),Y(ge);const ve=Ye||(w.length?cde(w[w.length-1]):null);Z(ve?ve.toISOString().slice(0,10):"");return}const Qe=new URLSearchParams(de);ze&&Qe.set("investor",ze);const Ke=await fetch(`/api/metrics/investor-overview?${Qe.toString()}`,{credentials:"include",headers:me}),qe=await Ke.json();if(!Ke.ok)throw new Error(qe?.error||`HTTP ${Ke.status}`);H(Number(qe.initial_value||0)),Q(Number(qe.current_value||0)),q(Number(qe.moic||0)),Y(Number(qe.roi_pct||0)),Z(qe.current_date||qe.latest_date||"")}catch(ze){console.warn("Portfolio KPI load failed:",ze),H(0),Q(0),q(0),Y(0),Z("")}})()},[C,I,r,F,je,w]);const fe=y.useMemo(()=>{if(G){const de=new Date(G);return`${de.getFullYear()}-${String(de.getMonth()+1).padStart(2,"0")}`}return I||""},[G,I]),[Oe,Re]=y.useState([]);y.useEffect(()=>{(async()=>{if(!fe){Re([]);return}try{const de=new URLSearchParams({period_end:fe}),me=z3();me&&de.set("investor",me);const ze=await(await fetch(`/api/metrics/allocation?${de.toString()}`,{credentials:"include",headers:g()})).json(),Ke=(Array.isArray(ze?.items)?ze.items:[]).filter(qe=>Number(qe.percent)>0).map((qe,it)=>({name:qe.name,percent:Number(qe.percent),value:Number((Se*(Number(qe.percent)/100)).toFixed(2)),color:qe.color||Mm[it%Mm.length]}));Re(Ke)}catch{Re([])}})()},[fe,Se]);const[re,be]=y.useState([]),[Ae,D]=y.useState(!1);y.useEffect(()=>{async function de(){D(!0);try{const me=Oe.map((ce,ze)=>({id:ze+1,name:ce.name,current:ce.value,dateYm:fe}));be(me)}finally{D(!1)}}de()},[Oe,fe]);const Me=y.useMemo(()=>{const de=p.trim().toLowerCase();return de?re.filter(me=>me.name?.toLowerCase().includes(de)):re},[re,p]),ae=y.useMemo(()=>Me.reduce((de,me)=>de+Number(me.current||0),0),[Me]);return c.jsxs("div",{className:"space-y-6",children:[c.jsx("h1",{className:"text-2xl font-semibold text-slate-800",children:"Portfolio Summary"}),c.jsxs("div",{className:"rounded-xl bg-sky-200/60 border border-sky-200 p-3 flex flex-wrap items-center gap-3",children:[c.jsx("select",{className:"rounded-lg bg-white border border-slate-300 px-3 py-2",value:n,onChange:de=>a(de.target.value),children:c.jsx("option",{children:"Companies: All"})}),c.jsx("span",{className:"text-slate-700",children:"where"}),c.jsx("select",{className:"rounded-lg bg-white border border-slate-300 px-3 py-2",value:i,onChange:de=>l(de.target.value),children:c.jsx("option",{children:"Industries: All"})}),c.jsxs("select",{className:"rounded-lg bg-white border border-slate-300 px-3 py-2",value:u,onChange:de=>h(de.target.value),children:[c.jsx("option",{children:"Investment types: All"}),c.jsx("option",{children:"Equity"}),c.jsx("option",{children:"Debt"})]}),c.jsx("select",{className:"rounded-lg bg-white border border-slate-300 px-3 py-2",value:d,onChange:de=>m(de.target.value),children:c.jsx("option",{children:"Investors: All"})}),c.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[c.jsx("select",{className:"rounded-lg bg-white border border-slate-300 px-3 py-2",value:_,onChange:de=>A(de.target.value),children:w.map(de=>c.jsx("option",{value:de,children:de},de))}),c.jsx("span",{className:"text-slate-700",children:"to"}),c.jsx("select",{className:"rounded-lg bg-white border border-slate-300 px-3 py-2",value:k,onChange:de=>O(de.target.value),children:w.slice(Math.max(0,w.indexOf(_))).map(de=>c.jsx("option",{value:de,children:de},de))}),c.jsx("button",{onClick:W,className:"rounded-lg bg-sky-600 text-white px-3 py-2 text-sm font-medium",children:"Apply"}),c.jsx("button",{onClick:U,className:"rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm",children:"Reset"})]})]}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-5",children:[c.jsx("div",{className:"text-slate-700 mb-3 font-medium",children:"360 Portfolio Overview"}),c.jsx("div",{className:"rounded-lg bg-slate-50 border border-slate-200 p-5",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-slate-500 text-sm",children:"Initial value"}),c.jsx("div",{className:"text-xl text-sky-700 font-semibold",children:Nc(V)})]}),c.jsx("div",{className:"text-slate-400",children:""}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-slate-500 text-sm",children:"Current value"}),c.jsx("div",{className:"text-xl text-sky-700 font-semibold",children:Nc(Se)})]})]})})]}),c.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white grid grid-cols-1 md:grid-cols-2 gap-4 p-5",children:[c.jsxs("div",{className:"rounded-lg border border-slate-200 p-4",children:[c.jsx("div",{className:"text-slate-500 text-sm",children:"ROI"}),c.jsxs("div",{className:"text-emerald-600 text-xl font-semibold",children:[z>=0?"+":"",_M(z)]})]}),c.jsxs("div",{className:"rounded-lg border border-slate-200 p-4",children:[c.jsx("div",{className:"text-slate-500 text-sm",children:"MOIC"}),c.jsxs("div",{className:"text-slate-800 text-xl font-semibold",children:[Number(P||0).toFixed(2),"x"]})]})]})]}),c.jsx("div",{className:"bg-white rounded-xl shadow overflow-hidden",children:c.jsx("div",{className:"p-6 grid grid-cols-1 gap-6",children:c.jsx(ude,{title:"Portfolio Allocation",totalLabel:"Current Value",totalValue:Math.round(Se),data:Oe})})})]}),c.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white",children:[c.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-slate-200",children:[c.jsx("input",{className:"w-80 rounded-lg border border-slate-300 px-3 py-2 bg-slate-50 outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100",placeholder:"Search by anything",value:p,onChange:de=>v(de.target.value)}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{className:"rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm",children:"Export"}),c.jsx("button",{className:"rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm",children:"Edit columns"})]})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full text-sm",children:[c.jsx("thead",{children:c.jsxs("tr",{className:"bg-slate-50 text-slate-600",children:[c.jsx("th",{colSpan:3,className:"text-left px-5 py-3 font-medium",children:"NAME"}),c.jsx("th",{className:"text-right px-5 py-3 font-medium",children:"INVESTMENT"}),c.jsx("th",{className:"px-5 py-3 font-medium"}),c.jsx("th",{className:"px-5 py-3 font-medium"}),c.jsx("th",{className:"px-5 py-3 font-medium"}),c.jsx("th",{className:"px-5 py-3 font-medium"}),c.jsx("th",{className:"px-5 py-3 font-medium"}),c.jsx("th",{colSpan:2,className:"text-left px-5 py-3 font-medium",children:"DATE"})]})}),c.jsx("tbody",{children:Ae?c.jsx("tr",{children:c.jsx("td",{className:"px-5 py-6 text-slate-500",colSpan:11,children:"Loading..."})}):Me.length===0?c.jsx("tr",{children:c.jsx("td",{className:"px-5 py-6 text-slate-500",colSpan:11,children:"No results"})}):c.jsxs(c.Fragment,{children:[Me.map(de=>c.jsxs("tr",{className:"border-t",children:[c.jsx("td",{colSpan:3,className:"px-5 py-3 text-sky-700",children:de.name}),c.jsx("td",{className:"px-5 py-3 text-right tabular-nums",children:Nc(de.current)}),c.jsx("td",{className:"px-5 py-3"}),c.jsx("td",{className:"px-5 py-3"}),c.jsx("td",{className:"px-5 py-3"}),c.jsx("td",{className:"px-5 py-3"}),c.jsx("td",{className:"px-5 py-3"}),c.jsx("td",{colSpan:2,className:"px-5 py-3",children:ode(de.dateYm)})]},de.id)),c.jsxs("tr",{className:"border-t bg-slate-50",children:[c.jsx("td",{className:"px-5 py-3 font-semibold text-left",children:"Total Investment"}),c.jsx("td",{className:"px-5 py-3"}),c.jsx("td",{className:"px-5 py-3"}),c.jsx("td",{className:"px-5 py-3 font-semibold text-right tabular-nums",children:Nc(ae)}),c.jsx("td",{className:"px-5 py-3"}),c.jsx("td",{className:"px-5 py-3"}),c.jsx("td",{className:"px-5 py-3"}),c.jsx("td",{className:"px-5 py-3"}),c.jsx("td",{className:"px-5 py-3"}),c.jsx("td",{colSpan:2,className:"px-5 py-3"})]})]})})]})})]})]})}const q3=(...e)=>e.filter(Boolean).join(" "),V3=e=>e==null||Number.isNaN(e)?"":new Intl.NumberFormat(void 0,{style:"currency",currency:"USD"}).format(Number(e)),rl=e=>{if(!e)return"";const t=e instanceof Date?e:new Date(e);return Number.isNaN(t.getTime())?"":t.toISOString().slice(0,10)};function fde(e,t){const r=t.map(l=>l.map(u=>{const h=u==null?"":String(u);return/[",\n]/.test(h)?`"${h.replace(/"/g,'""')}"`:h}).join(",")).join(`
`),n=new Blob([r],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(n),i=document.createElement("a");i.href=a,i.download=e,i.click(),setTimeout(()=>URL.revokeObjectURL(a),600)}function dde(){if(typeof window>"u")return null;try{const t=new URL(window.location.href).searchParams.get("investorId"),r=window.localStorage.getItem("currentInvestorId"),n=t||r;return n?Number(n):null}catch{return null}}function xS({profiles:e=[],adminView:t=!1,investorId:r=null}){const[n,a]=y.useState([]),[i,l]=y.useState(!1),[u,h]=y.useState(""),[d,m]=y.useState({ready:!1,user:null,investor:null}),[p,v]=y.useState("All profiles"),[g,w]=y.useState("All"),[b,S]=y.useState(""),[j,_]=y.useState(!0),[A,k]=y.useState(!1),O=y.useRef(null),[C,T]=y.useState(null),[I,M]=y.useState({top:0,left:0}),W=y.useRef(null),U=y.useRef(null),[F,oe]=y.useState(null),[je,ue]=y.useState(null),[V,H]=y.useState(!1),[Se,Q]=y.useState(""),[z,Y]=y.useState(""),[P,q]=y.useState(""),G=y.useRef(null),Z=new Date,[fe,Oe]=y.useState(Z.getFullYear()),[Re,re]=y.useState(Math.floor(Z.getMonth()/3)+1),[be,Ae]=y.useState("Elpis Opportunity Fund LP"),[D,Me]=y.useState(!1),[ae,de]=y.useState({name:!0,investor:!0,entity:!0,dueDate:!0,status:!0,amountDue:!0,paidDate:!0,download:!0,actions:!0});y.useEffect(()=>{let Fe=!0;return(async()=>{try{const{data:Ye}=await We.get("/auth/me",{headers:{Accept:"application/json"}});if(!Fe)return;m({ready:!0,user:Ye?.user||null,investor:Ye?.investor||null})}catch{if(!Fe)return;m({ready:!0,user:null,investor:null})}})(),()=>{Fe=!1}},[]);const me=dde(),ce=t&&r!=null&&r!==void 0?r:me??null;async function ze(){l(!0),h("");try{const Fe=ce?{investor_id:ce}:void 0,{data:Ye}=await We.get("/api/statements",{...Fe?{params:Fe}:{}});let ge=[];Array.isArray(Ye)?ge=Ye:Ye&&typeof Ye=="object"&&(Array.isArray(Ye.items)?ge=Ye.items:Array.isArray(Ye.data)?ge=Ye.data:Array.isArray(Ye.statements)&&(ge=Ye.statements)),a(ge)}catch(Fe){h(String(Fe?.response?.data?.error||Fe.message||Fe))}finally{l(!1)}}y.useEffect(()=>{d.ready&&ze()},[d.ready,ce,t]);const Qe=y.useMemo(()=>{const Fe=b.trim().toLowerCase();let Ye=n.map(ge=>({...ge,_due:new Date(ge.dueDate)}));return p&&p!=="All profiles"&&p!=="Filter by all profiles"&&(Ye=Ye.filter(ge=>(ge.profile||ge.entity||"").toLowerCase().includes(p.toLowerCase()))),g==="Outstanding"&&(Ye=Ye.filter(ge=>String(ge.status).toLowerCase()==="outstanding")),g==="Paid"&&(Ye=Ye.filter(ge=>String(ge.status).toLowerCase()==="paid")),Fe&&(Ye=Ye.filter(ge=>[ge.name,ge.investor,ge.entity,ge.status,rl(ge.dueDate),rl(ge.paidDate),ge.amountDue].map(Ge=>Ge==null?"":String(Ge)).some(Ge=>Ge.toLowerCase().includes(Fe)))),Ye.sort((ge,Ge)=>(ge._due-Ge._due)*(j?1:-1)),Ye},[n,p,g,b,j]);function Ke(){const Fe=[ae.name&&"Name",ae.investor&&"Investor",ae.entity&&"Entity",ae.dueDate&&"Due Date",ae.status&&"Status",ae.amountDue&&"Amount Due",ae.paidDate&&"Paid Date"].filter(Boolean),Ye=Qe.map(ge=>[ae.name&&ge.name,ae.investor&&ge.investor,ae.entity&&ge.entity,ae.dueDate&&rl(ge.dueDate),ae.status&&ge.status,ae.amountDue&&ge.amountDue,ae.paidDate&&rl(ge.paidDate)].filter(Boolean));fde("statements.csv",[Fe,...Ye])}async function qe(Fe){oe(Fe),ue(null),Q(""),q(""),H(!0);try{const Ye=await We.get(`/api/statements/${Fe}/pdf`,{responseType:"blob",params:{inline:1}});G.current&&URL.revokeObjectURL(G.current);const ge=URL.createObjectURL(Ye.data);G.current=ge,Y(`${ge}#toolbar=0`)}catch(Ye){q(Ye?.response?.data?.error||Ye.message||"Failed to load the PDF preview."),Y("")}try{const{data:Ye,headers:ge}=await We.get(`/api/statements/${Fe}`,{headers:{Accept:"application/json"}});if(typeof Ye!="object"){const Ge=ge?.["content-type"]||"unknown";throw new Error(`Server did not return JSON (content-type: ${Ge}).`)}ue(Ye)}catch(Ye){Q(String(Ye?.response?.data?.error||Ye.message||Ye))}finally{H(!1)}}function it(){oe(null),ue(null),Q(""),Y(""),q(""),G.current&&(URL.revokeObjectURL(G.current),G.current=null)}y.useEffect(()=>()=>{G.current&&(URL.revokeObjectURL(G.current),G.current=null)},[]);async function Je(Fe){if(Fe?.id&&window.confirm(`Delete this statement?

${Fe.name}
Investor: ${Fe.investor}
Entity: ${Fe.entity}`))try{await We.delete(`/api/statements/${Fe.id}`),a(Ye=>Ye.filter(ge=>ge.id!==Fe.id))}catch(Ye){alert(`Failed to delete: ${Ye?.response?.data?.error||Ye.message||Ye}`)}finally{T(null)}}return y.useEffect(()=>{const Fe=ge=>{U.current&&U.current.contains(ge.target)||(O.current&&!O.current.contains(ge.target)&&k(!1),W.current&&!W.current.contains(ge.target)&&T(null))},Ye=()=>T(null);return document.addEventListener("mousedown",Fe),window.addEventListener("scroll",Ye,!0),window.addEventListener("resize",Ye),()=>{document.removeEventListener("mousedown",Fe),window.removeEventListener("scroll",Ye,!0),window.removeEventListener("resize",Ye)}},[]),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white shadow-sm",children:[c.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 border-b border-slate-200 px-4 py-3",children:[c.jsx("input",{type:"text",value:b,onChange:Fe=>S(Fe.target.value),placeholder:"Search by anything",className:"w-72 max-w-[60%] flex-1 rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-sky-200"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("button",{onClick:Ke,className:"inline-flex items-center gap-2 rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50",title:"Export visible rows to CSV",children:[c.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"opacity-70",children:[c.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),c.jsx("polyline",{points:"7 10 12 15 17 10"}),c.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),"Export"]}),c.jsxs("div",{className:"relative hidden md:block",ref:O,children:[c.jsxs("button",{onClick:()=>k(Fe=>!Fe),className:"inline-flex items-center gap-2 rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50",title:"Show / hide columns",children:[c.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"opacity-70",children:[c.jsx("line",{x1:"4",y1:"21",x2:"4",y2:"14"}),c.jsx("line",{x1:"4",y1:"10",x2:"4",y2:"3"}),c.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"12"}),c.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"3"}),c.jsx("line",{x1:"20",y1:"21",x2:"20",y2:"16"}),c.jsx("line",{x1:"20",y1:"12",x2:"20",y2:"3"}),c.jsx("line",{x1:"1",y1:"14",x2:"7",y2:"14"}),c.jsx("line",{x1:"9",y1:"8",x2:"15",y2:"8"}),c.jsx("line",{x1:"17",y1:"16",x2:"23",y2:"16"})]}),"Edit columns"]}),A&&c.jsx("div",{className:"absolute right-0 z-10 mt-2 w-64 rounded-xl border border-slate-200 bg-white p-2 text-sm shadow-lg",children:Object.keys(ae).map(Fe=>c.jsxs("label",{className:"flex items-center justify-between rounded-lg px-2 py-1.5 hover:bg-slate-50",children:[c.jsx("span",{className:"capitalize text-slate-700",children:Fe==="dueDate"?"Due Date":Fe==="paidDate"?"Paid Date":Fe==="actions"?"Actions":Fe.charAt(0).toUpperCase()+Fe.slice(1)}),c.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:ae[Fe],onChange:()=>de(Ye=>({...Ye,[Fe]:!Ye[Fe]}))})]},Fe))})]})]})]}),c.jsx("div",{className:"hidden overflow-x-auto md:block",children:c.jsxs("table",{className:"min-w-full table-fixed",children:[c.jsx("thead",{children:c.jsxs("tr",{className:"text-left text-xs font-semibold uppercase tracking-wide text-slate-500",children:[ae.name&&c.jsx("th",{className:"w-[17%] px-4 py-3",children:"Name"}),ae.investor&&c.jsx("th",{className:"w-[17%] px-4 py-3",children:"Investor"}),ae.entity&&c.jsx("th",{className:"w-[17%] px-4 py-3",children:"Entity"}),ae.dueDate&&c.jsx("th",{className:"w-[12%] px-4 py-3",children:c.jsxs("button",{onClick:()=>_(Fe=>!Fe),className:"inline-flex items-center gap-1 text-slate-500 hover:text-slate-700",title:"Sort by Due Date",children:[c.jsx("span",{children:"Due Date"}),c.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:j?c.jsx("polyline",{points:"6 15 12 9 18 15"}):c.jsx("polyline",{points:"6 9 12 15 18 9"})})]})}),ae.status&&c.jsx("th",{className:"w-[10%] px-4 py-3",children:"Status"}),ae.amountDue&&c.jsx("th",{className:"w-[10%] px-4 py-3",children:"Amount Due"}),ae.paidDate&&c.jsx("th",{className:"w-[10%] px-4 py-3",children:"Paid Date"}),ae.download&&c.jsx("th",{className:"w-[7%] px-4 py-3",children:"PDF"}),ae.actions&&c.jsx("th",{className:"w-[7%] px-4 py-3",children:"Actions"})]})}),c.jsxs("tbody",{className:"divide-y divide-slate-100 text-sm",children:[i&&c.jsx("tr",{children:c.jsx("td",{className:"px-4 py-10 text-center text-slate-500",colSpan:9,children:"Loading"})}),!!u&&!i&&c.jsx("tr",{children:c.jsx("td",{className:"px-4 py-10 text-center text-rose-600",colSpan:9,children:u})}),!i&&!u&&Qe.length===0&&c.jsx("tr",{children:c.jsx("td",{className:"px-4 py-12 text-center text-slate-500",colSpan:9,children:d.ready?"Nothing to display":"Loading"})}),Qe.map(Fe=>c.jsxs("tr",{className:"hover:bg-slate-50/60",children:[ae.name&&c.jsx("td",{className:"truncate px-4 py-3 font-medium text-slate-800",title:Fe.name,children:Fe.name}),ae.investor&&c.jsx("td",{className:"truncate px-4 py-3 text-slate-700",title:Fe.investor,children:Fe.investor}),ae.entity&&c.jsx("td",{className:"truncate px-4 py-3 text-slate-700",title:Fe.entity,children:Fe.entity}),ae.dueDate&&c.jsx("td",{className:"px-4 py-3 text-slate-700",children:rl(Fe.dueDate)||""}),ae.status&&c.jsx("td",{className:"px-4 py-3",children:c.jsx("span",{className:q3("inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium",String(Fe.status).toLowerCase()==="paid"?"bg-green-50 text-green-700 ring-1 ring-green-200":"bg-amber-50 text-amber-700 ring-1 ring-amber-200"),children:Fe.status})}),ae.amountDue&&c.jsx("td",{className:"px-4 py-3 tabular-nums text-slate-800",children:V3(Fe.amountDue)}),ae.paidDate&&c.jsx("td",{className:"px-4 py-3 text-slate-700",children:rl(Fe.paidDate)||""}),ae.download&&c.jsx("td",{className:"px-4 py-3",children:Fe.pdfAvailable?c.jsx("a",{href:`/api/statements/${Fe.id}/pdf`,className:"rounded-lg border border-slate-300 bg-white px-3 py-1.5 text-sm text-slate-700 hover:bg-slate-50",children:"Download"}):c.jsx("span",{className:"text-slate-400",children:""})}),ae.actions&&c.jsxs("td",{className:"px-4 py-3",ref:W,children:[c.jsx("button",{onClick:Ye=>{const ge=Ye.currentTarget.getBoundingClientRect();M({top:ge.bottom+8,left:Math.max(8,ge.right-144)}),T(Ge=>Ge===Fe.id?null:Fe.id)},className:"inline-flex h-9 w-9 items-center justify-center rounded-full border border-slate-300 bg-white text-slate-700 hover:bg-slate-50",title:"Actions",children:c.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:[c.jsx("circle",{cx:"12",cy:"5",r:"2"}),c.jsx("circle",{cx:"12",cy:"12",r:"2"}),c.jsx("circle",{cx:"12",cy:"19",r:"2"})]})}),C===Fe.id&&Uf.createPortal(c.jsxs("div",{ref:U,style:{position:"fixed",top:I.top,left:I.left,zIndex:1e3},className:"w-36 overflow-hidden rounded-lg border border-slate-200 bg-white shadow-lg",children:[c.jsx("button",{onClick:()=>{T(null),qe(Fe.id)},className:"block w-full px-3 py-2 text-left text-sm text-slate-700 hover:bg-slate-50",children:"View"}),c.jsx("button",{onClick:()=>Je(Fe),className:"block w-full px-3 py-2 text-left text-sm text-rose-600 hover:bg-rose-50",children:"Delete"})]}),document.body)]})]},Fe.id))]})]})}),c.jsxs("div",{className:"md:hidden",children:[i&&c.jsx("div",{className:"px-4 py-8 text-center text-slate-500",children:"Loading"}),!!u&&!i&&c.jsx("div",{className:"px-4 py-8 text-center text-rose-600",children:u}),!i&&!u&&Qe.length===0&&c.jsx("div",{className:"px-4 py-12 text-center text-slate-500",children:d.ready?"Nothing to display":"Loading"}),c.jsx("ul",{className:"divide-y divide-slate-100",children:Qe.map(Fe=>c.jsxs("li",{className:"p-4",children:[c.jsxs("div",{className:"flex items-start justify-between gap-3",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:Fe.name}),c.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[Fe.investor,"  ",Fe.entity]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[Fe.pdfAvailable?c.jsx("a",{href:`/api/statements/${Fe.id}/pdf`,className:"rounded-lg border border-slate-300 bg-white px-2.5 py-1 text-xs text-slate-700 hover:bg-slate-50",children:"PDF"}):null,c.jsx("button",{onClick:Ye=>{const ge=Ye.currentTarget.getBoundingClientRect();M({top:ge.bottom+8,left:Math.max(8,ge.right-144)}),T(Ge=>Ge===Fe.id?null:Fe.id)},className:"inline-flex h-8 w-8 items-center justify-center rounded-full border border-slate-300 bg-white text-slate-700 hover:bg-slate-50",title:"Actions",ref:W,children:c.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:[c.jsx("circle",{cx:"12",cy:"5",r:"2"}),c.jsx("circle",{cx:"12",cy:"12",r:"2"}),c.jsx("circle",{cx:"12",cy:"19",r:"2"})]})})]})]}),c.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-3 text-sm",children:[c.jsxs("div",{className:"rounded-lg bg-slate-50 px-3 py-2",children:[c.jsx("div",{className:"text-xs text-slate-500",children:"Due"}),c.jsx("div",{className:"text-slate-800",children:rl(Fe.dueDate)||""})]}),c.jsxs("div",{className:"rounded-lg bg-slate-50 px-3 py-2",children:[c.jsx("div",{className:"text-xs text-slate-500",children:"Amount"}),c.jsx("div",{className:"tabular-nums text-slate-800",children:V3(Fe.amountDue)})]}),c.jsxs("div",{className:"rounded-lg bg-slate-50 px-3 py-2",children:[c.jsx("div",{className:"text-xs text-slate-500",children:"Status"}),c.jsx("div",{className:q3("inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium",String(Fe.status).toLowerCase()==="paid"?"bg-green-50 text-green-700 ring-1 ring-green-200":"bg-amber-50 text-amber-700 ring-1 ring-amber-200"),children:Fe.status})]}),c.jsxs("div",{className:"rounded-lg bg-slate-50 px-3 py-2",children:[c.jsx("div",{className:"text-xs text-slate-500",children:"Paid"}),c.jsx("div",{className:"text-slate-800",children:rl(Fe.paidDate)||""})]})]}),C===Fe.id&&Uf.createPortal(c.jsxs("div",{ref:U,style:{position:"fixed",top:I.top,left:I.left,zIndex:1e3},className:"w-36 overflow-hidden rounded-lg border border-slate-200 bg-white shadow-lg",children:[c.jsx("button",{onClick:()=>{T(null),qe(Fe.id)},className:"block w-full px-3 py-2 text-left text-sm text-slate-700 hover:bg-slate-50",children:"View"}),c.jsx("button",{onClick:()=>Je(Fe),className:"block w-full px-3 py-2 text-left text-sm text-rose-600 hover:bg-rose-50",children:"Delete"})]}),document.body)]},Fe.id))})]})]}),F!==null&&c.jsxs("div",{className:"fixed inset-0 z-30",children:[c.jsx("div",{className:"absolute inset-0 bg-black/20",onClick:it}),c.jsxs("div",{className:"absolute right-0 top-0 h-full w-full max-w-[920px] overflow-y-auto rounded-l-2xl bg-white shadow-2xl",children:[c.jsxs("div",{className:"flex items-center justify-between border-b border-slate-200 px-5 py-4",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"text-sm text-slate-500",children:[je?.entity,"  ",je?.investor]}),c.jsxs("div",{className:"text-base font-semibold text-slate-900",children:["Statement ",je?.period?.start," "," ",je?.period?.end]})]}),c.jsx("button",{onClick:it,className:"rounded-full border border-slate-300 bg-white px-3 py-1.5 text-sm hover:bg-slate-50",children:"Close"})]}),c.jsxs("div",{className:"p-5",children:[c.jsx("div",{className:"mb-4 rounded-xl border border-slate-200 bg-slate-50",children:z?c.jsx("iframe",{title:"Statement PDF preview",src:z,style:{width:"100%",height:"72vh",border:0},onError:()=>q("Failed to load the PDF preview.")},F):null}),P&&c.jsxs("div",{className:"mb-4 text-center text-sm text-rose-600",children:[P," ",F?c.jsx("a",{className:"underline",href:`/api/statements/${F}/pdf`,children:"Download instead"}):null]}),V&&c.jsx("div",{className:"py-10 text-center text-slate-500",children:"Loading"}),!!Se&&c.jsx("div",{className:"whitespace-pre-wrap py-10 text-center text-rose-600",children:Se})]})]})]})]})}const K3="/api/documents";function G3(e){if(!e)return"";const t=e instanceof Date?e:new Date(e);return Number.isNaN(t.getTime())?"":t.toLocaleDateString()}function vS(e=""){const t=String(e).toLowerCase().match(/\.([a-z0-9]+)$/);return t?t[1]:""}const hde=new Set(["png","jpg","jpeg","gif","webp","bmp","svg"]),mde=new Set(["txt","csv","log","json","md","ts","js","py","xml","yaml","yml"]),pde=e=>hde.has(vS(e)),xde=e=>vS(e)==="pdf",vde=e=>mde.has(vS(e));function gde(){if(typeof window>"u")return null;try{const t=new URL(window.location.href).searchParams.get("investorId"),r=window.localStorage.getItem("currentInvestorId"),n=t||r;return n?Number(n):null}catch{return null}}function W3({anchorRect:e,onClose:t,children:r}){const[n,a]=y.useState({top:0,left:0}),i=y.useRef(null);return y.useEffect(()=>{function l(){const h=i.current?.getBoundingClientRect?.(),d=window.innerWidth,m=window.innerHeight,p=8;let v=e.left,g=e.bottom+6;const w=h?.width||220,b=h?.height||240;v+w+p>d&&(v=Math.max(p,d-w-p)),g+b+p>m&&(g=Math.max(p,e.top-b-6)),a({top:g,left:v})}l();const u=()=>t();return window.addEventListener("resize",l),window.addEventListener("scroll",l,!0),window.addEventListener("mousedown",u),()=>{window.removeEventListener("resize",l),window.removeEventListener("scroll",l,!0),window.removeEventListener("mousedown",u)}},[e,t]),Ib.createPortal(c.jsx("div",{ref:i,style:{position:"fixed",top:n.top,left:n.left,zIndex:1e4},className:"w-52 rounded-xl border border-slate-200 bg-white p-1 shadow-xl",onMouseDown:l=>l.stopPropagation(),children:r}),document.body)}function yde({open:e,onClose:t,file:r,fetchBlob:n,onDownload:a}){const[i,l]=y.useState(null),[u,h]=y.useState(""),[d,m]=y.useState(!1),[p,v]=y.useState("");if(y.useEffect(()=>{if(!e||!r)return;let j=!1,_=null;return(async()=>{try{m(!0),v("");const A=await n(r);if(j)return;h(A?.type||""),_=URL.createObjectURL(A),l(_)}catch(A){j||v(String(A?.message||A))}finally{j||m(!1)}})(),()=>{j=!0,_&&URL.revokeObjectURL(_),l(null)}},[e,r,n]),y.useEffect(()=>{function j(_){_.key==="Escape"&&t?.()}return e&&window.addEventListener("keydown",j),()=>window.removeEventListener("keydown",j)},[e,t]),!e)return null;const g=r?.name||r?.__doc?.title||"Document",w=pde(g)||u.startsWith("image/"),b=xde(g)||u==="application/pdf",S=vde(g)||/^text\/|\/json$/.test(u);return Ib.createPortal(c.jsx("div",{className:"fixed inset-0 z-[10002] bg-black/50",onMouseDown:t,children:c.jsxs("div",{className:"absolute inset-6 md:inset-12 lg:inset-16 bg-white rounded-2xl shadow-2xl overflow-hidden",onMouseDown:j=>j.stopPropagation(),children:[c.jsxs("div",{className:"flex items-center justify-between border-b border-slate-200 px-4 py-3",children:[c.jsx("div",{className:"truncate text-sm font-medium text-slate-800",children:g}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:()=>a(r),className:"rounded-md border border-slate-300 px-3 py-1.5 text-sm hover:bg-slate-50",children:"Download"}),c.jsx("button",{onClick:t,className:"rounded-md border border-slate-300 px-3 py-1.5 text-sm hover:bg-slate-50",children:"Close"})]})]}),c.jsxs("div",{className:"h-full overflow-auto bg-slate-50",children:[d&&c.jsx("div",{className:"p-6 text-center text-slate-600",children:"Loading preview"}),p&&c.jsxs("div",{className:"p-6 text-center text-rose-700",children:["Preview failed: ",p]}),!d&&!p&&i&&c.jsxs(c.Fragment,{children:[w&&c.jsx("img",{src:i,alt:g,className:"mx-auto block max-h-[calc(100vh-220px)] object-contain"}),b&&c.jsx("iframe",{title:"pdf",src:i,className:"w-full h-[calc(100vh-220px)]"}),S&&c.jsx("div",{className:"p-4",children:c.jsx("iframe",{title:"text",src:i,className:"w-full h-[calc(100vh-220px)] bg-white border rounded-lg"})}),!w&&!b&&!S&&c.jsxs("div",{className:"p-6 text-center text-slate-700",children:["Preview is not supported for this file type. Use"," ",c.jsx("span",{className:"font-medium",children:"Download"})," to open it locally."]})]})]})]})}),document.body)}function gS(){const[e,t]=y.useState(""),[r,n]=y.useState("dateDesc"),[a,i]=y.useState(!1),[l,u]=y.useState(""),[h,d]=y.useState([]),[m,p]=y.useState(!1),[v,g]=y.useState(null),[w,b]=y.useState(null),[S,j]=y.useState(null),_=gde();async function A(I,M={}){const W=await fetch(`${K3}${I}`,{...M,headers:{"Content-Type":"application/json",...M.headers||{}},credentials:"include"});if(W.status===401)throw u("Youre not signed in or your session expired. Please log in again."),new Error("Unauthorized");if(!W.ok){let U=`Request failed (${W.status})`;try{const F=await W.json();U=F?.error||F?.message||U}catch{}throw new Error(U)}return W.json()}async function k(I){const M=await fetch(`${K3}${I}`,{credentials:"include"});if(M.status===401)throw u("Youre not signed in or your session expired. Please log in again."),new Error("Unauthorized");if(!M.ok)throw new Error(`Request failed (${M.status})`);return M.blob()}y.useEffect(()=>{(async()=>{try{i(!0),u("");const I=_?`?investor_id=${_}`:"",M=await A(I),U=(Array.isArray(M.documents)?M.documents:[]).map(F=>({id:`doc:${F.id}`,name:F.title||F.original_name||`Document ${F.id}`,type:"file",dateUploaded:F.uploaded_at,__doc:F}));d(U)}catch{}finally{i(!1)}})()},[_]);const O=y.useMemo(()=>{const I=e.trim().toLowerCase();let M=I?h.filter(V=>(V.name||"").toLowerCase().includes(I)):[...h];const W=(V,H)=>(V.name||"").localeCompare(H.name||""),U=(V,H)=>-W(V,H),F=V=>{const H=V?.dateUploaded?new Date(V.dateUploaded):null;return H&&!Number.isNaN(H.getTime())?H.getTime():-1/0},oe=(V,H)=>F(V)-F(H)||W(V,H),je=(V,H)=>-oe(V,H),ue={az:W,za:U,dateAsc:oe,dateDesc:je};return M.sort(ue[r]||je),M},[h,e,r]);async function C(I){const M=I.__doc?.id??String(I.id).replace(/^doc:/,""),W=await k(`/download/${M}`),U=URL.createObjectURL(W),F=document.createElement("a");F.href=U,F.download=I.name||`document-${M}`,document.body.appendChild(F),F.click(),F.remove(),URL.revokeObjectURL(U)}async function T(I){const M=I.__doc?.id??String(I.id).replace(/^doc:/,"");return k(`/download/${M}`)}return c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"flex items-center justify-between",children:c.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:"Shared Files"})}),l&&c.jsx("div",{className:"rounded-lg border border-amber-300 bg-amber-50 px-3 py-2 text-sm text-amber-800",children:l}),c.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white shadow-sm",children:[c.jsxs("div",{className:"flex flex-col gap-3 border-b border-slate-200 px-4 py-3 md:flex-row md:items-center md:justify-between",children:[c.jsx("div",{className:"text-sm text-slate-600",children:"Documents shared with you by admin."}),c.jsxs("div",{className:"grid w-full grid-cols-1 gap-2 md:w-auto md:auto-cols-max md:grid-flow-col md:items-center",children:[c.jsx("input",{value:e,onChange:I=>t(I.target.value),placeholder:"Search...",className:"w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-sky-200"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("label",{className:"text-sm text-slate-600",children:"Sort:"}),c.jsxs("select",{value:r,onChange:I=>n(I.target.value),className:"rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm",children:[c.jsx("option",{value:"dateDesc",children:"Date  (New  Old)"}),c.jsx("option",{value:"dateAsc",children:"Date  (Old  New)"}),c.jsx("option",{value:"az",children:"A  Z (Name)"}),c.jsx("option",{value:"za",children:"Z  A (Name)"})]})]})]})]}),c.jsx("div",{className:"hidden overflow-x-auto md:block",children:c.jsxs("table",{className:"min-w-full table-fixed",children:[c.jsx("thead",{children:c.jsxs("tr",{className:"text-left text-xs font-semibold uppercase tracking-wide text-slate-500",children:[c.jsx("th",{className:"w-[70%] px-4 py-3",children:"Name"}),c.jsx("th",{className:"w-[30%] px-4 py-3",children:"Shared / Uploaded"})]})}),c.jsxs("tbody",{className:"divide-y divide-slate-100 text-sm",children:[O.length===0&&c.jsx("tr",{children:c.jsx("td",{colSpan:2,className:"px-4 py-10 text-center text-slate-500",children:a?"Loading":"No shared documents"})}),O.map(I=>c.jsxs("tr",{className:"hover:bg-slate-50/60 cursor-default",children:[c.jsx("td",{className:"px-4 py-3",children:c.jsx("button",{onClick:()=>{g(I),p(!0)},className:"truncate font-medium text-slate-800 hover:underline text-left",title:"Preview",children:I.name})}),c.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{children:G3(I.dateUploaded)||""}),c.jsx("button",{onClick:M=>{const W=M.currentTarget.getBoundingClientRect();j(W),b(I.id===w?null:I.id)},className:"rounded-md p-1 text-slate-500 hover:bg-slate-100","aria-label":"Row menu",children:c.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:[c.jsx("circle",{cx:"12",cy:"5",r:"1.5"}),c.jsx("circle",{cx:"12",cy:"12",r:"1.5"}),c.jsx("circle",{cx:"12",cy:"19",r:"1.5"})]})})]}),w===I.id&&S&&c.jsxs(W3,{anchorRect:S,onClose:()=>b(null),children:[c.jsx("button",{className:"w-full rounded-lg px-3 py-2 text-left text-sm hover:bg-slate-50",onClick:()=>{b(null),g(I),p(!0)},children:"Preview"}),c.jsx("button",{className:"w-full rounded-lg px-3 py-2 text-left text-sm hover:bg-slate-50",onClick:()=>{b(null),C(I).catch(M=>alert(String(M?.message||M)))},children:"Download"})]})]})]},I.id))]})]})}),c.jsx("div",{className:"md:hidden",children:O.length===0?c.jsx("div",{className:"px-4 py-10 text-center text-slate-500",children:a?"Loading":"No shared documents"}):c.jsx("ul",{className:"divide-y divide-slate-100",children:O.map(I=>c.jsxs("li",{className:"px-4 py-3",children:[c.jsxs("div",{className:"flex items-start",children:[c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("button",{onClick:()=>{g(I),p(!0)},className:"block w-full text-left truncate font-medium text-slate-800 hover:underline",children:I.name}),c.jsx("div",{className:"mt-0.5 text-xs text-slate-500",children:G3(I.dateUploaded)||""})]}),c.jsx("div",{className:"ml-2",children:c.jsx("button",{onClick:M=>{const W=M.currentTarget.getBoundingClientRect();j(W),b(I.id===w?null:I.id)},className:"rounded-md p-1 text-slate-500 hover:bg-slate-100","aria-label":"Row menu",children:c.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:[c.jsx("circle",{cx:"12",cy:"5",r:"1.5"}),c.jsx("circle",{cx:"12",cy:"12",r:"1.5"}),c.jsx("circle",{cx:"12",cy:"19",r:"1.5"})]})})})]}),w===I.id&&S&&c.jsxs(W3,{anchorRect:S,onClose:()=>b(null),children:[c.jsx("button",{className:"w-full rounded-lg px-3 py-2 text-left text-sm hover:bg-slate-50",onClick:()=>{b(null),g(I),p(!0)},children:"Preview"}),c.jsx("button",{className:"w-full rounded-lg px-3 py-2 text-left text-sm hover:bg-slate-50",onClick:()=>{b(null),C(I).catch(M=>alert(String(M?.message||M)))},children:"Download"})]})]},I.id))})})]}),c.jsx(yde,{open:m,onClose:()=>{p(!1),g(null)},file:v,fetchBlob:I=>T(I),onDownload:I=>C(I).catch(M=>alert(String(M?.message||M)))})]})}function bde(){if(typeof window>"u")return null;try{const t=new URL(window.location.href).searchParams.get("investorId"),r=window.localStorage.getItem("currentInvestorId"),n=t||r;return n?Number(n):null}catch{return null}}function yS({onSaved:e}){const[t,r]=y.useState(!1),[n,a]=y.useState(!1),[i,l]=y.useState(""),[u,h]=y.useState(!1),[d,m]=y.useState(null),[p,v]=y.useState(""),[g,w]=y.useState(null),[b,S]=y.useState({first_name:"",last_name:"",birthdate:"",citizenship:"",email:"",phone:"",ssn:"",emergency_contact:"",note:"",address1:"",address2:"",country:"",city:"",state:"",zip:"",bank_name:"",bank_account_name:"",bank_account_number:"",bank_account_type:"",bank_routing_number:"",bank_address:""}),j=y.useMemo(()=>{const W=(b.first_name||"").trim()[0]||"",U=(b.last_name||"").trim()[0]||"";return(W+U||"AI").toUpperCase()},[b.first_name,b.last_name]),_=y.useMemo(()=>d?URL.createObjectURL(d):"",[d]);y.useEffect(()=>()=>{_&&URL.revokeObjectURL(_)},[_]),y.useEffect(()=>{w(bde())},[]),y.useEffect(()=>{(async()=>{a(!0);try{const{data:W}=await We.get("/api/auth/me",{headers:{Accept:"application/json"},...g?{params:{investor_id:g}}:{}}),U=W.user||W,F=W.profile||{};S({first_name:U.first_name||F.first_name||"",last_name:U.last_name||F.last_name||"",birthdate:F.birthdate||"",citizenship:F.citizenship||"",email:U.email||F.email||"",phone:U.phone||F.phone||"",ssn:F.ssn||F.ssn_tax_id||"",emergency_contact:F.emergency_contact||"",note:F.note||"",address1:F.address1||U.address||"",address2:F.address2||"",country:F.country||"",city:F.city||"",state:F.state||"",zip:F.zip||"",bank_name:F.bank_name||"",bank_account_name:F.bank_account_name||"",bank_account_number:F.bank_account_number||"",bank_account_type:F.bank_account_type||"",bank_routing_number:F.bank_routing_number||"",bank_address:F.bank_address||""}),v(F.avatar_url||U.avatar_url||""),l("")}catch(W){const U=W?.response?.data?.msg||W?.response?.data?.error||(W?.response?`Failed to load profile (${W.response.status})`:"Failed to load your profile.");l(U)}finally{a(!1),h(!0)}})()},[g]);const A=W=>S(U=>({...U,[W.target.name]:W.target.value})),k=()=>{l(""),r(!0)},O=()=>{m(null),r(!1),l("")},C=W=>{const U=W.target.files?.[0];U&&m(U)},T=()=>{m(null),v("")},I=async W=>{W.preventDefault(),l("");const U=["first_name","last_name","birthdate","citizenship","email","phone","ssn","emergency_contact","address1","country","city","state","zip","bank_name","bank_account_name","bank_account_number","bank_account_type","bank_routing_number"];for(const F of U)if(!String(b[F]||"").trim()){l(`${F.replace(/_/g," ")} is required`);return}a(!0);try{if(await We.put("/api/auth/profile",b,g?{params:{investor_id:g}}:void 0),d||p===""){const F=new FormData;d&&F.append("avatar",d,d.name),p===""&&F.append("remove_avatar","1");const{data:oe}=await We.put("/api/auth/profile/avatar",F,{headers:{"Content-Type":"multipart/form-data"},...g?{params:{investor_id:g}}:{}});oe?.avatar_url!==void 0&&v(oe.avatar_url||"")}r(!1),e?.(!0)}catch(F){const oe=F?.response?.data?.msg||F?.response?.data?.error||(F?.response?`Save failed (${F.response.status})`:"Failed to save profile.");l(oe)}finally{a(!1)}},M=({label:W,name:U,required:F,type:oe="text",placeholder:je="",disabled:ue=!t})=>c.jsxs("div",{className:"space-y-1",children:[c.jsxs("label",{className:"block text-sm font-semibold text-gray-700",children:[W,F&&c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{name:U,type:oe,value:b[U],onChange:A,disabled:ue,placeholder:je,className:`w-full rounded-lg border px-3 py-2.5 bg-gray-50 focus:bg-white focus:outline-none focus:ring-4 focus:ring-indigo-100 ${ue?"text-gray-600 border-gray-200":"border-gray-300"}`})]});return c.jsxs("form",{onSubmit:I,className:"space-y-10",children:[c.jsxs("section",{className:"rounded-2xl border border-gray-200 bg-white shadow-sm",children:[c.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between p-6 border-b",children:[c.jsx("h2",{className:"text-xl font-semibold",children:"Personal Information"}),t?c.jsxs("div",{className:"flex items-center gap-3 self-start sm:self-auto",children:[c.jsx("button",{type:"button",onClick:O,className:"rounded-lg border px-3 py-1.5 text-gray-700 hover:bg-gray-50",disabled:n,children:"Cancel"}),c.jsx("button",{type:"submit",className:"rounded-lg bg-indigo-600 text-white px-4 py-2 hover:brightness-110 disabled:opacity-60",disabled:n,children:n?"Saving":"Save"})]}):c.jsx("button",{type:"button",onClick:k,className:"inline-flex items-center gap-2 rounded-lg border border-sky-300 text-sky-700 px-3 py-1.5 hover:bg-sky-50 disabled:opacity-60 self-start sm:self-auto",disabled:n||!u,children:"Edit"})]}),c.jsx("div",{className:"p-6",children:c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[112px_1fr] gap-6 items-start",children:[c.jsxs("div",{className:"flex flex-col items-start md:items-center gap-3",children:[c.jsx("div",{className:"relative h-24 w-24 rounded-full bg-teal-500 text-white grid place-items-center text-3xl font-semibold overflow-hidden",children:_||p?c.jsx("img",{src:_||p,alt:"Profile",className:"h-full w-full object-cover"}):j}),t&&c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("label",{className:"inline-flex items-center gap-2 rounded-lg border px-3 py-1.5 text-gray-700 hover:bg-gray-50 cursor-pointer",children:[c.jsx("input",{type:"file",accept:"image/*",onChange:C,className:"hidden"}),"Change"]}),(_||p)&&c.jsx("button",{type:"button",onClick:T,className:"text-rose-600 hover:underline text-sm",children:"Remove"})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsx(M,{label:"First Name",name:"first_name",required:!0,placeholder:"Benjamin"}),c.jsx(M,{label:"Last Name",name:"last_name",required:!0,placeholder:"Jones"}),c.jsx(M,{label:"Birthdate",name:"birthdate",required:!0,placeholder:"11/02/1968"}),c.jsx(M,{label:"Citizenship",name:"citizenship",required:!0,placeholder:"United States"}),c.jsx(M,{label:"Email",name:"email",required:!0,type:"email",placeholder:"ben@educounting.com"}),c.jsx(M,{label:"Phone",name:"phone",required:!0,placeholder:"3177015050"}),c.jsx(M,{label:"SSN / Tax ID",name:"ssn",required:!0,placeholder:"308-92-2338"}),c.jsx(M,{label:"Emergency Contact",name:"emergency_contact",required:!0,type:"tel",placeholder:"+1 555 987 6543"}),c.jsx("div",{className:"text-xs text-gray-500 self-end md:col-span-1",children:"SSN / Tax ID is an encrypted attribute"}),c.jsx("div",{className:"md:col-span-2",children:c.jsx(M,{label:"Note",name:"note",placeholder:"Add any extra personal notes here"})})]})]})})]}),c.jsxs("section",{className:"rounded-2xl border border-gray-200 bg-white shadow-sm",children:[c.jsxs("div",{className:"p-6 border-b",children:[c.jsx("h3",{className:"text-xl font-semibold",children:"Bank Information"}),c.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"These details are used for your bank, investment, credit, business and digital payment accounts."})]}),c.jsxs("div",{className:"p-6 grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsx(M,{label:"Bank Name",name:"bank_name",required:!0,placeholder:"ABC Bank"}),c.jsx(M,{label:"Account Name",name:"bank_account_name",required:!0,placeholder:"Benjamin Jones"}),c.jsx(M,{label:"Account Number",name:"bank_account_number",required:!0,placeholder:""}),c.jsxs("div",{className:"space-y-1",children:[c.jsxs("label",{className:"block text-sm font-semibold text-gray-700",children:["Account Type",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsxs("select",{name:"bank_account_type",value:b.bank_account_type,onChange:A,disabled:!t,className:`w-full rounded-lg border px-3 py-2.5 bg-gray-50 focus:bg-white focus:outline-none focus:ring-4 focus:ring-indigo-100 ${t?"border-gray-300":"text-gray-600 border-gray-200"}`,children:[c.jsx("option",{value:"",children:"Select account type"}),c.jsx("option",{value:"Bank Accounts",children:"Bank Accounts"}),c.jsx("option",{value:"Investment Accounts",children:"Investment Accounts"}),c.jsx("option",{value:"Credit Accounts",children:"Credit Accounts"}),c.jsx("option",{value:"Business & Corporate Accounts",children:"Business & Corporate Accounts"}),c.jsx("option",{value:"Digital & Payment Accounts",children:"Digital & Payment Accounts"})]})]}),c.jsx(M,{label:"Routing Number",name:"bank_routing_number",required:!0,placeholder:""}),c.jsx("div",{className:"md:col-span-2",children:c.jsx(M,{label:"Bank Address (Optional)",name:"bank_address",placeholder:"123 Main St, Suite 100, City, State ZIP"})})]})]}),c.jsxs("section",{className:"rounded-2xl border border-gray-200 bg-white shadow-sm",children:[c.jsx("div",{className:"p-6 border-b",children:c.jsx("h3",{className:"text-xl font-semibold",children:"Residential Address"})}),c.jsxs("div",{className:"p-6 grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsx("div",{className:"md:col-span-2",children:c.jsx(M,{label:"Street Address 1",name:"address1",required:!0,placeholder:"1496 Daylight Dr."})}),c.jsx("div",{className:"md:col-span-2",children:c.jsx(M,{label:"Street Address 2 (Optional)",name:"address2",placeholder:""})}),c.jsx(M,{label:"Country",name:"country",required:!0,placeholder:"United States"}),c.jsx(M,{label:"City",name:"city",required:!0,placeholder:"Carmel"}),c.jsx(M,{label:"State / Province",name:"state",required:!0,placeholder:"Indiana"}),c.jsx(M,{label:"Zip / Postal Code",name:"zip",required:!0,placeholder:"46280"})]})]}),i&&c.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 text-rose-700 px-4 py-3",children:i})]})}const wde=[{key:"name",label:"NAME",visible:!0},{key:"email",label:"EMAIL",visible:!0},{key:"phone",label:"PHONE",visible:!0},{key:"notes",label:"NOTES",visible:!0}];function Sde(){try{const t=new URL(window.location.href).searchParams.get("investorId"),r=localStorage.getItem("currentInvestorId");return Number(t||r||1)}catch{return 1}}function bS(){const e=Sde(),[t,r]=y.useState([]),[n,a]=y.useState(""),[i,l]=y.useState(wde),[u,h]=y.useState(!1),[d,m]=y.useState(!1),[p,v]=y.useState("add"),[g,w]=y.useState(null),[b,S]=y.useState(!1),[j,_]=y.useState("");y.useEffect(()=>{let M=!1;const W=setTimeout(async()=>{S(!0),_("");try{const F=(await We.get(`/api/contacts/${e}`,{params:{q:n,page:1,page_size:200}})).data;M||r(Array.isArray(F?.data)?F.data:[])}catch(U){if(!M){const F=U?.response?.data?.error||U?.message||"Failed to load contacts.";_(F)}}finally{M||S(!1)}},300);return()=>{M=!0,clearTimeout(W)}},[e,n]);const A=y.useMemo(()=>i.filter(M=>M.visible),[i]);function k(M){l(W=>W.map(U=>U.key===M?{...U,visible:!U.visible}:U))}function O(){const M=A,W=M.map(V=>V.label).join(","),U=t.map(V=>M.map(H=>{const Se=V[H.key]??"";return`"${String(Se).replaceAll('"','""')}"`}).join(",")),F=[W,...U].join(`
`),oe=new Blob([F],{type:"text/csv;charset=utf-8;"}),je=URL.createObjectURL(oe),ue=document.createElement("a");ue.href=je,ue.download="contacts.csv",ue.click(),URL.revokeObjectURL(je)}async function C(M){if(M&&window.confirm("Are you sure you want to delete this contact?"))try{await We.delete(`/api/contacts/item/${M}`),r(W=>W.filter(U=>U.id!==M))}catch(W){const U=W?.response?.data?.error||W?.message||"Failed to delete contact.";_(U)}}function T(){v("add"),w(null),m(!0)}function I(M){v("edit"),w(M),m(!0)}return c.jsxs("div",{className:"w-full",children:[c.jsxs("div",{className:"flex items-center justify-between gap-3 py-4",children:[c.jsx("div",{className:"flex-1 max-w-sm",children:c.jsxs("div",{className:"relative",children:[c.jsx("input",{value:n,onChange:M=>a(M.target.value),placeholder:"Search by anything",className:"w-full rounded-xl border border-gray-200 bg-white px-4 py-2.5 text-sm outline-none ring-0 placeholder:text-gray-400 focus:border-gray-300 focus:ring-2 focus:ring-gray-100"}),c.jsxs("svg",{viewBox:"0 0 24 24",className:"pointer-events-none absolute right-3 top-1/2 h-5 w-5 -translate-y-1/2 opacity-50",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[c.jsx("path",{d:"M21 21l-4.3-4.3"}),c.jsx("circle",{cx:"10",cy:"10",r:"7"})]})]})}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:O,className:"rounded-xl border border-gray-200 bg-white px-4 py-2 text-sm font-medium hover:bg-gray-50 active:scale-[.99]",title:"Export CSV",children:"Export"}),c.jsxs("div",{className:"relative",children:[c.jsx("button",{onClick:()=>h(M=>!M),className:"rounded-xl border border-gray-200 bg-white px-4 py-2 text-sm font-medium hover:bg-gray-50 active:scale-[.99]",title:"Show / hide columns",children:"Hide columns"}),u&&c.jsxs("div",{className:"absolute right-0 z-20 mt-2 w-56 overflow-hidden rounded-xl border border-gray-200 bg-white shadow-lg",onMouseLeave:()=>h(!1),children:[c.jsx("div",{className:"p-2 text-xs font-semibold text-gray-500",children:"Columns"}),c.jsx("div",{className:"max-h-64 overflow-auto p-2",children:i.map(M=>c.jsxs("label",{className:"flex cursor-pointer items-center gap-3 rounded-lg px-2 py-2 text-sm hover:bg-gray-50",children:[c.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded",checked:M.visible,onChange:()=>k(M.key)}),c.jsx("span",{children:M.label})]},M.key))})]})]}),c.jsxs("button",{onClick:T,className:"inline-flex items-center gap-2 rounded-xl bg-[#2B86C5] px-4 py-2 text-sm font-semibold text-white shadow-sm hover:brightness-110 active:scale-[.99]",children:[c.jsx("span",{className:"inline-flex h-5 w-5 items-center justify-center rounded-md bg-white/20",children:"+"}),"Add Contact"]})]})]}),c.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white",children:[c.jsxs("div",{className:"grid grid-cols-5 gap-4 border-b border-gray-100 px-5 py-3 text-xs font-semibold tracking-wide text-gray-500",children:[A.map(M=>c.jsx("div",{children:M.label},M.key)),c.jsx("div",{className:"text-right",children:"Action"})]}),b?c.jsx("div",{className:"flex min-h-[220px] items-center justify-center p-8",children:c.jsx("span",{className:"text-sm text-gray-500",children:"Loading"})}):j?c.jsx("div",{className:"flex min-h-[220px] items-center justify-center p-8",children:c.jsx("span",{className:"text-sm text-red-500",children:j})}):t.length>0?c.jsx("div",{className:"divide-y divide-gray-100",children:t.map(M=>c.jsxs("div",{className:"grid grid-cols-5 gap-4 px-5 py-4 text-sm",children:[A.map(W=>c.jsx("div",{children:M[W.key]||c.jsx("span",{className:"text-gray-400",children:""})},W.key)),c.jsx("div",{className:"flex items-center justify-end",children:c.jsx(Ede,{onEdit:()=>I(M),onDelete:()=>C(M.id)})})]},M.id??`${M.name}-${M.email}`))}):c.jsxs("div",{className:"flex min-h-[260px] flex-col items-center justify-center gap-2 px-6 py-16 text-center",children:[c.jsx("p",{className:"max-w-2xl text-base font-semibold text-gray-700",children:"Please add anyone here you would like copied on correspondence such as emails and invoices."}),c.jsx("p",{className:"text-sm text-gray-400",children:"Nothing to display"})]})]}),d&&c.jsx(jde,{mode:p,investorId:e,contactId:g?.id,initial:g,onClose:()=>{m(!1),w(null)},onSaved:(M,W)=>{M&&r(U=>W==="edit"?U.map(F=>F.id===M.id?M:F):[M,...U]),m(!1),w(null)}})]})}function Ede({onEdit:e,onDelete:t}){const[r,n]=y.useState(!1),a=y.useRef(null);return y.useEffect(()=>{function i(l){a.current&&!a.current.contains(l.target)&&n(!1)}return r&&document.addEventListener("mousedown",i),()=>{document.removeEventListener("mousedown",i)}},[r]),c.jsxs("div",{className:"relative",ref:a,children:[c.jsx("button",{type:"button",onClick:()=>n(i=>!i),className:"inline-flex h-8 w-8 items-center justify-center rounded-full hover:bg-gray-100 text-gray-600",title:"Actions",children:c.jsxs("svg",{viewBox:"0 0 24 24",className:"h-5 w-5",fill:"currentColor","aria-hidden":"true",children:[c.jsx("circle",{cx:"12",cy:"5",r:"1.6"}),c.jsx("circle",{cx:"12",cy:"12",r:"1.6"}),c.jsx("circle",{cx:"12",cy:"19",r:"1.6"})]})}),r&&c.jsxs("div",{className:"absolute right-0 z-30 mt-1 w-32 rounded-lg border border-gray-200 bg-white py-1 text-sm shadow-lg",children:[c.jsx("button",{type:"button",onClick:()=>{n(!1),e?.()},className:"flex w-full items-center px-3 py-1.5 text-left hover:bg-gray-50",children:"Edit"}),c.jsx("button",{type:"button",onClick:()=>{n(!1),t?.()},className:"flex w-full items-center px-3 py-1.5 text-left text-red-600 hover:bg-red-50",children:"Delete"})]})]})}function jde({mode:e="add",investorId:t,contactId:r,initial:n,onClose:a,onSaved:i}){const[l,u]=y.useState({name:n?.name||"",email:n?.email||"",phone:n?.phone||"",notes:n?.notes||""}),[h,d]=y.useState(!1),[m,p]=y.useState("");y.useEffect(()=>{u({name:n?.name||"",email:n?.email||"",phone:n?.phone||"",notes:n?.notes||""})},[n,e]);async function v(){if(!l.name.trim()||!l.email.trim()){p("Name and Email are required.");return}d(!0),p("");try{let b;e==="edit"&&r?b=await We.put(`/api/contacts/item/${r}`,{name:l.name.trim(),email:l.email.trim(),phone:l.phone.trim()||null,notes:l.notes.trim()||null}):b=await We.post(`/api/contacts/${t}`,{name:l.name.trim(),email:l.email.trim(),phone:l.phone.trim()||null,notes:l.notes.trim()||null});const S=b.data;i?.(S?.data||null,e)}catch(b){const S=b?.response?.data?.error||b?.message||"Failed to save contact.";p(S)}finally{d(!1)}}const g=e==="edit"?"Edit Contact":"Add Contact",w=e==="edit"?"Save Changes":"Save Contact";return c.jsxs("div",{className:"fixed inset-0 z-40 flex items-center justify-center",children:[c.jsx("div",{className:"absolute inset-0 bg-black/30 backdrop-blur-[2px]",onClick:a}),c.jsxs("div",{className:"relative z-50 w-full max-w-lg rounded-2xl bg-white p-6 shadow-2xl",children:[c.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[c.jsx("h3",{className:"text-lg font-semibold",children:g}),c.jsx("button",{className:"rounded-lg p-2 text-gray-500 hover:bg-gray-50",onClick:a,"aria-label":"Close",title:"Close",children:""})]}),c.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[c.jsx(Th,{label:"Name",value:l.name,onChange:b=>u(S=>({...S,name:b})),placeholder:"Jane Cooper",required:!0}),c.jsx(Th,{label:"Email",type:"email",value:l.email,onChange:b=>u(S=>({...S,email:b})),placeholder:"jane@example.com",required:!0}),c.jsx(Th,{label:"Phone",value:l.phone,onChange:b=>u(S=>({...S,phone:b})),placeholder:"+1 555 0123"}),c.jsx(Th,{label:"Notes",as:"textarea",value:l.notes,onChange:b=>u(S=>({...S,notes:b})),placeholder:"Optional notes"})]}),m&&c.jsx("div",{className:"mt-3 rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700",children:m}),c.jsxs("div",{className:"mt-6 flex items-center justify-end gap-2",children:[c.jsx("button",{onClick:a,className:"rounded-xl border border-gray-200 bg-white px-4 py-2 text-sm font-medium hover:bg-gray-50",disabled:h,children:"Cancel"}),c.jsx("button",{onClick:v,className:"rounded-xl bg-[#2B86C5] px-4 py-2 text-sm font-semibold text-white hover:brightness-110 disabled:opacity-60",disabled:h,children:h?"Saving":w})]})]})]})}function Th({label:e,value:t,onChange:r,placeholder:n,as:a="input",type:i="text",required:l=!1}){const u=a;return c.jsxs("label",{className:"block text-sm",children:[c.jsxs("span",{className:"mb-1 block font-medium text-gray-700",children:[e," ",l&&c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx(u,{type:i,value:t,onChange:h=>r(h.target.value),placeholder:n,className:`w-full rounded-xl border border-gray-200 bg-white px-3 py-2 outline-none ring-0 placeholder:text-gray-400 focus:border-gray-300 focus:ring-2 focus:ring-gray-100 ${a==="textarea"?"min-h-[88px]":""}`})]})}const TM=y.createContext(null);function Nde({children:e}){const[t,r]=y.useState([]),n=y.useRef(1),a=y.useCallback((l,u)=>{const h=n.current++;r(d=>[...d,{id:h,type:l,message:u}]),setTimeout(()=>r(d=>d.filter(m=>m.id!==h)),4e3)},[]),i=y.useMemo(()=>({success:l=>a("success",l),error:l=>a("error",l),info:l=>a("info",l)}),[a]);return c.jsxs(TM.Provider,{value:i,children:[e,c.jsx("div",{className:"pointer-events-none fixed right-4 top-4 z-[100] flex w-[320px] flex-col gap-2",children:t.map(l=>c.jsx("div",{className:`pointer-events-auto rounded-xl border px-3 py-2 text-sm shadow ${l.type==="success"?"border-emerald-200 bg-emerald-50 text-emerald-900":l.type==="error"?"border-red-200 bg-red-50 text-red-900":"border-gray-200 bg-white text-gray-900"}`,children:l.message},l.id))})]})}const Ade=()=>y.useContext(TM);function _de(){const e=Ade(),[t,r]=y.useState([]),[n,a]=y.useState(!0),[i,l]=y.useState(""),[u,h]=y.useState(""),[d,m]=y.useState(""),[p,v]=y.useState(null);y.useEffect(()=>{try{if(p){const ae=p.investor_id||p.id,me=[p.workbook_investor_name,p.investor_name,p.name,[p.first_name,p.last_name].filter(Boolean).join(" ")].map(ce=>(ce||"").trim()).filter(Boolean)[0];me&&window.localStorage.setItem("investorHint",me),ae?(window.localStorage.setItem("currentInvestorId",String(ae)),We.defaults.headers.common["X-View-As-Investor"]=String(ae)):(window.localStorage.removeItem("currentInvestorId"),delete We.defaults.headers.common["X-View-As-Investor"])}else window.localStorage.removeItem("currentInvestorId"),delete We.defaults.headers.common["X-View-As-Investor"]}catch(ae){console.warn("Failed to set view-as investor context:",ae)}},[p]);const[g,w]=y.useState(0),[b,S]=y.useState(!1),[j,_]=y.useState([]),[A,k]=y.useState(!1),O=["All","IRA","ROTH IRA","Retirement","Depends"],[C,T]=y.useState("All"),[I,M]=y.useState(!1),[W,U]=y.useState(!1),[F,oe]=y.useState("invite"),[je,ue]=y.useState(null),[V,H]=y.useState({name:"",email:"",investor_type:"IRA",depends_on_id:null,parent_relationship:""}),Se=()=>{oe("invite"),ue(null),H({name:"",email:"",investor_type:"IRA",depends_on_id:null,parent_relationship:""})},Q=y.useMemo(()=>new Intl.NumberFormat(void 0,{style:"currency",currency:"USD",maximumFractionDigits:2}),[]),z=ae=>{if(!ae)return"";try{const de=new Date(ae);return Number.isNaN(de.getTime())?ae:de.toLocaleString()}catch{return ae}},Y=y.useCallback(async()=>{let ae=!0;a(!0),h("");try{const{data:de}=await We.get("/api/invitations",{params:{status:"accepted"},headers:{Accept:"application/json"}});if(!ae)return;const ce=(Array.isArray(de)?de:Array.isArray(de?.items)?de.items:Array.isArray(de?.data)?de.data:[]).filter(ze=>(ze.status||"accepted").toLowerCase()==="accepted").map(ze=>{const Qe=ze.investor||{};return{id:ze.id??ze.invitation_id??Qe.id??crypto.randomUUID(),investor_id:Qe.id??null,name:Qe.name||ze.name||"",email:Qe.email||ze.email||"",company_name:Qe.company_name||"",contact_phone:Qe.contact_phone||"",investor_type:Qe.investor_type||"",parent_investor_id:Qe.parent_investor_id??null,parent_relationship:Qe.parent_relationship||null,created_at:ze.created_at||null,used_at:ze.used_at||null,current_balance:ze.current_balance??ze.ending_balance??ze.balance??null,balance_source:ze.balance_source||null,balance_as_of:ze.balance_as_of||null}});r(ce),l("/api/invitations?status=accepted")}catch(de){h(de?.response?.data?.error||de?.message||"Failed to load accepted investors."),e.error("Failed to load accepted investors.")}finally{a(!1)}return()=>{ae=!1}},[e]);y.useEffect(()=>{Y()},[Y]);const P=y.useCallback(async()=>{try{const{data:ae}=await We.get("/api/invitations/stats"),de=Number(ae?.pending||0);w(Number.isFinite(de)?de:0)}catch{try{const{data:ae}=await We.get("/api/invitations",{params:{status:"pending",per_page:1}});w(Number(ae?.total||0))}catch{w(0)}}},[]),q=y.useCallback(async()=>{k(!0);try{const{data:ae}=await We.get("/api/invitations",{params:{status:"pending",per_page:200,page:1,sort:"created_at",order:"desc"}}),de=Array.isArray(ae)?ae:Array.isArray(ae?.items)?ae.items:[];_(de)}catch{e.error("Failed to load pending invitations.")}finally{k(!1)}},[e]);y.useEffect(()=>{P()},[P]);const G=async ae=>{if(ae&&confirm("Cancel this invitation?"))try{await We.delete(`/api/invitations/${ae}`),e.success("Invitation cancelled."),await Promise.all([P(),q()])}catch(de){e.error(de?.response?.data?.error||de?.message||"Cancel failed.")}},Z=y.useMemo(()=>{const ae=new Map;return t.forEach(de=>{de.investor_id&&ae.set(Number(de.investor_id),de.name||de.email)}),ae},[t]),fe=y.useMemo(()=>{const ae=d.trim().toLowerCase();return t.filter(de=>{const me=!ae||de.name.toLowerCase().includes(ae)||de.email.toLowerCase().includes(ae)||de.company_name.toLowerCase().includes(ae),ce=C==="All"||(de.investor_type||"").toLowerCase()===C.toLowerCase();return me&&ce})},[t,d,C]),Oe=y.useMemo(()=>{const ae=Number(je||0);return t.map(de=>({value:Number(de.investor_id||de.id),label:de.name||de.email||`Investor ${de.id}`})).filter(de=>Number.isFinite(de.value)&&(!ae||de.value!==ae))},[t,je]),Re=ae=>{const{name:de,value:me}=ae.target;H(ce=>({...ce,[de]:me}))},re=async()=>{await We.post("/admin/invite",{email:V.email.trim(),name:V.name.trim(),user_type:"investor",investor_type:V.investor_type,...V.investor_type==="Depends"&&V.depends_on_id?{depends_on_id:V.depends_on_id,parent_relationship:V.parent_relationship.trim()||null}:{}},{headers:{"Content-Type":"application/json"}})},be=async ae=>{await We.put(`/api/investors/${ae}`,{name:V.name.trim(),email:V.email.trim(),investor_type:V.investor_type,depends_on_ids:V.investor_type==="Depends"&&V.depends_on_id?[V.depends_on_id]:[],parent_relationship:V.investor_type==="Depends"&&V.parent_relationship.trim()||null},{headers:{"Content-Type":"application/json"}})},Ae=async ae=>{if(ae.preventDefault(),!V.name.trim()||!V.email.trim()){e.error("Please provide both Name and Email.");return}if(V.investor_type==="Depends"){if(Oe.length===0){e.error("No existing investors to select as a dependent. Create one first.");return}if(!V.depends_on_id){e.error("Please select one dependent investor.");return}if(!V.parent_relationship.trim()){e.error("Please enter the relationship between the investors.");return}}U(!0);try{F==="invite"?(await re(),e.success(`Invitation sent to ${V.email}.`),await P()):F==="edit"&&je&&(await be(je),e.success("Investor updated.")),await Y(),Se(),M(!1)}catch(de){e.error(de?.response?.data?.msg||de?.response?.data?.error||de?.message||"Action failed.")}finally{U(!1)}},D=ae=>{oe("edit"),ue(ae.investor_id||ae.id),H({name:ae.name||"",email:ae.email||"",investor_type:ae.investor_type||"IRA",depends_on_id:null,parent_relationship:ae.parent_relationship||""}),M(!0)},Me=async ae=>{const de=ae.investor_id||ae.id;if(!de){e.error("Missing investor id.");return}if(confirm(`Delete investor "${ae.name||ae.email}"?`))try{await We.delete(`/api/investors/${de}`),await Y(),e.success("Investor deleted.")}catch(me){e.error(me?.response?.data?.error||me?.message||"Delete failed.")}};if(p){const ae=p.investor_id||p.id||null;return c.jsx("div",{className:"p-6",children:c.jsx(Tde,{investor:p,investorId:ae,onBack:()=>v(null)})})}return c.jsxs("div",{className:"p-6",children:[c.jsxs("div",{className:"mb-4 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[c.jsx("h2",{className:"text-xl font-semibold",children:"Investors (Invitation Accepted)"}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("button",{type:"button",onClick:async()=>{await q(),S(!0)},className:"rounded-full border border-amber-200 bg-amber-50 px-3 py-1 text-xs font-medium text-amber-900 hover:bg-amber-100",title:"View pending invitations",children:["Pending: ",g]}),c.jsx("select",{className:"rounded-lg border px-3 py-2 text-sm",value:C,onChange:ae=>T(ae.target.value),title:"Filter by type",children:O.map(ae=>c.jsx("option",{value:ae,children:ae},ae))}),c.jsx("button",{type:"button",onClick:()=>{Se(),oe("invite"),M(!0)},className:"rounded-xl border bg-black px-4 py-2 text-sm font-medium text-white shadow hover:opacity-90 active:opacity-80",children:"+ Add Investor"})]})]}),c.jsx("div",{className:"mb-4 flex gap-3",children:c.jsx("input",{type:"text",value:d,onChange:ae=>m(ae.target.value),placeholder:"Search by name, company, or email",className:"w-full max-w-sm rounded-lg border px-3 py-2 outline-none focus:ring"})}),n&&c.jsx("div",{className:"rounded-lg border p-6 text-gray-600",children:"Loading"}),!n&&u&&c.jsx("div",{className:"rounded-lg border border-red-300 bg-red-50 p-4 text-red-700",children:u}),!n&&!u&&c.jsx("div",{className:"overflow-x-auto rounded-lg border",children:c.jsxs("table",{className:"min-w-full text-left text-sm",children:[c.jsx("thead",{className:"bg-gray-50 text-gray-700",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-3 font-medium",children:"Investor"}),c.jsx("th",{className:"px-4 py-3 font-medium",children:"Company"}),c.jsx("th",{className:"px-4 py-3 font-medium",children:"Email"}),c.jsx("th",{className:"px-4 py-3 font-medium",children:"Contact"}),c.jsx("th",{className:"px-4 py-3 font-medium",children:"Type"}),c.jsx("th",{className:"px-4 py-3 font-medium",children:"Parent"}),c.jsx("th",{className:"px-4 py-3 font-medium",children:"Invited On"}),c.jsx("th",{className:"px-4 py-3 font-medium",children:"Accepted On"}),c.jsx("th",{className:"px-4 py-3 font-medium",children:"Current Balance"}),c.jsx("th",{className:"px-4 py-3 font-medium",children:"Action"})]})}),c.jsxs("tbody",{className:"divide-y",children:[fe.map(ae=>{const de=ae.current_balance==null?"":Q.format(Number(ae.current_balance)),me=ae.parent_investor_id&&Z.get(Number(ae.parent_investor_id))?Z.get(Number(ae.parent_investor_id)):ae.parent_investor_id?`#${ae.parent_investor_id}`:"";return c.jsxs("tr",{children:[c.jsx("td",{className:"px-4 py-3",children:c.jsx("button",{type:"button",onClick:()=>v(ae),className:"text-sky-700 hover:underline font-medium",title:"View investor dashboard",children:ae.name||""})}),c.jsx("td",{className:"px-4 py-3",children:ae.company_name||""}),c.jsx("td",{className:"px-4 py-3",children:ae.email||""}),c.jsx("td",{className:"px-4 py-3",children:ae.contact_phone||""}),c.jsx("td",{className:"px-4 py-3",children:ae.investor_type||""}),c.jsx("td",{className:"px-4 py-3",children:me}),c.jsx("td",{className:"px-4 py-3",children:z(ae.created_at)}),c.jsx("td",{className:"px-4 py-3",children:z(ae.used_at)}),c.jsx("td",{className:"px-4 py-3",children:c.jsxs("div",{className:"flex flex-col",children:[c.jsx("span",{children:de}),ae.balance_as_of&&c.jsxs("span",{className:"text-xs text-gray-500",children:["as of ",z(ae.balance_as_of)]})]})}),c.jsx("td",{className:"px-4 py-3",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{type:"button",onClick:()=>D(ae),className:"rounded-lg border px-2 py-1 text-xs hover:bg-gray-50",title:"Edit",children:"Edit"}),c.jsx("button",{type:"button",onClick:()=>Me(ae),className:"rounded-lg border px-2 py-1 text-xs hover:bg-gray-50",title:"Delete",children:"Delete"})]})})]},ae.id)}),fe.length===0&&c.jsx("tr",{children:c.jsx("td",{className:"px-4 py-6 text-gray-600",colSpan:10,children:"No investors found."})})]})]})}),I&&c.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center",children:[c.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>W?null:M(!1)}),c.jsxs("div",{className:"relative z-[61] w-full max-w-lg rounded-2xl bg-white p-6 shadow-xl",children:[c.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[c.jsx("h3",{className:"text-lg font-semibold",children:F==="edit"?"Edit Investor":"Invite Investor"}),c.jsxs("button",{type:"button",onClick:async()=>{await q(),S(!0)},className:"rounded-full border border-amber-200 bg-amber-50 px-2.5 py-1 text-xs font-medium text-amber-900 hover:bg-amber-100",title:"View pending invitations",children:["Pending: ",g]}),c.jsx("button",{onClick:()=>W?null:M(!1),className:"rounded-full px-2 py-1 text-gray-500 hover:bg-gray-100",title:"Close",type:"button",children:""})]}),c.jsxs("form",{onSubmit:Ae,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Name"}),c.jsx("input",{name:"name",type:"text",value:V.name,onChange:Re,placeholder:"Investor full name",className:"w-full rounded-lg border px-3 py-2 outline-none focus:ring",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Email"}),c.jsx("input",{name:"email",type:"email",value:V.email,onChange:Re,placeholder:"email@example.com",className:"w-full rounded-lg border px-3 py-2 outline-none focus:ring",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Investor Type"}),c.jsxs("select",{name:"investor_type",value:V.investor_type,onChange:Re,className:"w-full rounded-lg border px-3 py-2 outline-none focus:ring",children:[c.jsx("option",{value:"IRA",children:"IRA"}),c.jsx("option",{value:"ROTH IRA",children:"ROTH IRA"}),c.jsx("option",{value:"Retirement",children:"Retirement"}),c.jsx("option",{value:"Depends",children:"Depends"})]})]}),V.investor_type==="Depends"&&(Oe.length>0?c.jsxs(c.Fragment,{children:[c.jsx(kde,{label:"Dependent investor (required)",options:Oe,value:V.depends_on_id,onChange:ae=>H(de=>({...de,depends_on_id:ae}))}),c.jsxs("div",{className:"mt-3",children:[c.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Relationship with parent investor"}),c.jsx("input",{type:"text",name:"parent_relationship",value:V.parent_relationship,onChange:Re,placeholder:"e.g., Self, Spouse, Child, Trust",className:"w-full rounded-lg border px-3 py-2 text-sm outline-none focus:ring"})]})]}):c.jsx("p",{className:"text-xs text-red-600",children:"No existing investors found. Create at least one investor first to set as dependent."})),c.jsxs("div",{className:"flex items-center justify-end gap-3 pt-2",children:[c.jsx("button",{type:"button",onClick:()=>W?null:M(!1),className:"rounded-lg border px-4 py-2 text-sm hover:bg-gray-50",disabled:W,children:"Cancel"}),c.jsx("button",{type:"submit",className:"rounded-lg bg-black px-4 py-2 text-sm font-medium text-white shadow hover:opacity-90 disabled:opacity-60",disabled:W,children:W?F==="edit"?"Saving":"Sending":F==="edit"?"Update":"Send Invite"})]})]})]})]}),b&&c.jsxs("div",{className:"fixed inset-0 z-[70]",children:[c.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>S(!1)}),c.jsxs("div",{className:"absolute right-0 top-0 h-full w-full max-w-md bg-white shadow-xl",children:[c.jsxs("div",{className:"flex items-center justify-between border-b px-5 py-4",children:[c.jsxs("div",{className:"text-lg font-semibold",children:["Pending Invitations (",g,")"]}),c.jsx("button",{className:"rounded-full px-2 py-1 text-gray-500 hover:bg-gray-100",onClick:()=>S(!1),title:"Close",children:""})]}),c.jsxs("div",{className:"p-4",children:[A&&c.jsx("div",{className:"rounded-lg border p-4 text-gray-600",children:"Loading"}),!A&&j.length===0&&c.jsx("div",{className:"rounded-lg border p-4 text-gray-600",children:"No pending invitations."}),!A&&j.length>0&&c.jsx("div",{className:"space-y-2",children:j.map(ae=>c.jsxs("div",{className:"flex items-center justify-between rounded-lg border px-3 py-2",children:[c.jsxs("div",{children:[c.jsx("div",{className:"font-medium",children:ae.name||ae.email||""}),c.jsxs("div",{className:"text-xs text-gray-500",children:[ae.email,"  invited ",z(ae.created_at)]})]}),c.jsx("button",{className:"rounded-lg border px-3 py-1 text-xs hover:bg-gray-50",onClick:()=>G(ae.id),title:"Cancel invitation",children:"Cancel"})]},ae.id))})]})]})]})]})}function Tde({investor:e,investorId:t,onBack:r}){const[n,a]=y.useState("overview"),i=[{id:"overview",label:"Overview"},{id:"portfolio",label:"Portfolio"},{id:"statements",label:"Statements"},{id:"documents",label:"Documents"},{id:"personalinformation",label:"Personal Information"},{id:"contacts",label:"Contacts"}],l="inline-flex items-center whitespace-nowrap px-3 sm:px-4 py-2 text-sm font-medium rounded-t-md border-b-2 transition-colors focus:outline-none focus-visible:ring-2 focus-visible:ring-sky-500",u="border-transparent text-slate-600 hover:text-sky-700 hover:bg-sky-50",h="border-sky-500 text-sky-700 bg-sky-50",d=e?.name||e?.email||`Investor #${t||""}`;return c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("button",{type:"button",onClick:r,className:"inline-flex items-center gap-2 rounded-full border px-3 py-1 text-xs font-medium text-slate-700 hover:bg-gray-50",children:[c.jsx("span",{className:"text-lg leading-none",children:""}),c.jsx("span",{children:"Back to investor list"})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Admin  Investor Dashboard"}),c.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-slate-900",children:d}),e?.investor_type&&c.jsxs("div",{className:"text-xs text-slate-500",children:["Type: ",e.investor_type]})]})]})}),c.jsx("div",{className:"border-b border-slate-200",children:c.jsx("nav",{className:"flex gap-1 sm:gap-2 overflow-x-auto",children:i.map(m=>c.jsx("button",{type:"button",onClick:()=>a(m.id),className:`${l} ${n===m.id?h:u}`,children:m.label},m.id))})}),c.jsxs("div",{className:"mt-4",children:[n==="overview"&&c.jsx(mS,{adminView:!0,investorId:t}),n==="portfolio"&&c.jsx(pS,{adminView:!0,investorId:t}),n==="statements"&&c.jsx(xS,{adminView:!0,investorId:t}),n==="documents"&&c.jsx(gS,{adminView:!0,investorId:t}),n==="personalinformation"&&c.jsx(yS,{adminView:!0,investorId:t}),n==="contacts"&&c.jsx(bS,{adminView:!0,investorId:t})]})]})}function kde({label:e,options:t,value:r,onChange:n}){const[a,i]=y.useState(!1),l=y.useRef(null);y.useEffect(()=>{function d(m){l.current&&(l.current.contains(m.target)||i(!1))}return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[]);const u=t.find(d=>d.value===r)||null,h=u?u.label:"Select an investor";return c.jsxs("div",{className:"relative",ref:l,children:[c.jsx("label",{className:"mb-1 block text-sm font-medium",children:e}),c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between rounded-lg border px-3 py-2 text-left text-sm outline-none focus:ring",onClick:()=>i(d=>!d),children:[c.jsx("span",{className:"truncate",children:h}),c.jsx("svg",{className:`h-4 w-4 transition ${a?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{d:"M5.23 7.21a.75.75 0 011.06.02L10 10.585l3.71-3.354a.75.75 0 111.02 1.1l-4.22 3.81a.75.75 0 01-1.02 0l-4.22-3.81a.75.75 0 01-.02-1.06z"})})]}),a&&c.jsxs("div",{className:"absolute z-10 mt-1 w-full rounded-lg border bg-white shadow",children:[c.jsxs("div",{className:"max-h-60 overflow-auto py-1",children:[t.map(d=>c.jsxs("label",{className:"flex cursor-pointer items-center gap-2 px-3 py-2 text-sm hover:bg-gray-50",onClick:()=>{n(d.value),i(!1)},children:[c.jsx("input",{type:"radio",name:"single-select",checked:r===d.value,onChange:()=>{},className:"h-4 w-4"}),c.jsx("span",{className:"truncate",children:d.label})]},d.value)),t.length===0&&c.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No investors found."})]}),c.jsx("div",{className:"flex items-center justify-end gap-2 border-t px-3 py-2 text-xs",children:r!==null&&c.jsx("button",{type:"button",onClick:()=>n(null),className:"rounded border px-2 py-1 hover:bg-gray-50",children:"Clear"})})]})]})}function Cde(){return c.jsx(Nde,{children:c.jsx(_de,{})})}var kM={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Y3=pn.createContext&&pn.createContext(kM),Ode=["attr","size","title"];function Dde(e,t){if(e==null)return{};var r=Pde(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Pde(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Fm(){return Fm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fm.apply(this,arguments)}function X3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Im(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?X3(Object(r),!0).forEach(function(n){Rde(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Rde(e,t,r){return t=Mde(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Mde(e){var t=Fde(e,"string");return typeof t=="symbol"?t:t+""}function Fde(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CM(e){return e&&e.map((t,r)=>pn.createElement(t.tag,Im({key:r},t.attr),CM(t.child)))}function ya(e){return t=>pn.createElement(Ide,Fm({attr:Im({},e.attr)},t),CM(e.child))}function Ide(e){var t=r=>{var{attr:n,size:a,title:i}=e,l=Dde(e,Ode),u=a||r.size||"1em",h;return r.className&&(h=r.className),e.className&&(h=(h?h+" ":"")+e.className),pn.createElement("svg",Fm({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,n,l,{className:h,style:Im(Im({color:e.color||r.color},r.style),e.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),i&&pn.createElement("title",null,i),e.children)};return Y3!==void 0?pn.createElement(Y3.Consumer,null,r=>t(r)):t(kM)}function Lde(e){return ya({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M14 3v4a1 1 0 0 0 1 1h4"},child:[]},{tag:"path",attr:{d:"M5 12v-7a2 2 0 0 1 2 -2h7l5 5v4"},child:[]},{tag:"path",attr:{d:"M7 16.5a1.5 1.5 0 0 0 -3 0v3a1.5 1.5 0 0 0 3 0"},child:[]},{tag:"path",attr:{d:"M10 20.25c0 .414 .336 .75 .75 .75h1.25a1 1 0 0 0 1 -1v-1a1 1 0 0 0 -1 -1h-1a1 1 0 0 1 -1 -1v-1a1 1 0 0 1 1 -1h1.25a.75 .75 0 0 1 .75 .75"},child:[]},{tag:"path",attr:{d:"M16 15l2 6l2 -6"},child:[]}]})(e)}function Bde(e){return ya({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M14 3v4a1 1 0 0 0 1 1h4"},child:[]},{tag:"path",attr:{d:"M5 12v-7a2 2 0 0 1 2 -2h7l5 5v4"},child:[]},{tag:"path",attr:{d:"M5 15v6h1a2 2 0 0 0 2 -2v-2a2 2 0 0 0 -2 -2h-1z"},child:[]},{tag:"path",attr:{d:"M20 16.5a1.5 1.5 0 0 0 -3 0v3a1.5 1.5 0 0 0 3 0"},child:[]},{tag:"path",attr:{d:"M12.5 15a1.5 1.5 0 0 1 1.5 1.5v3a1.5 1.5 0 0 1 -3 0v-3a1.5 1.5 0 0 1 1.5 -1.5z"},child:[]}]})(e)}function Ude(e){return ya({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M14 3v4a1 1 0 0 0 1 1h4"},child:[]},{tag:"path",attr:{d:"M5 12v-7a2 2 0 0 1 2 -2h7l5 5v4"},child:[]},{tag:"path",attr:{d:"M5 18h1.5a1.5 1.5 0 0 0 0 -3h-1.5v6"},child:[]},{tag:"path",attr:{d:"M17 18h2"},child:[]},{tag:"path",attr:{d:"M20 15h-3v6"},child:[]},{tag:"path",attr:{d:"M11 15v6h1a2 2 0 0 0 2 -2v-2a2 2 0 0 0 -2 -2h-1z"},child:[]}]})(e)}function $de(e){return ya({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M14 3v4a1 1 0 0 0 1 1h4"},child:[]},{tag:"path",attr:{d:"M14 3v4a1 1 0 0 0 1 1h4"},child:[]},{tag:"path",attr:{d:"M5 18h1.5a1.5 1.5 0 0 0 0 -3h-1.5v6"},child:[]},{tag:"path",attr:{d:"M11 18h1.5a1.5 1.5 0 0 0 0 -3h-1.5v6"},child:[]},{tag:"path",attr:{d:"M16.5 15h3"},child:[]},{tag:"path",attr:{d:"M18 15v6"},child:[]},{tag:"path",attr:{d:"M5 12v-7a2 2 0 0 1 2 -2h7l5 5v4"},child:[]}]})(e)}function Z3(e){return ya({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M14 3v4a1 1 0 0 0 1 1h4"},child:[]},{tag:"path",attr:{d:"M14 3v4a1 1 0 0 0 1 1h4"},child:[]},{tag:"path",attr:{d:"M16.5 15h3"},child:[]},{tag:"path",attr:{d:"M5 12v-7a2 2 0 0 1 2 -2h7l5 5v4"},child:[]},{tag:"path",attr:{d:"M4.5 15h3"},child:[]},{tag:"path",attr:{d:"M6 15v6"},child:[]},{tag:"path",attr:{d:"M18 15v6"},child:[]},{tag:"path",attr:{d:"M10 15l4 6"},child:[]},{tag:"path",attr:{d:"M10 21l4 -6"},child:[]}]})(e)}function zde(e){return ya({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M14 3v4a1 1 0 0 0 1 1h4"},child:[]},{tag:"path",attr:{d:"M5 12v-7a2 2 0 0 1 2 -2h7l5 5v4"},child:[]},{tag:"path",attr:{d:"M4 15l4 6"},child:[]},{tag:"path",attr:{d:"M4 21l4 -6"},child:[]},{tag:"path",attr:{d:"M17 20.25c0 .414 .336 .75 .75 .75h1.25a1 1 0 0 0 1 -1v-1a1 1 0 0 0 -1 -1h-1a1 1 0 0 1 -1 -1v-1a1 1 0 0 1 1 -1h1.25a.75 .75 0 0 1 .75 .75"},child:[]},{tag:"path",attr:{d:"M11 15v6h3"},child:[]}]})(e)}function Hde(e){return ya({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M6 20.735a2 2 0 0 1 -1 -1.735v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2h-1"},child:[]},{tag:"path",attr:{d:"M11 17a2 2 0 0 1 2 2v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1v-2a2 2 0 0 1 2 -2z"},child:[]},{tag:"path",attr:{d:"M11 5l-1 0"},child:[]},{tag:"path",attr:{d:"M13 7l-1 0"},child:[]},{tag:"path",attr:{d:"M11 9l-1 0"},child:[]},{tag:"path",attr:{d:"M13 11l-1 0"},child:[]},{tag:"path",attr:{d:"M11 13l-1 0"},child:[]},{tag:"path",attr:{d:"M13 15l-1 0"},child:[]}]})(e)}function qde(e){return ya({attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M854.6 288.7L639.4 73.4c-6-6-14.2-9.4-22.7-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.6-9.4-22.6zM400 402c22.1 0 40 17.9 40 40s-17.9 40-40 40-40-17.9-40-40 17.9-40 40-40zm296 294H328c-6.7 0-10.4-7.7-6.3-12.9l99.8-127.2a8 8 0 0 1 12.6 0l41.1 52.4 77.8-99.2a8 8 0 0 1 12.6 0l136.5 174c4.3 5.2.5 12.9-6.1 12.9zm-94-370V137.8L790.2 326H602z"},child:[]}]})(e)}function Q3(e){return ya({attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M518.3 459a8 8 0 0 0-12.6 0l-112 141.7a7.98 7.98 0 0 0 6.3 12.9h73.9V856c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V613.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 459z"},child:[]},{tag:"path",attr:{d:"M811.4 366.7C765.6 245.9 648.9 160 512.2 160S258.8 245.8 213 366.6C127.3 389.1 64 467.2 64 560c0 110.5 89.5 200 199.9 200H304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8h-40.1c-33.7 0-65.4-13.4-89-37.7-23.5-24.2-36-56.8-34.9-90.6.9-26.4 9.9-51.2 26.2-72.1 16.7-21.3 40.1-36.8 66.1-43.7l37.9-9.9 13.9-36.6c8.6-22.8 20.6-44.1 35.7-63.4a245.6 245.6 0 0 1 52.4-49.9c41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.2c19.9 14 37.5 30.8 52.4 49.9 15.1 19.3 27.1 40.7 35.7 63.4l13.8 36.5 37.8 10C846.1 454.5 884 503.8 884 560c0 33.1-12.9 64.3-36.3 87.7a123.07 123.07 0 0 1-87.6 36.3H720c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h40.1C870.5 760 960 670.5 960 560c0-92.7-63.1-170.7-148.6-193.3z"},child:[]}]})(e)}function Vde(e){return ya({attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0 0 42 42h216v494z"},child:[]}]})(e)}function Kde(e){return ya({attr:{viewBox:"0 0 16 16",fill:"currentColor"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M10.57 1.14l3.28 3.3.15.36v9.7l-.5.5h-11l-.5-.5v-13l.5-.5h7.72l.35.14zM10 5h3l-3-3v3zM3 2v12h10V6H9.5L9 5.5V2H3zm2.062 7.533l1.817-1.828L6.17 7 4 9.179v.707l2.171 2.174.707-.707-1.816-1.82zM8.8 7.714l.7-.709 2.189 2.175v.709L9.5 12.062l-.705-.709 1.831-1.82L8.8 7.714z"},child:[]}]})(e)}function Gde(e){return ya({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 48C141.31 48 48 141.31 48 256s93.31 208 208 208 208-93.31 208-208S370.69 48 256 48zm108.25 138.29-134.4 160a16 16 0 0 1-12 5.71h-.27a16 16 0 0 1-11.89-5.3l-57.6-64a16 16 0 1 1 23.78-21.4l45.29 50.32 122.59-145.91a16 16 0 0 1 24.5 20.58z"},child:[]}]})(e)}function J3(e){return ya({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"m289.94 256 95-95A24 24 0 0 0 351 127l-95 95-95-95a24 24 0 0 0-34 34l95 95-95 95a24 24 0 1 0 34 34l95-95 95 95a24 24 0 0 0 34-34z"},child:[]}]})(e)}function Wde(e,t){y.useEffect(()=>{function r(n){!e.current||e.current.contains(n.target)||t?.()}return document.addEventListener("mousedown",r),()=>document.removeEventListener("mousedown",r)},[t,e])}function eC({anchorRect:e,children:t,onClose:r,width:n=260}){const a=y.useRef(null);Wde(a,r);const[i,l]=y.useState({top:0,left:0});return y.useEffect(()=>{if(!e)return;const u=8,h=document.documentElement.clientWidth,d=document.documentElement.clientHeight,m=window.pageXOffset,p=window.pageYOffset;let v=m+e.left,g=p+e.bottom+6;const w=m+h-n-u,b=m+u;v=Math.min(Math.max(b,v),w),l({top:g,left:v});const S=()=>{const A=a.current;if(!A)return;const k=A.offsetHeight||320;let O=g;const C=p+d-k-u;if(O>C){const T=p+e.top-k-6;O=Math.max(p+u,Math.min(T,C))}l(T=>T.top===O&&T.left===v?T:{top:O,left:v})},j=requestAnimationFrame(S),_=()=>requestAnimationFrame(S);return window.addEventListener("resize",_),window.addEventListener("scroll",_,{passive:!0}),()=>{cancelAnimationFrame(j),window.removeEventListener("resize",_),window.removeEventListener("scroll",_)}},[e,n]),e?Ib.createPortal(c.jsx("div",{style:{position:"absolute",inset:0,zIndex:1e4,pointerEvents:"none"},children:c.jsx("div",{ref:a,style:{position:"absolute",top:i.top,left:i.left,width:n,pointerEvents:"auto"},className:"rounded-md border border-slate-200 bg-white p-1 shadow-xl",children:t})}),document.body):null}function ay(e=""){const t=(e||"").toLowerCase().match(/\.([a-z0-9]+)$/i);return t?t[1]:""}function Yde(e,t){if(!e&&t){if(t.includes("pdf"))return"pdf";if(t.includes("excel")||t.includes("spreadsheet"))return"xls";if(t.includes("word"))return"doc";if(t.includes("powerpoint"))return"ppt";if(t.startsWith("image/"))return"image";if(t.includes("json"))return"json";if(t.includes("zip")||t.includes("compressed"))return"zip";if(t.startsWith("text/"))return"txt"}switch(e){case"pdf":return"pdf";case"xls":case"xlsx":return"xls";case"csv":return"csv";case"doc":case"docx":return"doc";case"ppt":case"pptx":return"ppt";case"png":case"jpg":case"jpeg":case"gif":case"webp":case"svg":return"image";case"zip":case"rar":case"7z":return"zip";case"json":return"json";case"txt":case"log":case"md":return"txt";case"js":case"ts":case"tsx":case"py":case"java":case"go":case"rb":case"php":case"c":case"cpp":case"cs":return"code";default:return"file"}}function iy({ext:e,mime:t,size:r=22,className:n=""}){const a=Yde(e,t),i={size:r,className:`shrink-0 ${n}`};switch(a){case"pdf":return c.jsx(Ude,{...i,className:`text-red-600 ${i.className}`});case"xls":return c.jsx(zde,{...i,className:`text-emerald-600 ${i.className}`});case"csv":return c.jsx(Lde,{...i,className:`text-teal-600 ${i.className}`});case"doc":return c.jsx(Bde,{...i,className:`text-blue-600 ${i.className}`});case"ppt":return c.jsx($de,{...i,className:`text-orange-600 ${i.className}`});case"json":return c.jsx(Z3,{...i,className:`text-cyan-600 ${i.className}`});case"txt":return c.jsx(Z3,{...i,className:`text-slate-600 ${i.className}`});case"zip":return c.jsx(Hde,{...i,className:`text-amber-600 ${i.className}`});case"image":return c.jsx(qde,{...i,className:`text-fuchsia-600 ${i.className}`});case"code":return c.jsx(Kde,{...i,className:`text-indigo-600 ${i.className}`});default:return c.jsx(Vde,{...i,className:`text-slate-700 ${i.className}`})}}function Xde(){const[e,t]=y.useState([]),[r,n]=y.useState([]),[a,i]=y.useState(!1),[l,u]=y.useState(""),[h,d]=y.useState(!1),m=y.useMemo(()=>{const ve=new Map;return r.forEach(ne=>{ne.file&&ne.file.type?.startsWith?.("image/")&&ve.set(ne.id,URL.createObjectURL(ne.file))}),ve},[r]);y.useEffect(()=>()=>{m.forEach(ve=>URL.revokeObjectURL(ve))},[m]);const[p,v]=y.useState(null),[g,w]=y.useState(null),[b,S]=y.useState([]),[j,_]=y.useState([]),[A,k]=y.useState(""),O=y.useMemo(()=>{const ve=A.trim().toLowerCase();return ve?b.filter(ne=>(ne.label||"").toLowerCase().includes(ve)||(ne.email||"").toLowerCase().includes(ve)):b},[b,A]),C=O.length>0&&O.every(ve=>j.includes(ve.user_id)),[T,I]=y.useState(null),[M,W]=y.useState(null),[U,F]=y.useState(!1),[oe,je]=y.useState(null),[ue,V]=y.useState(null),[H,Se]=y.useState(null),[Q,z]=y.useState(!1),[Y,P]=y.useState(null),[q,G]=y.useState(null),Z=ve=>ve>=1e6?(ve/1e6).toFixed(2)+" MB":ve>=1e3?(ve/1e3).toFixed(1)+" KB":(ve||0)+" B";y.useEffect(()=>{fe()},[]),y.useEffect(()=>{function ve(ne){const xe=Array.from(ne.clipboardData?.files||[])[0];xe&&Ae([xe])}return window.addEventListener("paste",ve),()=>window.removeEventListener("paste",ve)},[]);async function fe(){try{const{data:ve}=await We.get("/api/documents");ve?.ok&&t(ve.documents||[])}catch{t([]),u("Not authorized. Please sign in again.")}}const Oe=".pdf,.csv,.xls,.xlsx,.doc,.docx,.ppt,.pptx,.png,.jpg,.jpeg,.gif,.webp,.svg,.zip,.rar,.7z,.json,.txt,.md",Re=50*1024*1024,re=()=>`${Date.now()}_${Math.random().toString(36).slice(2,8)}`,be=ve=>ve?.name?ve.name.replace(/\.[^.]+$/,""):"Untitled";function Ae(ve){const ne=Array.from(ve||[]);if(!ne.length)return;const xe=[],Be=[];ne.forEach(Ze=>{Ze.size>Re?Be.push(`${Ze.name} is too large (max 50MB).`):xe.push({id:re(),file:Ze,title:be(Ze),progress:0,status:"idle"})}),n(Ze=>[...Ze,...xe]),Be.length&&u(Be.join(" "))}function D(ve){Ae(ve.target.files),ve.target.value=""}function Me(ve){ve.preventDefault(),i(!1),Ae(ve.dataTransfer?.files)}function ae(ve){ve.preventDefault(),i(!0)}function de(ve){ve.preventDefault(),i(!1)}function me(ve){n(ne=>ne.filter(xe=>xe.id!==ve))}function ce(){n([]),u("")}async function ze(ve){if(ve.preventDefault(),!r.length){u("Pick files first.");return}d(!0),u("");for(let ne=0;ne<r.length;ne++){const xe=r[ne].id;await Qe(xe)}d(!1),n(ne=>ne.filter(xe=>xe.status!=="done")),fe()}async function Qe(ve){n(Be=>Be.map(Ze=>Ze.id===ve?{...Ze,status:"uploading",progress:8}:Ze));const ne=setInterval(()=>{n(Be=>Be.map(Ze=>Ze.id!==ve||Ze.status!=="uploading"?Ze:{...Ze,progress:Math.min(94,Ze.progress+Math.random()*8)}))},120),xe=r.find(Be=>Be.id===ve);try{const{data:Be}=await Z7("/api/documents/upload",xe.file,xe.title?{title:xe.title}:{});if(clearInterval(ne),!Be?.ok){const Ze=Be?.error||"Upload failed";n(tt=>tt.map(At=>At.id===ve?{...At,status:"error",progress:0,error:Ze}:At)),u(Ze);return}n(Ze=>Ze.map(tt=>tt.id===ve?{...tt,status:"done",progress:100}:tt))}catch(Be){clearInterval(ne);const Ze=Be?.response?.data?.error||Be?.message||"Upload failed";n(tt=>tt.map(At=>At.id===ve?{...At,status:"error",progress:0,error:Ze}:At)),u(Ze)}}async function Ke(ve,ne){v(ve),w(ne),_([]),k("");try{const{data:xe}=await We.get("/api/documents/share-options",{params:{role:ne}});if(!xe?.ok)throw new Error(xe?.error||"Failed to load options");S(xe.options||[])}catch(xe){S([]),alert(xe?.message||"Failed to load options")}}function qe(ve){_(ne=>ne.includes(ve)?ne.filter(xe=>xe!==ve):[...ne,ve])}function it(){if(C)_(ve=>ve.filter(ne=>!O.some(xe=>xe.user_id===ne)));else{const ve=O.map(ne=>ne.user_id);_(ne=>Array.from(new Set([...ne,...ve])))}}async function Je(){if(!(!p||!j.length))try{const{data:ve}=await We.post("/api/documents/share",{document_id:p.id,investor_ids:j});if(!ve?.ok)throw new Error(ve?.error||"Share failed");v(null),w(null),S([]),_([]),k(""),fe()}catch(ve){alert(ve?.message||"Share failed")}}async function Fe(ve,ne){try{const{data:xe}=await We.delete("/api/documents/share",{data:{document_id:ve,investor_id:ne}});if(!xe?.ok)throw new Error(xe?.error||"Revoke failed");fe()}catch(xe){alert(xe?.message||"Revoke failed")}}async function Ye(ve){F(!0),je(ve),V(null),Se(null),z(!0);try{const ne=await We.get(`/api/documents/view/${ve.id}`,{responseType:"blob"});if((ne.headers["content-type"]||ve.mime_type||"application/octet-stream").startsWith("text/")||["csv","json","txt","md"].includes(ay(ve.original_name))){const Be=await ne.data.text();Se(Be)}else{const Be=URL.createObjectURL(ne.data);V(Be)}}catch{Se(null),V(null),alert("Could not open preview. Try Download.")}finally{z(!1)}}function ge(){F(!1),ue&&URL.revokeObjectURL(ue),V(null),Se(null),je(null)}async function Ge(ve){if(window.confirm(`Delete ${ve.title||ve.original_name}? This cannot be undone.`))try{const{data:ne}=await We.delete(`/api/documents/${ve.id}`);if(!ne?.ok)throw new Error(ne?.error||"Delete failed");fe()}catch(ne){alert(ne?.message||"Delete failed")}}return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-white border rounded-xl shadow-sm",children:[c.jsxs("div",{className:"px-4 py-3 border-b flex items-center justify-between",children:[c.jsx("h3",{className:"text-base font-semibold text-gray-800",children:"Upload"}),c.jsxs("div",{className:"text-sm text-gray-600",children:["Tip: You can also ",c.jsx("span",{className:"font-medium",children:"paste"})," a file (Ctrl/Cmd+V) directly into this page."]})]}),c.jsxs("form",{className:"p-4",onSubmit:ze,children:[c.jsx("label",{className:"block text-sm font-medium mb-2",children:"Your files"}),c.jsx("div",{onDrop:Me,onDragOver:ae,onDragLeave:de,className:["relative rounded-2xl border-2 border-dashed px-5 py-6 transition-all w-full",a?"border-emerald-500 bg-emerald-50":"border-slate-200 hover:border-slate-300"].join(" "),children:r.length===0?c.jsxs("div",{className:"flex flex-col items-center text-center gap-3",children:[c.jsx("div",{className:"w-14 h-14 rounded-full bg-slate-50 flex items-center justify-center",children:c.jsx(Q3,{className:"text-slate-500",size:28})}),c.jsxs("div",{className:"text-sm text-slate-600",children:[c.jsx("span",{className:"font-medium text-slate-800",children:"Drag & drop"})," files here, or"," ",c.jsxs("label",{className:"text-emerald-700 cursor-pointer hover:underline",children:["browse",c.jsx("input",{type:"file",accept:Oe,multiple:!0,onChange:D,className:"sr-only"})]})]}),c.jsx("div",{className:"text-xs text-slate-500",children:"Accepted: PDF, XLS/XLSX, CSV, DOC/DOCX, PPT/PPTX, Images, ZIP, JSON, TXT (max 50MB each)"})]}):c.jsx("div",{className:"space-y-3",children:r.map(ve=>{const ne=ay(ve.file?.name),xe=m.get(ve.id);return c.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg ring-1 ring-slate-200",children:[xe?c.jsx("img",{src:xe,alt:"preview",className:"w-12 h-12 rounded-md object-cover"}):c.jsx("div",{className:"w-12 h-12 rounded-md bg-slate-50 flex items-center justify-center",children:c.jsx(iy,{ext:ne,mime:ve.file?.type,size:22})}),c.jsxs("div",{className:"min-w-0 flex-1",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"text-sm font-medium text-slate-800 truncate",title:ve.file?.name,children:ve.file?.name}),c.jsx("div",{className:"text-xs text-slate-500 shrink-0",children:Z(ve.file?.size)})]}),c.jsx("div",{className:"mt-1",children:c.jsx("input",{className:"w-full border rounded-md px-2 py-1 text-sm",value:ve.title,onChange:Be=>n(Ze=>Ze.map(tt=>tt.id===ve.id?{...tt,title:Be.target.value}:tt)),placeholder:"Title (optional)"})}),(ve.status==="uploading"||ve.status==="done")&&c.jsx("div",{className:"mt-2 h-2 w-full rounded-full bg-slate-100 overflow-hidden",children:c.jsx("div",{className:"h-full bg-emerald-600 transition-all",style:{width:`${ve.progress}%`}})}),ve.status==="error"&&c.jsx("div",{className:"mt-1 text-xs text-red-600",children:ve.error||"Upload failed"})]}),c.jsx("button",{type:"button",className:"p-2 rounded-md hover:bg-slate-100 text-slate-500",onClick:()=>me(ve.id),title:"Remove",disabled:ve.status==="uploading",children:c.jsx(J3,{size:18})})]},ve.id)})})}),c.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-3 justify-end",children:[c.jsxs("label",{children:[c.jsx("input",{type:"file",accept:Oe,multiple:!0,onChange:D,className:"sr-only"}),c.jsx("span",{className:"inline-flex items-center px-3 py-2 rounded-lg border hover:bg-slate-50 cursor-pointer",children:"Choose files"})]}),c.jsx("button",{type:"button",className:"inline-flex items-center px-3 py-2 rounded-lg border",onClick:ce,disabled:!r.length||h,children:"Clear"}),c.jsxs("button",{type:"submit",disabled:!r.length||h,className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-gray-900 text-white hover:bg-black disabled:opacity-50",children:[c.jsx(Q3,{size:18}),h?"Uploading":`Upload ${r.length} file${r.length>1?"s":""}`]})]}),l&&c.jsxs("div",{className:"mt-3 flex items-center gap-2 text-sm",children:[c.jsx(Gde,{className:"text-emerald-600"}),c.jsx("span",{children:l})]})]})]}),c.jsxs("div",{className:"bg-white border rounded-xl shadow-sm",children:[c.jsx("div",{className:"px-4 py-3 border-b",children:c.jsx("h3",{className:"text-base font-semibold text-gray-800",children:"Documents"})}),c.jsx("div",{className:"p-4 overflow-auto",children:e.length?c.jsxs("table",{className:"min-w-full text-sm",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"text-left px-2 py-2",children:"Title"}),c.jsx("th",{className:"text-left px-2 py-2",children:"Original"}),c.jsx("th",{className:"text-left px-2 py-2",children:"Size"}),c.jsx("th",{className:"text-left px-2 py-2",children:"Uploaded"}),c.jsx("th",{className:"text-left px-2 py-2",children:"Shared With"}),c.jsx("th",{className:"text-right px-2 py-2",children:"Actions"})]})}),c.jsx("tbody",{children:e.map(ve=>{const ne=ay(ve.original_name),xe=(ve.shares||[]).map(Ze=>Ze.label||`User ${Ze.investor_user_id}`),Be=xe.length===0?"":xe.length<=2?xe.join(", "):`${xe.slice(0,2).join(", ")} +${xe.length-2}`;return c.jsxs("tr",{className:"border-t",children:[c.jsx("td",{className:"px-2 py-2",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(iy,{ext:ne,mime:ve.mime_type}),c.jsx("button",{type:"button",className:"text-left truncate max-w-[26ch] hover:underline",title:"View",onClick:()=>Ye(ve),children:ve.title})]})}),c.jsx("td",{className:"px-2 py-2",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(iy,{ext:ne,mime:ve.mime_type}),c.jsx("span",{className:"truncate max-w-[32ch]",title:ve.original_name,children:ve.original_name})]})}),c.jsx("td",{className:"px-2 py-2",children:Z(ve.size_bytes)}),c.jsx("td",{className:"px-2 py-2",children:new Date(ve.uploaded_at).toLocaleString()}),c.jsx("td",{className:"px-2 py-2",children:xe.length?c.jsx(c.Fragment,{children:c.jsxs("button",{className:"inline-flex items-center gap-1 px-2 py-1 rounded border hover:bg-slate-50",onClick:Ze=>{I(ve),W(Ze.currentTarget.getBoundingClientRect())},title:xe.join(", "),children:[c.jsx("span",{className:"truncate max-w-[26ch]",children:Be}),c.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",className:"opacity-60",children:c.jsx("path",{d:"M7 10l5 5 5-5z"})})]})}):c.jsx("span",{className:"text-gray-500",children:""})}),c.jsx("td",{className:"px-2 py-2 text-right",children:c.jsxs("div",{className:"inline-flex items-center gap-3",children:[c.jsx("button",{className:"text-blue-600 hover:underline",onClick:()=>Ye(ve),children:"View"}),c.jsx("a",{className:"text-blue-600 hover:underline",href:`/api/documents/download/${ve.id}`,target:"_blank",rel:"noopener noreferrer",children:"Download"}),c.jsx("button",{className:"text-red-600 hover:underline",onClick:()=>Ge(ve),title:"Delete",children:"Delete"}),c.jsx("button",{className:"inline-flex items-center justify-center rounded-md p-2 hover:bg-gray-100",title:"More",onClick:Ze=>{P(ve),G(Ze.currentTarget.getBoundingClientRect())},children:c.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:[c.jsx("circle",{cx:"12",cy:"5",r:"1.5"}),c.jsx("circle",{cx:"12",cy:"12",r:"1.5"}),c.jsx("circle",{cx:"12",cy:"19",r:"1.5"})]})})]})})]},ve.id)})})]}):c.jsx("div",{className:"text-gray-500 text-sm",children:"No documents yet."})})]}),Y&&q&&c.jsxs(eC,{anchorRect:q,onClose:()=>{P(null),G(null)},children:[c.jsx("div",{className:"px-3 py-2 text-sm text-slate-600",children:"Share"}),c.jsx("div",{className:"my-1 border-t"}),c.jsx("button",{className:"w-full text-left px-3 py-2 text-sm hover:bg-slate-50",onClick:()=>{Ke(Y,"admin"),P(null),G(null)},children:" Share with Admin"}),c.jsx("button",{className:"w-full text-left px-3 py-2 text-sm hover:bg-slate-50",onClick:()=>{Ke(Y,"group_admin"),P(null),G(null)},children:" Share with Group Admin"}),c.jsx("button",{className:"w-full text-left px-3 py-2 text-sm hover:bg-slate-50",onClick:()=>{Ke(Y,"investor"),P(null),G(null)},children:" Share with Investor"})]}),T&&M&&c.jsxs(eC,{anchorRect:M,onClose:()=>{I(null),W(null)},width:280,children:[c.jsx("div",{className:"px-3 py-2 text-sm text-slate-600",children:"Shared With"}),c.jsx("div",{className:"my-1 border-t"}),c.jsx("div",{className:"max-h-[260px] overflow-auto",children:(T.shares||[]).map(ve=>c.jsxs("div",{className:"flex items-center justify-between px-3 py-2",children:[c.jsxs("div",{className:"truncate pr-2",children:[c.jsx("div",{className:"text-sm font-medium truncate",children:ve.label||`User ${ve.investor_user_id}`}),ve.email?c.jsx("div",{className:"text-xs text-gray-500 truncate",children:ve.email}):null]}),c.jsx("button",{className:"text-red-600 hover:underline text-sm",onClick:()=>{Fe(T.id,ve.investor_user_id),I(null),W(null)},title:"Revoke access",children:"Revoke"})]},ve.investor_user_id))})]}),p&&c.jsx("div",{className:"fixed inset-0 z-30 flex items-center justify-center bg-black/30",onMouseDown:()=>{v(null),w(null)},children:c.jsxs("div",{className:"w-[560px] max-h-[75vh] overflow-auto rounded-2xl bg-white p-4 shadow-2xl",onMouseDown:ve=>ve.stopPropagation(),children:[c.jsxs("div",{className:"mb-3",children:[c.jsxs("div",{className:"text-lg font-semibold",children:["Share ",p.title||p.original_name,""]}),c.jsxs("div",{className:"text-sm text-gray-500",children:["Role: ",c.jsx("span",{className:"font-medium",children:g})]})]}),c.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[c.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-gray-50 border-b",children:[c.jsxs("label",{className:"inline-flex items-center gap-2 text-sm",children:[c.jsx("input",{type:"checkbox",checked:C,onChange:it}),c.jsx("span",{children:"Select all"})]}),c.jsxs("div",{className:"text-xs text-gray-500",children:[j.length," selected  ",O.length," shown"]})]}),c.jsxs("div",{className:"px-3 py-2 border-b flex items-center gap-2",children:[c.jsx("input",{value:A,onChange:ve=>k(ve.target.value),placeholder:"Search by name or email",className:"w-full rounded-md border px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-emerald-500"}),A&&c.jsx("button",{type:"button",className:"text-xs text-gray-500 hover:underline",onClick:()=>k(""),title:"Clear",children:"Clear"})]}),c.jsx("div",{className:"max-h-[320px] overflow-auto divide-y",children:O.length?O.map(ve=>c.jsxs("label",{className:"flex items-center gap-3 px-3 py-2",children:[c.jsx("input",{type:"checkbox",checked:j.includes(ve.user_id),onChange:()=>qe(ve.user_id)}),c.jsxs("div",{className:"flex-1",children:[c.jsx("div",{className:"text-sm font-medium",children:ve.label}),ve.email&&c.jsx("div",{className:"text-xs text-gray-500",children:ve.email})]})]},ve.user_id)):c.jsxs("div",{className:"px-3 py-8 text-center text-sm text-gray-500",children:["No matches for ",A,"."]})})]}),c.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[c.jsx("button",{className:"px-3 py-2 rounded-lg border border-gray-300",onClick:()=>{v(null),w(null),S([]),_([]),k("")},children:"Cancel"}),c.jsx("button",{className:"px-3 py-2 rounded-lg bg-gray-900 text-white disabled:opacity-50",disabled:!j.length,onClick:Je,children:"Share"})]})]})}),U&&c.jsx("div",{className:"fixed inset-0 z-40 bg-black/60 flex items-center justify-center",onMouseDown:ge,children:c.jsxs("div",{className:"bg-white w-[92vw] max-w-5xl max-h-[85vh] rounded-2xl shadow-2xl overflow-hidden",onMouseDown:ve=>ve.stopPropagation(),children:[c.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",children:[c.jsx("div",{className:"font-semibold text-gray-800 truncate",children:oe?.title||oe?.original_name}),c.jsxs("div",{className:"flex items-center gap-3",children:[oe&&c.jsx("a",{className:"text-blue-600 hover:underline",href:`/api/documents/download/${oe.id}`,target:"_blank",rel:"noreferrer",children:"Download"}),c.jsx("button",{className:"p-2 rounded hover:bg-slate-100",onClick:ge,"aria-label":"Close",children:c.jsx(J3,{size:18})})]})]}),c.jsxs("div",{className:"p-0 bg-slate-50 h-[75vh] overflow-hidden",children:[Q&&c.jsx("div",{className:"h-full grid place-items-center text-sm text-slate-600",children:"Loading preview"}),!Q&&ue&&(oe?.mime_type||"").includes("pdf")&&c.jsx("iframe",{title:"PDF",src:ue,className:"w-full h-full"}),!Q&&ue&&oe&&oe.mime_type&&oe.mime_type.startsWith("image/")&&c.jsx("img",{src:ue,alt:"preview",className:"max-h-full max-w-full object-contain mx-auto"}),!Q&&H&&c.jsx("pre",{className:"h-full overflow-auto p-4 whitespace-pre-wrap text-[13px] leading-5",children:H}),!Q&&!ue&&!H&&c.jsx("div",{className:"h-full grid place-items-center text-sm text-slate-600",children:"No preview available. Use Download instead."})]})]})})]})}function Zde(){const[e,t]=y.useState(!1),[r,n]=y.useState(!1),[a,i]=y.useState([]),l=y.useRef(null),u=()=>{const b=localStorage.getItem("accessToken");return b?{Authorization:`Bearer ${b}`}:{}},h=b=>b==null?"":b<1024?`${b} B`:b<1024*1024?`${(b/1024).toFixed(1)} KB`:`${(b/(1024*1024)).toFixed(1)} MB`,d=b=>{if(!b)return"";try{return new Date(b*1e3).toLocaleString()}catch{return""}},m=async()=>{try{const b=await fetch("/api/kb/list",{credentials:"include",headers:{...u()}}),S=await b.json();b.ok?i(S.items||[]):console.error(S)}catch(b){console.error(b)}};y.useEffect(()=>{m()},[]);const p=async b=>{if(b?.length){t(!0);try{for(const S of b)try{const j=new FormData;j.append("file",S);const _=await fetch("/api/kb/upload",{method:"POST",body:j,credentials:"include",headers:{...u()}}),A=await _.json();_.ok||console.error(A)}catch(j){console.error(j)}await m()}finally{t(!1)}}},v=b=>p(Array.from(b.target.files||[])),g=y.useCallback(b=>{b.preventDefault(),b.stopPropagation(),n(!1);const S=Array.from(b.dataTransfer?.files||[]);p(S)},[]),w=async b=>{if(window.confirm("Delete this file from your knowledge base?"))try{const S=await fetch(`/api/kb/${b}`,{method:"DELETE",credentials:"include",headers:{...u()}}),j=await S.json();S.ok?i(j.items||[]):alert(j.error||"Delete failed")}catch(S){alert(String(S))}};return c.jsxs("div",{className:"space-y-5",children:[c.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm p-5",children:[c.jsxs("div",{className:"flex items-start justify-between gap-4",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Knowledge Base"}),c.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Upload any file. We ",c.jsx("span",{className:"font-medium",children:"only"})," keep the embeddings (never the file). Your chatbot answers strictly from ",c.jsx("span",{className:"font-medium",children:"your"})," indexed content."]}),c.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-3 text-xs",children:[c.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 rounded-full bg-blue-50 text-blue-700",children:[c.jsx(wB,{size:14})," txt  md  csv  xlsx  pdf  docx  pptx  "]}),c.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 rounded-full bg-emerald-50 text-emerald-700",children:[c.jsx(PB,{size:14})," Per-user isolated index"]})]})]}),c.jsxs("button",{onClick:()=>l.current?.click(),className:"inline-flex items-center gap-2 text-sm px-3 py-2 rounded-md border hover:bg-gray-50 text-gray-700",title:"Upload files",children:[c.jsx(AA,{size:16})," Upload"]})]}),c.jsx("div",{onDragOver:b=>{b.preventDefault(),n(!0)},onDragLeave:()=>n(!1),onDrop:g,className:`mt-5 rounded-xl border-2 border-dashed ${r?"border-blue-400 bg-blue-50/40":"border-gray-300 bg-gray-50"}`,children:c.jsxs("div",{className:"flex flex-col items-center justify-center p-10 text-center",children:[c.jsx("div",{className:`rounded-full p-3 ${r?"bg-blue-100":"bg-white border"}`,children:e?c.jsx(JC,{className:"animate-spin text-blue-600",size:22}):c.jsx(AA,{size:22,className:"text-blue-600"})}),c.jsxs("p",{className:"mt-3 text-sm text-gray-800",children:["Drag & drop files here, or"," ",c.jsx("button",{type:"button",onClick:()=>l.current?.click(),className:"text-blue-700 font-medium hover:underline",children:"browse"})]}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Multiple files supported. Max recommended 50 MB per file."}),c.jsx("input",{ref:l,type:"file",multiple:!0,className:"hidden",onChange:v})]})})]}),c.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm overflow-hidden",children:[c.jsxs("div",{className:"px-5 py-3 border-b flex items-center justify-between",children:[c.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Activity"}),c.jsx("button",{onClick:m,className:"text-xs px-2 py-1 rounded-md border hover:bg-gray-50 text-gray-700",children:"Refresh"})]}),a.length===0?c.jsx("div",{className:"p-6 text-sm text-gray-500",children:"No uploads yet. Drop a few files above to start indexing."}):c.jsx("ul",{className:"divide-y",children:a.map(b=>c.jsxs("li",{className:"px-5 py-3 flex items-start gap-3",children:[c.jsx("div",{className:"mt-0.5",children:c.jsx(hB,{className:"text-emerald-600",size:18})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[c.jsx(yB,{size:16,className:"text-gray-500"}),c.jsx("span",{className:"text-sm font-medium text-gray-900 truncate",children:b.name}),c.jsxs("span",{className:"text-xs text-gray-500",children:[" ",h(b.size)]}),c.jsxs("span",{className:"text-xs text-gray-400",children:[" ",d(b.created)]})]}),c.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["ID: ",c.jsx("span",{className:"font-mono",children:b.id})]})]}),c.jsxs("button",{onClick:()=>w(b.id),className:"ml-auto inline-flex items-center gap-1 text-xs px-2 py-1 rounded-md border text-rose-700 hover:bg-rose-50",title:"Delete from knowledge base",children:[c.jsx(eO,{size:14})," Delete"]})]},b.id))})]}),c.jsx("p",{className:"text-[11px] text-gray-500",children:"Tip: After uploading, open the chat and ask naturally. The bot retrieves from your user-scoped FAISS index."})]})}function Qde(e){return document.cookie.split("; ").find(t=>t.startsWith(e+"="))?.split("=")[1]||""}async function nl(e,t={}){const r=new Headers(t.headers||{});if(t.method&&t.method!=="GET"||t.forceXsrf){const n=Qde("XSRF-TOKEN");n&&r.set("X-XSRF-TOKEN",n)}return fetch(e,{...t,headers:r,credentials:"include"})}function Jde(){const[e,t]=y.useState([]),[r,n]=y.useState(""),[a,i]=y.useState(!1),[l,u]=y.useState(null),[h,d]=y.useState({}),[m,p]=y.useState(null),[v,g]=y.useState(!1),[w,b]=y.useState(null),[S,j]=y.useState([]),[_,A]=y.useState([]),[k,O]=y.useState(!1),[C,T]=y.useState(!1),[I,M]=y.useState(!1),[W,U]=y.useState([]),[F,oe]=y.useState(""),[je,ue]=y.useState(!1),[V,H]=y.useState(!1);y.useEffect(()=>{Se()},[]);const Se=async()=>{i(!0),n("");try{const D=await nl("/api/admin/users?per_page=500",{method:"GET"}),Me=await D.json().catch(()=>({}));if(!D.ok||Me.ok===!1)throw new Error(Me.error||`Failed to load users (${D.status})`);const de=(Array.isArray(Me.data)?Me.data:[]).filter(me=>(me.role||"").toLowerCase().includes("group"));t(de)}catch(D){console.error(D),n(D.message||"Failed to load Group Investor Admins")}finally{i(!1)}},Q=async D=>{p(D),n("");try{const Me=await nl(`/api/admin/group-admins/${D}/investors`,{method:"GET"}),ae=await Me.json().catch(()=>({}));if(!Me.ok||ae.ok===!1)throw new Error(ae.message||`Failed to load members (${Me.status})`);d(de=>({...de,[D]:ae.members||[]}))}catch(Me){console.error(Me),n(Me.message||"Failed to load group members")}finally{p(null)}},z=async D=>{b(D),g(!0),A([]),await P(D.id)},Y=()=>{g(!1),b(null),j([]),A([])},P=async D=>{O(!0),n("");try{const Me=await nl(`/api/admin/group-admins/${D}/available-investors`,{method:"GET"}),ae=await Me.json().catch(()=>({}));if(!Me.ok||ae.ok===!1)throw new Error(ae.message||`Failed to load available investors (${Me.status})`);j(ae.investors||[])}catch(Me){console.error(Me),n(Me.message||"Failed to load available investors")}finally{O(!1)}},q=D=>{A(Me=>Me.includes(D)?Me.filter(ae=>ae!==D):[...Me,D])},G=async D=>{if(D.preventDefault(),!(!w||_.length===0)){T(!0),n("");try{const Me=await nl(`/api/admin/group-admins/${w.id}/investors`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({investor_ids:_})}),ae=await Me.json().catch(()=>({}));if(!Me.ok||ae.ok===!1)throw new Error(ae.message||`Failed to add investors to group (status ${Me.status})`);await Q(w.id),Y()}catch(Me){console.error(Me),n(Me.message||"Failed to add investors to group")}finally{T(!1)}}},Z=async(D,Me)=>{if(window.confirm("Remove this investor from the group?"))try{const ae=await nl(`/api/admin/group-admins/${D}/investors/${Me}`,{method:"DELETE"}),de=await ae.json().catch(()=>({}));if(!ae.ok||de.ok===!1)throw new Error(de.message||`Failed to remove investor from group (status ${ae.status})`);await Q(D)}catch(ae){console.error(ae),n(ae.message||"Failed to remove investor from group")}},fe=async D=>{if(window.confirm("Delete this Group Investor Admin?"))try{const Me=await nl(`/api/admin/group-investor-admin/${D}`,{method:"DELETE"}),ae=await Me.json().catch(()=>({}));if(!Me.ok||ae.ok===!1)throw new Error(ae.message||`Failed to delete Group Investor Admin (status ${Me.status})`);t(de=>de.filter(me=>me.id!==D)),d(de=>{const me={...de};return delete me[D],me})}catch(Me){console.error(Me),n(Me.message||"Failed to delete Group Investor Admin")}},Oe=async()=>{M(!0),oe(""),await re()},Re=()=>{M(!1),U([]),oe("")},re=async()=>{ue(!0),n("");try{const D=await nl("/api/admin/investors",{method:"GET"}),Me=await D.json().catch(()=>({}));if(!D.ok||Me.ok===!1)throw new Error(Me.message||`Failed to load investors (${D.status})`);U(Me.investors||[])}catch(D){console.error(D),n(D.message||"Failed to load investors for admin selection")}finally{ue(!1)}},be=async D=>{if(D.preventDefault(),!!F){H(!0),n("");try{const Me=await nl("/api/admin/group-investor-admin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({investor_id:F})}),ae=await Me.json().catch(()=>({}));if(!Me.ok||ae.ok===!1)throw new Error(ae.message||`Failed to create Group Investor Admin (status ${Me.status})`);await Se(),Re()}catch(Me){console.error(Me),n(Me.message||"Failed to create Group Investor Admin")}finally{H(!1)}}},Ae=D=>{u(Me=>Me===D?null:D),h[D]||Q(D)};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Group Investor Admin"}),c.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Manage investor groups, assign admins, and control group-level access."})]}),r&&c.jsx("div",{className:"rounded-md bg-red-50 border border-red-200 px-4 py-3 text-sm text-red-700",children:r}),c.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-4 space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Group Investor Admins"}),c.jsxs("button",{type:"button",onClick:Oe,className:"inline-flex items-center gap-2 rounded-md bg-blue-600 px-3 py-1.5 text-xs font-medium text-white shadow-sm hover:bg-blue-700",children:[c.jsx(OB,{size:14}),"Add Group Investor Admin"]})]}),a?c.jsx("p",{className:"text-sm text-gray-500",children:"Loading group admins..."}):e.length===0?c.jsxs("p",{className:"text-sm text-gray-500",children:["No Group Investor Admins yet. Click"," ",c.jsx("span",{className:"font-semibold",children:"Add Group Investor Admin"})," ","to create one."]}):c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full text-sm",children:[c.jsx("thead",{children:c.jsxs("tr",{className:"border-b bg-gray-50 text-xs font-semibold uppercase text-gray-500",children:[c.jsx("th",{className:"px-3 py-2 text-left",children:"Name"}),c.jsx("th",{className:"px-3 py-2 text-left",children:"Email"}),c.jsx("th",{className:"px-3 py-2 text-left",children:"Created"}),c.jsx("th",{className:"px-3 py-2 text-right",children:"Actions"})]})}),c.jsx("tbody",{children:e.map(D=>{const Me=h[D.id]||[],ae=l===D.id;return c.jsxs(pn.Fragment,{children:[c.jsxs("tr",{className:"border-b",children:[c.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:c.jsx("button",{type:"button",onClick:()=>Ae(D.id),className:"text-blue-600 hover:underline",children:D.name||""})}),c.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:D.email||""}),c.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-gray-500",children:""}),c.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:c.jsxs("div",{className:"flex items-center justify-end gap-2",children:[c.jsxs("button",{type:"button",onClick:()=>z(D),className:"inline-flex items-center gap-1 rounded-md border border-gray-300 px-2 py-1 text-xs text-gray-700 hover:bg-gray-100",children:[c.jsx(tO,{size:14}),"Add Investor"]}),c.jsxs("button",{type:"button",onClick:()=>alert("TODO: edit logic for Group Investor Admin"),className:"inline-flex items-center gap-1 rounded-md border border-gray-300 px-2 py-1 text-xs text-gray-700 hover:bg-gray-100",children:[c.jsx(kB,{size:14}),"Edit"]}),c.jsxs("button",{type:"button",onClick:()=>fe(D.id),className:"inline-flex items-center gap-1 rounded-md border border-red-200 px-2 py-1 text-xs text-red-600 hover:bg-red-50",children:[c.jsx(eO,{size:14}),"Delete"]})]})})]}),ae&&c.jsx("tr",{className:"border-b bg-gray-50",children:c.jsxs("td",{className:"px-3 py-3 text-sm text-gray-700",colSpan:4,children:[c.jsx("div",{className:"font-semibold mb-2",children:"Investors in this group"}),m===D.id?c.jsx("div",{className:"text-gray-500",children:"Loading investors..."}):Me.length===0?c.jsxs("div",{className:"text-gray-500",children:["No investors in this group yet. Use"," ",c.jsx("span",{className:"font-semibold",children:"Add Investor"})," ","to add one or more."]}):c.jsx("ul",{className:"space-y-1",children:Me.map(de=>c.jsxs("li",{className:"flex items-center justify-between",children:[c.jsxs("span",{children:[de.name||""," ",c.jsxs("span",{className:"text-gray-500",children:["(",de.email||"",")"]})]}),c.jsx("button",{type:"button",onClick:()=>Z(D.id,de.investor_id),className:"text-xs text-red-600 hover:text-red-800",children:"Remove"})]},de.investor_id))})]})})]},D.id)})})]})})]}),v&&w&&c.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/30",children:c.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-xl",children:[c.jsxs("div",{className:"flex items-center justify-between border-b px-4 py-3",children:[c.jsxs("h3",{className:"text-sm font-semibold",children:["Add Investors to Group "," ",c.jsx("span",{className:"font-bold",children:w.name||w.email})]}),c.jsx("button",{type:"button",onClick:Y,className:"text-gray-400 hover:text-gray-600",children:c.jsx(wc,{size:18})})]}),c.jsxs("form",{onSubmit:G,children:[c.jsxs("div",{className:"max-h-80 overflow-y-auto px-4 py-3 space-y-2",children:[c.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Select one or more investors to add under this Group Investor Admin. Investors who are already in this group are not shown."}),k?c.jsx("div",{className:"text-sm text-gray-500",children:"Loading investors..."}):S.length===0?c.jsx("div",{className:"text-sm text-gray-500",children:"No available investors to add."}):S.map(D=>c.jsxs("label",{className:"flex items-center gap-2 rounded-md border border-gray-200 px-3 py-2 text-sm hover:bg-gray-50",children:[c.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:_.includes(D.id),onChange:()=>q(D.id)}),c.jsxs("span",{children:[D.name||""," ",c.jsxs("span",{className:"text-gray-500",children:["(",D.email||"",")"]})]})]},D.id))]}),c.jsxs("div",{className:"flex items-center justify-end gap-2 border-t px-4 py-3",children:[c.jsx("button",{type:"button",onClick:Y,className:"inline-flex items-center rounded-md border border-gray-300 px-3 py-1.5 text-xs font-medium text-gray-700 hover:bg-gray-100",children:"Cancel"}),c.jsx("button",{type:"submit",disabled:C||_.length===0,className:"inline-flex items-center rounded-md bg-blue-600 px-4 py-1.5 text-xs font-medium text-white shadow-sm hover:bg-blue-700 disabled:opacity-50",children:C?"Saving...":"Add Selected"})]})]})]})}),I&&c.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/30",children:c.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-md",children:[c.jsxs("div",{className:"flex items-center justify-between border-b px-4 py-3",children:[c.jsx("h3",{className:"text-sm font-semibold",children:"Add Group Investor Admin"}),c.jsx("button",{type:"button",onClick:Re,className:"text-gray-400 hover:text-gray-600",children:c.jsx(wc,{size:18})})]}),c.jsxs("form",{onSubmit:be,children:[c.jsxs("div",{className:"px-4 py-3 space-y-3",children:[c.jsx("p",{className:"text-xs text-gray-500",children:"Select an investor user to promote to Group Investor Admin."}),je?c.jsx("div",{className:"text-sm text-gray-500",children:"Loading investors..."}):W.length===0?c.jsx("div",{className:"text-sm text-gray-500",children:"No eligible investors found."}):c.jsxs("select",{className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-1 focus:ring-blue-500",value:F,onChange:D=>oe(D.target.value),children:[c.jsx("option",{value:"",children:"Select an investor"}),W.map(D=>c.jsxs("option",{value:D.id,children:[D.name," (",D.email,")"]},D.id))]})]}),c.jsxs("div",{className:"flex items-center justify-end gap-2 border-t px-4 py-3",children:[c.jsx("button",{type:"button",onClick:Re,className:"inline-flex items-center rounded-md border border-gray-300 px-3 py-1.5 text-xs font-medium text-gray-700 hover:bg-gray-100",children:"Cancel"}),c.jsx("button",{type:"submit",disabled:V||!F||W.length===0,className:"inline-flex items-center rounded-md bg-blue-600 px-4 py-1.5 text-xs font-medium text-white shadow-sm hover:bg-blue-700 disabled:opacity-50",children:V?"Saving...":"Save as Group Admin"})]})]})]})})]})}const e0e=()=>{const[e,t]=y.useState("overview"),{user:r,logout:n}=y.useContext(mi);if(r===void 0)return c.jsx("div",{className:"p-6",children:"Loading"});const a={fullName:r?.name||[r?.first_name,r?.last_name].filter(Boolean).join(" ")||"Admin",email:r?.email||"",userType:(r?.user_type||"").toLowerCase()},i=({title:ne,children:xe})=>c.jsx("div",{className:"space-y-4",children:c.jsxs("div",{className:"bg-white border rounded-xl shadow-sm",children:[c.jsx("div",{className:"px-4 py-3 border-b",children:c.jsx("h3",{className:"text-base font-semibold text-gray-800",children:ne})}),c.jsx("div",{className:"p-4 text-sm text-gray-600",children:xe})]})}),l=()=>{switch(e){case"overview":return c.jsx(B3,{});case"investors":return c.jsx(Cde,{});case"groupInvestorAdmin":return c.jsx(Jde,{});case"companies":return c.jsx(i,{title:"Companies",children:"Portfolio companies with metrics, documents, and valuations. (Placeholder UI)"});case"management":return c.jsx(i,{title:"Management",children:"Management company items: fees, expenses, approvals, workflows. (Placeholder UI)"});case"documents":return c.jsx(Xde,{});case"settings":return c.jsx(BB,{});case"addUser":return c.jsx(UB,{});case"allUsers":return c.jsx(zB,{});case"excel":return c.jsx(kG,{});case"quickbooks":return c.jsx(CG,{});case"manual":return c.jsx(DG,{});case"knowledge":return c.jsx(Zde,{});default:return c.jsx(B3,{})}},u=({label:ne,tabKey:xe,icon:Be})=>c.jsxs("button",{onClick:()=>t(xe),className:`flex items-center gap-2 w-full px-4 py-2 rounded-md text-sm transition font-medium ${e===xe?"bg-blue-100 text-blue-800":"text-gray-700 hover:bg-gray-200"}`,children:[Be,ne]}),[h,d]=y.useState(!1),[m,p]=y.useState("invites"),[v,g]=y.useState({invites:0,deletes:0,dependents:0,groups:0}),[w,b]=y.useState(!1),[S,j]=y.useState([]),[_,A]=y.useState(!1),[k,O]=y.useState([]),[C,T]=y.useState(!1),[I,M]=y.useState([]),[W,U]=y.useState(!1),[F,oe]=y.useState([]),[je,ue]=y.useState(!1),V=y.useRef(null),H=y.useMemo(()=>Number(v.invites||0)+Number(v.deletes||0)+Number(v.dependents||0)+Number(v.groups||0),[v]),Se=ne=>{if(!ne)return"";const xe=new Date(ne);return Number.isNaN(xe.getTime())?ne:xe.toLocaleString()},Q=async()=>{b(!0);try{let ne=0,xe=0,Be=0,Ze=0;try{const{data:tt}=await We.get("/api/invitations/stats");ne=Number(tt?.pending||0)}catch(tt){console.error("Error loading invite stats",tt)}try{const{data:tt}=await We.get("/api/deletion-requests/stats");xe=Number(tt?.pending||0)}catch(tt){console.error("Error loading delete stats",tt)}try{const{data:tt}=await We.get("/api/notifications/admin/dependent-requests/unread-count");Be=Number(tt?.count||0)}catch(tt){console.error("Error loading dependent stats",tt)}try{const{data:tt}=await We.get("/api/notifications/admin/group-requests/unread-count");Ze=Number(tt?.count||0)}catch(tt){console.error("Error loading group-request stats",tt)}g({invites:ne,deletes:xe,dependents:Be,groups:Ze})}finally{b(!1)}},z=async()=>{A(!0);try{const{data:ne}=await We.get("/api/invitations",{params:{status:"pending",per_page:100,page:1,sort:"created_at",order:"desc"}}),xe=Array.isArray(ne)?ne:ne?.items||[];j(xe)}catch(ne){console.error("Error loading pending invites",ne)}finally{A(!1)}},Y=async()=>{T(!0);try{const{data:ne}=await We.get("/api/deletion-requests"),xe=Array.isArray(ne)?ne:[];O(xe)}catch(ne){console.error("Error loading delete requests",ne)}finally{T(!1)}},P=async()=>{U(!0);try{const{data:ne}=await We.get("/api/notifications/admin/dependent-requests"),xe=Array.isArray(ne)?ne:[];M(xe)}catch(ne){console.error("Error loading dependent requests",ne)}finally{U(!1)}},q=async()=>{ue(!0);try{const{data:ne}=await We.get("/api/notifications/admin/group-requests"),xe=Array.isArray(ne)?ne:[];oe(xe)}catch(ne){console.error("Error loading group requests",ne)}finally{ue(!1)}};y.useEffect(()=>{Q();const ne=setInterval(Q,6e4);return()=>clearInterval(ne)},[]),y.useEffect(()=>{function ne(xe){V.current&&(V.current.contains(xe.target)||d(!1))}return h&&document.addEventListener("mousedown",ne),()=>document.removeEventListener("mousedown",ne)},[h]);const G=async()=>{d(ne=>!ne),h||await Promise.all([z(),Y(),P(),q(),Q()])},Z=async ne=>{if(window.confirm("Cancel this invitation?"))try{await We.delete(`/api/invitations/${ne}`),await Promise.all([z(),Q()])}catch(xe){alert(xe?.response?.data?.error||xe?.message||"Cancel failed.")}},fe=async ne=>{try{await We.post(`/api/invitations/${ne}/approve-dependent`),await Promise.all([z(),Q()])}catch(xe){alert(xe?.response?.data?.error||xe?.message||"Approve failed.")}},Oe=async ne=>{try{await We.post(`/api/deletion-requests/${ne}/approve`)}catch(xe){alert(xe?.response?.data?.error||xe?.message||"Approve failed.")}finally{await Promise.all([Y(),Q()])}},Re=async ne=>{try{await We.post(`/api/deletion-requests/${ne}/reject`)}catch(xe){alert(xe?.response?.data?.error||xe?.message||"Reject failed.")}finally{await Promise.all([Y(),Q()])}},re=(ne="")=>{const Be=ne.replace(/<[^>]+>/g," ").match(/for\s+(.+?)\s*\(([^()]+@[^()]+)\)/i);return Be?{name:Be[1].trim(),email:Be[2].trim().toLowerCase()}:{name:"",email:""}},be=(ne="")=>ne.toLowerCase().includes("existing account detected"),Ae=async ne=>{if(window.confirm("Mark this dependent account request as approved?"))try{await We.post("/api/notifications/admin/dependent-requests/mark-read",{ids:[ne.id]}),await Promise.all([P(),Q()]),d(!1)}catch(xe){alert(xe?.response?.data?.error||xe?.message||"Failed to approve dependent request.")}},D=async ne=>{const{name:xe,email:Be}=re(ne.message||"");if(!Be){alert("Could not detect an email address in this request.");return}if(window.confirm(`Send invitation to ${xe||Be}? (${Be})`))try{const Ze=await We.post("/api/invitations",{name:xe||Be,email:Be,user_type:"Investor"});await We.post("/api/notifications/admin/dependent-requests/mark-read",{ids:[ne.id]}),await Promise.all([z(),P(),Q()]);const tt=Ze?.data?.msg;alert(tt==="resent"?"Invitation resent to this email.":"Invitation sent."),d(!1)}catch(Ze){alert(Ze?.response?.data?.error||Ze?.message||"Failed to send invitation.")}},Me=async ne=>{try{await We.post("/api/notifications/admin/dependent-requests/mark-read",{ids:[ne.id]}),await Promise.all([P(),Q()]),d(!1)}catch(xe){alert(xe?.response?.data?.error||xe?.message||"Failed to dismiss notification.")}},ae=(ne="")=>{const Be=ne.replace(/\r/g,"").split(`
`).map(At=>At.trim());let Ze="";const tt=[];return Be.forEach(At=>{if(!At)return;const nn=At.match(/^Group account request from (.+)\.?$/i);if(nn){Ze=nn[1].trim();return}const En=At.match(/^[-]\s*(.+?)\s*<([^>]+)>/);En&&tt.push({name:En[1].trim(),email:En[2].trim().toLowerCase()})}),{requester:Ze,members:tt}},de=async ne=>{try{await We.post("/api/notifications/admin/group-requests/mark-read",{ids:[ne.id]}),await Promise.all([q(),Q()]),d(!1)}catch(xe){alert(xe?.response?.data?.error||xe?.message||"Failed to dismiss group request.")}},me=async(ne,xe)=>{if(window.confirm(`Mark ${xe.name||xe.email} as approved for this group request?`))try{await We.post("/api/admin/group-requests/approve",{notification_id:ne.id,member_email:xe.email}),await Promise.all([q(),Q()]),d(!1)}catch(Be){alert(Be?.response?.data?.message||Be?.response?.data?.error||Be?.message||"Failed to approve group request.")}},ce=async(ne,xe)=>{if(!xe.email){alert("Could not detect an email address for this member.");return}if(window.confirm(`Send invitation to ${xe.name||xe.email}? (${xe.email})`))try{const Be=await We.post("/api/invitations",{name:xe.name||xe.email,email:xe.email,user_type:"Investor"});await We.post("/api/notifications/admin/group-requests/mark-read",{ids:[ne.id]}),await Promise.all([z(),q(),Q()]);const Ze=Be?.data?.msg;alert(Ze==="resent"?"Invitation resent to this email.":"Invitation sent."),d(!1)}catch(Be){alert(Be?.response?.data?.error||Be?.message||"Failed to send invitation.")}},[ze,Qe]=y.useState(!1),[Ke,qe]=y.useState(0),[it,Je]=y.useState([]),[Fe,Ye]=y.useState(!1),ge=async()=>{try{const{data:ne}=await We.get("/api/admin/messages/unread-count");qe(ne.count||0)}catch{}},Ge=async()=>{Ye(!0);try{const{data:ne}=await We.get("/api/admin/messages");Je(Array.isArray(ne)?ne:[]),await ge()}finally{Ye(!1)}},ve=async ne=>{alert(`Subject: ${ne.subject||"No subject"}

${ne.body||"No message body"}`);try{await We.post(`/api/admin/messages/${ne.id}/mark-read`),await Ge()}catch{}};return y.useEffect(()=>{ge();const ne=setInterval(ge,6e4);return()=>clearInterval(ne)},[]),c.jsxs("div",{className:"flex min-h-screen bg-gray-50",children:[c.jsxs("aside",{className:"w-64 bg-gray-100 border-r border-gray-200 flex flex-col justify-between shadow-sm",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"px-6 py-5 border-b border-gray-200",children:[c.jsx("h2",{className:"text-xl font-bold text-center tracking-tight cursor-pointer hover:text-blue-600",onClick:()=>t("overview"),children:"Admin Panel"}),c.jsx("p",{className:"text-lg text-black-600 text-center",children:"Financial Reporting Agent"})]}),c.jsxs("nav",{className:"p-4 space-y-6 ml-[10px]",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-base font-bold text-gray-500 uppercase mb-2",children:"Dashboard"}),c.jsx(u,{label:"Overview",tabKey:"overview",icon:c.jsx(_A,{size:16})}),c.jsx(u,{label:"Investors",tabKey:"investors",icon:c.jsx(Nf,{size:16})}),c.jsx(u,{label:"Group Investor Admin",tabKey:"groupInvestorAdmin",icon:c.jsx(Nf,{size:16})}),c.jsx(u,{label:"Documents",tabKey:"documents",icon:c.jsx(jf,{size:16})}),c.jsx(u,{label:"Settings",tabKey:"settings",icon:c.jsx(_A,{size:16})})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-base font-bold text-gray-500 uppercase mb-2",children:"Users"}),c.jsx(u,{label:"Add User",tabKey:"addUser",icon:c.jsx(tO,{size:16})}),c.jsx(u,{label:"All Users",tabKey:"allUsers",icon:c.jsx(Nf,{size:16})})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-base font-bold text-gray-500 uppercase mb-2",children:"Integration"}),c.jsx(u,{label:"Excel Sheet",tabKey:"excel",icon:c.jsx(xB,{size:16})}),c.jsx(u,{label:"QuickBooks",tabKey:"quickbooks",icon:c.jsx(jf,{size:16})})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-base font-bold text-gray-500 uppercase mb-2",children:"Manual Entry"}),c.jsx(u,{label:"Entry Form",tabKey:"manual",icon:c.jsx(jB,{size:16})})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-base font-bold text-gray-500 uppercase mb-2",children:"Funds"}),c.jsxs("a",{href:"/admin/opportunity",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 w-full px-4 py-2 rounded-md text-sm transition font-medium text-gray-700 hover:bg-gray-200",children:[c.jsx(jf,{size:16}),"Opportunity Fund"]}),c.jsxs("a",{href:"/admin/generalpartner",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 w-full px-4 py-2 rounded-md text-sm transition font-medium text-gray-700 hover:bg-gray-200",children:[c.jsx($b,{size:16}),"General Partner"]})]})]})]}),c.jsxs("div",{className:"p-4 border-t border-gray-200",children:[c.jsxs("button",{onClick:n,className:"flex items-center gap-2 text-red-500 hover:text-red-700 transition w-full text-sm font-medium",children:[c.jsx(Wm,{size:16}),"Logout"]}),c.jsx("p",{className:"text-xs mt-2 text-gray-400",children:"Logged in as Admin"})]})]}),c.jsxs("div",{className:"flex-1 flex flex-col",children:[c.jsxs("header",{className:"flex justify-end items-center gap-4 p-4 bg-white border-b relative",children:[c.jsxs("div",{className:"relative",ref:V,children:[c.jsxs("button",{type:"button",onClick:G,className:"relative inline-flex items-center justify-center rounded-full h-10 w-10 border border-gray-200 bg-white hover:bg-gray-50",title:"Notifications",children:[c.jsx(oB,{size:18}),c.jsx("span",{className:"sr-only",children:"Notifications"}),w?c.jsx("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center h-5 w-5 rounded-full bg-gray-300 text-[10px] text-white",children:c.jsx(JC,{className:"animate-spin",size:12})}):H>0?c.jsx("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center h-5 min-w-[20px] rounded-full bg-rose-600 text-[10px] text-white px-1",children:H}):null]}),h&&c.jsxs("div",{className:"absolute right-0 mt-2 w-[460px] bg-white border rounded-xl shadow-xl z-50",children:[c.jsxs("div",{className:"flex items-center justify-between border-b px-4 py-3",children:[c.jsx("div",{className:"font-semibold text-gray-800",children:"Notifications"}),c.jsx("div",{className:"text-xs text-gray-500",children:w?"Refreshing":"Up to date"})]}),c.jsx("div",{className:"px-4 pt-3",children:c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsxs("button",{className:`px-3 py-1.5 rounded-md text-sm border ${m==="invites"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200 hover:bg-gray-50"}`,onClick:()=>p("invites"),children:["Invites"," ",v.invites?`(${v.invites})`:""]}),c.jsxs("button",{className:`px-3 py-1.5 rounded-md text-sm border ${m==="deletes"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200 hover:bg-gray-50"}`,onClick:()=>p("deletes"),children:["Delete Requests"," ",v.deletes?`(${v.deletes})`:""]}),c.jsxs("button",{className:`px-3 py-1.5 rounded-md text-sm border ${m==="dependents"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200 hover:bg-gray-50"}`,onClick:()=>p("dependents"),children:["Dependent Requests"," ",v.dependents?`(${v.dependents})`:""]}),c.jsxs("button",{className:`px-3 py-1.5 rounded-md text-sm border ${m==="groups"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200 hover:bg-gray-50"}`,onClick:()=>p("groups"),children:["Group Requests"," ",v.groups?`(${v.groups})`:""]})]})}),c.jsx("div",{className:"max-h-[60vh] overflow-y-auto px-4 py-3",children:m==="invites"?c.jsx(c.Fragment,{children:_?c.jsx("div",{className:"text-sm text-gray-500 p-3",children:"Loading pending invitations"}):S.length===0?c.jsx("div",{className:"text-sm text-gray-500 p-3",children:"No pending invitations."}):c.jsx("ul",{className:"space-y-2",children:S.map(ne=>{const xe=ne.is_dependent_request||!!ne.invited_parent_investor_id;return c.jsxs("li",{className:"border rounded-lg p-3 flex items-center justify-between",children:[c.jsxs("div",{className:"text-sm",children:[c.jsx("div",{className:"font-medium text-gray-800",children:ne.name||ne.email||""}),c.jsxs("div",{className:"text-gray-500",children:[ne.email,"  invited"," ",Se(ne.created_at)]}),xe&&c.jsx("div",{className:"text-xs text-blue-600 mt-1",children:"Dependent investor request"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[xe&&c.jsxs("button",{onClick:()=>fe(ne.id),className:"inline-flex items-center gap-1 rounded-md border border-emerald-200 bg-emerald-50 text-emerald-800 px-2 py-1 text-xs hover:bg-emerald-100",title:"Approve dependent investor",children:[c.jsx(Z0,{size:14}),"Accept"]}),c.jsxs("button",{onClick:()=>Z(ne.id),className:"inline-flex items-center gap-1 rounded-md border px-2 py-1 text-xs hover:bg-gray-50",title:"Cancel invitation",children:[c.jsx(wc,{size:14}),"Cancel"]})]})]},ne.id)})})}):m==="deletes"?c.jsx(c.Fragment,{children:C?c.jsx("div",{className:"text-sm text-gray-500 p-3",children:"Loading delete requests"}):k.length===0?c.jsx("div",{className:"text-sm text-gray-500 p-3",children:"No delete requests."}):c.jsx("ul",{className:"space-y-2",children:k.map(ne=>c.jsx("li",{className:"border rounded-lg p-3",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"text-sm",children:[c.jsxs("div",{className:"font-medium text-gray-800",children:["Investor #",ne.investor_id]}),c.jsxs("div",{className:"text-gray-500",children:["Requested by #",ne.requested_by_investor_id||""," "," ",Se(ne.created_at)]}),ne.reason&&c.jsxs("div",{className:"text-gray-600 mt-1",children:[c.jsx("span",{className:"text-gray-500",children:"Reason:"})," ",ne.reason]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("button",{onClick:()=>Oe(ne.id),className:"inline-flex items-center gap-1 rounded-md border border-emerald-200 bg-emerald-50 text-emerald-800 px-2 py-1 text-xs hover:bg-emerald-100",title:"Approve deletion",children:[c.jsx(Z0,{size:14}),"Approve"]}),c.jsxs("button",{onClick:()=>Re(ne.id),className:"inline-flex items-center gap-1 rounded-md border border-rose-200 bg-rose-50 text-rose-700 px-2 py-1 text-xs hover:bg-rose-100",title:"Reject deletion",children:[c.jsx(wc,{size:14}),"Reject"]})]})]})},ne.id))})}):m==="dependents"?c.jsx(c.Fragment,{children:W?c.jsx("div",{className:"text-sm text-gray-500 p-3",children:"Loading dependent account requests"}):I.length===0?c.jsx("div",{className:"text-sm text-gray-500 p-3",children:"No dependent account requests."}):c.jsx("ul",{className:"space-y-2",children:I.map(ne=>{const xe=be(ne.message||""),{name:Be,email:Ze}=re(ne.message||"");return c.jsxs("li",{className:"border rounded-lg p-3 space-y-2",children:[c.jsxs("div",{className:"flex items-start justify-between gap-3",children:[c.jsxs("div",{className:"text-sm",children:[c.jsx("div",{className:"font-medium text-gray-800",children:ne.title||"Dependent account request submitted"}),ne.message&&c.jsx("div",{className:"text-gray-700 mt-1 whitespace-pre-line",dangerouslySetInnerHTML:{__html:ne.message}}),c.jsx("div",{className:"text-xs text-gray-500 mt-1",children:Se(ne.created_at)}),Ze&&c.jsxs("div",{className:"text-xs text-gray-500 mt-0.5",children:[Be||"Dependent","  ",Ze]})]}),c.jsx("button",{onClick:()=>Me(ne),className:"inline-flex items-center gap-1 rounded-md border px-2 py-1 text-xs text-gray-500 hover:bg-gray-50",title:"Dismiss request",children:c.jsx(wc,{size:14})})]}),c.jsx("div",{className:"flex items-center gap-2",children:xe?c.jsxs("button",{onClick:()=>Ae(ne),className:"inline-flex items-center gap-1 rounded-md border px-2 py-1 text-xs hover:bg-gray-50",children:[c.jsx(Z0,{size:14}),"Approve request"]}):c.jsxs("button",{onClick:()=>D(ne),className:"inline-flex items-center gap-1 rounded-md border px-2 py-1 text-xs hover:bg-gray-50",children:[c.jsx(lg,{size:14}),"Send invitation"]})})]},ne.id)})})}):c.jsx(c.Fragment,{children:je?c.jsx("div",{className:"text-sm text-gray-500 p-3",children:"Loading group account requests"}):F.length===0?c.jsx("div",{className:"text-sm text-gray-500 p-3",children:"No group account requests."}):c.jsx("ul",{className:"space-y-2",children:F.map(ne=>{const{requester:xe,members:Be}=ae(ne.message||"");return c.jsxs("li",{className:"border rounded-lg p-3 space-y-2",children:[c.jsxs("div",{className:"flex items-start justify-between gap-3",children:[c.jsxs("div",{className:"text-sm",children:[c.jsx("div",{className:"font-medium text-gray-800",children:ne.title||"Group account request submitted"}),xe&&c.jsxs("div",{className:"text-gray-700 mt-1",children:["Request from:"," ",c.jsx("span",{className:"font-medium",children:xe})]}),c.jsx("div",{className:"text-xs text-gray-500 mt-1",children:Se(ne.created_at)})]}),c.jsx("button",{onClick:()=>de(ne),className:"inline-flex items-center gap-1 rounded-md border px-2 py-1 text-xs text-gray-500 hover:bg-gray-50",title:"Dismiss request",children:c.jsx(wc,{size:14})})]}),Be.length>0&&c.jsx("div",{className:"mt-2 space-y-2",children:Be.map(Ze=>c.jsxs("div",{className:"flex items-center justify-between gap-2 rounded-md bg-gray-50 px-2 py-1",children:[c.jsxs("div",{className:"text-xs text-gray-700",children:[c.jsx("div",{className:"font-medium",children:Ze.name||"Group member"}),c.jsx("div",{className:"text-gray-500",children:Ze.email})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("button",{onClick:()=>me(ne,Ze),className:"inline-flex items-center gap-1 rounded-md border px-2 py-1 text-[11px] hover:bg-gray-50",children:[c.jsx(Z0,{size:13}),"Approve"]}),c.jsxs("button",{onClick:()=>ce(ne,Ze),className:"inline-flex items-center gap-1 rounded-md border px-2 py-1 text-[11px] hover:bg-gray-50",children:[c.jsx(lg,{size:13}),"Send invite"]})]})]},Ze.email))})]},ne.id)})})})}),c.jsx("div",{className:"border-t px-4 py-2 text-right",children:c.jsx("button",{onClick:async()=>{await Promise.all([z(),Y(),P(),q(),Q()])},className:"text-xs rounded-md border px-3 py-1 hover:bg-gray-50",children:"Refresh"})})]})]}),c.jsxs("div",{className:"relative",children:[c.jsxs("button",{onClick:()=>{Qe(ne=>{const xe=!ne;return ne||Ge(),xe})},className:"relative inline-flex items-center justify-center rounded-full h-10 w-10 border border-gray-200 bg-white hover:bg-gray-50",title:"Mailbox",children:[c.jsx(lg,{size:18}),Ke>0&&c.jsx("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center h-5 min-w-[20px] rounded-full bg-blue-600 text-[10px] text-white px-1",children:Ke})]}),ze&&c.jsxs("div",{className:"absolute right-0 mt-2 w-[420px] bg-white border rounded-xl shadow-xl z-50",children:[c.jsxs("div",{className:"flex items-center justify-between border-b px-4 py-3",children:[c.jsx("div",{className:"font-semibold text-gray-800",children:"Mailbox"}),c.jsx("button",{className:"text-xs rounded-md border px-2 py-0.5 hover:bg-gray-50",onClick:Ge,children:"Refresh"})]}),c.jsx("div",{className:"max-h-[60vh] overflow-y-auto px-4 py-3",children:Fe?c.jsx("div",{className:"text-sm text-gray-500 p-3",children:"Loading"}):it.length===0?c.jsx("div",{className:"text-sm text-gray-500 p-3",children:"No messages."}):c.jsx("ul",{className:"space-y-2",children:it.map(ne=>c.jsxs("li",{className:"border rounded-lg p-3 cursor-pointer hover:bg-gray-50",onClick:()=>ve(ne),children:[c.jsx("div",{className:"font-medium text-gray-800",children:ne.subject||"No subject"}),c.jsxs("div",{className:"text-gray-500 text-xs",children:["From: ",ne.investor_name||"Unknown"," "," ",new Date(ne.created_at).toLocaleString()]}),!ne.read_at&&c.jsx("span",{className:"text-blue-600 text-xs font-semibold",children:"Unread"})]},ne.id))})})]})]}),c.jsxs("div",{className:"relative group cursor-pointer",children:[c.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-600 text-white flex items-center justify-center text-lg font-bold",children:a.fullName?.charAt(0).toUpperCase()||"A"}),c.jsxs("div",{className:"absolute right-0 mt-2 hidden group-hover:block bg-white shadow-lg border rounded-md w-64 p-4 z-50",children:[c.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-2",children:"Admin Info"}),c.jsxs("div",{className:"text-sm text-gray-600",children:[c.jsxs("div",{children:[c.jsx("strong",{children:"Full Name:"})," ",a.fullName]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Email:"})," ",a.email]}),c.jsxs("div",{children:[c.jsx("strong",{children:"User Type:"})," ",a.userType]})]})]})]})]}),c.jsx("main",{className:"p-6 overflow-y-auto bg-white shadow-inner flex-1",children:l()})]})]})},t0e=[{investor:"TOTAL",ownership:"100%",commitment:"271,000,003",capitalPaid:"70,500,000",distributions:"(62,736,000)",realizedGains:"19,331,000",unrealizedGains:"21,202,000",isSection:!0},{investor:"TOTAL FOR INVESTORS",ownership:"100%",commitment:"271,000,003",capitalPaid:"70,500,000",distributions:"(62,736,000)",realizedGains:"19,331,000",unrealizedGains:"21,202,000",isSection:!0},{investor:"General Partner",ownership:"0.4%",commitment:"1,000,000",capitalPaid:"705,000",distributions:"(627,000)",realizedGains:"193,000",unrealizedGains:"222,000",group:"Carried interest partner"},{investor:"Investor X",ownership:"9.2%",commitment:"25,000,000",capitalPaid:"17,625,000",distributions:"(15,684,000)",realizedGains:"4,833,000",unrealizedGains:"5,554,000",group:"Carried interest partner"},{investor:"Investor X",ownership:"7.4%",commitment:"20,000,000",capitalPaid:"14,100,000",distributions:"(12,547,000)",realizedGains:"3,866,000",unrealizedGains:"4,443,000",group:"Carried interest partner"},{investor:"Investor X",ownership:"3.0%",commitment:"8,000,000",capitalPaid:"5,640,000",distributions:"(5,019,000)",realizedGains:"1,546,000",unrealizedGains:"1,777,000",group:"Carried interest partner"}],r0e=()=>{const[e,t]=y.useState(""),r=t0e.filter(n=>n.investor.toLowerCase().includes(e.toLowerCase()));return c.jsxs("div",{className:"p-6 bg-white rounded shadow space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h3",{className:"text-sm text-gray-500",children:"Total Invested Amount"}),c.jsx("p",{className:"text-2xl font-bold text-pink-600 mt-2",children:"$79,155M"})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h3",{className:"text-sm text-gray-500",children:"Number of Investors"}),c.jsx("p",{className:"text-2xl font-bold text-purple-600 mt-2",children:"2216"})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h3",{className:"text-sm text-gray-500",children:"Rate of Return"}),c.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-2",children:"-4.16%"})]})]}),c.jsx("input",{type:"text",placeholder:"Search investor",value:e,onChange:n=>t(n.target.value),className:"mb-4 p-2 border rounded w-full"}),c.jsxs("table",{className:"w-full table-auto border text-sm",children:[c.jsx("thead",{className:"bg-gray-100",children:c.jsxs("tr",{children:[c.jsx("th",{className:"border p-2 text-left",children:"Investor"}),c.jsx("th",{className:"border p-2 text-right",children:"Ownership"}),c.jsx("th",{className:"border p-2 text-right",children:"Commitment"}),c.jsx("th",{className:"border p-2 text-right",children:"Paid in Capital"}),c.jsx("th",{className:"border p-2 text-right",children:"Distributions"}),c.jsx("th",{className:"border p-2 text-right",children:"Realised Gains"}),c.jsx("th",{className:"border p-2 text-right",children:"Unrealised Gains"})]})}),c.jsx("tbody",{children:r.map((n,a)=>c.jsxs("tr",{className:n.isSection?"font-bold bg-gray-50":"hover:bg-gray-50",children:[c.jsx("td",{className:"border p-2",children:n.investor}),c.jsx("td",{className:"border p-2 text-right",children:n.ownership}),c.jsx("td",{className:"border p-2 text-right",children:n.commitment}),c.jsx("td",{className:"border p-2 text-right",children:n.capitalPaid}),c.jsx("td",{className:"border p-2 text-right text-red-500",children:n.distributions}),c.jsx("td",{className:"border p-2 text-right",children:n.realizedGains}),c.jsx("td",{className:"border p-2 text-right",children:n.unrealizedGains})]},a))})]})]})},n0e=[{quarter:"Q2 2019",investment:4,gain:0,moic:1},{quarter:"Q3 2019",investment:8,gain:0,moic:1},{quarter:"Q4 2019",investment:15,gain:0,moic:1},{quarter:"Q1 2020",investment:17,gain:4,moic:1.1},{quarter:"Q2 2020",investment:21,gain:4,moic:1.1},{quarter:"Q3 2020",investment:25,gain:5,moic:1.2},{quarter:"Q4 2020",investment:42,gain:6,moic:1.3},{quarter:"Q1 2021",investment:48,gain:10,moic:1.5},{quarter:"Q2 2021",investment:82,gain:20,moic:1.8},{quarter:"Q3 2021",investment:88,gain:28,moic:2},{quarter:"Q4 2021",investment:88,gain:30,moic:2.1},{quarter:"Q1 2022",investment:96,gain:34,moic:2.2},{quarter:"Q2 2022",investment:109,gain:39,moic:2.3},{quarter:"Q3 2022",investment:120,gain:44,moic:2.4},{quarter:"Q4 2022",investment:148,gain:50,moic:2.5},{quarter:"Q1 2023",investment:154,gain:55,moic:2.5},{quarter:"Q2 2023",investment:164,gain:60,moic:2.6},{quarter:"Q3 2023",investment:162,gain:58,moic:2.4}],a0e=[{title:"Net Fund performance",data:[{label:"Contribution",value:"$82.0M"},{label:"NAV & Distribution",value:"$162.8M"},{label:"Gain",value:"$80.8M"},{label:"Fund size",value:"$140.0M"},{label:"TVPI",value:"1.99x"},{label:"IRR",value:"29.80%"}]},{title:"Total Portfolio performance",data:[{label:"Investment",value:"$78.3M"},{label:"Fair value",value:"$161.7M"},{label:"Gain",value:"$83.4M"},{label:"Companies",value:"2"},{label:"MOIC",value:"x2.06"},{label:"IRR",value:"33.23%"}]}],i0e=()=>c.jsxs("div",{className:"space-y-8",children:[c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:a0e.map((e,t)=>c.jsxs("div",{className:"bg-white shadow p-6 rounded-lg",children:[c.jsx("h3",{className:"text-md font-semibold mb-4 text-gray-700",children:e.title}),c.jsx("div",{className:"grid grid-cols-2 gap-4",children:e.data.map((r,n)=>c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-gray-500",children:r.label}),c.jsx("p",{className:"font-bold text-gray-900",children:r.value})]},n))})]},t))}),c.jsxs("div",{className:"bg-white shadow p-6 rounded-lg",children:[c.jsx("h3",{className:"text-md font-semibold mb-4 text-gray-700",children:"Total Portfolio Performance"}),c.jsx(zn,{width:"100%",height:300,children:c.jsxs(qc,{data:n0e,margin:{top:20,right:30,left:0,bottom:5},children:[c.jsx(ml,{strokeDasharray:"3 3"}),c.jsx(fi,{dataKey:"quarter"}),c.jsx($a,{yAxisId:"left"}),c.jsx($a,{yAxisId:"right",orientation:"right",domain:[1,3]}),c.jsx($n,{}),c.jsx(Qc,{}),c.jsx(Mi,{yAxisId:"left",dataKey:"investment",stackId:"a",fill:"#606060",name:"Investment"}),c.jsx(Mi,{yAxisId:"left",dataKey:"gain",stackId:"a",fill:"#49C5B6",name:"Net Gain/(Loss)"}),c.jsx(zc,{yAxisId:"right",type:"monotone",dataKey:"moic",stroke:"#FFA500",name:"MOIC",strokeWidth:2})]})})]})]}),s0e=[{date:"13 Oct",actual:3},{date:"14 Oct",actual:3},{date:"15 Oct",actual:5},{date:"16 Oct",actual:4},{date:"17 Oct",actual:0},{date:"18 Oct",forecast:3},{date:"19 Oct",forecast:3},{date:"20 Oct",forecast:5},{date:"21 Oct",forecast:3.8},{date:"22 Oct",forecast:6}],l0e=[{name:"Account Receivables",value:9.8},{name:"Royalties",value:5.1},{name:"Commissions",value:.9},{name:"Interest Receipts",value:.2},{name:"Tax Refunds",value:.1}],o0e=[{name:"Account Payables",value:-8.3},{name:"Payroll",value:-6.1},{name:"Tax Payments",value:-2.5},{name:"Capex",value:-1.8},{name:"Rent/Admin Charges",value:-.9}],c0e=[{name:"Inflow",value:60,fill:"#06b6d4"},{name:"Outflow",value:40,fill:"#f43f5e"}],u0e=[{label:"Maximum Variance",value:"$5,767,899.32",percentage:"21%",date:"10th Sep 2022",color:"rose"},{label:"Minimum Variance",value:"$1,197,359.80",percentage:"15.45%",date:"18th Sep 2022",color:"green"},{label:"Average Variance",value:"$1,678,899.32",percentage:"21%",date:"10th Sep 2022",color:"amber"}],f0e=()=>c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[c.jsxs("div",{className:"col-span-2 bg-white p-6 rounded shadow",children:[c.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Net Cashflow - Past 30 Days"}),c.jsx(zn,{width:"100%",height:250,children:c.jsxs(NM,{data:s0e,children:[c.jsx(ml,{strokeDasharray:"3 3"}),c.jsx(fi,{dataKey:"date"}),c.jsx($a,{domain:[-2,10],tickFormatter:e=>`${e}M`}),c.jsx($n,{formatter:e=>`$${e}M`}),c.jsx(zc,{type:"monotone",dataKey:"actual",stroke:"#f97316",name:"Actual"}),c.jsx(zc,{type:"monotone",dataKey:"forecast",stroke:"#16a34a",name:"Forecast"})]})})]}),c.jsxs("div",{className:"bg-white p-6 rounded shadow",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Net Cashflow"}),c.jsx(zn,{width:"100%",height:250,children:c.jsxs(Vfe,{cx:"50%",cy:"50%",innerRadius:"40%",outerRadius:"80%",barSize:20,data:c0e,children:[c.jsx(aS,{background:!0,clockWise:!0,dataKey:"value"}),c.jsx(Qc,{iconSize:10,layout:"vertical",verticalAlign:"middle",align:"right"}),c.jsx($n,{formatter:e=>`${e}%`})]})})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[c.jsxs("div",{className:"bg-white p-6 rounded shadow",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Inflows"}),c.jsx(zn,{width:"100%",height:200,children:c.jsxs(qc,{layout:"vertical",data:l0e,children:[c.jsx(fi,{type:"number",domain:[0,10],tickFormatter:e=>`${e}M`}),c.jsx($a,{type:"category",dataKey:"name",width:130}),c.jsx($n,{formatter:e=>`$${e}M`}),c.jsx(Mi,{dataKey:"value",fill:"#22c55e"})]})})]}),c.jsxs("div",{className:"bg-white p-6 rounded shadow",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Outflows"}),c.jsx(zn,{width:"100%",height:200,children:c.jsxs(qc,{layout:"vertical",data:o0e,children:[c.jsx(fi,{type:"number",domain:[-10,0],tickFormatter:e=>`${-e}M`}),c.jsx($a,{type:"category",dataKey:"name",width:130}),c.jsx($n,{formatter:e=>`$${-e}M`}),c.jsx(Mi,{dataKey:"value",fill:"#ef4444"})]})})]})]}),c.jsx("div",{className:"grid grid-cols-3 gap-6",children:u0e.map((e,t)=>c.jsxs("div",{className:`border-l-4 border-${e.color}-500 bg-white p-4 rounded shadow`,children:[c.jsx("p",{className:`text-${e.color}-600 font-semibold`,children:e.label}),c.jsxs("h2",{className:"text-xl font-bold mt-1",children:[e.value," ",c.jsxs("span",{className:"text-sm text-gray-500",children:["(",e.percentage,")"]})]}),c.jsxs("p",{className:"text-sm text-gray-500",children:["Measured on ",e.date]})]},t))})]}),tC=[{category:"other income",amount:5261},{category:"primary paycheck",amount:3742}],rC=[{account:"Chase Sapphire",balance:-216},{account:"Chase Ink",balance:-15},{account:"Chase Freedom Unlimited",balance:-1},{account:"Amex Gold",balance:-56}],d0e=[{category:"subscriptions",amount:-402,budget:-626},{category:"groceries",amount:-1057,budget:-1200},{category:"gym",amount:-318,budget:-200},{category:"education",amount:-17,budget:-50},{category:"restaurants & other",amount:-242,budget:-600},{category:"other expenses",amount:-2770,budget:-8e3},{category:"other shopping",amount:-343,budget:0},{category:"bills & utilities",amount:-3692,budget:-60},{category:"other health & wellness",amount:-108,budget:-250},{category:"travel & vacation",amount:-471,budget:-200},{category:"other transportation",amount:-163,budget:-50}],h0e=[{month:"Jan Y24",amount:1e3},{month:"Feb Y24",amount:3e3},{month:"Mar Y24",amount:2e3},{month:"Apr Y24",amount:5e3},{month:"May Y24",amount:4e3},{month:"Jun Y24",amount:3e3}],m0e=[{label:"Maximum Variance",value:"$5,767,899.32",percentage:"21%",date:"10th Sep 2022",color:"rose"},{label:"Minimum Variance",value:"$1,197,359.80",percentage:"15.45%",date:"18th Sep 2022",color:"green"},{label:"Average Variance",value:"$1,678,899.32",percentage:"21%",date:"10th Sep 2022",color:"amber"}],p0e=()=>c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[c.jsxs("div",{className:"bg-white p-6 rounded shadow",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Income by Category"}),c.jsxs("table",{className:"w-full table-auto border",children:[c.jsx("thead",{className:"bg-gray-100",children:c.jsxs("tr",{children:[c.jsx("th",{className:"border p-2 text-left",children:"Category"}),c.jsx("th",{className:"border p-2 text-left",children:"Amount"})]})}),c.jsxs("tbody",{children:[tC.map((e,t)=>c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsx("td",{className:"border p-2",children:e.category}),c.jsxs("td",{className:"border p-2 text-right",children:["$",e.amount]})]},t)),c.jsxs("tr",{className:"font-bold",children:[c.jsx("td",{className:"border p-2",children:"Total"}),c.jsxs("td",{className:"border p-2 text-right",children:["$",tC.reduce((e,t)=>e+t.amount,0)]})]})]})]})]}),c.jsxs("div",{className:"bg-white p-6 rounded shadow",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Current Debt Balances"}),c.jsxs("table",{className:"w-full table-auto border",children:[c.jsx("thead",{className:"bg-gray-100",children:c.jsxs("tr",{children:[c.jsx("th",{className:"border p-2 text-left",children:"Account"}),c.jsx("th",{className:"border p-2 text-left",children:"Balance"})]})}),c.jsxs("tbody",{children:[rC.map((e,t)=>c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsx("td",{className:"border p-2",children:e.account}),c.jsxs("td",{className:"border p-2 text-right",children:["$",e.balance]})]},t)),c.jsxs("tr",{className:"font-bold",children:[c.jsx("td",{className:"border p-2",children:"Total"}),c.jsxs("td",{className:"border p-2 text-right",children:["$",rC.reduce((e,t)=>e+t.balance,0)]})]})]})]})]})]}),c.jsxs("div",{className:"bg-white p-6 rounded shadow",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Expense by Category with Budget"}),c.jsxs("table",{className:"w-full table-auto border",children:[c.jsx("thead",{className:"bg-gray-100",children:c.jsxs("tr",{children:[c.jsx("th",{className:"border p-2 text-left",children:"Category"}),c.jsx("th",{className:"border p-2 text-left",children:"Amount"}),c.jsx("th",{className:"border p-2 text-left",children:"Budget"})]})}),c.jsx("tbody",{children:d0e.map((e,t)=>c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsx("td",{className:"border p-2",children:e.category}),c.jsxs("td",{className:`border p-2 text-right ${e.amount<0?"text-red-500":"text-green-500"}`,children:["$",e.amount]}),c.jsxs("td",{className:`border p-2 text-right ${e.budget<0?"text-red-500":"text-green-500"}`,children:["$",e.budget]})]},t))})]})]}),c.jsxs("div",{className:"bg-white p-6 rounded shadow",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Bills and Subscriptions"}),c.jsx(zn,{width:"100%",height:250,children:c.jsxs(qc,{data:h0e,children:[c.jsx(ml,{strokeDasharray:"3 3"}),c.jsx(fi,{dataKey:"month"}),c.jsx($a,{}),c.jsx($n,{}),c.jsx(Mi,{dataKey:"amount",fill:"#f43f5e"})]})})]}),c.jsx("div",{className:"grid grid-cols-3 gap-6",children:m0e.map((e,t)=>c.jsxs("div",{className:`border-l-4 border-${e.color}-500 bg-white p-4 rounded shadow`,children:[c.jsx("p",{className:`text-${e.color}-600 font-semibold`,children:e.label}),c.jsxs("h2",{className:"text-xl font-bold mt-1",children:[e.value," ",c.jsxs("span",{className:"text-sm text-gray-500",children:["(",e.percentage,")"]})]}),c.jsxs("p",{className:"text-sm text-gray-500",children:["Measured on ",e.date]})]},t))})]}),x0e=()=>c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[c.jsxs("div",{className:"bg-white p-6 rounded shadow",children:[c.jsx("h3",{className:"text-sm text-gray-500",children:"Management Fees"}),c.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-2",children:"$2.1M"})]}),c.jsxs("div",{className:"bg-white p-6 rounded shadow",children:[c.jsx("h3",{className:"text-sm text-gray-500",children:"Organizational Expenses"}),c.jsx("p",{className:"text-2xl font-bold text-orange-500 mt-2",children:"$0.3M"})]}),c.jsxs("div",{className:"bg-white p-6 rounded shadow",children:[c.jsx("h3",{className:"text-sm text-gray-500",children:"Other Expenses"}),c.jsx("p",{className:"text-2xl font-bold text-red-500 mt-2",children:"$0.1M"})]})]}),c.jsxs("div",{className:"bg-white p-6 rounded shadow",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Expenses Breakdown"}),c.jsxs("table",{className:"w-full table-auto text-sm border",children:[c.jsx("thead",{className:"bg-gray-100",children:c.jsxs("tr",{children:[c.jsx("th",{className:"border p-2 text-left",children:"Category"}),c.jsx("th",{className:"border p-2 text-right",children:"Amount"}),c.jsx("th",{className:"border p-2 text-right",children:"Percentage"})]})}),c.jsxs("tbody",{children:[c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsx("td",{className:"border p-2",children:"Management Fees"}),c.jsx("td",{className:"border p-2 text-right",children:"$2,100,000"}),c.jsx("td",{className:"border p-2 text-right",children:"84%"})]}),c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsx("td",{className:"border p-2",children:"Organizational Expenses"}),c.jsx("td",{className:"border p-2 text-right",children:"$300,000"}),c.jsx("td",{className:"border p-2 text-right",children:"12%"})]}),c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsx("td",{className:"border p-2",children:"Other Expenses"}),c.jsx("td",{className:"border p-2 text-right",children:"$100,000"}),c.jsx("td",{className:"border p-2 text-right",children:"4%"})]})]})]})]})]}),v0e=()=>{const[e,t]=y.useState([]),[r,n]=y.useState("Overview"),a=Fi(),{logout:i}=y.useContext(mi);y.useEffect(()=>{l()},[]);const l=()=>{const w=localStorage.getItem("accessToken");w&&dr.get("/api/group-admin/users",{headers:{Authorization:`Bearer ${w}`}}).then(b=>t(b.data)).catch(b=>console.error(b))},u=()=>{i(),a("/login")},h=[{year:"2010",investment:8e3},{year:"2011",investment:12e3},{year:"2012",investment:18e3},{year:"2013",investment:15e3},{year:"2014",investment:25e3},{year:"2015",investment:12e3}],d=[{group:"AAA",value:28e3},{group:"A",value:26e3},{group:"AA",value:12e3},{group:"BB",value:5e3},{group:"BBB",value:15e3}],m=[{name:"CMO",value:27},{name:"Corporates",value:60},{name:"Municipal",value:4},{name:"MBS",value:1},{name:"Cash",value:8}],p=[{book:100,market:28e3,group:"AAA"},{book:700,market:26e3,group:"A"},{book:400,market:12e3,group:"AA"},{book:200,market:5e3,group:"BB"},{book:300,market:15e3,group:"BBB"}],v=["#8884d8","#82ca9d","#ffc658","#ff8042","#00C49F"],g=()=>c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h3",{className:"text-sm text-gray-500",children:"Total Invested Amount"}),c.jsx("p",{className:"text-2xl font-bold text-pink-600 mt-2",children:"$79,155M"})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h3",{className:"text-sm text-gray-500",children:"Number of Investments"}),c.jsx("p",{className:"text-2xl font-bold text-purple-600 mt-2",children:"2216"})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h3",{className:"text-sm text-gray-500",children:"Rate of Return"}),c.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-2",children:"-4.16%"})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-6 mt-6",children:[c.jsxs("div",{className:"bg-white p-6 rounded shadow",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Yearly Total Investment"}),c.jsx(zn,{width:"100%",height:200,children:c.jsxs(NM,{data:h,children:[c.jsx(zc,{type:"monotone",dataKey:"investment",stroke:"#8884d8"}),c.jsx(ml,{stroke:"#ccc"}),c.jsx(fi,{dataKey:"year"}),c.jsx($a,{}),c.jsx($n,{})]})})]}),c.jsxs("div",{className:"bg-white p-6 rounded shadow",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Total Investment by Rating Group"}),c.jsx(zn,{width:"100%",height:200,children:c.jsxs(qc,{data:d,children:[c.jsx(ml,{strokeDasharray:"3 3"}),c.jsx(fi,{dataKey:"group"}),c.jsx($a,{}),c.jsx($n,{}),c.jsx(Qc,{}),c.jsx(Mi,{dataKey:"value",fill:"#82ca9d"})]})})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-6 mt-6",children:[c.jsxs("div",{className:"bg-white p-6 rounded shadow",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Total Investment by Asset Class"}),c.jsx(zn,{width:"100%",height:200,children:c.jsxs(Kp,{children:[c.jsx(ou,{data:m,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:80,label:!0,children:m.map((w,b)=>c.jsx(Bi,{fill:v[b%v.length]},`cell-${b}`))}),c.jsx($n,{})]})})]}),c.jsxs("div",{className:"bg-white p-6 rounded shadow",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Market vs Book Value by Rating"}),c.jsx(zn,{width:"100%",height:200,children:c.jsxs(zfe,{children:[c.jsx(ml,{}),c.jsx(fi,{dataKey:"market",name:"Market Value",unit:"$"}),c.jsx($a,{dataKey:"book",name:"Book Value",unit:"$"}),c.jsx(Vp,{range:[60]}),c.jsx($n,{cursor:{strokeDasharray:"3 3"}}),c.jsx(cS,{name:"Rating",data:p,fill:"#8884d8"})]})})]})]}),c.jsxs("div",{className:"bg-white p-6 mt-6 rounded shadow",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Top Investment Companies"}),c.jsxs("table",{className:"w-full table-auto border",children:[c.jsx("thead",{className:"bg-gray-100",children:c.jsxs("tr",{children:[c.jsx("th",{className:"border p-2 text-left",children:"Company"}),c.jsx("th",{className:"border p-2 text-left",children:"Industry"}),c.jsx("th",{className:"border p-2 text-left",children:"Investment"}),c.jsx("th",{className:"border p-2 text-left",children:"Return"})]})}),c.jsxs("tbody",{children:[c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsx("td",{className:"border p-2",children:"Alpha Capital"}),c.jsx("td",{className:"border p-2",children:"Finance"}),c.jsx("td",{className:"border p-2",children:"$10,000,000"}),c.jsx("td",{className:"border p-2 text-green-600",children:"+5%"})]}),c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsx("td",{className:"border p-2",children:"Zenith Ventures"}),c.jsx("td",{className:"border p-2",children:"Tech"}),c.jsx("td",{className:"border p-2",children:"$7,500,000"}),c.jsx("td",{className:"border p-2 text-red-500",children:"-2%"})]})]})]})]})]});return c.jsxs("div",{className:"flex min-h-screen bg-gray-100",children:[c.jsxs("aside",{className:"w-64 bg-white border-r flex flex-col justify-between shadow-sm",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"px-6 py-5 border-b",children:[c.jsx("h2",{className:"text-xl font-bold text-center",children:"Group Admin"}),c.jsx("p",{className:"text-sm text-gray-500 text-center",children:"Dashboard"})]}),c.jsx("nav",{className:"p-4 space-y-2",children:["Overview","Fund Performance Status","Cash Flow and Net IRR","Capital Account","GP Fees & carry and Expenses"].map(w=>c.jsx("button",{onClick:()=>n(w),className:`flex items-center gap-2 px-4 py-2 rounded-md text-sm w-full text-left font-medium ${r===w?"bg-blue-100 text-blue-800":"text-gray-700 hover:bg-gray-200"}`,children:w},w))})]}),c.jsx("div",{className:"p-4 border-t",children:c.jsxs("button",{onClick:u,className:"flex items-center gap-2 text-red-500 hover:text-red-700 text-sm",children:[c.jsx(Wm,{size:16})," Logout"]})})]}),c.jsxs("main",{className:"flex-1 p-6 space-y-6",children:[r==="Overview"&&g(),r==="Fund Performance Status"&&c.jsx(i0e,{}),r==="Cash Flow and Net IRR"&&c.jsx(f0e,{}),r==="Capital Account"&&c.jsx(r0e,{}),r==="GP Fees & carry and Expenses"&&c.jsx(p0e,{}),r==="Expenses"&&c.jsx(x0e,{})]})]})},g0e=[{id:"inv_5m",label:"I have at least $5M in investments"},{id:"assets_2_5m",label:"I have between $2.2M and $5M in assets"},{id:"assets_1_2_2m",label:"I have between $1M and $2.2M in assets"},{id:"income",label:"I have income of $200k (or $300k jointly with spouse) for the past 2 years and expect the same this year"},{id:"license",label:"I am a Series 7, Series 65, or Series 82 holder and my license is active and in good standing"},{id:"not_yet",label:"I'm not accredited yet"}],sy=e=>!!(e&&e!=="not_yet");function nC(){if(typeof window>"u")return null;try{const t=new URL(window.location.href).searchParams.get("investorId"),r=window.localStorage.getItem("currentInvestorId"),n=t||r;return n?Number(n):null}catch{return null}}function OM({onAccredited:e}){const t=ga(),[r,n]=y.useState(!1),[a,i]=y.useState("not_yet"),[l,u]=y.useState(!0),[h,d]=y.useState(!1),[m,p]=y.useState("");y.useEffect(()=>{let w=!0;return(async()=>{u(!0),p("");try{const b=nC(),S=b?{investor_id:b}:void 0,{data:j}=await We.get("/api/investor/accreditation",{headers:{Accept:"application/json"},params:S});if(!w)return;j&&j.selection?(i(j.selection),sy(j.selection)?e?.(!0):e?.(!1)):e?.(!1)}catch(b){if(!w)return;const S=b?.response?.data?.error||(b?.response?`Load failed (${b.response.status})`:"Unable to load accreditation.");p(S),e?.(!1)}finally{w&&u(!1)}})(),()=>{w=!1}},[t.search,e]);async function v(){d(!0),p("");try{const w=sy(a),b=nC(),S=b?{investor_id:b}:void 0;await We.post("/api/investor/accreditation",{selection:a,accredited:w},{params:S}),n(!1),e?.(w)}catch(w){const b=w?.response?.data?.error||(w?.response?`Save failed (${w.response.status})`:"Unable to save accreditation.");p(b)}finally{d(!1)}}const g=sy(a);return c.jsx("div",{className:"max-w-4xl",children:c.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white shadow-sm",children:[c.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-200",children:[c.jsx("h2",{className:"text-xl font-semibold text-slate-800",children:"Accreditation Status"}),r?c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:v,disabled:h,className:"rounded-lg bg-blue-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-blue-700 disabled:opacity-60",children:h?"Saving...":"Save"}),c.jsx("button",{onClick:()=>{n(!1),p("")},className:"rounded-lg border border-slate-300 bg-white px-3 py-1.5 text-sm font-medium text-slate-700 hover:bg-slate-50",children:"Cancel"})]}):c.jsxs("button",{onClick:()=>n(!0),className:"inline-flex items-center gap-2 rounded-lg border border-slate-300 bg-white px-3 py-1.5 text-sm font-medium text-slate-700 hover:bg-slate-50 disabled:opacity-60",disabled:l,children:["Edit",c.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[c.jsx("path",{d:"M12 20h9"}),c.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4 12.5-12.5z"})]})]})]}),!l&&m&&c.jsx("div",{className:"px-6 pt-4",children:c.jsx("div",{className:"rounded-lg bg-rose-50 text-rose-700 border border-rose-200 px-4 py-2 text-sm",children:m})}),c.jsx("div",{className:"px-6 pt-5",children:l?c.jsx("div",{className:"h-12 rounded-lg bg-slate-100 animate-pulse"}):g?c.jsxs("div",{className:"rounded-lg bg-green-600/95 text-white px-4 py-3 shadow-inner",children:[c.jsx("div",{className:"text-lg font-semibold",children:"Accredited"}),c.jsx("div",{className:"text-sm opacity-90",children:"You meet the criteria to be an accredited investor."})]}):c.jsxs("div",{className:"rounded-lg bg-red-700/95 text-white px-4 py-3 shadow-inner",children:[c.jsx("div",{className:"text-lg font-semibold",children:"Not Accredited"}),c.jsx("div",{className:"text-sm opacity-90",children:"You do not meet the criteria to be an accredited investor."})]})}),c.jsxs("div",{className:"px-6 py-5",children:[c.jsx("fieldset",{className:"space-y-3",children:g0e.map(w=>c.jsxs("label",{className:"flex cursor-pointer items-start gap-3",children:[c.jsx("input",{type:"radio",name:"accreditation",className:"mt-1 h-4 w-4",checked:a===w.id,onChange:()=>r&&i(w.id),disabled:!r||l}),c.jsx("span",{className:"text-slate-800",children:w.label})]},w.id))}),!r&&!l&&c.jsx("p",{className:"mt-4 text-xs text-slate-500",children:"Edit to update your accreditation. Your selection determines the banner above."})]})]})})}const ly="https://clarus.elpiscapital.com";function DM(){const[e,t]=y.useState(!1),[r,n]=y.useState(1),[a,i]=y.useState(""),[l,u]=y.useState(""),[h,d]=y.useState(""),[m,p]=y.useState(""),[v,g]=y.useState(!1),[w,b]=y.useState(""),[S,j]=y.useState(""),_=()=>{n(1),i(""),u(""),d(""),p(""),b(""),j("")},A=()=>{_(),t(!0)},k=()=>{t(!1)},O=async Ke=>{if(Ke.preventDefault(),b(""),j(""),!a.trim()){b("Email is required");return}try{g(!0);const qe=await fetch(`${ly}/api/auth/password/code/start`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a})}),it=await qe.json().catch(()=>({}));if(!qe.ok)throw new Error(it?.msg||"Unable to send code");j("If this email exists, a 6-digit code has been sent."),n(2)}catch(qe){b(qe.message||"Unable to send code")}finally{g(!1)}},C=async Ke=>{if(Ke.preventDefault(),b(""),j(""),!l.trim()){b("Verification code is required");return}try{g(!0);const qe=await fetch(`${ly}/api/auth/password/code/verify`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a,code:l})}),it=await qe.json().catch(()=>({}));if(!qe.ok)throw new Error(it?.msg||"Invalid or expired code");j("Code verified. You can now choose a new password."),n(3)}catch(qe){b(qe.message||"Invalid or expired code")}finally{g(!1)}},T=async Ke=>{if(Ke.preventDefault(),b(""),j(""),!h||!m){b("Please enter and confirm your new password.");return}if(h!==m){b("Passwords do not match.");return}try{g(!0);const qe=await fetch(`${ly}/api/auth/password/code/complete`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a,code:l,password:h,confirm:m})}),it=await qe.json().catch(()=>({}));if(!qe.ok)throw new Error(it?.msg||"Unable to update password");j("Password updated. Redirecting to login"),localStorage.removeItem("accessToken"),localStorage.removeItem("access_token"),localStorage.removeItem("token"),setTimeout(()=>{window.location.href="/login"},1e3)}catch(qe){b(qe.message||"Unable to update password")}finally{g(!1)}},[I,M]=y.useState(!1),[W,U]=y.useState(""),[F,oe]=y.useState(""),[je,ue]=y.useState(!1),[V,H]=y.useState(""),[Se,Q]=y.useState(""),z=(Ke=!1)=>{U(""),oe(""),H(""),Ke||Q(""),ue(!1)},Y=()=>{z(!1),M(!0)},P=()=>{M(!1),z(!1)},q=async Ke=>{Ke.preventDefault(),H(""),Q("");const qe=W.trim(),it=F.trim().toLowerCase();if(!qe||!it){H("Please provide both Investor Name and Investor Email.");return}try{ue(!0);const{data:Je}=await We.post("/investor/dependents/request",{investor_name:qe,investor_email:it},{headers:{"Content-Type":"application/json"}}),Fe=Je?.message||Je?.msg||"Request sent. An admin will review it shortly.";Q(Fe),z(!0)}catch(Je){H(Je?.response?.data?.error||Je?.response?.data?.message||Je.message||"Unable to send request.")}finally{ue(!1)}},[G,Z]=y.useState(!1),[fe,Oe]=y.useState(""),[Re,re]=y.useState(""),[be,Ae]=y.useState(!1),[D,Me]=y.useState(""),[ae,de]=y.useState(""),me=(Ke=!1)=>{Oe(""),re(""),Me(""),Ke||de(""),Ae(!1)},ce=()=>{me(!1),Z(!0)},ze=()=>{Z(!1),me(!1)},Qe=async Ke=>{Ke.preventDefault(),Me(""),de("");const qe=fe.trim(),it=Re.trim().toLowerCase();if(!qe||!it){Me("Please provide both Investor Name and Investor Email.");return}try{Ae(!0);const{data:Je}=await We.post("/investor/group-investor/request",{investor_name:qe,investor_email:it},{headers:{"Content-Type":"application/json"}}),Fe=Je?.message||Je?.msg||"Your request to become a Group Investor Admin has been submitted.";de(Fe),me(!0)}catch(Je){Me(Je?.response?.data?.error||Je?.response?.data?.message||Je.message||"Unable to submit request.")}finally{Ae(!1)}};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h2",{className:"text-xl font-semibold text-slate-800",children:"Settings"}),c.jsx("p",{className:"text-sm text-slate-500",children:"Manage your investor account preferences."})]}),c.jsxs("div",{className:"grid gap-6 md:grid-cols-1 max-w-2xl",children:[c.jsxs("section",{className:"rounded-xl border bg-white shadow-sm p-4 space-y-3",children:[c.jsx("h3",{className:"font-semibold text-slate-800 text-sm",children:"Security"}),c.jsx("p",{className:"text-xs text-slate-500",children:"We recommend changing your password regularly."}),c.jsx("button",{type:"button",onClick:A,className:"inline-flex items-center justify-center rounded-lg bg-indigo-600 text-white text-sm font-medium px-4 py-2 mt-2 hover:brightness-110",children:"Change password"})]}),c.jsxs("section",{className:"rounded-xl border bg-white shadow-sm p-4 space-y-3",children:[c.jsx("h3",{className:"font-semibold text-slate-800 text-sm",children:"Dependent Investors"}),c.jsx("p",{className:"text-xs text-slate-500",children:"Add an existing investor as your dependent. Your request will be reviewed and approved by an administrator."}),c.jsx("button",{type:"button",onClick:Y,className:"inline-flex items-center justify-center rounded-lg bg-sky-600 text-white text-sm font-medium px-4 py-2 mt-2 hover:brightness-110",children:"Add Dependent Investor"})]}),c.jsxs("section",{className:"rounded-xl border bg-white shadow-sm p-4 space-y-3",children:[c.jsx("h3",{className:"font-semibold text-slate-800 text-sm",children:"Group Investor"}),c.jsx("p",{className:"text-xs text-slate-500",children:"Request to become a Group Investor Admin. Enter the investor you want to include in your group. Your request will be reviewed by an administrator."}),c.jsx("button",{type:"button",onClick:ce,className:"inline-flex items-center justify-center rounded-lg bg-emerald-600 text-white text-sm font-medium px-4 py-2 mt-2 hover:brightness-110",children:"Create Group Investor"})]})]}),c.jsx("p",{className:"text-xs text-slate-400",children:"You can wire additional controls to real API endpoints as they are implemented."}),e&&c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4",children:c.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-white shadow-xl p-6 space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Change password"}),c.jsx("button",{type:"button",onClick:k,className:"text-slate-400 hover:text-slate-600 text-xl leading-none",children:""})]}),c.jsxs("p",{className:"text-xs text-slate-500",children:["Step ",r," of 3"]}),w&&c.jsx("div",{className:"rounded-md border border-rose-200 bg-rose-50 text-rose-700 px-3 py-2 text-sm",children:w}),S&&c.jsx("div",{className:"rounded-md border border-emerald-200 bg-emerald-50 text-emerald-700 px-3 py-2 text-sm",children:S}),r===1&&c.jsxs("form",{onSubmit:O,className:"space-y-4",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Email address"}),c.jsx("input",{type:"email",value:a,onChange:Ke=>i(Ke.target.value),className:"w-full rounded-lg border px-3 py-2 text-sm bg-gray-50 focus:bg-white focus:outline-none focus:ring-2 focus:ring-indigo-100 border-gray-300",placeholder:"you@example.com",required:!0})]}),c.jsx("button",{type:"submit",disabled:v,className:"w-full inline-flex items-center justify-center rounded-lg bg-indigo-600 text-white text-sm font-medium px-4 py-2 hover:brightness-110 disabled:opacity-60",children:v?"Sending code":"Send verification code"})]}),r===2&&c.jsxs("form",{onSubmit:C,className:"space-y-4",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Verification code"}),c.jsx("input",{type:"text",value:l,onChange:Ke=>u(Ke.target.value),className:"w-full rounded-lg border px-3 py-2 text-sm bg-gray-50 focus:bg-white focus:outline-none focus:ring-2 focus:ring-indigo-100 border-gray-300 tracking-[0.2em]",placeholder:"123456",required:!0}),c.jsxs("p",{className:"text-xs text-slate-500",children:["Enter the 6-digit code sent to ",c.jsx("strong",{children:a}),"."]})]}),c.jsx("button",{type:"submit",disabled:v,className:"w-full inline-flex items-center justify-center rounded-lg bg-indigo-600 text-white text-sm font-medium px-4 py-2 hover:brightness-110 disabled:opacity-60",children:v?"Verifying":"Verify code"})]}),r===3&&c.jsxs("form",{onSubmit:T,className:"space-y-4",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-sm font-medium text-slate-700",children:"New password"}),c.jsx("input",{type:"password",value:h,onChange:Ke=>d(Ke.target.value),className:"w-full rounded-lg border px-3 py-2 text-sm bg-gray-50 focus:bg-white focus:outline-none focus:ring-2 focus:ring-indigo-100 border-gray-300",required:!0})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Confirm new password"}),c.jsx("input",{type:"password",value:m,onChange:Ke=>p(Ke.target.value),className:"w-full rounded-lg border px-3 py-2 text-sm bg-gray-50 focus:bg-white focus:outline-none focus:ring-2 focus:ring-indigo-100 border-gray-300",required:!0})]}),c.jsx("button",{type:"submit",disabled:v,className:"w-full inline-flex items-center justify-center rounded-lg bg-indigo-600 text-white text-sm font-medium px-4 py-2 hover:brightness-110 disabled:opacity-60",children:v?"Updating":"Update password"})]})]})}),I&&c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4",children:c.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-white shadow-xl p-6 space-y-4",children:[c.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[c.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Add Dependent Investor"}),c.jsx("button",{type:"button",onClick:P,className:"text-slate-400 hover:text-slate-600 text-xl leading-none",children:""})]}),V&&c.jsx("div",{className:"rounded-md border border-rose-200 bg-rose-50 text-rose-700 px-3 py-2 text-sm",children:V}),Se&&c.jsx("div",{className:"rounded-md border border-emerald-200 bg-emerald-50 text-emerald-700 px-3 py-2 text-sm",children:Se}),c.jsxs("form",{onSubmit:q,className:"space-y-4",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Investor Name"}),c.jsx("input",{type:"text",className:"w-full rounded-lg border px-3 py-2 text-sm bg-gray-50 focus:bg-white focus:outline-none focus:ring-2 focus:ring-sky-100 border-gray-300",value:W,onChange:Ke=>U(Ke.target.value),placeholder:"Full name as on the account"})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Investor Email"}),c.jsx("input",{type:"email",className:"w-full rounded-lg border px-3 py-2 text-sm bg-gray-50 focus:bg-white focus:outline-none focus:ring-2 focus:ring-sky-100 border-gray-300",value:F,onChange:Ke=>oe(Ke.target.value),placeholder:"their.email@example.com"})]}),c.jsxs("div",{className:"flex justify-end gap-2",children:[c.jsx("button",{type:"button",onClick:P,className:"rounded-lg border border-slate-200 px-4 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50",children:"Cancel"}),c.jsx("button",{type:"submit",disabled:je,className:"inline-flex items-center justify-center rounded-lg bg-sky-600 text-white text-sm font-medium px-4 py-2 hover:brightness-110 disabled:opacity-60",children:je?"Sending":"Send Request"})]})]})]})}),G&&c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4",children:c.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-white shadow-xl p-6 space-y-4",children:[c.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[c.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Create Group Investor"}),c.jsx("button",{type:"button",onClick:ze,className:"text-slate-400 hover:text-slate-600 text-xl leading-none",children:""})]}),c.jsx("p",{className:"text-xs text-slate-500",children:"Enter the investor you want to include in your group. You can send multiple requests to add more investors."}),D&&c.jsx("div",{className:"rounded-md border border-rose-200 bg-rose-50 text-rose-700 px-3 py-2 text-sm",children:D}),ae&&c.jsx("div",{className:"rounded-md border border-emerald-200 bg-emerald-50 text-emerald-700 px-3 py-2 text-sm",children:ae}),c.jsxs("form",{onSubmit:Qe,className:"space-y-4",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Investor Name"}),c.jsx("input",{type:"text",className:"w-full rounded-lg border px-3 py-2 text-sm bg-gray-50 focus:bg-white focus:outline-none focus:ring-2 focus:ring-emerald-100 border-gray-300",placeholder:"Full name as on the account",value:fe,onChange:Ke=>Oe(Ke.target.value)})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Investor Email"}),c.jsx("input",{type:"email",className:"w-full rounded-lg border px-3 py-2 text-sm bg-gray-50 focus:bg-white focus:outline-none focus:ring-2 focus:ring-emerald-100 border-gray-300",placeholder:"their.email@example.com",value:Re,onChange:Ke=>re(Ke.target.value)})]}),c.jsxs("div",{className:"flex justify-end gap-2",children:[c.jsx("button",{type:"button",onClick:ze,className:"rounded-lg border border-slate-200 px-4 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50",children:"Cancel"}),c.jsx("button",{type:"submit",disabled:be,className:"inline-flex items-center justify-center rounded-lg bg-emerald-600 text-white text-sm font-medium px-4 py-2 hover:brightness-110 disabled:opacity-60",children:be?"Submitting":"Submit Request"})]})]})]})})]})}const ra={width:"1em",height:"1em",fill:"none","aria-hidden":!0},un={menu:()=>c.jsx("svg",{viewBox:"0 0 24 24",...ra,children:c.jsx("path",{d:"M4 6h16M4 12h16M4 18h16",stroke:"currentColor",strokeWidth:"2"})}),close:()=>c.jsx("svg",{viewBox:"0 0 24 24",...ra,children:c.jsx("path",{d:"M6 6l12 12M18 6l-12 12",stroke:"currentColor",strokeWidth:"2"})}),overview:()=>c.jsx("svg",{viewBox:"0 0 24 24",...ra,children:c.jsx("path",{d:"M3 12l9-7 9 7v7a2 2 0 01-2 2h-4a2 2 0 01-2-2v-3H9v3a2 2 0 01-2 2H3v-9z",stroke:"currentColor",strokeWidth:"2"})}),portfolio:()=>c.jsxs("svg",{viewBox:"0 0 24 24",...ra,children:[c.jsx("path",{d:"M3 7h18v10H3z",stroke:"currentColor",strokeWidth:"2"}),c.jsx("path",{d:"M8 7V5a2 2 0 012-2h4a2 2 0 012 2v2",stroke:"currentColor",strokeWidth:"2"})]}),statements:()=>c.jsxs("svg",{viewBox:"0 0 24 24",...ra,children:[c.jsx("path",{d:"M8 7h8M8 11h8M8 15h5",stroke:"currentColor",strokeWidth:"2"}),c.jsx("rect",{x:"4",y:"3",width:"16",height:"18",rx:"2",stroke:"currentColor",strokeWidth:"2"})]}),documents:()=>c.jsxs("svg",{viewBox:"0 0 24 24",...ra,children:[c.jsx("path",{d:"M14 3H6a2 2 0 00-2 2v14a2 2 0 002 2h8l6-6V5a2 2 0 00-2-2h-4z",stroke:"currentColor",strokeWidth:"2"}),c.jsx("path",{d:"M14 3v6h6",stroke:"currentColor",strokeWidth:"2"})]}),person:()=>c.jsxs("svg",{viewBox:"0 0 24 24",...ra,children:[c.jsx("circle",{cx:"12",cy:"8",r:"4",stroke:"currentColor",strokeWidth:"2"}),c.jsx("path",{d:"M6 20a6 6 0 0112 0",stroke:"currentColor",strokeWidth:"2"})]}),badge:()=>c.jsx("svg",{viewBox:"0 0 24 24",...ra,children:c.jsx("path",{d:"M12 3l2.5 5 5.5.8-4 3.9.9 5.6L12 16l-4.9 2.3.9-5.6-4-3.9 5.5-.8L12 3z",stroke:"currentColor",strokeWidth:"2"})}),contacts:()=>c.jsxs("svg",{viewBox:"0 0 24 24",...ra,children:[c.jsx("circle",{cx:"8",cy:"8",r:"3",stroke:"currentColor",strokeWidth:"2"}),c.jsx("path",{d:"M2 21a6 6 0 0112 0",stroke:"currentColor",strokeWidth:"2"}),c.jsx("rect",{x:"14",y:"7",width:"8",height:"10",rx:"2",stroke:"currentColor",strokeWidth:"2"})]}),group:()=>c.jsxs("svg",{viewBox:"0 0 24 24",...ra,children:[c.jsx("path",{d:"M16 11a4 4 0 10-8 0 4 4 0 008 0z",stroke:"currentColor",strokeWidth:"2"}),c.jsx("path",{d:"M3 21a7 7 0 0114 0M17 7a3 3 0 013-3 3 3 0 013 3M22 21a5 5 0 00-6-4",stroke:"currentColor",strokeWidth:"2"})]}),settings:()=>c.jsxs("svg",{viewBox:"0 0 24 24",...ra,children:[c.jsx("path",{d:"M10.3 4.3a1 1 0 011.4 0l1.1 1.1a1 1 0 00.9.27l1.5-.34a1 1 0 011.16.58l.7 1.4a1 1 0 01-.18 1.11l-1.02 1.02a1 1 0 000 1.4l1.02 1.02a1 1 0 01.18 1.11l-.7 1.4a1 1 0 01-1.16.58l-1.5-.34a1 1 0 00-.9.27l-1.1 1.1a1 1 0 01-1.4 0l-1.1-1.1a1 1 0 00-.9-.27l-1.5.34a1 1 0 01-1.16-.58l-.7-1.4a1 1 0 01-.18-1.11L6.4 13.3a1 1 0 000-1.4L5.38 10.9a1 1 0 01-.18-1.11l.7-1.4a1 1 0 011.16-.58l1.5.34a1 1 0 00.9-.27l1.1-1.1z",stroke:"currentColor",strokeWidth:"2"}),c.jsx("circle",{cx:"12",cy:"12",r:"2.5",stroke:"currentColor",strokeWidth:"2"})]}),logout:()=>c.jsxs("svg",{viewBox:"0 0 24 24",...ra,children:[c.jsx("path",{d:"M15 17l5-5-5-5M20 12H9",stroke:"currentColor",strokeWidth:"2"}),c.jsx("path",{d:"M4 4h6a2 2 0 012 2v2",stroke:"currentColor",strokeWidth:"2"}),c.jsx("path",{d:"M12 16v2a2 2 0 01-2 2H4",stroke:"currentColor",strokeWidth:"2"})]}),bell:()=>c.jsxs("svg",{viewBox:"0 0 24 24",...ra,children:[c.jsx("path",{d:"M12 3a4 4 0 00-4 4v2.1c0 .5-.2 1-.6 1.3L6 12.5V14h12v-1.5l-1.4-2.1a1.7 1.7 0 01-.6-1.3V7a4 4 0 00-4-4z",stroke:"currentColor",strokeWidth:"2"}),c.jsx("path",{d:"M10 18a2 2 0 004 0",stroke:"currentColor",strokeWidth:"2"})]})},y0e="w-full text-left px-3 py-2 rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-sky-400 flex items-center gap-2 text-sm leading-5",b0e="hover:bg-sky-50 text-slate-700",w0e="bg-sky-100 text-sky-700";function S0e(){const{user:e,logout:t}=y.useContext(mi);if(e===void 0)return c.jsx("p",{className:"p-6",children:"Loading dashboard"});const[r,n]=y.useState(!0),a=typeof window<"u"&&localStorage.getItem("investor.selectedTab")||"accreditation",[i,l]=y.useState(a),[u,h]=y.useState(null),[d,m]=y.useState(""),[p,v]=y.useState({investor_type:null,parent_investor_id:null,dependents:[]}),[g,w]=y.useState(!1),S=(e?.user_type||"").toString().replace(/\s+/g,"").toLowerCase()==="groupadmin",j=(e?.full_name||"").trim().split(/\s+/)[0]||"",[_,A]=y.useState(!1),[k,O]=y.useState(0),[C,T]=y.useState([]),[I,M]=y.useState(!1),[W,U]=y.useState("");y.useEffect(()=>{let Y=!0;return(async()=>{m("");try{const{data:P}=await We.get("/api/investor/accreditation",{headers:{Accept:"application/json"}});if(!Y)return;const q=!!(P&&P.selection&&P.selection!=="not_yet");h(q),l(q?localStorage.getItem("investor.selectedTab")||"overview":"accreditation")}catch(P){if(!Y)return;h(!1),l("accreditation"),m(P?.response?.data?.error||(P?.response?`Accreditation check failed (${P.response.status})`:"Unable to check accreditation."))}})(),()=>{Y=!1}},[]),y.useEffect(()=>{let Y=!0;return(async()=>{try{const{data:P}=await We.get("/api/investor/me",{headers:{Accept:"application/json"}});if(!Y)return;v({investor_type:P?.investor_type??null,parent_investor_id:P?.parent_investor_id??null,dependents:Array.isArray(P?.dependents)?P.dependents:[]})}finally{Y&&w(!0)}})(),()=>{Y=!1}},[]);const F=y.useMemo(()=>{const Y=String(p.investor_type||"").trim().toLowerCase(),P=p.parent_investor_id!==null&&p.parent_investor_id!==void 0;return Y.startsWith("depend")||P},[p.investor_type,p.parent_investor_id]),oe=y.useMemo(()=>Array.isArray(p.dependents)&&p.dependents.length>0,[p.dependents]);y.useEffect(()=>{g&&F&&i!=="portfolio"&&l("portfolio")},[g,F,i]),y.useEffect(()=>(g&&F&&p.parent_investor_id&&i==="portfolio"?We.defaults.headers.common["X-View-As-Investor"]=String(p.parent_investor_id):delete We.defaults.headers.common["X-View-As-Investor"],()=>{delete We.defaults.headers.common["X-View-As-Investor"]}),[g,F,p.parent_investor_id,i]),y.useEffect(()=>{if(g&&F){const Y=localStorage.getItem("investor.selectedTab");Y&&Y!=="portfolio"&&localStorage.removeItem("investor.selectedTab")}},[g,F]),y.useEffect(()=>{(i==="accreditation"||u===!0)&&localStorage.setItem("investor.selectedTab",i)},[i,u]);const je=Y=>{try{const P=!!Y&&(Y.name||Y.investor_name||Y.full_name),q=Y&&(Y.name||Y.investor_name||Y.full_name)||"",G=(Y&&(Y.investor_id??Y.id??Y.investorId))??null;if(P&&q?(localStorage.setItem("investorHint",q),G!=null?localStorage.setItem("currentInvestorId",String(G)):localStorage.removeItem("currentInvestorId")):(localStorage.removeItem("investorHint"),localStorage.removeItem("currentInvestorId")),typeof window<"u"&&window.location){const Z=new URL(window.location.href);P&&q?(Z.searchParams.set("investor",q),G!=null?Z.searchParams.set("investorId",String(G)):Z.searchParams.delete("investorId")):(Z.searchParams.delete("investor"),Z.searchParams.delete("investorId")),window.history.replaceState({},"",Z.toString())}}catch{}};y.useEffect(()=>{let Y=!0;const P=async()=>{try{const{data:G}=await We.get("/api/notifications/unread-count",{headers:{Accept:"application/json"}});if(!Y)return;O(G?.count||0)}catch{if(!Y)return}};P();const q=setInterval(P,6e4);return()=>{Y=!1,clearInterval(q)}},[]);const ue=async()=>{M(!0),U("");try{const{data:Y}=await We.get("/api/notifications",{headers:{Accept:"application/json"}});T(Array.isArray(Y)?Y:[])}catch(Y){U(Y?.response?.data?.error||Y?.message||"Unable to load notifications.")}finally{M(!1)}},V=()=>{const Y=!_;A(Y),Y&&ue()},H=async()=>{const Y=C.filter(P=>!P.read_at).map(P=>P.id);if(!Y.length){O(0);return}try{await We.post("/api/notifications/mark-read",{ids:Y},{headers:{"Content-Type":"application/json"}}),T(P=>P.map(q=>q.read_at?q:{...q,read_at:new Date().toISOString()})),O(0)}catch(P){U(P?.response?.data?.error||P?.message||"Failed to mark notifications as read.")}},Se=y.useMemo(()=>{if(g&&F)return[{title:"INVESTMENTS",items:[{id:"portfolio",label:"Portfolio",icon:un.portfolio}]},{title:"ACCOUNT",items:[{id:"logout",label:"Logout",icon:un.logout}]}];const Y=[{id:"overview",label:"Overview",icon:un.overview}],P=[{id:"portfolio",label:"Portfolio",icon:un.portfolio}];if(S){const fe=j?`${j}'s Group`:"My Group";P.push({id:"group-members",label:fe,icon:un.group})}P.push({id:"statements",label:"Statements",icon:un.statements},{id:"documents",label:"Documents",icon:un.documents});const q=[{id:"personalinformation",label:"Personal Information",icon:un.person},{id:"accreditation",label:"Accreditation",icon:un.badge},{id:"contacts",label:"Contacts",icon:un.contacts},{id:"settings",label:"Settings",icon:un.settings}],Z=g&&!F&&oe?[{title:"DEPENDENT",items:[{id:"dependents",label:"Dependent",icon:un.group}]}]:[];return[{title:"DASHBOARD",items:Y},{title:"INVESTMENTS",items:P},{title:"PROFILE",items:q},...Z,{title:"ACCOUNT",items:[{id:"logout",label:"Logout",icon:un.logout}]}]},[g,F,oe,S,j]),Q=Y=>{if(Y==="logout"){t();return}if(g&&F&&Y!=="portfolio")return;if(u===!1&&!F&&Y!=="accreditation"){l("accreditation");return}if(!(Y==="dependents"&&!(g&&!F&&oe))){if(l(Y),Y!=="group-members"){try{localStorage.removeItem("investorHint"),localStorage.removeItem("currentInvestorId")}catch{}if(typeof window<"u"&&window.location)try{const q=new URL(window.location.href);q.searchParams.delete("investor"),q.searchParams.delete("investorId"),window.history.replaceState({},"",q.toString())}catch{}}window?.matchMedia&&window.matchMedia("(max-width: 1023px)").matches&&n(!1)}},z=Y=>g&&F?Y!=="portfolio"&&Y!=="logout":u===!1&&Y!=="accreditation"&&Y!=="logout";return c.jsxs("div",{className:"min-h-screen bg-slate-100 flex flex-col",children:[c.jsxs("header",{className:"flex items-center justify-between gap-3 bg-white border-b px-3 sm:px-4 md:px-6 py-3 sticky top-0 z-40",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("button",{type:"button",className:"inline-flex items-center justify-center p-2 rounded-md border border-slate-300 text-slate-700 hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-sky-500",onClick:()=>n(Y=>!Y),"aria-label":r?"Close menu":"Open menu",children:r?c.jsx(un.close,{}):c.jsx(un.menu,{})}),c.jsx("h1",{className:"text-base sm:text-lg md:text-2xl font-semibold text-blue-600",children:"Investor Panel"})]}),c.jsx("div",{className:"flex items-center gap-3",children:c.jsxs("div",{className:"relative",children:[c.jsxs("button",{type:"button",onClick:V,className:"relative inline-flex items-center justify-center rounded-full border border-slate-300 bg-white p-2 text-slate-600 hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-sky-500","aria-label":"Investor notifications",children:[c.jsx(un.bell,{}),k>0&&c.jsx("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center rounded-full bg-rose-500 px-1.5 py-0.5 text-[10px] font-semibold text-white",children:k>9?"9+":k})]}),_&&c.jsxs("div",{className:"absolute right-0 mt-2 w-72 rounded-xl border border-slate-200 bg-white shadow-lg z-[100]",children:[c.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b border-slate-100",children:[c.jsx("span",{className:"text-xs font-semibold text-slate-600",children:"Notifications"}),c.jsx("button",{type:"button",onClick:H,className:"text-[11px] text-sky-600 hover:underline",children:"Mark all read"})]}),c.jsx("div",{className:"max-h-72 overflow-y-auto",children:I?c.jsx("div",{className:"px-3 py-3 text-xs text-slate-500",children:"Loading"}):W?c.jsx("div",{className:"px-3 py-3 text-xs text-rose-600",children:W}):C.length?C.map(Y=>c.jsxs("div",{className:`px-3 py-2 text-xs border-b border-slate-50 last:border-0 ${Y.read_at?"":"bg-slate-50"}`,children:[c.jsx("div",{className:"font-semibold text-slate-700",children:Y.title||"Notification"}),Y.message&&c.jsx("div",{className:"mt-0.5 text-slate-600",children:Y.message}),c.jsxs("div",{className:"mt-0.5 flex justify-between items-center text-[10px] text-slate-400",children:[c.jsx("span",{children:Y.created_at?new Date(Y.created_at).toLocaleString():""}),Y.link_url&&c.jsx("a",{href:Y.link_url,target:"_blank",rel:"noreferrer",className:"text-sky-600 hover:underline",children:"View"})]})]},Y.id)):c.jsx("div",{className:"px-3 py-3 text-xs text-slate-500",children:"No notifications yet."})})]})]})})]}),g&&F&&i==="portfolio"&&c.jsx("div",{className:"bg-sky-50 text-sky-800 border-b border-sky-200 px-4 py-2 text-sm",children:"You are a dependent investor. This Portfolio shows your parent investors data."}),c.jsxs("div",{className:"flex-1 flex relative",children:[r&&c.jsx("div",{className:"fixed inset-0 bg-black/25 z-30 lg:hidden",onClick:()=>n(!1),"aria-hidden":"true"}),c.jsx("aside",{className:["fixed lg:static z-40 lg:z-0 inset-y-0 left-0 w-60 bg-white border-r","transform transition-transform duration-200 ease-in-out",r?"translate-x-0":"-translate-x-full"].join(" "),"aria-label":"Sidebar navigation",children:c.jsx("nav",{className:"h-full overflow-y-auto px-3 py-4 space-y-6",children:Se.map(Y=>c.jsxs("div",{children:[c.jsx("div",{className:"font-semibold text-slate-400 uppercase text-[11px] tracking-wide mb-2",children:Y.title}),c.jsx("ul",{className:"space-y-1",children:Y.items.map(P=>{const q=i===P.id,G=z(P.id),Z=P.icon;return c.jsx("li",{children:c.jsxs("button",{className:`${y0e} ${q?w0e:b0e} ${G?"opacity-50 cursor-not-allowed":""}`,onClick:()=>G?null:Q(P.id),"aria-disabled":G?"true":"false",title:G?"Not available for this account":P.label,children:[c.jsx("span",{className:"shrink-0 leading-none inline-flex items-center",children:c.jsx(Z,{})}),c.jsx("span",{className:"truncate",children:P.label})]})},P.id)})})]},Y.title))})}),c.jsxs("main",{className:"flex-1 px-3 sm:px-4 md:px-6 lg:px-8 py-4 z-10",children:[!F&&u===!1&&c.jsxs("div",{className:"mb-4 rounded-lg border border-amber-200 bg-amber-50 text-amber-800 px-4 py-3 text-sm",children:["Please complete your ",c.jsx("strong",{children:"Accreditation"})," to access the rest of the dashboard."]}),d&&c.jsx("div",{className:"mb-4 rounded-lg border border-rose-200 bg-rose-50 text-rose-700 px-4 py-3 text-sm",children:d}),c.jsxs("div",{className:"w-full",children:[!F&&i==="overview"&&c.jsx(mS,{}),i==="portfolio"&&c.jsx(pS,{}),!F&&S&&i==="group-members"&&c.jsx(j0e,{onSelectInvestor:je}),!F&&i==="statements"&&c.jsx(xS,{}),!F&&i==="documents"&&c.jsx(gS,{}),!F&&i==="personalinformation"&&c.jsx(yS,{}),!F&&i==="contacts"&&c.jsx(bS,{}),!F&&i==="settings"&&c.jsx(DM,{}),i==="accreditation"&&!F&&c.jsx(OM,{onAccredited:h}),!F&&oe&&i==="dependents"&&c.jsx(N0e,{})]})]})]})]})}const E0e=[{id:"overview",label:"Overview"},{id:"portfolio",label:"Portfolio"},{id:"statements",label:"Statements"},{id:"documents",label:"Documents"},{id:"personalinformation",label:"Personal Information"},{id:"accreditation",label:"Accreditation"},{id:"contacts",label:"Contacts"},{id:"settings",label:"Settings"}],j0e=({onSelectInvestor:e})=>{const[t,r]=y.useState(!0),[n,a]=y.useState(null),[i,l]=y.useState([]),[u,h]=y.useState(null),[d,m]=y.useState("overview");y.useEffect(()=>{(async()=>{try{r(!0),a(null);const{data:w}=await We.get("/api/group-admin/my-group",{headers:{Accept:"application/json"}}),b=w||{},j=(Array.isArray(b.members)?b.members:Array.isArray(b.investors)?b.investors:[]).map(_=>({id:_.id??_.investor_id,investor_id:_.id??_.investor_id,name:_.name,email:_.email,added_at:_.added_at||null}));l(j)}catch(w){a(w?.response?.data?.error||w?.message||"Failed to load group investors.")}finally{r(!1)}})()},[]);const p=g=>{h(g),m("overview"),e&&e(g)},v=()=>{h(null),m("overview"),e&&e(null)};return t?c.jsx("p",{className:"text-sm text-slate-600",children:"Loading group investors"}):n?c.jsx("div",{className:"rounded-md border border-rose-100 bg-rose-50 px-4 py-3 text-sm text-rose-700",children:n}):i.length?u?c.jsxs("div",{className:"rounded-xl border border-slate-100 bg-white",children:[c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2 border-b border-slate-100 px-4 py-3",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-xs font-semibold text-sky-700 uppercase tracking-wide",children:"Viewing child investor"}),c.jsx("div",{className:"text-base font-semibold text-slate-900",children:u.name}),c.jsx("div",{className:"text-xs text-slate-500",children:u.email})]}),c.jsx("button",{type:"button",onClick:v,className:"inline-flex items-center px-3 py-1.5 rounded-lg border border-slate-300 text-xs font-semibold text-slate-700 bg-white hover:bg-slate-50",children:" Back to investor list"})]}),c.jsx("div",{className:"border-b border-slate-100 flex flex-wrap items-center gap-1 px-4 pt-2",children:E0e.map(g=>c.jsx("button",{type:"button",onClick:()=>m(g.id),className:`px-3 py-2 text-xs sm:text-sm border-b-2 -mb-px transition ${d===g.id?"border-sky-500 text-sky-700 font-semibold":"border-transparent text-slate-500 hover:text-slate-700"}`,children:g.label},g.id))}),c.jsxs("div",{className:"p-4 sm:p-6",children:[d==="overview"&&c.jsx(mS,{}),d==="portfolio"&&c.jsx(pS,{}),d==="statements"&&c.jsx(xS,{}),d==="documents"&&c.jsx(gS,{}),d==="personalinformation"&&c.jsx(yS,{}),d==="accreditation"&&c.jsx(OM,{}),d==="contacts"&&c.jsx(bS,{}),d==="settings"&&c.jsx(DM,{})]})]}):c.jsxs("div",{className:"rounded-xl border border-slate-100 bg-white p-4 space-y-3",children:[c.jsx("h2",{className:"text-sm sm:text-base font-semibold text-slate-800",children:"Investors in your group"}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full text-left text-xs sm:text-sm",children:[c.jsx("thead",{className:"border-b border-slate-100 text-slate-500",children:c.jsxs("tr",{children:[c.jsx("th",{className:"py-2 pr-4 font-medium",children:"Name"}),c.jsx("th",{className:"py-2 px-4 font-medium",children:"Email"}),c.jsx("th",{className:"py-2 px-4 font-medium",children:"Added"})]})}),c.jsx("tbody",{className:"divide-y divide-slate-50",children:i.map(g=>c.jsxs("tr",{children:[c.jsx("td",{className:"py-2 pr-4 text-slate-800",children:c.jsx("button",{type:"button",onClick:()=>p(g),className:"text-sky-700 hover:underline",children:g.name})}),c.jsx("td",{className:"py-2 px-4 text-sky-700",children:g.email}),c.jsx("td",{className:"py-2 px-4 text-slate-500",children:g.added_at?new Date(g.added_at).toLocaleDateString():""})]},g.investor_id??g.id))})]})})]}):c.jsx("div",{className:"rounded-md border border-slate-100 bg-white px-4 py-3 text-sm text-slate-600",children:"No investors have been added to your group yet."})};function N0e(){const[e,t]=y.useState([]),[r,n]=y.useState(!0),[a,i]=y.useState(""),[l,u]=y.useState({}),[h,d]=y.useState({type:"",msg:""});y.useEffect(()=>{m()},[]);const m=async()=>{i(""),n(!0);try{const{data:v}=await We.get("/api/investors/dependents",{headers:{Accept:"application/json"}}),g=Array.isArray(v)?v:Array.isArray(v?.items)?v.items:Array.isArray(v?.data)?v.data:[];t(g)}catch(v){i(v?.response?.data?.error||v?.message||"Unable to load dependents.")}finally{n(!1)}},p=async v=>{if(v){u(g=>({...g,[v]:!0})),d({type:"",msg:""});try{await We.post("/api/deletion-requests",{investor_id:v},{headers:{"Content-Type":"application/json"}}),t(g=>g.map(w=>w.id===v?{...w,delete_request_status:"pending"}:w)),d({type:"success",msg:"Delete request sent to admin."})}catch(g){d({type:"error",msg:g?.response?.data?.error||g?.message||"Request failed."})}finally{u(g=>({...g,[v]:!1})),setTimeout(()=>d({type:"",msg:""}),3500)}}};return c.jsxs("div",{className:"space-y-4",children:[c.jsx("h2",{className:"text-lg font-semibold",children:"Dependent Accounts"}),h.msg&&c.jsx("div",{className:`rounded-lg border px-4 py-3 text-sm ${h.type==="success"?"border-emerald-200 bg-emerald-50 text-emerald-800":"border-rose-200 bg-rose-50 text-rose-700"}`,children:h.msg}),a&&c.jsx("div",{className:"rounded-lg border border-rose-200 bg-rose-50 text-rose-700 px-4 py-3 text-sm",children:a}),r?c.jsx("div",{className:"rounded-lg border p-6 text-sm text-slate-600",children:"Loading"}):e.length===0?c.jsx("div",{className:"rounded-lg border p-6 text-sm text-slate-600",children:"No dependent accounts found."}):c.jsx("div",{className:"overflow-x-auto rounded-lg border",children:c.jsxs("table",{className:"min-w-full text-left text-sm",children:[c.jsx("thead",{className:"bg-gray-50 text-gray-700",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-3 font-medium",children:"Investor"}),c.jsx("th",{className:"px-4 py-3 font-medium",children:"Email"}),c.jsx("th",{className:"px-4 py-3 font-medium",children:"Type"}),c.jsx("th",{className:"px-4 py-3 font-medium",children:"Relation"}),c.jsx("th",{className:"px-4 py-3 font-medium",children:"Delete Request"})]})}),c.jsx("tbody",{className:"divide-y",children:e.map(v=>{const g=(v.delete_request_status||"").toLowerCase(),w=!!l[v.id],b=v.parent_relationship||v.relationship||"";return c.jsxs("tr",{children:[c.jsx("td",{className:"px-4 py-3",children:v.name||""}),c.jsx("td",{className:"px-4 py-3",children:v.email||""}),c.jsx("td",{className:"px-4 py-3",children:v.investor_type||"Depends"}),c.jsx("td",{className:"px-4 py-3",children:b}),c.jsx("td",{className:"px-4 py-3",children:g==="pending"?c.jsx("span",{className:"inline-flex items-center rounded-full border border-amber-200 bg-amber-50 px-2 py-0.5 text-xs text-amber-900",children:"Pending"}):g==="approved"?c.jsx("span",{className:"inline-flex items-center rounded-full border border-emerald-200 bg-emerald-50 px-2 py-0.5 text-xs text-emerald-900",children:"Approved"}):g==="rejected"?c.jsx("span",{className:"inline-flex items-center rounded-full border border-rose-200 bg-rose-50 px-2 py-0.5 text-xs text-rose-700",children:"Rejected"}):c.jsx("button",{onClick:()=>p(v.id),disabled:w,className:"rounded-lg border px-2.5 py-1 text-xs hover:bg-gray-50 disabled:opacity-60",title:"Ask admin to remove this dependent account",children:w?"Sending":"Request delete"})})]},v.id||v.investor_id)})})]})})]})}const al={name:"Antigravity Fund 1",status:"ACTIVE",date:"June 5th, 2023",committedCapital:"$1,000,000",calledSoFar:"$100,000",fundsAvailable:"$90,000",leftToCall:"$900,000",investments:[{company:"Brex",currentValue:"$1,345,223",initialInvestment:"$1,000,000",lastUpdated:"1/11/23",positive:!0},{company:"Cardless",currentValue:"$100,000",initialInvestment:"$100,000",lastUpdated:"2/17/23",positive:!0},{company:"Kaycakes",currentValue:"$432,567",initialInvestment:"$600,000",lastUpdated:"2/14/23",positive:!1},{company:"Pipe",currentValue:"$710,436",initialInvestment:"$800,000",lastUpdated:"10/02/23",positive:!1}]},A0e=[{date:"5/10/23",value:"$78,000",doc:"Statement.pdf"},{date:"2/12/22",value:"$92,000",doc:"Statement.pdf"},{date:"7/19/21",value:"$100,000",doc:"Statement.pdf"}],pf=({icon:e,label:t,active:r,onClick:n})=>c.jsxs("button",{onClick:n,className:`flex items-center gap-3 w-full px-3 py-2 rounded-md text-sm font-medium transition
      ${r?"bg-blue-100 text-blue-700":"text-gray-700 hover:bg-blue-50 hover:text-blue-600"}`,children:[e,t]});function _0e(){const[e,t]=y.useState(!1),[r,n]=y.useState("Fund"),a=Fi();return c.jsxs("div",{className:"flex min-h-screen bg-gray-50",children:[c.jsxs("aside",{className:"w-64 bg-white border-r border-gray-200 shadow-sm flex flex-col justify-between",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"p-5 border-b border-gray-100 text-center",children:[c.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Opportunity Fund"}),c.jsx("p",{className:"text-md text-gray-500",children:"Dashboard"})]}),c.jsxs("nav",{className:"flex flex-col p-4 space-y-1",children:[c.jsx(pf,{icon:c.jsx($b,{size:18}),label:"Fund",active:r==="Fund",onClick:()=>n("Fund")}),c.jsx(pf,{icon:c.jsx(QC,{size:18}),label:"Lead",active:r==="Lead",onClick:()=>n("Lead")}),c.jsx(pf,{icon:c.jsx(jf,{size:18}),label:"Documents",active:r==="Documents",onClick:()=>n("Documents")}),c.jsx(pf,{icon:c.jsx(Nf,{size:18}),label:"Profiles & Teams",active:r==="Profiles & Teams",onClick:()=>n("Profiles & Teams")}),c.jsx(pf,{icon:c.jsx(XC,{size:18}),label:"Tax Center",active:r==="Tax Center",onClick:()=>n("Tax Center")})]})]}),c.jsxs("div",{className:"p-4 border-t border-gray-200 space-y-2",children:[c.jsxs("button",{onClick:()=>a("/admin-dashboard"),className:"flex items-center gap-2 text-gray-600 hover:text-blue-600 w-full text-sm",children:[c.jsx(ZC,{size:16})," Back to Admin Panel"]}),c.jsxs("button",{onClick:()=>a("/login"),className:"flex items-center gap-2 text-red-500 hover:text-red-700 w-full text-sm",children:[c.jsx(Wm,{size:16})," Logout"]})]})]}),c.jsxs("main",{className:"flex-1 p-8 space-y-8",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("span",{className:"text-sm bg-green-100 text-green-700 px-2 py-1 rounded",children:al.status}),c.jsx("h1",{className:"text-2xl font-bold mt-2",children:al.name}),c.jsx("p",{className:"text-gray-500",children:al.date})]}),c.jsxs("div",{className:"space-x-2",children:[c.jsx("button",{className:"px-4 py-2 bg-gray-900 text-white rounded",children:"Start Investment"}),c.jsx("button",{className:"px-4 py-2 bg-gray-200 rounded",children:"Call Capital"})]})]}),r==="Fund"&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"grid grid-cols-4 gap-4 bg-white shadow rounded-lg p-4",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-500",children:"Committed Capital"}),c.jsx("p",{className:"text-lg font-semibold",children:al.committedCapital})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-500",children:"Called So Far"}),c.jsx("p",{className:"text-lg font-semibold",children:al.calledSoFar})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-500",children:"Funds Available"}),c.jsx("p",{className:"text-lg font-semibold",children:al.fundsAvailable})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-500",children:"Left to Call"}),c.jsx("p",{className:"text-lg font-semibold",children:al.leftToCall})]})]}),c.jsxs("div",{className:"bg-white shadow rounded-lg p-4",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("h2",{className:"text-xl font-semibold",children:"Fund Investments"}),c.jsx("input",{type:"text",placeholder:"Search",className:"border rounded px-2 py-1 text-sm"})]}),c.jsxs("table",{className:"min-w-full border text-center",children:[c.jsx("thead",{children:c.jsxs("tr",{className:"bg-gray-50 text-center",children:[c.jsx("th",{className:"p-2 border ",children:"Company"}),c.jsx("th",{className:"p-2 border",children:"Current Value"}),c.jsx("th",{className:"p-2 border",children:"Initial Investment"}),c.jsx("th",{className:"p-2 border",children:"Last Updated"}),c.jsx("th",{className:"p-2 border",children:"Action"})]})}),c.jsx("tbody",{children:al.investments.map((i,l)=>c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsx("td",{className:"p-2 border",children:i.company}),c.jsx("td",{className:`p-2 border font-medium ${i.positive?"text-green-600":"text-red-600"}`,children:i.currentValue}),c.jsx("td",{className:"p-2 border",children:i.initialInvestment}),c.jsx("td",{className:"p-2 border",children:i.lastUpdated}),c.jsx("td",{className:"p-2 border text-blue-600 cursor-pointer",onClick:()=>t(!0),children:"View"})]},l))})]})]})]}),r!=="Fund"&&c.jsxs("div",{className:"bg-white p-6 rounded shadow text-gray-600",children:[c.jsx("h2",{className:"text-xl font-semibold mb-2",children:r}),c.jsxs("p",{children:['Content for the "',r,'" section will go here.']})]})]}),e&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex justify-center items-center",children:c.jsxs("div",{className:"bg-white rounded-lg p-6 w-96 shadow-lg",children:[c.jsxs("div",{className:"flex justify-between mb-4",children:[c.jsx("h3",{className:"text-lg font-bold",children:"Kaycakes history"}),c.jsx("button",{onClick:()=>t(!1),className:"text-gray-500 hover:text-gray-700",children:"X"})]}),c.jsxs("table",{className:"w-full border",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"p-2 border",children:"Date"}),c.jsx("th",{className:"p-2 border",children:"Value"}),c.jsx("th",{className:"p-2 border",children:"Docs"})]})}),c.jsx("tbody",{children:A0e.map((i,l)=>c.jsxs("tr",{children:[c.jsx("td",{className:"p-2 border",children:i.date}),c.jsx("td",{className:"p-2 border text-red-600",children:i.value}),c.jsx("td",{className:"p-2 border text-blue-600 cursor-pointer",children:i.doc})]},l))})]}),c.jsx("div",{className:"text-right mt-4",children:c.jsx("button",{onClick:()=>t(!1),className:"bg-gray-900 text-white px-4 py-2 rounded",children:"Close"})})]})})]})}const il={name:"General Partner Fund ",status:"ACTIVE",committedCapital:"$6,000,000",calledSoFar:"$100,000",fundsAvailable:"$30,000",leftToCall:"$90,000",investments:[{company:"Brex",currentValue:"$1,345,223",initialInvestment:"$1,000,000",lastUpdated:"1/11/23",positive:!0},{company:"Cardless",currentValue:"$100,000",initialInvestment:"$100,000",lastUpdated:"2/17/23",positive:!0},{company:"Kaycakes",currentValue:"$432,567",initialInvestment:"$600,000",lastUpdated:"2/14/23",positive:!1},{company:"Pipe",currentValue:"$710,436",initialInvestment:"$800,000",lastUpdated:"10/02/23",positive:!1}]},T0e=[{date:"5/10/23",value:"$78,000",doc:"Statement.pdf"},{date:"2/12/22",value:"$92,000",doc:"Statement.pdf"},{date:"7/19/21",value:"$100,000",doc:"Statement.pdf"}],xf=({icon:e,label:t,active:r,onClick:n})=>c.jsxs("button",{onClick:n,className:`flex items-center gap-3 w-full px-3 py-2 rounded-md text-sm font-medium transition ${r?"bg-blue-100 text-blue-700":"text-gray-700 hover:bg-blue-50 hover:text-blue-600"}`,children:[e,t]});function k0e(){const[e,t]=y.useState(!1),[r,n]=y.useState("Fund"),a=Fi(),{user:i}=y.useContext(mi);return c.jsxs("div",{className:"flex min-h-screen bg-gray-50",children:[c.jsxs("aside",{className:"w-64 bg-white border-r border-gray-200 shadow-sm flex flex-col justify-between",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"p-5 border-b border-gray-100 text-center",children:[c.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"General Partner"}),c.jsx("p",{className:"text-md text-gray-500",children:"Dashboard"})]}),c.jsxs("nav",{className:"flex flex-col p-4 space-y-1",children:[c.jsx(xf,{icon:c.jsx($b,{size:18}),label:"Fund",active:r==="Fund",onClick:()=>n("Fund")}),c.jsx(xf,{icon:c.jsx(QC,{size:18}),label:"Lead",active:r==="Lead",onClick:()=>n("Lead")}),c.jsx(xf,{icon:c.jsx(jf,{size:18}),label:"Documents",active:r==="Documents",onClick:()=>n("Documents")}),c.jsx(xf,{icon:c.jsx(Nf,{size:18}),label:"Profiles & Teams",active:r==="Profiles & Teams",onClick:()=>n("Profiles & Teams")}),c.jsx(xf,{icon:c.jsx(XC,{size:18}),label:"Tax Center",active:r==="Tax Center",onClick:()=>n("Tax Center")})]})]}),i&&c.jsxs("div",{className:"p-4 border-t border-gray-200 space-y-2",children:[c.jsxs("button",{onClick:()=>a("/admin-dashboard"),className:"flex items-center gap-2 text-gray-800 hover:text-blue-600 w-full text-md",children:[c.jsx(ZC,{size:18})," Back to Admin Panel"]}),c.jsxs("button",{onClick:()=>a("/login"),className:"flex items-center gap-2 text-red-500 hover:text-red-700 w-full text-sm",children:[c.jsx(Wm,{size:16})," Logout"]})]})]}),c.jsxs("main",{className:"flex-1 p-8 space-y-8",children:[c.jsx("div",{className:"flex items-center justify-between",children:c.jsxs("div",{children:[c.jsx("span",{className:"text-sm bg-green-100 text-green-700 px-2 py-1 rounded",children:il.status}),c.jsx("h1",{className:"text-2xl font-bold mt-2",children:il.name}),c.jsx("p",{className:"text-gray-500",children:il.date})]})}),r==="Fund"&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"grid grid-cols-4 gap-4 bg-white shadow rounded-lg p-4",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-500",children:"Committed Capital"}),c.jsx("p",{className:"text-lg font-semibold",children:il.committedCapital})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-500",children:"Called So Far"}),c.jsx("p",{className:"text-lg font-semibold",children:il.calledSoFar})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-500",children:"Funds Available"}),c.jsx("p",{className:"text-lg font-semibold",children:il.fundsAvailable})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-500",children:"Left to Call"}),c.jsx("p",{className:"text-lg font-semibold",children:il.leftToCall})]})]}),c.jsxs("div",{className:"bg-white shadow rounded-lg p-4",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("h2",{className:"text-xl font-semibold",children:"Fund Investments"}),c.jsx("input",{type:"text",placeholder:"Search",className:"border rounded px-2 py-1 text-sm"})]}),c.jsxs("table",{className:"min-w-full border text-center",children:[c.jsx("thead",{children:c.jsxs("tr",{className:"bg-gray-50 text-center",children:[c.jsx("th",{className:"p-2 border",children:"Company"}),c.jsx("th",{className:"p-2 border",children:"Current Value"}),c.jsx("th",{className:"p-2 border",children:"Initial Investment"}),c.jsx("th",{className:"p-2 border",children:"Last Updated"}),c.jsx("th",{className:"p-2 border",children:"Action"})]})}),c.jsx("tbody",{children:il.investments.map((l,u)=>c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsx("td",{className:"p-2 border",children:l.company}),c.jsx("td",{className:`p-2 border font-medium ${l.positive?"text-green-600":"text-red-600"}`,children:l.currentValue}),c.jsx("td",{className:"p-2 border",children:l.initialInvestment}),c.jsx("td",{className:"p-2 border",children:l.lastUpdated}),c.jsx("td",{className:"p-2 border text-blue-600 cursor-pointer",onClick:()=>t(!0),children:"View"})]},u))})]})]})]}),r!=="Fund"&&c.jsxs("div",{className:"bg-white p-6 rounded shadow text-gray-600",children:[c.jsx("h2",{className:"text-xl font-semibold mb-2",children:r}),c.jsxs("p",{children:['Content for the "',r,'" section will go here.']})]})]}),e&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex justify-center items-center",children:c.jsxs("div",{className:"bg-white rounded-lg p-6 w-96 shadow-lg",children:[c.jsxs("div",{className:"flex justify-between mb-4",children:[c.jsx("h3",{className:"text-lg font-bold",children:"Company History"}),c.jsx("button",{onClick:()=>t(!1),className:"text-gray-500 hover:text-gray-700",children:"X"})]}),c.jsxs("table",{className:"w-full border",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"p-2 border",children:"Date"}),c.jsx("th",{className:"p-2 border",children:"Value"}),c.jsx("th",{className:"p-2 border",children:"Docs"})]})}),c.jsx("tbody",{children:T0e.map((l,u)=>c.jsxs("tr",{children:[c.jsx("td",{className:"p-2 border",children:l.date}),c.jsx("td",{className:"p-2 border text-red-600",children:l.value}),c.jsx("td",{className:"p-2 border text-blue-600 cursor-pointer",children:l.doc})]},u))})]}),c.jsx("div",{className:"text-right mt-4",children:c.jsx("button",{onClick:()=>t(!1),className:"bg-gray-900 text-white px-4 py-2 rounded",children:"Close"})})]})})]})}function aC(){const[e]=SC(),t=e.get("token"),r=Fi(),[n,a]=y.useState(!0),[i,l]=y.useState(""),[u,h]=y.useState(""),[d,m]=y.useState({first_name:"",last_name:"",birthdate:"",citizenship:"",email:"",phone:"",ssn:"",emergency_contact:"",address1:"",address2:"",country:"",city:"",state:"",zip:"",password:""}),p=y.useMemo(()=>{const b=(d.first_name||"").trim()[0]||"",S=(d.last_name||"").trim()[0]||"";return(b+S||"A").toUpperCase()},[d.first_name,d.last_name]);y.useEffect(()=>{if(!t){l("Invite token missing."),a(!1);return}(async()=>{try{const{data:b}=await We.get(`/admin/invite/${t}`),S=(b?.name||"").trim();let j="",_="";if(S){const A=S.split(" ");A.length===1?j=A[0]:(_=A.pop(),j=A.join(" "))}m(A=>({...A,first_name:j,last_name:_,email:b?.email||""})),l("")}catch(b){const S=b?.response?.data?.msg||b?.response?.data?.error||b?.message||"Invalid or expired link.";l(S)}finally{a(!1)}})()},[t]);const v=b=>m(S=>({...S,[b.target.name]:b.target.value})),g=["first_name","last_name","birthdate","citizenship","email","phone","ssn","address1","country","city","state","zip","password"],w=async b=>{b.preventDefault(),l(""),h("");for(const S of g)if(!String(d[S]||"").trim()){const j=S.replace(/_/g," ");l(`${j} is required`);return}try{const{data:S}=await We.post(`/admin/invite/${t}`,d);h(S?.msg||"Account created. Redirecting to login"),setTimeout(()=>r("/login"),900)}catch(S){const j=S?.response?.data?.msg||S?.response?.data?.error||S?.message||"Something went wrong.";l(j)}};return n?c.jsx("div",{className:"p-6 text-gray-600",children:"Loading invitation"}):c.jsx("div",{className:"max-w-5xl mx-auto p-6",children:c.jsxs("form",{onSubmit:w,className:"space-y-10",children:[c.jsxs("section",{className:"rounded-2xl border border-gray-200 bg-white shadow-sm",children:[c.jsx("div",{className:"flex items-start justify-between p-6 border-b",children:c.jsx("h2",{className:"text-xl font-semibold",children:"Personal Information"})}),c.jsxs("div",{className:"p-6",children:[c.jsxs("div",{className:"grid grid-cols-[96px_1fr] gap-6 items-start",children:[c.jsx("div",{className:"h-24 w-24 rounded-full bg-teal-500 text-white grid place-items-center text-3xl font-semibold",children:p}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsx(An,{label:"First Name",name:"first_name",value:d.first_name,onChange:v,required:!0}),c.jsx(An,{label:"Last Name",name:"last_name",value:d.last_name,onChange:v,required:!0}),c.jsx(An,{label:"Birthdate",name:"birthdate",value:d.birthdate,onChange:v,required:!0,placeholder:"MM/DD/YYYY"}),c.jsx(An,{label:"Citizenship",name:"citizenship",value:d.citizenship,onChange:v,required:!0,placeholder:"United States"}),c.jsx(An,{label:"Email",name:"email",type:"email",value:d.email,onChange:v,required:!0}),c.jsx(An,{label:"Phone",name:"phone",value:d.phone,onChange:v,required:!0}),c.jsx(An,{label:"SSN / Tax ID",name:"ssn",value:d.ssn,onChange:v,required:!0}),c.jsx(An,{label:"Emergency Contact (Phone Number)",name:"emergency_contact",value:d.emergency_contact,onChange:v,placeholder:"+1 555 0100"}),c.jsx("div",{className:"text-xs text-gray-500 self-end md:col-span-1",children:"SSN / Tax ID is an encrypted attribute"})]})]}),c.jsx("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 gap-6",children:c.jsx(An,{label:"Password",name:"password",type:"password",value:d.password,onChange:v,required:!0})})]})]}),c.jsxs("section",{className:"rounded-2xl border border-gray-200 bg-white shadow-sm",children:[c.jsx("div",{className:"p-6 border-b",children:c.jsx("h3",{className:"text-xl font-semibold",children:"Residential Address"})}),c.jsxs("div",{className:"p-6 grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsx("div",{className:"md:col-span-2",children:c.jsx(An,{label:"Street Address 1",name:"address1",value:d.address1,onChange:v,required:!0})}),c.jsx("div",{className:"md:col-span-2",children:c.jsx(An,{label:"Street Address 2 (Optional)",name:"address2",value:d.address2,onChange:v})}),c.jsx(An,{label:"Country",name:"country",value:d.country,onChange:v,required:!0}),c.jsx(An,{label:"City",name:"city",value:d.city,onChange:v,required:!0}),c.jsx(An,{label:"State / Province",name:"state",value:d.state,onChange:v,required:!0}),c.jsx(An,{label:"Zip / Postal Code",name:"zip",value:d.zip,onChange:v,required:!0})]})]}),i&&c.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 text-rose-700 px-4 py-3",children:i}),u&&c.jsx("div",{className:"rounded-xl border border-emerald-200 bg-emerald-50 text-emerald-700 px-4 py-3",children:u}),c.jsx("div",{children:c.jsx("button",{type:"submit",className:"inline-flex items-center justify-center rounded-xl bg-indigo-600 text-white font-medium px-6 py-3 shadow hover:brightness-110 active:scale-[0.99]",children:"Create Account"})})]})})}function An({label:e,name:t,value:r,onChange:n,required:a,type:i="text",placeholder:l=""}){return c.jsxs("div",{className:"space-y-1",children:[c.jsxs("label",{className:"block text-sm font-semibold text-gray-700",children:[e,a&&c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{name:t,type:i,value:r,onChange:n,placeholder:l,required:a,className:"w-full rounded-lg border px-3 py-2.5 bg-gray-50 focus:bg-white focus:outline-none focus:ring-4 focus:ring-indigo-100 border-gray-300"})]})}function C0e(e){return document.cookie.split("; ").find(t=>t.startsWith(e+"="))?.split("=")[1]||""}async function iC(e,t={}){const r=new Headers(t.headers||{});if(t.method&&t.method!=="GET"||t.forceXsrf){const n=C0e("XSRF-TOKEN");n&&r.set("X-XSRF-TOKEN",n)}return fetch(e,{...t,headers:r,credentials:"include"})}function O0e(){const e=Fi(),{token:t}=NI(),[r,n]=y.useState(!0),[a,i]=y.useState({email:"",name:""}),[l,u]=y.useState(""),[h,d]=y.useState(!1),[m,p]=y.useState({first_name:"",last_name:"",password:"",confirm:"",phone:"",address:"",company:"",country:"",state:"",city:"",tax_id:""}),[v,g]=y.useState(!1);y.useEffect(()=>{let j=!1;async function _(){n(!0),u("");try{const A=await iC(`/api/admin/invitations/${t}`,{method:"GET"}),k=await A.json();if(!A.ok||k.ok===!1)throw new Error(k.error||"Invalid or expired invitation.");if(!j&&(i({email:k.email,name:k.name||""}),k.name)){const O=k.name.trim().split(/\s+/);p(C=>({...C,first_name:O[0]||"",last_name:O.slice(1).join(" ")||"",company:k.name||""}))}}catch(A){j||u(A.message||"Unable to load invitation.")}finally{j||n(!1)}}return t&&_(),()=>{j=!0}},[t]);function w(j){const{name:_,value:A}=j.target;p(k=>({...k,[_]:A}))}function b(j){return j.length<8?"Password must be at least 8 characters.":/[A-Z]/.test(j)?/[a-z]/.test(j)?/[0-9]/.test(j)?"":"Password must include a number.":"Password must include a lowercase letter.":"Password must include an uppercase letter."}async function S(j){j.preventDefault(),u("");const _=["first_name","last_name","password","confirm"];for(const k of _)if(!m[k]){u("Please fill in all required fields.");return}const A=b(m.password);if(A)return u(A);if(m.password!==m.confirm)return u("Passwords do not match.");d(!0);try{const k=await iC(`/api/admin/invitations/${t}/accept`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({first_name:m.first_name.trim(),last_name:m.last_name.trim(),password:m.password,phone:m.phone.trim()||null,address:m.address.trim()||null,company:m.company.trim()||null,country:m.country.trim()||null,state:m.state.trim()||null,city:m.city.trim()||null,tax_id:m.tax_id.trim()||null})}),O=await k.json().catch(()=>({}));if(!k.ok||O.ok===!1)throw new Error(O.error||"Unable to accept invitation.");e("/login",{replace:!0,state:{flash:"Account created. Please log in."}})}catch(k){u(k.message||"Something went wrong.")}finally{d(!1)}}return r?c.jsx("div",{className:"p-6",children:c.jsx("div",{className:"mx-auto max-w-xl",children:c.jsx("div",{className:"animate-pulse h-24 rounded-2xl bg-gray-100"})})}):l?c.jsx("div",{className:"p-6",children:c.jsx("div",{className:"mx-auto max-w-xl rounded-2xl border border-red-200 bg-red-50 p-6",children:c.jsx("p",{className:"text-red-700 font-medium",children:l})})}):c.jsx("div",{className:"p-6",children:c.jsxs("div",{className:"mx-auto max-w-2xl",children:[c.jsxs("div",{className:"rounded-2xl bg-white shadow-sm ring-1 ring-black/5 p-6",children:[c.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Accept Admin Invitation"}),c.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Create your admin account. Youll be redirected to the login page after submitting."}),c.jsxs("form",{onSubmit:S,className:"mt-6 space-y-5",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-800",children:"Email"}),c.jsx("input",{value:a.email,disabled:!0,className:"mt-1 w-full rounded-xl border border-gray-200 bg-gray-100 px-4 py-2.5 text-gray-700"}),c.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Email is locked to the invited address."})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-800",children:"First name*"}),c.jsx("input",{name:"first_name",value:m.first_name,onChange:w,autoComplete:"given-name",className:"mt-1 w-full rounded-xl border border-gray-200 px-4 py-2.5 focus:ring-4 focus:ring-indigo-100 focus:border-indigo-400",placeholder:"Jane"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-800",children:"Last name*"}),c.jsx("input",{name:"last_name",value:m.last_name,onChange:w,autoComplete:"family-name",className:"mt-1 w-full rounded-xl border border-gray-200 px-4 py-2.5 focus:ring-4 focus:ring-indigo-100 focus:border-indigo-400",placeholder:"Doe"})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-800",children:"Password*"}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:v?"text":"password",name:"password",value:m.password,onChange:w,autoComplete:"new-password",className:"mt-1 w-full rounded-xl border border-gray-200 px-4 py-2.5 pr-12 focus:ring-4 focus:ring-indigo-100 focus:border-indigo-400"}),c.jsx("button",{type:"button",onClick:()=>g(j=>!j),className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-gray-500",children:v?"Hide":"Show"})]}),c.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"At least 8 chars incl. upper/lowercase and a number."})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-800",children:"Confirm password*"}),c.jsx("input",{type:"password",name:"confirm",value:m.confirm,onChange:w,autoComplete:"new-password",className:"mt-1 w-full rounded-xl border border-gray-200 px-4 py-2.5 focus:ring-4 focus:ring-indigo-100 focus:border-indigo-400"})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-800",children:"Phone"}),c.jsx("input",{name:"phone",value:m.phone,onChange:w,className:"mt-1 w-full rounded-xl border border-gray-200 px-4 py-2.5",placeholder:"+1 555 123 4567"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-800",children:"Company"}),c.jsx("input",{name:"company",value:m.company,onChange:w,className:"mt-1 w-full rounded-xl border border-gray-200 px-4 py-2.5",placeholder:"Acme Corp"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-800",children:"Address"}),c.jsx("input",{name:"address",value:m.address,onChange:w,className:"mt-1 w-full rounded-xl border border-gray-200 px-4 py-2.5",placeholder:"123 Main St, Suite 100"})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-800",children:"City"}),c.jsx("input",{name:"city",value:m.city,onChange:w,className:"mt-1 w-full rounded-xl border border-gray-200 px-4 py-2.5",placeholder:"City"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-800",children:"State/Province"}),c.jsx("input",{name:"state",value:m.state,onChange:w,className:"mt-1 w-full rounded-xl border border-gray-200 px-4 py-2.5",placeholder:"State"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-800",children:"Country"}),c.jsx("input",{name:"country",value:m.country,onChange:w,className:"mt-1 w-full rounded-xl border border-gray-200 px-4 py-2.5",placeholder:"Country"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-800",children:"Tax ID"}),c.jsx("input",{name:"tax_id",value:m.tax_id,onChange:w,className:"mt-1 w-full rounded-xl border border-gray-200 px-4 py-2.5",placeholder:"EIN / VAT / GST"})]}),l?c.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 p-3 text-red-700 text-sm",children:l}):null,c.jsx("div",{className:"pt-2",children:c.jsx("button",{type:"submit",disabled:h,className:"inline-flex items-center justify-center rounded-xl bg-indigo-600 px-5 py-2.5 font-medium text-white shadow-sm hover:bg-indigo-700 disabled:opacity-60 disabled:cursor-not-allowed",children:h?"Creating account":"Create admin account"})})]})]}),c.jsxs("p",{className:"mt-6 text-center text-sm text-gray-500",children:["Already have an account?"," ",c.jsx("button",{className:"text-indigo-600 hover:underline",onClick:()=>e("/login"),children:"Log in"})]})]})})}function D0e(e){return document.cookie.split("; ").find(t=>t.startsWith(e+"="))?.split("=")[1]||""}async function P0e(e,t={}){const r=new Headers(t.headers||{});if(t.method&&t.method!=="GET"||t.forceXsrf){const n=D0e("XSRF-TOKEN");n&&r.set("X-XSRF-TOKEN",n)}return fetch(e,{...t,headers:r,credentials:"include"})}function R0e(){const[e,t]=y.useState(""),[r,n]=y.useState(!1),[a,i]=y.useState(!1),[l,u]=y.useState("");async function h(p){i(!0),u("");try{const v=await P0e(`/api/auth/password/${p}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})}),g=await v.json().catch(()=>({}));if(!v.ok&&g?.error)throw new Error(g.error);n(!0),g?.sent===!1?u("We couldn't send the email right now. Try again in a moment."):u("If that email exists, weve sent a reset link.")}catch(v){u(v.message||"Something went wrong. Please try again.")}finally{i(!1)}}const d=p=>{p.preventDefault(),e&&h("forgot")},m=()=>h("resend");return c.jsx("div",{className:"min-h-screen grid place-items-center bg-emerald-500/10 p-6",children:c.jsxs("div",{className:"w-full max-w-xl rounded-2xl bg-white p-8 shadow",children:[c.jsx("h1",{className:"text-2xl font-semibold mb-2",children:"Forgot password"}),r?c.jsxs("div",{className:"space-y-4",children:[c.jsx("p",{className:"text-sm",children:l||"If that email exists, weve sent a reset link."}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("button",{onClick:m,disabled:a,className:"rounded-lg border px-3 py-2 text-sm hover:bg-gray-50 disabled:opacity-60",children:a?"Resending...":"Didnt get it? Resend"}),c.jsx("button",{onClick:()=>n(!1),className:"text-sm text-emerald-700 hover:underline",children:"Use a different email"})]})]}):c.jsxs("form",{onSubmit:d,className:"space-y-4",children:[c.jsx("input",{type:"email",required:!0,value:e,onChange:p=>t(p.target.value),className:"w-full rounded-xl border px-4 py-2",placeholder:"you@example.com"}),c.jsx("button",{disabled:a,className:"w-full rounded-xl bg-emerald-600 text-white py-2",children:a?"Sending...":"Send reset link"})]})]})})}function M0e(e){return document.cookie.split("; ").find(t=>t.startsWith(e+"="))?.split("=")[1]||""}async function sC(e,t={}){const r=new Headers(t.headers||{});if(t.method&&t.method!=="GET"||t.forceXsrf){const n=M0e("XSRF-TOKEN");n&&r.set("X-XSRF-TOKEN",n)}return fetch(e,{...t,headers:r,credentials:"include"})}function F0e(){const[e]=SC(),t=y.useMemo(()=>e.get("token")||"",[e]),[r,n]=y.useState("set"),[a,i]=y.useState(""),[l,u]=y.useState(""),[h,d]=y.useState(""),[m,p]=y.useState(""),[v,g]=y.useState(!1);y.useEffect(()=>{t||p("Invalid or missing reset link.")},[t]);async function w(S){if(S.preventDefault(),!!t){if(a!==l||a.length<8){p("Passwords must match and be at least 8 characters.");return}try{g(!0),p("");const j=await sC("/api/auth/password/set",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:t,password:a})}),_=await j.json().catch(()=>({}));j.ok&&_.ok?(n("verify"),p(_.phone_mask?`We sent a 6-digit code to ${_.phone_mask}.`:"We sent a 6-digit code to your phone.")):p(_.error||"Unable to proceed.")}catch{p("Network error. Please try again.")}finally{g(!1)}}}async function b(S){if(S.preventDefault(),!!t){if(!/^\d{6}$/.test(h)){p("Please enter the 6-digit code.");return}try{g(!0),p("");const j=await sC("/api/auth/password/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:t,code:h})}),_=await j.json().catch(()=>({}));j.ok&&_.ok?(n("done"),p("Password reset complete. You can now log in.")):p(_.error||"Verification failed.")}catch{p("Network error. Please try again.")}finally{g(!1)}}}return t?c.jsx("div",{className:"min-h-[60vh] flex items-center justify-center px-4",children:c.jsxs("div",{className:"w-full max-w-md mx-auto p-8 bg-white rounded-2xl shadow",children:[c.jsx("h1",{className:"text-2xl font-semibold mb-4",children:"Reset password"}),m&&c.jsx("div",{className:"mb-4 text-sm text-amber-700",children:m}),r==="set"&&c.jsxs("form",{onSubmit:w,className:"space-y-4",children:[c.jsx("input",{type:"password",className:"w-full rounded-xl border px-4 py-2",placeholder:"New password",value:a,onChange:S=>i(S.target.value),autoFocus:!0}),c.jsx("input",{type:"password",className:"w-full rounded-xl border px-4 py-2",placeholder:"Confirm password",value:l,onChange:S=>u(S.target.value)}),c.jsx("button",{className:"w-full rounded-xl bg-emerald-600 text-white py-2 disabled:opacity-60",disabled:v,children:v?"Sending code":"Continue"})]}),r==="verify"&&c.jsxs("form",{onSubmit:b,className:"space-y-4",children:[c.jsx("input",{inputMode:"numeric",pattern:"\\d{6}",maxLength:6,className:"w-full rounded-xl border px-4 py-2 tracking-widest text-center",placeholder:"Enter 6-digit code",value:h,onChange:S=>d(S.target.value.replace(/\D/g,"")),autoFocus:!0}),c.jsx("button",{className:"w-full rounded-xl bg-emerald-600 text-white py-2 disabled:opacity-60",disabled:v,children:v?"Verifying":"Verify & Finish"})]}),r==="done"&&c.jsxs("div",{className:"space-y-3",children:[c.jsx("p",{children:"Your password has been updated."}),c.jsx(Um,{to:"/login",className:"text-emerald-700 underline",children:"Return to login"})]})]})}):c.jsx("div",{className:"p-6 text-center",children:m})}function I0e({onSubmit:e,loading:t}){const[r,n]=y.useState(""),[a,i]=y.useState(""),l=u=>{u.preventDefault();const h=r.trim(),d=a.trim();!h||!d||e({name:h,email:d})};return c.jsxs("form",{onSubmit:l,className:"mt-3 space-y-2 rounded-2xl border border-violet-100 bg-violet-50/80 px-3 py-3 text-sm",children:[c.jsx("div",{className:"font-semibold text-violet-800 mb-1",children:"Dependent account details"}),c.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[c.jsx("input",{type:"text",className:"w-full rounded-md border border-gray-300 px-2 py-1 text-sm",placeholder:"Dependent full name",value:r,onChange:u=>n(u.target.value)}),c.jsx("input",{type:"email",className:"w-full rounded-md border border-gray-300 px-2 py-1 text-sm",placeholder:"Dependent email address",value:a,onChange:u=>i(u.target.value)})]}),c.jsx("button",{type:"submit",disabled:t,className:"mt-1 inline-flex items-center justify-center rounded-md bg-violet-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-violet-700 disabled:opacity-60",children:t?"Sending...":"Send dependent request"})]})}function L0e({onSubmit:e,loading:t}){const[r,n]=y.useState([{name:"",email:""}]),a=(h,d,m)=>{n(p=>p.map((v,g)=>g===h?{...v,[d]:m}:v))},i=()=>n(h=>[...h,{name:"",email:""}]),l=h=>n(d=>d.filter((m,p)=>p!==h)),u=h=>{h.preventDefault();const d=r.map(m=>({name:m.name.trim(),email:m.email.trim()})).filter(m=>m.name&&m.email);d.length&&e(d)};return c.jsxs("form",{onSubmit:u,className:"mt-3 space-y-2 rounded-2xl border border-violet-100 bg-violet-50/80 px-3 py-3 text-sm",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{className:"font-semibold text-violet-800",children:"Group members (name + email)"}),c.jsx("button",{type:"button",onClick:i,className:"text-xs text-violet-700 hover:underline",children:"+ Add member"})]}),c.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto pr-1",children:r.map((h,d)=>c.jsxs("div",{className:"grid grid-cols-[1fr,1fr,auto] gap-2",children:[c.jsx("input",{type:"text",className:"rounded-md border border-gray-300 px-2 py-1 text-xs",placeholder:"Full name",value:h.name,onChange:m=>a(d,"name",m.target.value)}),c.jsx("input",{type:"email",className:"rounded-md border border-gray-300 px-2 py-1 text-xs",placeholder:"Email address",value:h.email,onChange:m=>a(d,"email",m.target.value)}),r.length>1&&c.jsx("button",{type:"button",onClick:()=>l(d),className:"text-[10px] text-red-500 hover:underline self-center",children:"Remove"})]},d))}),c.jsx("button",{type:"submit",disabled:t,className:"mt-1 inline-flex items-center justify-center rounded-md bg-violet-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-violet-700 disabled:opacity-60",children:t?"Sending...":"Send group request"})]})}function B0e({apiBase:e="/api",authBase:t="/auth",brand:r="Clarus AI",defaultOpen:n=!1,autoSendOnFinal:a=!1,lang:i="en-US",ttsDefaultEnabled:l=!0}){const[u,h]=y.useState(n),[d,m]=y.useState(!1),[p,v]=y.useState([]),[g,w]=y.useState({user:null,investor:null,ready:!1,error:null}),[b,S]=y.useState(null),j=y.useRef(null),_=y.useRef(null);y.useEffect(()=>{let me=!0;return(async()=>{try{const{data:ce}=await We.get(`${t}/me`,{headers:{Accept:"application/json"}});if(!me)return;if(!ce?.ok){w({user:null,investor:null,ready:!0,error:"Auth error"});return}w({user:ce.user||null,investor:ce.investor||null,ready:!0,error:null})}catch{if(!me)return;w({user:null,investor:null,ready:!0,error:"Cannot reach /auth/me"})}})(),()=>{me=!1}},[t]);const A=y.useMemo(()=>{const me=g?.investor??{},ce=g?.user??{},ze=it=>String(it??"").trim().toLowerCase(),Qe=it=>it===!0||it===1||it==="1"||ze(it)==="true"||ze(it)==="yes",Ke=ze(me.investor_type)||ze(me.type)||ze(ce.investor_type)||ze(ce.type),qe=me.parent_investor_id!=null||me.parent_id!=null||ce.parent_investor_id!=null||ce.parent_id!=null||me.dependent_parent_id!=null;return Ke==="depends"||Ke==="dependent"||Ke==="dependant"||Qe(me.is_dependent)||Qe(ce.is_dependent)||qe},[g]),k=!g.ready||A;function O(){try{const me="clarus_cid_global";let ce=localStorage.getItem(me);return ce||(ce=crypto.randomUUID?crypto.randomUUID():Math.random().toString(36).slice(2)),localStorage.setItem(me,ce),ce}catch{return Math.random().toString(36).slice(2)}}const C=typeof window<"u"&&(window.SpeechRecognition||window.webkitSpeechRecognition),T=!!C,I=y.useRef(null),[M,W]=y.useState(!1),[U,F]=y.useState(""),oe=typeof window<"u"?window.speechSynthesis:void 0,je=!!oe,[ue,V]=y.useState(l&&je),[H,Se]=y.useState([]),[Q,z]=y.useState(!1),Y=y.useRef(null);y.useEffect(()=>{if(!je)return;function me(){const ce=oe.getVoices();ce&&ce.length&&Se(ce)}return me(),window.speechSynthesis.onvoiceschanged=me,()=>{window.speechSynthesis.onvoiceschanged=null}},[je,oe]);const P=y.useMemo(()=>H.length?H.find(ce=>/en/i.test(ce.lang))||H[0]:null,[H]);function q(me){if(!(!ue||!je||!me))try{oe.cancel(),z(!1);const ce=new SpeechSynthesisUtterance(me);Y.current=ce,ce.lang=P?.lang||"en-US",ce.voice=P||null,ce.rate=1,ce.pitch=1,ce.volume=1,ce.onstart=()=>z(!0),ce.onend=()=>z(!1),ce.onerror=()=>z(!1),oe.speak(ce)}catch{}}y.useEffect(()=>{if(!ue||!je||p.length===0)return;const me=p[p.length-1];if(me.role==="assistant"){const ce=(me.content||"").replace(/\*\*/g,"").replace(/<br\s*\/?>/gi,`
`);q(ce)}},[p,ue,je]),y.useEffect(()=>{je&&(u||(oe.cancel(),z(!1)))},[u,oe,je]),y.useEffect(()=>{_.current&&(_.current.scrollTop=_.current.scrollHeight)},[p,d,u]);async function G(me){const ce=me.target.closest('a[data-chat-dl="1"]');if(!ce)return;me.preventDefault();const ze=ce.getAttribute("href");let Qe="";try{const Ke=new URL(ze,window.location.origin);Qe=Ke.searchParams.get("filename")||Ke.searchParams.get("fn")||""}catch{}try{const Ke=await We.get(ze,{responseType:"blob"}),qe=Ke.data,Je=(Ke.headers["content-disposition"]||"").match(/filename\*?=(?:UTF-8''|")(.*?)(?:\"|;|$)/i),Fe=Qe||(ze.split("/").pop()||"download").split("?")[0],Ye=Je?decodeURIComponent(Je[1]):Fe,ge=document.createElement("a");ge.href=URL.createObjectURL(qe),ge.download=Ye,document.body.appendChild(ge),ge.click(),URL.revokeObjectURL(ge.href),ge.remove()}catch(Ke){console.error(Ke),v(qe=>[...qe,{role:"assistant",content:"Sorrycouldnt download that file."}])}}const Z=me=>(me||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");function fe(me){let ce=Z(me||"");return ce=ce.replace(/\[([^\]]+)\]\(((?:https?:\/\/|\/)[^) \t\r\n]+)\)/g,(ze,Qe,Ke)=>{const it=/download/i.test(Qe)?' data-chat-dl="1"':"";return`<a href="${Ke}"${it} class="text-violet-600 hover:underline" target="_blank" rel="noopener noreferrer">${Z(Qe)}</a>`}),ce=ce.replace(/((?:https?:\/\/|\/)[^\s<>"'()]+)(?=[\s)<]|$)/g,ze=>`<a href="${ze}" data-chat-dl="1" class="text-violet-600 hover:underline" target="_blank" rel="noopener noreferrer">${ze}</a>`),ce=ce.replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>"),ce=ce.replace(/\n/g,"<br/>"),ce}async function Oe(me){const ce=(me||"").trim();if(!ce)return;if(je&&(oe.cancel(),z(!1)),v(it=>[...it,{role:"user",content:ce}]),m(!0),/^(\s*(hi|hello|hey|hola|howdy|yo|good\s+(morning|afternoon|evening))\b[!.]?\s*)$/i.test(ce)){const Je=`Hello ${g?.user?.first_name&&g.user.first_name.trim()||g?.user?.username&&String(g.user.username)||g?.user?.email&&String(g.user.email).split("@")[0]||g?.investor?.name&&String(g.investor.name)||"there"}! How can I assist you?`;v(Fe=>[...Fe,{role:"assistant",content:Je}]),m(!1);return}const Qe=O(),Ke=g.user?{id:g.user.id??null,email:g.user.email??null,username:g.user.username??null,name:g.user.name??null,first_name:g.user.first_name??null,last_name:g.user.last_name??null,user_type:g.user.user_type??"Investor"}:{user_type:"Investor"},qe=g.investor?{investor_id:g.investor.id??null,investor_name:g.investor.name??null}:{};try{const{data:it}=await We.post(`${e}/chat`,{message:ce,conversation_id:Qe,user:Ke,...qe}),Je=re(it);v(Fe=>[...Fe,Je])}catch(it){const Je=it?.response?.data?.error||it?.response?.data?.message||it?.message||"Sorryserver unavailable right now.";v(Fe=>[...Fe,{role:"assistant",content:Je}])}finally{m(!1)}}async function Re(me){me&&me.preventDefault();const ce=(j.current?.value||"").trim();if(!ce)return;const ze=ce.toLowerCase();ze.includes("group account")?S("group"):ze.includes("dependent account")||ze.includes("depends account")?S("dependent"):S(null),j.current&&(j.current.value=""),await Oe(ce)}function re(me){if(me?.answer)return{role:"assistant",content:me.answer};if(me?.type==="db")return{role:"assistant",content:me.answer||"(No response)"};if(me?.type==="metric"){const ce=typeof me.value=="number"?new Intl.NumberFormat().format(me.value):me.value,ze=(me.metric||"").replace(/_/g," "),Qe=me.period?`
Period: ${me.period}`:"";return{role:"assistant",content:`**${ze}**: ${ce}${Qe}
${me.note||""}`}}return me?.type==="explanation"||me?.type==="nlp"?{role:"assistant",content:me.answer||""}:me?.error||me?.message?{role:"assistant",content:me.error||me.message}:{role:"assistant",content:"(No response)"}}const be=C,Ae=()=>{if(F(""),!be){F("Voice input not supported in this browser.");return}if(!M)try{const me=new be;I.current=me,me.lang=i,me.interimResults=!0,me.continuous=!1;let ce="";me.onstart=()=>W(!0),me.onresult=ze=>{let Qe="";for(let Ke=ze.resultIndex;Ke<ze.results.length;Ke++){const qe=ze.results[Ke][0].transcript;ze.results[Ke].isFinal?ce+=qe+" ":Qe+=qe}if(j.current){const Ke=j.current.dataset.base||j.current.value;j.current.dataset.base||(j.current.dataset.base=Ke),j.current.value=(Ke+" "+Qe).trim()}},me.onerror=ze=>{F(ze.error||"Voice input error"),W(!1)},me.onend=()=>{if(W(!1),j.current?.dataset?.base&&delete j.current.dataset.base,ce.trim()){if(a)j.current&&(j.current.value=ce.trim()),Re();else if(j.current){const ze=j.current.value||"";j.current.value=(ze+" "+ce).trim(),j.current.focus()}}},me.start()}catch(me){F(me.message||"Failed to start voice input"),W(!1)}},D=async({name:me,email:ce})=>{const ze=`${me}, ${ce}`;await Oe(ze),S(null)},Me=async me=>{const ce=(me||[]).filter(Qe=>Qe.name&&Qe.email);if(!ce.length)return;const ze=ce.map(Qe=>`${Qe.name}, ${Qe.email}`).join(`
`);await Oe(ze),S(null)};if(k)return null;const ae=({className:me=""})=>c.jsx("svg",{viewBox:"0 0 24 24",className:`h-5 w-5 ${me}`,children:c.jsx("path",{fill:"currentColor",d:"M12 2a1 1 0 0 1 1 1v1.06A7.002 7.002 0 0 1 19 11v4a3 3 0 0 1-3 3h-1a3 3 0 0 1-6 0H8a3 3 0 0 1-3-3v-4a7.002 7.002 0 0 1 6-6.94V3a1 1 0 0 1 1-1Zm-3 9a1 1 0 1 0 0 2h6a1 1 0 1 0 0-2H9Z"})}),de=({active:me})=>c.jsx("svg",{viewBox:"0 0 24 24",className:`h-5 w-5 ${me?"text-rose-600":""}`,children:c.jsx("path",{fill:"currentColor",d:"M12 14a3 3 0 0 0 3-3V6a3 3 0 1 0-6 0v5a3 3 0 0 0 3 3Zm6-3a6 6 0 0 1-12 0H4a8 8 0 0 0 7 7.93V21h2v-2.07A8 8 0 0 0 20 11h-2Z"})});return c.jsxs("div",{className:"fixed bottom-6 right-6 z-50",children:[c.jsx("button",{onClick:()=>h(!u),className:"group rounded-full shadow-2xl bg-gradient-to-r from-violet-600 to-indigo-600 text-white h-14 w-14 flex items-center justify-center hover:from-violet-500 hover:to-indigo-500 transition transform hover:scale-[1.03]","aria-label":"Open financial chatbot",children:c.jsx(ae,{className:"text-white group-hover:scale-110 transition-transform"})}),u&&c.jsxs("div",{className:"mt-3 w-[420px] max-h-[78vh] rounded-3xl overflow-hidden shadow-[0_20px_70px_rgba(0,0,0,0.25)] border border-white/20 bg-white/80 backdrop-blur-xl",children:[c.jsx("div",{className:"relative h-16 bg-gradient-to-r from-violet-600 via-indigo-600 to-fuchsia-600",children:c.jsxs("div",{className:"absolute inset-0 px-4 flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-3 text-white",children:[c.jsx("div",{className:"h-9 w-9 rounded-xl bg-white/20 flex items-center justify-center ring-1 ring-white/30",children:c.jsx(ae,{className:"text-white"})}),c.jsxs("div",{className:"leading-tight",children:[c.jsx("div",{className:"font-semibold text-[15px]",children:r}),c.jsxs("div",{className:"text-[12px] flex items-center gap-1 opacity-90",children:[c.jsx("span",{className:"inline-block h-2.5 w-2.5 rounded-full bg-emerald-400 shadow-[0_0_0_2px_rgba(255,255,255,0.35)]"}),"Online"]})]})]}),c.jsx("button",{type:"button",onClick:()=>V(!ue),className:"text-white/90 hover:text-white bg-white/10 hover:bg-white/15 border border-white/20 rounded-xl px-3 py-1.5 text-xs",title:ue?"Turn voice off":"Turn voice on",children:ue?"Voice On":"Voice Off"})]})}),c.jsxs("div",{ref:_,onClick:G,className:"flex-1 max-h-[52vh] overflow-y-auto px-4 py-4 space-y-4 bg-gradient-to-b from-white/60 to-white",children:[g.error&&c.jsxs("div",{className:"text-amber-700 bg-amber-50 border border-amber-200 text-sm rounded-lg p-2",children:[g.error,". You may need to log in again."]}),p.map((me,ce)=>c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("div",{className:"text-[11px] text-gray-400 pl-1",children:me.role==="user"?"You":r}),c.jsx("div",{className:`flex ${me.role==="user"?"justify-end":"justify-start"}`,children:c.jsx("div",{className:`max-w-[78%] leading-relaxed text-[15px] ${me.role==="user"?"bg-gradient-to-r from-violet-600 to-indigo-600 text-white shadow-md rounded-2xl rounded-br-md":"bg-white border border-gray-100 text-gray-800 shadow-sm rounded-2xl rounded-bl-md"} px-4 py-2.5`,dangerouslySetInnerHTML:{__html:fe(me.content||"")}})})]},ce)),d&&c.jsxs("div",{className:"flex items-center gap-2 text-gray-500 pl-1",children:[c.jsx("div",{className:"h-2 w-2 rounded-full bg-gray-400 animate-bounce"}),c.jsx("div",{className:"h-2 w-2 rounded-full bg-gray-300 animate-bounce [animation-delay:150ms]"}),c.jsx("div",{className:"h-2 w-2 rounded-full bg-gray-200 animate-bounce [animation-delay:300ms]"})]}),b==="dependent"&&c.jsx(I0e,{onSubmit:D,loading:d}),b==="group"&&c.jsx(L0e,{onSubmit:Me,loading:d})]}),c.jsxs("form",{onSubmit:Re,className:"border-t border-gray-100 bg-white/80 backdrop-blur px-3 py-3",children:[c.jsxs("div",{className:"flex items-center gap-2 rounded-2xl border border-gray-200 bg-white px-3 py-2 shadow-sm focus-within:ring-2 focus-within:ring-violet-300",children:[c.jsx("input",{ref:j,className:"flex-1 outline-none text-[15px] placeholder-gray-400",placeholder:M?"Listening":"Type or use the mic to speak",autoComplete:"off"}),c.jsx("button",{type:"button",onClick:Ae,disabled:!T,className:`relative shrink-0 inline-flex items-center justify-center rounded-xl px-2.5 py-2 text-sm border
                  ${M?"border-rose-200 text-rose-600 bg-rose-50":"border-gray-200 text-gray-700 hover:bg-gray-50"} disabled:opacity-50`,title:T?"Speak your question":"Voice input not supported",children:c.jsx(de,{active:M})}),c.jsxs("button",{type:"submit",className:"shrink-0 inline-flex items-center gap-2 rounded-xl px-3 py-2 text-sm text-white bg-gradient-to-r from-violet-600 to-indigo-600 hover:from-violet-500 hover:to-indigo-500 transition shadow-md",children:[c.jsx("svg",{viewBox:"0 0 24 24",className:"h-5 w-5",children:c.jsx("path",{fill:"currentColor",d:"M3.4 20.6 22 12 3.4 3.4 3 10l12 2-12 2z"})}),"Send"]})]}),U&&c.jsx("div",{className:"pt-2 text-xs text-rose-600",children:U})]}),c.jsx("div",{className:"px-5 py-2 text-[11px] text-gray-400 bg-white/70",children:"Secure  Scoped answers for the logged-in investor"})]})]})}function kb(e){return(e||"").toString().replace(/\s+/g,"").toLowerCase()}function U0e(){const{user:e}=pn.useContext(mi),t=ga();return e===void 0?c.jsx("div",{children:"Loading..."}):e===null?c.jsx(La,{to:"/login",replace:!0,state:{from:t}}):c.jsx(uy,{})}function oy({role:e}){const{user:t}=pn.useContext(mi),r=ga();if(t===void 0)return c.jsx("div",{children:"Loading..."});if(t===null)return c.jsx(La,{to:"/login",replace:!0,state:{from:r}});const n=kb(t.user_type),a=kb(e);return a==="investor"&&n==="groupadmin"?c.jsx(uy,{}):n!==a?n==="admin"?c.jsx(La,{to:"/admin-dashboard",replace:!0}):n==="groupadmin"?c.jsx(La,{to:"/investor-dashboard",replace:!0}):c.jsx(La,{to:"/investor-dashboard",replace:!0}):c.jsx(uy,{})}function $0e(){const{user:e}=pn.useContext(mi),t=ga(),r=e?.user_type||"",n=kb(r),[a,i]=pn.useState(()=>(typeof window<"u"?window.__INVESTOR__:null)||null);pn.useEffect(()=>{let w=!1;async function b(){if(!e||n!=="investor"){i(null);return}if(window.__INVESTOR__){i(window.__INVESTOR__);return}try{const{data:S}=await We.get("/api/investor/me");w||(i(S||null),window.__INVESTOR__=S||null)}catch{w||i(null)}}return b(),()=>{w=!0}},[e?.id,n]);const l=pn.useMemo(()=>a?(a.investor_type||"").toLowerCase().startsWith("depend")||a.parent_investor_id!=null:!1,[a]),h=pn.useMemo(()=>new Set(["/login","/invite/accept","/accept-invite","/admin/generalpartner","/forgot-password","/reset-password"]),[]).has(t.pathname),d=t.pathname.startsWith("/invite/admin/"),p=!!e&&!(h||d)&&!(n==="investor"&&l);function v(){return e===void 0?c.jsx("div",{children:"Loading..."}):e===null?c.jsx(J7,{}):n==="admin"?c.jsx(La,{to:"/admin-dashboard",replace:!0}):n==="groupadmin"||n==="investor"?c.jsx(La,{to:"/investor-dashboard",replace:!0}):c.jsx(La,{to:"/investor-dashboard",replace:!0})}function g(){return e===void 0?c.jsx("div",{children:"Loading..."}):e?n==="admin"?c.jsx(La,{to:"/admin-dashboard",replace:!0}):n==="groupadmin"||n==="investor"?c.jsx(La,{to:"/investor-dashboard",replace:!0}):c.jsx(La,{to:"/investor-dashboard",replace:!0}):c.jsx(La,{to:"/login",replace:!0})}return c.jsxs(c.Fragment,{children:[c.jsxs(UI,{children:[c.jsx(Ur,{path:"/login",element:c.jsx(v,{})}),c.jsx(Ur,{path:"/invite/accept",element:c.jsx(aC,{})}),c.jsx(Ur,{path:"/accept-invite",element:c.jsx(aC,{})}),c.jsx(Ur,{path:"/invite/admin/:token",element:c.jsx(O0e,{})}),c.jsx(Ur,{path:"/forgot-password",element:c.jsx(R0e,{})}),c.jsx(Ur,{path:"/reset-password",element:c.jsx(F0e,{})}),c.jsx(Ur,{path:"/admin/generalpartner",element:c.jsx(k0e,{})}),c.jsx(Ur,{element:c.jsx(U0e,{}),children:c.jsx(Ur,{path:"/dashboard",element:c.jsx(g,{})})}),c.jsxs(Ur,{element:c.jsx(oy,{role:"admin"}),children:[c.jsx(Ur,{path:"/admin-dashboard",element:c.jsx(e0e,{})}),c.jsx(Ur,{path:"/admin/opportunity",element:c.jsx(_0e,{})})]}),c.jsx(Ur,{element:c.jsx(oy,{role:"groupadmin"}),children:c.jsx(Ur,{path:"/group-admin-dashboard",element:c.jsx(v0e,{})})}),c.jsx(Ur,{element:c.jsx(oy,{role:"investor"}),children:c.jsx(Ur,{path:"/investor-dashboard",element:c.jsx(S0e,{})})}),c.jsx(Ur,{path:"*",element:c.jsx(g,{})})]}),p&&c.jsx(B0e,{user:window.__PORTAL_USER__,investor:window.__INVESTOR__,tenant:"default",ttsDefaultEnabled:!1,autoSendOnFinal:!0,defaultOpen:!0,apiBase:"/api"})]})}GF.createRoot(document.getElementById("root")).render(c.jsx(pn.StrictMode,{children:c.jsx(uL,{children:c.jsx(Q7,{children:c.jsx($0e,{})})})}));
